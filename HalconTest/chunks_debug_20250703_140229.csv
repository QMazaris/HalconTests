context_id,chunk_type,sequence,description,code,line_start,line_end,injected_context
7adec538,full,0,"Example for the application of the HALCON Measure Tool
(in this program: pure image processing witho...","read_image (Zeiss1, 'zeiss1')
get_image_size (Zeiss1, Width, Height)
Row := 275
Column := 335
Radius := 107
AngleStart := -rad(55)
AngleExtent := rad(170)
gen_measure_arc (Row, Column, Radius, AngleStart, AngleExtent, 10, Width, Height, 'nearest_neighbor', MeasureHandle)
measure_pos (Zeiss1, Measure...",9,20,
7adec538,micro,1,(in this program: pure image processing without visualization),"read_image (Zeiss1, 'zeiss1')
get_image_size (Zeiss1, Width, Height)
Row := 275
Column := 335
Radius := 107
AngleStart := -rad(55)
AngleExtent := rad(170)",6,15,
7adec538,micro,2,,"gen_measure_arc (Row, Column, Radius, AngleStart, AngleExtent, 10, Width, Height, 'nearest_neighbor', MeasureHandle)",16,17,"* --- Automatically Added Context ---
get_image_size (Zeiss1, Width, Height)
Row := 275
Column := 335
Radius := 107
AngleStart := -rad(55)
AngleExtent := rad(170)
* --- End of Automatically Added Cont..."
7adec538,micro,3,,"measure_pos (Zeiss1, MeasureHandle, 1, 10, 'all', 'all', RowEdge, ColumnEdge, Amplitude, Distance)
distance_pp (RowEdge[1], ColumnEdge[1], RowEdge[2], ColumnEdge[2], IntermedDist)",18,26,"* --- Automatically Added Context ---
read_image (Zeiss1, 'zeiss1')
gen_measure_arc (Row, Column, Radius, AngleStart, AngleExtent, 10, Width, Height, 'nearest_neighbor', MeasureHandle)
* --- End of Au..."
9fd82286,full,0,"Pin Measurement: Example for the application of the HALCON Measure Tool
(in this program: pure proce...","read_image (Image, 'ic_pin')
get_image_size (Image, Width, Height)
Row := 47
Column := 485
Phi := 0
Length1 := 420
Length2 := 10
gen_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
gen_measure_rectangle2 (Row, Column, Phi, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle...",9,34,
9fd82286,micro,1,(in this program: pure processing code without visualization),"read_image (Image, 'ic_pin')
get_image_size (Image, Width, Height)
Row := 47
Column := 485
Phi := 0
Length1 := 420
Length2 := 10
gen_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)",6,16,
9fd82286,micro,2,,"gen_measure_rectangle2 (Row, Column, Phi, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle)",17,18,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
Row := 47
Column := 485
Phi := 0
Length1 := 420
Length2 := 10
* --- End of Automatically Added Context ---"
9fd82286,micro,3,,"measure_pairs (Image, MeasureHandle, 1.5, 30, 'negative', 'all', RowEdgeFirst, ColumnEdgeFirst, AmplitudeFirst, RowEdgeSecond, ColumnEdgeSecond, AmplitudeSecond, PinWidth, PinDistance)
avgPinWidth := sum(PinWidth) / |PinWidth|
avgPinDistance := sum(PinDistance) / |PinDistance|
numPins := |PinWidth|",19,23,"* --- Automatically Added Context ---
read_image (Image, 'ic_pin')
gen_measure_rectangle2 (Row, Column, Phi, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle)
* --- End of Automatica..."
9fd82286,micro,4,,"Row := 508
Column := 200
Phi := -1.5708
Length1 := 482
Length2 := 35
gen_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
gen_measure_rectangle2 (Row, Column, Phi, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle)
measure_pos (Image, MeasureHandle, 1.5, 30, 'all', 'all', ...",24,40,"* --- Automatically Added Context ---
read_image (Image, 'ic_pin')
get_image_size (Image, Width, Height)
Row := 47
Column := 485
Phi := 0
Length1 := 420
Length2 := 10
gen_rectangle2 (Rectangle, Row, C..."
c6aa1fef,full,0,"This example shows the usage of the metrology model
to measure circles and rectangles with subpixel
...","dev_update_off ()
read_image (Image, 'pads')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
RowCircle := [52:89:500]
CircleInitRow := [RowCircle,RowCircle]
CircleInit...",11,107,
c6aa1fef,micro,1,,"dev_update_off ()
read_image (Image, 'pads')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",10,17,
c6aa1fef,micro,2,tolerance for the circles,"RowCircle := [52:89:500]
CircleInitRow := [RowCircle,RowCircle]
CircleInitColumn := [gen_tuple_const(6,348),gen_tuple_const(6,438)]
gen_cross_contour_xld (Cross1, CircleInitRow, CircleInitColumn, 6, 0.785398)
CircleInitRadius := [gen_tuple_const(6,23),gen_tuple_const(6,23)]
CircleRadiusTolerance := ...",18,25,
c6aa1fef,micro,3,tolerance for the rectangles,"RectangleInitRow := [410, 410]
RectangleInitColumn := [215, 562]
RectangleInitPhi := [0, 0]
RectangleInitLength1 := [85, 85]
RectangleInitLength2 := [88, 88]
RectangleTolerance := 10",26,34,
c6aa1fef,micro,4,,create_metrology_model (MetrologyHandle),35,36,
c6aa1fef,micro,5,"necessary, but improves the runtime of the
first measurement.","set_metrology_model_image_size (MetrologyHandle, Width, Height)",37,40,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
c6aa1fef,micro,6,as defined above,"add_metrology_object_rectangle2_measure (MetrologyHandle, RectangleInitRow, RectangleInitColumn, RectangleInitPhi, RectangleInitLength1, RectangleInitLength2, RectangleTolerance, 5, .5, 1, [], [], MetrologyRectangleIndices)",41,43,"* --- Automatically Added Context ---
RectangleInitRow := [410, 410]
RectangleInitColumn := [215, 562]
RectangleInitPhi := [0, 0]
RectangleInitLength1 := [85, 85]
RectangleInitLength2 := [88, 88]
Rect..."
c6aa1fef,micro,7,as defined above,"add_metrology_object_circle_measure (MetrologyHandle, CircleInitRow, CircleInitColumn, CircleInitRadius, CircleRadiusTolerance, 5, 1.5, 2, [], [], MetrologyCircleIndices)",44,46,"* --- Automatically Added Context ---
CircleInitRow := [RowCircle,RowCircle]
CircleInitColumn := [gen_tuple_const(6,348),gen_tuple_const(6,438)]
CircleInitRadius := [gen_tuple_const(6,23),gen_tuple_co..."
c6aa1fef,micro,8,"instance per metrology object in one call.
Since we like to measure two circles per object,
we set '...","set_metrology_object_param (MetrologyHandle, MetrologyCircleIndices, 'num_instances', 2)",47,51,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
add_metrology_object_circle_measure (MetrologyHandle, CircleInitRow, CircleInitColumn, CircleInitRadius, CircleRadiusTole..."
c6aa1fef,micro,9,"that only consistent circles are returned, that have
either only edges from bright to dark or vice v...","set_metrology_object_param (MetrologyHandle, MetrologyCircleIndices, 'measure_transition', 'uniform')",52,59,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
add_metrology_object_circle_measure (MetrologyHandle, CircleInitRow, CircleInitColumn, CircleInitRadius, CircleRadiusTole..."
c6aa1fef,micro,10,,"set_metrology_object_param (MetrologyHandle, MetrologyCircleIndices, 'min_score', .9)",60,62,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
add_metrology_object_circle_measure (MetrologyHandle, CircleInitRow, CircleInitColumn, CircleInitRadius, CircleRadiusTole..."
c6aa1fef,micro,11,,"apply_metrology_model (Image, MetrologyHandle)
get_metrology_object_result (MetrologyHandle, MetrologyRectangleIndices, 'all', 'result_type', 'all_param', RectangleParameter)",63,67,"* --- Automatically Added Context ---
read_image (Image, 'pads')
create_metrology_model (MetrologyHandle)
add_metrology_object_rectangle2_measure (MetrologyHandle, RectangleInitRow, RectangleInitColum..."
c6aa1fef,micro,12,,"Sequence := [0:5:|RectangleParameter| - 1]
RectangleRow := RectangleParameter[Sequence]
RectangleColumn := RectangleParameter[Sequence + 1]
RectanglePhi := RectangleParameter[Sequence + 2]
RectangleLength1 := RectangleParameter[Sequence + 3]
RectangleLength2 := RectangleParameter[Sequence + 4]",68,75,"* --- Automatically Added Context ---
get_metrology_object_result (MetrologyHandle, MetrologyRectangleIndices, 'all', 'result_type', 'all_param', RectangleParameter)
* --- End of Automatically Added C..."
c6aa1fef,micro,13,,"get_metrology_object_result (MetrologyHandle, MetrologyCircleIndices, 'all', 'result_type', 'all_param', CircleParameter)",76,77,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
add_metrology_object_circle_measure (MetrologyHandle, CircleInitRow, CircleInitColumn, CircleInitRadius, CircleRadiusTole..."
c6aa1fef,micro,14,,"Sequence := [0:3:|CircleParameter| - 1]
CircleRow := CircleParameter[Sequence]
CircleColumn := CircleParameter[Sequence + 1]
CircleRadius := CircleParameter[Sequence + 2]",78,83,"* --- Automatically Added Context ---
get_metrology_object_result (MetrologyHandle, MetrologyRectangleIndices, 'all', 'result_type', 'all_param', RectangleParameter)
Sequence := [0:5:|RectangleParamet..."
c6aa1fef,micro,15,,"get_metrology_object_result_contour (Contours, MetrologyHandle, 'all', 'all', 1.5)",86,87,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
c6aa1fef,micro,16,"and the coordinates of the edge points
that were the basis for fitting the circles and rectangles","get_metrology_object_measures (Contour, MetrologyHandle, 'all', 'all', Row1, Column1)
gen_cross_contour_xld (Cross, Row1, Column1, 6, 0.785398)",88,92,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
c6aa1fef,micro,17,,"Color := ['gray', 'cyan', 'green']
dev_display (Image)
dev_set_line_width (1)
dev_set_color (Color[0])
dev_display (Contour)
dev_set_color (Color[1])
dev_display (Cross)
dev_set_line_width (2)
dev_set_color (Color[2])
dev_display (Contours)
Message := Color[2] + ': Measurement result'
Message[1] := ...",93,113,"* --- Automatically Added Context ---
read_image (Image, 'pads')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_metrology_object_result_contour (Contours, MetrologyHandle, 'all', 'a..."
2d5c1a9c,full,0,"***************************************************************
Example for the generic box finder u...","dev_update_off ()
ImagePath := 'boxes/cardboard_boxes_'
dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction ()
stop ()
dev_clear_window ()
read_image (Image, ImagePath + '01')
dev_display (Ima...",34,148,
2d5c1a9c,micro,1,,"dev_update_off ()
ImagePath := 'boxes/cardboard_boxes_'
dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)",33,39,
2d5c1a9c,micro,2,,"set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction ()
stop ()",40,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
2d5c1a9c,micro,3,,"dev_clear_window ()
read_image (Image, ImagePath + '01')
dev_display (Image)
Message := 'This is an image of the example scene in which we want to find the boxes.'
dev_disp_text (Message, 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'righ...",45,157,"* --- Automatically Added Context ---
ImagePath := 'boxes/cardboard_boxes_'
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
4b424568,full,0,"************************************************************
3D Gripping Point Detection training wo...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 42)
ImageDir := '3d_machine_vision/depalletizing/'
LabelDir := ImageDir + 'labels/'
OutputDir := '3d_gripping_point_data'
RemoveResults := false
Visualization3D := false
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gr...",30,332,
4b424568,micro,1,,"dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 42)
ImageDir := '3d_machine_vision/depalletizing/'
LabelDir := ImageDir + 'labels/'
OutputDir := '3d_gripping_point_data'",28,37,
4b424568,micro,2,,RemoveResults := false,38,40,
4b424568,micro,3,"The 3D visualization can be used for better interpretation
of the final results.",Visualization3D := false,41,45,
4b424568,micro,4,,"DeviceRuntime := ['gpu', 'cpu']",46,48,
4b424568,micro,5,"Preparation and Initialization
************************************************************","read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)",49,54,
4b424568,micro,6,(prefer GPU over CPU).,"set_suitable_device (DLModelHandle, DeviceRuntime)",55,58,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
4b424568,micro,7,"You can create a dataset e.g. with the MVTec Deep Learning
Tool. To label the data use a segmentatio...","read_dl_dataset_3d_gripping_point_detection (ImageDir, LabelDir, [128, 0], dict{file_name_xyz_only: 'xyz_'}, DLDataset)",59,65,"* --- Automatically Added Context ---
ImageDir := '3d_machine_vision/depalletizing/'
LabelDir := ImageDir + 'labels/'
* --- End of Automatically Added Context ---"
4b424568,micro,8,,"split_dl_dataset (DLDataset, 70, 15, [])
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, dict{overwrite_files: 'auto'}, DLDatasetFilename)",66,70,"* --- Automatically Added Context ---
OutputDir := '3d_gripping_point_data'
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
read_dl_dataset_3d_gripping_point_detection (ImageDir, ..."
4b424568,micro,9,,"WindowDict := dict{}
DatasetSamples := DLDataset.samples
for Index := 0 to 4 by 1
SampleIndex := round(rand(1) * (|DatasetSamples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'gripping_map_ground_truth', [], WindowDict)
dev_disp_text ('Press...",71,82,"* --- Automatically Added Context ---
read_dl_dataset_3d_gripping_point_detection (ImageDir, LabelDir, [128, 0], dict{file_name_xyz_only: 'xyz_'}, DLDataset)
* --- End of Automatically Added Context -..."
4b424568,micro,10,,"set_dl_model_param (DLModelHandle, 'solver_type', 'adam')
set_dl_model_param (DLModelHandle, 'learning_rate', 0.001)
set_dl_model_param (DLModelHandle, 'batch_size', 2)",87,90,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
4b424568,micro,11,"For better model performance increase the number of epochs,
from 100 to e.g. 200.","create_dl_train_param (DLModelHandle, 100, 1, 'true', 42, [], [], TrainParam)",91,94,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
4b424568,micro,12,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",95,103,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
read_dl_dataset_3d_gripping_point_detection (ImageDir, LabelDir, [128, 0], dict{file_name_xyz..."
4b424568,micro,13,"restrict the size of regions which are considered during
the gripping point determination.","GrippingPointParams := dict{min_area_size: 300}
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandlePretrained)
set_suitable_device (DLModelHandlePretrained, DeviceRuntime)",111,118,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
* --- End of Automatically Added Context ---"
4b424568,micro,14,train_dl_model.,"read_dl_model ('model_best.hdl', DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_suitable_device (DLModelHandle, DeviceRuntime)
GrippingPointParams := dict{min_area_size: 300}
EvalMeasures := ['gripping_point...",119,140,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
read_dl_dataset_3d_gripping_point_detection (ImageDir, LabelD..."
4b424568,micro,15,"model to some randomly chosen test images and compare the
result to the pretrained model.","find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
read_dl_samples (DLDataset, SampleIndices, TestSamples)
DisplayParams := dict{gripping_point_size: 25}
DisplayParams3D := dict{arrow_thickness: 0.003, arrow_length: 0.05}
if (Visualization3D)
WindowDict := dict{}
WindowDict...",145,205,"* --- Automatically Added Context ---
OutputDir := '3d_gripping_point_data'
RemoveResults := false
Visualization3D := false
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
read_dl..."
4b424568,micro,16,'runtime' if possible.,"query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
for Index := 0 to |DLDeviceHandles| - 1 by 1
try
set_dl_model_param (DLModelHandle, 'device', DLDevi...",206,242,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
for Index := 0 to 4 by 1
* --- End of Automatically Added Con..."
4b424568,micro,17,,"if (not RemoveResults)
return ()
endif",243,247,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
4b424568,micro,18,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",248,256,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_display_gripping_point_evaluation_comparison (['Pretrained model', ..."
4b424568,micro,19,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",257,281,"* --- Automatically Added Context ---
OutputDir := '3d_gripping_point_data'
* --- End of Automatically Added Context ---"
4b424568,micro,20,,"if (|ModelNames| != 2 or |EvaluationResults| != 2)
throw ('This procedure works only with 2 models.')
endif
WindowWidth := 512
WindowHeight := 512
PieColors := ['#008000', '#800000']
ContentStart := WindowHeight * 0.12
AvailableHeight := WindowHeight * 0.70
PieRadius := AvailableHeight * 0.12
dev_op...",282,342,"* --- Automatically Added Context ---
dev_display_gripping_point_evaluation_comparison (['Pretrained model', 'Finetuned model'], [EvaluationResultPretrained,EvaluationResult], WindowHandle)
* --- End ..."
77f0f4dc,full,0,"************************************************************
3D Gripping Point Detection example wor...","dev_update_off ()
dev_close_window ()
ImagePath := '3d_machine_vision/gripping_point_detection/'
Visualization3D := false
DeviceRuntime := ['gpu', 'cpu']
SortResultsTiltedCamera := false
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
set_dl_model_param (DLModelHandle, 'image_wi...",29,201,
77f0f4dc,micro,1,,"dev_update_off ()
dev_close_window ()
ImagePath := '3d_machine_vision/gripping_point_detection/'",27,33,
77f0f4dc,micro,2,"The 3D visualization can be used for better understanding
and interaction. For faster processing cho...",Visualization3D := false,34,39,
77f0f4dc,micro,3,,"DeviceRuntime := ['gpu', 'cpu']",40,42,
77f0f4dc,micro,4,"(i. e. the z-axis), the sorting direction of the
gripping points can be estimated orthogonally to th...",SortResultsTiltedCamera := false,43,48,
77f0f4dc,micro,5,"Preparation and Initialization
************************************************************","read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)",49,54,
77f0f4dc,micro,6,"changed here.
Please refer to the chapter reference for details.","set_dl_model_param (DLModelHandle, 'image_width', 640)
set_dl_model_param (DLModelHandle, 'image_height', 480)",55,60,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
77f0f4dc,micro,7,(prefer GPU over CPU).,"set_suitable_inference_device (DLModelHandle, DeviceRuntime)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
WindowDict := dict{}
DLDatasetInfo := dict{}",61,68,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
77f0f4dc,micro,8,parameter options.,"DisplayParams := dict{gripping_point_size: 25}
DisplayParams3D := dict{arrow_thickness: 0.003, arrow_length: 0.05}",69,72,
77f0f4dc,micro,9,parameter options.,"DLGrippingPointParams := dict{min_area_size: 300}
if (SortResultsTiltedCamera)
read_image (GrayImage, ImagePath + 'warehouse_gray_01')
read_image (XYZImage, ImagePath + 'warehouse_xyz_01')
decompose3 (XYZImage, X, Y, Z)
estimate_dl_3d_sorting_direction (X, Y, Z, DLGrippingPointParams.sorting_directi...",73,85,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/gripping_point_detection/'
Visualization3D := false
SortResultsTiltedCamera := false
* --- End of Automatically Added Context ---"
77f0f4dc,micro,10,"Inference on Example Images
************************************************************","for Index := 1 to 9 by 1
read_image (Image, ImagePath + 'warehouse_gray_' + Index$'.2d')
read_image (XYZImage, ImagePath + 'warehouse_xyz_' + Index$'.2d')
decompose3 (XYZImage, X, Y, Z)
gen_empty_obj (Normals)
gen_dl_samples_3d_gripping_point_detection (Image, X, Y, Z, Normals, DLSample)
preprocess_...",86,137,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/gripping_point_detection/'
Visualization3D := false
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
create_dl..."
77f0f4dc,micro,11,device type if possible.,"query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
for Index := 0 to |DLDeviceHandles| - 1 by 1
try
set_dl_model_param (DLModelHandle, 'device', DLDevi...",138,180,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
read_dl_model ('pretrained_dl_3d_gripping_point.hdl', DLModelHandle)
for Index := 1 to 9 by 1
* --- End of Automatically Added Con..."
77f0f4dc,micro,12,,"PoseIn := [-0.05, -0.4, 10.0, 314.011, 3.748, 358.584, 0]
xyz_attrib_to_object_model_3d (X, Y, Z, Image, '&amp;gray', ObjectModel3D)
get_object_models_center (ObjectModel3D, Center)
max_diameter_object_model_3d (ObjectModel3D, Diameter)
gen_arrow_object_model_3d (Diameter * 0.01, Center - Diameter /...",181,193,"* --- Automatically Added Context ---
decompose3 (XYZImage, X, Y, Z)
read_image (Image, ImagePath + 'warehouse_gray_' + Index$'.2d')
* --- End of Automatically Added Context ---"
77f0f4dc,micro,13,,"Font := 'mono'
FontSize := 14
set_display_font (WindowHandleDirection, FontSize, Font, 'true', 'false')
visualize_object_model_3d (WindowHandleDirection, [ObjectModel3D,OM3DArrow], [], PoseIn, ['color_attrib_0', 'color_1'], ['&amp;gray', 'yellow'], Message, [], Instructions, PoseOut)
dev_close_windo...",194,213,"* --- Automatically Added Context ---
PoseIn := [-0.05, -0.4, 10.0, 314.011, 3.748, 358.584, 0]
xyz_attrib_to_object_model_3d (X, Y, Z, Image, '&amp;gray', ObjectModel3D)
gen_arrow_object_model_3d (Di..."
8b3f7ffd,full,0,"***************************************************************
Example for generating synthetic tra...","dev_update_off ()
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_introduction_text (WindowHandle)
stop ()
dev_clear_window ()
dev_disp_text ('First, read the 3D object model to be used for the data generation,\ndefine dat...",25,573,
8b3f7ffd,micro,1,"is created that can be used to train the detection and
the 3D pose estimation network.
For this trai...","dev_update_off ()
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_introduction_text (WindowHandle)
stop ()",18,30,
8b3f7ffd,micro,2,"Set basic parameters of the dataset.
***********************************************","dev_clear_window ()
dev_disp_text ('First, read the 3D object model to be used for the data generation,\ndefine data generation parameters and prepare the needed data\nstructures.', 'window', 'top', 'left', 'black', [], [])",31,37,
8b3f7ffd,micro,3,,"read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)",38,39,
8b3f7ffd,micro,4,"Select MaxNumPoints as small as possible for the wanted
approximation of the surface. A smaller numb...","prepare_input_object_model_3d (ObjectModel3D, 1000, ObjectModel3D)",40,45,"* --- Automatically Added Context ---
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
8b3f7ffd,micro,5,,"DatasetRelPath := 'bitholder_dataset'
get_current_dir (DirName)
DatasetAbsPath := DirName + '/' + DatasetRelPath + '/'",46,49,
8b3f7ffd,micro,6,,DatasetDictFilename := DatasetAbsPath + 'DLDataset.hdict',50,51,"* --- Automatically Added Context ---
DatasetAbsPath := DirName + '/' + DatasetRelPath + '/'
DatasetRelPath := 'bitholder_dataset'
get_current_dir (DirName)
* --- End of Automatically Added Context --..."
8b3f7ffd,micro,7,,FileExtension := 'png',52,54,
8b3f7ffd,micro,8,,TargetNumImages := 50000,55,56,
8b3f7ffd,micro,9,,TargetImagesPerFolder := 1000,57,59,
8b3f7ffd,micro,10,or create a new one?,Resume := true,60,63,
8b3f7ffd,micro,11,,"DatasetDict := HNULL
if (Resume)
attempt_read_dataset (DatasetDictFilename, ObjectModel3D, DatasetDict)
endif",64,69,"* --- Automatically Added Context ---
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
DatasetAbsPath := DirName + '/' + DatasetRelPath + '/'
DatasetRelPath := 'bitholder_dat..."
8b3f7ffd,micro,12,,"if (DatasetDict == HNULL)
create_dataset_deep_3d_matching (ObjectModel3D, DatasetAbsPath, DatasetDict)
mkdir_recursive (DatasetDict.image_dir)
write_dict (DatasetDict, DatasetDictFilename, [], [])
endif
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",70,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
DatasetAbsPath := DirName + '/'..."
8b3f7ffd,micro,13,"Start Scene Engine.
***********************************************","dev_clear_window ()
dev_disp_text ('Then, start and connect the Scene Engine and check available assets.', 'window', 'top', 'left', 'black', [], [])
try
open_scene_engine ([], [], SceneEngine)
catch (Exception)
Text := 'Unable to start scene engine.'
Text := [Text,'Check that the tool is correctly i...",79,100,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
8b3f7ffd,micro,14,"Set data generation parameters.
***********************************************","dev_clear_window ()
dev_disp_text ('Then, set parameters for the data generation.', 'window', 'top', 'left', 'black', [], [])",101,107,"* --- Automatically Added Context ---
dev_disp_text ('Then, start and connect the Scene Engine and check available assets.', 'window', 'top', 'left', 'black', [], [])
* --- End of Automatically Added ..."
8b3f7ffd,micro,15,,"create_scene_engine_run_params (SceneEngine, ObjectModel3D, DataGenParams)",108,110,"* --- Automatically Added Context ---
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
open_scene_engine ([], [], SceneEngine)
* --- End of Automatically Added Context ---"
8b3f7ffd,micro,16,,"set_scene_engine_run_param (DataGenParams, 'part_material', 'plastic_clear')
set_scene_engine_run_param (DataGenParams, 'part_color', [0.075, 0.015, 0.020, 0.115, 0.036, 0.220])
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",111,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
create_scene_engine_run_params (SceneEngine, ObjectModel3D, DataGenParams)
* --- End of Automatically Adde..."
8b3f7ffd,micro,17,"Render example images.
***********************************************","dev_clear_window ()
dev_disp_text ('Rendering example images. This might take a few seconds.', 'window', 'top', 'left', 'black', [], [])
run_scene_engine (SceneEngine, DataGenParams, SceneDescription)
visualize_scene_engine_run (SceneDescription, [], [])
dev_disp_text ('Example images with object ma...",118,132,"* --- Automatically Added Context ---
open_scene_engine ([], [], SceneEngine)
create_scene_engine_run_params (SceneEngine, ObjectModel3D, DataGenParams)
* --- End of Automatically Added Context ---"
8b3f7ffd,micro,18,"Render the dataset.
***********************************************","dev_disp_data_generation_text (TargetNumImages, WindowHandle)
stop ()
while (DatasetDict.num_images &lt; TargetNumImages)
run_scene_engine (SceneEngine, DataGenParams, SceneDescription)
visualize_scene_engine_run (SceneDescription, [], [])
for ResultImgIdx := 0 to |SceneDescription.images| - 1 by 1
...",133,197,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
DatasetAbsPath := DirName + '/' + DatasetRelPath + '/'
DatasetRelPath := 'bitholder_dataset'
get_current_d..."
8b3f7ffd,micro,19,,"DatasetDict := dict{}
tuple_sem_type_elem (ObjectModel3D, SemTypes)
if (SemTypes != 'object_model_3d')
throw ('ObjectModel3D must be a 3D Object Model.')
endif
DatasetDict.orig_3d_model := ObjectModel3D
DatasetDict.image_dir := DatasetPath
DatasetDict.num_images := 0
DatasetDict.curr_sub_path := 0
D...",198,242,"* --- Automatically Added Context ---
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
DatasetDict := HNULL
if (DatasetDict == HNULL)
* --- End of Automatically Added Context..."
8b3f7ffd,micro,20,,"get_scene_engine_param (SceneEngine, 'assets', Assets)
NumMeshes := 0
NumTextures := 0
NumEnvironmentMaps := 0
AssetsFound := true
try
get_dict_param (Assets.providers, 'keys', [], ProviderNames)
for Index := 0 to |ProviderNames| - 1 by 1
Providers := Assets.providers
get_dict_tuple (Providers, Prov...",243,294,"* --- Automatically Added Context ---
open_scene_engine ([], [], SceneEngine)
catch (Exception)
Text := 'Unable to start scene engine.'
dev_disp_text (Text, 'window', 'top', 'left', '#F28D26', 'box', ..."
8b3f7ffd,micro,21,"and checks if the contained 3D object model matches
the target 3D object model.","try
read_dict (DatasetDictFilename, [], [], DatasetDict)
catch (Exception)
DatasetDict := HNULL
return ()
endtry",295,307,"* --- Automatically Added Context ---
DatasetAbsPath := DirName + '/' + DatasetRelPath + '/'
DatasetRelPath := 'bitholder_dataset'
get_current_dir (DirName)
DatasetDictFilename := DatasetAbsPath + 'DL..."
8b3f7ffd,micro,22,,"get_object_model_3d_params (ObjectModel3D, 'num_points', NumPoints)
get_object_model_3d_params (ObjectModel3D, 'center', Center)
max_diameter_object_model_3d (ObjectModel3D, Diameter)
get_object_model_3d_params (DatasetDict.orig_3d_model, 'num_points', NumPointsDataset)
get_object_model_3d_params (D...",308,367,"* --- Automatically Added Context ---
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
if (DatasetDict == HNULL)
Text := 'Unable to start scene engine.'
dev_disp_text ('Press..."
8b3f7ffd,micro,23,If the directory already exists no error is thrown.,"tuple_regexp_test (Path, '^(.):', MatchMounted)
tuple_regexp_test (Path, '^/', MatchUnix)
tuple_regexp_test (Path, '^\\\\', MatchWindows)
tuple_regexp_test (Path, '^\\.', MatchRelative)
if (MatchUnix)
tuple_regexp_match (Path, '^/(\\w*)/', Drive)
Drive := '/' + Drive + '/'
tuple_strchr (Path{1:strle...",368,558,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
read_object_model_3d ('bitholder.om3', 'm', [], [], ObjectModel3D, Status)
TargetNumImages := 50000
if (Da..."
8b3f7ffd,micro,24,,"get_object_model_3d_params (ObjectModel3DOut, 'num_triangles', NumTriangles)
if (NumTriangles == 0)
get_object_model_3d_params (ObjectModel3DOut, 'num_polygons', NumPolygons)
if (NumPolygons != 0)
triangulate_object_model_3d (ObjectModel3DOut, 'polygon_triangulation', [], [], ObjectModel3DOut, Infor...",559,583,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3D, 'num_points', NumPoints)
ObjectModel3DOut := ObjectModel3D
* --- End of Automatically Added Context ---"
03ac23b1,full,0,"***************************************************************
This example shows the typical workf...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
set_system ('seed_rand', 42)
dev_disp_introduction_text (WindowHandle)
stop ()
dev_clear_window ()
Text := []
Text := [Text,'First, define input ...",22,448,
03ac23b1,micro,1,***************************************************************,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
set_system ('seed_rand', 42)
dev_disp_introduction_text (WindowHandle)
stop ()",19,29,
03ac23b1,micro,2,"0.) Set input/output paths.
***********************************************","dev_clear_window ()
Text := []
Text := [Text,'First, define input and output paths and the model to train,']
Text := [Text,'read the generated synthetic training data and read or create a']
Text := [Text,'Deep 3D Matching model.']
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])",30,40,
03ac23b1,micro,3,,"* ModelToTrain := 'detection'
ModelToTrain := 'pose_estimation'",41,43,
03ac23b1,micro,4,this program.,RemoveResults := false,44,46,
03ac23b1,micro,5,,"DatasetRelPath := 'bitholder_dataset'
DatasetFilename := './' + DatasetRelPath + '/DLDataset.hdict'",47,49,
03ac23b1,micro,6,,"DeepMatching3DFilename := './' + 'deep_matching_3d.dm3'
OutputDir := './' + DatasetRelPath + '_' + ModelToTrain",50,53,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
DatasetRelPath := 'bitholder_dataset'
* --- End of Automatically Added Context ---"
03ac23b1,micro,7,"1.) Prepare the training.
***********************************************
Read in the DLDataset.","file_exists (DatasetFilename, DatasetFileExists)
if (not DatasetFileExists)
Text := 'DatasetFilename := ' + DatasetFilename + ' does not exist!'
Text := [Text,'', 'Please generate a Deep 3D Matching dataset first.']
Text := [Text,'This is shown in the example deep_3d_matching_data_generation.hdev']
...",54,69,"* --- Automatically Added Context ---
Text := []
DatasetFilename := './' + DatasetRelPath + '/DLDataset.hdict'
DatasetRelPath := 'bitholder_dataset'
* --- End of Automatically Added Context ---"
03ac23b1,micro,8,,"read_or_create_deep_matching_3d (DeepMatching3DFilename, DLDataset, Deep3DMatchingModel)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_' + ModelToTrain, DLModelHandle)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_disp_text ('Then, convert, split ...",70,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* ModelToTrain := 'detection'
DeepMatching3DFilename := './' + 'deep_matching_3d.dm3'
read_dl_dataset_deep..."
03ac23b1,micro,9,parameters.,"if (ModelToTrain == 'pose_estimation')
ConversionParam := dict{min_visibility: 0.2}
convert_dl_dataset_detection_to_pose_estimation (DLDataset, DLModelHandle, ConversionParam, DLDatasetPoseEst)
DLDataset := DLDatasetPoseEst
GenParamPreprocessing := dict{}
else
GenParamPreprocessing := dict{min_visib...",79,89,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
read_dl_dataset_deep_matching_3d (DatasetFilename, DLDataset)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_' + ModelTo..."
03ac23b1,micro,10,,"get_dl_model_param (DLModelHandle, 'type', ModelType)
split_dl_dataset (DLDataset, 95, 5, dict{model_type: ModelType})",90,92,"* --- Automatically Added Context ---
read_dl_dataset_deep_matching_3d (DatasetFilename, DLDataset)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_' + ModelToTrain, DLModelHandle)
* --- En..."
03ac23b1,micro,11,necessary.,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], GenParamPreprocessing, DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)
disp_continue_mess...",93,100,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
DatasetRelPath := 'bitholder_dataset'
OutputDir := './' + DatasetRelPath + '_' + ModelToTrain
read_dl_data..."
03ac23b1,micro,12,,"WindowDict := dict{}
for Index := 0 to 9 by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
if (ModelToTrain == 'pose_estimation')
dev_display_dl_data (DLSample, [], DLDataset, 'image', [], WindowDict)
else
dev_display_dl_data (DLSample,...",101,115,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* ModelToTrain := 'detection'
read_dl_dataset_deep_matching_3d (DatasetFilename, DLDataset)
* --- End of A..."
03ac23b1,micro,13,"2.) Train the model.
***********************************************","dev_clear_window ()
dev_disp_text ('Set training parameters.', 'window', 'top', 'left', 'black', [], [])",116,122,
03ac23b1,micro,14,See the respective system requirements in the Installation Guide.,"query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]",123,129,
03ac23b1,micro,15,,BatchSize := 4,130,131,
03ac23b1,micro,16,duration.,"NumThreadsTraining := max([BatchSize,4])
set_system ('thread_num', NumThreadsTraining)",132,136,"* --- Automatically Added Context ---
BatchSize := 4
* --- End of Automatically Added Context ---"
03ac23b1,micro,17,and get_dl_model_param ().,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'learning_rate', 0.001)
set_dl_model_param (DLModelHandle, 'device', DLDevice)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_close_window ()",137,145,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_' + ModelToTrain, DLModelHandle)
DLDevice := DL..."
03ac23b1,micro,18,each epoch.,"SerializationStrategy := dict{['type']: 'current', basename: 'model_current_epoch_' + ModelToTrain}
if (ModelToTrain == 'pose_estimation')
EvaluationParams := dict{['deep_matching_3d']: Deep3DMatchingModel}
GenParamNames := ['serialize', 'evaluate']
GenParamValues := [SerializationStrategy,Evaluatio...",146,166,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
read_dl_dataset_deep_matching_3d (DatasetFilename, DLDataset)
read_or_create_deep_matching_3d (DeepMatching3DFilename, DLDataset, De..."
03ac23b1,micro,19,"'model_current_epoch_' + ModelToTrain + '.hdl'
in train_dl_model.",stop (),167,171,
03ac23b1,micro,20,,"dev_close_window ()
dev_close_window ()
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)",172,176,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
03ac23b1,micro,21,consumption.,"set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",177,180,"* --- Automatically Added Context ---
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_' + ModelToTrain, DLModelHandle)
* --- End of Automatically Added Context ---"
03ac23b1,micro,22,,"file_exists (DeepMatching3DFilename, FileExists)
if (FileExists)
Text := []
Text := [Text,'When proceeding with F5, you are overwriting the existing']
Text := [Text,'Deep 3D Matching model ' + DeepMatching3DFilename + '.']
Text := [Text,'Are you sure? If yes, press F5.']
dev_clear_window ()
dev_disp...",181,194,"* --- Automatically Added Context ---
Text := []
DeepMatching3DFilename := './' + 'deep_matching_3d.dm3'
read_or_create_deep_matching_3d (DeepMatching3DFilename, DLDataset, Deep3DMatchingModel)
* --- ..."
03ac23b1,micro,23,"3.) Demonstrate inference.
***********************************************","dev_clear_window ()
dev_disp_text ('To demonstrate the inference steps, we apply the trained model to\nsome randomly chosen example images.', 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",195,203,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
03ac23b1,micro,24,to some randomly chosen example images.,"if (ModelToTrain == 'detection')
demonstrate_inference_detection (DLDataset, DLPreprocessParam, DLModelHandle, WindowHandle)
else
demonstrate_inference_pose_estimation (DLDataset, Deep3DMatchingModel, TrainParam, WindowHandle)
endif
dev_clear_window ()",204,212,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
read_dl_dataset_deep_matching_3d (DatasetFilename, DLDataset)
read_or_create_deep_matching_3d (DeepMatching3DFilename, DLDataset, De..."
03ac23b1,micro,25,"4.) Remove files if necessary.
***********************************************","clean_up_output (OutputDir, RemoveResults, ModelToTrain)
dev_disp_text ('End of program.', 'window', 'bottom', 'right', 'black', [], [])",213,232,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
RemoveResults := false
DatasetRelPath := 'bitholder_dataset'
OutputDir := './' + DatasetRelPath + '_' + ModelToTrain
* --- End of Au..."
03ac23b1,micro,26,,"if (not RemoveResults)
return ()
endif",233,237,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
03ac23b1,micro,27,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",238,246,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 400, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
03ac23b1,micro,28,,"remove_dir_recursively (OutputDir)
delete_file ('model_current_epoch_' + ModelToTrain + '.hdl')
delete_file ('model_current_epoch_' + ModelToTrain + '_info.hdict')
return ()
dev_clear_window ()
Text[0] := 'This example shows the typical workflow of a Deep 3D Matching training'
Text[1] := 'on a synth...",247,458,"* --- Automatically Added Context ---
* ModelToTrain := 'detection'
DatasetRelPath := 'bitholder_dataset'
DeepMatching3DFilename := './' + 'deep_matching_3d.dm3'
OutputDir := './' + DatasetRelPath + '..."
647cfa8d,full,0,"This example shows the typical workflow of a Deep 3D Matching
application with a model trained on sy...","dev_update_off ()
dev_close_window ()
DeviceToUse := 'gpu'
BatchSizeDetection := 4
BatchSizePoseEstimation := 4
OptimizedFilePrefix := 'match_bitholder'
WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4
CameraIdxMainView := 2
ImagePath := '3d_machine_vision/multi_view/'
list_image_files (I...",11,467,
647cfa8d,micro,1,"application with a model trained on synthetic data generated
for the application.","dev_update_off ()
dev_close_window ()",7,14,
647cfa8d,micro,2,"- 'cpu' to run on the CPU
- 'gpu' to run on an available GPU
- 'openvino' to use the OpenVINO AI2 in...",DeviceToUse := 'gpu',19,26,
647cfa8d,micro,3,You might need to adapt the values depending on your device.,"BatchSizeDetection := 4
BatchSizePoseEstimation := 4",27,31,
647cfa8d,micro,4,,OptimizedFilePrefix := 'match_bitholder',32,34,
647cfa8d,micro,5,,"WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4",35,38,
647cfa8d,micro,6,,CameraIdxMainView := 2,39,41,
647cfa8d,micro,7,,"ImagePath := '3d_machine_vision/multi_view/'
list_image_files (ImagePath, 'default', [], ImageFiles)
tuple_regexp_select (ImageFiles, 'multi_view_bitholder*', BitholderImages)
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_dis...",42,51,
647cfa8d,micro,8,"Read the trained Deep 3D Matching model. *
*******************************************
For now only ...","dev_clear_window ()
dev_disp_text ('First, read the Deep 3D Matching model and set the device to be\nused. Finding optimized parameter for the device may take some\ntime.', 'window', 'top', 'left', 'black', [], [])",52,62,
647cfa8d,micro,9,,"read_deep_matching_3d ('match_bitholder.dm3', Deep3DMatchingModel)",63,64,
647cfa8d,micro,10,,"set_deep_matching_3d_device (Deep3DMatchingModel, DeviceToUse, BatchSizeDetection, BatchSizePoseEstimation, OptimizedFilePrefix)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",65,70,"* --- Automatically Added Context ---
DeviceToUse := 'gpu'
BatchSizeDetection := 4
BatchSizePoseEstimation := 4
OptimizedFilePrefix := 'match_bitholder'
dev_open_window (0, 0, 600, 450, 'black', Windo..."
647cfa8d,micro,11,"Set camera calibration parameter and pose. *
********************************************","dev_clear_window ()
dev_disp_text ('Set the camera calibration parameter and pose for all four cameras\nin the Deep 3D Matching model.', 'window', 'top', 'left', 'black', [], [])
set_deep_matching_3d_param (Deep3DMatchingModel, 'camera_parameter 0', ['area_scan_division', 0.00538272, -3716.44, 3.444...",71,92,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
dev_disp_text ('First, read the Deep 3D Matching model and set the device to be\nused. Finding optimized p..."
647cfa8d,micro,12,"Apply the Deep 3D Matching. *
*****************************","dev_clear_window ()
dev_disp_text ('Then, apply the Deep 3D Matching on the images of the four cameras.', 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_close_window ()",93,102,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
dev_disp_text ('First, read the Deep 3D Matching model and set the device to be\nused. Finding optimized p..."
647cfa8d,micro,13,,"dev_set_draw ('margin')
dev_open_window (0, 0, WindowWidth / (NumberOfCameras - 1), WindowHeight, 'black', WindowHandle1)
dev_open_window (0, WindowWidth / (NumberOfCameras - 1), WindowWidth, WindowHeight, 'black', WindowHandle2)
dev_open_window (0, WindowWidth * NumberOfCameras / (NumberOfCameras -...",103,108,"* --- Automatically Added Context ---
WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4
* --- End of Automatically Added Context ---"
647cfa8d,micro,14,Each set consists of one image of each of the four calibrated cameras.,"for Index := 1 to |BitholderImages| / NumberOfCameras by 1
Filename := BitholderImages[Index - 1]
read_image (Images, ImagePath + '/multi_view_bitholder_cam_' + [0:NumberOfCameras - 1] + '_' + Index)
visualize_images (Images, WindowHandle1, WindowHandle2, WindowHandle3, NumberOfCameras, CameraIdxMai...",109,125,"* --- Automatically Added Context ---
WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4
CameraIdxMainView := 2
ImagePath := '3d_machine_vision/multi_view/'
tuple_regexp_select (ImageFiles, '..."
647cfa8d,micro,15,,"dev_close_window ()
dev_close_window ()
dev_close_window ()",126,146,
647cfa8d,micro,16,,Device := DeviceToUse,147,150,"* --- Automatically Added Context ---
DeviceToUse := 'gpu'
* --- End of Automatically Added Context ---"
647cfa8d,micro,17,,"get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_detection', DLModelDetection)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_pose_estimation', DLModelPoseEstimation)
set_dl_model_param (DLModelDetection, 'batch_size', BatchSizeDetection)
set_dl_model_param (DLModelPoseEstimati...",151,156,"* --- Automatically Added Context ---
BatchSizeDetection := 4
BatchSizePoseEstimation := 4
read_deep_matching_3d ('match_bitholder.dm3', Deep3DMatchingModel)
* --- End of Automatically Added Context -..."
647cfa8d,micro,18,,"if (DeviceToUse == 'auto')
query_available_dl_devices ('ai_accelerator_interface', 'tensorrt', DLDeviceHandlesTensorRT)
query_available_dl_devices ('ai_accelerator_interface', 'openvino', DLDeviceHandlesOpenVINO)
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandlesGPU)
query_available_dl_de...",157,176,"* --- Automatically Added Context ---
DeviceToUse := 'gpu'
Device := DeviceToUse
* --- End of Automatically Added Context ---"
647cfa8d,micro,19,,"if (Device == 'tensorrt' or Device == 'openvino')
query_available_dl_devices ('ai_accelerator_interface', Device, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No suitable device found. Please choose another DeviceToUse.')
endif
if (Device == 'openvino')
FileName := OptimizedFilePrefix + '_op...",177,219,"* --- Automatically Added Context ---
DeviceToUse := 'gpu'
BatchSizeDetection := 4
BatchSizePoseEstimation := 4
OptimizedFilePrefix := 'match_bitholder'
read_deep_matching_3d ('match_bitholder.dm3', D..."
647cfa8d,micro,20,,"DLDevice := DLDeviceHandles[0]
set_dl_model_param (DLModelDetection, 'device', DLDevice)
set_dl_model_param (DLModelPoseEstimation, 'device', DLDevice)
return ()",220,252,"* --- Automatically Added Context ---
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_detection', DLModelDetection)
get_deep_matching_3d_param (Deep3DMatchingModel, 'dl_model_pose_estimatio..."
647cfa8d,micro,21,,"CameraIdxPreview := [0:NumberOfCameras - 1]
tuple_remove (CameraIdxPreview, find(CameraIdxPreview,CameraIdxMainView), CameraIdxPreview)
dev_set_window (WindowHandle1)
dev_clear_window ()
select_obj (Images, TiledImage, CameraIdxPreview + 1)
tile_images (TiledImage, TiledImage, 1, 'vertical')
zoom_im...",255,267,"* --- Automatically Added Context ---
WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4
CameraIdxMainView := 2
dev_open_window (0, 0, WindowWidth / (NumberOfCameras - 1), WindowHeight, 'blac..."
647cfa8d,micro,22,,"dev_set_window (WindowHandle2)
dev_clear_window ()
select_obj (Images, Image, CameraIdxMainView + 1)
dev_display (Image)
dev_disp_text ('Camera: ' + CameraIdxMainView, 'window', 'top', 'left', 'black', [], [])",268,274,"* --- Automatically Added Context ---
CameraIdxMainView := 2
dev_open_window (0, WindowWidth / (NumberOfCameras - 1), WindowWidth, WindowHeight, 'black', WindowHandle2)
read_image (Images, ImagePath +..."
647cfa8d,micro,23,,"dev_set_window (WindowHandle3)
dev_clear_window ()
return ()",275,307,"* --- Automatically Added Context ---
dev_open_window (0, WindowWidth * NumberOfCameras / (NumberOfCameras - 1), 600, WindowHeight, 'black', WindowHandle3)
* --- End of Automatically Added Context ---"
647cfa8d,micro,24,,"ResultDict := DeepMatchingResults.results
get_dict_param (DeepMatchingResults.results, 'keys', [], ResultKeys)
if (0 == |ResultKeys|)
dev_set_window (WindowHandle2)
Text[0] := 'Camera: ' + CameraIdxMainView
Text[1] := 'No matches found'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
...",311,324,"* --- Automatically Added Context ---
CameraIdxMainView := 2
dev_open_window (0, WindowWidth / (NumberOfCameras - 1), WindowWidth, WindowHeight, 'black', WindowHandle2)
dev_open_window (0, WindowWidth..."
647cfa8d,micro,25,,"CameraIdxPreview := [0:NumberOfCameras - 1]
tuple_remove (CameraIdxPreview, find(CameraIdxPreview,CameraIdxMainView), CameraIdxPreview)
Colors := ['red', 'blue', 'green', 'magenta', 'cyan', 'yellow', 'gray']
get_deep_matching_3d_param (Deep3DMatchingModel, 'orig_3d_model', ObjectModel3D)
ColorNames ...",325,334,"* --- Automatically Added Context ---
NumberOfCameras := 4
CameraIdxMainView := 2
read_deep_matching_3d ('match_bitholder.dm3', Deep3DMatchingModel)
CameraIdxPreview := [0:NumberOfCameras - 1]
* --- E..."
647cfa8d,micro,26,,"for CamIdx := 0 to NumberOfCameras - 1 by 1
get_deep_matching_3d_param (Deep3DMatchingModel, 'camera_pose ' + CamIdx, CamPose)
pose_invert (CamPose, CamPoseInv)
get_deep_matching_3d_param (Deep3DMatchingModel, 'camera_parameter ' + CamIdx, CamParam)
PosesInCam := []
for RIdx := 0 to |ResultKeys| - 1...",335,405,"* --- Automatically Added Context ---
WindowHeight := 550
WindowWidth := 550
NumberOfCameras := 4
CameraIdxMainView := 2
read_deep_matching_3d ('match_bitholder.dm3', Deep3DMatchingModel)
dev_open_win..."
647cfa8d,micro,27,,"dev_set_window (WindowHandle3)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
visualize_object_model_3d (WindowHandle3, OM3DsMainView, [], [], ColorNames, ColorValues, '3D visualization of found matches', Lab...",406,475,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
dev_disp_text ('First, read the Deep 3D Matching model and set the device to be\nused. Finding optimized p..."
44ca0d6d,full,0,"Example for Deformable Surface-Based 3D Matching
This example shows how to use HALCON's deformable s...","dev_update_off ()
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, 400, 300, 800, 600, VisCamParam)
create_pose (0.00, 0.01, 0.62, 122.0, 357.0, 120.0, 'Rp+T', 'gba', 'point', VisPose1)
create_pose (0.08, -0.77, 0.35, 298.0, 353.0, 315.0, 'Rp+T', 'gba', 'point', VisPose2)
VisRefParName := ['alph...",27,267,
44ca0d6d,micro,1,,"dev_update_off ()
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, 400, 300, 800, 600, VisCamParam)
create_pose (0.00, 0.01, 0.62, 122.0, 357.0, 120.0, 'Rp+T', 'gba', 'point', VisPose1)
create_pose (0.08, -0.77, 0.35, 298.0, 353.0, 315.0, 'Rp+T', 'gba', 'point', VisPose2)
VisRefParName := ['alph...",26,44,
44ca0d6d,micro,2,,"Steps := 'Step 1: Create model'
Steps[1] := 'Step 2: Extend model (optional)'
Steps[2] := 'Step 3: Search for (deformed) instances of the object in 3D scenes'",45,49,
44ca0d6d,micro,3,,"dev_clear_window ()
disp_message (WindowHandle, Steps[0], 'window', 12, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",50,55,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ImageWidth, ImageHeight, -1, -1, WindowHandle)
Steps := 'Step 1: Create model'
Steps[1] := 'Step 2: Extend model (optional)'
* ---..."
44ca0d6d,micro,4,,"read_object_model_3d ('silicone_baking_mold/silicone_baking_mold_3d_model', 'm', [], [], ObjectModel3DReference, Status)",56,58,
44ca0d6d,micro,5,"Here, points where the silicone baking mold might be grasped
with a vacuum cup are defined. Note tha...","ReferencePointX := [4.2, 4.2, 4.2, -4.2, -4.2, -4.2] * 0.01
ReferencePointY := [7.75, 0, -7.75, 7.75, 0, -7.75] * 0.01
ReferencePointZ := [3.0, 3.0, 3.0, 3.0, 3.0, 3.0] * 0.01",59,66,
44ca0d6d,micro,6,,"Title := 'Step 1: Create model\n \nCreate deformable surface model from a 3D object model of a\nsilicone baking mold (blue) and some reference points (green)'
gen_object_model_3d_from_points (ReferencePointX, ReferencePointY, ReferencePointZ, ObjectModel3DReferencePoints)
visualize_object_model_3d (...",67,71,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, 400, 300, 800, 600, VisCamParam)
create_pose (0.00, 0.01, 0.62, 122.0, 357.0, 120.0, 'Rp+T', 'gba', 'point', ..."
44ca0d6d,micro,7,,"create_deformable_surface_model (ObjectModel3DReference, 0.03, 'stiffness', 0.85, DeformableSurfaceModel)",72,74,"* --- Automatically Added Context ---
read_object_model_3d ('silicone_baking_mold/silicone_baking_mold_3d_model', 'm', [], [], ObjectModel3DReference, Status)
* --- End of Automatically Added Context ..."
44ca0d6d,micro,8,geometry of the deformed search object.,"add_deformable_surface_model_reference_point (DeformableSurfaceModel, ReferencePointX, ReferencePointY, ReferencePointZ, ReferencePointIndex)",75,78,"* --- Automatically Added Context ---
ReferencePointX := [4.2, 4.2, 4.2, -4.2, -4.2, -4.2] * 0.01
ReferencePointY := [7.75, 0, -7.75, 7.75, 0, -7.75] * 0.01
ReferencePointZ := [3.0, 3.0, 3.0, 3.0, 3.0..."
44ca0d6d,micro,9,,"dev_clear_window ()
disp_message (WindowHandle, Steps[0:1], 'window', 12, 12, ['dim gray', 'white'], 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",79,84,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ImageWidth, ImageHeight, -1, -1, WindowHandle)
Steps := 'Step 1: Create model'
Steps[1] := 'Step 2: Extend model (optional)'
* ---..."
44ca0d6d,micro,10,"to extend the supported range of deformations.
For this, the above created deformable surface model ...","for Index := 1 to 3 by 1
read_object_model_3d ('silicone_baking_mold/silicone_baking_mold_3d_scene_' + Index$'02d', 'm', [], [], ObjectModel3DScene, Status)
preprocess_object_model_3d (ObjectModel3DScene, 'true', 'true', 'true', ObjectModel3DSearchSceneForDef)
if (Index == 1)
dev_clear_window ()
Tit...",85,126,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, 400, 300, 800, 600, VisCamParam)
create_pose (0.08, -0.77, 0.35, 298.0, 353.0, 315.0, 'Rp+T', 'gba', 'point',..."
44ca0d6d,micro,11,,"dev_clear_window ()
disp_message (WindowHandle, Steps[0:2], 'window', 12, 12, ['dim gray', 'dim gray', 'white'], 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",127,132,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ImageWidth, ImageHeight, -1, -1, WindowHandle)
Steps := 'Step 1: Create model'
Steps[1] := 'Step 2: Extend model (optional)'
* ---..."
44ca0d6d,micro,12,,"for Index := 4 to 7 by 1
dev_clear_window ()
disp_message (WindowHandle, 'Step 3: Search for deformed model instances\n \nLoad scene ' + (Index - 3) + ' of 4...', 'window', 12, 12, 'black', 'true')
read_object_model_3d ('silicone_baking_mold/silicone_baking_mold_3d_scene_' + Index$'02d', 'm', [], []...",133,231,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, 400, 300, 800, 600, VisCamParam)
create_pose (0.08, -0.77, 0.35, 298.0, 353.0, 315.0, 'Rp+T', 'gba', 'point',..."
44ca0d6d,micro,13,,"create_pose (0.04765, -0.0071, 0.9388, 340.5837, 1.8518, 0.0, 'Rp+T', 'gba', 'point', PlanePose)
MinDistanceToPlane := 0.015
MaxDistanceBetweenPoints := 0.001
MinNumPoints := 1000
NormalDirection := [0, 0, -1]
if (RemoveBackgroundPlane == 'true')
gen_plane_object_model_3d (PlanePose, [], [], ObjectM...",232,254,"* --- Automatically Added Context ---
create_pose (0.00, 0.01, 0.62, 122.0, 357.0, 120.0, 'Rp+T', 'gba', 'point', VisPose1)
* --- End of Automatically Added Context ---"
44ca0d6d,micro,14,,"if (Smooth == 'true')
smooth_object_model_3d (UnionObjectModel3D, 'mls', [], [], ReferenceModelExt)
else
ReferenceModelExt := UnionObjectModel3D
endif",255,261,"* --- Automatically Added Context ---
union_object_model_3d (ObjectModel3DSelected, 'points_surface', UnionObjectModel3D)
* --- End of Automatically Added Context ---"
44ca0d6d,micro,15,,"if (ReorientNormals == 'true')
orient_normals_towards_direction (ReferenceModelExt, NormalDirection)
endif
return ()",262,279,"* --- Automatically Added Context ---
NormalDirection := [0, 0, -1]
smooth_object_model_3d (UnionObjectModel3D, 'mls', [], [], ReferenceModelExt)
* --- End of Automatically Added Context ---"
367c89c8,full,0,"This example program shows how to use HALCON's 3D shaped-based matching
to find the 3D pose of tile ...","dev_update_off ()
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
get_cam_par_data (CamParam, 'image_width', IWidth)
get_cam_par_data (CamParam, 'image_height', IHeight)
dev_close_window ()
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5...",20,170,
367c89c8,micro,1,explicitly explained in the example program create_shape_model_3d_lowest_model_level.hdev,dev_update_off (),17,21,
367c89c8,micro,2,,"gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
get_cam_par_data (CamParam, 'image_width', IWidth)
get_cam_par_data (CamParam, 'image_height', IHeight)
dev_close_window ()
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'black', WindowH...",22,33,
367c89c8,micro,3,,"acquire_shape_models (WindowHandle, CamParam, ShapeModel3DID1, ShapeModel3DID2)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
MatchingParameters := ['num_matches', 'pose_refinement']
MatchingParameterValues := [2, 'least_squares_high']
MinScore := 0.65
Greediness := 0.9
NumLevels := ...",34,44,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'b..."
367c89c8,micro,4,,"NumImages := 9
for I := 1 to NumImages by 1
read_image (Image, 'tile_spacers/tile_spacers_' + I$'02')
dev_set_color (Colors[0])
dev_display (Image)
Message := 'Search model with \'ignore_local_polarity\' ...'
disp_message (WindowHandle, Message, 'window', 12, 12, Colors, 'true')
count_seconds (Secon...",45,113,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'b..."
367c89c8,micro,5,,"read_object_model_3d ('tile_spacer', 0.0001, [], [], ObjectModel3DID, DxfStatus)
prepare_object_model_3d (ObjectModel3DID, 'shape_based_matching_3d', 'true', [], [])
MinContrast := 10
dev_clear_window ()",114,121,
367c89c8,micro,6,,"Row := 12
disp_message (WindowHandle, 'Reading the 3D shape model file 1 of 2 from disk ...', 'window', Row, 12, 'white', 'false')
file_exists ('tile_spacer_local_polarity.sm3', FileExists)
if (FileExists)
read_shape_model_3d ('tile_spacer_local_polarity.sm3', ShapeModel3DID1)
disp_message (WindowHa...",124,148,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'b..."
367c89c8,micro,7,,"disp_message (WindowHandle, 'Reading the 3D shape model file 2 of 2 from disk ...', 'window', Row, 12, 'white', 'false')
file_exists ('tile_spacer_part_polarity.sm3', FileExists)
if (FileExists)
read_shape_model_3d ('tile_spacer_part_polarity.sm3', ShapeModel3DID2)
disp_message (WindowHandle, 'Readi...",149,181,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'b..."
1e4710c5,full,0,"This example program shows how to use HALCON's shape-based
3D matching to find the 3D pose of tile s...","dev_update_off ()
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
get_cam_par_data (CamParam, 'image_width', IWidth)
get_cam_par_data (CamParam, 'image_height', IHeight)
read_image (Image, 'tile_spacers/tile_spacers_color_01')
dev_cl...",23,193,
1e4710c5,micro,1,"a reduction by factor 6 for the memory needed for the model
and factor 4 for the time needed to crea...",dev_update_off (),19,24,
1e4710c5,micro,2,,"gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
get_cam_par_data (CamParam, 'image_width', IWidth)
get_cam_par_data (CamParam, 'image_height', IHeight)
read_image (Image, 'tile_spacers/tile_spacers_color_01')
dev_close_window ()
dev_...",25,39,
1e4710c5,micro,3,,"try
read_shape_model_3d ('tile_spacer.sm3', ShapeModel3DID)
catch (Exception)
read_object_model_3d ('tile_spacer.dxf', 0.0001, [], [], ObjectModel3DID, DXFStatus)
prepare_object_model_3d (ObjectModel3DID, 'shape_based_matching_3d', 'true', [], [])
disp_message (WindowHandle, 'Reading the 3D shape mo...",40,75,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'w..."
1e4710c5,micro,4,,"Times := []
NumImages := 12
for I := 1 to NumImages by 1
read_image (Image, 'tile_spacers/tile_spacers_color_' + I$'02')
dev_display (Image)
count_seconds (Seconds1)
find_shape_model_3d (Image, ShapeModel3DID, 0.7, 0.85, 0, ['num_matches', 'max_overlap', 'border_model'], [3, 0.75, 'true'], Pose, Cov...",76,132,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
read_image (Image, 'tile_spacers/tile_spacers_c..."
1e4710c5,micro,5,,"pose_to_hom_mat3d (Pose, HomMat3D)
affine_trans_point_3d (HomMat3D, ReferencePoint[0], ReferencePoint[1], ReferencePoint[2], X, Y, Z)
project_3d_point (X, Y, Z, CamParam, Row, Column)",133,137,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0269462, -354.842, 1.27964e-005, 1.28e-005, 254.24, 201.977, 512, 384, CamParam)
find_shape_model_3d (Image, ShapeModel3DID, 0.7..."
1e4710c5,micro,6,,"Message := 'Pose:'
Message[1] := '   X: ' + (1000 * Pose[0])$'4.1f' + ' mm'
Message[2] := '   Y: ' + (1000 * Pose[1])$'4.1f' + ' mm'
Message[3] := '   Z: ' + (1000 * Pose[2])$'4.1f' + ' mm'
Message[4] := '   Alpha: ' + Pose[3]$'4.1f' + '°'
Message[5] := '   Beta: ' + Pose[4]$'4.1f' + '°'
Message[6] ...",138,201,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512 * 1.5, 384 * 1.5, 'white', WindowHandle)
find_shape_model_3d (Image, ShapeModel3DID, 0.7, 0.85, 0, ['num_matches', 'max_overlap', 'bord..."
0ac7abce,full,0,"This program demonstrates the effect of using the
generic parameter 'recompute_score' of the operato...","gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Wi...",34,240,
0ac7abce,micro,1,"significantly higher when setting 'recompute_score'
to 'false'. Also note that in real images typica...","gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Wi...",29,42,
0ac7abce,micro,2,,"X := [-1, -1, 1, 1, -1, -1, 1, 1]
Y := [1, -1, -1, 1, 1, -1, -1, 1]
Z := [-1, -1, -1, -1, 1, 1, 1, 1]
Polygons := [4, 0, 1, 2, 3, 4, 4, 5, 6, 7, 4, 0, 1, 5, 4, 4, 3, 2, 6, 7, 4, 0, 3, 7, 4, 4, 1, 2, 6, 5]
gen_object_model_3d_from_points (X, Y, Z, ObjectModel3DID)
set_object_model_3d_attrib_mod (Obje...",43,50,
0ac7abce,micro,3,,"prepare_object_model_3d (ObjectModel3DID, 'shape_based_matching_3d', 'true', [], [])",51,53,"* --- Automatically Added Context ---
gen_object_model_3d_from_points (X, Y, Z, ObjectModel3DID)
* --- End of Automatically Added Context ---"
0ac7abce,micro,4,,"disp_object_model_3d_safe (WindowHandle, ObjectModel3DID, CamParam, [0, 0, 11, 30, 40, 0, 0], [], [])
disp_message (WindowHandle, '3D Object Model of a Cube', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",54,60,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_object_model_3..."
0ac7abce,micro,5,,"create_cube_shape_model_3d (WindowHandle, ObjectModel3DID, CamParam, ShapeModel3DID)
Scores1 := []
Scores2 := []
Times1 := []
Times2 := []
Longitudes := []
Latitude := rad(45)
Distance := 11.5
dev_set_color ('green')
dev_set_line_width (2)
for Longitude := rad(30) to rad(60) by rad(0.25)
convert_poi...",61,117,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
X := [-1, -1, 1, 1..."
0ac7abce,micro,6,,"dev_clear_window ()
Title := ['\'recompute_score\'=\'false\'', '\'recompute_score\'=\'true\'']
Colors := ['yellow', 'green']
plot_tuple (WindowHandle, Longitudes, [Scores1,Scores2], 'Longitude [deg]', 'Matching score', Colors, ['ticks_x', 'ticks_y', 'end_y'], [6, .01, 1])
disp_message (WindowHandle,...",118,193,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
X := [-1, -1, 1, 1..."
0ac7abce,micro,7,"If this fails, it creates a new 3D shape model.","dev_clear_window ()
disp_message (WindowHandle, 'Reading the 3D shape model file from disk ...', 'window', 12, 12, 'white', 'false')
file_exists ('cube.sm3', FileExists)
if (FileExists)
read_shape_model_3d ('cube.sm3', ShapeModel3DID)
dev_clear_window ()
disp_message (WindowHandle, 'Reading the 3D s...",194,252,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_object_model_3..."
80c8c6dd,full,0,"This basic example shows how to use the procedure
debug_find_surface_model
to inspect and debug the ...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_box_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.103, 0.082, 0.05, OM3DBox)
triangulate_object_model_3d (OM3DBox, 'greedy', [], [], OM3DModel, Information)
FileName := 'box_edge_supported.sfm'
file_exists (FileName, FileExi...",13,95,
80c8c6dd,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)",11,15,
80c8c6dd,micro,2,,"gen_box_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.103, 0.082, 0.05, OM3DBox)
triangulate_object_model_3d (OM3DBox, 'greedy', [], [], OM3DModel, Information)",16,19,
80c8c6dd,micro,3,,"FileName := 'box_edge_supported.sfm'
file_exists (FileName, FileExists)
if (not FileExists)
dev_disp_text ('Creating new surface model. This might take some minutes...', 'window', 'top', 'left', 'black', [], [])
create_surface_model (OM3DModel, 0.05, ['train_3d_edges', 'train_view_based'], ['true', ...",20,39,"* --- Automatically Added Context ---
triangulate_object_model_3d (OM3DBox, 'greedy', [], [], OM3DModel, Information)
* --- End of Automatically Added Context ---"
80c8c6dd,micro,4,,"find_surface_model (SurfaceModel, OM3DScene, 0.05, 0.2, 0, 'true', [], [], Poses, Scores, ResultHandle)
dev_clear_window ()
dev_display (ZScene)
dev_disp_text ('find_surface_model has completed. Next, the debug procedure will be started,\nwhich allows inspection and debugging of the parameters.', 'w...",40,48,"* --- Automatically Added Context ---
create_surface_model (OM3DModel, 0.05, ['train_3d_edges', 'train_view_based'], ['true', 'true'], SurfaceModel)
decompose3 (ImageXYZ, XScene, YScene, ZScene)
xyz_t..."
80c8c6dd,micro,5,,"debug_find_surface_model (SurfaceModel, OM3DModel, OM3DScene, ResultHandle, CreateNames, CreateValues, FindNames, FindValues)",49,51,"* --- Automatically Added Context ---
triangulate_object_model_3d (OM3DBox, 'greedy', [], [], OM3DModel, Information)
create_surface_model (OM3DModel, 0.05, ['train_3d_edges', 'train_view_based'], ['t..."
80c8c6dd,micro,6,"now contain the parameters that were set within the procedure.
Pass those to create_surface_model an...","dev_clear_window ()
convert_tuple_to_string (CreateNames, CreateNamesStr)
convert_tuple_to_string (CreateValues, CreateValuesStr)
convert_tuple_to_string (FindNames, FindNamesStr)
convert_tuple_to_string (FindValues, FindValuesStr)
FindMsg := ['create_surface_model:','  GenParamName: ' + CreateNames...",52,113,"* --- Automatically Added Context ---
debug_find_surface_model (SurfaceModel, OM3DModel, OM3DScene, ResultHandle, CreateNames, CreateValues, FindNames, FindValues)
* --- End of Automatically Added Con..."
bbee5ea3,full,0,"***********************************************************************
Example for Surface-Based 3D...","dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()
read_image (Image, ImagePath + 'engine_cover_xyz_01')
decompose3 (Image, Xm, Ym, Zm)
threshold (Zm, ModelZ, 0, 650)
connection (ModelZ, ConnectedModel)
select_obj (ConnectedModel, ModelROI, [10, 9])
unio...",23,136,
bbee5ea3,micro,1,,"dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()",22,27,
bbee5ea3,micro,2,,"read_image (Image, ImagePath + 'engine_cover_xyz_01')
decompose3 (Image, Xm, Ym, Zm)",32,34,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
* --- End of Automatically Added Context ---"
bbee5ea3,micro,3,,"threshold (Zm, ModelZ, 0, 650)",35,36,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
bbee5ea3,micro,4,,"connection (ModelZ, ConnectedModel)",37,38,"* --- Automatically Added Context ---
threshold (Zm, ModelZ, 0, 650)
* --- End of Automatically Added Context ---"
bbee5ea3,micro,5,,"select_obj (ConnectedModel, ModelROI, [10, 9])
union1 (ModelROI, ModelROI)",39,41,"* --- Automatically Added Context ---
connection (ModelZ, ConnectedModel)
* --- End of Automatically Added Context ---"
bbee5ea3,micro,6,,"reduce_domain (Xm, ModelROI, Xm)",42,44,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_obj (ConnectedModel, ModelROI, [10, 9])
* --- End of Automatically Added Context ---"
bbee5ea3,micro,7,,"dev_open_window_fit_image (Zm, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Zm)
dev_set_line_width (2)
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (ModelROI)
disp_message (WindowHandle, 'Create surface model from XYZ image regi...",45,57,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_obj (ConnectedModel, ModelROI, [10, 9])
* --- End of Automatically Added Context ---"
bbee5ea3,micro,8,,"xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
create_surface_model (ObjectModel3DModel, 0.03, [], [], SFM)",58,61,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
bbee5ea3,micro,9,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
Message := 'Surface model'
visualize_object_model_3d (WindowHandle, ObjectModel3DModel, [], [], [], [], Message, [], Instructions, PoseOut)",62,69,"* --- Automatically Added Context ---
dev_open_window_fit_image (Zm, 0, 0, -1, -1, WindowHandle)
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
* --- End of Automatically Added Context ---"
bbee5ea3,micro,10,"Online-Phase: Match the reference object in 3D scenes
**********************************************...","NumImages := 10
for Index := 2 to NumImages by 1
read_image (Image, ImagePath + 'engine_cover_xyz_' + Index$'02')
decompose3 (Image, X, Y, Z)
threshold (Z, SceneGood, 0, 666)
reduce_domain (X, SceneGood, XReduced)
xyz_to_object_model_3d (XReduced, Y, Z, ObjectModel3DSceneReduced)
count_seconds (T0)
...",70,142,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
read_image (Image, ImagePath + 'engine_cover_xyz_01')
dev_open_window_fit_image (Zm, 0, 0, -1, -1, WindowHandle)
xyz_to_object_mode..."
515b4a4d,full,0,"***********************************************************************
Example for surface-based 3D...","dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()
read_image (Image, ImagePath + 'engine_cover_noisy_xyz_01')
decompose3 (Image, Xm, Ym, Zm)
threshold (Zm, RegionGood, 1e-30, 1)
reduce_domain (Zm, RegionGood, Zm)
median_image (Zm, ZmMedian, 'circle', 2....",22,184,
515b4a4d,micro,1,,"dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()",21,26,
515b4a4d,micro,2,,"read_image (Image, ImagePath + 'engine_cover_noisy_xyz_01')
decompose3 (Image, Xm, Ym, Zm)",31,33,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
* --- End of Automatically Added Context ---"
515b4a4d,micro,3,,"threshold (Zm, RegionGood, 1e-30, 1)
reduce_domain (Zm, RegionGood, Zm)",34,36,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
515b4a4d,micro,4,,"median_image (Zm, ZmMedian, 'circle', 2.5, 'mirrored')",37,38,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
515b4a4d,micro,5,,"threshold (ZmMedian, RegionsModel, 0.422, 0.529)
threshold (ZmMedian, RegionsModel, 0.422, 0.529)
connection (RegionsModel, ConnectedModel)
select_shape (ConnectedModel, ModelROI, ['area', 'holes_num'], 'and', [1500, 1], [1e30, 1])",39,43,"* --- Automatically Added Context ---
median_image (Zm, ZmMedian, 'circle', 2.5, 'mirrored')
* --- End of Automatically Added Context ---"
515b4a4d,micro,6,,"reduce_domain (Xm, ModelROI, Xm)",44,46,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_shape (ConnectedModel, ModelROI, ['area', 'holes_num'], 'and', [1500, 1], [1e30, 1])
* --- End of Automatically Added Contex..."
515b4a4d,micro,7,,"get_image_size (Zm, Width, Height)
dev_open_window (0, 0, Width * 4, Height * 4, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Zm)
dev_set_line_width (2)
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (ModelROI)
disp_message (WindowHand...",47,60,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_shape (ConnectedModel, ModelROI, ['area', 'holes_num'], 'and', [1500, 1], [1e30, 1])
* --- End of Automatically Added Contex..."
515b4a4d,micro,8,,"xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)",61,62,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
515b4a4d,micro,9,,"connection_object_model_3d (ObjectModel3DModel, 'distance_3d', 0.005, ObjectModel3DConnected)
select_object_model_3d (ObjectModel3DConnected, 'num_points', 'and', 1000, 1e30, ObjectModel3DSelected)",63,65,"* --- Automatically Added Context ---
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
* --- End of Automatically Added Context ---"
515b4a4d,micro,10,,"surface_normals_object_model_3d (ObjectModel3DSelected, 'mls', [], [], ObjectModel3DModel)",66,67,"* --- Automatically Added Context ---
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
select_object_model_3d (ObjectModel3DConnected, 'num_points', 'and', 1000, 1e30, ObjectModel3DSelected)
* ..."
515b4a4d,micro,11,,"create_surface_model (ObjectModel3DModel, 0.03, 'model_invert_normals', 'true', SFM)",68,70,"* --- Automatically Added Context ---
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
* --- End of Automatically Added Context ---"
515b4a4d,micro,12,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
Message := 'Surface model'
visualize_object_model_3d (WindowHandle, ObjectModel3DModel, [], [], ['point_size', 'disp_normals'], [2, 'true'], Message, [], Instruc...",71,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * 4, Height * 4, 'black', WindowHandle)
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
* --- End of Automatically Added Cont..."
515b4a4d,micro,13,"Online-Phase: Match the reference object in 3D scenes
**********************************************...","ContainsNum := [2, 2, 1, 3, 3, 2]
for Index := 2 to 7 by 1
read_image (Image, ImagePath + 'engine_cover_noisy_xyz_' + Index$'02')
decompose5 (Image, X, Y, Z, Confidence, Intensity)
threshold (Confidence, Region1, 0, 16000)
reduce_domain (Confidence, Region1, Confidence)
reduce_domain (Intensity, Reg...",79,190,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
read_image (Image, ImagePath + 'engine_cover_noisy_xyz_01')
dev_open_window (0, 0, Width * 4, Height * 4, 'black', WindowHandle)
xy..."
95c16880,full,0,"***********************************************************************
Example for restricting the ...","dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()
dev_open_window_fit_size (0, 0, 176, 144, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
read_image (Image, ImagePath + 'engine_cover_xyz_01')
decompose3 (Image, Xm, Y...",16,116,
95c16880,micro,1,,"dev_update_off ()
gen_empty_obj (EmptyObject)
ImagePath := 'time_of_flight/'
dev_close_window ()
dev_open_window_fit_size (0, 0, 176, 144, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",15,22,
95c16880,micro,2,,"read_image (Image, ImagePath + 'engine_cover_xyz_01')
decompose3 (Image, Xm, Ym, Zm)",27,29,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
* --- End of Automatically Added Context ---"
95c16880,micro,3,,"threshold (Zm, ModelZ, 0, 650)",30,31,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
95c16880,micro,4,,"connection (ModelZ, ConnectedModel)",32,33,"* --- Automatically Added Context ---
threshold (Zm, ModelZ, 0, 650)
* --- End of Automatically Added Context ---"
95c16880,micro,5,,"select_obj (ConnectedModel, ModelROI, [10, 9])
union1 (ModelROI, ModelROI)",34,36,"* --- Automatically Added Context ---
connection (ModelZ, ConnectedModel)
* --- End of Automatically Added Context ---"
95c16880,micro,6,,"reduce_domain (Xm, ModelROI, Xm)",37,39,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_obj (ConnectedModel, ModelROI, [10, 9])
* --- End of Automatically Added Context ---"
95c16880,micro,7,,"dev_display (Zm)
dev_set_line_width (2)
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (ModelROI)
dev_disp_text ('Create surface model from XYZ image region.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', []...",40,50,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
select_obj (ConnectedModel, ModelROI, [10, 9])
* --- End of Automatically Added Context ---"
95c16880,micro,8,,"xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
create_surface_model (ObjectModel3DModel, 0.03, [], [], SFM)",51,54,"* --- Automatically Added Context ---
decompose3 (Image, Xm, Ym, Zm)
* --- End of Automatically Added Context ---"
95c16880,micro,9,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'",55,59,
95c16880,micro,10,"Acquire scene.
***************************************
Load the XYZ Images.","Index := 7
read_image (Image, ImagePath + 'engine_cover_xyz_' + Index$'02')
decompose3 (Image, X, Y, Z)",64,70,"* --- Automatically Added Context ---
ImagePath := 'time_of_flight/'
read_image (Image, ImagePath + 'engine_cover_xyz_01')
* --- End of Automatically Added Context ---"
95c16880,micro,11,the speed and robustness of the surface-based matching.,"threshold (Z, SceneGood, 0, 666)
reduce_domain (X, SceneGood, XReduced)
xyz_to_object_model_3d (XReduced, Y, Z, ObjectModel3DSceneReduced)",71,76,"* --- Automatically Added Context ---
decompose3 (Image, X, Y, Z)
* --- End of Automatically Added Context ---"
95c16880,micro,12,"Matching without pose restriction.
***************************************","count_seconds (T0)
find_surface_model (SFM, ObjectModel3DSceneReduced, 0.05, 0.3, 0.2, 'true', 'num_matches', 10, Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeForMatchingNoRestriction := (T1 - T0) * 1000
rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DModelFound)
...",77,87,"* --- Automatically Added Context ---
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
create_surface_model (ObjectModel3DModel, 0.03, [], [], SFM)
decompose3 (Image, X, Y, Z)
xyz_to_object_mod..."
95c16880,micro,13,,"Title := 'Detecting all poses (no pose restriction)'
Title[1] := 'Time for matching: ' + TimeForMatchingNoRestriction$'.3' + ' ms'
visualize_object_model_3d (WindowHandle, [ObjectModel3DScene,ObjectModel3DModelFound], [], [], ['colored', 'color_0'], [12, 'gray'], Title, [], Instructions, PoseOut)",88,92,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 176, 144, -1, -1, WindowHandle)
Instructions[0] := 'Rotate: Left button'
TimeForMatchingNoRestriction := (T1 - T0) * 1000
rigid_tr..."
95c16880,micro,14,"Matching with pose restriction.
***************************************","dev_clear_window ()
Text := 'Restricting pose range to allow only poses '
Text[1] := 'that are similar to the original position.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
set_surface_model_param (SFM, 'pose_restriction_reference_pose', [0, 0, 0, 0, 0, 0, 0])",93,100,"* --- Automatically Added Context ---
create_surface_model (ObjectModel3DModel, 0.03, [], [], SFM)
* --- End of Automatically Added Context ---"
95c16880,micro,15,,"set_surface_model_param (SFM, 'pose_restriction_max_angle_diff', rad(45))
count_seconds (T0)
find_surface_model (SFM, ObjectModel3DSceneReduced, 0.05, 0.3, 0.2, 'true', 'num_matches', 10, Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeForMatchingWithRestriction := (T1 - T0) * 1000
rigi...",101,111,"* --- Automatically Added Context ---
xyz_to_object_model_3d (Xm, Ym, Zm, ObjectModel3DModel)
create_surface_model (ObjectModel3DModel, 0.03, [], [], SFM)
decompose3 (Image, X, Y, Z)
xyz_to_object_mod..."
95c16880,micro,16,,"Title := 'Detecting all poses (with pose restriction)'
Title[1] := 'Time for matching without restriction: ' + TimeForMatchingNoRestriction$'.3' + ' ms'
Title[2] := 'Time for matching with restriction: ' + TimeForMatchingWithRestriction$'.3' + ' ms'
visualize_object_model_3d (WindowHandle, [ObjectMo...",112,122,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 176, 144, -1, -1, WindowHandle)
Instructions[0] := 'Rotate: Left button'
TimeForMatchingNoRestriction := (T1 - T0) * 1000
Title :=..."
01a17f8d,full,0,"***********************************************************************
Example for surface-based 3D...","dev_update_off ()
dev_close_window ()
initialize_visualization (WindowHandle1, WindowHandle2, Instructions)
write_description_text (WindowHandle1)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()
read_object_model_3d ('gear', 'm', [], [], Model, Status)
FileName := 'gear_self_similar_p...",19,508,
01a17f8d,micro,1,,"dev_update_off ()
dev_close_window ()
initialize_visualization (WindowHandle1, WindowHandle2, Instructions)
write_description_text (WindowHandle1)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()
read_object_model_3d ('gear', 'm', [], [], Model, Status)",18,29,
01a17f8d,micro,2,almost symmetric objects in a robust and accurate way.,"FileName := 'gear_self_similar_poses.sfm'
file_exists (FileName, FileExists)
if (not FileExists)
write_description_text_2 (WindowHandle1)
create_surface_model (Model, 0.03, ['model_invert_normals', 'train_self_similar_poses'], ['true', 'true'], SurfaceModelID)
write_surface_model (SurfaceModelID, Fi...",30,64,"* --- Automatically Added Context ---
initialize_visualization (WindowHandle1, WindowHandle2, Instructions)
read_object_model_3d ('gear', 'm', [], [], Model, Status)
* --- End of Automatically Added C..."
01a17f8d,micro,3,,"for SceneIdx := 1 to 3 by 1
read_image (ImageCombined, 'gears/gears_' + SceneIdx$'02')
select_obj (ImageCombined, Image, 1)
select_obj (ImageCombined, XYZ, 2)
decompose3 (XYZ, X, Y, Z)
xyz_attrib_to_object_model_3d (X, Y, Z, Image, '&amp;gray', Scene)
if (1 == SceneIdx)
visualize_object_model_3d (Wi...",65,133,"* --- Automatically Added Context ---
initialize_visualization (WindowHandle1, WindowHandle2, Instructions)
read_object_model_3d ('gear', 'm', [], [], Model, Status)
create_surface_model (Model, 0.03,..."
01a17f8d,micro,4,,"get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
get_object_model_3d_params (OM3DScene, 'point_coord_y', YCoords)
get_object_model_3d_params (OM3DScene, 'point_coord_z', ZCoords)",146,149,
01a17f8d,micro,5,,"get_object_model_3d_params (OM3DScene, 'mapping_row', Rows)
get_object_model_3d_params (OM3DScene, 'mapping_col', Columns)",150,152,"* --- Automatically Added Context ---
get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
* --- End of Automatically Added Context ---"
01a17f8d,micro,6,,"get_object_model_3d_params (OM3DScene, 'mapping_size', MappingSize)
Width := MappingSize[0]
Height := MappingSize[1]
gen_cam_par_area_scan_division (0.012, 0, 5.2e-006, 5.2e-006, Width / 2, Height / 2, Width, Height, CameraParamStart)
CameraPoseStart := [0, 0, 0, 0, 0, 0, 0]",153,158,"* --- Automatically Added Context ---
get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
* --- End of Automatically Added Context ---"
01a17f8d,micro,7,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, [XCoords,YCoords,ZCoords])
set_calib_data_cam_param (CalibDataID, 0, 'area_scan_division', CameraParamStart)
set_calib_data_observ_points (CalibDataID, 0, 0, 0, Rows, Columns, 'all', CameraPoseSt...",159,263,"* --- Automatically Added Context ---
String := 'Pre-created model found. Reading...'
estimate_camera_parameters (SceneReference, CameraParam, CameraPose)
get_object_model_3d_params (OM3DScene, 'point..."
01a17f8d,micro,8,,"SubStringEnumGap := []
TableAlphabetical := ['a)', 'b)', 'c)', 'd)', 'e)', 'f)', 'e)', 'g)', 'h)', 'i)', 'j)']
TableRoman := ['i)', 'ii)', 'iii)', 'iv)', 'v)', 'vi)', 'vii)', 'viii)', 'ix)', 'x)', 'xi)']
GapsRoman := [' ', '', '', '', ' ', '', '', '', '', ' ', '']
Check := []
for k := 0 to |StringOu...",264,539,"* --- Automatically Added Context ---
initialize_visualization (WindowHandle1, WindowHandle2, Instructions)
String := 'Pre-created model found. Reading...'
select_obj (ImageCombined, Image, 1)
Width :..."
2bc27e8c,full,0,"This example shows how to use the view-based score computation in
surface-based matching.
In order t...","dev_close_window ()
dev_open_window (0, 0, 800, 260, 'black', WindowHandle1)
dev_update_off ()
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
LineLength :...",18,120,
2bc27e8c,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 800, 260, 'black', WindowHandle1)
dev_update_off ()
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
LineLength :...",17,27,
2bc27e8c,micro,2,,"read_object_model_3d ('pipe_joint.ply', 'm', [], [], ObjectModel3D, Status)
dev_disp_intro_text ()
stop ()",28,32,
2bc27e8c,micro,3,Enable the calculation of the view-based score for the model.,"dev_clear_window ()
dev_disp_text ('Creating new surface model.\nThis might take some seconds...', 'window', 'top', 'left', 'white', 'box', 'false')
create_surface_model (ObjectModel3D, 0.05, 'train_view_based', 'true', SurfaceModelID)",33,38,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint.ply', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
2bc27e8c,micro,4,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'First, let\'s have a look at the 3D data of the scene. \n\n\nThe pipe joints are not entirely visible in the scene. Some pipe joints appear to be occluded because other joints are partially covering them or because the sensor could only acq...",39,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 260, 'black', WindowHandle1)
Instructions := 'Rotate: Left button'
LineLength := 70
* --- End of Automatically Added Context ---"
2bc27e8c,micro,5,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Since only few scene points can be matched to corresponding model points, the overall score is very small if no view-based information is considered. Especially, if the surface of the object in the search scene is fragmented, e.g., because ...",52,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 260, 'black', WindowHandle1)
LineLength := 70
Text := 'First, let\'s have a look at the 3D data of the scene. \n\n\nThe pipe joints ar..."
2bc27e8c,micro,6,,"find_surface_model (SurfaceModelID, ObjectModel3DScene, 0.05, 0.2, 0.15, 'true', ['num_matches', 'use_view_based'], [7, 'false'], Pose, Score, SurfaceMatchingResultID)",58,59,"* --- Automatically Added Context ---
create_surface_model (ObjectModel3D, 0.05, 'train_view_based', 'true', SurfaceModelID)
read_object_model_3d ('pipe_joint_scene', 'm', [], [], ObjectModel3DScene, ..."
2bc27e8c,micro,7,,"rigid_trans_object_model_3d (ObjectModel3D, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DRigidTrans], [], VisPose, VisParamNames, VisParamValues, 'Using the conventional surface score, leads to very low values.', ['',Score$'.2f'], Instruct...",60,63,"* --- Automatically Added Context ---
Instructions := 'Rotate: Left button'
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red', 'gray', 0.5, 1]
read_object_model_3d ('p..."
2bc27e8c,micro,8,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Considering the maximum number of points that are possibly visible from the current viewpoint instead of all model points increases the score drastically. \n\nNote that MinScore has been adapted such that the \'surface_score\' has been set ...",64,72,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 260, 'black', WindowHandle1)
LineLength := 70
Text := 'First, let\'s have a look at the 3D data of the scene. \n\n\nThe pipe joints ar..."
2bc27e8c,micro,9,,"find_surface_model (SurfaceModelID, ObjectModel3DScene, 0.05, 0.2, 0.15, 'true', 'num_matches', 5, PoseViewBased, ScoreViewBased, SurfaceMatchingResultID)",73,75,"* --- Automatically Added Context ---
create_surface_model (ObjectModel3D, 0.05, 'train_view_based', 'true', SurfaceModelID)
read_object_model_3d ('pipe_joint_scene', 'm', [], [], ObjectModel3DScene, ..."
2bc27e8c,micro,10,,"rigid_trans_object_model_3d (ObjectModel3D, PoseViewBased, ObjectModel3DRigidTrans)
VisParamValues[0] := 'forest green'
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DRigidTrans], [], [], VisParamNames, VisParamValues, 'The view-based score leads to much higher values.', ...",76,130,"* --- Automatically Added Context ---
Instructions := 'Rotate: Left button'
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red', 'gray', 0.5, 1]
read_object_model_3d ('p..."
bb9f7cda,full,0,"Example for edge-supported surface-based matching
This example demonstrates how to use edge-supporte...","dev_update_off ()
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
get_cam_par_data (CameraParam, 'image_width', Width)
get_cam_par_data (CameraParam, 'image_height', Height)
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraPose)
MinScor...",13,323,
bb9f7cda,micro,1,"matching. I shows, how to cope with edges stemming from the boundary
of the scene, how to speed up t...",dev_update_off (),8,14,
bb9f7cda,micro,2,,"gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
get_cam_par_data (CameraParam, 'image_width', Width)
get_cam_par_data (CameraParam, 'image_height', Height)",15,18,
bb9f7cda,micro,3,,"create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraPose)",19,20,
bb9f7cda,micro,4,,MinScore := 0.2,21,22,
bb9f7cda,micro,5,,"create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red', 'white', 0.5, 1]
WidthW1 := 400
LineLength := 32
VisRowNextStep := 300
VisInstructions[0] := 'Rotate: Left button'
VisInstructions[1] := ...",23,32,"* --- Automatically Added Context ---
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraPose)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,6,,"dev_close_window ()
dev_open_window_fit_size (0, WidthW1 + 10, Width, Height, 640, 480, WindowHandle2)
get_window_extents (WindowHandle2, Row, Column, WidthW2, HeightW2)
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
se...",33,40,"* --- Automatically Added Context ---
get_cam_par_data (CameraParam, 'image_width', Width)
get_cam_par_data (CameraParam, 'image_height', Height)
WidthW1 := 400
* --- End of Automatically Added Contex..."
bb9f7cda,micro,7,,"SceneIdx := 4
read_image (Image, 'boxes/cardboard_boxes_02')",41,44,
bb9f7cda,micro,8,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'This example demonstrates edge-supported surface-based matching. The goal is to find cardboard boxes in 3D scans of the scene.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', 'top', 'left', 'black', 'box', '...",45,53,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window_fit_size (0, WidthW1 + 10, Width, Height, 640, 480, WindowHandle2)
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandl..."
bb9f7cda,micro,9,,"dev_set_window (WindowHandle1)
gen_box_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.103, 0.082, 0.05, ObjectModel3DBox)
triangulate_object_model_3d (ObjectModel3DBox, 'greedy', [], [], ObjectModel3DModel, Information)",54,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,10,,"FileName := 'box_edge_supported.sfm'
file_exists (FileName, FileExists)
if (not FileExists)
dev_disp_text ('Creating new surface model.\nThis might take some minutes...', 'window', 150, 'left', 'black', 'box', 'false')
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', 'true', Surface...",58,69,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DBox, 'greedy', [], [], ObjectModel3DModel, Information)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,11,,"read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_02')
decompose3 (ImageXYZ, XScene, YScene, ZScene)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectModel3DScene)
prepare_object_model_3d (ObjectModel3DScene, 'segmentation', 'true', [], [])
get_object_model_3d_params (ObjectModel3DScene, 'center...",70,76,
bb9f7cda,micro,12,,"dev_set_window (WindowHandle1)
Text := 'First, let\'s have a look at the 3D data of the scene.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', VisRowNextStep, 'left', 'black', 'box', 'false')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",77,89,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
LineLength := 32
VisRowNextStep := 300
VisInstructions[0] := 'Rotate: Left button'
..."
bb9f7cda,micro,13,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Objects with a planar surface are sometimes found incorrectly if no edge information is used. Especially, if the surface of the object in the search scene is fragmented, e.g., because of reflections on the surface.'
wrap_text (Text, LineLen...",90,95,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,14,,"find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', ['num_matches', 'use_3d_edges'], [1, 'false'], Pose, Score, SurfaceMatchingResult)",96,97,"* --- Automatically Added Context ---
MinScore := 0.2
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', 'true', SurfaceModel)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectMode..."
bb9f7cda,micro,15,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DRigidTrans], [], VisPose, VisParamNames, VisParamValues, 'Without edge support, a wrong match is found.', [], VisInstructions, VisPose)",98,101,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,16,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'In those cases, the use of 3D edges (displayed in green) helps to find the correct match. Note that \'num_matches\' has been set to 1, therefore only one box is found.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, '...",102,110,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,17,,"find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', 'num_matches', 1, Pose, Score, SurfaceMatchingResult)",111,112,"* --- Automatically Added Context ---
MinScore := 0.2
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', 'true', SurfaceModel)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectMode..."
bb9f7cda,micro,18,,"get_object_model_3d_params (ObjectModel3DScene, 'diameter_axis_aligned_bounding_box', Diameter)
edges_object_model_3d (ObjectModel3DScene, 0.01 * Diameter, [], [], ObjectModel3DEdges)",113,115,"* --- Automatically Added Context ---
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectModel3DScene)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,19,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
VisParamValues[0] := 'forest green'
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DEdges,ObjectModel3DRigidTrans], [], VisPose, [VisParamNames,'color_1'], [VisParamValues,'green'], 'With edge ...",116,120,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,20,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'If we search for more than one match, the second box is found as well.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', 'top', 'left', 'black', 'box', 'false')
Text := 'Note that additional matches may also b...",121,129,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,21,,"find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', 'num_matches', 5, Pose, Score, SurfaceMatchingResult)",130,131,"* --- Automatically Added Context ---
MinScore := 0.2
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', 'true', SurfaceModel)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectMode..."
bb9f7cda,micro,22,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DEdges,ObjectModel3DRigidTrans], [], VisPose, [VisParamNames,'color_1', 'color_4'], [VisParamValues,'green', 'red'], 'The boundaries of the scene ...",132,135,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,23,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'We can eliminate the 3D edges stemming from the boundary of the scene (displayed in red) to avoid the additional matches in the corners of the scene.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', 'top', 'l...",136,141,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,24,,"Border := 50
object_model_3d_to_xyz (XEdges, YEdges, ZEdges, ObjectModel3DEdges, 'from_xyz_map', [], [])
get_image_size (XEdges, WidthMapping, HeightMapping)
select_points_object_model_3d (ObjectModel3DEdges, ['mapping_row', 'mapping_col'], [Border,Border], [HeightMapping - Border,WidthMapping - Bor...",142,146,"* --- Automatically Added Context ---
edges_object_model_3d (ObjectModel3DScene, 0.01 * Diameter, [], [], ObjectModel3DEdges)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,25,,"visualize_object_model_3d (WindowHandle2, [ObjectModel3DEdgesWithoutBorder,ObjectModel3DEdges], [], VisPose, ['color_0', 'color_1'], ['green', 'red'], 'Scene edges with removed edges at the boundary', [], VisInstructions, VisPose)",147,149,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisInstructions[0] := 'Rotate: Left button'
dev_open_window_fit_size (0, WidthW1 + ..."
bb9f7cda,micro,26,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Without the edges at the boundary of the scene, no additional matches are found in the corners of the scene.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', 'top', 'left', 'black', 'box', 'false')
Text := 'Y...",150,158,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,27,,"find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', ['num_matches', '3d_edges'], [5,ObjectModel3DEdgesWithoutBorder], Pose, Score, SurfaceMatchingResult)",159,160,"* --- Automatically Added Context ---
MinScore := 0.2
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', 'true', SurfaceModel)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectMode..."
bb9f7cda,micro,28,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [ObjectModel3DScene,ObjectModel3DEdgesWithoutBorder,ObjectModel3DRigidTrans], [], VisPose, [VisParamNames,'color_1'], [VisParamValues,'green'], 'Matching result with cropped edge...",161,164,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,29,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'An even better way to avoid matches in the background plane is to completely remove the background plane from the scene.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWrapped, 'window', 'top', 'left', 'black', 'box', 'false'...",165,173,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,30,,"select_points_object_model_3d (ObjectModel3DScene, 'point_coord_z', 0.1, 0.73, SceneWithoutBackground)",174,175,"* --- Automatically Added Context ---
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectModel3DScene)
* --- End of Automatically Added Context ---"
bb9f7cda,micro,31,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [SceneWithoutBackground,ObjectModel3DScene], [], VisPose, ['color_0', 'color_1', 'alpha_1'], ['white', 'red', 0.5], 'Scene and removed background', [], VisInstructions, VisPose)
...",176,181,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisInstructions[0] := 'Rotate: Left button'
dev_open_window_fit_size (0, WidthW1 + ..."
bb9f7cda,micro,32,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Without the background plane of the scene, no additional matches are found in the corners of the scene. Furthermore, the matching is significantly faster if the background has been removed from the scene.'
wrap_text (Text, LineLength, TextW...",182,188,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,33,,"Num := 5
count_seconds (S1)
for I := 1 to Num by 1
find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', 'num_matches', 3, Pose, Score, SurfaceMatchingResult)
endfor
count_seconds (S2)
TimeWithBackground := (S2 - S1) / real(Num) * 1000.0
count_seconds (S1)
for I := 1 to...",189,207,"* --- Automatically Added Context ---
MinScore := 0.2
Text := 'This example demonstrates edge-supported surface-based matching. The goal is to find cardboard boxes in 3D scans of the scene.'
create_su..."
bb9f7cda,micro,34,,"edges_object_model_3d (SceneWithoutBackground, 0.01 * Diameter, [], [], ObjectModel3DEdgesWithoutBackground)
rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [SceneWithoutBackground,ObjectModel3DEdgesWithoutBackground,ObjectMod...",208,212,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,35,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'Further speedup is possible, if the points in the search scene are dense compared to the size of the object, i.e., if the pose refinement has to use a large number of points.'
wrap_text (Text, LineLength, TextWrapped)
dev_disp_text (TextWra...",213,222,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,36,,"Num := 5
count_seconds (S1)
for I := 1 to Num by 1
find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1, MinScore, 'false', ['num_matches', 'pose_ref_sub_sampling'], [3, 20], Pose, Score, SurfaceMatchingResult)
endfor
count_seconds (S2)
TimeWithBackgroundPoseRefSubSampling := (S2 - S1) / ...",223,245,"* --- Automatically Added Context ---
MinScore := 0.2
Text := 'This example demonstrates edge-supported surface-based matching. The goal is to find cardboard boxes in 3D scans of the scene.'
create_su..."
bb9f7cda,micro,37,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)
visualize_object_model_3d (WindowHandle2, [SceneWithoutBackground,ObjectModel3DEdgesWithoutBackground,ObjectModel3DRigidTrans], [], VisPose, [VisParamNames,'color_1'], [VisParamValues,'green'], 'Matching result in scene ...",246,249,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,38,,"dev_set_window (WindowHandle1)
dev_clear_window ()
Text := 'You can even use image data to improve the matching results. This is especially helpful if the 3D edges from the scene are blurry or distorted. The typically better defined image edges improve the matching accuracy.'
wrap_text (Text, LineLe...",250,258,"* --- Automatically Added Context ---
LineLength := 32
dev_open_window (0, 0, WidthW1, HeightW2, 'white', WindowHandle1)
Text := 'This example demonstrates edge-supported surface-based matching. The g..."
bb9f7cda,micro,39,,"set_surface_model_param (SurfaceModel, 'camera_parameter', CameraParam)
set_surface_model_param (SurfaceModel, 'camera_pose', CameraPose)
find_surface_model_image (Image, SurfaceModel, SceneWithoutBackground, 0.05, 0.1, MinScore, 'true', ['num_matches', 'pose_ref_sub_sampling'], [5, 20], Pose, Score...",259,262,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraP..."
bb9f7cda,micro,40,,"rigid_trans_object_model_3d (ObjectModel3DModel, Pose, ObjectModel3DRigidTrans)",263,264,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DBox, 'greedy', [], [], ObjectModel3DModel, Information)
find_surface_model (SurfaceModel, ObjectModel3DScene, 0.05, 0.1,..."
bb9f7cda,micro,41,,"object_model_3d_to_xyz (X, Y, Z, SceneWithoutBackground, 'from_xyz_map', [], [])
get_domain (Z, Domain)
get_region_points (Domain, Rows, Columns)
get_grayval (Image, Rows, Columns, AttribValues)",265,269,"* --- Automatically Added Context ---
read_image (Image, 'boxes/cardboard_boxes_02')
select_points_object_model_3d (ObjectModel3DScene, 'point_coord_z', 0.1, 0.73, SceneWithoutBackground)
* --- End of..."
bb9f7cda,micro,42,,"set_object_model_3d_attrib_mod (SceneWithoutBackground, '&amp;gray', 'points', AttribValues)
visualize_object_model_3d (WindowHandle2, [SceneWithoutBackground,ObjectModel3DEdgesWithoutBackground,ObjectModel3DRigidTrans], [], VisPose, [VisParamNames,'color_1', 'color_attrib_0'], [VisParamValues,'gree...",270,272,"* --- Automatically Added Context ---
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisPose)
VisParamNames := ['color', 'color_0', 'alpha', 'alpha_0']
VisParamValues := ['red',..."
bb9f7cda,micro,43,,"set_window_param (WindowHandle2, 'flush', 'false')
dev_set_lut ('cubic_root')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (Image)
dev_disp_text ('Matching results projected into the image', 'window', 'top', 'left', 'black', [], [])
for Index := 0 to |Score| - 1 by 1
CurrPose := Pose[7...",273,333,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
dev_open_window_fit_size (0, WidthW1 + 10, Width, Height, 640,..."
2f753c42,full,0,"Simple example for edge-supported surface-based matching.
This example demonstrates how to use edge-...","dev_update_off ()
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraPose)
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisualizationPose)
get_cam_par_data (CameraPa...",11,154,
2f753c42,micro,1,"matching, with and without images.",dev_update_off (),8,12,
2f753c42,micro,2,,"gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)",13,14,
2f753c42,micro,3,,"create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraPose)
create_pose (-0.075, -0.56, 4.4, 308, 6, 335, 'Rp+T', 'gba', 'point', VisualizationPose)
get_cam_par_data (CameraParam, 'image_width', Width)
get_cam_par_data (CameraParam, 'image_height', Height)
dev_close_window ()
dev_open_window ...",15,28,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
* --- End of Automatically Added Context ---"
2f753c42,micro,4,,"gen_box_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.103, 0.082, 0.05, ObjectModel3DBox)
triangulate_object_model_3d (ObjectModel3DBox, 'greedy', [], [], ObjectModel3DModel, Information)",29,31,
2f753c42,micro,5,,"FileName := 'box_edge_supported.sfm'
file_exists (FileName, FileExists)
if (not FileExists)
dev_disp_text ('No pre-created model found.\nCreating new surface model.\nThis may take some minutes...', 'window', 60, 12, 'black', [], [])
create_surface_model (ObjectModel3DModel, 0.03, 'train_3d_edges', '...",32,45,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DBox, 'greedy', [], [], ObjectModel3DModel, Information)
* --- End of Automatically Added Context ---"
2f753c42,micro,6,,"for SceneIdx := 1 to 4 by 1
read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + SceneIdx$'02d')
decompose3 (ImageXYZ, XScene, YScene, ZScene)
xyz_to_object_model_3d (XScene, YScene, ZScene, ObjectModel3DScene)
read_image (Image, 'boxes/cardboard_boxes_' + SceneIdx$'02d')
if (SceneIdx == 1)
dev_set_...",46,178,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.003, -22215.7, 1e-6, 1e-6, 629.3, 486.95, 1280, 960, CameraParam)
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', CameraP..."
964c31c4,full,0,"This example shows how the symmetry of 3D object models
can be used to speed up the surface-based ma...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_cylinder_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 1, -4, 0, Cylinder)
sample_object_model_3d (Cylinder, 'fast_compute_normals', 0.02, [], [], ...",18,98,
964c31c4,micro,1,"(1) A cylinder with a continuous symmetry.
(2) An object with a non-continuous, five-fold symmetry.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",14,22,
964c31c4,micro,2,,"gen_cylinder_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 1, -4, 0, Cylinder)",23,24,
964c31c4,micro,3,,"sample_object_model_3d (Cylinder, 'fast_compute_normals', 0.02, [], [], CylinderSampled)
convex_hull_object_model_3d (CylinderSampled, CylinderTriangulated)
disp_object_model_3d (WindowHandle, CylinderTriangulated, [], [1, 1, 80, 210, 30, 0, 0], 'disp_pose', 'true')
Text := 'Using find_surface_model...",25,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_cylinder_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 1, -4, 0, Cylinder)
* --- End of Automatically Added ..."
964c31c4,micro,4,,"count_seconds (T0)
find_surface_model (SurfaceModelID, CylinderSampled, 0.05, 1, 0, 'false', [], [], Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeNoSymmetry := (T1 - T0) * 1000",35,40,"* --- Automatically Added Context ---
sample_object_model_3d (Cylinder, 'fast_compute_normals', 0.02, [], [], CylinderSampled)
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
* --..."
964c31c4,micro,5,,"set_surface_model_param (SurfaceModelID, 'symmetry_axis_direction', [0, 0, 1])",41,43,"* --- Automatically Added Context ---
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
* --- End of Automatically Added Context ---"
964c31c4,micro,6,,"count_seconds (T0)
find_surface_model (SurfaceModelID, CylinderSampled, 0.05, 1, 0, 'false', [], [], Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeWithSymmetry := (T1 - T0) * 1000
Text[2] := 'Without symmetry: ' + TimeNoSymmetry + ' ms'
Text[3] := 'With symmetry: ' + TimeWithSymmetry ...",44,54,"* --- Automatically Added Context ---
sample_object_model_3d (Cylinder, 'fast_compute_normals', 0.02, [], [], CylinderSampled)
Text := 'Using find_surface_model to find a cylinder'
create_surface_mode..."
964c31c4,micro,7,,"read_object_model_3d ('car_rim', 'm', [], [], CarRim, Status)
dev_clear_window ()
disp_object_model_3d (WindowHandle, CarRim, [], [0.01, 0.01, 1.5, 210, 30, 0, 0], 'disp_pose', 'true')
Text := 'Using find_surface_model to find the object'
Text[1] := 'with and without symmetry information.'
dev_disp_...",55,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Text := 'Using find_surface_model to find a cylinder'
create_surface_model (CylinderSampled, 0.03, [], [],..."
964c31c4,micro,8,,"get_surface_model_param (SurfaceModelID, 'diameter', Diameter)
sample_object_model_3d (CarRim, 'fast_compute_normals', Diameter * 0.01, [], [], CarRimSampled)",65,68,"* --- Automatically Added Context ---
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
read_object_model_3d ('car_rim', 'm', [], [], CarRim, Status)
* --- End of Automatically Adde..."
964c31c4,micro,9,,"count_seconds (T0)
find_surface_model (SurfaceModelID, CarRimSampled, 0.05, 1, 0, 'false', [], [], Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeNoSymmetry := (T1 - T0) * 1000",69,74,"* --- Automatically Added Context ---
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
TimeNoSymmetry := (T1 - T0) * 1000
count_seconds (T0)
find_surface_model (SurfaceModelID, Cyl..."
964c31c4,micro,10,"The object is identical if rotated around the z-axis with
360/5 = 72 degrees","set_surface_model_param (SurfaceModelID, 'symmetry_poses', [0, 0, 0, 0, 0,360.0 / 5,0])",75,79,"* --- Automatically Added Context ---
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
* --- End of Automatically Added Context ---"
964c31c4,micro,11,,"count_seconds (T0)
find_surface_model (SurfaceModelID, CarRimSampled, 0.05, 1, 0, 'false', [], [], Pose, Score, SurfaceMatchingResultID)
count_seconds (T1)
TimeWithSymmetry := (T1 - T0) * 1000
Text[2] := 'Without symmetry: ' + TimeNoSymmetry + ' ms'
Text[3] := 'With symmetry: ' + TimeWithSymmetry + ...",80,92,"* --- Automatically Added Context ---
Text := 'Using find_surface_model to find a cylinder'
create_surface_model (CylinderSampled, 0.03, [], [], SurfaceModelID)
find_surface_model (SurfaceModelID, Cyl..."
964c31c4,micro,12,,"rigid_trans_object_model_3d (CarRim, [0, 0, 0, 0, 0,360.0 / 5,0], ObjectModel3DRigidTrans)
Title := 'Note that the object is identical '
Title[1] := 'when transformed with the symmetry pose'
Title[2] := '[0,0,0, 0,0,360.0/5, 0].'
visualize_object_model_3d (WindowHandle, [CarRim,ObjectModel3DRigidTra...",93,104,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
read_object_model_3d ('car_rim', 'm', [], [], CarRim, Status)
* --- End of Automatically Added Context ---"
de84c15f,full,0,"This example program shows how to use the operators
gen_plane_object_model_3d, gen_sphere_object_mod...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_pose (0.1, 1.5, 88, 106, 337, 224, 'Rp+T', 'gba', 'point', PoseIn)
gen_circle_contour_xld (ContCircle, 200, 200, 100, 0, 6.28318, 'positiv...",14,45,
de84c15f,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_pose (0.1, 1.5, 88, 106, 337, 224, 'Rp+T', 'gba', 'point', PoseIn)
gen_circle_contour_xld (ContCircle, 200, 200, 100, 0, 6.28318, 'positiv...",13,23,
de84c15f,micro,2,,"gen_plane_object_model_3d ([0, 0, 0, 0, 0, 0, 0], [], [], ObjectModel3DPlane1)",24,25,
de84c15f,micro,3,,"gen_plane_object_model_3d ([1, 1, 1, 0, 50, 30, 0], X, Y, ObjectModel3DPlane2)",26,27,"* --- Automatically Added Context ---
X := 3 * Row / max([Row,Column]) - 2
Y := 3 * Column / max([Row,Column]) - 2
get_contour_xld (ContCircle, Row, Column)
* --- End of Automatically Added Context --..."
de84c15f,micro,4,,"gen_sphere_object_model_3d ([0, 0, 3, 0, 0, 0, 0], 0.5, ObjectModel3DSphere1)",28,29,
de84c15f,micro,5,,"gen_sphere_object_model_3d_center (-1, 0, 1, 1, ObjectModel3DSphere2)",30,31,
de84c15f,micro,6,,"gen_cylinder_object_model_3d ([1, -1, 2, 0, 0, 60, 0], 0.5, -1, 1, ObjectModel3DCylinder)",32,33,
de84c15f,micro,7,,"gen_box_object_model_3d ([-1, 2, 1, 0, 0, 90, 0], 1, 2, 1, ObjectModel3DBox)",34,36,
de84c15f,micro,8,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
ObjectModels := [ObjectModel3DPlane1,ObjectModel3DCylinder,ObjectModel3DSphere1,ObjectModel3DSphere2,ObjectModel3DPlane2,ObjectModel3DBox]
Labels := ['Plane1', '...",37,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
create_pose (0.1, 1.5, 88, 106, 337, 224, 'Rp+T', 'gba', 'point', PoseIn)
gen_plane_object_model_3d ([0, 0..."
da5915e0,full,0,"This example shows how to use the operator read_object_model_3d
with 'file_type' 'generic_ascii'.
Th...","dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
FileName := '../../../3d_models/mvtec_logo.xyz'
FileFormat := dict{}
FileFormat.separator := ' '
FileFormat.columns := ['', 'point_coord_x', 'point_coord_y', 'point_coord_z']
read_object_model_3d (FileName, 'm', ['fi...",13,103,
da5915e0,micro,1,"with 'file_type' 'generic_ascii'.
This format can be used to read different ASCII files
containing 3...","dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)",6,15,
da5915e0,micro,2,"Example 1: .xyz file                                          *
************************************...","FileName := '../../../3d_models/mvtec_logo.xyz'
FileFormat := dict{}",16,25,
da5915e0,micro,3,whitespaces.,FileFormat.separator := ' ',26,29,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,4,"element (which we skip when reading the file)
X coordinate
Y coordinate
Z coordinate","FileFormat.columns := ['', 'point_coord_x', 'point_coord_y', 'point_coord_z']",30,36,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,5,"content from the first to the last line, we must not set the
parameters 'comment', 'first_point_line...","read_object_model_3d (FileName, 'm', ['file_type', 'ascii_format'], ['generic_ascii',FileFormat], ObjectModel3D, Status)",37,42,"* --- Automatically Added Context ---
FileName := '../../../3d_models/mvtec_logo.xyz'
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,6,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
visualize_object_model_3d (WindowHandle, ObjectModel3D, [], [], [], [], 'Read XYZ coordinates', [], Instructions, PoseOut)",43,48,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
read_object_model_3d (FileName, 'm', ['file_type', 'ascii_format'], ['generic_ascii',FileFormat], ..."
da5915e0,micro,7,"Example 2: .pts file                                          *
************************************...","FileName := '../../../3d_models/mvtec_logo.pts'
FileFormat := dict{}",49,59,"* --- Automatically Added Context ---
FileName := '../../../3d_models/mvtec_logo.xyz'
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,8,X coordinate,FileFormat.columns[0] := 'point_coord_x',64,66,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,9,,FileFormat.columns[1] := 'point_coord_y',67,68,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,10,,FileFormat.columns[2] := 'point_coord_z',69,70,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,11,'&amp;intensity'),FileFormat.columns[3] := '&amp;intensity',71,73,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,12,attribute 'red'),FileFormat.columns[4] := 'red',74,76,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,13,extended attribute 'green'),FileFormat.columns[5] := 'green',77,79,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,14,extended attribute 'blue'),FileFormat.columns[6] := 'blue',80,83,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,15,,"open_file (FileName, 'input', FileHandleIn)
fread_line (FileHandleIn, OutLine, IsEOF1)
close_file (FileHandleIn)
ExpectedNumPoints := number(split(OutLine,'\n'))",85,90,"* --- Automatically Added Context ---
FileName := '../../../3d_models/mvtec_logo.xyz'
* --- End of Automatically Added Context ---"
da5915e0,micro,16,,FileFormat.first_point_line := 2,91,92,"* --- Automatically Added Context ---
FileFormat := dict{}
* --- End of Automatically Added Context ---"
da5915e0,micro,17,points.,"FileFormat.last_point_line := 2 + ExpectedNumPoints - 1
read_object_model_3d (FileName, 'm', ['file_type', 'ascii_format'], ['generic_ascii',FileFormat], ObjectModel3D, Status)",93,98,"* --- Automatically Added Context ---
FileName := '../../../3d_models/mvtec_logo.xyz'
read_object_model_3d (FileName, 'm', ['file_type', 'ascii_format'], ['generic_ascii',FileFormat], ObjectModel3D, S..."
da5915e0,micro,18,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
visualize_object_model_3d (WindowHandle, ObjectModel3D, [], [], ['intensity_red', 'intensity_green', 'intensity_blue'], ['red', 'green', 'blue'], 'Read XYZ coord...",99,109,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instruct..."
0e4cb14d,full,0,"This example program shows how to use the operators
set_object_model_3d_attrib and set_object_model_...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size', 'disp_lines', 'attribute_0', 'color_0'...",20,91,
0e4cb14d,micro,1,"object model are set. Second, the triangles and the color is
set. Third, the coordinates of a 3d obj...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size', 'disp_lines', 'attribute_0', 'color_0'...",13,30,
0e4cb14d,micro,2,,gen_empty_object_model_3d (ObjectModel3D),31,33,
0e4cb14d,micro,3,point in one plane.,"PointCoordX := [0.5, 0, 1, 1, 0, 0, 1, 1, 0] - 0.5
PointCoordY := [0, 1, 1, 1, 1, 0, 0, 0, 0] - 0.5
PointCoordZ := [0.5, 0, 0, 1, 1, 0, 0, 1, 1] - 0.5
set_object_model_3d_attrib_mod (ObjectModel3D, ['point_coord_x', 'point_coord_y', 'point_coord_z'], [], [PointCoordX,PointCoordY,PointCoordZ])",34,40,"* --- Automatically Added Context ---
gen_empty_object_model_3d (ObjectModel3D)
* --- End of Automatically Added Context ---"
0e4cb14d,micro,4,,"visualize_object_model_3d (WindowHandle, ObjectModel3D, [], DisplayPose, VisualParamNames, VisualParamValues, 'Define a cube by point coordinates', [], Instructions, DisplayPose)",41,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
0e4cb14d,micro,5,point of the 3D object model.,"T1 := [0, 8, 5]
T2 := [0, 7, 8]
T3 := [0, 6, 7]
T4 := [0, 5, 6]
T5 := [5, 6, 2]
T6 := [5, 2, 1]
T7 := [6, 7, 3]
T8 := [6, 3, 2]
T9 := [7, 3, 4]
T10 := [7, 4, 8]
T11 := [8, 4, 1]
T12 := [8, 1, 5]
T13 := [2, 3, 4]
T14 := [2, 4, 1]
set_object_model_3d_attrib (ObjectModel3D, 'triangles', [], [T1,T2,T3,T...",44,61,"* --- Automatically Added Context ---
gen_empty_object_model_3d (ObjectModel3D)
* --- End of Automatically Added Context ---"
0e4cb14d,micro,6,,"visualize_object_model_3d (WindowHandle, [ObjectModel3D2,ObjectModel3D2], [], DisplayPose, VisualParamNames, VisualParamValues, 'Connect points to triangles', [], Instructions, DisplayPose)",62,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
0e4cb14d,micro,7,,"PointCoordY[0, 3, 6, 7] := [-1, 0.3, -.8, -.3]
set_object_model_3d_attrib_mod (ObjectModel3D2, 'point_coord_y', [], PointCoordY)",65,68,"* --- Automatically Added Context ---
PointCoordY := [0, 1, 1, 1, 1, 0, 0, 0, 0] - 0.5
set_object_model_3d_attrib (ObjectModel3D, 'triangles', [], [T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11,T12,T13,T14], Obj..."
0e4cb14d,micro,8,,"visualize_object_model_3d (WindowHandle, [ObjectModel3D2,ObjectModel3D2], [], DisplayPose, VisualParamNames, VisualParamValues, 'Modify some point coordiantes', [], Instructions, DisplayPose)",69,71,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
0e4cb14d,micro,9,to visualize the distance from the plane.,"gen_plane_object_model_3d ([0, .55, 0, 90, 0, 0, 0], [-1, -1, 1, 1], [-1, 1, 1, -1], PlaneOM3D)
distance_object_model_3d (ObjectModel3D2, PlaneOM3D, [], 0, [], [])
VisualParamNames2 := [VisualParamNames,'color_attrib_0', 'color_attrib_1', 'color_0', 'color_1', 'color_2']
VisualParamValues2 := [Visua...",72,79,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
0e4cb14d,micro,10,a copy of ObjectModel3D2.,"remove_object_model_3d_attrib (ObjectModel3D2, '&amp;distance', ObjectModel3D3)
VisualParamNames2 := [VisualParamNames,'color_0', 'color_1', 'color_2']
VisualParamValues2 := [VisualParamValues,'yellow', 'orange', 'blue']
visualize_object_model_3d (WindowHandle, [ObjectModel3D3,ObjectModel3D3,PlaneOM...",80,86,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
0e4cb14d,micro,11,,"remove_object_model_3d_attrib_mod (ObjectModel3D3, 'triangles')
VisualParamNames2 := [VisualParamNames,'color_0', 'color_1']
VisualParamValues2 := [VisualParamValues,'yellow', 'blue']
visualize_object_model_3d (WindowHandle, [ObjectModel3D3,PlaneOM3D], [], DisplayPose, VisualParamNames2, VisualParam...",87,97,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
create_pose (0, 0, 40, 30, 60, 15, 'Rp+T', 'gba', 'point', DisplayPose)
VisualParamNames := ['point_size',..."
8ed9a279,full,0,"Object models e.g., acquired with a 3D sensor can have an object
coordinate system, that is not alig...","dev_close_window ()
FontSize := 14
WindowSize := 500
dev_open_window (0, 0, WindowSize, WindowSize, 'white', WindowHandle1)
set_display_font (WindowHandle1, FontSize, 'mono', 'true', 'false')
GenParamName := ['lut', 'color_attrib', 'light_position', 'disp_pose', 'alpha']
GenParamValue := ['color1', ...",26,136,
8ed9a279,micro,1,,"dev_close_window ()
FontSize := 14
WindowSize := 500
dev_open_window (0, 0, WindowSize, WindowSize, 'white', WindowHandle1)
set_display_font (WindowHandle1, FontSize, 'mono', 'true', 'false')",25,31,
8ed9a279,micro,2,"A lookup table (lut) is set that transforms attribute values into
a color. In this example the color...","GenParamName := ['lut', 'color_attrib', 'light_position', 'disp_pose', 'alpha']
GenParamValue := ['color1', 'coord_z', '0.0 0.0 -0.3 1.0', 'true', 0.9]",32,38,
8ed9a279,micro,3,,Scale2Millimeter := 1000,39,40,
8ed9a279,micro,4,,"read_object_model_3d ('cutting_edge.om3', 'm', [], [], ObjectModel3D, Status)",41,42,
8ed9a279,micro,5,,"create_pose (-0.0005, -0.0005, 0.04, 280, 0, 20, 'Rp+T', 'gba', 'point', DispPose1)
create_pose (0, -0.0005, 0.04, 280, 0, 20, 'Rp+T', 'gba', 'point', DispPose2)",43,46,
8ed9a279,micro,6,,"Information := 'This example shows how an object coordinate'
Information[1] := 'system can be aligned with the data given by'
Information[2] := 'a 3D object model.'
Information[3] := ' '
Information[4] := 'This may be useful, e.g., to align a cutting'
Information[5] := 'edge in a way that the x-axis...",47,58,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowSize, WindowSize, 'white', WindowHandle1)
* --- End of Automatically Added Context ---"
8ed9a279,micro,7,"The original coordinate axes are not aligned with the main axes
of the data. The object coordinate s...","dev_set_window (WindowHandle1)
dev_clear_window ()
WindowTitle := 'The coordinate axes of the object model are'
WindowTitle[1] := 'not aligned with the main axes of the model.'
WindowTitle[2] := 'The coloring of the model shows that points'
WindowTitle[3] := 'along the top ridge of the object have '...",59,79,"* --- Automatically Added Context ---
FontSize := 14
WindowSize := 500
dev_open_window (0, 0, WindowSize, WindowSize, 'white', WindowHandle1)
GenParamName := ['lut', 'color_attrib', 'light_position', ..."
8ed9a279,micro,8,"the principal axes coordinate system with respect to
the original coordinate system of the 3D object...","moments_object_model_3d (ObjectModel3D, 'principal_axes', Pose)",85,90,"* --- Automatically Added Context ---
read_object_model_3d ('cutting_edge.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
8ed9a279,micro,9,"coordinate system.
For transforming the points of the 3D object model into the
principal axes coordi...","pose_invert (Pose, PoseInvert)
pose_to_hom_mat3d (PoseInvert, HomMat3D)
affine_trans_object_model_3d (ObjectModel3D, HomMat3D, ObjectModel3DPCA)",91,98,"* --- Automatically Added Context ---
read_object_model_3d ('cutting_edge.om3', 'm', [], [], ObjectModel3D, Status)
moments_object_model_3d (ObjectModel3D, 'principal_axes', Pose)
* --- End of Automat..."
8ed9a279,micro,10,"These moments correspond to the variances in x, y, z and the
covariances xy, xz and yz.","moments_object_model_3d (ObjectModel3D, 'central_moment_2_points', Moments)",99,102,"* --- Automatically Added Context ---
read_object_model_3d ('cutting_edge.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
8ed9a279,micro,11,,MomentsSecondOrderOrig := Moments[0:2] * (Scale2Millimeter * Scale2Millimeter),103,104,"* --- Automatically Added Context ---
Scale2Millimeter := 1000
moments_object_model_3d (ObjectModel3D, 'central_moment_2_points', Moments)
* --- End of Automatically Added Context ---"
8ed9a279,micro,12,,"moments_object_model_3d (ObjectModel3DPCA, 'central_moment_2_points', MomentsPCA)",105,106,"* --- Automatically Added Context ---
affine_trans_object_model_3d (ObjectModel3D, HomMat3D, ObjectModel3DPCA)
* --- End of Automatically Added Context ---"
8ed9a279,micro,13,,MomentsSecondOrderPCA := MomentsPCA[0:2] * (Scale2Millimeter * Scale2Millimeter),107,109,"* --- Automatically Added Context ---
Scale2Millimeter := 1000
moments_object_model_3d (ObjectModel3DPCA, 'central_moment_2_points', MomentsPCA)
* --- End of Automatically Added Context ---"
8ed9a279,micro,14,,"WindowTitle := 'The 3D object model was transformed into its'
WindowTitle[1] := 'principal axes system. The object model is'
WindowTitle[2] := 'now aligned with the coordinate axes.'",110,113,"* --- Automatically Added Context ---
WindowTitle := 'The coordinate axes of the object model are'
WindowTitle[2] := 'The coloring of the model shows that points'
* --- End of Automatically Added Cont..."
8ed9a279,micro,15,"the old and in the new object coordinate system.
For the principal axes system, it can be seen that
...","OldVariance[0] := 'Variances in original system:'
OldVariance[1] := ' '
OldVariance[2] := '  Var(x) = ' + MomentsSecondOrderOrig[0]$'.3f' + ' mm²'
OldVariance[3] := '  Var(y) = ' + MomentsSecondOrderOrig[1]$'.3f' + ' mm²'
OldVariance[4] := '  Var(z) = ' + MomentsSecondOrderOrig[2]$'.3f' + ' mm²'",114,124,"* --- Automatically Added Context ---
Scale2Millimeter := 1000
moments_object_model_3d (ObjectModel3D, 'central_moment_2_points', Moments)
MomentsSecondOrderOrig := Moments[0:2] * (Scale2Millimeter * ..."
8ed9a279,micro,16,,"NewVariance[0] := 'Variances in new system:'
NewVariance[1] := ' '
NewVariance[2] := '  Var(x) = ' + MomentsSecondOrderPCA[0]$'.3f' + ' mm²'
NewVariance[3] := '  Var(y) = ' + MomentsSecondOrderPCA[1]$'.3f' + ' mm²'
NewVariance[4] := '  Var(z) = ' + MomentsSecondOrderPCA[2]$'.3f' + ' mm²'
disp_object...",125,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowSize, WindowSize, 'white', WindowHandle1)
GenParamName := ['lut', 'color_attrib', 'light_position', 'disp_pose', 'alpha']
GenParamVal..."
ea05d7aa,full,0,"************************************************************
This example program shows how to use t...","dev_update_off ()
dev_close_window ()
ImagePath := 'time_of_flight/'
read_image (Image, ImagePath + 'engine_cover_xyz_01')
scale_image (Image, Image, .001, .0)
zoom_image_factor (Image, Image, 2, 2, 'constant')
decompose3 (Image, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
prepare_obj...",16,114,
ea05d7aa,micro,1,"This example program shows how to use the operators
connection_object_model_3d and select_object_mod...","dev_update_off ()
dev_close_window ()",6,17,
ea05d7aa,micro,2,,"ImagePath := 'time_of_flight/'
read_image (Image, ImagePath + 'engine_cover_xyz_01')
scale_image (Image, Image, .001, .0)
zoom_image_factor (Image, Image, 2, 2, 'constant')
decompose3 (Image, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)",18,24,
ea05d7aa,micro,3,,"prepare_object_model_3d (ObjectModel3DID, 'segmentation', 'true', [], [])",25,27,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
* --- End of Automatically Added Context ---"
ea05d7aa,micro,4,,"create_pose (0.058, -0.165, 0.660, 345.0, 355.0, 356.0, 'Rp+T', 'gba', 'point', Pose)",28,30,
ea05d7aa,micro,5,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'",31,34,
ea05d7aa,micro,6,,"gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 352, 288, 710, 576, CamParam)
GenParamName := ['color', 'disp_pose', 'alpha']
GenParamValue := ['green', 'false', 0.8]
dev_open_window (0, 0, 710, 576, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
visualize_o...",35,44,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
create_pose (0.058, -0.165, 0.660, 345.0, 355.0, 356.0, 'Rp+T', 'gba', 'point', Pose)
Instructions[0] := 'Rotate..."
ea05d7aa,micro,7,,"MinValue := 0.500
MaxValue := 0.670
select_points_object_model_3d (ObjectModel3DID, 'point_coord_z', MinValue, MaxValue, ObjectModel3DIDReduced)
visualize_object_model_3d (WindowHandle, ObjectModel3DIDReduced, CamParam, Pose, GenParamName, GenParamValue, 'Result after thresholding at z=' + (MaxValue...",45,50,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
create_pose (0.058, -0.165, 0.660, 345.0, 355.0, 356.0, 'Rp+T', 'gba', 'point', Pose)
Instructions[0] := 'Rotate..."
ea05d7aa,micro,8,of each of the resulting object,"GenParamName[0] := 'colored'
GenParamValue[0] := 12
connection_object_model_3d (ObjectModel3DIDReduced, 'distance_3d', 0.010, ObjectModel3DIDConnections)
volume_object_model_3d_relative_to_plane (ObjectModel3DIDConnections, [0, 0,MaxValue,0, 0, 0, 0], 'signed', 'true', Volume)
max_diameter_object_mo...",51,58,"* --- Automatically Added Context ---
GenParamName := ['color', 'disp_pose', 'alpha']
GenParamValue := ['green', 'false', 0.8]
MaxValue := 0.670
select_points_object_model_3d (ObjectModel3DID, 'point_..."
ea05d7aa,micro,9,,"dev_open_window (0, 720, 400, 576, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
Indices := [0:|ObjectModel3DIDConnections| - 1]
disp_message (WindowHandle1, ['Features of the connected components:', ' ', ' '], 'window', 12, 12, 'white', 'false')
ResultMessage...",59,70,"* --- Automatically Added Context ---
create_pose (0.058, -0.165, 0.660, 345.0, 355.0, 356.0, 'Rp+T', 'gba', 'point', Pose)
Instructions[0] := 'Rotate: Left button'
gen_cam_par_area_scan_division (0.0..."
ea05d7aa,micro,10,,"MinVolume := 0.35e-003
MaxVolume := 1.0e-003
MinDiameter := 185.0e-003
MaxDiameter := 300.0e-003",71,76,
ea05d7aa,micro,11,"select_object_model_3d uses the plane [0,0,0,0,0,0]
for the volume calculation! Therefore we have
to...","hom_mat3d_identity (HomMat3DIdentity)
hom_mat3d_translate (HomMat3DIdentity, 0, 0, -MaxValue, HomMat3DTranslation)
hom_mat3d_invert (HomMat3DTranslation, HomMat3DInvert)
affine_trans_object_model_3d (ObjectModel3DIDConnections, HomMat3DTranslation, ObjectModel3DTranslated)",77,87,"* --- Automatically Added Context ---
MaxValue := 0.670
connection_object_model_3d (ObjectModel3DIDReduced, 'distance_3d', 0.010, ObjectModel3DIDConnections)
* --- End of Automatically Added Context -..."
ea05d7aa,micro,12,,"for Index := 0 to |ObjectModel3DIDConnections| - 1 by 1
set_object_model_3d_attrib_mod (ObjectModel3DTranslated[Index], '&amp;Index', [], Index)
endfor
volume_object_model_3d_relative_to_plane (ObjectModel3DTranslated, [0, 0, 0, 0, 0, 0, 0], 'signed', 'true', Volume1)
select_object_model_3d (ObjectM...",88,96,"* --- Automatically Added Context ---
connection_object_model_3d (ObjectModel3DIDReduced, 'distance_3d', 0.010, ObjectModel3DIDConnections)
MinVolume := 0.35e-003
MaxVolume := 1.0e-003
MinDiameter := ..."
ea05d7aa,micro,13,,"Label := []
for Index := 0 to |ObjectModel3DSelected| - 1 by 1
get_object_model_3d_params (ObjectModel3DSelected[Index], '&amp;Index', FormerIndex)
Label := [Label,'#' + FormerIndex]
endfor
if (|ObjectModel3DSelected| &gt; 1)
visualize_object_model_3d (WindowHandle, ObjectModel3DSelected, CamParam, ...",97,120,"* --- Automatically Added Context ---
create_pose (0.058, -0.165, 0.660, 345.0, 355.0, 356.0, 'Rp+T', 'gba', 'point', Pose)
Instructions[0] := 'Rotate: Left button'
gen_cam_par_area_scan_division (0.0..."
304931d2,full,0,"******************************************************************
This example program shows how to...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, [], [], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom...",13,40,
304931d2,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, [], [], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",12,17,
304931d2,micro,2,,"read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
gen_cam_par_area_scan_division (0.01, 0.0, 0.00001, 0.00001, 320, 240, 640, 480, CamParam...",18,31,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, [], [], WindowHandle)
* --- End of Automatically Added Context ---"
304931d2,micro,3,,"smallest_bounding_box_object_model_3d (ObjectModel3DAffineTrans, 'axis_aligned', PoseBox, Length1, Length2, Length3)
gen_box_object_model_3d (PoseBox, Length1, Length2, Length3, BoundingBoxes)
visualize_object_model_3d (WindowHandle, [ObjectModel3DAffineTrans,BoundingBoxes], CamParam, Pose, ['color_...",32,36,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, [], [], WindowHandle)
Instructions[0] := 'Rotate: Left button'
gen_cam_par_area_scan_division (0.01, 0.0, 0.00001, 0.000..."
304931d2,micro,4,,"smallest_bounding_box_object_model_3d (ObjectModel3DAffineTrans, 'oriented', PoseBoxOri, Length1Ori, Length2Ori, Length3Ori)
gen_box_object_model_3d (PoseBoxOri, Length1Ori, Length2Ori, Length3Ori, BoundingBoxesOriented)
visualize_object_model_3d (WindowHandle, [ObjectModel3DAffineTrans,BoundingBoxe...",37,46,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, [], [], WindowHandle)
Instructions[0] := 'Rotate: Left button'
gen_cam_par_area_scan_division (0.01, 0.0, 0.00001, 0.000..."
385ec3e9,full,0,"***********************************************************************
This example program shows h...","dev_update_off ()
dev_close_window ()
read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_02.tif')
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
access_channel (XYZ, X, 1)
access_channel (XYZ, Y, 2)
access_chan...",13,164,
385ec3e9,micro,1,"This example program shows how to use the operator
fit_object_model_3d in HALCON. First, the 2.5D in...","dev_update_off ()
dev_close_window ()",6,14,
385ec3e9,micro,2,,"read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_02.tif')
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",15,18,
385ec3e9,micro,3,,"access_channel (XYZ, X, 1)
access_channel (XYZ, Y, 2)
access_channel (XYZ, Z, 3)",19,22,"* --- Automatically Added Context ---
read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_02.tif')
* --- End of Automatically Added Context ---"
385ec3e9,micro,4,,"threshold (Z, Region, 0.0, 0.83)
reduce_domain (X, Region, XTmp)
dev_display (Z)
dev_set_draw ('margin')
dev_set_line_width (2)
dev_set_color ('green')
dev_display (Region)
disp_message (WindowHandle, 'Segment cylinder with a simple threshold', 'window', 12, 12, 'black', 'true')
disp_continue_messag...",23,33,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
access_channel (XYZ, X, 1)
access_channel (XYZ, Z, 3)
* --- End of Automatically Added Context ---"
385ec3e9,micro,5,,"xyz_to_object_model_3d (XTmp, Y, Z, ObjectModel3DID)
ParFitting := ['primitive_type', 'fitting_algorithm', 'output_xyz_mapping']
ValFitting := ['cylinder', 'least_squares_huber', 'true']",34,37,"* --- Automatically Added Context ---
access_channel (XYZ, Y, 2)
access_channel (XYZ, Z, 3)
reduce_domain (X, Region, XTmp)
* --- End of Automatically Added Context ---"
385ec3e9,micro,6,,"fit_primitives_object_model_3d (ObjectModel3DID, ParFitting, ValFitting, ObjectModel3DOutID)",38,39,"* --- Automatically Added Context ---
xyz_to_object_model_3d (XTmp, Y, Z, ObjectModel3DID)
ParFitting := ['primitive_type', 'fitting_algorithm', 'output_xyz_mapping']
ValFitting := ['cylinder', 'least..."
385ec3e9,micro,7,,"dev_display (Z)
dev_set_draw ('fill')
dev_display_fitting_results (RegionCylinder, RegionSphere, RegionPlane, RegionNone, ObjectModel3DOutID, WindowHandle, [])
dev_update_on ()",40,64,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
access_channel (XYZ, Z, 3)
fit_primitives_object_model_3d (ObjectModel3DID, ParFitting, ValFitting, Ob..."
385ec3e9,micro,8,"Color[0] is used for objects which could not be fitted
Color[1] is used for cylinders
Color[2] is us...","if (Colors == [])
Colors := ['dim gray', 'forest green', 'red', 'slate blue']
endif
NumNone := 0
NumCylinders := 0
NumSpheres := 0
NumPlanes := 0
for Index := 0 to |ObjectModel3DOutID| - 1 by 1
object_model_3d_to_xyz (XTmp, YTmp, ZTmp, ObjectModel3DOutID[Index], 'from_xyz_map', [], [])
get_domain (X...",69,178,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
reduce_domain (X, Region, XTmp)
fit_primitives_object_model_3d (ObjectModel3DID, ParFitting, ValFittin..."
04de6524,full,0,"************************************************************
This examples shows how to measure some...","dev_close_window ()
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
read_object_model_3d ('plant', 'm', [], [], Plant, Status)
select_points_object_model_3d (Plant, 'point_coord_z', 0, 0.607, ObjectModel3DThresholded)
select_points_...",20,267,
04de6524,micro,1,"This examples shows how to measure some features of plants *
in 3D.                                 ...","dev_close_window ()
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",7,24,
04de6524,micro,2,,"read_object_model_3d ('plant', 'm', [], [], Plant, Status)",25,27,
04de6524,micro,3,,"select_points_object_model_3d (Plant, 'point_coord_z', 0, 0.607, ObjectModel3DThresholded)
select_points_object_model_3d (ObjectModel3DThresholded, 'num_neighbors_fast 0.01', 100, 1e+10, PlantThresholded)
PoseVis := [0.434603, -0.334464, 2.41924, 255.878, 304.461, 240.131, 0]
visualize_object_model_...",28,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
read_object_model_3d ('plant', 'm', [], [], Plant, Status)
* --- End of Automatically Added Context ---"
04de6524,micro,4,"1. How to segment leaves *
**************************","segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)",35,40,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholded, 'num_neighbors_fast 0.01', 100, 1e+10, PlantThresholded)
* --- End of Automatically Added Context ---"
04de6524,micro,5,,"sample_object_model_3d (Leaves, 'fast', 0.001, [], [], LeavesSampled)
triangulate_object_model_3d (LeavesSampled, 'greedy', [], [], LeavesTriangulated, Information1)
visualize_object_model_3d (WindowHandle, [PlantThresholded,LeavesTriangulated], [], PoseVis, ['colored', 'alpha_0'], [12, 0.1], '1. Se...",41,46,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
select_points_object_model_3d (ObjectModel3DThresholded, 'num_neighbors_fast 0.01', 100, 1e+10, PlantThresh..."
04de6524,micro,6,,"get_object_model_3d_params (BBox, 'primitive_pose', BBoxPose)
pose_invert (BBoxPose, BBoxPoseInverted)
rigid_trans_object_model_3d (LeavesTriangulated, BBoxPoseInverted, LeavesTransTmp)
rigid_trans_object_model_3d (Trunk, BBoxPoseInverted, TrunkTransTmp)
rigid_trans_object_model_3d (LeavesTransTmp, ...",47,55,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
triangulate_object_model_3d (LeavesSampled, 'greedy', [], [], LeavesTria..."
04de6524,micro,7,,"dev_set_window (WindowHandle)
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'gray', WindowHandle1)
dev_open_window (0, 500, 500, 500, 'gray', WindowHandle2)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')",56,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
* --- End of Automatically Added Context ---"
04de6524,micro,8,"2. How to determine the angular distribution of leaves *
*******************************************...","for j := 8 to |LeavesTriangulated| - 1 by 1
get_object_model_3d_params (LeavesTrans[j], 'center', Center)
gen_object_model_3d_from_points (Center[0], Center[1], Center[2], ObjectModel3D)
X := Center[0]
Y := 0
Z := 0
gen_object_model_3d_from_points (X, Y, Z, ObjectModel3D3)
tuple_atan2 (Center[1], Ce...",65,100,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 800, 'gray', WindowHandle)
triangulate_object_model_3d (LeavesSampled, 'greedy', [], [], LeavesTriangulated, Information1)
rigid_trans..."
04de6524,micro,9,"3. How to estimate the area of leaves in metric units *
********************************************...","area_object_model_3d (LeavesTriangulated, Area)",101,106,"* --- Automatically Added Context ---
triangulate_object_model_3d (LeavesSampled, 'greedy', [], [], LeavesTriangulated, Information1)
* --- End of Automatically Added Context ---"
04de6524,micro,10,,"AreaF := Area * 10000
AreaF := AreaF$'0.1f'
PoseVis := [-0.0590142, -0.00151176, 2.56947, 0.0, 0.0, 0.0, 0]
visualize_object_model_3d (WindowHandle, [PlantThresholded,LeavesTriangulated], [], [], ['intensity_red', 'intensity_green', 'intensity_blue', 'alpha_0'], ['coord_x', 'coord_y', 'coord_z', 0.2...",107,112,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholded, 'num_neighbors_fast 0.01', 100, 1e+10, PlantThresholded)
PoseVis := [0.434603, -0.334464, 2.41924, 255.87..."
04de6524,micro,11,"4. How to estimate the diameter of the trunk *
**********************************************","smallest_bounding_box_object_model_3d (PlantThresholded, 'oriented', Pose1, Length11, Length21, Length31)
pose_invert (Pose, PoseInvert)
rigid_trans_object_model_3d (PlantThresholded, PoseInvert, ObjectModel3DRigidTrans)
DiameterAll := []
for k := 1 to 2 by 0.01
PoseShift := [0.01 * k,0, 0, 0, 90, 0...",113,130,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholded, 'num_neighbors_fast 0.01', 100, 1e+10, PlantThresholded)
segment_leaves_3d (PlantThresholded, Leaves, Pla..."
04de6524,micro,12,,"rigid_trans_object_model_3d ([LeavesTriangulated,Trunk], PoseInvert, ObjectModel3DRigidTransVis)
PoseVis := [-0.005, 0.03, 2, 0, 270, 80, 0]
tuple_gen_const (|LeavesTriangulated|, 0.2, Alpha)
tuple_gen_const (|LeavesTriangulated|, '', Dummy)
visualize_object_model_3d (WindowHandle, [ObjectModel3DRig...",131,138,"* --- Automatically Added Context ---
PoseVis := [0.434603, -0.334464, 2.41924, 255.878, 304.461, 240.131, 0]
visualize_object_model_3d (WindowHandle, PlantThresholded, [], PoseVis, ['intensity_red', ..."
04de6524,micro,13,"5. How to analyze angel of leaves *
***********************************","get_object_model_3d_params (PlanesCollected, 'primitive_pose', PosePlanes)",139,144,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
* --- End of Automatically Added Context ---"
04de6524,micro,14,,"sample_object_model_3d (PlanesCollected, 'fast', 0.001, [], [], SampledPlanes)",145,147,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
* --- End of Automatically Added Context ---"
04de6524,micro,15,,"moments_object_model_3d (SampledPlanes, 'principal_axis', Moments)",148,150,"* --- Automatically Added Context ---
sample_object_model_3d (PlanesCollected, 'fast', 0.001, [], [], SampledPlanes)
* --- End of Automatically Added Context ---"
04de6524,micro,16,,"dev_open_window (0, 800, 512, 512, 'gray', WindowHandle1)
dev_set_line_width (2)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')",151,155,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'gray', WindowHandle1)
* --- End of Automatically Added Context ---"
04de6524,micro,17,,"CamParam := ['area_scan_division', 1, 0, 1e-003, 1e-003,512 / 2,512 / 2,512, 512]
Pose3 := [2.14809e-011, -2.64974e-005, 0.117874, 0.0, 90.0, 0.0, 0]
for Index := 0 to |PlanesCollected| - 1 by 1
get_object_model_3d_params (LeavesTriangulated[Index], 'num_points', NumPoints)
if (NumPoints &gt; 500)
C...",156,236,"* --- Automatically Added Context ---
PoseVis := [0.434603, -0.334464, 2.41924, 255.878, 304.461, 240.131, 0]
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
..."
04de6524,micro,18,,"select_points_object_model_3d (ObjectModel3DThresholded1, 'num_neighbors_fast 0.002', 70, 1e+10, ObjectModel3DThresholded2)
connection_object_model_3d (ObjectModel3DThresholded2, 'distance_3d', 0.001, ObjectModel3DConnected)",237,240,
04de6524,micro,19,,"select_object_model_3d (ObjectModel3DConnected, 'diameter', 'and', 0.12, 1, ObjectModel3DSelected)",241,243,"* --- Automatically Added Context ---
connection_object_model_3d (ObjectModel3DThresholded2, 'distance_3d', 0.001, ObjectModel3DConnected)
* --- End of Automatically Added Context ---"
04de6524,micro,20,,"smallest_bounding_box_object_model_3d (ObjectModel3DSelected, 'oriented', Pose, Length1, Length2, Length3)
gen_box_object_model_3d (Pose, Length1 + 0.1, Length2, Length3, BBox)",244,247,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
select_object_model_3d (ObjectModel3DConnected, 'diameter', 'and', 0.12,..."
04de6524,micro,21,,"distance_object_model_3d (ObjectModel3DThresholded1, BBox, [], 0, 'signed_distances', 'true')
select_points_object_model_3d (ObjectModel3DThresholded1, '&amp;distance', 0.0015, 1, ObjectModel3DThresholded3)
select_points_object_model_3d (ObjectModel3DThresholded1, '&amp;distance', -1, -0.0001, Trunk...",248,252,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
select_points_object_model_3d (ObjectModel3DThresholded1, 'num_neighbors..."
04de6524,micro,22,,"connection_object_model_3d (ObjectModel3DThresholded3, 'distance_3d', 0.001, ObjectModel3DConnected1)
select_object_model_3d (ObjectModel3DConnected1, 'num_points', 'and', 500, 1e+10, ObjectModel3DSelected1)
ObjectsCollected := []
PlanesCollected := []
for i := 0 to |ObjectModel3DSelected1| - 1 by 1...",253,281,"* --- Automatically Added Context ---
segment_leaves_3d (PlantThresholded, Leaves, PlanesCollected, Trunk, BBox, Pose, Length1)
gen_plane_object_model_3d (PoseShift, [-1, 1, 1, -1] / 50.0, [-1, -1, 1,..."
74ca39c8,full,0,"********************************************************
This example program shows how to remove pa...","read_object_model_3d ('glass_mug', 'cm', [], [], ObjectModel3D, Status)
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e...",16,61,
74ca39c8,micro,1,,"read_object_model_3d ('glass_mug', 'cm', [], [], ObjectModel3D, Status)",15,17,
74ca39c8,micro,2,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 255, 768, 512, CamParam)
create_pose (-0.1e-3, -0.47e-3, 55.8e-...",18,32,
74ca39c8,micro,3,,"Title := 'Move and rotate the object to an appropriate pose, before'
Title[1] := 'selecting the region of the points to be trimmed off.'
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
dev_display (Ramp)
visua...",33,41,"* --- Automatically Added Context ---
read_object_model_3d ('glass_mug', 'cm', [], [], ObjectModel3D, Status)
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
gen_cam_par_area_scan_division (0...."
74ca39c8,micro,4,suitable region,"Message := 'Now draw region with the mouse to cut out part of the model'
Message[1] := '(Right click to finish)'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",42,46,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
74ca39c8,micro,5,,"dev_set_line_width (3)
dev_set_color ('red')
draw_region (Region, WindowHandle)
get_cam_par_data (CamParam, 'image_width', ImageWidth)
get_cam_par_data (CamParam, 'image_height', ImageHeight)
gen_rectangle1 (Rectangle, 0, 0, ImageHeight, ImageWidth)
difference (Rectangle, Region, RegionComplement)",47,54,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 255, 768, 512, CamParam)
* --- End of Automatica..."
74ca39c8,micro,6,,"reduce_object_model_3d_by_view (RegionComplement, ObjectModel3D, CamParam, Pose, ObjectModel3DReduced)",55,57,"* --- Automatically Added Context ---
read_object_model_3d ('glass_mug', 'cm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 255, 768, 512, CamParam)
create_..."
74ca39c8,micro,7,,"Title := 'Resulting reduced 3d object model'
dev_display (Ramp)
visualize_object_model_3d (WindowHandle, [ObjectModel3DReduced,ObjectModel3DReduced], CamParam, Pose, GenParamName, GenParamValue, Title, [], Instructions, Pose)",58,67,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 512, 'black', WindowHandle)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 255, 768, 512, CamParam)
create_pose (-0.1e-3, -..."
71778ce7,full,0,"This example shows how to reduce a 3D object model to the
triangles visible for a virtual camera wit...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
VisParam...",15,242,
71778ce7,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
VisParam...",14,23,
71778ce7,micro,2,,"read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
dev_disp_intro_text ()
stop ()",24,28,
71778ce7,micro,3,,"Width := 1280
Height := 1024",31,33,
71778ce7,micro,4,object model.,BorderFact := 1.1,34,36,
71778ce7,micro,5,,IsTelecentric := false,37,38,
71778ce7,micro,6,,"get_cam_par_and_pose (IsTelecentric, ObjectModel3D, BorderFact, Width, Height, PoseInit, CameraParam)",39,41,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
Width := 1280
Height := 1024
BorderFact := 1.1
IsTelecentric :=..."
71778ce7,micro,7,,"dev_open_window (505, 0, 600, 220, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_disp_visualization_3d_model ()",42,46,
71778ce7,micro,8,,"visualize_object_model_3d (WindowHandle1, ObjectModel3D, CameraParam, PoseInit, [], [], 'Object model to be reduced', [], Instructions, Pose)",47,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles',..."
71778ce7,micro,9,and pose.,"render_object_model_3d (Image1, ObjectModel3D, CameraParam, Pose, [], [])
dev_set_window (WindowHandle1)
dev_display (Image1)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_set_window (WindowHandle2)
dev_disp_visualization_rendered_model ()
stop ()",50,59,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
get_ca..."
71778ce7,micro,10,according to the chosen camera parameters and pose.,"object_model_3d_to_xyz (X, Y, Z, ObjectModel3D, 'cartesian_faces', CameraParam, Pose)",63,65,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
get_cam_par_and_pose (IsTelecentric, ObjectModel3D, BorderFact,..."
71778ce7,micro,11,,"xyz_to_object_model_3d (X, Y, Z, IntermediateObjectModel3D)",66,67,"* --- Automatically Added Context ---
object_model_3d_to_xyz (X, Y, Z, ObjectModel3D, 'cartesian_faces', CameraParam, Pose)
* --- End of Automatically Added Context ---"
71778ce7,micro,12,,"pose_invert (Pose, PoseInvert)
rigid_trans_object_model_3d (IntermediateObjectModel3D, PoseInvert, IntermediateObjectModel3D)
dev_set_window (WindowHandle2)
dev_disp_intermediate_model ()
visualize_object_model_3d (WindowHandle1, [IntermediateObjectModel3D,ObjectModel3D], CameraParam, Pose, VisParam...",68,74,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNames := ['color_0', 'color_1', 'alpha']
VisParamValues := ..."
71778ce7,micro,13,the intermediate object model.,"distance_object_model_3d (IntermediateObjectModel3D, ObjectModel3D, [], 0, ['distance_to', 'store_closest_index'], ['triangles', 'true'])",77,79,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
xyz_to_object_model_3d (X, Y, Z, IntermediateObjectModel3D)
* -..."
71778ce7,micro,14,,"get_object_model_3d_params (IntermediateObjectModel3D, '&amp;closest_index', ClosestTriangleIndex)
tuple_sort (ClosestTriangleIndex, ClosestTriangleIndex)
tuple_uniq (ClosestTriangleIndex, ClosestTriangleIndexUniq)",80,83,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, IntermediateObjectModel3D)
* --- End of Automatically Added Context ---"
71778ce7,micro,15,,"get_object_model_3d_params (ObjectModel3D, 'triangles', Triangles)
ClosestTrianglePoints := Triangles[ClosestTriangleIndexUniq * 3]
ClosestTrianglePoints := [ClosestTrianglePoints,Triangles[ClosestTriangleIndexUniq * 3 + 1]]
ClosestTrianglePoints := [ClosestTrianglePoints,Triangles[ClosestTriangleIn...",84,88,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
tuple_uniq (ClosestTriangleIndex, ClosestTriangleIndexUniq)
* -..."
71778ce7,micro,16,,"tuple_sort (ClosestTrianglePoints, ClosestTrianglePoints)
tuple_uniq (ClosestTrianglePoints, ClosestTrianglePointsUniq)",89,91,"* --- Automatically Added Context ---
tuple_uniq (ClosestTriangleIndex, ClosestTriangleIndexUniq)
ClosestTrianglePoints := Triangles[ClosestTriangleIndexUniq * 3]
get_object_model_3d_params (ObjectMod..."
71778ce7,micro,17,,"get_object_model_3d_params (ObjectModel3D, 'num_points', NumPoints)
tuple_gen_const (NumPoints, 0, IsVisible)
IsVisible[ClosestTrianglePointsUniq] := 1.0",92,95,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
tuple_uniq (ClosestTrianglePoints, ClosestTrianglePointsUniq)
*..."
71778ce7,micro,18,,"select_points_object_model_3d (ObjectModel3D, IsVisible, 0.5, 1.5, ObjectModel3DVisible)
dev_set_window (WindowHandle2)
dev_disp_visible_model ()
visualize_object_model_3d (WindowHandle1, [ObjectModel3DVisible,ObjectModel3D], CameraParam, Pose, VisParamNames, VisParamValues, 'Original and reduced ob...",96,174,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNames := ['color_0', 'color_1', 'alpha']
VisParamValues := ..."
71778ce7,micro,19,"a camera pose, such that the input 3D object model is
completely visible for the camera.","if (IsTelecentric)
get_object_model_3d_params (ObjectModel3D, 'bounding_box1', BB1)
max_diameter_object_model_3d (ObjectModel3D, Diameter)
create_pose (-(BB1[0] + BB1[3]) / 2, -(BB1[1] + BB1[4]) / 2, -BB1[2] + Diameter, 0, 0, 0, 'Rp+T', 'gba', 'point', PoseInit)
rigid_trans_object_model_3d (ObjectMo...",175,248,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', 'convert_to_triangles', 'true', ObjectModel3D, Status)
Width := 1280
Height := 1024
BorderFact := 1.1
IsTelecentric :=..."
7e57c34a,full,0,"*******************************************
This example shows some major             *
approaches i...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction ()
stop ()
dev_disp_introduction_threshold ()
stop ()
for SceneIdx := 2 to 4 by 1
read_image (ImageXYZ, 'boxes/cardboard_bo...",22,427,
7e57c34a,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",21,26,
7e57c34a,micro,2,,"dev_disp_introduction ()
stop ()",27,29,
7e57c34a,micro,3,"1. Remove background plane based on       *
thresholding                           *
***************...","dev_disp_introduction_threshold ()
stop ()
for SceneIdx := 2 to 4 by 1
read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + SceneIdx$'02d')
read_image (Image, 'boxes/cardboard_boxes_' + SceneIdx$'02d')
decompose3 (ImageXYZ, XScene, YScene, ZScene)
xyz_to_object_model_3d (XScene, YScene, ZScene, Obje...",30,85,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
7e57c34a,micro,4,,"dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction_estimation ()
stop ()",91,97,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
7e57c34a,micro,5,This is an offline step.,"read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + 1$'02d')
decompose3 (ImageXYZ, XScene, YScene, ZScene)",98,103,"* --- Automatically Added Context ---
read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + SceneIdx$'02d')
decompose3 (ImageXYZ, XScene, YScene, ZScene)
* --- End of Automatically Added Context ---"
7e57c34a,micro,6,for estimation of background plane.,draw_rect (ROI),104,107,
7e57c34a,micro,7,,"dev_disp_plane_estimation (ZScene, ROI)
stop ()
dev_close_window ()",108,112,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, XScene, YScene, ZScene)
draw_rect (ROI)
* --- End of Automatically Added Context ---"
7e57c34a,micro,8,,"intersection (ROI, ZScene, ROI)
fit_surface_first_order (ROI, ZScene, 'tukey', 5, 2, Alpha, Beta, Gamma)
area_center (ROI, Area, Row, Column)
get_image_size (ZScene, Width, Height)",113,118,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, XScene, YScene, ZScene)
draw_rect (ROI)
* --- End of Automatically Added Context ---"
7e57c34a,micro,9,,"gen_image_surface_first_order (ImageSurface, 'real', Alpha, Beta, Gamma, Row, Column, Width, Height)",119,121,"* --- Automatically Added Context ---
fit_surface_first_order (ROI, ZScene, 'tukey', 5, 2, Alpha, Beta, Gamma)
area_center (ROI, Area, Row, Column)
get_image_size (ZScene, Width, Height)
* --- End of ..."
7e57c34a,micro,10,,"dev_disp_plane_estimation_2 (ZScene, ImageSurface)
stop ()",122,124,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, XScene, YScene, ZScene)
gen_image_surface_first_order (ImageSurface, 'real', Alpha, Beta, Gamma, Row, Column, Width, Height)
* --- End of Au..."
7e57c34a,micro,11,,"dev_close_window ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
PoseVis := [-0.19, -0.52, 4.5, 310, 15, 330, 0]",125,131,"* --- Automatically Added Context ---
PoseVis := [-0.19, -0.52, 4.5, 310, 15, 330, 0]
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
7e57c34a,micro,12,to acquired scenes.,"for i := 2 to 4 by 1
read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + i$'02d')
read_image (Image, 'boxes/cardboard_boxes_' + i$'02d')
decompose3 (ImageXYZ, XScene, YScene, ZScene)
xyz_attrib_to_object_model_3d (XScene, YScene, ZScene, Image, '&amp;gray', ObjectModel3D)
Instructions[0] := 'Rotate...",132,159,"* --- Automatically Added Context ---
read_image (ImageXYZ, 'boxes/cardboard_boxes_xyz_' + SceneIdx$'02d')
read_image (Image, 'boxes/cardboard_boxes_' + SceneIdx$'02d')
threshold (ZScene, Regions, Min..."
7e57c34a,micro,13,"3. Remove background based on reference scene *
************************************************","dev_disp_introduction_reference_scene ()
stop ()",160,166,
7e57c34a,micro,14,,"dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
read_image (ImageRefPlane, 'metal-parts/metal_parts_reference_plane_xyz')
decompose3 (ImageRefPlane, XRef, YRef, ZRef)
xyz_to_object_model_3d (XRef, YRef, ZRef, ReferenceScene)",167,171,
7e57c34a,micro,15,,"dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
PoseVis := [-135, -500, 4000, 300, 15, 45, 0]
VisParams := ['alpha', 'color', 'point_size']
VisValues := [0.1, 'gray', 1]
Instructions[0] := 'Rotate: Left button'
...",172,185,"* --- Automatically Added Context ---
visualize_object_model_3d (WindowHandle, ObjectModel3DScene, [], PoseVis, 'intensity_0', '&amp;gray', 'Full Scene', [], Instructions, PoseOut)
dev_open_window (0,..."
7e57c34a,micro,16,acquired scene.,"for I := 1 to 2 by 1
dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
read_image (ImageScene, 'metal-parts/metal_parts_xyz_' + I$'02')
decompose3 (ImageScene, ImageX, ImageY, ImageZ)
xyz_to_object_model_3d (ImageX, ImageY, ImageZ, ObjectModel3D)
...",186,434,"* --- Automatically Added Context ---
reduce_object_model_3d_by_view (Regions, ObjectModel3DScene, [], [], ObjectModel3DReduced)
dev_disp_text ('Apply threshold on Z-image', 'window', 'top', 'left', '..."
3eec1308,full,0,"*******************************************
This example shows some major            *
approaches in...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction ()
stop ()
dev_disp_introduction_thresholding ()
stop ()
dev_disp_text ('Reading model. This may take a moment.', 'window',...",18,541,
3eec1308,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction ()
stop ()",17,25,
3eec1308,micro,2,"1. Remove bin based on thresholding *
**************************************","dev_disp_introduction_thresholding ()
stop ()",26,31,
3eec1308,micro,3,,"dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
read_image (ImageXYZ, 'cameras_xyz_' + 1$'02')
decompose3 (ImageXYZ, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ReferenceScene)",32,37,
3eec1308,micro,4,,"teach_background_plane (BackgroundPlane, ReferenceScene)
PoseVis := [-225, -475, 6350, 332, 13, 29, 0]
for i := 1 to 2 by 1
dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
read_image (ImageXYZ, 'cameras_xyz_' + i$'02')
decompose3 (ImageXYZ, X, Y...",38,72,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
rea..."
3eec1308,micro,5,"2. Remove bin based on meshed CAD-model *
******************************************","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_introduction_cad ()
stop ()",73,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
3eec1308,micro,6,,"dev_update_off ()
PoseVis := [33, -104, -148, 341, 3, 253, 0]",83,86,"* --- Automatically Added Context ---
PoseVis := [-225, -475, 6350, 332, 13, 29, 0]
* --- End of Automatically Added Context ---"
3eec1308,micro,7,,"dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
read_image (ImageXYZ, 'metal-parts/metal_parts_bin_xyz_' + 2$'02')
decompose3 (ImageXYZ, XRef, YRef, ZRef)",87,90,"* --- Automatically Added Context ---
read_image (ImageXYZ, 'cameras_xyz_' + 1$'02')
dev_disp_text ('Reading model. This may take a moment.', 'window', 'bottom', 'right', 'black', [], [])
* --- End of..."
3eec1308,micro,8,,"if (0)
CameraParam := ['area_scan_division', 0.0125115, -7.21334e-05, 5.2e-06, 5.2e-06, 807.526, 1048.29, 2448, 2048]
else
xyz_to_object_model_3d (XRef, YRef, ZRef, ReferenceScene)
estimate_camera_parameters (ReferenceScene, CameraParam, CameraPose)
endif",91,100,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ReferenceScene)
decompose3 (ImageXYZ, XRef, YRef, ZRef)
* --- End of Automatically Added Context ---"
3eec1308,micro,9,,"teach_background_plane_2 (ZRef, ReferencePlane)",101,103,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, XRef, YRef, ZRef)
* --- End of Automatically Added Context ---"
3eec1308,micro,10,,"read_object_model_3d ('bin/bin_cad.om3', 'm', [], [], BinCAD, Status2)",104,105,
3eec1308,micro,11,upper margin of the bin in order to align the bin.,"read_object_model_3d ('bin/bin_border', 'm', [], [], BinModel, Status3)",106,109,
3eec1308,micro,12,,"create_surface_model (BinModel, 0.05, 'model_invert_normals', 'true', SurfaceModelID)",110,112,"* --- Automatically Added Context ---
read_object_model_3d ('bin/bin_border', 'm', [], [], BinModel, Status3)
* --- End of Automatically Added Context ---"
3eec1308,micro,13,,"set_surface_model_param (SurfaceModelID, 'pose_restriction_reference_pose', [52.4834, 47.0139, 669.813, 0.202755, 329.745, 149.944, 0])
set_surface_model_param (SurfaceModelID, 'pose_restriction_max_angle_diff', rad(25))
for I := 1 to 2 by 1
dev_disp_text ('Reading model. This may take a moment.', '...",113,186,"* --- Automatically Added Context ---
read_image (ImageXYZ, 'cameras_xyz_' + 1$'02')
decompose3 (ImageXYZ, X, Y, Z)
PoseVis := [-225, -475, 6350, 332, 13, 29, 0]
threshold (Z, Region, 0.0001, 1e+10)
r..."
3eec1308,micro,14,"For details, see the HDevelop example
remove_background_for_3d_object_localization.hdev.","sub_image (Z, BackgroundPlane, ImageSub, 1, 0)",187,190,"* --- Automatically Added Context ---
teach_background_plane (BackgroundPlane, ReferenceScene)
decompose3 (ImageXYZ, X, Y, Z)
sub_image (Z, ReferencePlane, ImageSub, 1, 0)
* --- End of Automatically A..."
3eec1308,micro,15,,"threshold (ImageSub, Region1, -100, -10)
connection (Region1, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10000, 1e+10)
union1 (SelectedRegions, Domain)",191,195,"* --- Automatically Added Context ---
remove_background (Z, BackgroundPlane, Domain, Scene, Scene)
sub_image (Z, ReferencePlane, ImageSub, 1, 0)
connection (Region, ConnectedRegions)
select_shape (Con..."
3eec1308,micro,16,,"reduce_object_model_3d_by_view (Domain, ObjectModel3D, 'xyz_mapping', [], Scene)
return ()",196,254,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
remove_background (Z, BackgroundPlane, Domai..."
3eec1308,micro,17,"For details see the HDevelop example
remove_background_for_3d_object_localization.hdev)","object_model_3d_to_xyz (X, Y, Z, ObjectModel3D, 'from_xyz_map', [], [])",255,258,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)
decompose3 (ImageXYZ, X, Y, Z)
* --- End of Automatically Added Context ---"
3eec1308,micro,18,,"gen_rectangle1 (ROI_0, 215.677, 1234.19, 820.226, 1274.95)
gen_rectangle1 (TMP_Region, 223.164, 211.792, 810.867, 259.345)
union2 (ROI_0, TMP_Region, ROI_0)
intersection (ROI_0, Z, ROI_0)",259,264,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, X, Y, Z)
* --- End of Automatically Added Context ---"
3eec1308,micro,19,,"fit_surface_first_order (ROI_0, Z, 'regression', 5, 2, Alpha, Beta, Gamma)",265,266,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, X, Y, Z)
gen_rectangle1 (ROI_0, 215.677, 1234.19, 820.226, 1274.95)
* --- End of Automatically Added Context ---"
3eec1308,micro,20,,"area_center (ROI_0, Area, Row, Column)
get_image_size (Z, Width, Height)
gen_image_surface_first_order (ImageSurface, 'real', Alpha, Beta, Gamma, Row, Column, Width, Height)
return ()
gen_rectangle1 (ROI_0, 806.753, 438.1, 953.527, 519.7)
gen_rectangle1 (TMP_Region, 670.22, 1119.46, 718.007, 1229.62...",267,320,"* --- Automatically Added Context ---
decompose3 (ImageXYZ, XRef, YRef, ZRef)
teach_background_plane_2 (ZRef, ReferencePlane)
decompose3 (ImageXYZ, X, Y, Z)
gen_rectangle1 (ROI_0, 215.677, 1234.19, 82..."
3eec1308,micro,21,,"get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
get_object_model_3d_params (OM3DScene, 'point_coord_y', YCoords)
get_object_model_3d_params (OM3DScene, 'point_coord_z', ZCoords)",333,336,
3eec1308,micro,22,,"get_object_model_3d_params (OM3DScene, 'mapping_row', Rows)
get_object_model_3d_params (OM3DScene, 'mapping_col', Columns)",337,339,"* --- Automatically Added Context ---
get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
* --- End of Automatically Added Context ---"
3eec1308,micro,23,,"get_object_model_3d_params (OM3DScene, 'mapping_size', MappingSize)
Width := MappingSize[0]
Height := MappingSize[1]
gen_cam_par_area_scan_division (0.012, 0, 5.2e-006, 5.2e-006, Width / 2, Height / 2, Width, Height, CameraParamStart)
CameraPoseStart := [0, 0, 0, 0, 0, 0, 0]",340,345,"* --- Automatically Added Context ---
get_image_size (Z, Width, Height)
get_object_model_3d_params (OM3DScene, 'point_coord_x', XCoords)
* --- End of Automatically Added Context ---"
3eec1308,micro,24,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, [XCoords,YCoords,ZCoords])
set_calib_data_cam_param (CalibDataID, 0, 'area_scan_division', CameraParamStart)
set_calib_data_observ_points (CalibDataID, 0, 0, 0, Rows, Columns, 'all', CameraPoseSt...",346,470,"* --- Automatically Added Context ---
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
visualize_object_model_3d (WindowHandle, Scene, [], PoseVis, 'intensity', 'coord_z', 'Full s..."
3eec1308,micro,25,,"smallest_bounding_box_object_model_3d (Scene, 'oriented', PoseBB, Length1, Length2, Length3)",471,472,"* --- Automatically Added Context ---
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
* --- End of Automatically Added Context ---"
3eec1308,micro,26,,"if (1)
gen_box_object_model_3d (PoseBB, Length1, Length2, 50, BoundingBox)
dev_clear_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button...",473,489,"* --- Automatically Added Context ---
PoseVis := [-225, -475, 6350, 332, 13, 29, 0]
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
visualize_object_model_3d (WindowHandle, Scene..."
3eec1308,micro,27,,"pose_invert (PoseBB, PoseInvert)
rigid_trans_object_model_3d (Scene, PoseInvert, ObjectModel3DRigidTrans)",490,492,"* --- Automatically Added Context ---
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
smallest_bounding_box_object_model_3d (Scene, 'oriented', PoseBB, Length1, Length2, Length3)..."
3eec1308,micro,28,,"object_model_3d_to_xyz (X1, Y1, Z1, ObjectModel3DRigidTrans, 'from_xyz_map', [], [])",493,494,"* --- Automatically Added Context ---
rigid_trans_object_model_3d (Scene, PoseInvert, ObjectModel3DRigidTrans)
* --- End of Automatically Added Context ---"
3eec1308,micro,29,,"dev_set_color ('#f28d2680')
threshold (X1, RegionX, -140, 140)
threshold (Y1, RegionY, -75, 75)",495,498,"* --- Automatically Added Context ---
object_model_3d_to_xyz (X1, Y1, Z1, ObjectModel3DRigidTrans, 'from_xyz_map', [], [])
* --- End of Automatically Added Context ---"
3eec1308,micro,30,,"intersection (RegionX, RegionY, RegionIntersection)
intersection (RegionIntersection, Domain, RegionIntersection)",499,501,"* --- Automatically Added Context ---
remove_background (Z, BackgroundPlane, Domain, Scene, Scene)
threshold (X1, RegionX, -140, 140)
threshold (Y1, RegionY, -75, 75)
* --- End of Automatically Added ..."
3eec1308,micro,31,,"connection (RegionIntersection, ConnectedRegions1)
select_shape (ConnectedRegions1, SelectedRegions1, 'area', 'and', 5000, 1e+10)
union1 (SelectedRegions1, ROI)",502,505,"* --- Automatically Added Context ---
union2 (ROI_0, TMP_Region, ROI)
intersection (RegionX, RegionY, RegionIntersection)
* --- End of Automatically Added Context ---"
3eec1308,micro,32,,"reduce_object_model_3d_by_view (ROI, Scene, 'xyz_mapping', [], SceneReduced)
if (1)
dev_close_window ()
endif
return ()
String := '2. Remove bin based on meshed CAD-model'
String[1] := ''
String[2] := 'i)   Load a meshed CAD model.'
String[3] := 'ii)  Generate a model for aligning the bin in '
Strin...",506,547,"* --- Automatically Added Context ---
reduce_object_model_3d_by_view (Region, ObjectModel3D, [], [], Scene)
remove_bin2 (Domain, Scene, PoseOut, SceneReduced)
decompose3 (ImageXYZ, X, Y, Z)
union2 (RO..."
8513ee98,full,0,"This example shows how the number of points in a
3D object model can be reduced by sampling the
poin...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
read_image ...",29,138,
8513ee98,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'",28,36,
8513ee98,micro,2,,"read_image (Image, 'time_of_flight/engine_cover_noisy_xyz_01')
decompose3 (Image, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)",37,41,
8513ee98,micro,3,(see the example select_points_object_model_3d_by_density.hdev).,"NumNeighbors := 15
get_object_model_3d_params (ObjectModel3D, 'neighbor_distance ' + NumNeighbors, DistanceDistribution)
InlierRate := 70
Distance := sort(DistanceDistribution)[|DistanceDistribution| * InlierRate / 100]
create_pose (-0.008, -0.35, 6.1, 326, 0, 175, 'Rp+T', 'gba', 'point', VisPose1)
...",42,144,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
Instructions := 'Rotate: Left button'
read_image (Image, 'time_of_flight/engine_cover_noisy_xyz_01')
dec..."
7a6e0bf1,full,0,"***********************************************************************
This example program shows h...","dev_update_off ()
dev_close_window ()
read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_01.tif')
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
access_channel (XYZ, X, 1)
access_channel (XYZ, Y, 2)
access_chan...",15,193,
7a6e0bf1,micro,1,"This example program shows how to use the operator
segment_object_model_3d in HALCON. First, the 2.5...","dev_update_off ()
dev_close_window ()",6,16,
7a6e0bf1,micro,2,,"read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_01.tif')
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",17,20,
7a6e0bf1,micro,3,,"access_channel (XYZ, X, 1)
access_channel (XYZ, Y, 2)
access_channel (XYZ, Z, 3)
Message := 'Generate a 3D object model from an'
Message[1] := 'XYZ image and segment primitives'
Message[2] := '(spheres, cylinders, planes) in it:'
dev_display (Z)
disp_message (WindowHandle, Message, 'window', 12, 12,...",21,32,"* --- Automatically Added Context ---
read_image (XYZ, '3d_machine_vision/segmentation/3d_primitives_xyz_01.tif')
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically..."
7a6e0bf1,micro,4,,"xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
prepare_object_model_3d (ObjectModel3DID, 'segmentation', 'false', 'max_area_holes', 100)
ParSegmentation := ['max_orientation_diff', 'max_curvature_diff', 'output_xyz_mapping', 'min_area']
ValSegmentation := [0.13, 0.11, 'true', 150]
ParFitting := [...",33,39,"* --- Automatically Added Context ---
access_channel (XYZ, X, 1)
access_channel (XYZ, Y, 2)
access_channel (XYZ, Z, 3)
* --- End of Automatically Added Context ---"
7a6e0bf1,micro,5,because the parameter 'fitting' is set to 'true' by default,"segment_object_model_3d (ObjectModel3DID, [ParSegmentation,ParFitting], [ValSegmentation,ValFitting], ObjectModel3DOutID)",40,42,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3DID)
ParSegmentation := ['max_orientation_diff', 'max_curvature_diff', 'output_xyz_mapping', 'min_area']
ValSegmentat..."
7a6e0bf1,micro,6,,"dev_set_colored (12)
for Index := 0 to |ObjectModel3DOutID| - 1 by 1
object_model_3d_to_xyz (XTmp, YTmp, ZTmp, ObjectModel3DOutID[Index], 'from_xyz_map', [], [])
get_domain (ZTmp, DomainTmp)
if (Index == 0)
copy_obj (DomainTmp, Domain, 1, 1)
else
concat_obj (Domain, DomainTmp, Domain)
endif
endfor
d...",43,58,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
segment_object_model_3d (ObjectModel3DID, [ParSegmentation,ParFitting], [ValSegmentation,ValFitting], ..."
7a6e0bf1,micro,7,,"dev_clear_window ()
dev_display_fitting_results (RegionCylinder, RegionSphere, RegionPlane, RegionNone, ObjectModel3DOutID, WindowHandle, [])",59,62,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
segment_object_model_3d (ObjectModel3DID, [ParSegmentation,ParFitting], [ValSegmentation,ValFitting], ..."
7a6e0bf1,micro,8,,"for Index := 0 to |ObjectModel3DOutID| - 1 by 1
copy_object_model_3d (ObjectModel3DOutID[Index], 'primitives_all', CopiedObjectModel3DID)
endfor
dev_update_on ()",65,93,"* --- Automatically Added Context ---
segment_object_model_3d (ObjectModel3DID, [ParSegmentation,ParFitting], [ValSegmentation,ValFitting], ObjectModel3DOutID)
for Index := 0 to |ObjectModel3DOutID| -..."
7a6e0bf1,micro,9,"Color[0] is used for objects which could not be fitted
Color[1] is used for cylinders
Color[2] is us...","if (Colors == [])
Colors := ['dim gray', 'forest green', 'red', 'slate blue']
endif
NumNone := 0
NumCylinders := 0
NumSpheres := 0
NumPlanes := 0
for Index := 0 to |ObjectModel3DOutID| - 1 by 1
object_model_3d_to_xyz (XTmp, YTmp, ZTmp, ObjectModel3DOutID[Index], 'from_xyz_map', [], [])
get_domain (X...",98,207,"* --- Automatically Added Context ---
dev_open_window_fit_image (XYZ, 0, 0, -1, -1, WindowHandle)
Message := 'Generate a 3D object model from an'
segment_object_model_3d (ObjectModel3DID, [ParSegmenta..."
f03aa0e5,full,0,"**************************************************************
This example program shows how to rem...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 256, 768, 512, C...",29,133,
f03aa0e5,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",28,33,
f03aa0e5,micro,2,,"read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 256, 768, 512, CamParam)
create_pose (-4.4e-005, -2.9e-003, 1.8e-1, 289.0, 0.8, 12.5, 'Rp+T', 'gba', 'point', Pose)
GenParamName := ['color_0', 'alpha_0', 'disp_pose_0']
...",38,51,
f03aa0e5,micro,3,Those values will be applied to the 3D object model.,"ThreshMinX := -15.0e-3
ThreshMaxX := 15.0e-3",52,56,
f03aa0e5,micro,4,of the thresholds.,"create_pose (ThreshMinX, 0.0, 0.0, 0, 90, 0, 'Rp+T', 'gba', 'point', PosePlaneMinX)
create_pose (ThreshMaxX, 0.0, 0.0, 0, 90, 0, 'Rp+T', 'gba', 'point', PosePlaneMaxX)
gen_plane_object_model_3d (PosePlaneMinX, [25.0e-3, 25.0e-3, -25.0e-3, -25.0e-3], [25.0e-3, -25.0e-3, -25.0e-3, 25.0e-3], ObjectMode...",57,63,"* --- Automatically Added Context ---
create_pose (-4.4e-005, -2.9e-003, 1.8e-1, 289.0, 0.8, 12.5, 'Rp+T', 'gba', 'point', Pose)
ThreshMinX := -15.0e-3
ThreshMaxX := 15.0e-3
* --- End of Automatically..."
f03aa0e5,micro,5,,"Title := 'The x-coordinates of the 3d points will be thresholded'
Information := ['Apply threshold: ',(ThreshMinX * 1e3)$'3.1f' + ' mm &lt;= x &lt;= ' + (ThreshMaxX * 1e3)$'3.1f' + ' mm']
visualize_object_model_3d (WindowHandle, [ObjectModel3DMinX,ObjectModel3DMaxX,ObjectModel3D,ObjectModel3D], CamP...",64,68,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.0..."
f03aa0e5,micro,6,points such that ThreshMinX &lt;= x &lt;= ThreshMaxX.,"select_points_object_model_3d (ObjectModel3D, 'point_coord_x', ThreshMinX, ThreshMaxX, ObjectModel3DThresholded)
Title := 'Result of the threshold operation on the x-coordinates'
Information := ['Applied threshold: ',(ThreshMinX * 1e3)$'3.1f' + ' mm &lt;= x &lt;= ' + (ThreshMaxX * 1e3)$'3.1f' + ' mm...",69,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.0..."
f03aa0e5,micro,7,"Second Example
**************************************************************","read_object_model_3d ('car_rim', 'm', [], [], ObjectModel3D, Status)
max_diameter_object_model_3d (ObjectModel3D, Diameter)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 256, 768, 512, CamParam)
GenParamName := ['color_0', 'alpha_0', 'disp_pose_0']
GenParamValue := ['green', .3, 'true']
...",85,101,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 384, 256, 768, 512, CamParam)
GenPara..."
f03aa0e5,micro,8,of the thresholding planes.,"MinAngle := -20
MaxAngle := 55
create_pose (0, 0.0, 0.0, 90, MinAngle, 0, 'Rp+T', 'gba', 'point', PosePlane1)
create_pose (0, 0.0, 0.0, 90, MaxAngle, 0, 'Rp+T', 'gba', 'point', PosePlane2)
gen_plane_object_model_3d (PosePlane1, [0, 0, 1, 1] * Diameter, [-1, 1, 1, -1] * Diameter, ObjectModel3DBorder1...",102,114,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (-4.4e-005, -2.9e-003, ..."
f03aa0e5,micro,9,"(one the positive side of plane 1, on the negative side of plane 2).","get_object_model_3d_params (ObjectModel3D, 'point_coord_x', PX)
get_object_model_3d_params (ObjectModel3D, 'point_coord_y', PY)
Angle := deg(atan2(PY,PX))",115,119,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
f03aa0e5,micro,10,,"select_points_object_model_3d (ObjectModel3D, Angle, MinAngle, MaxAngle, ObjectModel3DThresholded)
Title := ['Result of selecting points based on their angle', 'in the x-y-plane']
Information := []
get_object_model_3d_params (ObjectModel3DThresholded, 'num_points', NumPoints)
if (NumPoints &gt; 0)
v...",120,139,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'gray', WindowHandle)
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (-4.4e-005, -2.9e-003, ..."
3e2903f5,full,0,"This example shows how sparse points, that often indicate
noisy or inaccurate measurements, can be r...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
read_image ...",20,111,
3e2903f5,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'",19,27,
3e2903f5,micro,2,,"read_image (Image, 'time_of_flight/engine_cover_noisy_xyz_01')
decompose3 (Image, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)",28,32,
3e2903f5,micro,3,such that the 30% sparsest points are removed.,"NumNeighbors := 15
get_object_model_3d_params (ObjectModel3D, 'neighbor_distance ' + NumNeighbors, DistanceDistribution)
InlierRate := 70
Distance := sort(DistanceDistribution)[|DistanceDistribution| * InlierRate / 100]
create_pose (-0.008, -0.35, 6.1, 326, 0, 175, 'Rp+T', 'gba', 'point', VisPose1)
...",33,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1000, 600, 'black', WindowHandle1)
Instructions := 'Rotate: Left button'
read_image (Image, 'time_of_flight/engine_cover_noisy_xyz_01')
dec..."
3eee21bd,full,0,"***********************************************************
This example program shows how to use th...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 512, 512, 512, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
read_object_model_3d (...",14,34,
3eee21bd,micro,1,"This example program shows how to use the operator
connection_object_model_3d in HALCON. The connect...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 512, 512, 512, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')",6,19,
3eee21bd,micro,2,,"read_object_model_3d ('bmc_mini', 'm', [], [], ObjectModel3D, Status)",20,22,
3eee21bd,micro,3,"information. The parameter 'Value' is ignored for the
feature 'mesh'.","connection_object_model_3d (ObjectModel3D, 'mesh', 1, ObjectModel3DConnected)",23,27,"* --- Automatically Added Context ---
read_object_model_3d ('bmc_mini', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
3eee21bd,micro,4,,"create_pose (0.08, 0.05, 1.0, 188.0, 50.0, 0.0, 'Rp+T', 'gba', 'point', Pose)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 256, 240, 512, 512, CamParam)
disp_object_model_3d_safe (WindowHandle1, ObjectModel3D, CamParam, Pose, 'colored', 12)
disp_object_model_3d_safe (WindowHandle2, ObjectMod...",28,40,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 512, 512, 512, 'black', WindowHandle2)
read_object_model_3d ('bmc_mini', 'm', [], [],..."
f683c64c,full,0,"This example shows the fusion of multiple 3D object models into one
surface, along with the suggeste...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
create_pos...",11,610,
f683c64c,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",10,15,
f683c64c,micro,2,,"Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', VisPose)
GenParamNames := ['colored', 'point_size']
GenParamValues := [12, 1]
GenParamNamesBB := ['...",16,25,
f683c64c,micro,3,,"dev_disp_introduction_text ()
stop ()",26,28,
f683c64c,micro,4,,"dev_disp_workflow_text ()
stop ()",29,32,
f683c64c,micro,5,,"get_system ('example_dir', ExampleDir)
Path := ExampleDir + '/3d_models/universal_joint_part/'
list_files (Path, 'files', Files)
SelectedFiles := regexp_select(Files,'registered_')
NumObjects := |SelectedFiles|
ObjectModel3D := []",33,39,
f683c64c,micro,6,"and therefore all further lengths will be taken
as in this unit as well.","Scale := 'mm'
for IndexOM3D := 0 to NumObjects - 1 by 1
read_object_model_3d (SelectedFiles[IndexOM3D], Scale, [], [], ObjectModel3DIn, Status)
ObjectModel3D := [ObjectModel3D,ObjectModel3DIn]
endfor",40,48,"* --- Automatically Added Context ---
SelectedFiles := regexp_select(Files,'registered_')
NumObjects := |SelectedFiles|
ObjectModel3D := []
list_files (Path, 'files', Files)
* --- End of Automatically..."
f683c64c,micro,7,,"visualize_object_model_3d (WindowHandle, ObjectModel3D, [], VisPose, GenParamNames, GenParamValues, 'All 15 input point clouds that should be fused into one surface.', [], Instructions, VisPose)
GenParamNames := [GenParamNames,'disp_normals', 'normal_color']
GenParamValues := [GenParamValues,'true',...",49,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,8,,"surface_normals_object_model_3d (ObjectModel3D, 'xyz_mapping', [], [], ObjectModel3DNormals)
visualize_object_model_3d (WindowHandle, ObjectModel3DNormals, [], VisPose, GenParamNames, GenParamValues, 'Input point clouds with normals: \nHere, the NormalDirection is \'outwards\'.', [], Instructions, V...",54,56,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,9,"all over the surface. An incorrect value of the parameter might result
in an incorrect surface or ev...",NormalDirection := 'outwards',57,61,"* --- Automatically Added Context ---
visualize_object_model_3d (WindowHandle, ObjectModel3DNormals, [], VisPose, GenParamNames, GenParamValues, 'Input point clouds with normals: \nHere, the NormalDir..."
f683c64c,micro,10,,"get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_open_window (0, Width + 8, 400, Height, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_disp_bounding_box_text ()
union_object_model_3d (ObjectModel3DNormals, 'points_surface', UnionObjectMode...",64,73,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,11,,"BoundingBox := [55, 1, 16, 115, 55, 26]
gen_box_object_model_3d_from_coordinates (BoundingBox, ObjectModel3DBoundingBox)
visualize_object_model_3d (WindowHandle, [ObjectModel3DNormals,ObjectModel3DBoundingBox], [], VisPose, GenParamNamesBB, GenParamValuesBB, 'Input point clouds with adapted bounding...",74,77,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,12,Start with a rough resolution.,"get_object_model_3d_params (ObjectModel3DBoundingBox, 'diameter_axis_aligned_bounding_box', DiameterBoundingBox)
Resolution := DiameterBoundingBox / 100.0",78,81,"* --- Automatically Added Context ---
gen_box_object_model_3d_from_coordinates (BoundingBox, ObjectModel3DBoundingBox)
* --- End of Automatically Added Context ---"
f683c64c,micro,13,to avoid discretization effects.,SurfaceTolerance := Resolution * 4,82,84,"* --- Automatically Added Context ---
Resolution := DiameterBoundingBox / 100.0
get_object_model_3d_params (ObjectModel3DBoundingBox, 'diameter_axis_aligned_bounding_box', DiameterBoundingBox)
* --- E..."
f683c64c,micro,14,"If the input clouds represent the object only from one side, this parameter
should be set very large...",MinThickness := DiameterBoundingBox,85,89,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3DBoundingBox, 'diameter_axis_aligned_bounding_box', DiameterBoundingBox)
* --- End of Automatically Added Context ---"
f683c64c,micro,15,,Smoothing := 1.0,90,92,
f683c64c,micro,16,and visualize the resulting watertight surface.,"dev_disp_text ('Fusing point clouds...', 'window', 'bottom', 'right', 'black', [], [])
dev_disp_fusion_text (WindowHandle2)
fuse_object_model_3d (ObjectModel3DNormals, BoundingBox, Resolution, SurfaceTolerance, MinThickness, Smoothing, NormalDirection, [], [], ObjectModel3DFusion)
GenParamNamesBB :=...",93,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,17,,"dev_disp_resolution_text (WindowHandle2)
Resolutions := [DiameterBoundingBox / 100,DiameterBoundingBox / 150]
for Index := 0 to |Resolutions| - 1 by 1
dev_set_window (WindowHandle)
dev_disp_text ('Fusing point clouds...', 'window', 'bottom', 'right', 'black', [], [])
count_seconds (T1)
fuse_object_m...",106,121,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,18,,"dev_disp_surface_tolerance_text (WindowHandle2)
SurfaceTolerances := [Resolution * 2,Resolution * 50]
Title[0] := 'Low SurfaceTolerance (' + SurfaceTolerances[0]$'.2f' + ' ' + Scale + '); more outliers.'
Title[1] := 'Higher SurfaceTolerance (' + SurfaceTolerances[1]$'.2f' + ' ' + Scale + ');\nsome o...",122,135,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,19,,"dev_disp_min_thickness_text (WindowHandle2)
MinThicknesses := [1,DiameterBoundingBox]
Title[0] := 'MinThickness specifying the object\'s narrowest part.\nHere, it is too low (' + MinThicknesses[0]$'.2f' + ' ' + Scale + '), which causes holes in the surface.'
Title[1] := 'Large value (' + MinThicknes...",136,148,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,20,,"dev_disp_smoothing_text (WindowHandle2)
Smoothings := [0.5, 152, 15]
Title[0] := 'Smoothing too small (' + Smoothings[0]$'.1f' + '); uneven surface.'
Title[1] := 'Smoothing too large (' + Smoothings[1]$'.1f' + '); loss of detail.'
Title[2] := 'Medium Smoothing (' + Smoothings[2]$'.1f' + ').'
for Ind...",149,161,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,21,,"dev_disp_dist_in_front_text (WindowHandle2)
DistancesInFront := [Resolution * 2,DiameterBoundingBox]
Title[0] := 'Smaller \'distance_in_front\' value (' + DistancesInFront[0]$'.2f' + ' ' + Scale + ');\n\'holes\' between outliers are closed.'
Title[1] := 'Large \'distance_in_front\' value (' + Distan...",164,175,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,22,,"dev_disp_angle_threshold_text (WindowHandle2)
AngleThresholds := [rad(5),rad(30)]
Title[0] := 'Smaller angle_threshold (' + AngleThresholds[0]$'.2f' + ' rad); many outliers are excluded.'
Title[1] := 'Larger angle_threshold (' + AngleThresholds[1]$'.2f' + ' rad); more outliers are included.'
for Ind...",176,187,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,23,,"dev_disp_point_meshing_text (WindowHandle2)
PointMeshing := ['none', 'isosurface']
Title[0] := 'point_meshing is deactivated; output is not triangulated.'
Title[1] := 'point_meshing is activated; \ntriangulation with the \'marching tetrahedra\' algorithm.'
for Index := 0 to |PointMeshing| - 1 by 1
d...",188,201,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,24,with the adapted set of parameters.,"Resolution := 0.53
SurfaceTolerance := 1.5
MinThickness := 80
Smoothing := 20
dev_disp_text ('Fusing point clouds with final adapted parameters...', 'window', 'bottom', 'right', 'black', [], [])
fuse_object_model_3d (ObjectModel3DNormals, BoundingBox, Resolution, SurfaceTolerance, MinThickness, Smoo...",202,226,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
Instructions := 'Rotate: Left Button'
create_pose (-57, -34, 1097, 131, 6, 293, 'Rp+T', 'gba', 'point', Vi..."
f683c64c,micro,25,to be used in visualization.,"Points := {[]}
Points.at(0) := [BoxCoordinates[0],BoxCoordinates[1],BoxCoordinates[2]]
Points.at(1) := [BoxCoordinates[3],BoxCoordinates[1],BoxCoordinates[2]]
Points.at(2) := [BoxCoordinates[3],BoxCoordinates[4],BoxCoordinates[2]]
Points.at(3) := [BoxCoordinates[0],BoxCoordinates[4],BoxCoordinates[2...",227,239,
f683c64c,micro,26,,"PX := []
PY := []
PZ := []
for Index := 0 to 7 by 1
PX := [PX,Points.at(Index)[0]]
PY := [PY,Points.at(Index)[1]]
PZ := [PZ,Points.at(Index)[2]]
endfor
gen_object_model_3d_from_points (PX, PY, PZ, ObjectModel3DBox)",240,250,"* --- Automatically Added Context ---
for Index := 0 to |Resolutions| - 1 by 1
Points := {[]}
* --- End of Automatically Added Context ---"
f683c64c,micro,27,,"Faces := []
Faces := [Faces,4, 0, 1, 5, 4]
Faces := [Faces,4, 1, 2, 6, 5]
Faces := [Faces,4, 2, 3, 7, 6]
Faces := [Faces,4, 3, 0, 4, 7]
Faces := [Faces,4, 0, 1, 2, 3]
Faces := [Faces,4, 4, 5, 6, 7]
set_object_model_3d_attrib_mod (ObjectModel3DBox, 'polygons', [], Faces)
return ()
Text := 'This examp...",251,618,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
visualize_object_model_3d (WindowHandle, ObjectModel3DNormals, [], VisPose, GenParamNames, GenParamValues,..."
d39f044d,full,0,"********************************************************************
This program shows how to calcu...","read_object_model_3d ('bmc_mini', 'm', [], [], ObjectModel3D1, Status)
read_object_model_3d ('glass_mug', 'm', [], [], ObjectModel3D2, Status)
dev_close_window ()
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_...",20,2051,
d39f044d,micro,1,"This program shows how to calculate the intersection between a
3D object model and a plane.
If you s...","read_object_model_3d ('bmc_mini', 'm', [], [], ObjectModel3D1, Status)
read_object_model_3d ('glass_mug', 'm', [], [], ObjectModel3D2, Status)
dev_close_window ()
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_...",6,29,
d39f044d,micro,2,,"GenParamName := ['color', 'disp_pose', 'alpha']
GenParamValue := ['green', 'true', 0.8]
ColorIntersect := 'color'
ColorIntersectValue := 'green'
Instructions := 'Rotate: Left mouse button'
Instructions[1] := 'Zoom:   Shift + left mouse button'
Instructions[2] := 'Move:   Ctrl  + left mouse button'",30,38,
d39f044d,micro,3,,"interactive_intersection_object_model_3d (WindowHandle, ObjectModel3D1, CamParam, [0.08, 0.05, 1.0, 188.0, 50.0, 0.0, 0], GenParamName, GenParamValue, 'Move object to an appropriate pose', [], Instructions, ColorIntersect, ColorIntersectValue, PoseOut)",39,41,"* --- Automatically Added Context ---
read_object_model_3d ('bmc_mini', 'm', [], [], ObjectModel3D1, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open..."
d39f044d,micro,4,,"ColorIntersect := 'colored'
ColorIntersectValue := 12
interactive_intersection_object_model_3d (WindowHandle, ObjectModel3D2, CamParam, [], GenParamName, GenParamValue, 'Move object to an appropriate pose', [], Instructions, ColorIntersect, ColorIntersectValue, PoseOut)
pose_to_hom_mat3d (PoseOut, H...",42,69,"* --- Automatically Added Context ---
read_object_model_3d ('glass_mug', 'm', [], [], ObjectModel3D2, Status)
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_ope..."
d39f044d,micro,5,"This procedure translates and rotates the input
3D object model and intersects it with a plane.
The ...","affine_trans_object_model_3d (ObjectModel3DID, HomMat3D, ObjectModel3DAffineTrans)
hom_mat3d_to_pose (HomMat3D, Pose)",70,78,"* --- Automatically Added Context ---
pose_to_hom_mat3d (PoseOut, HomMat3D)
* --- End of Automatically Added Context ---"
d39f044d,micro,6,"The plane is given in the Hesse Normal form [1,0,0,0] and describes
the plane that originates from [...","count_seconds (Seconds)
intersect_plane_object_model_3d (ObjectModel3DAffineTrans, [0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 0], ObjectModel3DLines)
count_seconds (Seconds1)
TimeInfo := 'Calculation time: ' + ((Seconds1 - Seconds) * 1e3)$'.3' + ' ms'",79,88,"* --- Automatically Added Context ---
draw_intersection_object_model (ObjectModel3D2, HomMat3D, WindowHandle, CamParam, GenParamName, GenParamValue, ColorIntersect, ColorIntersectValue, TimeInfo)
affi..."
d39f044d,micro,7,Test if the object intersects the plane,"get_object_model_3d_params (ObjectModel3DLines, 'num_points', NumPoints)
if (NumPoints &gt; 0)
pose_invert (Pose, PoseInvert)
create_pose (0.0, 0.0, 0.0, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRot)
pose_compose (Pose, PoseRot, PoseCompose)
moments_object_model_3d (ObjectModel3DLines, 'mean_points', M...",89,193,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
dev_open_window (0, 0, Width * .75, Height * .75, 'black', WindowHandle)
GenPar..."
d39f044d,micro,8,"Define global variables
**********************************************************","global def tuple gDispObjOffset
global def tuple gLabelsDecor
global def tuple gInfoDecor
global def tuple gInfoPos
global def tuple gTitlePos
global def tuple gTitleDecor
global def tuple gTerminationButtonLabel
global def tuple gAlphaDeselected
global def tuple gIsSinglePose
global def tuple gUses...",218,232,
d39f044d,micro,9,"Initialize Handles to enable correct handling in error case
****************************************...","Scene3DTest := []
Scene3D := []
WindowHandleBuffer := []",233,239,
d39f044d,micro,10,the image with respect to the smaller image dimension.,TrackballSize := 0.8,244,247,
d39f044d,micro,11,shall be used ('shoemake' or 'bell').,"VirtualTrackball := 'shoemake'
* VirtualTrackball := 'bell'",248,252,
d39f044d,micro,12,"1: Left mouse button
2: Middle mouse button
4: Right mouse button
5: Left+Right mouse button
8+x: Sh...","MouseMapping := [17, 1, 2, 5, 9, 4, 49]",253,263,
d39f044d,micro,13,"center. With gDispObjOffset a fixed offset is added
R,  C","gDispObjOffset := [-30, 0]",264,268,
d39f044d,micro,14,"Color,   Box","gInfoDecor := ['white', 'false']
gLabelsDecor := ['white', 'false']
gTitleDecor := ['black', 'true']",269,274,
d39f044d,micro,15,"gInfoPos has one of the values
{'UpperLeft', 'LowerLeft', 'UpperRight'}",gInfoPos := 'LowerLeft',275,278,
d39f044d,micro,16,"{'UpperLeft', 'UpperCenter', 'UpperRight'}",gTitlePos := 'UpperLeft',279,281,
d39f044d,micro,17,the objects that are not selected,gAlphaDeselected := 0.3,282,284,
d39f044d,micro,18,,gTerminationButtonLabel := ' Continue ',285,286,
d39f044d,micro,19,"if it responds only if the mouse button is released while being placed
over the continue button.
'tr...",WaitForButtonRelease := 'true',287,298,
d39f044d,micro,20,"If there are more models passed then this number, some calculations
are performed differently and th...",MaxNumModels := 1000,299,304,
d39f044d,micro,21,"(1) The rotation center is fixed in the center of the image and lies
on the surface of the object.
(...",WindowCenteredRotation := 2,305,310,
d39f044d,micro,22,,"NumModels := |ObjectModel3D|
SelectedObject := gen_tuple_const(NumModels,1)",313,316,
d39f044d,micro,23,,"dev_set_preferences ('graphics_window_context_menu', 'false')
dev_get_preferences ('graphics_window_mouse_wheel', WindowMouseWheel)
dev_set_preferences ('graphics_window_mouse_wheel', 'false')
get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'false')
dev_update_off ()
try
CPLength :...",317,1144,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, '..."
d39f044d,micro,24,"- the pose change that was introduced by the user by
moving the mouse
- the selection of a single ob...","global tuple gIsSinglePose
ButtonHoldOut := ButtonHoldIn
PosesOut := PosesIn
SelectedObjectOut := SelectedObjectIn
WindowCenteredRotationOut := WindowCenteredRotationlIn
VisualizeTB := max(SelectedObjectOut) != 0
InvLog2 := 1.0 / log(2)
if (Button == MouseMapping[6])
if (ButtonHoldOut)
return ()
end...",1145,1577,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, '..."
d39f044d,micro,25,,"clear_window (WindowHandleBuffer)
if (ColorImage)
disp_color (BackgroundImage, WindowHandleBuffer)
else
disp_image (BackgroundImage, WindowHandleBuffer)
endif",1578,1585,"* --- Automatically Added Context ---
WindowHandleBuffer := []
ColorImage := NumChannels == 3
count_channels (BackgroundImage, NumChannels)
* --- End of Automatically Added Context ---"
d39f044d,micro,26,,"if (sum(SelectedObject) == |SelectedObject|)
if (gUsesOpenGL == 'true')
try
display_scene_3d (WindowHandleBuffer, Scene3D, 0)
catch (Exception)
if (Exception[0] == 5185 or Exception[0] == 5188 or Exception[0] == 5187)
gUsesOpenGL := 'false'
else
throw (Exception)
endif
endtry
endif
if (gUsesOpenGL =...",1586,1633,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
GenParamName := ['color', 'disp_pose', 'alpha']
GenParamValue := ['green', 'tru..."
d39f044d,micro,27,,"if (Labels != 0)
set_color (WindowHandleBuffer, gLabelsDecor[0])
for Index := 0 to |ObjectModel3DID| - 1 by 1
Pose := Poses[Index * 7:Index * 7 + 6]
pose_to_hom_mat3d (Pose, HomMat3D)
get_object_model_3d_params (ObjectModel3DID[Index], 'center', Center)
affine_trans_point_3d (HomMat3D, Center[0], Ce...",1634,1651,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
pose_to_hom_mat3d (PoseOut, HomMat3D)
affine_trans_object_model_3d (ObjectModel..."
d39f044d,micro,28,,"if (VisualizeTrackball)
set_line_width (WindowHandleBuffer, 1)
gen_ellipse_contour_xld (TrackballContour, TrackballCenterRow, TrackballCenterCol, 0, TrackballRadiusPixel, TrackballRadiusPixel, 0, 6.28318, 'positive', 1.5)
set_color (WindowHandleBuffer, 'dim gray')
disp_xld (TrackballContour, WindowH...",1652,1659,"* --- Automatically Added Context ---
TrackballSize := 0.8
WindowHandleBuffer := []
TrackballRadiusPixel := TrackballSize * MinImageSize / 2.0
TrackballCenterRow := Height / 2
TrackballCenterCol := Wi..."
d39f044d,micro,29,,"if (VisualizeRotationCenter != 0 and |RotationCenter| == 3)
if (RotationCenter[2] &lt; 1e-10)
RotationCenter[2] := 1e-10
endif
project_3d_point (RotationCenter[0], RotationCenter[1], RotationCenter[2], CamParam, RotCenterRow, RotCenterCol)
Orientation := rad(90)
if (VisualizeRotationCenter == 1)
Ori...",1660,1679,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
TrackballSize := 0.8
WindowHandleBuffer := []
TrackballRadiusPixel := Trackball..."
d39f044d,micro,30,,"disp_title_and_information (WindowHandleBuffer, Title, Information)",1680,1682,"* --- Automatically Added Context ---
WindowHandleBuffer := []
dump_image_output (Image, IntersectionLine, WindowHandleBuffer, WindowHandleIntersect, Scene3D, AlphaOrig, ObjectModel3D, GenParamName, G..."
d39f044d,micro,31,,"if (DisplayContinueButton == 'true')
disp_continue_button (WindowHandleBuffer)
endif
return ()
NumModels := |ObjectModel3D|
TBCenter[0] := 0
TBCenter[1] := 0
TBCenter[2] := 0
get_object_model_3d_params (ObjectModel3D, 'center', Centers)
get_object_model_3d_params (ObjectModel3D, 'diameter_axis_align...",1683,1798,"* --- Automatically Added Context ---
NumModels := |ObjectModel3D|
WindowHandleBuffer := []
get_object_models_center (ObjectModel3D, Center)
TBCenter := [Qx,Qy,Qz]
affine_trans_point_3d (HomMat3D, Cen..."
d39f044d,micro,32,,"MD := mean(Diameter)
if (MD &gt; 1e-10)
Weight := Diameter / MD
else
Weight := Diameter
endif
SumW := sum(select_mask(Weight,abs(sgn(SelectedObject))))
if (SumW &lt; 1e-10)
Weight := gen_tuple_const(|Weight|,1.0)
SumW := sum(select_mask(Weight,abs(sgn(SelectedObject))))
endif
for Index := 0 to NumMo...",1799,1931,"* --- Automatically Added Context ---
pose_to_hom_mat3d (PoseOut, HomMat3D)
TrackballSize := 0.8
VirtualTrackball := 'shoemake'
SelectedObject := gen_tuple_const(NumModels,1)
get_object_models_center ..."
d39f044d,micro,33,,"if (MX1 == MX2 and MY1 == MY2)
QuatRotation := [1, 0, 0, 0]
return ()
endif",1932,1937,"* --- Automatically Added Context ---
MX1 := (TrackballCenterCol - MCol1) / (0.5 * MinImageSize)
MY1 := (TrackballCenterRow - MRow1) / (0.5 * MinImageSize)
MX2 := (TrackballCenterCol - MCol2) / (0.5 *..."
d39f044d,micro,34,,"project_point_on_trackball (MX1, MY1, VirtualTrackball, TrackballSize, P1)
project_point_on_trackball (MX2, MY2, VirtualTrackball, TrackballSize, P2)",1938,1940,"* --- Automatically Added Context ---
TrackballSize := 0.8
VirtualTrackball := 'shoemake'
MX1 := (TrackballCenterCol - MCol1) / (0.5 * MinImageSize)
MY1 := (TrackballCenterRow - MRow1) / (0.5 * MinIma..."
d39f044d,micro,35,,"tuple_vector_cross_product (P1, P2, RotAxis)",1941,1942,"* --- Automatically Added Context ---
project_point_on_trackball (MX1, MY1, VirtualTrackball, TrackballSize, P1)
project_point_on_trackball (MX2, MY2, VirtualTrackball, TrackballSize, P2)
* --- End of..."
d39f044d,micro,36,,"D := P2 - P1
T := sqrt(sum(D * D)) / (2.0 * TrackballSize)
if (T &gt; 1.0)
T := 1.0
endif
if (T &lt; -1.0)
T := -1.0
endif
RotAngle := 2.0 * asin(T) * SensFactor
Len := sqrt(sum(RotAxis * RotAxis))
if (Len &gt; 0.0)
RotAxis := RotAxis / Len
endif
axis_angle_to_quat (RotAxis[0], RotAxis[1], RotAxis[2...",1943,2003,"* --- Automatically Added Context ---
create_pose (0.0, 0.0, 0.0, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRot)
TrackballSize := 0.8
SensFactor := 0.1
Len := sqrt(QX1 * QX1 + QY1 * QY1 + QZ1 * QZ1)
get_l..."
d39f044d,micro,37,,"NumModels := |ObjectModel3DID|
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)",2004,2008,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 320, 240, 640, 480, CamParam)
affine_trans_object_model_3d (ObjectModel3DID, HomMat3D, ObjectModel3DAffineTra..."
d39f044d,micro,38,,"SelectPose := []
for Index1 := 0 to |SelectedObject| - 1 by 1
SelectPose := [SelectPose,gen_tuple_const(7,SelectedObject[Index1])]
if (SelectedObject[Index1] == 0)
set_scene_3d_instance_param (Scene3D, Index1, 'visible', 'false')
endif
endfor
set_scene_3d_param (Scene3D, 'depth_persistence', 'true')...",2009,2020,"* --- Automatically Added Context ---
SelectedObject := gen_tuple_const(NumModels,1)
Scene3D := []
WindowHandleBuffer := []
get_object_models_center (ObjectModel3D, Center)
NumModels := |ObjectModel3D..."
d39f044d,micro,39,center,"gen_region_points (RegionCenter, TrackballCenterRow, TrackballCenterCol)
distance_transform (RegionCenter, DistanceImage, 'chamfer-3-4-unnormalized', 'false', Width, Height)
get_domain (DistanceImage, Domain)
get_region_points (Domain, Rows, Columns)
get_grayval (DistanceImage, Rows, Columns, Grayva...",2021,2034,"* --- Automatically Added Context ---
Scene3D := []
WindowHandleBuffer := []
TrackballCenterRow := Height / 2
TrackballCenterCol := Width / 2
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_..."
d39f044d,micro,40,,"if (Pos != -1)
TBCenter := [0, 0,Value[Pos[0]]]
else
TBCenter := [0, 0, -1]
endif
if (max(SelectedObject) != 0)
TBSize := (0.5 + 0.5 * sum(SelectedObject) / NumModels) * TrackballRadiusPixel
else
TBCenter := []
TBSize := 0
endif
return ()",2035,2082,"* --- Automatically Added Context ---
TrackballSize := 0.8
SelectedObject := gen_tuple_const(NumModels,1)
TBCenter := [Qx,Qy,Qz]
get_object_models_center (ObjectModel3D, Center)
affine_trans_point_3d ..."
931d78df,full,0,"********************************************************************
This program shows how to calcu...","Files := ['bmc_mini', 'glass_mug']
dev_update_off ()
dev_close_window ()
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 240, 180, 480, 360, CamParam)
get_cam_par_data (CamParam, 'image_width', ImageWidth)
get_cam_par_data (CamParam, 'image_height', ImageHeight)
dev_open_window (0, 0, ImageWidt...",15,190,
931d78df,micro,1,,"Files := ['bmc_mini', 'glass_mug']",14,16,
931d78df,micro,2,,"dev_update_off ()
dev_close_window ()
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 240, 180, 480, 360, CamParam)
get_cam_par_data (CamParam, 'image_width', ImageWidth)
get_cam_par_data (CamParam, 'image_height', ImageHeight)
dev_open_window (0, 0, ImageWidth, ImageHeight, 'black', WindowHand...",17,27,
931d78df,micro,3,,"create_pose (0.05, 0.10, 1.2, 181.4, 30.6, 359.0, 'Rp+T', 'gba', 'point', VisualizationPose)
create_pose (0.12, 0.08, 1.2, 180.0, 90.0, 0.0, 'Rp+T', 'gba', 'point', PoseConnected)
create_pose (0, 0, 0, 0, 90, 0, 'Rp+T', 'gba', 'point', CutPlanePose)
Border := 0.03",28,32,
931d78df,micro,4,,"VisualizationPose := [VisualizationPose,6.5e-005, -0.15e-3, 8.1e-3, 120.0, 0.0, 30.0, 0]
CutPlanePose := [CutPlanePose,0, 0, 0, 70, 0, 0, 0]
PoseConnected := [PoseConnected,0.0, -0.1e-3, 6.0e-3, 90.0, 0.0, 0.0, 0]
Border := [Border,0.0003]
GenParamName := ['color_0', 'attribute_0', 'disp_pose_0', 'l...",33,45,"* --- Automatically Added Context ---
create_pose (0.05, 0.10, 1.2, 181.4, 30.6, 359.0, 'Rp+T', 'gba', 'point', VisualizationPose)
create_pose (0.12, 0.08, 1.2, 180.0, 90.0, 0.0, 'Rp+T', 'gba', 'point..."
931d78df,micro,5,successively with two different Object models.,"for Index := 0 to |Files| - 1 by 1
read_object_model_3d (Files[Index], 'mm', [], [], ObjectModel3D, Status)
CurrentCutPlanePose := CutPlanePose[Index * 7:Index * 7 + 6]
count_seconds (Seconds)
intersect_plane_object_model_3d (ObjectModel3D, CurrentCutPlanePose, ObjectModel3DIntersection)
count_secon...",46,117,"* --- Automatically Added Context ---
Files := ['bmc_mini', 'glass_mug']
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 240, 180, 480, 360, CamParam)
get_cam_par_data (CamParam, 'image_width', I..."
931d78df,micro,6,,"pose_invert (PoseIntersectionPlane, PoseInvert)",120,121,"* --- Automatically Added Context ---
pose_invert (CurrentCutPlanePose, PoseInvert)
* --- End of Automatically Added Context ---"
931d78df,micro,7,,"get_object_model_3d_params (ObjectModel3DIntersection, 'diameter_axis_aligned_bounding_box', Diameter)
PoseInvert[2] := PoseInvert[2] + Diameter",122,124,"* --- Automatically Added Context ---
intersect_plane_object_model_3d (ObjectModel3D, CurrentCutPlanePose, ObjectModel3DIntersection)
pose_invert (CurrentCutPlanePose, PoseInvert)
* --- End of Automat..."
931d78df,micro,8,,"Scale := 1
gen_cam_par_area_scan_telecentric_division (1, 0, 1.0 / Scale, 1.0 / Scale, 0, 0, 512, 512, CamParam)
project_object_model_3d (Intersection, ObjectModel3DIntersection, CamParam, PoseInvert, 'data', 'lines')
return ()",125,173,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0, 7e-6, 7e-6, 240, 180, 480, 360, CamParam)
intersect_plane_object_model_3d (ObjectModel3D, CurrentCutPlanePose, ObjectMode..."
931d78df,micro,9,,"smallest_rectangle1_xld (Intersection, Row11, Column11, Row21, Column21)
RowMin := min(Row11)
RowMax := max(Row21)
ColumnMin := min(Column11)
ColumnMax := max(Column21)",174,180,"* --- Automatically Added Context ---
project_object_model_3d_lines_to_contour_xld (Intersection, CurrentCutPlanePose, ObjectModel3DIntersection)
* --- End of Automatically Added Context ---"
931d78df,micro,10,,"Scale := (1.0 - 2.0 * RelBorder) * min([Width / (RowMax - RowMin),Height / (ColumnMax - ColumnMin)])
RowTrans := RelBorder * Width - (RowMin + 0.5) * Scale - 0.5
ColumnTrans := RelBorder * Height - (ColumnMin + 0.5) * Scale - 0.5",181,185,"* --- Automatically Added Context ---
Scale := 1
RowMin := min(Row11)
RowMax := max(Row21)
ColumnMin := min(Column11)
ColumnMax := max(Column21)
smallest_rectangle1_xld (Intersection, Row11, Column11,..."
931d78df,micro,11,,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, Scale, Scale, 0, 0, HomMat2DScale)
hom_mat2d_translate (HomMat2DScale, RowTrans, ColumnTrans, HomMat2D)
return ()",186,241,"* --- Automatically Added Context ---
determine_transformation_parameters (Intersection, ImageHeight, ImageWidth, 0.1, HomMat2D)
Scale := 1
RowMin := min(Row11)
ColumnMin := min(Column11)
smallest_rec..."
1c9e5372,full,0,"This example program shows how to use the operator
projective_trans_object_model_3d in HALCON.  In t...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
HomMat3D := [-0.3, 0.5, 0.8, 0, -0.1, 0.8, -0.5, 0, -.1, -0.3, 0.2, 1, 0.5, 0.8, 0.5, 1]
gen_box_object_model_3d ([0.5, 0.5, 0.5, 0, 0, 0, 0], 1, 1, 1, CubeBox)
sa...",13,65,
1c9e5372,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
HomMat3D := [-0.3, 0.5, 0.8, 0, -0.1, 0.8, -0.5, 0, -.1, -0.3, 0.2, 1, 0.5, 0.8, 0.5, 1]",12,17,
1c9e5372,micro,2,,"gen_box_object_model_3d ([0.5, 0.5, 0.5, 0, 0, 0, 0], 1, 1, 1, CubeBox)",20,21,
1c9e5372,micro,3,,"sample_object_model_3d (CubeBox, 'fast', 0.1, [], [], CubeSampled)",29,30,"* --- Automatically Added Context ---
gen_box_object_model_3d ([0.5, 0.5, 0.5, 0, 0, 0, 0], 1, 1, 1, CubeBox)
* --- End of Automatically Added Context ---"
1c9e5372,micro,4,,"gen_object_model_3d_from_points ([0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 1, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 1], CubePoints)",31,32,
1c9e5372,micro,5,,"set_object_model_3d_attrib (CubePoints, 'polygons', [], [4, 0, 1, 3, 2, 4, 4, 5, 7, 6, 4, 0, 1, 5, 4, 4, 2, 3, 7, 6, 4, 1, 3, 7, 5, 4, 0, 2, 6, 4], CubeFaces)",33,35,"* --- Automatically Added Context ---
gen_object_model_3d_from_points ([0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 1, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 1], CubePoints)
* --- End of Automatically Added Contex..."
1c9e5372,micro,6,,"rigid_trans_object_model_3d (CubePoints, [2, 0, 0, 0, 0, 0, 0], CubePointsRT)
rigid_trans_object_model_3d (CubeFaces, [4, 0, 0, 0, 0, 0, 0], CubeFacesRT)",36,39,"* --- Automatically Added Context ---
gen_object_model_3d_from_points ([0, 0, 0, 0, 1, 1, 1, 1], [0, 0, 1, 1, 0, 0, 1, 1], [0, 1, 0, 1, 0, 1, 0, 1], CubePoints)
set_object_model_3d_attrib (CubePoints,..."
1c9e5372,micro,7,,"VisParamNames := ['disp_pose', 'color']
VisParamValues := ['true', 'orange']
gen_cam_par_area_scan_division (0.016, 0, 5e-6, 5e-6, 320, 240, 640, 480, VisCamParam)
create_pose (-1.7, 1, 45, 35, 340, 334, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zo...",40,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
gen_box_object_model_3d ([0.5, 0.5, 0.5, 0, 0, 0, 0], 1, 1, 1, CubeBox)
sample_object_model_3d (CubeBox, '..."
1c9e5372,micro,8,,"projective_trans_object_model_3d (CubePointsRT, HomMat3D, CubePoints1)
projective_trans_object_model_3d (CubeFacesRT, HomMat3D, CubeFaces1)
projective_trans_object_model_3d (CubeSampled, HomMat3D, CubeSampled1)",52,57,"* --- Automatically Added Context ---
HomMat3D := [-0.3, 0.5, 0.8, 0, -0.1, 0.8, -0.5, 0, -.1, -0.3, 0.2, 1, 0.5, 0.8, 0.5, 1]
sample_object_model_3d (CubeBox, 'fast', 0.1, [], [], CubeSampled)
rigid_..."
1c9e5372,micro,9,,"* projective_trans_object_model_3d (CubeBox, HomMat3D, CubeBox1)",58,60,"* --- Automatically Added Context ---
HomMat3D := [-0.3, 0.5, 0.8, 0, -0.1, 0.8, -0.5, 0, -.1, -0.3, 0.2, 1, 0.5, 0.8, 0.5, 1]
gen_box_object_model_3d ([0.5, 0.5, 0.5, 0, 0, 0, 0], 1, 1, 1, CubeBox)
*..."
1c9e5372,micro,10,,"Title := 'Projectively transformed object models'
create_pose (-0.3, 0.1, 10, 145, 60, 315, 'Rp+T', 'gba', 'point', VisPose)
Labels := ['Sampled Primitive', 'Corner points only', 'Faces']
visualize_object_model_3d (WindowHandle, [CubeSampled1,CubePoints1,CubeFaces1], VisCamParam, VisPose, VisParamNa...",61,71,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
VisParamNames := ['disp_pose', 'color']
VisParamValues := ['true', 'orange']
gen_cam_par_area_scan_divisio..."
d1ff0665,full,0,"This example program shows how to use the operator
rigid_trans_object_model_3d in HALCON. In this ex...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.016, 0, 5e-6, 5e-6, 320, 240, 640, 480, CamParam)
create_pose (-1, 1, 20, 110, 0, 270, 'Rp+T', 'gba', 'point', DisplayPose)
creat...",13,32,
d1ff0665,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.016, 0, 5e-6, 5e-6, 320, 240, 640, 480, CamParam)
create_pose (-1, 1, 20, 110, 0, 270, 'Rp+T', 'gba', 'point', DisplayPose)
creat...",12,19,
d1ff0665,micro,2,,"gen_cylinder_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.5, 0, 2, ObjectModel3DCylinder)
disp_object_model_3d_safe (WindowHandle, ObjectModel3DCylinder, CamParam, DisplayPose, 'disp_pose', 'true')
disp_message (WindowHandle, 'Cylinder before transformation', 'window', 12, 12, 'black', 'true')
disp_con...",20,26,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
gen_cam_par_area_scan_division (0.016, 0, 5e-6, 5e-6, 320, 240, 640, 480, CamParam)
create_pose (-1, 1, 20..."
d1ff0665,micro,3,,"rigid_trans_object_model_3d (ObjectModel3DCylinder, TransPose, ObjectModel3DRigidTrans)
dev_clear_window ()
disp_object_model_3d_safe (WindowHandle, ObjectModel3DRigidTrans, CamParam, DisplayPose, 'disp_pose', 'true')
disp_message (WindowHandle, 'Cylinder after transformation', 'window', 12, 12, 'bl...",27,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
gen_cam_par_area_scan_division (0.016, 0, 5e-6, 5e-6, 320, 240, 640, 480, CamParam)
create_pose (-1, 1, 20..."
3a7bbe9e,full,0,"This program shows how to use simplify_object_model_3d
to simplify a complex 3d object model to diff...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.08, 0, 6e-6, 6e-6, 256, 256, 512, 512, CamParam)
create_pose (-40, 45, 2100, 195, 45, 5, 'Rp+T', 'gba', 'point', CamPose)
Instruc...",9,38,
3a7bbe9e,micro,1,to simplify a complex 3d object model to different degrees.,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",6,11,
3a7bbe9e,micro,2,,"gen_cam_par_area_scan_division (0.08, 0, 6e-6, 6e-6, 256, 256, 512, 512, CamParam)
create_pose (-40, 45, 2100, 195, 45, 5, 'Rp+T', 'gba', 'point', CamPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'",12,18,
3a7bbe9e,micro,3,"model must be triangulated to be able to pass it to
simplify_object_model_3d).","read_object_model_3d ('mvtec_bunny.om3', 'm', [], [], ObjectModel3D, Status)",19,23,
3a7bbe9e,micro,4,,"get_object_model_3d_params (ObjectModel3D, 'num_points', NumPointsOrig)
visualize_object_model_3d (WindowHandle, ObjectModel3D, CamParam, CamPose, ['color', 'disp_background'], ['green', 'true'], ['Original model','with ' + NumPointsOrig + ' points'], [], Instructions, CamPose)",24,27,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_cam_par_area_scan_division (0.08, 0, 6e-6, 6e-6, 256, 256, 512, 512, CamParam)
create_pose (-40, 45, 2..."
3a7bbe9e,micro,5,,"dev_open_window (0, 516, 512, 512, 'black', WindowHandleSimplified)
set_display_font (WindowHandleSimplified, 14, 'mono', 'true', 'false')
PercentageRemaining := [10, 1, 0.1]
for Index := 0 to |PercentageRemaining| - 1 by 1
Amount := PercentageRemaining[Index]
simplify_object_model_3d (ObjectModel3D...",28,44,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.08, 0, 6e-6, 6e-6, 256, 256, 512, 512, CamParam)
create_pose (-40, 45, 2100, 195, 45, 5, 'Rp+T', 'gba', 'point', CamPose)
Instru..."
045524bf,full,0,"***************************************************************
This example program shows how noisy...","dev_update_off ()
dev_close_window ()
HeightWindow := 600
WidthWindow := 600
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2...",20,315,
045524bf,micro,1,,"dev_update_off ()
dev_close_window ()
HeightWindow := 600
WidthWindow := 600
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2...",19,33,
045524bf,micro,2,,"dev_disp_introduction (WindowHandle2)
stop ()",34,37,"* --- Automatically Added Context ---
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)
* --- End of Automatically Added Context ---"
045524bf,micro,3,,"read_image (Image, 'time_of_flight/engine_cover_noisy_xyz_01')
decompose3 (Image, X, Y, Z)
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)
get_object_model_3d_params (ObjectModel3D, 'num_points', NumPoints)",38,43,
045524bf,micro,4,,"dev_disp_explanation1 (WindowHandle2)
Title := 'Original noisy point cloud acquired with'
Title[1] := 'time-of-flight sensor.'
visualize_object_model_3d (WindowHandle1, ObjectModel3D, [], VisPose1, ['color', 'point_size'], ['white', 2], Title, [], Instructions, VisPose1)",44,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,5,"Step 1: Removal of sparse points.
***************************************************************
Fi...","NumNeighbors := 15
get_object_model_3d_params (ObjectModel3D, 'neighbor_distance ' + NumNeighbors, DistanceDistribution)
InlierRate := 70
Distance := sort(DistanceDistribution)[|DistanceDistribution| * InlierRate / 100]",50,58,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)
* --- End of Automatically Added Context ---"
045524bf,micro,6,,"select_points_object_model_3d (ObjectModel3D, 'num_neighbors_fast ' + Distance, 15, NumPoints, ObjectModel3DThresholdedFast)",59,60,"* --- Automatically Added Context ---
xyz_to_object_model_3d (X, Y, Z, ObjectModel3D)
get_object_model_3d_params (ObjectModel3D, 'num_points', NumPoints)
Distance := sort(DistanceDistribution)[|Distan..."
045524bf,micro,7,,"dev_disp_explanation2 (WindowHandle2)
Title := 'Point cloud without sparse points.'
visualize_object_model_3d (WindowHandle1, ObjectModel3DThresholdedFast, [], VisPose2, ['color', 'point_size'], ['white', 2], Title, [], Instructions, VisPose2)",61,65,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,8,"Step 2: Removal of invalid points.
***************************************************************
A...","select_points_object_model_3d (ObjectModel3DThresholdedFast, 'num_neighbors_fast 1e-6', 0, 1, ObjectModel3DValid)",66,72,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3D, 'num_neighbors_fast ' + Distance, 15, NumPoints, ObjectModel3DThresholdedFast)
* --- End of Automatically Added Cont..."
045524bf,micro,9,invalid points.,"dev_disp_explanation3 (WindowHandle2)
Title := 'Point cloud without sparse and invalid points.'
visualize_object_model_3d (WindowHandle1, ObjectModel3DValid, [], VisPose2, ['color', 'point_size'], ['white', 2], Title, [], Instructions, VisPose2)",73,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,10,,"count_seconds (Seconds1)
smooth_object_model_3d (ObjectModel3DValid, 'mls', [], [], SmoothObjectModel3DMLS)
count_seconds (Seconds2)
TimeMLS := Seconds2 - Seconds1",85,89,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholdedFast, 'num_neighbors_fast 1e-6', 0, 1, ObjectModel3DValid)
* --- End of Automatically Added Context ---"
045524bf,micro,11,,"dev_disp_explanation4 (WindowHandle2)
Title := 'Smoothed point cloud.'
Title[1] := 'Smoothing method: \'mls\''
Title[2] := 'Processing time: ' + TimeMLS * 1e3 + ' ms'
visualize_object_model_3d (WindowHandle1, SmoothObjectModel3DMLS, [], VisPose2, ['color', 'point_size'], ['white', 2], Title, [], Ins...",90,95,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,12,,"count_seconds (Seconds1)
smooth_object_model_3d (ObjectModel3DValid, 'mls', 'mls_kNN', 200, SmoothObjectModel3DMLS1)
count_seconds (Seconds2)
TimeMLS1 := Seconds2 - Seconds1",96,100,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholdedFast, 'num_neighbors_fast 1e-6', 0, 1, ObjectModel3DValid)
count_seconds (Seconds1)
count_seconds (Seconds2..."
045524bf,micro,13,,"dev_disp_explanation5 (WindowHandle2)
Title := 'Smoothed point cloud with increased \'mls_kNN\'.'
Title[1] := 'Smoothing method: \'mls\''
Title[2] := 'Processing time: ' + TimeMLS1 * 1e3 + ' ms'
visualize_object_model_3d (WindowHandle1, SmoothObjectModel3DMLS1, [], VisPose2, ['color', 'point_size'],...",101,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,14,,"count_seconds (Seconds1)
smooth_object_model_3d (ObjectModel3DValid, 'xyz_mapping', [], [], SmoothObjectModel3DXYZMapping)
count_seconds (Seconds2)",108,111,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholdedFast, 'num_neighbors_fast 1e-6', 0, 1, ObjectModel3DValid)
count_seconds (Seconds1)
count_seconds (Seconds2..."
045524bf,micro,15,,"dev_disp_explanation6 (WindowHandle2)
TimeXYZMapping := Seconds2 - Seconds1
Title := 'Smoothed point cloud.'
Title[1] := 'Smoothing method: \'xyz_mapping\''
Title[2] := 'Processing time: ' + TimeXYZMapping * 1e3 + ' ms'
visualize_object_model_3d (WindowHandle1, SmoothObjectModel3DXYZMapping, [], Vis...",112,118,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,16,,"count_seconds (Seconds1)
smooth_object_model_3d (ObjectModel3DValid, 'xyz_mapping', ['xyz_mapping_mask_width', 'xyz_mapping_mask_height'], [7, 7], SmoothObjectModel3DXYZMapping1)
count_seconds (Seconds2)
TimeXYZMapping1 := Seconds2 - Seconds1",119,123,"* --- Automatically Added Context ---
select_points_object_model_3d (ObjectModel3DThresholdedFast, 'num_neighbors_fast 1e-6', 0, 1, ObjectModel3DValid)
count_seconds (Seconds1)
count_seconds (Seconds2..."
045524bf,micro,17,,"dev_disp_explanation7 (WindowHandle2)
Title := 'Smoothed point cloud with increased mask size.'
Title[1] := 'Smoothing method: \'xyz_mapping\''
Title[2] := 'Processing time: ' + TimeXYZMapping1 * 1e3 + ' ms'
visualize_object_model_3d (WindowHandle1, SmoothObjectModel3DXYZMapping1, [], VisPose2, ['co...",124,130,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
045524bf,micro,18,"Comparison of original and filtered and smoothed point cloud.
**************************************...","dev_disp_explanation8 (WindowHandle2)
Legend := ['Filtered', 'Original']
Color := ['yellow', 'red']
dev_clear_window ()
dev_disp_text (Legend, 'window', 12, 500, Color, 'box', 'false')
Title := 'Input and result point cloud.'
visualize_object_model_3d (WindowHandle1, [SmoothObjectModel3DXYZMapping1,...",131,323,"* --- Automatically Added Context ---
dev_open_window (0, 0, HeightWindow, WidthWindow, 'black', WindowHandle1)
dev_open_window (0, WidthWindow + 12, HeightWindow, WidthWindow, 'black', WindowHandle2)..."
9288eb12,full,0,"This example program demonstrates how to use the operator
triangulate_object_model_3d
Init visualiza...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
ForceP...",12,474,
9288eb12,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
ForceP...",11,21,
9288eb12,micro,2,"'greedy_kNN' --&gt; 40
'greedy_radius_type' --&gt; 'auto'
'greedy_radius_value' --&gt; 1.0
'greedy_n...","create_pose (-49.9194, 43.0534, 1343.74, 199.373, 27.1203, 3.17326, 'Rp+T', 'gba', 'point', Pose0)
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
if (OpenGLSupported)
SamplingFactor := 0.003
MeshMorpologyParams := [4, 3, 30000]
else
SamplingFactor := 0.0053
MeshMorpolo...",22,48,"* --- Automatically Added Context ---
get_system_opengl_supported (WindowHandle, OpenGLSupported)
* --- End of Automatically Added Context ---"
9288eb12,micro,3,"- both the triangulation and the visualization of the objects are
much faster
- the sub-sampling res...","get_object_model_3d_params (ObjectModel3D, 'diameter_axis_aligned_bounding_box', Diameter)
sample_object_model_3d (ObjectModel3D, 'fast', SamplingFactor * Diameter, [], [], RawPointData3D)",51,58,"* --- Automatically Added Context ---
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
SamplingFactor := 0.003
* --- End of Automatically Added Context ---"
9288eb12,micro,4,,"visualize_object_model_3d (WindowHandle, RawPointData3D, [], Pose0, 'point_size', 1, 'Raw point data to be triangulated', [], Instructions, Pose)",59,62,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
create_pose (-49.9194, 43.0534, 1343.74, 199.373, 27.1203, 3.1732..."
9288eb12,micro,5,,"DescriptionText := []
ParameterNames := 'information'
ParameterValues := 'verbose'
Status := 'Performing triangulation with default settings ...'
disp_message (WindowHandle, [DescriptionText,Status], 'window', 12, 12, 'black', 'true')",69,75,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
* --- End of Automatically A..."
9288eb12,micro,6,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'greedy', ParameterNames, ParameterValues, Surface3DDefault, Info)
count_seconds (End)
TimeDefault := End - Start
force_pause (TimeDefault, ForcePause)",76,81,"* --- Automatically Added Context ---
ForcePause := 1.5
sample_object_model_3d (ObjectModel3D, 'fast', SamplingFactor * Diameter, [], [], RawPointData3D)
ParameterNames := 'information'
ParameterValue..."
9288eb12,micro,7,information is returned by triangulate_object_model_3d,* dev_inspect_ctrl (Info),82,85,"* --- Automatically Added Context ---
triangulate_object_model_3d (RawPointData3D, 'greedy', ParameterNames, ParameterValues, Surface3DDefault, Info)
* --- End of Automatically Added Context ---"
9288eb12,micro,8,,"VisParNames := ['disp_lines', 'color', 'line_color', 'alpha']
VisParValues := ['true', 'white', 'green', 0.5]
Status := 'Execution time (default settings): ' + TimeDefault$'.2' + 's'
set_system ('flush_graphic', 'false')
dev_clear_window ()
set_system ('flush_graphic', 'true')
if (OpenGLSupported)
K...",86,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
get_system_opengl_supported (WindowHandle, OpenGLSupported)
creat..."
9288eb12,micro,9,remove artifacts on the surface boundaries.,"ParameterNames := ['greedy_mesh_erosion', 'greedy_mesh_dilation']
ParameterValues := MeshMorpologyParams[0:1]",110,114,"* --- Automatically Added Context ---
MeshMorpologyParams := [4, 3, 30000]
ParameterNames := 'information'
ParameterValues := 'verbose'
* --- End of Automatically Added Context ---"
9288eb12,micro,10,,"DescriptionText := 'Mesh morphology is used to remove artifacts on the boundary'
Status := 'Performing triangulation with mesh morphology ...'
disp_message (WindowHandle, [DescriptionText,Status], 'window', 12, 12, 'black', 'true')",115,119,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
DescriptionText := []
* --- ..."
9288eb12,micro,11,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'greedy', [ParameterNames,'information'], [ParameterValues,'verbose'], Surface3DMorphology, Info)
count_seconds (End)
TimeMorphology := End - Start
force_pause (TimeMorphology, ForcePause)",120,126,"* --- Automatically Added Context ---
ForcePause := 1.5
sample_object_model_3d (ObjectModel3D, 'fast', SamplingFactor * Diameter, [], [], RawPointData3D)
ParameterNames := 'information'
ParameterValue..."
9288eb12,micro,12,,"VisParNames := ['color_0', 'color_1', 'alpha', 'disp_background']
if (OpenGLSupported)
Objects3D := [Surface3DMorphology,Surface3DDefault]
VisParValues := ['green', 'red', 0.5, 'true']
else
Objects3D := [Surface3DDefault,Surface3DMorphology]
VisParValues := ['red', 'green', 0.5, 'true']
endif
Status...",127,141,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
get_system_opengl_supported (WindowHandle, OpenGLSupported)
read_..."
9288eb12,micro,13,remove artifacts on the surface boundaries.,"ParameterNames := ['greedy_mesh_erosion', 'greedy_mesh_dilation', 'greedy_remove_small_surfaces']
ParameterValues := MeshMorpologyParams",144,149,"* --- Automatically Added Context ---
MeshMorpologyParams := [4, 3, 30000]
ParameterNames := 'information'
ParameterValues := 'verbose'
* --- End of Automatically Added Context ---"
9288eb12,micro,14,,"DescriptionText := 'Additionally you can remove undesired surface pieces.         '
Status := 'Performing triangulation with mesh morphology ...'
dev_clear_window ()
disp_object_model_3d_safe (WindowHandle, Objects3D, [], Pose, VisParNames, VisParValues)
disp_message (WindowHandle, [DescriptionText,...",150,156,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
visualize_object_model_3d (W..."
9288eb12,micro,15,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'greedy', [ParameterNames,'information'], [ParameterValues,'verbose'], Surface3DErasure, Info)
count_seconds (End)
TimeSurfaceErasure := End - Start
force_pause (TimeSurfaceErasure, ForcePause)",157,163,"* --- Automatically Added Context ---
ForcePause := 1.5
sample_object_model_3d (ObjectModel3D, 'fast', SamplingFactor * Diameter, [], [], RawPointData3D)
ParameterNames := 'information'
ParameterValue..."
9288eb12,micro,16,,"VisParNames := ['color_0', 'color_1', 'alpha', 'disp_background']
if (OpenGLSupported)
Objects3D := [Surface3DErasure,Surface3DMorphology]
VisParValues := ['green', 'red', 0.5, 'true']
else
Objects3D := [Surface3DMorphology,Surface3DErasure]
VisParValues := ['red', 'green', 0.5, 'true']
endif
Status...",164,179,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
get_system_opengl_supported (WindowHandle, OpenGLSupported)
read_..."
9288eb12,micro,17,,"ParameterNames := [ParameterNames,'greedy_kNN']
ParameterValues := [ParameterValues,10]",180,184,"* --- Automatically Added Context ---
ParameterNames := 'information'
ParameterValues := 'verbose'
* --- End of Automatically Added Context ---"
9288eb12,micro,18,,"DescriptionText := 'The number of neighbors has a direct impact over the'
DescriptionText[1] := 'triangulation speed. Reduce k-NN to 10 (default = 40)'
DescriptionText[2] := 'and compare execution times.'
Status := 'Performing triangulation with reduced number of neighbors ...'
dev_clear_window ()
d...",185,193,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
visualize_object_model_3d (W..."
9288eb12,micro,19,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'greedy', [ParameterNames,'information'], [ParameterValues,'verbose'], Surface3DkNN10, Info)
count_seconds (End)
TimeKNN10 := End - Start
force_pause (TimeKNN10, ForcePause)",194,200,"* --- Automatically Added Context ---
ForcePause := 1.5
sample_object_model_3d (ObjectModel3D, 'fast', SamplingFactor * Diameter, [], [], RawPointData3D)
ParameterNames := 'information'
ParameterValue..."
9288eb12,micro,20,,"VisParNames := 'color'
VisParValues := 'green'
Objects3D := Surface3DkNN10
Status := 'Execution time k-NN = 10: ' + TimeKNN10$'.2' + 's (compared to ' + TimeDefault$'.2' + 's (default settings))'
delayed_clear_titled_window (WindowHandle, [], 12, 12, OpenGLSupported)
visualize_object_model_3d (Windo...",201,243,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
ForcePause := 1.5
get_system_opengl_supported (WindowHandle, Open..."
9288eb12,micro,21,,"dev_clear_window ()
disp_object_model_3d_safe (WindowHandle, Objects3D, [], Pose, VisParNames, VisParValues)
disp_message (WindowHandle, 'End of program', 'window', 12, 12, 'black', 'true')
get_window_extents (WindowHandle, Row, Column, Width, Height)
get_font (WindowHandle, Font)
open_window (0, 0,...",244,398,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
ForcePause := 1.5
read_object_model_3d ('mvtec_bunny.om3', 'mm', [], [], ObjectModel3D, Status)
visualize_..."
9288eb12,micro,22,"will be applied with the next graphic operation
called after this procedure","dev_clear_window ()
if (|Title| &gt; 0)
disp_message (WindowHandle, Title, 'window', Row, Column, 'white', 'false')
endif
set_system ('flush_graphic', 'true')
return ()
OpenGLSupported := true
gen_object_model_3d_from_points (0, 0, 0, ObjectModel3D)
get_system ('opengl_info', OpenGLInfo)
if (regexp_...",399,483,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
get_system_opengl_supported (WindowHandle, OpenGLSupported)
read_object_model_3d ('mvtec_bunny.om3', 'mm',..."
5819fe97,full,0,"This example program demonstrates how to use the operator
triangulate_object_model_3d
Init visualiza...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
read_o...",11,84,
5819fe97,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'",10,18,
5819fe97,micro,2,"'implicit_octree_depth' --&gt; 6
'implicit_solver_depth' --&gt; 6
'implicit_min_num_samples' --&gt; ...","read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], ObjectModel3D, Status)",19,25,
5819fe97,micro,3,We copy only its points and normals for demonstration purposes.,"copy_object_model_3d (ObjectModel3D, ['point_coord', 'point_normal'], RawPointData3D)",26,29,"* --- Automatically Added Context ---
read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
5819fe97,micro,4,,"create_pose (-43, 47, 920, 218, 37, 352, 'Rp+T', 'gba', 'point', Pose)
visualize_object_model_3d (WindowHandle, RawPointData3D, [], Pose, 'point_size', 1, 'Raw point data to be triangulated', [], Instructions, Pose)",30,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
copy_object_model_3d (ObjectModel3D, ['point_coord', 'point_norma..."
5819fe97,micro,5,,"DescriptionText := 'Triangulation in \'implicit\' mode with default settings'
ParameterNames := 'information'
ParameterValues := 'verbose'
Status := 'This may take a minute. Please wait ...'
disp_message (WindowHandle, [DescriptionText,' ',Status], 'window', 12, 12, 'black', 'true')",41,47,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automati..."
5819fe97,micro,6,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'implicit', ParameterNames, ParameterValues, Surface3DDefault, Info)
count_seconds (End)
TimeDefault := End - Start",48,52,"* --- Automatically Added Context ---
copy_object_model_3d (ObjectModel3D, ['point_coord', 'point_normal'], RawPointData3D)
ParameterNames := 'information'
ParameterValues := 'verbose'
* --- End of Au..."
5819fe97,micro,7,information is returned by triangulate_object_model_3d,* dev_inspect_ctrl (Info),53,56,"* --- Automatically Added Context ---
triangulate_object_model_3d (RawPointData3D, 'implicit', ParameterNames, ParameterValues, Surface3DDefault, Info)
* --- End of Automatically Added Context ---"
5819fe97,micro,8,,"VisParNames := ['disp_lines', 'color', 'line_color', 'alpha']
VisParValues := ['true', 'white', 'green', 0.5]
Status := 'Execution time: ' + TimeDefault$'.2' + 's'
visualize_object_model_3d (WindowHandle, Surface3DDefault, [], Pose, VisParNames, VisParValues, [DescriptionText,Status], [], Instructio...",57,63,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], Obj..."
5819fe97,micro,9,,"ParameterNames := 'implicit_octree_depth'
ParameterValues := 7",64,68,"* --- Automatically Added Context ---
ParameterNames := 'information'
ParameterValues := 'verbose'
* --- End of Automatically Added Context ---"
5819fe97,micro,10,,"DescriptionText := 'A triangulation with a higher level of detail can be achieved'
DescriptionText[1] := 'by increasing the octree depth. This results in a longer'
DescriptionText[2] := 'execution time of the operator.'
Status := 'Performing triangulation with a deeper octree ...'
disp_message (Wind...",69,75,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], ObjectModel3D, Status)
DescriptionText := 'T..."
5819fe97,micro,11,,"count_seconds (Start)
triangulate_object_model_3d (RawPointData3D, 'implicit', [ParameterNames,'information'], [ParameterValues,'verbose'], Surface3DDepth7, Info)
count_seconds (End)
TimeDepth7 := End - Start",76,81,"* --- Automatically Added Context ---
copy_object_model_3d (ObjectModel3D, ['point_coord', 'point_normal'], RawPointData3D)
ParameterNames := 'information'
ParameterValues := 'verbose'
count_seconds (..."
5819fe97,micro,12,,"Status := 'Execution time (octree depth = 7): ' + TimeDepth7$'.2' + 's'
visualize_object_model_3d (WindowHandle, Surface3DDepth7, [], Pose, VisParNames, VisParValues, [DescriptionText,Status], [], Instructions, PoseOut)",82,90,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
read_object_model_3d ('mvtec_bunny_normals.om3', 'm', [], [], Obj..."
1f01a584,full,0,"This example shows how to use the mapping-based 3D object model
triangulation, which triangulates th...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
VisParam...",20,144,
1f01a584,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left Button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl + left button'
VisParam...",19,32,
1f01a584,micro,2,,"read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], Object, Status)
create_pose (60, 5, 1540, 110, 350, 180, 'Rp+T', 'gba', 'point', VisPose)
dev_disp_intro_text ()
stop ()",33,37,
1f01a584,micro,3,,"visualize_object_model_3d (WindowHandle1, Object, [], VisPose, VisParamNames, VisParamValues, 'Raw point data to be triangulated', [], Instructions, VisPose)",38,40,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNames := 'point_size'
VisParamValues := 1
read_object_model..."
1f01a584,micro,4,,"dev_open_window (505, 0, 600, 220, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_disp_default_triangulation ()
triangulate_object_model_3d (Object, 'xyz_mapping', [], [], TriangulatedDefault, Information0)
object_model_3d_to_xyz (X, Y, Z, Object, 'from_xyz...",43,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNamesTri := ['disp_lines', 'color', 'line_color', 'alpha', ..."
1f01a584,micro,5,"be specified. The viewing direction of the sensor is approximately
the 'direction' of the artifact t...","get_object_model_3d_params (TriangulatedDefault, 'center', Center)
create_pose (-Center[0], -Center[1], -Center[2], 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
rigid_trans_object_model_3d (TriangulatedDefault, Pose, ObjectModel3DRigidTrans)
get_object_model_3d_params (ObjectModel3DRigidTrans, 'diameter_a...",65,72,"* --- Automatically Added Context ---
create_pose (60, 5, 1540, 110, 350, 180, 'Rp+T', 'gba', 'point', VisPose)
triangulate_object_model_3d (Object, 'xyz_mapping', [], [], TriangulatedDefault, Informa..."
1f01a584,micro,6,direction for sensors.,"Direction := [0, 0, 1]
gen_arrow_object_model_3d (Diameter / 100.0, [0, 0, 0], Direction * Diameter / 3, Arrow)
dev_set_window (WindowHandle2)
dev_disp_post_proc ()
dev_set_window (WindowHandle1)
visualize_object_model_3d (WindowHandle1, [Object,Arrow], [], VisPose, VisParamNamesArrow, VisParamValue...",73,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNamesArrow := ['point_size', 'color_1']
VisParamValuesArrow..."
1f01a584,micro,7,,"triangulate_object_model_3d (Object, 'xyz_mapping', GenParams, GenValues, Triangulated, Information)
visualize_object_model_3d (WindowHandle1, Triangulated, [], VisPose, VisParamNamesTri, VisParamValuesTri, 'Final xyz-mapping triangulation with post-processing', [], Instructions, VisPose)
Text := 'T...",83,150,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
Instructions := 'Rotate: Left Button'
VisParamNamesTri := ['disp_lines', 'color', 'line_color', 'alpha', ..."
d26b956d,full,0,"This example program shows the usage of the procedure
xyz_attrib_to_object_model_3d.
It can be used ...","dev_update_off ()
dev_close_window ()
read_image (Z, 'mreut_dgm_2.0.tif')
get_image_size (Z, Width, Height)
read_image (AerialImage, 'mreut4_3.png')
auto_threshold (AerialImage, Regions, 4)
region_to_label (Regions, LabelImage, 'byte', Width, Height)
compose2 (AerialImage, LabelImage, MultiChannelAt...",12,77,
d26b956d,micro,1,,"dev_update_off ()
dev_close_window ()",11,14,
d26b956d,micro,2,,"read_image (Z, 'mreut_dgm_2.0.tif')
get_image_size (Z, Width, Height)",15,18,
d26b956d,micro,3,to the 3D object model as attribute.,"read_image (AerialImage, 'mreut4_3.png')",19,22,
d26b956d,micro,4,"In this case, we label different terrain types very simply,
just for demonstration purposes.","auto_threshold (AerialImage, Regions, 4)
region_to_label (Regions, LabelImage, 'byte', Width, Height)",23,28,"* --- Automatically Added Context ---
get_image_size (Z, Width, Height)
read_image (AerialImage, 'mreut4_3.png')
* --- End of Automatically Added Context ---"
d26b956d,micro,5,,"compose2 (AerialImage, LabelImage, MultiChannelAttribImage)",29,31,"* --- Automatically Added Context ---
read_image (AerialImage, 'mreut4_3.png')
region_to_label (Regions, LabelImage, 'byte', Width, Height)
* --- End of Automatically Added Context ---"
d26b956d,micro,6,,"GroundResolution := 2.0
gen_image_surface_first_order (X, 'real', 0, GroundResolution, 0, 0, 0, Width, Height)
gen_image_surface_first_order (Y, 'real', -GroundResolution, 0, 0, 0, 0, Width, Height)",34,38,"* --- Automatically Added Context ---
get_image_size (Z, Width, Height)
* --- End of Automatically Added Context ---"
d26b956d,micro,7,"the X, Y and Z image and adds the information contained
in the attribute image to each point.","AttribName := ['&amp;gray', '&amp;terrain']
xyz_attrib_to_object_model_3d (X, Y, Z, MultiChannelAttribImage, AttribName, ObjectModel3D)",39,44,"* --- Automatically Added Context ---
read_image (Z, 'mreut_dgm_2.0.tif')
compose2 (AerialImage, LabelImage, MultiChannelAttribImage)
gen_image_surface_first_order (X, 'real', 0, GroundResolution, 0, ..."
d26b956d,micro,8,,"dev_open_window (Height / 2, 0, Width / 2, Height / 2, 'black', WindowHandle1)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_color (['red', 'green', 'blue'])
dev_set_draw ('fill')
dev_display (Regions)
disp_message (WindowHandle1, 'T...",45,67,"* --- Automatically Added Context ---
read_image (Z, 'mreut_dgm_2.0.tif')
get_image_size (Z, Width, Height)
read_image (AerialImage, 'mreut4_3.png')
auto_threshold (AerialImage, Regions, 4)
* --- End ..."
d26b956d,micro,9,,"prepare_object_model_3d (ObjectModel3D, 'segmentation', 'true', [], [])",68,69,"* --- Automatically Added Context ---
xyz_attrib_to_object_model_3d (X, Y, Z, MultiChannelAttribImage, AttribName, ObjectModel3D)
* --- End of Automatically Added Context ---"
d26b956d,micro,10,,"create_pose (-620, -85, 17000, 135, 2, 10, 'Rp+T', 'gba', 'point', Pose)
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
visualize_object_model_3d (WindowHandle3, ObjectModel3D, [], Pose, ['color_attrib', 'color_attri...",70,83,"* --- Automatically Added Context ---
xyz_attrib_to_object_model_3d (X, Y, Z, MultiChannelAttribImage, AttribName, ObjectModel3D)
dev_open_window (0, Width / 2 + 8, Width, Height, 'gray', WindowHandle..."
aefcd61e,full,0,"Example program to demonstrate the operator binocular_disparity
A pair of epipolar images (which are...","Width := 512
Height := 512
dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle1)
dev_open_window (0, Width / 2 + 12, Width / 2, Height / 2, 'black', WindowHandle2)
dev_open_window (Height / 2 + 62, 0, Width / 2, Height / 2, 'black', WindowHandle3...",11,29,
aefcd61e,micro,1,"horizontal epipolar lines) will be processed.
------------------------------------------------------...","Width := 512
Height := 512
dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle1)
dev_open_window (0, Width / 2 + 12, Width / 2, Height / 2, 'black', WindowHandle2)
dev_open_window (Height / 2 + 62, 0, Width / 2, Height / 2, 'black', WindowHandle3...",8,17,
aefcd61e,micro,2,,"Path := 'stereo/epipolar/'
read_image (LImage, Path + 'baseball_l')
dev_set_window (WindowHandle1)
dev_display (LImage)
read_image (RImage, Path + 'baseball_r')
dev_set_window (WindowHandle2)
dev_display (RImage)
binocular_disparity (LImage, RImage, DisparityNCC, Score, 'ncc', 11, 11, 0, -45, 10, 3,...",18,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle1)
dev_open_window (0, Width / 2 + 12, Width / 2, Height / 2, 'black', WindowHandle2)
dev_open_..."
ed1f96f2,full,0,"This example program compares the three stereo operators
binocular_disparity, binocular_disparity_ms...","dev_update_off ()
read_image (ImageRectifiedL, 'stereo/middlebury_cones/im2.png')
read_image (ImageRectifiedR, 'stereo/middlebury_cones/im6.png')
get_image_size (ImageRectifiedL, Width, Height)
MaxTotalWidth := 1000
Scale := MaxTotalWidth / (3. * Width)
Width := Scale * Width
Height := Scale * Heigh...",22,106,
ed1f96f2,micro,1,"High-accuracy stereo depth maps using structured light.
In IEEE Computer Society Conference on
Compu...",dev_update_off (),17,22,
ed1f96f2,micro,2,,"read_image (ImageRectifiedL, 'stereo/middlebury_cones/im2.png')
read_image (ImageRectifiedR, 'stereo/middlebury_cones/im6.png')
get_image_size (ImageRectifiedL, Width, Height)
MaxTotalWidth := 1000
Scale := MaxTotalWidth / (3. * Width)
Width := Scale * Width
Height := Scale * Height
dev_close_window...",23,35,
ed1f96f2,micro,3,,"read_image (GroundTruth, 'stereo/middlebury_cones/disp2.png')
read_image (Occlusions, 'stereo/middlebury_cones/occl.png')
gen_empty_region (RegionKnown)
threshold (Occlusions, RegionKnown, 1, 256)
change_domain (GroundTruth, RegionKnown, GroundTruth)
convert_image_type (GroundTruth, GroundTruth, 're...",36,55,"* --- Automatically Added Context ---
get_image_size (ImageRectifiedL, Width, Height)
* --- End of Automatically Added Context ---"
ed1f96f2,micro,4,,"MaskWidth := 7
MaskHeight := 7",56,58,
ed1f96f2,micro,5,,"count_seconds (S1)
binocular_disparity (ImageRectifiedL, ImageRectifiedR, Disparity, Score, 'ncc', MaskWidth, MaskHeight, 0, MinDisp, MaxDisp, 1, -1, 'none', 'interpolation')
count_seconds (S2)",59,62,"* --- Automatically Added Context ---
read_image (ImageRectifiedL, 'stereo/middlebury_cones/im2.png')
read_image (ImageRectifiedR, 'stereo/middlebury_cones/im6.png')
gray_features (RegionKnown, Ground..."
ed1f96f2,micro,6,,"sub_image (Disparity, GroundTruth, ImageSub, 1, 0)
threshold (ImageSub, RegionGood, -1, 1)
region_features (RegionGood, 'area', Good)
Error := 1 - Good / Known
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (Disparity)
disp_message (WindowHandle1, 'binocular_disparity\nerror: ' + (10...",63,71,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
read_image (GroundTruth, 'stereo/middlebury_cones/disp2.png')
gen_empty_region (RegionGood)
region_f..."
ed1f96f2,micro,7,,"SurfaceSmoothing := 39
EdgeSmoothing := 49",72,74,
ed1f96f2,micro,8,,"count_seconds (S1)
binocular_disparity_ms (ImageRectifiedL, ImageRectifiedR, Disparity, Score, MinDisp, MaxDisp, SurfaceSmoothing, EdgeSmoothing, 'consistency_check', 'false')
count_seconds (S2)",75,78,"* --- Automatically Added Context ---
read_image (ImageRectifiedL, 'stereo/middlebury_cones/im2.png')
read_image (ImageRectifiedR, 'stereo/middlebury_cones/im6.png')
gray_features (RegionKnown, Ground..."
ed1f96f2,micro,9,,"sub_image (Disparity, GroundTruth, ImageSub, 1, 0)
threshold (ImageSub, RegionGood, -1, 1)
region_features (RegionGood, 'area', Good)
Error := 1 - Good / Known
dev_set_window (WindowHandle2)
dev_clear_window ()
dev_display (Disparity)
disp_message (WindowHandle2, 'binocular_disparity_ms\nerror: ' + ...",79,87,"* --- Automatically Added Context ---
read_image (GroundTruth, 'stereo/middlebury_cones/disp2.png')
gen_empty_region (RegionGood)
region_features (RegionKnown, 'area', Known)
dev_open_window (0, Width..."
ed1f96f2,micro,10,,"GrayConstancy := 6
GradientConstancy := 12
Smoothness := 15
DefaultParameters := 'very_accurate'",88,92,
ed1f96f2,micro,11,,"count_seconds (S1)
binocular_disparity_mg (ImageRectifiedL, ImageRectifiedR, Disparity, Score, GrayConstancy, GradientConstancy, Smoothness, 0, 'false', 'default_parameters', DefaultParameters)
count_seconds (S2)",93,96,"* --- Automatically Added Context ---
read_image (ImageRectifiedL, 'stereo/middlebury_cones/im2.png')
read_image (ImageRectifiedR, 'stereo/middlebury_cones/im6.png')
binocular_disparity (ImageRectifie..."
ed1f96f2,micro,12,,"sub_image (Disparity, GroundTruth, ImageSub, 1, 0)
threshold (ImageSub, RegionGood, -1, 1)
region_features (RegionGood, 'area', Good)
Error := 1 - Good / Known
dev_open_window (0, 2 * (Width + 8), Width, Height, 'black', WindowHandle3)
get_window_extents (WindowHandle3, Row, Column, Width1, Height1)...",97,112,"* --- Automatically Added Context ---
get_image_size (ImageRectifiedL, Width, Height)
read_image (GroundTruth, 'stereo/middlebury_cones/disp2.png')
gen_empty_region (RegionGood)
region_features (Regio..."
a7e90820,full,0,"This example program shows how to use binocular_disparity_mg to
determine the disparities of the com...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_cam_par_area_scan_division (0.0130507774353, -6...",9,45,
a7e90820,micro,1,"determine the disparities of the components on a PCB with different
levels of accuracy.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')",6,14,
a7e90820,micro,2,binocular_calibration.,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",15,19,
a7e90820,micro,3,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",20,21,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
a7e90820,micro,4,,"map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
dev_clear_window ()
dev_display (ImageRectifiedL)
disp_message (WindowHandle, 'Left stereo image', 'window', 0, 0, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",22,29,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_binocula..."
a7e90820,micro,5,,"DefaultParameters := ['fast', 'fast_accurate', 'accurate', 'very_accurate']
for I := 0 to |DefaultParameters| - 1 by 1
Parameters := DefaultParameters[I]
count_seconds (S1)
binocular_disparity_mg (ImageRectifiedL, ImageRectifiedR, Disparity, Score, 1, 10, 5, 0, 'false', 'default_parameters', Paramet...",30,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
* --- End of Automatic..."
4142675d,full,0,"This example demonstrates the functionality binocular_disparity_ms
It explains the most important pa...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'The operator \'binocular_disparity_ms\' computes'
Message[1] := 'the disparities of a rectified stereo image pair'
Message[2] := 'usi...",9,123,
4142675d,micro,1,"It explains the most important parameters and
calculates the disparities of the components on a PCB","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'The operator \'binocular_disparity_ms\' computes'
Message[1] := 'the disparities of a rectified stereo image pair'
Message[2] := 'usi...",6,20,
4142675d,micro,2,binocular_calibration.,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",21,25,
4142675d,micro,3,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",26,27,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
4142675d,micro,4,,"map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
dev_clear_window ()
dev_display (ImageRectifiedL)
disp_message (WindowHandle, 'Left stereo image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",28,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_binocula..."
4142675d,micro,5,,"SurfaceSmoothing := [0, 10, 20, 30, 40, 50, 0, 0, 0, 0, 0, 30]
EdgeSmoothing := [0, 0, 0, 0, 0, 0, 10, 20, 30, 40, 50, 20]
for I := 0 to |SurfaceSmoothing| - 1 by 1
dev_clear_window ()
binocular_disparity_ms (ImageRectifiedL, ImageRectifiedR, Disparity, Score, 20, 40, SurfaceSmoothing[I], EdgeSmooth...",36,129,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
Message := 'The operator \'binocular_disparity_ms\' computes'
map_image (ImageL, MapL, ImageRectifiedL)
ma..."
64c21c9d,full,0,"Example program to illustrate the 'binocular_disparity' operator.
The program generates an artificia...","dev_update_window ('off')
Width := 320
Height := 240
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'gray', WindowHandle1)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, Width + 12, W...",12,95,
64c21c9d,micro,1,"images hide a circle in front of a background with same kind of texture. The disparities will be
cal...","dev_update_window ('off')
Width := 320
Height := 240
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'gray', WindowHandle1)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, Width + 12, W...",8,39,
64c21c9d,micro,2,,"min_max_gray (Disparity1, Disparity1, 0, Min, Max, Range)
scale_image (Disparity1, Disparity1, Max * 255 / (Max - Min), Min)
convert_image_type (Disparity1, ByteDisparity, 'byte')
binary_threshold (ByteDisparity, SegmCircle, 'max_separability', 'dark', UsedThreshold)
smallest_circle (SegmCircle, Row...",40,45,"* --- Automatically Added Context ---
binocular_disparity (Image1, Image2, Disparity1, Score1, 'sad', 11, 11, 0, -30, 30, 2, 30, 'left_right_check', 'interpolation')
* --- End of Automatically Added C..."
64c21c9d,micro,3,,"gen_circle (Circle, Row, Column, Radius)
dev_display (Circle)
dev_set_window (WindowHandle1)
dev_display (Image1)
dev_display (Circle)
disp_message (WindowHandle1, 'Left image', 'window', 12, 12, 'black', 'true')",46,71,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'gray', WindowHandle1)
gen_binocular_image_pair (Image1, Image2, -22.5, 18.7, Width, Height)
disp_message (WindowHandle1, 'L..."
64c21c9d,micro,4,,"gen_image_const (BackgroundImage, 'byte', Width, Height)
gen_image_proto (BackgroundImage, BackgroundImage, 128)
add_noise_white (BackgroundImage, BackgroundImage, 100)",72,75,"* --- Automatically Added Context ---
Width := 320
Height := 240
* --- End of Automatically Added Context ---"
64c21c9d,micro,5,,"gen_image_const (CircleImage, 'byte', Width, Height)
gen_image_proto (CircleImage, CircleImage, 128)
add_noise_white (CircleImage, CircleImage, 70)
gen_circle (Circle, Height / 2, Width / 2, 50.5)
reduce_domain (CircleImage, Circle, CircleImage)",76,82,"* --- Automatically Added Context ---
Width := 320
Height := 240
gen_circle (Circle, Row, Column, Radius)
* --- End of Automatically Added Context ---"
64c21c9d,micro,6,,"paint_gray (CircleImage, BackgroundImage, Image1)",83,85,"* --- Automatically Added Context ---
gen_binocular_image_pair (Image1, Image2, -22.5, 18.7, Width, Height)
gen_image_const (BackgroundImage, 'byte', Width, Height)
gen_image_const (CircleImage, 'byte..."
64c21c9d,micro,7,,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, 0, BackgroundDisparity, HomMat2DBackground)
affine_trans_image (BackgroundImage, Image2, HomMat2DBackground, 'constant', 'false')
hom_mat2d_translate (HomMat2DIdentity, 0, ObjectDisparity, HomMat2DCircle)
affine_trans_image...",86,109,"* --- Automatically Added Context ---
gen_binocular_image_pair (Image1, Image2, -22.5, 18.7, Width, Height)
gen_circle (Circle, Row, Column, Radius)
gen_image_const (BackgroundImage, 'byte', Width, He..."
2efc0659,full,0,"This example program shows how to use binocular_distance_mg to determine
the depth of the components...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_cam_par_area_scan_division (0.0130507774353, -6...",8,33,
2efc0659,micro,1,the depth of the components on a PCB with high accuracy.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')",6,13,
2efc0659,micro,2,binocular_calibration.,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",14,18,
2efc0659,micro,3,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",19,20,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
2efc0659,micro,4,,"map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
dev_clear_window ()
dev_display (ImageRectifiedL)
disp_message (WindowHandle, 'Left stereo image', 'window', 0, 0, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",21,28,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_binocula..."
2efc0659,micro,5,,"binocular_distance_mg (ImageRectifiedL, ImageRectifiedR, Distance, Score, RectCamParL, RectCamParR, RectLPosRectR, 1, 10, 5, 0, 'false', 'default_parameters', 'accurate')
dev_clear_window ()
dev_display (Distance)
disp_message (WindowHandle, 'Distances', 'window', 0, 0, 'black', 'true')",29,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilin..."
3eddf204,full,0,"This example program shows how to use binocular_distance_ms
to determine the depth of the components...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_cam_par_area_scan_division (0.0130507774353, -6...",8,33,
3eddf204,micro,1,to determine the depth of the components on a PCB.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')",6,13,
3eddf204,micro,2,binocular_calibration.,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",14,18,
3eddf204,micro,3,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",19,20,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
3eddf204,micro,4,,"map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
dev_clear_window ()
dev_display (ImageRectifiedL)
disp_message (WindowHandle, 'Left stereo image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",21,28,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
gen_binocula..."
3eddf204,micro,5,,"binocular_distance_ms (ImageRectifiedL, ImageRectifiedR, Distance, Score, RectCamParL, RectCamParR, RelPose, 20, 40, 30, 20, [], [])
dev_clear_window ()
dev_display (Distance)
disp_message (WindowHandle, 'Distances', 'window', 12, 12, 'black', 'true')",29,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
create_pose (0.153573, -0.003734, 0.044735, 0.174289, 319.843388, 359.894955, 'Rp+T', 'gba', 'point', RelP..."
f5189650,full,0,"This example describes how to use the operator
'disparity_image_to_xyz'.
The usage of the operator i...","dev_close_window ()
dev_update_off ()
dev_set_preferences ('graphics_window_context_menu', 'false')
ImagePath := 'stereo/board/'
Image1 := ImagePath + '/board_l_01'
Image2 := ImagePath + '/board_r_01'
gen_cam_par_area_scan_division (0.0131205, -665.85466, 1.4803422e-005, 1.48e-005, 155.90117, 126.70...",20,99,
f5189650,micro,1,,"dev_close_window ()
dev_update_off ()
dev_set_preferences ('graphics_window_context_menu', 'false')",19,23,
f5189650,micro,2,,"ImagePath := 'stereo/board/'
Image1 := ImagePath + '/board_l_01'
Image2 := ImagePath + '/board_r_01'",24,28,
f5189650,micro,3,,"gen_cam_par_area_scan_division (0.0131205, -665.85466, 1.4803422e-005, 1.48e-005, 155.90117, 126.703971, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131712, -728.9579, 1.4799849e-005, 1.48e-005, 163.265701, 119.310684, 320, 240, CamParamR)
create_pose (0.15350044, -0.003732778, 0.0448171...",29,33,
f5189650,micro,4,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",37,39,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0131205, -665.85466, 1.4803422e-005, 1.48e-005, 155.90117, 126.703971, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.01..."
f5189650,micro,5,,"read_image (ImageL, Image1)
read_image (ImageR, Image2)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",40,45,"* --- Automatically Added Context ---
Image1 := ImagePath + '/board_l_01'
Image2 := ImagePath + '/board_r_01'
ImagePath := 'stereo/board/'
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamPa..."
f5189650,micro,6,,"get_image_size (ImageRectifiedL, WidthL, HeightL)
dev_open_window (0, 0, WidthL, HeightL, 'white', WindowHandle1)
set_display_font (WindowHandle1, 11, 'mono', 'true', 'false')
dev_display (ImageRectifiedL)
disp_message (WindowHandle1, 'Left rectified image', 'window', 10, 10, 'black', 'true')",46,52,"* --- Automatically Added Context ---
map_image (ImageL, MapL, ImageRectifiedL)
* --- End of Automatically Added Context ---"
f5189650,micro,7,,"dev_open_window (0, WidthL + 10, WidthL, HeightL, 'white', WindowHandle2)
set_display_font (WindowHandle2, 11, 'mono', 'true', 'false')
dev_display (ImageRectifiedL)
disp_message (WindowHandle2, 'Right rectified image', 'window', 10, 10, 'black', 'true')
disp_continue_message (WindowHandle2, 'black'...",53,60,"* --- Automatically Added Context ---
map_image (ImageL, MapL, ImageRectifiedL)
get_image_size (ImageRectifiedL, WidthL, HeightL)
* --- End of Automatically Added Context ---"
f5189650,micro,8,,"binocular_disparity (ImageRectifiedL, ImageRectifiedR, DisparityImage, Score, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'none')",61,63,"* --- Automatically Added Context ---
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)
* --- End of Automatically Added Context ---"
f5189650,micro,9,,"get_domain (DisparityImage, RegionInpainting)
complement (RegionInpainting, RegionInpainting)
full_domain (DisparityImage, DisparityImage)
harmonic_interpolation (DisparityImage, RegionInpainting, DisparityImage, 0.001)",64,69,"* --- Automatically Added Context ---
binocular_disparity (ImageRectifiedL, ImageRectifiedR, DisparityImage, Score, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'none')
* --- End of Automatic..."
f5189650,micro,10,,"dev_set_window (WindowHandle1)
dev_display (DisparityImage)
disp_message (WindowHandle1, 'Disparity image', 'window', 10, 10, 'black', 'true')",70,74,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'white', WindowHandle1)
binocular_disparity (ImageRectifiedL, ImageRectifiedR, DisparityImage, Score, 'ncc', 17, 17, 5, 10..."
f5189650,micro,11,"The gray values in X, Y and Z represent the x, y, and z
coordinates of the pixels (Row, Column).","disparity_image_to_xyz (DisparityImage, X, Y, Z, RectCamParL, RectCamParR, RectLPosRectR)",78,82,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
f5189650,micro,12,,"scale_image (Z, Z, 2, 0)",86,88,"* --- Automatically Added Context ---
disparity_image_to_xyz (DisparityImage, X, Y, Z, RectCamParL, RectCamParR, RectLPosRectR)
* --- End of Automatically Added Context ---"
f5189650,micro,13,,"threshold (Z, Regions, 0.415, 0.5)
reduce_domain (Z, Regions, ZThresholded)",89,92,"* --- Automatically Added Context ---
disparity_image_to_xyz (DisparityImage, X, Y, Z, RectCamParL, RectCamParR, RectLPosRectR)
* --- End of Automatically Added Context ---"
f5189650,micro,14,,"xyz_attrib_to_object_model_3d (X, Y, ZThresholded, ImageRectifiedL, '&amp;gray', ObjectModel3D)",93,95,"* --- Automatically Added Context ---
map_image (ImageL, MapL, ImageRectifiedL)
disparity_image_to_xyz (DisparityImage, X, Y, Z, RectCamParL, RectCamParR, RectLPosRectR)
reduce_domain (Z, Regions, ZTh..."
f5189650,micro,15,,"prepare_object_model_3d (ObjectModel3D, 'segmentation', 'true', 'max_area_holes', 100)
create_pose (-0.025, -0.37, 1.7, 300, 12, 180, 'Rp+T', 'gba', 'point', Pose)
visualize_object_model_3d (WindowHandle2, ObjectModel3D, [], Pose, 'color_attrib', '&amp;gray', [], [], [], PoseOut)",96,105,"* --- Automatically Added Context ---
create_pose (0.15350044, -0.003732778, 0.04481715, 0.1736607, 319.8612, 359.8945, 'Rp+T', 'gba', 'point', RelPose)
dev_open_window (0, WidthL + 10, WidthL, Height..."
67b93e60,full,0,"Example program to illustrate the operator 'disparity_to_point_3d'
The following algorithm is perfor...","roty := 15
base := 0.08
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
pose_to_hom_mat3d (c1Pc2_model, c1Tc2_model)
Width := 320
Height := 240
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, ...",18,118,
67b93e60,micro,1,"e.g., the 3D points of the calibration plate are reconstructed and
the results are compared with the...","roty := 15
base := 0.08
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
pose_to_hom_mat3d (c1Pc2_model, c1Tc2_model)",12,22,
67b93e60,micro,2,,"Width := 320
Height := 240
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1",23,28,
67b93e60,micro,3,,"dev_close_window ()
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
dev_update_window ('off')
dev_open_window (0, Width + 4, Width, Height, 'black', WindowHandle2)
dev_update_window ('off')",29,36,"* --- Automatically Added Context ---
Width := 320
Height := 240
* --- End of Automatically Added Context ---"
67b93e60,micro,4,,"dist := 0.15
create_pose (base / 2.0 * cos(rad(roty)) - dist * sin(rad(roty)), 0, base / 2.0 * sin(rad(roty)) + dist * cos(rad(roty)), 0, -roty, 0, 'Rp+T', 'gba', 'point', c1Ptab)
pose_to_hom_mat3d (c1Ptab, c1Ttab)
pose_invert (c1Pc2_model, c2Pc1_model)
pose_compose (c2Pc1_model, c1Ptab, c2Ptab)",37,43,"* --- Automatically Added Context ---
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
* --- End of Automatically Added Context ---"
67b93e60,micro,5,,"sim_caltab (TabImage1, 'caltab_30mm.descr', AVTCam1, c1Ptab, 128, 224, 80, 0.5)
sim_caltab (TabImage2, 'caltab_30mm.descr', AVTCam2, c2Ptab, 128, 224, 80, 0.5)",44,46,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
* --- End of Automatically Adde..."
67b93e60,micro,6,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (TabImage1)
dev_set_window (WindowHandle2)
dev_clear_window ()
dev_display (TabImage2)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",47,56,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
dev_open_window (0, Width + 4, Width, Height, 'black', WindowHandle2)
sim_caltab (TabImage1, 'caltab..."
67b93e60,micro,7,,"gen_binocular_rectification_map (Map1, Map2, AVTCam1, AVTCam2, c1Pc2_model, 1, 'viewing_direction', 'bilinear', CamParamRect1, CamParamRect2, CamPoseRect1, CamPoseRect2, RelPoseRect)
map_image (TabImage1, Map1, ImageMapped1)
map_image (TabImage2, Map2, ImageMapped2)
dev_set_window (WindowHandle1)
de...",57,69,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
dev_open_window (0, 0, Width, H..."
67b93e60,micro,8,,"find_caltab (ImageMapped1, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (ImageMapped1, Caltab, 'caltab_30mm.descr', CamParamRect1, 128, 10, 18, 0.9, 15, 100, RCoord1, CCoord1, StartPose1)
find_caltab (ImageMapped2, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (ImageMapp...",70,74,"* --- Automatically Added Context ---
gen_binocular_rectification_map (Map1, Map2, AVTCam1, AVTCam2, c1Pc2_model, 1, 'viewing_direction', 'bilinear', CamParamRect1, CamParamRect2, CamPoseRect1, CamPos..."
67b93e60,micro,9,( the difference in row should be smaller than 1 pixel for a good usable epipolar rectification),"EpipolError := max(abs(RCoord2 - RCoord1))
if (EpipolError &gt; 1.0)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()
endif",75,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
find_marks_and_pose (ImageMapped1, Caltab, 'caltab_30mm.descr', CamParamRect1, 128, 10, 18, 0.9, 15,..."
67b93e60,micro,10,,"dev_set_window (WindowHandle1)
dev_set_color ('red')
disp_cross (WindowHandle1, RCoord1, CCoord1, 6, 0)
dev_set_window (WindowHandle2)
dev_set_color ('green')
disp_cross (WindowHandle2, RCoord2, CCoord2, 6, 0)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",83,92,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
dev_open_window (0, Width + 4, Width, Height, 'black', WindowHandle2)
find_marks_and_pose (ImageMapp..."
67b93e60,micro,11,get the disparity values of the corresponding calibration points,Disparity := CCoord2 - CCoord1,93,95,"* --- Automatically Added Context ---
find_marks_and_pose (ImageMapped1, Caltab, 'caltab_30mm.descr', CamParamRect1, 128, 10, 18, 0.9, 15, 100, RCoord1, CCoord1, StartPose1)
find_marks_and_pose (Image..."
67b93e60,micro,12,,"disparity_to_distance (CamParamRect1, CamParamRect2, RelPoseRect, Disparity, Distance)
disparity_to_point_3d (CamParamRect1, CamParamRect2, RelPoseRect, RCoord1, CCoord1, Disparity, X, Y, Z)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",96,101,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
gen_binocular_rectification_map (Map1, Map2, AVTCam1, AVTCam2, c1Pc2_model, 1, 'viewing_direction', ..."
67b93e60,micro,13,"!!! transform the reconstructed caltab points from the rectified coordinate system of camera 1
into ...","pose_to_hom_mat3d (CamPoseRect1, c1Trect1)
affine_trans_point_3d (c1Trect1, X, Y, Z, c1X, c1Y, c1Z)",102,106,"* --- Automatically Added Context ---
gen_binocular_rectification_map (Map1, Map2, AVTCam1, AVTCam2, c1Pc2_model, 1, 'viewing_direction', 'bilinear', CamParamRect1, CamParamRect2, CamPoseRect1, CamPos..."
67b93e60,micro,14,,"caltab_points ('caltab_30mm.descr', CalX, CalY, CalZ)
affine_trans_point_3d (c1Ttab, CalX, CalY, CalZ, c1CalX, c1CalY, c1CalZ)",107,110,
67b93e60,micro,15,,"tuple_sub (c1X, c1CalX, XDiff)
tuple_sub (c1Y, c1CalY, YDiff)
tuple_sub (c1Z, c1CalZ, ZDiff)",111,114,
67b93e60,micro,16,THE END :),"dev_close_window ()
dev_clear_window ()",115,124,
1442cb4e,full,0,"Example program to illustrate the operator 'intersect_lines_of_sight'
The following algorithm is per...","roty := 15
base := 0.08
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
pose_to_hom_mat3d (c1Pc2_model, c1Tc2_model)
Width := 320
Height := 240
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, ...",17,119,
1442cb4e,micro,1,"1) Two cameras are defined;
2) One (virtual) calibration plate is projected into both cameras;
3) Th...","roty := 15
base := 0.08
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
pose_to_hom_mat3d (c1Pc2_model, c1Tc2_model)",8,21,
1442cb4e,micro,2,,"Width := 320
Height := 240
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1",22,27,
1442cb4e,micro,3,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle2)",28,34,"* --- Automatically Added Context ---
Width := 320
Height := 240
* --- End of Automatically Added Context ---"
1442cb4e,micro,4,,"dist := 0.15
create_pose (base / 2.0 * cos(rad(roty)) - dist * sin(rad(roty)), 0, base / 2.0 * sin(rad(roty)) + dist * cos(rad(roty)), 0, -roty, 0, 'Rp+T', 'gba', 'point', c1Ptab)
pose_to_hom_mat3d (c1Ptab, c1Ttab)
pose_invert (c1Pc2_model, c2Pc1_model)
pose_compose (c2Pc1_model, c1Ptab, c2Ptab)",35,41,"* --- Automatically Added Context ---
create_pose (base * cos(rad(roty)), 0, base * sin(rad(roty)), 0, -2 * roty, 0, 'Rp+T', 'gba', 'point', c1Pc2_model)
* --- End of Automatically Added Context ---"
1442cb4e,micro,5,,"sim_caltab (TabImage1, 'caltab_30mm.descr', AVTCam1, c1Ptab, 128, 224, 80, 0.5)
sim_caltab (TabImage2, 'caltab_30mm.descr', AVTCam2, c2Ptab, 128, 224, 80, 0.5)",42,44,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
* --- End of Automatically Adde..."
1442cb4e,micro,6,,"dev_set_window (WindowHandle1)
dev_display (TabImage1)
dev_set_window (WindowHandle2)
dev_display (TabImage2)",45,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle2)
sim_caltab (TabImage1, 'calta..."
1442cb4e,micro,7,,"find_caltab (TabImage1, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (TabImage1, Caltab, 'caltab_30mm.descr', AVTCam1, 128, 10, 18, 0.9, 15, 100, RCoord1, CCoord1, StartPose1)
find_caltab (TabImage2, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (TabImage2, Caltab, 'calt...",51,64,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
dev_open_window (0, 0, Width, H..."
1442cb4e,micro,8,,"intersect_lines_of_sight (AVTCam1, AVTCam2, c1Pc2_model, RCoord1, CCoord1, RCoord2, CCoord2, X, Y, Z, Dist)",65,67,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
find_marks_and_pose (TabImage1,..."
1442cb4e,micro,9,,"caltab_points ('caltab_30mm.descr', CalX, CalY, CalZ)
affine_trans_point_3d (c1Ttab, CalX, CalY, CalZ, c1CalX, c1CalY, c1CalZ)",68,71,
1442cb4e,micro,10,,"tuple_sub (X, c1CalX, XDiff)
tuple_sub (Y, c1CalY, YDiff)
tuple_sub (Z, c1CalZ, ZDiff)",72,75,"* --- Automatically Added Context ---
intersect_lines_of_sight (AVTCam1, AVTCam2, c1Pc2_model, RCoord1, CCoord1, RCoord2, CCoord2, X, Y, Z, Dist)
* --- End of Automatically Added Context ---"
1442cb4e,micro,11,,"disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",76,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
* --- End of Automatically Added Context ---"
1442cb4e,micro,12,,"gen_binocular_rectification_map (Map1, Map2, AVTCam1, AVTCam2, c1Pc2_model, 1, 'viewing_direction', 'bilinear', CamParamRect1, CamParamRect2, CamPoseRect1, CamPoseRect2, RelPoseRect)
map_image (TabImage1, Map1, ImageMapped1)
map_image (TabImage2, Map2, ImageMapped2)
dev_set_window (WindowHandle1)
de...",83,93,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0085, -1000.0, 7.4e-6, 7.4e-6, Width / 2, Height / 2, Width, Height, AVTCam1)
AVTCam2 := AVTCam1
dev_open_window (0, 0, Width, H..."
1442cb4e,micro,13,,"find_caltab (ImageMapped1, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (ImageMapped1, Caltab, 'caltab_30mm.descr', CamParamRect1, 128, 10, 18, 0.9, 15, 100, RCoord1, CCoord1, StartPose1)
find_caltab (ImageMapped2, Caltab, 'caltab_30mm.descr', 3, 112, 5)
find_marks_and_pose (ImageMapp...",94,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle2)
find_caltab (TabImage1, Calta..."
1442cb4e,micro,14,,"intersect_lines_of_sight (CamParamRect1, CamParamRect2, RelPoseRect, RCoord1, CCoord1, RCoord2, CCoord2, X, Y, Z, Dist)",108,110,"* --- Automatically Added Context ---
find_marks_and_pose (TabImage1, Caltab, 'caltab_30mm.descr', AVTCam1, 128, 10, 18, 0.9, 15, 100, RCoord1, CCoord1, StartPose1)
find_marks_and_pose (TabImage2, Cal..."
1442cb4e,micro,15,into the *original* coordinate system of camera 1,"pose_to_hom_mat3d (CamPoseRect1, c1Trect1)
affine_trans_point_3d (c1Trect1, X, Y, Z, c1X, c1Y, c1Z)",111,115,"* --- Automatically Added Context ---
intersect_lines_of_sight (AVTCam1, AVTCam2, c1Pc2_model, RCoord1, CCoord1, RCoord2, CCoord2, X, Y, Z, Dist)
gen_binocular_rectification_map (Map1, Map2, AVTCam1, ..."
1442cb4e,micro,16,,"tuple_sub (c1X, c1CalX, XDiff)
tuple_sub (c1Y, c1CalY, YDiff)
tuple_sub (c1Z, c1CalZ, ZDiff)",116,119,"* --- Automatically Added Context ---
tuple_sub (X, c1CalX, XDiff)
tuple_sub (Y, c1CalY, YDiff)
tuple_sub (Z, c1CalZ, ZDiff)
* --- End of Automatically Added Context ---"
0440c1d7,full,0,"This example shows how to use match_fundamental_matrix_distortion_ransac
in an application in which ...","dev_update_off ()
read_image (Image1, 'stereo/uncalib/books_r')
read_image (Image2, 'stereo/uncalib/books_l')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
d...",19,101,
0440c1d7,micro,1,,dev_update_off (),18,19,
0440c1d7,micro,2,,"read_image (Image1, 'stereo/uncalib/books_r')
read_image (Image2, 'stereo/uncalib/books_l')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image2...",20,35,
0440c1d7,micro,3,,"points_foerstner (Image1, 1, 2, 3, 100, 0.1, 'gauss', 'true', Rows1, Columns1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2, 1, 2, 3, 100, 0.1, 'gauss', 'true', Rows2, Columns2, CoRRJunctions, CoRCJunctions, CoCCJunctions, R...",38,40,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/books_r')
read_image (Image2, 'stereo/uncalib/books_l')
* --- End of Automatically Added Context ---"
0440c1d7,micro,4,distortions into account.,"match_fundamental_matrix_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, 100, 200, 0, 0.5, 'gold_standard', 1, 42, FMatrix, Kappa, Error, Points1, Points2)",41,43,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/books_r')
read_image (Image2, 'stereo/uncalib/books_l')
points_foerstner (Image1, 1, 2, 3, 100, 0.1, 'gauss', 'true', Rows1, C..."
0440c1d7,micro,5,"i.e., to remove the radial distortions.","gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)",44,46,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
match_fundamental_matrix_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, 100, 200, 0,..."
0440c1d7,micro,6,,"change_radial_distortion_cam_par ('fixed', CamParDist, 0, CamPar)
change_radial_distortion_image (Image1, Image1, Image1Rect, CamParDist, CamPar)
change_radial_distortion_image (Image2, Image2, Image2Rect, CamParDist, CamPar)",47,50,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/books_r')
read_image (Image2, 'stereo/uncalib/books_l')
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 ..."
0440c1d7,micro,7,"epipolar standard configuration in which the epipolar lines are
horizontal.","gen_binocular_proj_rectification (Map1, Map2, FMatrix, [], Width, Height, Width, Height, 1, 'no_map', CovFMatRect, H1, H2)
projective_trans_point_2d (H1, [0, 0,Height,Height], [0,Width,0,Width], [1, 1, 1, 1], R1, C1, W1)
R1 := int(floor(R1 / W1))
C1 := int(floor(C1 / W1))
projective_trans_point_2d (...",51,64,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
match_fundamental_matrix_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, 100, 200, 0,..."
0440c1d7,micro,8,images.,"binocular_disparity_mg (Image1Mapped, Image2Mapped, Disparity, Score, 1, 30, 8, 0, 'false', 'default_parameters', 'fast_accurate')",65,68,"* --- Automatically Added Context ---
projective_trans_image_size (Image1Rect, Image1Mapped, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
projective_trans_image_size (Image2Rect, Image2Mapped, ..."
0440c1d7,micro,9,"reconstructed disparities that contains values that are not influenced
by border effects. Furthermor...","get_domain (Image1Mapped, Domain)
reduce_domain (Disparity, Domain, Disparity)
scale_image (Disparity, DisparityScaled, 5, 250)
compose2 (DisparityScaled, Image1Mapped, ImagePlot)
inner_rectangle1 (Domain, Row1, Column1, Row2, Column2)
crop_rectangle1 (DisparityScaled, DisparityScaled, Row1, Column1...",71,80,"* --- Automatically Added Context ---
projective_trans_image_size (Image1Rect, Image1Mapped, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
binocular_disparity_mg (Image1Mapped, Image2Mapped, Dis..."
0440c1d7,micro,10,"constitute a 3D reconstruction (which cannot be performed in the
uncalibrated case). The disparities...","dev_clear_window ()
dev_set_paint (['3d_plot', 'texture', 1, 0.72, 0.073, 0.68, -0.1, 0.19, 0.0, 0.03, -0.08])
set_window_param (WindowHandle, 'scale_plot', 'false')
set_window_param (WindowHandle, 'plot_quality', 'best')
set_window_param (WindowHandle, 'display_grid', 'false')
set_window_param (Win...",81,98,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
scale_image (Disparity, DisparityScaled, 5, 250)
* --- End of Automatically Added Context ---"
0440c1d7,micro,11,,"dev_display (ImagePlot)
disp_message (WindowHandle, 'Reconstructed disparities with texture', 'window', 12, 12, 'black', 'true')",99,107,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
compose2 (DisparityScaled, Image1Mapped, ImagePlot)
disp_message (WindowHandle, 'Reconstructe..."
b35388c7,full,0,"This example shows how to use match_fundamental_matrix_distortion_ransac
in an application in which ...","dev_update_off ()
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_window_param (WindowHandle, 'background_color', 'gray')
set_di...",21,173,
b35388c7,micro,1,,dev_update_off (),20,21,
b35388c7,micro,2,,"read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_window_param (WindowHandle, 'background_color', 'gray')
set_display_font (Window...",22,38,
b35388c7,micro,3,,"points_foerstner (Image1, 1, 2, 3, 200, 0.1, 'gauss', 'true', Rows1, Columns1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2, 1, 2, 3, 200, 0.1, 'gauss', 'true', Rows2, Columns2, CoRRJunctions, CoRCJunctions, CoCCJunctions, R...",42,45,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
* --- End of Automatically Added Context ---"
b35388c7,micro,4,"take the radial distortions into account to show the errors that are
caused by neglecting the radial...","match_fundamental_matrix_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, 100, 200, 0, 0.5, 'trans_gold_standard', 1, 42, FMatrixU, CovFMat, ErrorU, Points1U, Points2U)",46,49,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
points_foerstner (Image1, 1, 2, 3, 200, 0.1, 'gauss', 'true', Rows1, Colum..."
b35388c7,micro,5,"epipolar standard configuration in which the epipolar lines should be
horizontal. Of course, since t...","gen_binocular_proj_rectification (Map1U, Map2U, FMatrixU, [], Width, Height, Width, Height, 1, 'no_map', CovFMatRect, H1, H2)
projective_trans_point_2d (H1, [0, 0,Height,Height], [0,Width,0,Width], [1, 1, 1, 1], R1, C1, W1)
R1 := int(floor(R1 / W1))
C1 := int(floor(C1 / W1))
projective_trans_point_2...",50,65,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
get_image_size (Image1, Width, Height)
match_fundamental_matrix_ransac (Im..."
b35388c7,micro,6,"radial distortions are not taken into account, a significant error in
the disparities results.","binocular_disparity_mg (Image1MappedU, Image2MappedU, DisparityU, ScoreU, 1, 30, 8, 0, 'false', 'default_parameters', 'fast_accurate')",66,70,"* --- Automatically Added Context ---
projective_trans_image_size (Image1, Image1MappedU, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
projective_trans_image_size (Image2, Image2MappedU, H2, 'b..."
b35388c7,micro,7,"reconstructed disparities that contains values that are not influenced
by border effects. Furthermor...","get_domain (Image1MappedU, DomainU)
reduce_domain (DisparityU, DomainU, DisparityU)
scale_image (DisparityU, DisparityUScaled, 5, -250)
compose2 (DisparityUScaled, Image1MappedU, ImagePlotU)
get_image_size (DisparityU, WidthD, HeightD)
crop_part (DisparityUScaled, DisparityUScaled, 45, 170, WidthD -...",73,82,"* --- Automatically Added Context ---
projective_trans_image_size (Image1, Image1MappedU, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
binocular_disparity_mg (Image1MappedU, Image2MappedU, Disp..."
b35388c7,micro,8,"constitute a 3D reconstruction (which cannot be performed in the
uncalibrated case). However, the di...","dev_clear_window ()
dev_set_paint (['3d_plot', 'texture', 1, 0.88, 0.14, 0.32, 0.31, 0.23, 0.01, 0.0, 0.0])
set_window_param (WindowHandle, 'scale_plot', 'false')
set_window_param (WindowHandle, 'plot_quality', 'best')
set_window_param (WindowHandle, 'display_grid', 'false')
set_window_param (Window...",83,99,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
scale_image (DisparityU, DisparityUScaled, 5, -250)
* --- End of Automatically Added Context ..."
b35388c7,micro,9,,"dev_display (ImagePlotU)
Message[2] := '(textured)'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",100,106,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
compose2 (DisparityUScaled, Image1MappedU, ImagePlotU)
Message := 'Disparities if radial dist..."
b35388c7,micro,10,"radial distortions into account to show the huge improvement in the
quality of the reconstruction th...","match_fundamental_matrix_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, 100, 200, 0, 0.5, 'trans_gold_standard', 1, 42, FMatrix, Kappa, Error, Points1, Points2)",110,114,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
points_foerstner (Image1, 1, 2, 3, 200, 0.1, 'gauss', 'true', Rows1, Colum..."
b35388c7,micro,11,"i.e., to remove the radial distortions.","get_image_size (Image1, Width, Height)
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)",115,118,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
get_image_size (Image1, Width, Height)
match_fundamental_matrix_distortion_ransac (Image1, Image2, Rows1, Columns1, Ro..."
b35388c7,micro,12,,"change_radial_distortion_cam_par ('fixed', CamParDist, 0, CamPar)
change_radial_distortion_image (Image1, Image1, Image1Rect, CamParDist, CamPar)
change_radial_distortion_image (Image2, Image2, Image2Rect, CamParDist, CamPar)",119,122,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/pcb_l')
read_image (Image2, 'stereo/uncalib/pcb_r')
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (W..."
b35388c7,micro,13,"epipolar standard configuration in which the epipolar lines are
horizontal. Since we are taking the ...","gen_binocular_proj_rectification (Map1, Map2, FMatrix, [], Width, Height, Width, Height, 1, 'no_map', CovFMatRect, H1, H2)
projective_trans_point_2d (H1, [0, 0,Height,Height], [0,Width,0,Width], [1, 1, 1, 1], R1, C1, W1)
R1 := int(floor(R1 / W1))
C1 := int(floor(C1 / W1))
projective_trans_point_2d (...",123,137,"* --- Automatically Added Context ---
gen_binocular_proj_rectification (Map1U, Map2U, FMatrixU, [], Width, Height, Width, Height, 1, 'no_map', CovFMatRect, H1, H2)
projective_trans_point_2d (H1, [0, 0..."
b35388c7,micro,14,"images. Since the radial distortions are taken into account, the results
are significantly better th...","binocular_disparity_mg (Image1Mapped, Image2Mapped, Disparity, Score, 1, 30, 8, 0, 'false', 'default_parameters', 'fast_accurate')",138,142,"* --- Automatically Added Context ---
projective_trans_image_size (Image1Rect, Image1Mapped, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
projective_trans_image_size (Image2Rect, Image2Mapped, ..."
b35388c7,micro,15,"reconstructed disparities that contains values that are not influenced
by border effects. Furthermor...","get_domain (Image1Mapped, Domain)
reduce_domain (Disparity, Domain, Disparity)
scale_image (Disparity, DisparityScaled, 5, -450)
compose2 (DisparityScaled, Image1Mapped, ImagePlot)
get_image_size (Disparity, WidthD, HeightD)
crop_part (DisparityScaled, DisparityScaled, 30, 170, WidthD - 300, HeightD...",145,154,"* --- Automatically Added Context ---
get_image_size (DisparityU, WidthD, HeightD)
projective_trans_image_size (Image1Rect, Image1Mapped, H1, 'bilinear', WidthMapped, HeightMapped, 'false')
binocular_..."
b35388c7,micro,16,"constitute a 3D reconstruction (which cannot be performed in the
uncalibrated case). However, the di...","dev_display (DisparityScaled)
Message := 'Disparities if radial distortions'
Message[1] := 'are taken into account'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",155,169,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Message := 'Disparities if radial distortions'
scale_image (Disparity, DisparityScaled, 5, -4..."
b35388c7,micro,17,,"dev_display (ImagePlot)
Message[2] := '(textured)'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",170,179,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
compose2 (DisparityScaled, Image1Mapped, ImagePlot)
Message := 'Disparities if radial distort..."
ca33f3fa,full,0,"**************************************************************************************************
P...","dev_close_window ()
read_image (Image1, 'stereo/uncalib/boxes_l.png')
read_image (Image2, 'stereo/uncalib/boxes_r.png')
get_image_size (Image1, Width, Height)
dev_update_window ('off')
ScaleImage := 0.7
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage, 'black', WindowHandle1)
dev_open_...",17,171,
ca33f3fa,micro,1,,"dev_close_window ()
read_image (Image1, 'stereo/uncalib/boxes_l.png')
read_image (Image2, 'stereo/uncalib/boxes_r.png')
get_image_size (Image1, Width, Height)
dev_update_window ('off')
ScaleImage := 0.7
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage, 'black', WindowHandle1)
dev_open_...",16,35,
ca33f3fa,micro,2,,"points_foerstner (Image1, 1, 2, 3, 200, 0.1, 'gauss', 'false', Row1, Col1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2, 1, 2, 3, 200, 0.1, 'gauss', 'false', Row2, Col2, CoRRJunctions1, CoRCJunctions1, CoCCJunctions1, RowAre...",36,39,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/boxes_l.png')
read_image (Image2, 'stereo/uncalib/boxes_r.png')
* --- End of Automatically Added Context ---"
ca33f3fa,micro,3,,"gen_cam_par_area_scan_division (0.00969304, -2729.81, 1.46792e-5, 1.48e-5, 297.85, 255.4, 640, 480, CamPar)",40,42,
ca33f3fa,micro,4,,"match_rel_pose_ransac (Image1, Image2, Row1, Col1, Row2, Col2, CamPar, CamPar, 'ncc', 10, 0, 0, 200, 200, 0, 0.5, 'gold_standard', 2, 1, RelPose, CovRelPose, Error, Points1, Points2)
Row1 := subset(Row1,Points1)
Col1 := subset(Col1,Points1)
Row2 := subset(Row2,Points2)
Col2 := subset(Col2,Points2)
v...",43,50,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/boxes_l.png')
read_image (Image2, 'stereo/uncalib/boxes_r.png')
points_foerstner (Image1, 1, 2, 3, 200, 0.1, 'gauss', 'false',..."
ca33f3fa,micro,5,,"gen_binocular_rectification_map (Map1, Map2, CamPar, CamPar, RelPose, 1, 'viewing_direction', 'bilinear', CamParamRect1, CamParamRect2, CamPoseRect1, CamPoseRect2, RelPoseRect)
map_image (Image1, Map1, ImageRect1)
map_image (Image2, Map2, ImageRect2)
dev_set_window (WindowHandle1)
dev_clear_window (...",51,65,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/boxes_l.png')
read_image (Image2, 'stereo/uncalib/boxes_r.png')
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage..."
ca33f3fa,micro,6,,"binocular_distance (ImageRect1, ImageRect2, Distance, Score, CamParamRect1, CamParamRect2, RelPoseRect, 'ncc', 15, 15, 0, -50, 50, 1, 0.1, 'left_right_check', 'interpolation')
get_domain (Score, Domains)
gen_circle (StructElem, 10, 10, 10)
opening (Domains, StructElem, Domains)
connection (Domains, ...",66,90,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage, 'black', WindowHandle1)
dev_open_window (0, Width * ScaleImage + 10, Width * ScaleImage, Height * ..."
ca33f3fa,micro,7,,"pose_to_hom_mat3d (CamPoseRect1, HomMat3D)
hom_mat3d_invert (HomMat3D, HomMat3D)
affine_trans_point_3d (HomMat3D, X, Y, Z, XX, YY, ZZ)
project_3d_point (XX, YY, ZZ, CamParamRect1, R1Rect, C1Rect)",91,96,"* --- Automatically Added Context ---
vector_to_rel_pose (Row1, Col1, Row2, Col2, [], [], [], [], [], [], CamPar, CamPar, 'gold_standard', RelPose, CovRelPose1, Error, X, Y, Z, CovXYZ)
gen_binocular_r..."
ca33f3fa,micro,8,,"Normals := []
Ind := []
for I := 0 to 2 by 1
select_obj (Boxes, Box, I + 1)
gen_contour_region_xld (Box, BoxContour, 'border')
test_xld_point (BoxContour, R1Rect, C1Rect, IsInside)
tuple_find (IsInside, 1, Ind1)
R1 := subset(R1Rect,Ind1)
C1 := subset(C1Rect,Ind1)
area_center (Box, Area, CenterR, Cen...",97,124,"* --- Automatically Added Context ---
vector_to_rel_pose (Row1, Col1, Row2, Col2, [], [], [], [], [], [], CamPar, CamPar, 'gold_standard', RelPose, CovRelPose1, Error, X, Y, Z, CovXYZ)
area_center (Do..."
ca33f3fa,micro,9,,"Basis := 500
X := X * Basis
Y := Y * Basis
Z := Z * Basis",128,133,"* --- Automatically Added Context ---
vector_to_rel_pose (Row1, Col1, Row2, Col2, [], [], [], [], [], [], CamPar, CamPar, 'gold_standard', RelPose, CovRelPose1, Error, X, Y, Z, CovXYZ)
* --- End of Au..."
ca33f3fa,micro,10,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (Image1)
R1 := subset(Row1,Ind)
C1 := subset(Col1,Ind)
dev_set_color ('green')
dev_set_line_width (2)
gen_cross_contour_xld (Cross, R1, C1, 20, rad(45))
dev_display (Cross)
disp_message (WindowHandle1, ['3d coordinates of surface points'...",134,182,"* --- Automatically Added Context ---
read_image (Image1, 'stereo/uncalib/boxes_l.png')
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage, 'black', WindowHandle1)
points_foerstner (Image1..."
b84d26ca,full,0,"This example shows that the reconstruction that can be achieved with
uncalibrated stereo is only pos...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Width := 640
Height := 480
Focus := 500.0
Kappa := 2.0e-6
create_pyramid_points_3d (X, Y, Z)
gen_cam_par_area_scan_division (Focus, 0.0, 1.0, 1.0...",37,433,
b84d26ca,micro,1,"uncalibrated stereo is only possible up to an arbitrary 3D projective
transformation if the camera u...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,40,
b84d26ca,micro,2,projected data.,"Width := 640
Height := 480
Focus := 500.0
Kappa := 2.0e-6",41,46,
b84d26ca,micro,3,pyramid.,"create_pyramid_points_3d (X, Y, Z)",47,49,
b84d26ca,micro,4,,"gen_cam_par_area_scan_division (Focus, 0.0, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDisp)",50,51,"* --- Automatically Added Context ---
Width := 640
Height := 480
Focus := 500.0
* --- End of Automatically Added Context ---"
b84d26ca,micro,5,,"create_pose (0.002, -0.006, 0.027, -80.0, 0.0, 30.0, 'Rp+T', 'gba', 'point', PoseDisp)",52,53,
b84d26ca,micro,6,,"Message := 'Original 3D points'
disp_points_3d_var_pose (WindowHandle, X, Y, Z, PoseDisp, CamParDisp, rad(30), rad(1.0), 'cyan', Message)
project_3d_point_with_pose (CamParDisp, PoseDisp, X, Y, Z, RowsDisp, ColumnsDisp)",54,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
create_pyramid_points_3d (X, Y, Z)
gen_cam_par_area_scan_division (Focus, 0.0, 1.0, 1.0, 0.5 * (Width - 1)..."
b84d26ca,micro,7,,"dev_clear_window ()
dev_set_color ('cyan')
disp_cross (WindowHandle, RowsDisp, ColumnsDisp, 6, 0)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",58,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Original 3D points'
project_3d_point_with_pose (CamParDisp, PoseDisp, X, Y, Z, RowsDisp, Colum..."
b84d26ca,micro,8,of the original 3D points.,"gen_cam_par_area_scan_division (Focus, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)",65,68,"* --- Automatically Added Context ---
Width := 640
Height := 480
Focus := 500.0
Kappa := 2.0e-6
* --- End of Automatically Added Context ---"
b84d26ca,micro,9,"Define two poses of the simulation of a camera that takes images of the
3D data. Note that in this c...","create_pose (0.008, -0.002, 0.035, 0.0, 0.0, 0.0, 'Rp+T', 'gba', 'point', Pose1)
create_pose (-0.012, 0.006, 0.043, 0.0, 0.0, 0.0, 'Rp+T', 'gba', 'point', Pose2)",69,73,"* --- Automatically Added Context ---
create_pose (0.002, -0.006, 0.027, -80.0, 0.0, 30.0, 'Rp+T', 'gba', 'point', PoseDisp)
* --- End of Automatically Added Context ---"
b84d26ca,micro,10,"to obtain a set of corresponding points in two simulated ""images.""","project_3d_point_with_pose (CamParDist, Pose1, X, Y, Z, Rows1, Columns1)
project_3d_point_with_pose (CamParDist, Pose2, X, Y, Z, Rows2, Columns2)",74,77,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
gen_cam_par_area_scan_division (Focus, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)
creat..."
b84d26ca,micro,11,,"dev_clear_window ()
dev_set_color ('blue')
disp_cross (WindowHandle, Rows1, Columns1, 6, 0)
dev_set_color ('green')
disp_cross (WindowHandle, Rows2, Columns2, 6, 0)
disp_message (WindowHandle, ['Corresponding 3D points in two views', 'under pure camera translation'], 'window', 12, 12, 'black', 'true...",78,86,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
project_3d_point_with_pose (CamParDist, Pose1, X, Y, Z, Rows1, Columns1)
project_3d_point_with_pose (CamPa..."
b84d26ca,micro,12,translation case.,"vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standard', FMatrix, Kappa, Error, XR, YR, ZR, WR)",87,89,"* --- Automatically Added Context ---
Kappa := 2.0e-6
project_3d_point_with_pose (CamParDist, Pose1, X, Y, Z, Rows1, Columns1)
project_3d_point_with_pose (CamParDist, Pose2, X, Y, Z, Rows2, Columns2)
..."
b84d26ca,micro,13,"points and the original 3D points (i.e., the ground truth). Note that,
vector_to_fundamental_matrix_...","vector_to_hom_mat3d ('affine', XR, YR, ZR, X, Y, Z, HomMat3D)",90,97,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standa..."
b84d26ca,micro,14,"compute the maximum distance of the transformed reconstructed points
to the original 3D points. This...","affine_trans_point_3d (HomMat3D, XR, YR, ZR, XT, YT, ZT)
XD := X - XT
YD := Y - YT
ZD := Z - ZT
MaxErr := max(sqrt(XD * XD + YD * YD + ZD * ZD))",98,107,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standa..."
b84d26ca,micro,15,"vector_to_hom_mat3d of the affine case to a general 4×4 matrix and we
suppress elements in the matri...","HomMat3DDisp := gen_tuple_const(16,0.0)
HomMat3DDisp[15] := 1.0
for I := 0 to 11 by 1
if (abs(HomMat3D[I]) &gt;= 1e-14)
HomMat3DDisp[I] := HomMat3D[I]
else
HomMat3DDisp[I] := 0.0
endif
endfor",108,120,"* --- Automatically Added Context ---
vector_to_hom_mat3d ('affine', XR, YR, ZR, X, Y, Z, HomMat3D)
* --- End of Automatically Added Context ---"
b84d26ca,micro,16,affine 3D transformation.,"dev_clear_window ()
Message := 'Transformation matrix from the reconstructed 3D points'
Message[1] := 'to the original 3D points for pure camera translation:'
Message[2] := ' '
for I := 0 to 3 by 1
String := ''
for J := 0 to 3 by 1
String := String + HomMat3DDisp[I * 4 + J]$'8.4g' + ' '
endfor
Messa...",121,150,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
create_pyramid_points_3d (X, Y, Z)
Message := 'Original 3D points'
MaxErr := max(sqrt(XD * XD + YD * YD + ..."
b84d26ca,micro,17,"translation case. Note that the same camera parameters that were used to
visualize the original poin...","create_pose (-0.25, -1.2, 1.2, -80.0, 0.0, 30.0, 'Rp+T', 'gba', 'point', PoseDisp)
Message := ['Reconstructed 3D points for pure camera translation:', 'Note that the reconstructed planes are parallel']
disp_points_3d_var_pose (WindowHandle, XR, YR, ZR, PoseDisp, CamParDisp, rad(30), rad(1.0), 'cyan'...",151,164,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
gen_cam_par_area_scan_division (Focus, 0.0, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height..."
b84d26ca,micro,18,"original 3D points. Note that the poses include a rotation as well as a
translation. Thus, these pos...","create_pose (0.006, -0.003, 0.043, 10.0, 20.0, 5.0, 'Rp+T', 'gba', 'point', Pose1)
create_pose (-0.012, 0.005, 0.052, -20.0, -10.0, -5.0, 'Rp+T', 'gba', 'point', Pose2)",165,169,"* --- Automatically Added Context ---
create_pose (0.002, -0.006, 0.027, -80.0, 0.0, 30.0, 'Rp+T', 'gba', 'point', PoseDisp)
create_pose (0.008, -0.002, 0.035, 0.0, 0.0, 0.0, 'Rp+T', 'gba', 'point', P..."
b84d26ca,micro,19,,"dev_clear_window ()
dev_set_color ('blue')
disp_cross (WindowHandle, Rows1, Columns1, 6, 0)
dev_set_color ('green')
disp_cross (WindowHandle, Rows2, Columns2, 6, 0)
disp_message (WindowHandle, ['Corresponding 3D points in two views', 'under general camera motion'], 'window', 12, 12, 'black', 'true')...",174,183,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
disp_message (WindowHandle, ['Corresponding 3D points in two views', 'under pure camera translation'], 'wi..."
b84d26ca,micro,20,case.,"vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'gold_standard', FMatrix, Kappa, Error, XR, YR, ZR, WR)",184,186,"* --- Automatically Added Context ---
Kappa := 2.0e-6
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standard', FMatrix, Kappa..."
b84d26ca,micro,21,"vector_to_fundamental_matrix_distortion into inhomogeneous points by
dividing by WR.","XR := XR / WR
YR := YR / WR
ZR := ZR / WR",187,192,"* --- Automatically Added Context ---
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standard', FMatrix, Kappa, Error, XR, YR,..."
b84d26ca,micro,22,"points and the original 3D points (i.e., the ground truth). The
resulting projective transformation ...","vector_to_hom_mat3d ('projective', XR, YR, ZR, X, Y, Z, HomMat3D)",193,199,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standa..."
b84d26ca,micro,23,"and compute the maximum distance of the transformed reconstructed points
to the original 3D points. ...","projective_trans_point_3d (HomMat3D, XR, YR, ZR, XT, YT, ZT)
XD := X - XT
YD := Y - YT
ZD := Z - ZT
MaxErr := max(sqrt(XD * XD + YD * YD + ZD * ZD))",200,209,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
vector_to_fundamental_matrix_distortion (Rows1, Columns1, Rows2, Columns2, [], [], [], [], [], [], 640, 480, 'trans_gold_standa..."
b84d26ca,micro,24,projective 3D transformation.,"dev_clear_window ()
Message := 'Transformation matrix from the reconstructed 3D points'
Message[1] := 'to the original 3D points for general camera motion:'
Message[2] := ' '
for I := 0 to 3 by 1
String := '   '
for J := 0 to 3 by 1
String := String + HomMat3D[I * 4 + J]$'8.4f' + ' '
endfor
Message ...",210,235,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Original 3D points'
vector_to_hom_mat3d ('affine', XR, YR, ZR, X, Y, Z, HomMat3D)
affine_trans..."
b84d26ca,micro,25,"motion case. Note that the same camera parameters that were used to
visualize the original points ab...","create_pose (0.06, -0.055, 0.1, 130.0, 40.0, 160.0, 'Rp+T', 'gba', 'point', PoseDisp)
Message := ['Reconstructed 3D points for general camera motion:', 'Note that the reconstructed planes are not parallel', 'and that the squares of the pyramid are reconstructed', 'as general quadrilaterals.']
disp_p...",236,356,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Kappa := 2.0e-6
create_pyramid_points_3d (X, Y, Z)
gen_cam_par_area_scan_division (Focus, 0.0, 1.0, 1.0, 0..."
b84d26ca,micro,26,,OverallTime := 4.0,357,359,
b84d26ca,micro,27,,"get_window_extents (WindowHandle, Row, Column, Width, Height)
get_part (WindowHandle, Row1, Column1, Row2, Column2)
open_window (Row, Column, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_part (WindowHandleBuffer, Row1, Column1, Row2, Column2)
set_display_font (WindowHandleBuffer, 16, 'mon...",360,366,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Width := 640
Height := 480
project_point_hom_mat3d (ProjMat, X, Y, Z, Column, Row)
* --- End of Automatica..."
b84d26ca,micro,28,,"pose_to_hom_mat3d (PoseCenter, HomMat3DDisp)
hom_mat3d_invert (HomMat3DDisp, HomMat3DInvert)
CamCenterX := HomMat3DInvert[3]
CamCenterY := HomMat3DInvert[7]
CamCenterZ := HomMat3DInvert[11]
CamLookAtX := HomMat3DInvert[2] + CamCenterX
CamLookAtY := HomMat3DInvert[6] + CamCenterY
CamLookAtZ := HomMat...",367,392,"* --- Automatically Added Context ---
create_pyramid_points_3d (X, Y, Z)
HomMat3DDisp := gen_tuple_const(16,0.0)
* --- End of Automatically Added Context ---"
b84d26ca,micro,29,,"ProjX := -HomMat3DInvert[6]
ProjY := HomMat3DInvert[2]
ProjLenInv := 1.0 / sqrt(ProjX * ProjX + ProjY * ProjY)
ProjX := ProjX * ProjLenInv
ProjY := ProjY * ProjLenInv
CamRoll := acos(ProjX * HomMat3DInvert[0] + ProjY * HomMat3DInvert[4]) + rad(180)",393,400,"* --- Automatically Added Context ---
hom_mat3d_invert (HomMat3DDisp, HomMat3DInvert)
* --- End of Automatically Added Context ---"
b84d26ca,micro,30,,"convert_point_3d_cart_to_spher (-DX, -DY, -DZ, 'z', '-x', Longitude, Latitude, Radius)
set_color (WindowHandleBuffer, Color)
NumStep := 4 * AngleDelta / AngleIncr
DeltaStep := rad(360) / NumStep
TimePerLoop := OverallTime / NumStep
for Index := 0 to NumStep - 1 by 1
count_seconds (Seconds1)
IndexAng...",401,450,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Width := 640
Height := 480
create_pyramid_points_3d (X, Y, Z)
Message := 'Original 3D points'
project_3d_p..."
573fa9f7,full,0,,"dev_close_window ()
dev_update_off ()
Sequence := [1:10]
Names := 'dff/focus_' + (Sequence$'.2')
read_image (Image, Names)
channels_to_image (Image, Image)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', '...",6,38,
573fa9f7,micro,1,,"mean_image (Depth, DepthHighConf, 51, 51)
select_grayvalues_from_channels (Image, DepthHighConf, SharpImage)",24,26,"* --- Automatically Added Context ---
read_image (Image, Names)
depth_from_focus (Image, Depth, Confidence, 'highpass', 'next_maximum')
* --- End of Automatically Added Context ---"
573fa9f7,micro,2,,"scale_image_max (DepthHighConf, ImageScaleMax)
mean_image (ImageScaleMax, DepthMean, 51, 51)
dev_display (SharpImage)
disp_message (WindowHandle, 'Sharp image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",27,33,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
mean_image (Depth, DepthHighConf, 51, 51)
select_grayvalues_from_channels (Image, DepthHighConf, Shar..."
573fa9f7,micro,3,,"dev_set_paint (['3d_plot', 'texture'])
compose2 (DepthMean, SharpImage, TexturedImage)
dev_display (TexturedImage)
disp_message (WindowHandle, 'Textured depth image', 'window', 12, 12, 'black', 'true')",34,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
select_grayvalues_from_channels (Image, DepthHighConf, SharpImage)
mean_image (ImageScaleMax, DepthMe..."
3b26bed4,full,0,"This program demonstrates how to use the operator
reconstruct_points_stereo.
First, we extract the m...","dev_update_off ()
ImgPath := '3d_machine_vision/multi_view/'
ImgPrefix := 'multi_view_calib_'
read_image (Image, ImgPath + ImgPrefix + 'cam_0_00')
get_image_size (Image, Width, Height)
Scale := .5
CaltabDescr := 'caltab_100mm.descr'
dev_close_window ()
open_windows_multi_view_setup (Height, Width, S...",14,185,
3b26bed4,micro,1,,"dev_update_off ()
ImgPath := '3d_machine_vision/multi_view/'
ImgPrefix := 'multi_view_calib_'
read_image (Image, ImgPath + ImgPrefix + 'cam_0_00')
get_image_size (Image, Width, Height)
Scale := .5
CaltabDescr := 'caltab_100mm.descr'
dev_close_window ()
open_windows_multi_view_setup (Height, Width, S...",13,25,
3b26bed4,micro,2,,"try
read_camera_setup_model ('../../Calibration/Multi-View/four_camera_setup_model.csm', CameraSetupModelID)
catch (Exception)
if (Exception[0] == 5200)
init_camera_setup (CameraSetupModelID)
else
throw (Exception)
endif
endtry",26,36,
3b26bed4,micro,3,,"create_stereo_model (CameraSetupModelID, 'points_3d', [], [], StereoModelID)",37,39,"* --- Automatically Added Context ---
read_camera_setup_model ('../../Calibration/Multi-View/four_camera_setup_model.csm', CameraSetupModelID)
* --- End of Automatically Added Context ---"
3b26bed4,micro,4,,"caltab_points (CaltabDescr, X, Y, Z)
tuple_gen_sequence (0, |X| - 1, 1, Indices)
Ones := gen_tuple_const(|X|,1)
gen_image_const (ImageX, 'real', 1, |X|)
gen_image_const (ImageY, 'real', 1, |X|)
gen_image_const (ImageZ, 'real', 1, |X|)
Objects3D := []
Colors := ['yellow', 'cyan', 'magenta']",40,49,"* --- Automatically Added Context ---
CaltabDescr := 'caltab_100mm.descr'
* --- End of Automatically Added Context ---"
3b26bed4,micro,5,initialize a calibration data model,"create_calib_data ('calibration_object', 4, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, CaltabDescr)
for PoseIndex := 0 to 2 by 1
AllRow := []
AllColumn := []
AllIndices := []
AllCams := []
for CameraIndex := 0 to 3 by 1
get_camera_setup_param (CameraSetupModelID, CameraIndex, 'para...",50,93,"* --- Automatically Added Context ---
ImgPath := '3d_machine_vision/multi_view/'
read_image (Image, ImgPath + ImgPrefix + 'cam_0_00')
CaltabDescr := 'caltab_100mm.descr'
open_windows_multi_view_setup ..."
3b26bed4,micro,6,,"for I := 1 to 4 by 1
dev_close_window ()
endfor
gen_empty_obj (BackgroundImage)
get_camera_setup_param (CameraSetupModelID, 0, 'pose', CameraPose)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CameraParam)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left b...",94,119,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
read_camera_setup_model ('../../Calibration/Multi-View/four_camera_setup_model.csm', CameraSetupModelID)
Objects3D := []
get..."
3b26bed4,micro,7,,"gen_cam_par_area_scan_polynomial (0.00850373, 4008.61, -2.95892e+008, 2.37315e+013, 0.139749, -0.00367983, 5.99965e-006, 6e-006, 362.715, 236.769, 752, 480, CamParam0)
gen_cam_par_area_scan_polynomial (0.00854019, 3445.26, -1.18075e+008, 6.40715e+012, -0.0527818, -0.192439, 5.99894e-006, 6e-006, 406...",120,130,
3b26bed4,micro,8,,"create_camera_setup_model (4, CameraSetupModelID)
set_camera_setup_cam_param (CameraSetupModelID, 0, [], CamParam0, Pose0)
set_camera_setup_cam_param (CameraSetupModelID, 1, [], CamParam1, Pose1)
set_camera_setup_cam_param (CameraSetupModelID, 2, [], CamParam2, Pose2)
set_camera_setup_cam_param (Cam...",131,157,"* --- Automatically Added Context ---
read_camera_setup_model ('../../Calibration/Multi-View/four_camera_setup_model.csm', CameraSetupModelID)
gen_cam_par_area_scan_polynomial (0.00850373, 4008.61, -2..."
3b26bed4,micro,9,"the images of a multi-view stereo setup consisting
of four cameras","dev_open_window ((Height * Scale) + 10, (Width * Scale) + 10, Width * Scale, Height * Scale, 'black', WindowHandle3)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
set_display_font (WindowHandle3, 14, 'mono', 'true', 'false')
dev_open_window ((Height * Scale) + 10, 0, Width *...",158,196,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
Scale := .5
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
* --- End of Automatically Added Context ---"
9274c185,full,0,"This example shows how to use a mixed camera setup with
two telecentric and one perspective cameras ...","dev_close_window ()
dev_update_off ()
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
WindowWidth := 2202
WindowHeight := 1668
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, 800, 600, WindowHandle)...",14,146,
9274c185,micro,1,,"dev_close_window ()
dev_update_off ()
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
WindowWidth := 2202
WindowHeight := 1668
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, 800, 600, WindowHandle)...",13,36,
9274c185,micro,2,,"gen_cam_par_area_scan_tilt_polynomial (0.039, 0, 0, 0, 0, 0, 0.05, 15.0, 2.0, 8.99e-006, 8.99e-006, 550.5, 417, 1101, 834, StartCamParCamera0)
gen_cam_par_area_scan_tilt_bilateral_telecentric_polynomial (0.34, 0, 0, 0, 0, 0, 8, 0, 8.99e-006, 8.99e-006, 414, 352, 828, 704, StartCamParCamera1)
gen_cam...",37,48,
9274c185,micro,3,,"MessageCameras := 'Camera 0: Perspective camera'
MessageCameras[1] := 'Camera 1: Telecentric camera'
MessageCameras[2] := 'Camera 2: Telecentric camera'
RowMessage := [20, 20, 320]
ColumnMessage := [20, 450, 20]
dev_clear_window ()
for Index := 1 to 8 by 1
gen_empty_obj (CalibImages)
for CameraID :=...",49,69,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 3, 1, CalibDataID)
* --- End of Automatically Added Context ---"
9274c185,micro,4,,"calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)",70,73,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 3, 1, CalibDataID)
* --- End of Automatically Added Context ---"
9274c185,micro,5,"coordinate system within the camera setup model.
This is not strictly necessary, but simplifies the ...","ReferencePoseIndex := 1
get_calib_data (CalibDataID, 'calib_obj_pose', [0,ReferencePoseIndex], 'pose', ReferencePose)
set_camera_setup_param (CameraSetupModelID, 'general', 'coord_transf_pose', ReferencePose)",76,82,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 3, 1, CalibDataID)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)
* --- End o..."
9274c185,micro,6,,"create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)",83,85,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,7,,"BoundingBox := [-0.0008, -0.0085, -0.002, 0.006, 0.009, 0.0007]
set_stereo_model_param (StereoModelID, 'bounding_box', BoundingBox)",88,91,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,8,,"Message := 'The calibration of the mixed camera setup'
Message[1] := 'succeeded with an RMS error of ' + Error$'0.3f' + ' pixels.'
create_pose (0.01, 0.05, 1.6, 270.0, 0.0, 257.0, 'Rp+T', 'gba', 'point', VisPose)
gen_camera_setup_object_model_3d (CameraSetupModelID, 'auto', 'auto', ObjectModel3DCame...",92,99,"* --- Automatically Added Context ---
Instructions[0] := 'Rotate: Left button'
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, 800, 600, WindowHandle)
Message := 'This example shows how to ..."
9274c185,micro,9,,"Message := 'The following reconstruction may take a minute.'
Message[1] := 'If you do not have the time now, you may want to'
Message[2] := 'cancel the program now and come back later.'
Message[3] := ''
Message[4] := 'Else, press Run (F5) to continue.'
dev_disp_text (Message, 'window', 12, 12, 'whit...",100,108,"* --- Automatically Added Context ---
Message := 'This example shows how to use a mixed camera setup with perspective and'
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'bl..."
9274c185,micro,10,,"set_stereo_model_image_pairs (StereoModelID, [1, 2], [0, 0])",109,110,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,11,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')",111,113,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,12,,"set_stereo_model_param (StereoModelID, 'color', 'median')",114,116,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,13,,"set_stereo_model_param (StereoModelID, 'disparity_method', 'binocular_ms')
set_stereo_model_param (StereoModelID, 'binocular_ms_surface_smoothing', 20)
set_stereo_model_param (StereoModelID, 'binocular_ms_edge_smoothing', 130)
set_stereo_model_param (StereoModelID, 'binocular_ms_sub_disparity', 'tru...",117,124,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,14,,"set_stereo_model_param (StereoModelID, 'point_meshing', 'isosurface')
set_stereo_model_param (StereoModelID, 'resolution', 9e-5)
set_stereo_model_param (StereoModelID, 'surface_tolerance', 1.5e-3)
set_stereo_model_param (StereoModelID, 'smoothing', 3)",125,130,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
9274c185,micro,15,,"read_image (Images, '3d_machine_vision/multi_view/circuit_board_cam_' + [0:2])
tile_images (Images, TiledImage1, 2, 'horizontal')
dev_clear_window ()
dev_display (TiledImage1)
Message := 'Reconstruct scene from 3 different views.'
Message[1] := 'Please wait...'
dev_disp_text (Message, 'window', 12, ...",131,139,"* --- Automatically Added Context ---
Message := 'This example shows how to use a mixed camera setup with perspective and'
* --- End of Automatically Added Context ---"
9274c185,micro,16,,"reconstruct_surface_stereo (Images, StereoModelID, OM3DFusion)",140,142,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
read_image (Images, '3d_machine_vision/multi_view/circuit_board_cam_' + [0:2])
*..."
9274c185,micro,17,,"create_pose (0.003, 0.0, 0.25, 316.0, 7.0, 195.0, 'Rp+T', 'gba', 'point', VisPose)
Title := 'Reconstructed object model using \'surface_fusion\''
visualize_object_model_3d (WindowHandle, OM3DFusion, [], VisPose, ['red_channel_attrib', 'green_channel_attrib', 'blue_channel_attrib'], ['red', 'green', ...",143,152,"* --- Automatically Added Context ---
Instructions[0] := 'Rotate: Left button'
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, 800, 600, WindowHandle)
create_pose (0.01, 0.05, 1.6, 270.0, 0..."
8fbb9783,full,0,"This example creates a 3D model from 4 images taken from different points of view.
The program is sp...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Method := ['binocular', 'binocular_mg', 'binocular_ms']...",20,304,
8fbb9783,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Method := ['binocular', 'binocular_mg', 'binocular_ms']...",19,30,
8fbb9783,micro,2,,"create_pose (0.01581839460406891, -0.09941803310558929, -0.3079308956836844, 350.8986040828125, 354.3536799369792, 274.1973698039017, 'Rp+T', 'gba', 'point', Pose0)
create_pose (-0.0610990419307257, -0.002271718614999785, -0.2908451228380092, 357.0205814462478, 13.76778713838595, 180.8404608013425, ...",34,42,"* --- Automatically Added Context ---
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
* --- End of Automatically Added Context ---"
8fbb9783,micro,3,,"create_camera_setup_model (4, CameraSetupModelID)
set_camera_setup_cam_param (CameraSetupModelID, 0, [], CameraParam0, Pose0)
set_camera_setup_cam_param (CameraSetupModelID, 1, [], CameraParam1, Pose1)
set_camera_setup_cam_param (CameraSetupModelID, 2, [], CameraParam2, Pose2)
set_camera_setup_cam_p...",43,49,"* --- Automatically Added Context ---
create_pose (0.01581839460406891, -0.09941803310558929, -0.3079308956836844, 350.8986040828125, 354.3536799369792, 274.1973698039017, 'Rp+T', 'gba', 'point', Pose..."
8fbb9783,micro,4,,"create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)",50,51,"* --- Automatically Added Context ---
create_camera_setup_model (4, CameraSetupModelID)
* --- End of Automatically Added Context ---"
8fbb9783,micro,5,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')
set_stereo_model_param (StereoModelID, 'rectif_sub_sampling', 2.0)",52,54,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
8fbb9783,micro,6,,"set_stereo_model_image_pairs (StereoModelID, [0, 1, 2], [1, 2, 3])",55,56,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
8fbb9783,micro,7,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.1, -0.1, -0.07, 0.1, 0.1, 0.0])",57,58,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
8fbb9783,micro,8,,"set_stereo_model_param (StereoModelID, 'sub_sampling_step', 1)
set_stereo_model_param (StereoModelID, 'color', 'median')",59,62,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
8fbb9783,micro,9,,"Message := 'Reconstruct a 3D scene with the methods:'
Message := [Message,' - ' + Method]
Message := [Message,' ', 'Each scene is fully reconstructed and then']
Message := [Message,'segmented based on different score thresholds.']
Message := [Message,' ', 'Note that the score has a different meaning...",63,75,"* --- Automatically Added Context ---
Method := ['binocular', 'binocular_mg', 'binocular_ms']
* --- End of Automatically Added Context ---"
8fbb9783,micro,10,,"read_image (Images, 'universal_joint_part/universal_joint_part_scene_0_camera_' + [0:3])
get_image_size (Images, ImageWidth, ImageHeight)
tile_images (Images, TiledImage, 2, 'vertical')
get_window_extents (WindowHandle1, Row, Column, Width, Height)
dev_open_window (0, Width + 8, 1000 - Width, Height...",76,85,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
* --- End of Auto..."
8fbb9783,micro,11,"- reconstruct the scene, then
- segment the reconstructed scene with different thresholds.","for I := 0 to |Method| - 1 by 1
set_stereo_model_param (StereoModelID, 'disparity_method', Method[I])
if (Method[I] == 'binocular')
set_stereo_model_param (StereoModelID, 'binocular_filter', 'left_right_check')
set_stereo_model_param (StereoModelID, 'binocular_sub_disparity', 'interpolation')
ScoreR...",86,153,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Method := ['binoc..."
8fbb9783,micro,12,,"dev_set_window (WindowHandle2)
dev_close_window ()
dev_set_window (WindowHandle1)
dev_clear_window ()
Message := 'Part 2'
Message[1] := ' '
Message[2] := 'In contrast to the method shown before,'
Message[3] := 'the score threshold can be set before the\nreconstruction.'
Message[4] := 'In effect, the...",158,177,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
Message := 'Reconstruct a 3D scene with the methods:'
dev_disp_text ('Press Run (F5) to continue..."
8fbb9783,micro,13,- reconstruct the thresholded scene.,"for I := 0 to |Method| - 1 by 1
set_stereo_model_param (StereoModelID, 'disparity_method', Method[I])
set_stereo_model_param (StereoModelID, 'binocular_score_thresh', Scores[I])
display_reconstruction_message (TiledImage, WindowHandle1, Method[I])
count_seconds (S1)
reconstruct_surface_stereo (Image...",178,202,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Method := ['binoc..."
8fbb9783,micro,14,Compare results,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
Instructions[3] := 'Lock object:   Right button'
Title := 'Compare thresholded results of all methods'
create_pose (-0.15, 0, 3.5, -25, 0, 0, 'Rp+T', 'gba', 'poi...",203,292,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 754, 480, 600, -1, WindowHandle1)
create_pose (0.02, 0.035, 1.5, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Method := ['binoc..."
8fbb9783,micro,15,,"dev_set_window (WindowHandle)
get_part (WindowHandle, Row1, Column1, Row2, Column2)
get_image_size (TiledImage, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (TiledImage)
dev_set_part (Row1, Column1, Row2, Column2)
Message := 'Method: \'' + Method + '\''
Message[1] := 'Recons...",293,323,"* --- Automatically Added Context ---
Method := ['binocular', 'binocular_mg', 'binocular_ms']
Message := 'Reconstruct a 3D scene with the methods:'
tile_images (Images, TiledImage, 2, 'vertical')
get_..."
c3d7fecd,full,0,"This example shows the 3D reconstruction of several objects from
multiple cameras with the 'surface_...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_resize_window_fit_size (0, 0, 1024, 600, -1, -1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instr...",15,139,
c3d7fecd,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_resize_window_fit_size (0, 0, 1024, 600, -1, -1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instr...",14,23,
c3d7fecd,micro,2,,"Message := 'This example reconstructs several 3D objects using the method \'surface_fusion\'.'
Message[2] := ' '
Message[3] := 'The \'surface_fusion\' method uses the results of the method \'surface_pairwise\' as'
Message[4] := 'input for the fusion algorithm. Therefore, the pairwise parameters have...",24,37,
c3d7fecd,micro,3,"This reduces the runtime and returns results within a few seconds.
If you have more time, set this p...",FastReconstruction := true,38,42,
c3d7fecd,micro,4,,"if (FastReconstruction)
Resolution := 0.0012
Info := ', coarse resolution'
else
Resolution := 0.0006
Info := ', fine resolution'
endif",43,52,"* --- Automatically Added Context ---
FastReconstruction := true
* --- End of Automatically Added Context ---"
c3d7fecd,micro,5,,SurfaceTolerance := 2 * Resolution,53,55,"* --- Automatically Added Context ---
Resolution := 0.0012
* --- End of Automatically Added Context ---"
c3d7fecd,micro,6,,"read_camera_setup_model ('cam_setup_model.csm', CameraSetupModelID)",56,58,
c3d7fecd,micro,7,,"get_camera_setup_param (CameraSetupModelID, 'general', 'num_cameras', NumCameras)",59,61,"* --- Automatically Added Context ---
read_camera_setup_model ('cam_setup_model.csm', CameraSetupModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,8,,"create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)",62,64,"* --- Automatically Added Context ---
read_camera_setup_model ('cam_setup_model.csm', CameraSetupModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,9,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')",65,66,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,10,,"set_stereo_model_image_pairs (StereoModelID, [0, 0], [1, 2])",67,69,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,11,Use the 'binocular_disparity' method.,"set_stereo_model_param (StereoModelID, 'disparity_method', 'binocular')",70,72,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,12,,"set_stereo_model_param (StereoModelID, 'binocular_method', 'ncc')",73,74,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,13,,"set_stereo_model_param (StereoModelID, 'binocular_mask_width', 11)
set_stereo_model_param (StereoModelID, 'binocular_mask_height', 11)",75,77,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,14,,"set_stereo_model_param (StereoModelID, 'binocular_filter', 'left_right_check')",78,79,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,15,,"set_stereo_model_param (StereoModelID, 'binocular_sub_disparity', 'interpolation')",80,82,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
c3d7fecd,micro,16,,"NumObjects := 5
for I := 1 to NumObjects by 1
read_image (Images, '3d_machine_vision/multi_view/engine_part_cam_' + [0:2] + '_0' + I)
tile_images (Images, TiledImage, 2, 'vertical')
if (I == 1)
BoundingBox := [-0.134, -0.043, -0.005, -0.022, 0.067, 0.042]
elseif (I == 2)
BoundingBox := [-0.135, -0.0...",83,145,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Instructions := 'Rotate: Left button'
Message := 'This example reconstructs several 3D objects using the m..."
720054ad,full,0,"This example creates a 3D model from 3 images taken from different points of view.
It shows the reco...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1...",12,637,
720054ad,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1...",11,21,
720054ad,micro,2,,"disp_message_block01 ()
stop ()",22,25,
720054ad,micro,3,and the images of the object.,"read_camera_setup_model ('cam_setup_model.csm', CameraSetupModelID)
read_image (Images, '3d_machine_vision/multi_view/' + 'engine_part_cam_' + [0:2] + '_01')
get_image_size (Images, ImageWidth, ImageHeight)",26,31,
720054ad,micro,4,,"create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)",32,34,"* --- Automatically Added Context ---
read_camera_setup_model ('cam_setup_model.csm', CameraSetupModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,5,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')
set_stereo_model_image_pairs (StereoModelID, [0, 0], [1, 2])",35,38,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,6,,"estimate_bounding_box_3d_reconstruction (StereoModelID, 0.06, BoundingBox)",41,42,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,7,"to lie in the measurement plane. We have to account for this 5 cm offset
when using the procedure, w...","BoundingBox[2] := BoundingBox[2] + 0.05
BoundingBox[5] := BoundingBox[5] + 0.05
set_stereo_model_param (StereoModelID, 'bounding_box', BoundingBox)",43,49,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
estimate_bounding_box_3d_reconstruction (StereoModelID, 0.06, BoundingBox)
* ---..."
720054ad,micro,8,,"get_window_extents (WindowHandle1, Row1, Column1, Width1, Height1)
dev_open_window (0, Width1 + 8, 400, Height1, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
disp_message_block02 ()",50,55,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
720054ad,micro,9,"set bounding box. This way, it is easy to configure the bounding box.","gen_camera_setup_object_model_3d (CameraSetupModelID, 'auto', 'auto', ObjectModel3DCamera, ObjectModel3DCone)
gen_bounding_box_object_model_3d (StereoModelID, ObjectModel3DBoundingBox)
Title := 'Camera setup with initial bounding box'
visualize_object_model_3d (WindowHandle1, [ObjectModel3DBoundingB...",56,62,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,10,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_window (WindowHandle2)
dev_close_window ()",63,68,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
dev_open_window (0, Width1 + 8, 400, Height1, 'black', WindowHandle2)
* --- End of Automatically ..."
720054ad,micro,11,"For the first run, we only set the disparity method. We also enable the
persistence mode which later...","set_stereo_model_param (StereoModelID, 'persistence', 1)
set_stereo_model_param (StereoModelID, 'disparity_method', 'binocular')",69,74,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,12,,"tile_images (Images, TiledImage, 2, 'vertical')
display_reconstruction_message (TiledImage, WindowHandle1, 'binocular')",75,78,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
read_image (Images, '3d_machine_vision/multi_view/' + 'engine_part_cam_' + [0:2] + '_01')
* --- E..."
720054ad,micro,13,,"dev_disp_text ('Reconstructing 3D Object Model...', 'window', 'bottom', 'right', 'black', [], [])
reconstruct_surface_stereo (Images, StereoModelID, ObjectModel3DFusion)",79,82,"* --- Automatically Added Context ---
read_image (Images, '3d_machine_vision/multi_view/' + 'engine_part_cam_' + [0:2] + '_01')
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], Stere..."
720054ad,micro,14,results of the 'surface_fusion method'.,"get_stereo_model_object_model_3d (StereoModelID, 'm3d_pairwise', ObjectModel3DPairwise)",83,86,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,15,,"gen_bounding_box_object_model_3d (StereoModelID, ObjectModel3DBoundingBox)
get_window_extents (WindowHandle1, Row, Column, Width, Height)
dev_open_window (0, Width + 8, 1000 - Width, Height, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
disp_message_block03 (W...",87,96,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,16,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.14, -0.04, -0.01, -0.02, 0.07, 0.035])
set_stereo_model_param (StereoModelID, 'binocular_mask_width', 11)
set_stereo_model_param (StereoModelID, 'binocular_mask_height', 11)
set_stereo_model_param (StereoModelID, 'binocular_filter', 'left_ri...",97,107,"* --- Automatically Added Context ---
read_image (Images, '3d_machine_vision/multi_view/' + 'engine_part_cam_' + [0:2] + '_01')
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], Stere..."
720054ad,micro,17,,"disp_message_block04 (WindowHandle2)
Title := 'Final result of pairwise reconstruction'
Title[1] := 'and adapted bounding box'
create_pose (0.0, 0.003, 1.78, 285.0, 2.0, 100.0, 'Rp+T', 'gba', 'point', VisPose)
visualize_object_model_3d (WindowHandle1, [ObjectModel3DPairwise,ObjectModel3DBoundingBox]...",108,114,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,18,,"set_stereo_model_param (StereoModelID, 'point_meshing', 'isosurface')",118,119,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,19,,"set_stereo_model_param (StereoModelID, 'persistence', 0)
dev_disp_text ('Reconstructing 3D Object Model...', 'window', 'bottom', 'right', 'black', [], [])
reconstruct_surface_stereo (Images, StereoModelID, ObjectModel3DFusion)",120,124,"* --- Automatically Added Context ---
read_image (Images, '3d_machine_vision/multi_view/' + 'engine_part_cam_' + [0:2] + '_01')
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], Stere..."
720054ad,micro,20,,"disp_message_block05 (WindowHandle2)
Title := 'Initial result of fusion method together'
Title[1] := 'with pairwise reconstruction'
visualize_object_model_3d (WindowHandle1, [ObjectModel3DPairwise,ObjectModel3DFusion], [], VisPose, ['color_0', 'color_1', 'attribute_0', 'attribute_1', 'point_size'], ...",125,130,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,21,,"disp_message_block06 (WindowHandle2)
Resolutions := [0.0045, 0.001]
for Index := 0 to |Resolutions| - 1 by 1
Resolution := Resolutions[Index]
set_stereo_model_param (StereoModelID, 'resolution', Resolution)
count_seconds (T1)
dev_set_window (WindowHandle1)
dev_disp_text ('Reconstructing 3D Object Mo...",131,147,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,22,,"disp_message_block07 (WindowHandle2)
MinThicknesses := [0.008, 0.2]
for Index := 0 to |MinThicknesses| - 1 by 1
MinThickness := MinThicknesses[Index]
set_stereo_model_param (StereoModelID, 'min_thickness', MinThickness)
dev_set_window (WindowHandle1)
dev_disp_text ('Reconstructing 3D Object Model......",148,161,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,23,,"disp_message_block08 (WindowHandle2)
SurfaceTolerances := 0.002
for Index := 0 to |SurfaceTolerances| - 1 by 1
SurfaceTolerance := SurfaceTolerances[Index]
set_stereo_model_param (StereoModelID, 'surface_tolerance', SurfaceTolerance)
dev_set_window (WindowHandle1)
dev_disp_text ('Reconstructing 3D O...",162,175,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,24,,"disp_message_block09 (WindowHandle2)
Smoothings := [0.5, 5.0, 1.5]
for Index := 0 to |Smoothings| - 1 by 1
Smoothing := Smoothings[Index]
set_stereo_model_param (StereoModelID, 'smoothing', Smoothing)
dev_set_window (WindowHandle1)
dev_disp_text ('Reconstructing 3D Object Model...', 'window', 'botto...",176,190,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,25,even higher resolution to get an appealing result.,disp_message_block11 (WindowHandle2),191,194,"* --- Automatically Added Context ---
dev_open_window (0, Width1 + 8, 400, Height1, 'black', WindowHandle2)
* --- End of Automatically Added Context ---"
720054ad,micro,26,,"set_stereo_model_param (StereoModelID, 'resolution', 0.0006)",195,197,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_fusion', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
720054ad,micro,27,,"set_stereo_model_param (StereoModelID, 'smoothing', 0.7)
dev_set_window (WindowHandle1)
dev_disp_text ('Reconstructing 3D Object Model...', 'window', 'bottom', 'right', 'black', [], [])
reconstruct_surface_stereo (Images, StereoModelID, ObjectModel3DFusion)
Title := 'Final output'
visualize_object_m...",198,205,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
create_pose (0.03, 0.22, 19.4, 280, 0.0, 65.0, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] :..."
720054ad,micro,28,"or with dev_inspect_ctrl, you can get more information about
3D object models.","dev_inspect_ctrl ([ObjectModel3DFusion,ObjectModel3DPairwise,ObjectModel3DBoundingBox])
dev_set_window (WindowHandle2)
dev_close_window ()
disp_message_block12 (WindowHandle1)
stop ()
dev_close_inspect_ctrl ([ObjectModel3DFusion,ObjectModel3DPairwise,ObjectModel3DBoundingBox])",206,230,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
dev_open_window (0, Width1 + 8, 400, Height1, 'black', WindowHandle2)
gen_bounding_box_object_mod..."
720054ad,micro,29,,"dev_set_window (WindowHandle)
get_part (WindowHandle, Row1, Column1, Row2, Column2)
get_image_size (TiledImage, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (TiledImage)
dev_set_part (Row1, Column1, Row2, Column2)
Message := 'Method: \'' + Method + '\''
Message[1] := 'Recons...",231,645,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 600, 450, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row1, Column1, Width1, Height1)
dev_open_window (0, Width1 + 8..."
b2e8fe99,full,0,"This example creates a 3D model from 4 images taken from different points of view.
It shows the reco...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:  ...",10,546,
b2e8fe99,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:  ...",9,19,
b2e8fe99,micro,2,,"disp_message_block1 (Message)
stop ()",20,23,
b2e8fe99,micro,3,,"create_pose (0.01581839460406891, -0.09941803310558929, -0.3079308956836844, 350.8986040828125, 354.3536799369792, 274.1973698039017, 'Rp+T', 'gba', 'point', Pose0)
create_pose (-0.0610990419307257, -0.002271718614999785, -0.2908451228380092, 357.0205814462478, 13.76778713838595, 180.8404608013425, ...",26,34,"* --- Automatically Added Context ---
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,4,,"create_camera_setup_model (4, CameraSetupModelID)
set_camera_setup_cam_param (CameraSetupModelID, 0, [], CameraParam0, Pose0)
set_camera_setup_cam_param (CameraSetupModelID, 1, [], CameraParam1, Pose1)
set_camera_setup_cam_param (CameraSetupModelID, 2, [], CameraParam2, Pose2)
set_camera_setup_cam_p...",35,41,"* --- Automatically Added Context ---
create_pose (0.01581839460406891, -0.09941803310558929, -0.3079308956836844, 350.8986040828125, 354.3536799369792, 274.1973698039017, 'Rp+T', 'gba', 'point', Pose..."
b2e8fe99,micro,5,,"create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
set_stereo_model_image_pairs (StereoModelID, [0, 1, 2], [1, 2, 3])",42,45,"* --- Automatically Added Context ---
create_camera_setup_model (4, CameraSetupModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,6,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.1, -0.1, -0.1, 0.1, 0.1, 0.1])
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
disp_message_block2 (Message)",48,52,"* --- Automatically Added Context ---
disp_message_block1 (Message)
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,7,we estimate an initial bounding box.,"estimate_bounding_box_3d_reconstruction (StereoModelID, 0.05, BoundingBox)
set_stereo_model_param (StereoModelID, 'bounding_box', BoundingBox)",53,57,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,8,"set bounding box. This way, it is easy to configure the bounding box.","CameraSize := 0.02
ConeLength := 0.3
gen_camera_setup_object_model_3d (CameraSetupModelID, CameraSize, ConeLength, ObjectModel3DCamera, ObjectModel3DCone)
gen_bounding_box_object_model_3d (StereoModelID, ObjectModel3DBoundingBox)
Title := 'Initial bounding box with the cameras of the stereo setup'
v...",58,66,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Le..."
b2e8fe99,micro,9,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_window (WindowHandle2)
dev_clear_window ()",67,71,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,10,"desired disparity method. We also enable the persistence mode which later
will give us access to int...","set_stereo_model_param (StereoModelID, 'persistence', 1)
set_stereo_model_param (StereoModelID, 'disparity_method', 'binocular')",72,77,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,11,,"read_image (Images, 'universal_joint_part/universal_joint_part_scene_0_camera_' + [0:3])
get_image_size (Images, ImageWidth, ImageHeight)
tile_images (Images, TiledImage, 2, 'vertical')
display_reconstruction_message (TiledImage, WindowHandle1, 'binocular')
dev_set_window (WindowHandle2)
disp_messag...",78,88,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
disp_message_block1 (Message)
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
* --- End of Aut..."
b2e8fe99,micro,12,,"reconstruct_surface_stereo (Images, StereoModelID, ObjectModelSceneUnoptimized)",89,91,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
read_image (Images, 'universal_joint_part/universal_joint_part_scene_0_camera_..."
b2e8fe99,micro,13,,"disp_message_block4 (WindowHandle2, Message)
create_pose (0, 0.024, 0.53, 355, 0.0, 0.0, 'Rp+T', 'gba', 'point', VisPose)
visualize_object_model_3d (WindowHandle1, [ObjectModelSceneUnoptimized,ObjectModel3DBoundingBox], CameraParam0, VisPose, ['point_size_0', 'alpha_1', 'color_0', 'color_1', 'disp_p...",92,96,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Le..."
b2e8fe99,micro,14,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.08, -0.07, -0.045, 0.04, 0.03, 0.0])
reconstruct_surface_stereo (Images, StereoModelID, ObjectModelSceneUnoptimizedBBSmall)
gen_bounding_box_object_model_3d (StereoModelID, ObjectModel3DBoundingBox)
visualize_object_model_3d (WindowHandle1, ...",97,102,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Le..."
b2e8fe99,micro,15,,"get_stereo_model_object (FromImage, StereoModelID, [0, 1], 'from_image_rect')
get_stereo_model_object (ToImage, StereoModelID, [0, 1], 'to_image_rect')
concat_obj (FromImage, ToImage, RectifiedImages)
tile_images (RectifiedImages, TiledRectifiedImages, 2, 'horizontal')
get_image_size (TiledRectified...",103,115,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,16,,"disp_message_block5 (WindowHandle2, Message)
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (TiledRectifiedImages)
dev_set_color ('yellow')
dev_display (EpipolarLines)
Message := 'Rectified images and epipolar lines'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp...",116,127,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
disp_message_block1 (Message)
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
dev_disp_text ('..."
b2e8fe99,micro,17,,"get_stereo_model_object (DisparityImage, StereoModelID, [0, 1], 'disparity_image')
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (DisparityImage)
Message := 'Disparity image'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'win...",128,138,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
disp_message_block1 (Message)
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], Stereo..."
b2e8fe99,micro,18,,"set_stereo_model_param (StereoModelID, 'binocular_filter', 'left_right_check')",139,141,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,19,,"set_stereo_model_param (StereoModelID, 'binocular_sub_disparity', 'interpolation')",142,144,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,20,,"set_stereo_model_param (StereoModelID, 'binocular_num_levels', 4)",145,147,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,21,,"get_stereo_model_object (ScoreImage, StereoModelID, [0, 1], 'score_image')
ScoreThreshold := 0.7
disp_message_block7 (WindowHandle2, Message)
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_lut ('rainbow')
dev_display (ScoreImage)
Title := 'Score image'
dev_disp_text (Title, 'window', 12,...",148,160,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
disp_message_block1 (Message)
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], Stereo..."
b2e8fe99,micro,22,,"set_stereo_model_param (StereoModelID, 'binocular_score_thresh', ScoreThreshold)",161,163,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
ScoreThreshold := 0.7
* --- End of Automatically Added Context ---"
b2e8fe99,micro,23,,"threshold (ScoreImage, ScoreRegion, ScoreThreshold, 1)
reduce_domain (DisparityImage, ScoreRegion, DisparityImageReduced)
dev_set_window (WindowHandle1)
dev_set_lut ('default')
dev_clear_window ()
dev_display (DisparityImageReduced)
Title := 'Disparity image excluding disparities with a score &lt; '...",164,180,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
disp_message_block1 (Message)
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
Title := 'Initia..."
b2e8fe99,micro,24,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.08, -0.07, -0.045, 0.04, 0.028, 0.0])",183,184,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,25,,"reconstruct_surface_stereo (Images, StereoModelID, ObjectModelSceneOptimized)",193,194,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
read_image (Images, 'universal_joint_part/universal_joint_part_scene_0_camera_..."
b2e8fe99,micro,26,,"set_stereo_model_param (StereoModelID, 'persistence', 0)",195,197,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
b2e8fe99,micro,27,,"disp_message_block9 (Message)
create_pose (0.025, 0.03, 0.25, 345, 0, 0, 'Rp+T', 'gba', 'point', VisPose)
visualize_object_model_3d (WindowHandle1, ObjectModelSceneOptimized, CameraParam0, VisPose, ['point_size', 'color'], [2, 'yellow'], 'Final result', [], Instructions, VisPose)
disp_end_of_program...",198,219,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_pose (0, 0.15, 1.1, 285, 0.0, 340, 'Rp+T', 'gba', 'point', VisPose)
Instructions[0] := 'Rotate: Le..."
b2e8fe99,micro,28,,"dev_set_window (WindowHandle)
get_part (WindowHandle, Row1, Column1, Row2, Column2)
get_image_size (TiledImage, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (TiledImage)
dev_set_part (Row1, Column1, Row2, Column2)
Message := 'Method: \'' + Method + '\''
Message[1] := 'Recons...",220,554,"* --- Automatically Added Context ---
disp_message_block1 (Message)
dev_open_window (0, 608, 400, 450, 'black', WindowHandle2)
tile_images (Images, TiledImage, 2, 'vertical')
get_image_size (TiledRect..."
dfe9567a,full,0,"This example shows how to calibrate a sheet-of-light setup with
calibrate_sheet_of_light.
In order t...","dev_update_off ()
read_image (CalibObjectDisparity, 'sheet_of_light/calib_object_disparity')
get_image_size (CalibObjectDisparity, Width, Height)
dev_close_window ()
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'fals...",17,100,
dfe9567a,micro,1,"You can create a CAD model of the 3D calibration object with
create_sheet_of_light_calib_object. The...","dev_update_off ()
read_image (CalibObjectDisparity, 'sheet_of_light/calib_object_disparity')
get_image_size (CalibObjectDisparity, Width, Height)
dev_close_window ()
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'fals...",9,23,
dfe9567a,micro,2,"model and initialize it with the parameters of the camera. So far,
calibrate_sheet_of_light only sup...","read_object_model_3d ('calib_object.dxf', 'm', [], [], CalibObject3D, Status)
create_pose (0.000, 0.07, 2.7, 130, 350, 125, 'Rp+T', 'gba', 'point', VisualizationPoseModel)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + le...",24,34,"* --- Automatically Added Context ---
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
dfe9567a,micro,3,,"gen_cam_par_area_scan_division (0.016, 0, 4.65e-06, 4.65e-06, 640, 512, 1280, 1024, CameraParam)
set_system ('clip_region', 'false')
get_cam_par_data (CameraParam, 'image_width', ImageWidth)
get_cam_par_data (CameraParam, 'image_height', ImageHeight)
gen_rectangle1 (Domain, 0, 0, ImageHeight - 1, Im...",35,43,
dfe9567a,micro,4,,"set_sheet_of_light_param (SheetOfLightModelID, 'calibration_object', 'calib_object.dxf')",44,46,"* --- Automatically Added Context ---
create_sheet_of_light_model (Domain, [], [], SheetOfLightModelID)
* --- End of Automatically Added Context ---"
dfe9567a,micro,5,,"dev_clear_window ()
dev_set_paint (['3d_plot', 'shaded', 8, 0.9, 0.02, 0.3, -0.3, 0.3, -0.01, -0.003, -0.025])
dev_display (CalibObjectDisparity)
disp_message (WindowHandle, 'Measured disparity of the calibration object', 'window', 12, 12, 'black', 'true')
set_profile_sheet_of_light (CalibObjectDisp...",53,61,"* --- Automatically Added Context ---
read_image (CalibObjectDisparity, 'sheet_of_light/calib_object_disparity')
get_image_size (CalibObjectDisparity, Width, Height)
dev_open_window_fit_image (CalibOb..."
dfe9567a,micro,6,,"calibrate_sheet_of_light (SheetOfLightModelID, Error)",62,63,"* --- Automatically Added Context ---
create_sheet_of_light_model (Domain, [], [], SheetOfLightModelID)
* --- End of Automatically Added Context ---"
dfe9567a,micro,7,,"set_profile_sheet_of_light (CalibObjectDisparity, SheetOfLightModelID, [])
get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, ObjectModel3D)
dev_clear_window ()",67,71,"* --- Automatically Added Context ---
read_image (CalibObjectDisparity, 'sheet_of_light/calib_object_disparity')
create_sheet_of_light_model (Domain, [], [], SheetOfLightModelID)
* --- End of Automati..."
dfe9567a,micro,8,,"create_surface_model (CalibObject3D, 0.03, [], [], SurfaceModelID)
find_surface_model (SurfaceModelID, ObjectModel3D, 0.05, 0.2, 0, 'false', [], [], Pose, Score, SurfaceMatchingResultID)
pose_to_hom_mat3d (Pose, CHomMat3D)
affine_trans_object_model_3d (CalibObject3D, CHomMat3D, ObjectModel3DAffineTr...",72,78,"* --- Automatically Added Context ---
read_object_model_3d ('calib_object.dxf', 'm', [], [], CalibObject3D, Status)
create_pose (0.000, 0.07, 2.7, 130, 350, 125, 'Rp+T', 'gba', 'point', VisualizationP..."
dfe9567a,micro,9,,"select_points_object_model_3d (ObjectModel3D, 'point_coord_z', 0.001, 1, ObjectModel3DThresholded)
sample_object_model_3d (ObjectModel3DThresholded, 'accurate', 0.001, [], [], ObjectModel3DSampled)
Title := 'Calibrated reconstruction of the measurement (yellow) together with the calibration object (...",79,85,"* --- Automatically Added Context ---
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
Instructions[0] := 'Rotate: Left button'
Title := 'CAD model of the calibration objec..."
dfe9567a,micro,10,,"get_sheet_of_light_param (SheetOfLightModelID, 'camera_parameter', CamParamResult)
get_sheet_of_light_param (SheetOfLightModelID, 'camera_pose', CameraPose)
get_sheet_of_light_param (SheetOfLightModelID, 'lightplane_pose', LightPlanePose)
get_sheet_of_light_param (SheetOfLightModelID, 'movement_pose...",86,94,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.016, 0, 4.65e-06, 4.65e-06, 640, 512, 1280, 1024, CameraParam)
create_sheet_of_light_model (Domain, [], [], SheetOfLightModelID)..."
dfe9567a,micro,11,,"gen_sheet_of_light_object_model_3d (SheetOfLightModelID, 0.2, 0.05, 0.4, OM3DLightPlane, OM3DMovement, OM3DCamera, OM3DCone)
visualize_object_model_3d (WindowHandle, [CalibObject3D,OM3DLightPlane,OM3DMovement,OM3DCamera,OM3DCone], [], [0.0309362, 0.15155, 8.14821, 100.687, 1.86383, 90.368, 0], ['alp...",95,98,"* --- Automatically Added Context ---
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
read_object_model_3d ('calib_object.dxf', 'm', [], [], CalibObject3D, Status)
visuali..."
dfe9567a,micro,12,,"visualize_object_model_3d (WindowHandle, [ObjectModel3DSampled,OM3DLightPlane,OM3DMovement,OM3DCamera,OM3DCone], [], PoseOut, ['alpha_1', 'alpha_3', 'alpha_4', 'alpha_5', 'color_0', 'color_3', 'color_4', 'color_5'], [0.5, 0.5, 0.5, 0.5, 'blue', 'green', 'green', 'green'], 'Setup with reconstructed o...",99,106,"* --- Automatically Added Context ---
dev_open_window_fit_image (CalibObjectDisparity, 0, 0, -1, -1, WindowHandle)
visualize_object_model_3d (WindowHandle, CalibObject3D, [], VisualizationPoseModel, [..."
8d8594c5,full,0,"This example shows the main workflow necessary when using the
structured light method for 3D surface...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()
HSLMFile := './calibration/structured_light_model_3d.hslm'
try
read_structured_light_model (HSLMFile, Structure...",18,450,
8d8594c5,micro,1,StructuredLight/structured_light_calibration.hdev.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()",15,25,
8d8594c5,micro,2,"Read the structured light model that was generated by the
calibration example.","HSLMFile := './calibration/structured_light_model_3d.hslm'
try
read_structured_light_model (HSLMFile, StructuredLightModel)
catch (Exception)
if (Exception[0] == 5200)
dev_disp_hslm_file_error (HSLMFile, Text)
return ()
else
throw (Exception)
endif
endtry",26,41,
8d8594c5,micro,3,'3d_reconstruction'.,"get_structured_light_model_param (StructuredLightModel, 'type', ModelType)
if (ModelType != '3d_reconstruction')
dev_clear_window ()
Message := 'The type of the structured light model is \'' + ModelType + '\''
Message[1] := 'and not \'3d_reconstruction\' as expected!'
Message[2] := 'The program will...",42,53,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
* --- End of Automatically Added Context ---"
8d8594c5,micro,4,"therefore we ensure that the parameter 'pattern_orientation' is
set to 'vertical'.","get_structured_light_model_param (StructuredLightModel, 'pattern_orientation', PatternOrientation)
if (PatternOrientation != 'vertical')
PatternOrientation := 'vertical'
endif
dev_disp_read_structured_light_text ()
stop ()",54,64,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
* --- End of Automatically Added Context ---"
8d8594c5,micro,5,view of the camera.,"gen_structured_light_pattern (PatternImages, StructuredLightModel)
dev_disp_acquisition_text ()
stop ()
dev_clear_window ()",65,72,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
* --- End of Automatically Added Context ---"
8d8594c5,micro,6,corresponding camera images.,"acquire_camera_images_structured_light_3d (PatternImages, CameraImages)",73,76,"* --- Automatically Added Context ---
gen_structured_light_pattern (PatternImages, StructuredLightModel)
* --- End of Automatically Added Context ---"
8d8594c5,micro,7,"images and estimate the reliable pixels. This allows to
generate more robust results and also reduce...","UseModulation := true
if (UseModulation)
dev_disp_modulation_text ()
stop ()
ModulationType := 'phase_shift_modulation'
compute_structured_light_modulation (CameraImages, ModulationImage, StructuredLightModel, ModulationType)
MinPSModulation := 0.4
MaxPSModulation := 1.0
threshold (ModulationImage, ...",77,112,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
read_structured_light_model (HSLMFile, StructuredLightModel)
Message := 'The type of the structured light ..."
8d8594c5,micro,8,Set the parameter 'min_gray_difference' to a suitable value.,"MinGrayDifference := 5
set_structured_light_model_param (StructuredLightModel, 'min_gray_difference', MinGrayDifference)
dev_disp_decoding_text ()
stop ()
decode_structured_light_pattern (CameraImages, StructuredLightModel)",113,119,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
acquire_camera_images_structured_light_3d (PatternImages, CameraImages)
* --- End of Automatically Ad..."
8d8594c5,micro,9,,"get_structured_light_object (CorrespondenceImage, StructuredLightModel, 'correspondence_image')
dev_clear_window ()
dev_display (CorrespondenceImage)
Message := 'Correspondence image: Column values of the corresponding'
Message[1] := '                      projector pixels'
dev_disp_text (Message, '...",120,129,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
Message := 'The type of the structured light model is \'' + ModelType + '\''
get_structured_light_mod..."
8d8594c5,micro,10,,"reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3D)",130,132,"* --- Automatically Added Context ---
read_structured_light_model (HSLMFile, StructuredLightModel)
* --- End of Automatically Added Context ---"
8d8594c5,micro,11,,"dev_clear_window ()
visualize_3d_result (ObjectModel3D, WindowHandle, PoseOut)",133,136,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3D)
* --- End of Automatically Adde..."
8d8594c5,micro,12,the reconstructed 3D object model.,"retrieve_texture_structured_light (CameraImages, TextureImage)
get_object_model_3d_params (ObjectModel3D, 'mapping_row', MappingRow)
get_object_model_3d_params (ObjectModel3D, 'mapping_col', MappingCol)
get_grayval (TextureImage, MappingRow, MappingCol, Grayval)
set_object_model_3d_attrib_mod (Objec...",137,144,"* --- Automatically Added Context ---
acquire_camera_images_structured_light_3d (PatternImages, CameraImages)
reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3D)
* --- End of Au..."
8d8594c5,micro,13,,"visualize_3d_result_with_texture (WindowHandle, ObjectModel3D, PoseOut)",145,162,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3D)
visualize_3d_result (ObjectMode..."
8d8594c5,micro,14,window specified by WindowHandle.,"dev_set_window (WindowHandle)
dev_clear_window ()
Title[0] := '3D representation of the reconstructed surface.'
Title[1] := '(False color representation. Color codes z-coordinates.)'
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl +...",163,200,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3D)
visualize_3d_result (ObjectMode..."
8d8594c5,micro,15,texture in the graphic window specified by WindowHandle.,"dev_set_window (WindowHandle)
dev_clear_window ()
Title[0] := '3D representation of the reconstructed surface'
Title[1] := 'with a gray value texture.'
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
dev_set_window (W...",201,293,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
dev_disp_hslm_file_error (HSLMFile, Text)
Message[2] := 'The program will return!'
dev_disp_text ('Press R..."
8d8594c5,micro,16,"displayed. In this example, we display the pattern images in
an HDevelop graphics window for visuali...","dev_open_window (0, 0, 600, 450, 'black', WindowHandleProjector)
dev_open_window (0, 609, 600, 450, 'black', WindowHandleCamera)",294,303,
8d8594c5,micro,17,"value images of type byte or uint2.
Adapt the call of open_framegrabber to your camera and set
suita...","DirName := 'structured_light/cast_part/'
open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', DirName, 'default', -1, -1, AcqHandle)",304,309,
8d8594c5,micro,18,camera image of the diffuse reflecting object.,"count_obj (PatternImages, NumberOfPatternImages)
gen_empty_obj (CameraImages)
for Index := 1 to NumberOfPatternImages by 1
select_obj (PatternImages, DisplayImage, Index)
dev_set_window (WindowHandleProjector)
dev_display (DisplayImage)
dev_disp_text ('Pattern image ' + Index + ' of ' + NumberOfPatt...",310,330,"* --- Automatically Added Context ---
gen_structured_light_pattern (PatternImages, StructuredLightModel)
acquire_camera_images_structured_light_3d (PatternImages, CameraImages)
dev_open_window (0, 0, ..."
8d8594c5,micro,19,,close_framegrabber (AcqHandle),331,333,"* --- Automatically Added Context ---
open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', DirName, 'default', -1, -1, AcqHandle)
* --- End of Automatically Adde..."
8d8594c5,micro,20,images were displayed.,"dev_set_window (WindowHandleCamera)
dev_close_window ()
dev_set_window (WindowHandleProjector)
dev_close_window ()
return ()
dev_clear_window ()
Text := 'Decoding the acquired camera images:'
Text[1] := ' '
Text[2] := 'For each camera pixel, the algorithm determines the corresponding'
Text[3] := 'pr...",334,459,"* --- Automatically Added Context ---
HSLMFile := './calibration/structured_light_model_3d.hslm'
dev_disp_hslm_file_error (HSLMFile, Text)
Message[2] := 'The program will return!'
Message[1] := 'Pixel..."
8c630499,full,0,"This example shows the workflow necessary when calibrating a
structured light setup for the 3D surfa...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
CalibObjDescr := 'calibration/calplat...",18,737,
8c630499,micro,1,StructuredLight/structured_light_3d_surface_reconstruction.hdev.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()",15,25,
8c630499,micro,2,model type '3d_reconstruction'.,"create_structured_light_model ('3d_reconstruction', StructuredLightModel)",26,30,
8c630499,micro,3,"Description file of the calibration plate
Note that for optimum results it is recommended to use a
c...",CalibObjDescr := 'calibration/calplate.cpd',31,36,
8c630499,micro,4,projected by the pattern projector.,"PatternWidth := 1280
PatternHeight := 720",37,41,
8c630499,micro,5,images in addition to Gray code images are displayed.,PatternType := 'gray_code_and_phase_shift',42,44,
8c630499,micro,6,"patterns with both vertical and horizontal orientation must
be projected, therefore PatternOrientati...",PatternOrientation := 'both',45,48,
8c630499,micro,7,"Gray code images. The parameter is chosen such that the
smallest stripes are still clearly visible i...",MinStripeWidth := 16,49,53,
8c630499,micro,8,"code images. In this case we use the type 'global' in which a
completely white image and a completel...",Normalization := 'global',54,58,
8c630499,micro,9,"images. Pixels whose gray value difference in the Gray code
is smaller than 'min_gray_difference', a...",MinGrayDifference := 10,59,66,
8c630499,micro,10,,"GenParamNames := ['pattern_width', 'pattern_height', 'pattern_type', 'pattern_orientation', 'min_stripe_width', 'normalization', 'min_gray_difference']
GenParamValues := [PatternWidth,PatternHeight,PatternType,PatternOrientation,MinStripeWidth,Normalization,MinGrayDifference]
set_structured_light_mo...",67,74,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
PatternWidth := 1280
PatternHeight := 720
PatternType := 'gray_code_and_phase_shift'
Pat..."
8c630499,micro,11,the field of view of the camera.,"gen_structured_light_pattern (PatternImages, StructuredLightModel)",75,78,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
* --- End of Automatically Added Context ---"
8c630499,micro,12,,"dev_disp_calib_parameters_text ()
stop ()",79,81,
8c630499,micro,13,,"CamWidth := 1086
CamHeight := 814
CamFocus := 12.5e-3
CamK1 := .0
CamK2 := .0
CamK3 := .0
CamP1 := .0
CamP2 := .0
CamSx := 4.6e-6
CamSy := CamSx
CamCx := CamWidth * .5
CamCy := CamHeight * .5
gen_cam_par_area_scan_polynomial (CamFocus, CamK1, CamK2, CamK3, CamP1, CamP2, CamSx, CamSy, CamCx, CamCy, C...",82,96,
8c630499,micro,14,,"get_structured_light_model_param (StructuredLightModel, 'pattern_width', PatternWidth)
get_structured_light_model_param (StructuredLightModel, 'pattern_height', PatternHeight)
ProjFocus := 8.0e-3
ProjK1 := .0
ProjK2 := .0
ProjK3 := .0
ProjP1 := .0
ProjP2 := .0
ProjSx := 5.4e-6
ProjSy := ProjSx
ProjC...",97,112,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
PatternWidth := 1280
PatternHeight := 720
* --- End of Automatically Added Context ---"
8c630499,micro,15,represents the structured light setup for 3D reconstruction.,"create_calib_data ('calibration_object', 2, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, CalibObjDescr)
set_calib_data_cam_param (CalibDataID, 0, [], InitialCamParam)
set_calib_data_cam_param (CalibDataID, 1, [], InitialProjParam)
set_calib_data (CalibDataID, 'model', 'general', 'ref...",113,122,"* --- Automatically Added Context ---
CalibObjDescr := 'calibration/calplate.cpd'
gen_cam_par_area_scan_polynomial (CamFocus, CamK1, CamK2, CamK3, CamP1, CamP2, CamSx, CamSy, CamCx, CamCy, CamWidth, C..."
8c630499,micro,16,calibration data model.,"dev_disp_acquisition_text ()
stop ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj)
set_display_font (WindowHandleProj, 14, 'mono', 'true', 'false')
dev_open_window (0, 609, 600, 450, 'black', WindowHandleCam)
set_display_font (WindowHandleCam, 14, 'mono', 'true', 'false')",123,132,
8c630499,micro,17,,"DirName := 'structured_light/calibration/'
GenParamName := 'rms_pose_error_max'
GenParamValue := 6.5
NumPoses := 6
for PoseIndex := 0 to NumPoses - 1 by 1
ImageDir := DirName + 'pose_' + PoseIndex$'02d'
acquire_camera_images_structured_light (PatternImages, CameraImages, ImageDir, PoseIndex, WindowH...",133,170,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
gen_structured_light_pattern (PatternImages, StructuredLightModel)
create_calib_data ('c..."
8c630499,micro,18,and of the projector and validate the calibration results.,"calibrate_cameras (CalibDataID, CalibErrorRms)
dev_disp_calib_results (CalibDataID, CalibErrorRms, WindowHandleCam, WindowHandleProj)
disp_continue_message (WindowHandleProj, 'black', 'true')
stop ()",171,178,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj)
dev_open_window (0, 609, 600, 450, 'black'..."
8c630499,micro,19,"The reference coordinate system of the camera setup model is
set to the pose of the calibration plat...","RefPoseIndex := 0
get_calib_data (CalibDataID, 'calib_obj_pose', [0,RefPoseIndex], 'pose', RefPose)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)
set_camera_setup_param (CameraSetupModelID, 'general', 'coord_transf_pose', RefPose)",179,187,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
8c630499,micro,20,pose 0 of the calibration.,"get_calib_data_observ_points (CalibDataID, 0, 0, RefPoseIndex, Row, Column, Index, Pose)
caltab_points (CalibObjDescr, X, Y, Z)
gen_object_model_3d_from_points (X[Index], Y[Index], Z[Index], ObjectModel3DCalPlateRef)
gen_camera_setup_object_model_3d (CameraSetupModelID, 'auto', 'auto', ObjectModel3D...",188,196,"* --- Automatically Added Context ---
CalibObjDescr := 'calibration/calplate.cpd'
create_calib_data ('calibration_object', 2, 1, CalibDataID)
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj..."
8c630499,micro,21,,"set_structured_light_model_param (StructuredLightModel, 'camera_setup_model', CameraSetupModelID)",197,199,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelI..."
8c630499,micro,22,"sufficient, therefore we adapt the pattern orientation and
generate the new stripe patterns.","set_structured_light_model_param (StructuredLightModel, 'pattern_orientation', 'vertical')
gen_structured_light_pattern (PatternImages, StructuredLightModel)",200,205,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
gen_structured_light_pattern (PatternImages, StructuredLightModel)
* --- End of Automati..."
8c630499,micro,23,for 3D reconstruction.,"HSLMFile := './calibration/structured_light_model_3d.hslm'
write_structured_light_model (StructuredLightModel, HSLMFile)",206,210,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
* --- End of Automatically Added Context ---"
8c630499,micro,24,calibration plate.,"dev_clear_window ()
dev_set_window (WindowHandleProj)
dev_disp_perform_reconstruction ()
disp_continue_message (WindowHandleProj, 'black', 'true')
stop ()",211,218,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj)
* --- End of Automatically Added Context ---"
8c630499,micro,25,projected on it.,"ImageFiles := DirName + 'pose_00/sequence_reconstruction.seq'
acquire_camera_images_structured_light (PatternImages, CameraImages, ImageFiles, 0, WindowHandleCam, WindowHandleProj, NumberOfPatternImages)
dev_set_window (WindowHandleCam)
dev_close_window ()
dev_set_window (WindowHandleProj)
dev_close...",219,227,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj)
dev_open_window (0, 609, 600, 450, 'black', WindowHandleCam)
DirName := 'structured_light/calibration/..."
8c630499,micro,26,,"decode_structured_light_pattern (CameraImages, StructuredLightModel)
reconstruct_surface_structured_light (StructuredLightModel, ObjectModel3DCaltab)",228,231,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
acquire_camera_images_structured_light (PatternImages, CameraImages, ImageDir, PoseIndex..."
8c630499,micro,27,the reconstructed 3D object model.,"retrieve_texture_structured_light (CameraImages, TextureImage)
get_object_model_3d_params (ObjectModel3DCaltab, 'mapping_row', MappingRow)
get_object_model_3d_params (ObjectModel3DCaltab, 'mapping_col', MappingCol)
get_grayval (TextureImage, MappingRow, MappingCol, Grayval)
set_object_model_3d_attri...",232,240,"* --- Automatically Added Context ---
acquire_camera_images_structured_light (PatternImages, CameraImages, ImageDir, PoseIndex, WindowHandleCam, WindowHandleProj, NumberOfPatternImages)
reconstruct_su..."
8c630499,micro,28,,"visualize_3d_result_with_texture (WindowHandle, [ObjectModel3DCaltab,ObjectModel3DCalPlateRef], PoseOut)
dev_disp_program_end ()",241,263,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
gen_object_model_3d_from_points (X[Index], Y[Index], Z[Index], ObjectModel3DCalPlateRef)
reconstruct_surfa..."
8c630499,micro,29,marks in the camera and projector arrays.,"get_structured_light_model_param (StructuredLightModel, 'pattern_width', PatternWidth)
get_structured_light_model_param (StructuredLightModel, 'pattern_height', PatternHeight)
retrieve_texture_structured_light (ImageSequence, TextureImage)
gen_contour_polygon_xld (ProjArray, [0, 0,PatternHeight - 1,...",264,479,"* --- Automatically Added Context ---
create_structured_light_model ('3d_reconstruction', StructuredLightModel)
CalibObjDescr := 'calibration/calplate.cpd'
PatternWidth := 1280
PatternHeight := 720
cr..."
8c630499,micro,30,,"if (CameraType == 'area_scan_polynomial')
CamStyle := ['s', '.2e', '.2e', '.2e', '.2e', '.2e', '.2e', '.1e', '.1e', '.2f', '.2f', 'd', 'd']
CamUnit := ['', ' m', '', '', '', '', '', ' m', ' m', ' px', ' px', ' px', ' px']
elseif (CameraType == 'area_scan_division')
CamStyle := ['s', '.2e', '.2f', '....",480,569,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandleProj)
dev_open_window (0, 609, 600, 450, 'black', WindowHandleCam)
calibrate_cameras (CalibDataID, CalibErro..."
8c630499,micro,31,"is highly recommended to synchronize the pattern projector and
the camera, preferably at a hardware ...","open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', ImageDir, 'default', -1, -1, AcqHandle)",582,586,"* --- Automatically Added Context ---
ImageDir := DirName + 'pose_' + PoseIndex$'02d'
DirName := 'structured_light/calibration/'
for PoseIndex := 0 to NumPoses - 1 by 1
* --- End of Automatically Adde..."
8c630499,micro,32,"corresponding camera image of the surface of the object that
shows the projected pattern.","count_obj (PatternImages, NumberOfPatternImages)
gen_empty_obj (CameraImages)
for Index := 1 to NumberOfPatternImages by 1
select_obj (PatternImages, DisplayImage, Index)
dev_set_window (WindowHandleProjector)
dev_display (DisplayImage)
dev_disp_text ('Pose #' + PoseIndex$'02d' + ' - Pattern image '...",587,614,"* --- Automatically Added Context ---
for PoseIndex := 0 to NumPoses - 1 by 1
acquire_camera_images_structured_light (PatternImages, CameraImages, ImageDir, PoseIndex, WindowHandleCam, WindowHandlePro..."
8c630499,micro,33,,"close_framegrabber (AcqHandle)
return ()",615,642,"* --- Automatically Added Context ---
open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', ImageDir, 'default', -1, -1, AcqHandle)
* --- End of Automatically Add..."
8c630499,micro,34,texture in the graphic window specified by WindowHandle.,"dev_set_window (WindowHandle)
dev_clear_window ()
Title := 'Reconstructed calibration plate'
Instructions := 'Rotate: Left button'
Instructions[1] := 'Zoom: Shift + left button'
Instructions[2] := 'Move: Ctrl + left button'
dev_set_window (WindowHandle)
dev_set_lut ('default')
GenParamNames := ['lut...",643,722,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
PatternWidth := 1280
PatternHeight := 720
PatternType := 'gray_code_and_phase_shift'
PatternOrientation :=..."
8c630499,micro,35,graphic window specified by WindowHandle.,"dev_set_window (WindowHandle)
dev_clear_window ()
Title := 'Structured light setup and calibration points of the reference pose'
GenParamName := ['alpha_4', 'alpha_5', 'color_6', 'disp_pose_6']
GenParamValue := [.25, .25, 'green', 'true']
Pose := [0.1, 0.25, 11.2, 290., 3.0, 270., 0]
Instructions :=...",723,746,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
GenParamName := 'rms_pose_error_max'
GenParamValue := 6.5
get_calib_data_observ_points (CalibDataID, 0, 0,..."
417e63a5,full,0,"This example program checks the right position of a label on
a shampoo bottle.
First, two shape mode...","dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
set_system ('clip_region', 'false')
read_image (Image, 'packaging/shampoo_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (...",14,150,
417e63a5,micro,1,,"dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)",13,17,
417e63a5,micro,2,,"set_system ('clip_region', 'false')
read_image (Image, 'packaging/shampoo_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)",18,25,
417e63a5,micro,3,,"BottleModelRow := 131
BottleModelColumn := 370
BottleModelLength1 := 350
BottleModelLength2 := 35
BottleModelPhi := -0.1093
gen_rectangle2 (Rectangle1, BottleModelRow, BottleModelColumn, BottleModelPhi, BottleModelLength1, BottleModelLength2)
gen_rectangle2 (Rectangle2, BottleModelRow + 220, BottleM...",28,42,"* --- Automatically Added Context ---
read_image (Image, 'packaging/shampoo_01')
* --- End of Automatically Added Context ---"
417e63a5,micro,4,,"create_shape_model (ImageReduced, 5, -rad(3), rad(6), 0, 'auto', 'use_polarity', 25, 3, ModelIDBottle)",43,45,"* --- Automatically Added Context ---
reduce_domain (Image, TemplateBottleRegion, ImageReduced)
* --- End of Automatically Added Context ---"
417e63a5,micro,5,,"dev_display (Image)
dev_set_color ('forest green')
dev_display (TemplateBottleRegion)
dev_set_color ('slate blue')
disp_message (WindowHandle, 'bottle shape model', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",46,54,"* --- Automatically Added Context ---
read_image (Image, 'packaging/shampoo_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
union2 (Rectangle1, Rectangle2, TemplateBottleRegion)
* -..."
417e63a5,micro,6,,"LabelRow1 := 180
LabelRow2 := 310
LabelColumn1 := 50
LabelColumn2 := 470
gen_rectangle1 (TemplateLabelRegion, LabelRow1, LabelColumn1, LabelRow2, LabelColumn2)
area_center (TemplateLabelRegion, Area1, RowLabelRef, ColumnLabelRef)
gen_circle (SearchROILabel, RowLabelRef, ColumnLabelRef, 60)
reduce_do...",55,65,"* --- Automatically Added Context ---
read_image (Image, 'packaging/shampoo_01')
reduce_domain (Image, TemplateBottleRegion, ImageReduced)
* --- End of Automatically Added Context ---"
417e63a5,micro,7,,"create_shape_model (ImageReduced, 5, rad(-3), rad(6), 0, 'auto', 'use_polarity', 25, 5, ModelIDLabel1)
create_shape_model (ImageReduced, 5, rad(180 - 3), rad(6), 0, 'auto', 'use_polarity', 25, 5, ModelIDLabel2)
ModelIDsLabel := [ModelIDLabel1,ModelIDLabel2]",66,70,"* --- Automatically Added Context ---
reduce_domain (Image, TemplateBottleRegion, ImageReduced)
* --- End of Automatically Added Context ---"
417e63a5,micro,8,,"dev_display (Image)
dev_set_color ('forest green')
dev_display (TemplateLabelRegion)
dev_set_color ('slate blue')
dev_display (ModelRegions)
disp_message (WindowHandle, 'create label shape model', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",71,80,"* --- Automatically Added Context ---
read_image (Image, 'packaging/shampoo_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_rectangle1 (TemplateLabelRegion, LabelRow1, LabelColu..."
417e63a5,micro,9,,"for Index := 1 to 13 by 1
read_image (Image, 'packaging/shampoo_' + Index$'.2')
dev_display (Image)
disp_message (WindowHandle, 'check label position', 'window', 12, 12, 'black', 'true')
count_seconds (s1)
reduce_domain (Image, SearchROIBottle, ImageReduced)
find_shape_model (ImageReduced, ModelIDBo...",83,156,"* --- Automatically Added Context ---
read_image (Image, 'packaging/shampoo_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
area_center (TemplateBottleRegion, Area, RowBottleRef, Co..."
dcb75f37,full,0,Read circularly printed bar codes.,"dev_update_off ()
get_system ('clip_region', Information)
set_system ('clip_region', 'true')
read_image (Image, 'circular_barcode')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_colored (12)
dev_display (Image)
...",8,69,
dcb75f37,micro,1,,"dev_update_off ()
get_system ('clip_region', Information)
set_system ('clip_region', 'true')
read_image (Image, 'circular_barcode')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_colored (12)
dev_display (Image)
...",6,19,
dcb75f37,micro,2,,"threshold (Image, Region, 0, 100)
closing_circle (Region, Region, 3.5)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, Ring, ['width', 'height'], 'and', [550, 550], [750, 750])
shape_trans (Ring, OuterCircle, 'outer_circle')
complement (Ring, RegionComplement)
connection (Regio...",20,29,"* --- Automatically Added Context ---
read_image (Image, 'circular_barcode')
* --- End of Automatically Added Context ---"
dcb75f37,micro,3,,"smallest_circle (Ring, Row, Column, OuterRadius)
smallest_circle (InnerCircle, InnerRow, InnerColumn, InnerRadius)
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_display (Image)
dev_display (OuterCircle)
dev_display (InnerCircle)
stop ()",30,40,"* --- Automatically Added Context ---
read_image (Image, 'circular_barcode')
select_shape (ConnectedRegions, Ring, ['width', 'height'], 'and', [550, 550], [750, 750])
shape_trans (Ring, OuterCircle, '..."
dcb75f37,micro,4,of the ring in the image that contains the bar code.,"WidthPolar := 1440
HeightPolar := round(OuterRadius - InnerRadius - 10)
polar_trans_image_ext (Image, PolarTransImage, Row, Column, rad(360), 0, OuterRadius - 5, InnerRadius + 5, WidthPolar, HeightPolar, 'bilinear')
invert_image (PolarTransImage, ImageInvert)",41,47,"* --- Automatically Added Context ---
read_image (Image, 'circular_barcode')
smallest_circle (Ring, Row, Column, OuterRadius)
smallest_circle (InnerCircle, InnerRow, InnerColumn, InnerRadius)
* --- En..."
dcb75f37,micro,5,,"zoom_image_factor (ImageInvert, ImageZoomed, 1, 2, 'weighted')
create_bar_code_model ([], [], BarCodeHandle)",48,51,"* --- Automatically Added Context ---
invert_image (PolarTransImage, ImageInvert)
* --- End of Automatically Added Context ---"
dcb75f37,micro,6,,"set_bar_code_param (BarCodeHandle, 'element_size_min', 1.5)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.3)
find_bar_code (ImageZoomed, SymbolRegions, BarCodeHandle, 'Code 128', DecodedDataStrings)
dev_set_window_extents (-1, -1, WidthPolar / 2, HeightPolar)
dev_display (ImageZoomed)
dev_disp...",52,62,"* --- Automatically Added Context ---
get_system ('clip_region', Information)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
smallest_circle (Ring, Row, Column, OuterRadius)
smal..."
dcb75f37,micro,7,,"zoom_region (SymbolRegions, SymbolRegions, 1, 0.5)
polar_trans_region_inv (SymbolRegions, CodeRegionCircular, Row, Column, rad(360), 0, OuterRadius - 5, InnerRadius + 5, WidthPolar, HeightPolar, Width, Height, 'nearest_neighbor')
dev_set_window_extents (-1, -1, Width / 2, Height / 2)
dev_display (Im...",63,75,"* --- Automatically Added Context ---
read_image (Image, 'circular_barcode')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
smallest_circle ..."
019bdc2a,full,0,"This example illustrates the inspection process for        *
electrode sheets, specifically focusing...","dev_update_off ()
dev_close_window ()
collect_defect_images ('battery_electrode', ImageFilesDefect)
read_image (ImageInit, ImageFilesDefect[0])
get_image_size (ImageInit, ImgWidth, ImgHeight)
visualize_image_data (ImageInit)
stop ()
dev_close_window ()
visualize_defect_classes (ImageInit)
stop ()
de...",33,796,
019bdc2a,micro,1,,"dev_update_off ()
dev_close_window ()
collect_defect_images ('battery_electrode', ImageFilesDefect)
read_image (ImageInit, ImageFilesDefect[0])
get_image_size (ImageInit, ImgWidth, ImgHeight)",32,38,
019bdc2a,micro,2,,"visualize_image_data (ImageInit)
stop ()
dev_close_window ()",39,43,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFilesDefect[0])
* --- End of Automatically Added Context ---"
019bdc2a,micro,3,,"visualize_defect_classes (ImageInit)
stop ()
dev_close_window ()",44,49,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFilesDefect[0])
* --- End of Automatically Added Context ---"
019bdc2a,micro,4,,"dev_open_windows_for_detection (WindowHandleLegend, ToolId, WindowHandleDefect)
for Index := 0 to |ImageFilesDefect| - 1 by 1
read_image (Image, ImageFilesDefect[Index])
binary_threshold (Image, RegionThreshold, 'max_separability', 'dark', UsedThreshold)
fill_up (RegionThreshold, RegionFillUp)
conne...",54,146,"* --- Automatically Added Context ---
collect_defect_images ('battery_electrode', ImageFilesDefect)
* --- End of Automatically Added Context ---"
019bdc2a,micro,5,of detection.,"dev_close_windows_for_detection (WindowHandleLegend, ToolId, WindowHandleDefect)",147,151,"* --- Automatically Added Context ---
dev_open_windows_for_detection (WindowHandleLegend, ToolId, WindowHandleDefect)
* --- End of Automatically Added Context ---"
019bdc2a,micro,6,,"visualize_description_measurement ()
stop ()
dev_close_window ()
read_image (ImageMeasure, 'battery_electrode/battery_measure')
get_image_size (ImageMeasure, WidthMeas, HeightMeas)",156,163,
019bdc2a,micro,7,is done.,"MeasDist := 30
RowMeas := 80
ColMeas := 140
Length1 := 80
Length2 := 40",164,171,
019bdc2a,micro,8,,"dev_open_windows_for_measurement (WindowHandlePlot, WindowHandleMeasure, WindowHandleImage)",172,174,
019bdc2a,micro,9,,"TimeAll := []
PositionPixel := []",175,178,
019bdc2a,micro,10,,"NumIter := (HeightMeas - RowMeas) / MeasDist
for IndexMeas := 1 to NumIter by 1
count_seconds (T1)
gen_measure_rectangle2 (RowMeas, ColMeas, 0, Length1, Length2, WidthMeas, HeightMeas, 'nearest_neighbor', MeasureHandle)
measure_pos (ImageMeasure, MeasureHandle, 2, 20, 'all', 'all', RowEdge, ColEdge,...",179,209,"* --- Automatically Added Context ---
read_image (ImageMeasure, 'battery_electrode/battery_measure')
get_image_size (ImageMeasure, WidthMeas, HeightMeas)
MeasDist := 30
RowMeas := 80
ColMeas := 140
Le..."
019bdc2a,micro,11,,"dev_set_window (WindowHandleMeasure)
set_window_param (WindowHandleMeasure, 'flush', 'true')
set_display_font (WindowHandleMeasure, 16, 'mono', 'true', 'false')
TimeMean := mean(TimeAll) * 1000
dev_disp_text ('Average runtime of one measurement: ' + TimeMean$'.1f' + ' ms', 'window', 'top', 'left', '...",210,216,"* --- Automatically Added Context ---
dev_open_windows_for_measurement (WindowHandlePlot, WindowHandleMeasure, WindowHandleImage)
TimeAll := []
* --- End of Automatically Added Context ---"
019bdc2a,micro,12,,"dev_disp_text ('      End of program      ', 'window', 'bottom', 'right', 'black', [], [])
stop ()",217,220,
019bdc2a,micro,13,,"dev_close_windows_for_measurement (WindowHandlePlot, WindowHandleMeasure, WindowHandleImage)",221,235,"* --- Automatically Added Context ---
dev_open_windows_for_measurement (WindowHandlePlot, WindowHandleMeasure, WindowHandleImage)
* --- End of Automatically Added Context ---"
019bdc2a,micro,14,,"get_image_size (Image, ImgWidthOrig, ImgHeightOrig)
dev_open_window (0, 0, ImgWidthOrig / 4, ImgHeightOrig / 2, 'black', WindowHandleData)
set_display_font (WindowHandleData, 16, 'mono', 'true', 'false')",236,241,"* --- Automatically Added Context ---
read_image (Image, ImageFilesDefect[Index])
* --- End of Automatically Added Context ---"
019bdc2a,micro,15,,"scale_image_range (Image, ImageScaled, 20, 50)
concat_obj (Image, ImageScaled, ImagesConcat)
tile_images_offset (ImagesConcat, TiledImageData, [0,ImgHeightOrig], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], ImgWidthOrig, ImgHeightOrig * 2)",242,246,"* --- Automatically Added Context ---
read_image (Image, ImageFilesDefect[Index])
get_image_size (Image, ImgWidthOrig, ImgHeightOrig)
* --- End of Automatically Added Context ---"
019bdc2a,micro,16,,"dev_display (TiledImageData)
dev_disp_text ('The original image shows a part of an electrode sheet (aluminium cathode).', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Here the gray-values are scaled for a better visualization.', 'window', 145, 'left', 'black', [], [])
dev_disp_text ('Pr...",247,269,"* --- Automatically Added Context ---
tile_images_offset (ImagesConcat, TiledImageData, [0,ImgHeightOrig], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], ImgWidthOrig, ImgHeightOrig * 2)
* --- End of..."
019bdc2a,micro,17,,"ImgHeight := 636
ImgWidth := 1024
dev_open_window (0, 0, ImgWidth, ImgHeight, 'black', WindowHandleDefekt)
set_display_font (WindowHandleDefekt, 16, 'mono', 'true', 'false')
scale_image_range (Image, ImageScaled, 20, 50)",270,277,"* --- Automatically Added Context ---
get_image_size (ImageInit, ImgWidth, ImgHeight)
read_image (Image, ImageFilesDefect[Index])
scale_image_range (Image, ImageScaled, 20, 50)
* --- End of Automatica..."
019bdc2a,micro,18,,gen_empty_obj (CroppedImages),278,280,
019bdc2a,micro,19,,"crop_rectangle1 (ImageScaled, ImagePartCrack, 410, 2635, 536, 2761)
concat_obj (CroppedImages, ImagePartCrack, CroppedImages)",281,284,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,20,,"crop_rectangle1 (ImageScaled, ImagePartScratch, 41, 3685, 148, 3792)
concat_obj (CroppedImages, ImagePartScratch, CroppedImages)",285,288,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,21,,"crop_rectangle1 (ImageScaled, ImagePartContF, 4, 499, 76, 571)
concat_obj (CroppedImages, ImagePartContF, CroppedImages)",289,292,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,22,,"crop_rectangle1 (ImageScaled, ImagePartContB, 38, 2742, 102, 2806)
concat_obj (CroppedImages, ImagePartContB, CroppedImages)",293,296,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,23,,"scale_image_range (Image, ImageScaledBubble, 20, 90)
crop_rectangle1 (ImageScaledBubble, ImagePartBubble, 267, 2676, 328, 2737)
concat_obj (CroppedImages, ImagePartBubble, CroppedImages)",297,301,"* --- Automatically Added Context ---
read_image (Image, ImageFilesDefect[Index])
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,24,,"scale_image_range (Image, ImageScaledStripe, 25, 33)
crop_rectangle1 (ImageScaledStripe, ImagePartStripe, 92, 2100, 329, 2337)
concat_obj (CroppedImages, ImagePartStripe, CroppedImages)",302,306,"* --- Automatically Added Context ---
read_image (Image, ImageFilesDefect[Index])
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,25,,"crop_rectangle1 (ImageScaled, ImagePartElectrodeWidth, 283, 3854, 500, 4071)
concat_obj (CroppedImages, ImagePartElectrodeWidth, CroppedImages)",307,310,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,26,,"crop_rectangle1 (ImageScaled, ImagePartPinhole, 115, 3031, 170, 3086)
concat_obj (CroppedImages, ImagePartPinhole, CroppedImages)",311,314,"* --- Automatically Added Context ---
scale_image_range (Image, ImageScaled, 20, 50)
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,27,,"RowCoord := [82, 82, 82, 82, 338, 338, 338, 338]
ColCoord := [[0:256:1023],[0:256:1023]]
RowText := [100, 552]
ColText := [24:256:1023]
NoCrop := gen_tuple_const(8,-1)
zoom_image_size (CroppedImages, ImageZoomed, 256, 256, 'nearest_neighbor')",315,322,"* --- Automatically Added Context ---
gen_empty_obj (CroppedImages)
* --- End of Automatically Added Context ---"
019bdc2a,micro,28,,"tile_images_offset (ImageZoomed, TiledImageDefects, RowCoord, ColCoord, NoCrop, NoCrop, NoCrop, NoCrop, ImgWidth, ImgHeight)",323,325,"* --- Automatically Added Context ---
get_image_size (ImageInit, ImgWidth, ImgHeight)
RowCoord := [82, 82, 82, 82, 338, 338, 338, 338]
ColCoord := [[0:256:1023],[0:256:1023]]
NoCrop := gen_tuple_const..."
019bdc2a,micro,29,,"dev_display (TiledImageDefects)
Text := 'Part 1: '
Text[1] := 'This part of the example shows the inline defect detection on the electrode sheet.'
Text[2] := 'These are defect classes which will be detected and classified:'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
dev_disp_text...",326,359,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
RowText := [100, 552]
ColText := [24:256:1023]
tile_images_offset (Imag..."
019bdc2a,micro,30,,"dev_open_window (202, 0, 616, 495, 'black', WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')",360,364,
019bdc2a,micro,31,,"ColOffsetSecondColumn := 150
RowLegendOffset := 30
RowStart := 60
ColStart := 80
ColOffsetCircle := -20
RowOffsetCircle := 10",365,372,
019bdc2a,micro,32,,"gen_rectangle1 (Rectangle1, 8, 24, 185, 606)",373,375,
019bdc2a,micro,33,,"dev_set_color ('black')
CircleRadiusBlack := 12
gen_circle (CircleWhite, RowStart + RowOffsetCircle, ColStart + ColOffsetCircle, CircleRadiusBlack)
gen_circle (CircleYellow, RowStart + RowOffsetCircle + RowLegendOffset, ColStart + ColOffsetCircle, CircleRadiusBlack)
gen_circle (CircleOrange, RowStar...",376,395,"* --- Automatically Added Context ---
ColOffsetSecondColumn := 150
RowLegendOffset := 30
RowStart := 60
ColStart := 80
ColOffsetCircle := -20
RowOffsetCircle := 10
* --- End of Automatically Added Con..."
019bdc2a,micro,34,,"dev_set_color ('#616161')
dev_display (Rectangle1)
dev_set_color ('lime green')
dev_display (CircleWhite)
dev_set_color ('yellow')
dev_display (CircleYellow)
dev_set_color ('orange')
dev_display (CircleOrange)
dev_set_color ('spring green')
dev_display (CircleGreen)
dev_set_color ('cyan')
dev_displa...",396,425,"* --- Automatically Added Context ---
gen_rectangle1 (Rectangle1, 8, 24, 185, 606)
gen_circle (CircleWhite, RowStart + RowOffsetCircle, ColStart + ColOffsetCircle, CircleRadiusBlack)
gen_circle (Circl..."
019bdc2a,micro,35,,"dev_disp_text ('Legend of defect classes:', 'window', 20, 60, 'white', 'box', 'false')
dev_disp_text ('_________________________', 'window', 22, 60, 'white', 'box', 'false')
Text := 'Move the mouse over the image with defects.'
Text[1] := 'Details are shown in the zoom window on the right.'
dev_disp...",426,442,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Part 1: '
dev_disp_text ('Crack', 'window', RowText[0], ColTex..."
019bdc2a,micro,36,,"dump_window_image (ImageDump, WindowHandle)
dev_display (ImageDump)
return ()",443,474,"* --- Automatically Added Context ---
dev_open_window (202, 0, 616, 495, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
019bdc2a,micro,37,,"scale_image_range (Image, ImageScaled, 20, 50)
dev_display (ImageScaled)",477,480,"* --- Automatically Added Context ---
read_image (Image, ImageFilesDefect[Index])
scale_image_range (Image, ImageScaled, 20, 50)
* --- End of Automatically Added Context ---"
019bdc2a,micro,38,,"dev_set_draw ('margin')
dev_set_line_width (2)",481,484,
019bdc2a,micro,39,,"dev_set_color ('lime green')
dev_display (Stripes)
dev_set_color ('yellow')
union1 (Cracks, CracksUnionVis)
dilation_circle (CracksUnionVis, CracksVis, 10.5)
dev_display (CracksVis)
dev_set_color ('orange')
union1 (Scratches, ScratchesUnionVis)
dilation_circle (ScratchesUnionVis, ScratchesVis, 10.5)...",485,512,"* --- Automatically Added Context ---
intersection (ImageReduced, DilationRegionStripes, Stripes)
select_shape (ConnectedCrack, Cracks, ['area', 'ratio'], 'and', [140, 0], ['max', 0.8])
select_gray (S..."
019bdc2a,micro,40,,"dev_disp_text ('Image ' + (Index + 1) + '/5', 'window', 'top', 'left', 'black', [], [])
return ()
dev_open_window (0, 0, 1024, 200, 'black', WindowHandleData)
set_display_font (WindowHandleData, 16, 'mono', 'true', 'false')",513,539,"* --- Automatically Added Context ---
for Index := 0 to |ImageFilesDefect| - 1 by 1
read_image (Image, ImageFilesDefect[Index])
dev_open_window (0, 0, ImgWidthOrig / 4, ImgHeightOrig / 2, 'black', Win..."
019bdc2a,micro,41,,"Text := 'Part 2: '
Text[1] := ' '
Text[2] := 'The goal of this part is to find the exact position of the electrode sheet.'
Text[3] := 'In the following window, a cropped part of the left edge of the electrode can be seen.'
Text[4] := 'HALCON uses the measurement tools to detect the edge with subpixe...",540,570,"* --- Automatically Added Context ---
dev_disp_text ('The original image shows a part of an electrode sheet (aluminium cathode).', 'window', 'top', 'left', 'black', [], [])
Text := 'Part 1: '
dev_disp..."
019bdc2a,micro,42,,"gen_rectangle1 (Rectangle, RowMeas - Length2, ColMeas - Length1, RowMeas + Length2, ColMeas + Length1)",571,573,"* --- Automatically Added Context ---
RowMeas := 80
ColMeas := 140
Length1 := 80
Length2 := 40
* --- End of Automatically Added Context ---"
019bdc2a,micro,43,,"dev_set_window (WindowHandleImage)
dev_display (ImageMeasure)
dev_set_color ('cyan')
dev_display (Rectangle)
flush_buffer (WindowHandleImage)
return ()
dev_set_window (WindowHandleMeasure)
dev_clear_window ()",574,612,"* --- Automatically Added Context ---
read_image (ImageMeasure, 'battery_electrode/battery_measure')
dev_open_windows_for_measurement (WindowHandlePlot, WindowHandleMeasure, WindowHandleImage)
gen_rec..."
019bdc2a,micro,44,,"OffsetBorder := 20
crop_rectangle1 (ImageMeasure, ImageRectangle, RowMeas - Length2 - OffsetBorder, ColMeas - Length1 - OffsetBorder, RowMeas + Length2 + OffsetBorder, ColMeas + Length1 + OffsetBorder)",613,616,"* --- Automatically Added Context ---
read_image (ImageMeasure, 'battery_electrode/battery_measure')
RowMeas := 80
ColMeas := 140
Length1 := 80
Length2 := 40
* --- End of Automatically Added Context -..."
019bdc2a,micro,45,,"gen_rectangle1 (RectangleDetail, OffsetBorder, OffsetBorder, OffsetBorder + Length2 * 2, OffsetBorder + Length1 * 2)
dev_display (ImageRectangle)
dev_set_color ('cyan')
dev_display (RectangleDetail)
dev_set_color ('green')",617,623,"* --- Automatically Added Context ---
Length1 := 80
Length2 := 40
OffsetBorder := 20
crop_rectangle1 (ImageMeasure, ImageRectangle, RowMeas - Length2 - OffsetBorder, ColMeas - Length1 - OffsetBorder, ..."
019bdc2a,micro,46,,"disp_cross (WindowHandleMeasure, OffsetBorder + Length2, ColEdge - ColMeas + OffsetBorder + Length1, 20, rad(45))
flush_buffer (WindowHandleMeasure)
return ()
dev_set_window (WindowHandlePlot)
dev_clear_window ()
plot_tuple (WindowHandlePlot, [1:IndexMeas], PositionPixel, [], 'Position of column in ...",624,808,"* --- Automatically Added Context ---
collect_defect_images ('battery_electrode', ImageFilesDefect)
dev_open_windows_for_detection (WindowHandleLegend, ToolId, WindowHandleDefect)
ColMeas := 140
Lengt..."
1341e81e,full,0,"************************************************************ *
This example shows the detection of 3...","dev_update_off ()
DefectNumPointsMin := 150
SmoothingMaskSize := 50
MaxDistanceSmoothedToOriginal := 2.5e-05
MaxDistanceConnection := 2e-04
dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Ro...",16,93,
1341e81e,micro,1,"XYZ-mapping provided by the sensor. Then, 3D defects are
selected as connected parts of the surface ...",dev_update_off (),10,17,
1341e81e,micro,2,"Set parameters.
************************************************************ *
Define minimum defect...",DefectNumPointsMin := 150,18,23,
1341e81e,micro,3,,SmoothingMaskSize := 50,24,26,
1341e81e,micro,4,,MaxDistanceSmoothedToOriginal := 2.5e-05,27,29,
1341e81e,micro,5,,MaxDistanceConnection := 2e-04,30,32,
1341e81e,micro,6,"Initialize display.
************************************************************ *","dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
create_pose (0.0, 0.0, ...",33,43,
1341e81e,micro,7,"Loop through scenes, process them and visualize results.
*******************************************...","for Index := 0 to 3 by 1
read_object_model_3d ('battery_surface/battery_surface_' + Index$'02d', 'm', [], [], ObjectModel3D, Status)
Title[0] := 'Unrolled surface of cylindric battery ' + (Index + 1) + '/4.'
Title[1] := 'Points are colored according to their z-value.'
visualize_object_model_3d (Wind...",44,99,"* --- Automatically Added Context ---
DefectNumPointsMin := 150
SmoothingMaskSize := 50
MaxDistanceSmoothedToOriginal := 2.5e-05
MaxDistanceConnection := 2e-04
dev_open_window (0, 0, 1024, 768, 'black..."
b0cfe4c9,full,0,"************************************************************ *
This application example shows the in...","dev_update_off ()
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/side', '', 1, 2, AcqHandleCamSide)
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/top', '', 1, 2, AcqHandleCamTop)
create_data_code_2...",19,463,
b0cfe4c9,micro,1,"model and a data code reader.
Then, battery cells are inspected in two threads, one checks
the top v...",dev_update_off (),12,20,
b0cfe4c9,micro,2,"Initialize the used cameras or load images from file system.
***************************************...","open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/side', '', 1, 2, AcqHandleCamSide)
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/top', '', 1, 2, AcqHandleCamTop)",21,26,
b0cfe4c9,micro,3,"Initialize code reading.
************************************************************ *","create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'enhanced_recognition')
set_data_code_2d_param (DataCodeHandle, 'polarity', 'dark_on_light')",27,33,
b0cfe4c9,micro,4,"Initialize defect detection.
************************************************************ *","gen_circle_contour_xld (ContoursToSearch, 275, 0, 185, 0, 6.28318, 'positive', 1)",34,38,
b0cfe4c9,micro,5,,create_generic_shape_model (ModelID),39,41,
b0cfe4c9,micro,6,We set 'angle_start' and 'angle_end' to 0.0 to speed up detection.,"set_generic_shape_model_param (ModelID, 'angle_start', 0.0)
set_generic_shape_model_param (ModelID, 'angle_end', 0.0)",44,47,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,7,speed up detection.,"set_generic_shape_model_param (ModelID, 'min_score', 0.8)",48,50,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,8,,"set_generic_shape_model_param (ModelID, 'num_matches', 1)",51,52,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,9,pyramid level to increase robustness.,"set_generic_shape_model_param (ModelID, 'pyramid_level_lowest', 3)",53,55,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,10,alignment is needed.,"set_generic_shape_model_param (ModelID, 'subpixel', 'none')
train_generic_shape_model (ContoursToSearch, ModelID)",56,62,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContoursToSearch, 275, 0, 185, 0, 6.28318, 'positive', 1)
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context --..."
b0cfe4c9,micro,11,"Setup visualization windows.
************************************************************ *","grab_image_async (Image, AcqHandleCamSide, -1)
height_width_ratio (Image, Height, Width, Ratio)
WindowWidth := 500
WindowHeight := Ratio * WindowWidth",63,70,"* --- Automatically Added Context ---
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/side', '', 1, 2, AcqHandleCamSide)
* --- End of Automatically Ad..."
b0cfe4c9,micro,12,,"dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandleLeft)
set_display_font (WindowHandleLeft, 16, 'mono', 'true', 'false')",71,74,"* --- Automatically Added Context ---
WindowWidth := 500
WindowHeight := Ratio * WindowWidth
height_width_ratio (Image, Height, Width, Ratio)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,13,,"dev_open_window (0, WindowWidth + 8, WindowWidth, WindowHeight, 'black', WindowHandleRight)
set_display_font (WindowHandleRight, 16, 'mono', 'true', 'false')",75,78,"* --- Automatically Added Context ---
WindowWidth := 500
WindowHeight := Ratio * WindowWidth
height_width_ratio (Image, Height, Width, Ratio)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,14,"Loop through images, process them and visualize results.
*******************************************...","for I := 0 to 7 by 1
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, ErrorClassDict, DurationInspectionDefectDetection)
par_start&lt;ReadECCCode&gt; : read_data_matrix_code (Region, ImageSide, AcqHandleCamSide, DataCodeHandle, DecodedSt...",79,158,"* --- Automatically Added Context ---
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'false', 'battery_cell/side', '', 1, 2, AcqHandleCamSide)
open_framegrabber ('File', 1,..."
b0cfe4c9,micro,15,,"grab_image_async (Image, AcqHandle, 100)",159,161,"* --- Automatically Added Context ---
grab_image_async (Image, AcqHandleCamSide, -1)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,16,,"count_seconds (T0)
find_data_code_2d (Image, Region, DataCodeHandle, [], [], ResultHandles, DecodedString)
count_seconds (T1)
DurationCodeReading := T1 - T0
return ()",162,198,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
grab_image_async (Image, AcqHandleCamSide, -1)
par_start&lt;ReadECCCode&gt; : read_data_..."
b0cfe4c9,micro,17,,"grab_image_async (Image, AcqHandle, 100)
count_seconds (T0)",199,202,"* --- Automatically Added Context ---
grab_image_async (Image, AcqHandleCamSide, -1)
grab_image_async (Image, AcqHandle, 100)
count_seconds (T0)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,18,,"ErrorDict := dict{}
ErrorIndex := 0
gen_empty_region (ErrorRegion)
gen_empty_region (Alignment)
Result := true
DurationInspection := 0
threshold (Image, Region1, 60, 255)
reduce_domain (Image, Region1, ImageReduced)",203,212,"* --- Automatically Added Context ---
grab_image_async (Image, AcqHandleCamSide, -1)
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, Err..."
b0cfe4c9,micro,19,,"find_generic_shape_model (ImageReduced, ModelID, MatchResultID, NumMatchResult)",213,215,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
reduce_domain (Image, Region1, ImageReduced)
* --- End of Automatically Added Context ---"
b0cfe4c9,micro,20,,"get_generic_shape_model_result_object (Alignment, MatchResultID, 'all', 'contours')",216,218,"* --- Automatically Added Context ---
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, ErrorClassDict, DurationInspectionDefectDetection)..."
b0cfe4c9,micro,21,,"get_generic_shape_model_result (MatchResultID, 'best', 'row', Row)
get_generic_shape_model_result (MatchResultID, 'best', 'column', Column)
get_generic_shape_model_result (MatchResultID, 'best', 'angle', Angle)
if (NumMatchResult &gt; 0)
mean_image (Image, ImageMean, 3, 3)
inspect_outer_area (ImageM...",219,308,"* --- Automatically Added Context ---
grab_image_async (Image, AcqHandleCamSide, -1)
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, Err..."
b0cfe4c9,micro,22,,"ErrorDict := dict{}
ErrorIndex := 0
Result := true
gen_empty_region (ErrorRegion)
get_image_size (ImageMean, Width, Height)
RadiusOuterEllipse := 377.5
RadiusInnerEllipse := 325
if (Row == [])
Result := false
return ()
else
gen_circle (InnerEllipseIsoRing, Row, Column, RadiusInnerEllipse)
gen_circle...",309,387,"* --- Automatically Added Context ---
height_width_ratio (Image, Height, Width, Ratio)
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, E..."
b0cfe4c9,micro,23,,"ErrorDict := dict{}
ErrorIndex := 0
Result := true
gen_empty_region (ErrorRegion)
get_image_size (ImageMean, Width, Height)
if (Row == [])
Result := false
return ()
else
gen_circle (Circle, Row, Column, 180)
reduce_domain (ImageMean, Circle, ImageIA)
intensity (Circle, ImageIA, Mean, Deviation)
if (...",388,476,"* --- Automatically Added Context ---
height_width_ratio (Image, Height, Width, Ratio)
par_start&lt;DetectDefect&gt; : detect_defects (ImageTop, Regions, Alignment, AcqHandleCamTop, ModelID, Result, E..."
f7a5f5a5,full,0,"In this example five different color fuses are segmented with
a look-up table classifier (LUT) based...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
dev_set_draw ('margin')
ImageRootName := 'color/color_fuses_0'
FuseTypes := [5, 10, 15, 20, 30]
FuseColors := ['Orange', 'Red', 'Blue', 'Yellow', 'Green']
FuseHighlight := ['orange', 'red', 'blue', 'goldenr...",10,91,
f7a5f5a5,micro,1,"a look-up table classifier (LUT) based on a Gaussian Mixture
Model (GMM).","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
dev_set_draw ('margin')
ImageRootName := 'color/color_fuses_0'
FuseTypes := [5, 10, 15, 20, 30]
FuseColors := ['Orange', 'Red', 'Blue', 'Yellow', 'Green']
FuseHighlight := ['orange', 'red', 'blue', 'goldenr...",6,23,
f7a5f5a5,micro,2,,"set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_rectangle1 (FuseOrange, 195, 90, 230, 120)
dev_display (FuseOrange)
disp_message (WindowHandle, 'Orange Fuse', 'image', 160, 90 - 65, 'black', 'true')
gen_rectangle1 (FuseRed, 191, 280, 226, 310)
dev_display (FuseRed)
disp_message (Win...",24,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
f7a5f5a5,micro,3,,"create_class_gmm (3, 5, 1, 'full', 'none', 3, 42, GMMHandle)
add_samples_image_class_gmm (Image, Classes, GMMHandle, 0)
disp_message (WindowHandle, 'Training GMM classifier...', 'window', 48, 12, 'black', 'true')
train_class_gmm (GMMHandle, 100, 0.001, 'training', 0.001, Centers, Iter)",50,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
read_image (Image, ImageRootName + '0')
gen_empty_obj (Classes)
* --- End of Automatically Added Context -..."
f7a5f5a5,micro,4,,"disp_message (WindowHandle, 'Creating LUT classifier...', 'window', 84, 12, 'black', 'true')
create_class_lut_gmm (GMMHandle, ['bit_depth', 'rejection_threshold'], [6, 0.03], ClassLUTHandle)",56,59,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_class_gmm (3, 5, 1, 'full', 'none', 3, 42, GMMHandle)
* --- End of Automatically Added Context ---"
f7a5f5a5,micro,5,,"for Img := 0 to 3 by 1
read_image (Image, ImageRootName + Img)
count_seconds (T1)
classify_image_class_lut (Image, ClassRegions, ClassLUTHandle)
count_seconds (T2)
TimeToClassify := (T2 - T1) * 1000
dev_display (Image)
dev_set_line_width (3)
for Fuse := 1 to 5 by 1
copy_obj (ClassRegions, ObjectsSel...",60,97,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
ImageRootName := 'color/color_fuses_0'
FuseTypes := [5, 10, 15, 20, 30]
FuseColors := ['Orange', 'Red', 'B..."
8f4ab279,full,0,color_fuses_lut_trans.hdev: classify fuses by color,"dev_update_off ()
FuseColors := ['Orange', 'Red', 'Blue', 'Yellow', 'Green']
DisplayColors := ['coral', 'red', 'blue', 'goldenrod', 'forest green']
FuseTypes := [5, 10, 15, 20, 30]
HueRanges := [10, 30, 0, 10, 125, 162, 30, 64, 96, 128]
dev_close_window ()
read_image (Image, 'color/color_fuses_00')
...",7,57,
8f4ab279,micro,1,,dev_update_off (),6,7,
8f4ab279,micro,2,"step: set up fuse properties and hue ranges
****","FuseColors := ['Orange', 'Red', 'Blue', 'Yellow', 'Green']
DisplayColors := ['coral', 'red', 'blue', 'goldenrod', 'forest green']
FuseTypes := [5, 10, 15, 20, 30]",8,13,
8f4ab279,micro,3,,"HueRanges := [10, 30, 0, 10, 125, 162, 30, 64, 96, 128]
dev_close_window ()
read_image (Image, 'color/color_fuses_00')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",14,19,
8f4ab279,micro,4,"step: create look-up-table for color space transformation
****","create_color_trans_lut ('hsv', 'from_rgb', 8, ColorTransLUTHandle)
for Count := 0 to 4 by 1
read_image (Image, 'color/color_fuses_0' + Count)
dev_display (Image)
disp_message (WindowHandle, 'color/color_fuses0' + Count + '.png', 'window', 12, 512, 'black', 'true')
decompose3 (Image, Red, Green, Blue...",20,63,"* --- Automatically Added Context ---
FuseColors := ['Orange', 'Red', 'Blue', 'Yellow', 'Green']
DisplayColors := ['coral', 'red', 'blue', 'goldenrod', 'forest green']
FuseTypes := [5, 10, 15, 20, 30]..."
0557e14f,full,0,ball.hdev: Inspection of Ball Bonding,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowID)
read_image (Bond, 'die/die_03')
dev_display (Bond)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
stop ()
threshold (Bond, Bright, 100, 255)
s...",8,55,
0557e14f,micro,1,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowID)
read_image (Bond, 'die/die_03')
dev_display (Bond)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
stop ()
threshold (Bond, Bright, 100, 255)
s...",6,61,
28125d9e,full,0,board.hdev: Detection of missing solder,"get_system ('clip_region', Information)
set_system ('clip_region', 'true')
dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
read_image (Images, ['ic0', 'ic1', 'ic2', 'ic3'])
channels_to_image (Images, Ic)
select_obj (Images, Input1, 1)
dev_display (In...",8,84,
28125d9e,micro,1,,"get_system ('clip_region', Information)
set_system ('clip_region', 'true')
dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
read_image (Images, ['ic0', 'ic1', 'ic2', 'ic3'])
channels_to_image (Images, Ic)
select_obj (Images, Input1, 1)
dev_display (In...",6,90,
dd0fd654,full,0,"This example demonstrates an application from the pharmaceutical
industry. The task is to check the ...","dev_close_window ()
dev_update_off ()
read_image (ImageOrig, 'blister/blister_reference')
dev_open_window_fit_image (ImageOrig, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
access_channel (ImageOrig, Image1, 1...",14,127,
dd0fd654,micro,1,"industry. The task is to check the content of automatically filled
blisters. The first image (refere...","dev_close_window ()
dev_update_off ()
read_image (ImageOrig, 'blister/blister_reference')
dev_open_window_fit_image (ImageOrig, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",6,21,
dd0fd654,micro,2,subsequent blister images easily.,"access_channel (ImageOrig, Image1, 1)
threshold (Image1, Region, 90, 255)
shape_trans (Region, Blister, 'convex')
orientation_region (Blister, Phi)
area_center (Blister, Area1, Row, Column)
vector_angle_to_rigid (Row, Column, Phi, Row, Column, 0, HomMat2D)
affine_trans_image (ImageOrig, Image2, HomM...",22,47,"* --- Automatically Added Context ---
read_image (ImageOrig, 'blister/blister_reference')
* --- End of Automatically Added Context ---"
dd0fd654,micro,3,which is the chambers of the blister,"Count := 6
for Index := 1 to Count by 1
read_image (Image, 'blister/blister_' + Index$'02')
threshold (Image, Region, 90, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 9999999)
shape_trans (SelectedRegions, RegionTrans, 'convex')
ori...",48,133,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageOrig, 0, 0, -1, -1, WindowHandle)
threshold (Image1, Region, 90, 255)
orientation_region (Blister, Phi)
area_center (Blister, Area..."
9d53ca02,full,0,"This example demonstrates an application from the pharmaceutical
industry. The task is to check the ...","dev_close_window ()
read_image (Image, 'blister/blister_mixed_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_display (Image)
dev_set_draw ('margin')
disp_message (WindowHandle, 'Train gmm cl...",15,253,
9d53ca02,micro,1,"industry. The task is to check the content of manually filled
blisters. The first image (reference) ...","dev_close_window ()
read_image (Image, 'blister/blister_mixed_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_display (Image)
dev_set_draw ('margin')",6,22,
9d53ca02,micro,2,this information on to the gmm classifier,"disp_message (WindowHandle, 'Train gmm classifier on pill types', 'window', 12, 12, 'black', 'true')
extract_pill_types (Image, Chambers, ChambersUnion, Classes, PhiRef, RowRef, ColumnRef, PillTypeCount)
NumClasses := |PillTypeCount|
create_class_gmm (3, 3, [1, 5], 'spherical', 'normalization', 10, ...",23,32,"* --- Automatically Added Context ---
read_image (Image, 'blister/blister_mixed_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
9d53ca02,micro,3,,"Count := 12
for FileIndex := 1 to Count by 1
read_image (Image, 'blister/blister_mixed_' + FileIndex$'02')
threshold (Image, Region, 90, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 9999999)
shape_trans (SelectedRegions, RegionTrans...",33,153,"* --- Automatically Added Context ---
read_image (Image, 'blister/blister_mixed_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
extract_pill_types (Image, Chambers, ChambersU..."
9d53ca02,micro,4,,"select_shape (Chambers, PillType1, 'row', 'and', 1, 145)
union1 (PillType1, PillType1)
select_shape (Chambers, PillType2, 'row', 'and', 145, 270)
union1 (PillType2, PillType2)
select_shape (Chambers, PillType3, 'row', 'and', 270, 390)
union1 (PillType3, PillType3)",154,162,"* --- Automatically Added Context ---
extract_pill_types (Image, Chambers, ChambersUnion, Classes, PhiRef, RowRef, ColumnRef, PillTypeCount)
* --- End of Automatically Added Context ---"
9d53ca02,micro,5,,"reduce_domain (Image, PillType1, ImageReduced)
decompose3 (ImageReduced, ImageR, ImageG, ImageB)
threshold (ImageB, Region, 60, 95)",163,167,"* --- Automatically Added Context ---
read_image (Image, 'blister/blister_mixed_reference')
threshold (Image, Region, 90, 255)
reduce_domain (ImageAffineTrans, ChambersUnion, ImageReduced)
decompose3 ..."
9d53ca02,micro,6,,"reduce_domain (Image, PillType2, ImageReduced)
decompose3 (ImageReduced, ImageR, ImageG, ImageB)
invert_image (ImageB, ImageInvert)
hysteresis_threshold (ImageInvert, RegionHysteresis2, 190, 200, 5)",168,173,"* --- Automatically Added Context ---
read_image (Image, 'blister/blister_mixed_reference')
reduce_domain (ImageAffineTrans, ChambersUnion, ImageReduced)
decompose3 (ImageAffineTrans, ImageR, ImageG, ..."
9d53ca02,micro,7,,"reduce_domain (Image, PillType3, ImageReduced)
decompose3 (ImageReduced, ImageR, ImageG, ImageB)
invert_image (ImageB, ImageInvert)
hysteresis_threshold (ImageInvert, RegionHysteresis3, 180, 200, 10)
intersection (Region, PillType1, PillType1)
intersection (RegionHysteresis2, PillType2, PillType2)
P...",174,267,"* --- Automatically Added Context ---
read_image (Image, 'blister/blister_mixed_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
extract_pill_types (Image, Chambers, ChambersU..."
96aa8502,full,0,"This example counts bottles in bottle crates of returned empties.
With diffuse front light, correctl...","get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'false')
read_image (Image, 'bottles/bottle_crate_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off (...",15,68,
96aa8502,micro,1,,"get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'false')
read_image (Image, 'bottles/bottle_crate_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off (...",14,22,
96aa8502,micro,2,,"for Index := 1 to 24 by 1
read_image (Image, 'bottles/bottle_crate_' + Index$'.02')
threshold (Image, BackgroundRegion, 50, 130)
opening_circle (BackgroundRegion, BackgroundRegion, 3.5)
threshold (Image, Region, 85, 255)
difference (Region, BackgroundRegion, Region)
connection (Region, ConnectedRegi...",23,66,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_crate_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
96aa8502,micro,3,,"set_system ('store_empty_region', StoreEmptyRegion)",67,74,"* --- Automatically Added Context ---
get_system ('store_empty_region', StoreEmptyRegion)
* --- End of Automatically Added Context ---"
d0355e6f,full,0,"This example shows how the operator find_ncc_models can be used to
search multiple models in an imag...","dev_update_off ()
read_image (ImageClass1, 'label/cable_labels_01')
read_image (ImageClass2, 'label/cable_labels_02')
get_image_size (ImageClass1, Width, Height)
dev_close_window ()
dev_open_window_fit_image (ImageClass1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true'...",16,252,
d0355e6f,micro,1,"is determined using a style number printed on the cable.
If the style identifier is not present, an ...","dev_update_off ()
read_image (ImageClass1, 'label/cable_labels_01')
read_image (ImageClass2, 'label/cable_labels_02')
get_image_size (ImageClass1, Width, Height)",9,19,
d0355e6f,micro,2,,"dev_close_window ()
dev_open_window_fit_image (ImageClass1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)",20,25,"* --- Automatically Added Context ---
read_image (ImageClass1, 'label/cable_labels_01')
* --- End of Automatically Added Context ---"
d0355e6f,micro,3,,"ClassLabels := ['type 1', 'type 2', 'STYLE', '80°C', '30V', 'VW-1']
ClassColors := ['green', 'blue', 'cyan', 'magenta', 'yellow', 'coral']",26,28,
d0355e6f,micro,4,,"explain_task (ImageClass1, ImageClass2, ClassColors, WindowHandle)
stop ()",29,31,"* --- Automatically Added Context ---
read_image (ImageClass1, 'label/cable_labels_01')
read_image (ImageClass2, 'label/cable_labels_02')
dev_open_window_fit_image (ImageClass1, 0, 0, -1, -1, WindowHa..."
d0355e6f,micro,5,,"ClassIds := []
ModelIds := []
LabelIds := []
AngleStart := rad(-5)
AngleExtent := rad(10)",32,38,
d0355e6f,micro,6,,"dev_display (ImageClass1)
gen_rectangle1 (ROIClass1, 573.0, 417.6, 620.7, 543.9)
reduce_domain (ImageClass1, ROIClass1, ImageReduced)
create_ncc_model (ImageReduced, 'auto', AngleStart, AngleExtent, 'auto', 'use_polarity', ModelID)
ModelIds := [ModelIds,ModelID]
dev_set_color (ClassColors[1])
dev_di...",42,52,"* --- Automatically Added Context ---
read_image (ImageClass1, 'label/cable_labels_01')
ClassLabels := ['type 1', 'type 2', 'STYLE', '80°C', '30V', 'VW-1']
ClassColors := ['green', 'blue', 'cyan', 'ma..."
d0355e6f,micro,7,,"dev_display (ImageClass2)
gen_rectangle1 (ROIClass2, 498.7, 263.2, 544.8, 428.7)
reduce_domain (ImageClass2, ROIClass2, ImageReduced)
create_ncc_model (ImageReduced, 'auto', AngleStart, AngleExtent, 'auto', 'use_polarity', ModelID)
ModelIds := [ModelIds,ModelID]
dev_set_color (ClassColors[0])
dev_di...",53,63,"* --- Automatically Added Context ---
read_image (ImageClass2, 'label/cable_labels_02')
ClassLabels := ['type 1', 'type 2', 'STYLE', '80°C', '30V', 'VW-1']
ClassColors := ['green', 'blue', 'cyan', 'ma..."
d0355e6f,micro,8,,dev_display (ImageClass2),64,65,"* --- Automatically Added Context ---
read_image (ImageClass2, 'label/cable_labels_02')
* --- End of Automatically Added Context ---"
d0355e6f,micro,9,,"gen_rectangle1 (ROILabel1, 495.3, 49.8, 544.8, 215.4)
gen_rectangle1 (ROILabel2, 494.4, 489.3, 544.0, 615.6)
gen_rectangle1 (ROILabel3, 489.3, 680.5, 533.7, 777.7)
gen_rectangle1 (ROILabel4, 479.0, 842.6, 535.4, 999.6)
concat_obj (ROILabel1, ROILabel2, ROILabels)
concat_obj (ROILabels, ROILabel3, RO...",66,74,
d0355e6f,micro,10,,"for Index := 1 to NumberLabels by 1
select_obj (ROILabels, ObjectSelected, Index)
reduce_domain (ImageClass2, ObjectSelected, ImageReduced)
create_ncc_model (ImageReduced, 'auto', AngleStart, AngleExtent, 'auto', 'use_polarity', ModelID)
get_ncc_model_params (ModelID, NumLevels, AngleStart1, AngleEx...",75,88,"* --- Automatically Added Context ---
read_image (ImageClass2, 'label/cable_labels_02')
ClassColors := ['green', 'blue', 'cyan', 'magenta', 'yellow', 'coral']
ModelIds := []
AngleStart := rad(-5)
Angl..."
d0355e6f,micro,11,'VW-1' and '30 V' have to be present.,"CableTypeFound := false
tuple_gen_const (|ModelIds|, 1, NumMatches)
NumImages := 5
Loops := 20
T1 := 0
T2 := 0
for Index := 1 to NumImages by 1
read_image (Image2, 'label/cable_labels_' + Index$'02')
threshold (Image2, Region, 60, 150)
fill_up (Region, RegionFillUp)
reduce_domain (Image2, RegionFill...",89,141,"* --- Automatically Added Context ---
ClassLabels := ['type 1', 'type 2', 'STYLE', '80°C', '30V', 'VW-1']
ClassColors := ['green', 'blue', 'cyan', 'magenta', 'yellow', 'coral']
ModelIds := []
AngleSta..."
d0355e6f,micro,12,,"dump_window_image (Image, WindowHandle)
gauss_filter (Image, ImageGauss, 11)
dev_display (ImageGauss)
dev_disp_text (['Total time find_ncc_models:' + T2$'6.2f' + ' ms','Total time find_ncc_model:' + T1$'7.2f' + ' ms','Speedup: ' + ((T1 / T2 - 1) * 100)$'21.0f' + ' %'], 'window', 'center', 'center', ...",142,163,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageClass1, 0, 0, -1, -1, WindowHandle)
T1 := 0
T2 := 0
* --- End of Automatically Added Context ---"
d0355e6f,micro,13,and indicate the labels that will be searched using regions.,"get_image_size (ImageClass1, Width, Height)",164,166,"* --- Automatically Added Context ---
read_image (ImageClass1, 'label/cable_labels_01')
get_image_size (ImageClass1, Width, Height)
* --- End of Automatically Added Context ---"
d0355e6f,micro,14,,"crop_part (ImageClass1, ImagePart, Height / 4, 0, Width, Height / 2)
crop_part (ImageClass2, ImagePart2, Height / 4, 0, Width, Height / 2)
concat_obj (ImagePart, ImagePart2, ObjectsConcat)
tile_images_offset (ObjectsConcat, TiledImage, [0,Height / 2], [0, 0], [0, 0], [0, 0], [Height / 2,Height / 2],...",167,173,"* --- Automatically Added Context ---
read_image (ImageClass1, 'label/cable_labels_01')
read_image (ImageClass2, 'label/cable_labels_02')
get_image_size (ImageClass1, Width, Height)
* --- End of Autom..."
d0355e6f,micro,15,,"dev_set_color (ClassColors[0])
gen_rectangle1 (ROI_0, 314, 418, 370, 553)
dev_display (ROI_0)",174,177,"* --- Automatically Added Context ---
ClassColors := ['green', 'blue', 'cyan', 'magenta', 'yellow', 'coral']
* --- End of Automatically Added Context ---"
d0355e6f,micro,16,,"dev_set_color (ClassColors[1])
gen_rectangle1 (ROI_1, 757, 267, 805, 427)
dev_display (ROI_1)",178,181,"* --- Automatically Added Context ---
ClassColors := ['green', 'blue', 'cyan', 'magenta', 'yellow', 'coral']
* --- End of Automatically Added Context ---"
d0355e6f,micro,17,,"dev_set_color ('red')
gen_rectangle1 (ROI_2, 325, 187, 385, 364)
gen_rectangle1 (ROI_3, 308, 600, 368, 753)
gen_rectangle1 (ROI_4, 306, 810, 357, 946)
gen_rectangle1 (ROI_5, 299, 1003, 354, 1098)
dev_display (ROI_2)
dev_display (ROI_3)
dev_display (ROI_4)
dev_display (ROI_5)
Message := 'Using the op...",182,220,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
d0355e6f,micro,18,"1. Which cable type is present in the image?
2. Which labels are present?
A message is generated det...","CableTypeFound := false
for I := 0 to |ModelIds| - 1 by 1
if (I &lt; 2)
if (CableTypeFound)
continue
endif
if (find(Model,I) != -1)
Text := 'Cable is of ' + ClassLabels[I]
TextColors := 'black'
CableTypeFound := true
else
Text := 'Cable type is missing'
TextColors := 'red'
endif
else
if (find(Model,...",221,264,"* --- Automatically Added Context ---
ClassLabels := ['type 1', 'type 2', 'STYLE', '80°C', '30V', 'VW-1']
ModelIds := []
CableTypeFound := false
for I := 1 to Loops by 1
find_ncc_models (ImageReduced,..."
916dd960,full,0,"This example demonstrates a quality inspection on hazelnut wavers.
Using the morphology tools the wa...","read_image (Image, 'food/hazelnut_wafer_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_update_window ('off')
dev_set_line_width (3)
dev_set_draw ('margin')
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
for Index := 1 to 24 by 1
read_image (I...",11,39,
916dd960,micro,1,"Using the morphology tools the waver is extracted and examined
according to a few shape features lik...","read_image (Image, 'food/hazelnut_wafer_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_update_window ('off')
dev_set_line_width (3)
dev_set_draw ('margin')
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
for Index := 1 to 24 by 1
read_image (I...",6,45,
63ef0b2a,full,0,"The following example shows a production line, which carries
packages of soft cheese. The cheese pac...","dev_close_window ()
dev_update_off ()
read_image (Image, 'food/soft_cheese_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
rgb1_to_gray (Image, GrayImage)
gen_region_polygon_filled (Paprika, [77, 8...",18,205,
63ef0b2a,micro,1,"packages of soft cheese. The cheese packages consist of three
types of flavor: cream, ham and paprik...","dev_close_window ()
dev_update_off ()
read_image (Image, 'food/soft_cheese_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)",6,25,
63ef0b2a,micro,2,,"rgb1_to_gray (Image, GrayImage)
gen_region_polygon_filled (Paprika, [77, 84, 203], [306, 405, 347])
erosion_circle (Paprika, Paprika, 3.5)
PaprikaCount := 2
gen_region_polygon_filled (Cream, [94, 171, 210], [424, 488, 363])
erosion_circle (Cream, Cream, 3.5)
CreamCount := 4
gen_region_polygon_filled...",26,45,"* --- Automatically Added Context ---
read_image (Image, 'food/soft_cheese_01')
* --- End of Automatically Added Context ---"
63ef0b2a,micro,3,,"ModelIDs := [ModelID1,ModelID2,ModelID3]
ColorIndex := ['red', 'magenta', 'yellow']
TypesIndex := ['P', 'C', 'H']
NumImages := 18
for Index := 1 to NumImages by 1
AnglesTypes := []
Types := []
read_image (Image, 'food/soft_cheese_' + Index$'02')
rgb1_to_gray (Image, GrayImage)
threshold (GrayImage, ...",46,220,"* --- Automatically Added Context ---
read_image (Image, 'food/soft_cheese_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
rgb1_to_gray (Image, GrayImage)
PaprikaCount := 2
CreamCou..."
a451d292,full,0,"This example demonstrates the color space transformation.
The salami pieces on the pizza are segment...","dev_update_off ()
dev_close_window ()
read_image (Image, 'color/pizza_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_part (0, 0, Height - 1, Width - 1)
for I := 1 to ...",11,47,
a451d292,micro,1,"The salami pieces on the pizza are segmented by transforming
the RGB image into the CIELab color spa...","dev_update_off ()
dev_close_window ()
read_image (Image, 'color/pizza_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_part (0, 0, Height - 1, Width - 1)
for I := 1 to ...",6,53,
210cc17b,full,0,"This program performs a completeness check by counting the
fish sticks contained in each package.
He...","dev_update_off ()
dev_close_window ()
read_image (Image, 'food/fish_stick_package_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * .9, Height * .9, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_open_window (0,...",11,112,
210cc17b,micro,1,"fish sticks contained in each package.
Here, one-dimensional measuring tools are used to determine
t...","dev_update_off ()
dev_close_window ()
read_image (Image, 'food/fish_stick_package_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * .9, Height * .9, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_open_window (0,...",6,21,
210cc17b,micro,2,,"NumImages := 6
for Index := 1 to NumImages by 1
read_image (Image, 'food/fish_stick_package_' + Index$'02')
threshold (Image, Region, 100, 255)
closing_circle (Region, RegionClosing, 5)
fill_up (RegionClosing, RegionFillUp)
difference (RegionFillUp, RegionClosing, RegionDifference)
fill_up (RegionDi...",22,118,"* --- Automatically Added Context ---
read_image (Image, 'food/fish_stick_package_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * .9, Height * .9, 'black', WindowHandle)
dev_..."
6623dba3,full,0,,"dev_close_window ()
read_image (Image, 'ic')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_draw ('fill')
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (Image)
dev_set_colored (12)
decompose3 (Image, Red, Green, Blue)
trans_from_rgb (R...",6,52,
33c0f0f1,full,0,"This example checks bottle necks for defects.
First, the bottle is detected with basic morphology,
e...","SmoothX := 501
ThresholdOffset := 25
MinDefectSize := 50
PolarResolution := 640
RingSize := 70
get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'false')
read_image (Image, 'bottles/bottle_mouth_01')
dev_update_off ()
dev_close_window ()
dev_close_window ()
dev_op...",15,113,
33c0f0f1,micro,1,,"SmoothX := 501
ThresholdOffset := 25
MinDefectSize := 50",14,18,
33c0f0f1,micro,2,,"PolarResolution := 640
RingSize := 70
get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'false')
read_image (Image, 'bottles/bottle_mouth_01')
dev_update_off ()
dev_close_window ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle1...",19,37,
33c0f0f1,micro,3,,"for Index := 1 to 16 by 1
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
auto_threshold (Image, Regions, 2)
select_obj (Regions, DarkRegion, 1)
opening_circle (DarkRegion, RegionOpening, 3.5)
closing_circle (RegionOpening, RegionClosing, 25.5)
fill_up (RegionClosing, RegionFillUp)
boundar...",40,111,"* --- Automatically Added Context ---
SmoothX := 501
PolarResolution := 640
RingSize := 70
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle1..."
33c0f0f1,micro,4,,"set_system ('store_empty_region', StoreEmptyRegion)",112,119,"* --- Automatically Added Context ---
get_system ('store_empty_region', StoreEmptyRegion)
* --- End of Automatically Added Context ---"
d1649c30,full,0,"For the solar industry, a common problem is the damage of
fingers of solar cells. This example shows...","dev_update_off ()
dev_close_window ()
ImageName := 'solar_cell/solar_cell_'
read_image (Image, ImageName + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')
dev_set_draw ('margin')
dev_set_line_width...",10,75,
d1649c30,micro,1,"fingers of solar cells. This example shows how to
extract the broken fingers using morphology.","dev_update_off ()
dev_close_window ()
ImageName := 'solar_cell/solar_cell_'
read_image (Image, ImageName + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')
dev_set_draw ('margin')
dev_set_line_width...",6,20,
d1649c30,micro,2,,"NumImages := 6
for Index := 1 to NumImages by 1
read_image (Image, ImageName + Index$'02')
decompose3 (Image, ImageR, ImageG, ImageB)
threshold (ImageR, Region, 0, 159)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, GoodSmallParts, ['area', 'width'], 'and', [3500, 130], [5000,...",21,81,"* --- Automatically Added Context ---
ImageName := 'solar_cell/solar_cell_'
read_image (Image, ImageName + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automaticall..."
d65a266c,full,0,"This example segments plants in images taken under uncontrolled
conditions with varying background.","dev_update_off ()
dev_close_window ()
read_image (Image, 'plants/plants_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
NumImages := 6
for I := 1 to ...",9,48,
d65a266c,micro,1,conditions with varying background.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'plants/plants_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')",6,17,
d65a266c,micro,2,,"NumImages := 6
for I := 1 to NumImages by 1
read_image (Image, 'plants/plants_' + I$'02')
decompose3 (Image, Red, Green, Blue)
trans_from_rgb (Red, Green, Blue, L, A, B, 'cielab')
segment_image_mser (A, MSERDark, MSERLight, 'dark', 60, 600000, 1, 'may_touch_border', 1)
threshold (A, TmpRegion1, 20, ...",18,54,"* --- Automatically Added Context ---
read_image (Image, 'plants/plants_01')
* --- End of Automatically Added Context ---"
5c875e92,full,0,"*****************************************************************
This example program demonstrates ...","dev_update_off ()
dev_close_window ()
list_image_files ('datacode/aztec', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'(smartphone)|(ticket)|(ticket_machine)')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (Wind...",32,178,
5c875e92,micro,1,,"dev_update_off ()
dev_close_window ()
list_image_files ('datacode/aztec', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'(smartphone)|(ticket)|(ticket_machine)')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (Wind...",31,41,
5c875e92,micro,2,,"Message := 'This program demonstrates how to read Aztec data codes'
Message[1] := 'with manually adapted parameter settings.'
Message[2] := ' '
Message[3] := 'The following parameters are adapted to optimize the'
Message[4] := 'recognition and runtime:'
Message[5] := ' '
Message[6] := '  - \'module_...",42,62,
5c875e92,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Aztec Code', [], [], DataCodeHandle)",63,70,
5c875e92,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, ['module_size_min', 'module_size_max'], [3, 11])
set_data_code_2d_param (DataCodeHandle, 'module_gap', 'no')
set_data_code_2d_param (DataCodeHandle, 'polarity', 'any')
set_data_code_2d_param (DataCodeHandle, 'mirrored', 'no')
set_data_code_2d_param (DataCodeHa...",71,84,"* --- Automatically Added Context ---
create_data_code_2d_model ('Aztec Code', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
5c875e92,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + (Index + 1) + '...",85,129,"* --- Automatically Added Context ---
list_image_files ('datacode/aztec', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev..."
5c875e92,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",141,174,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
5c875e92,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",175,192,"* --- Automatically Added Context ---
list_image_files ('datacode/aztec', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
TitleMessage := 'Image ' + (Index + 1) + ' of ' + |ImageFiles|
Re..."
b1271188,full,0,"*************************************************************
This example program demonstrates how ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/aztec/aztec_ticket_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gre...",23,80,
b1271188,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/aztec/aztec_ticket_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gre...",22,32,
b1271188,micro,2,,"Message := 'This simple program demonstrates how to read'
Message[1] := 'Aztec data codes in a sequence of images'
Message[2] := 'with the standard default parameter setting.'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', ...",33,40,
b1271188,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Aztec Code', [], [], DataCodeHandle)",41,48,"* --- Automatically Added Context ---
Message[1] := 'Aztec data codes in a sequence of images'
* --- End of Automatically Added Context ---"
b1271188,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_image_size (Image, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings + ' ', Ascent, Descent, MessageWidt...",49,86,"* --- Automatically Added Context ---
ImageFiles := 'datacode/aztec/aztec_ticket_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev..."
000b4df4,full,0,"*****************************************************************
This example program demonstrates ...","dev_update_off ()
dev_close_window ()
list_image_files ('datacode/dotcode/', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'packages')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true...",25,170,
000b4df4,micro,1,,"dev_update_off ()
dev_close_window ()
list_image_files ('datacode/dotcode/', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'packages')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true...",24,34,
000b4df4,micro,2,,"Message := 'This program demonstrates how to read DotCode data codes'
Message[1] := 'with manually adapted parameter settings.'
Message[2] := ' '
Message[3] := 'The following parameters are adapted to optimize the'
Message[4] := 'recognition and runtime:'
Message[5] := ' '
Message[6] := '  - \'modul...",35,57,
000b4df4,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('DotCode', [], [], DataCodeHandle)",58,65,
000b4df4,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, ['module_size_min', 'module_size_max'], [2, 6])
set_data_code_2d_param (DataCodeHandle, ['symbol_rows_min', 'symbol_rows_max'], [14, 84])
set_data_code_2d_param (DataCodeHandle, ['symbol_cols_min', 'symbol_cols_max'], [17, 83])
set_data_code_2d_param (DataCode...",66,76,"* --- Automatically Added Context ---
create_data_code_2d_model ('DotCode', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
000b4df4,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'stop_after_result_num', 2, ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image...",77,121,"* --- Automatically Added Context ---
list_image_files ('datacode/dotcode/', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
..."
000b4df4,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",133,166,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'stop_after_result_num', 2, ResultHandles, Dec..."
000b4df4,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",167,184,"* --- Automatically Added Context ---
list_image_files ('datacode/dotcode/', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
TitleMessage := 'Image ' + (Index + 1) + ' of ' + |ImageFiles|..."
c5d24ded,full,0,"*************************************************************
This example program demonstrates how ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/dotcode/dotcode_mvtec_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('...",20,77,
c5d24ded,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/dotcode/dotcode_mvtec_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('...",19,29,
c5d24ded,micro,2,,"Message := 'This simple program demonstrates how to read'
Message[1] := 'DotCode data codes in a sequence of images'
Message[2] := 'with the standard default parameter setting.'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom'...",30,37,
c5d24ded,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('DotCode', [], [], DataCodeHandle)",38,45,"* --- Automatically Added Context ---
Message[1] := 'DotCode data codes in a sequence of images'
* --- End of Automatically Added Context ---"
c5d24ded,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_image_size (Image, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings + ' ', Ascent, Descent, MessageWidt...",46,83,"* --- Automatically Added Context ---
ImageFiles := 'datacode/dotcode/dotcode_mvtec_'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
..."
2624366a,full,0,"*****************************************************************
This example program demonstrates ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",27,173,
2624366a,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",26,36,
2624366a,micro,2,,"Message := 'This program demonstrates how to read ECC200'
Message[1] := 'data codes with manually adapted parameter settings.'
Message[2] := ' '
Message[3] := 'The following parameters are adapted to optimize the'
Message[4] := 'recognition and runtime:'
Message[5] := ' '
Message[6] := '  - \'module...",37,56,
2624366a,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",57,64,
2624366a,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, 'symbol_size', 18)
set_data_code_2d_param (DataCodeHandle, ['module_size_min', 'module_size_max'], [4, 7])
set_data_code_2d_param (DataCodeHandle, 'module_gap', 'no')
set_data_code_2d_param (DataCodeHandle, 'polarity', 'light_on_dark')
set_data_code_2d_param (...",65,77,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
2624366a,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 7 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + (Index - 6) + ' ...",78,122,"* --- Automatically Added Context ---
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
de..."
2624366a,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",134,169,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
2624366a,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",170,187,"* --- Automatically Added Context ---
ImageNum := 16
read_image (Image, ImageFiles + '07')
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
TitleMessage := 'Image ' + (Index -..."
141657c0,full,0,"*************************************************************
This example program demonstrates how ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gre...",23,73,
141657c0,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gre...",22,32,
141657c0,micro,2,,"Message := 'This simple program demonstrates how to read'
Message[1] := 'ECC 200 data codes in a sequence of images'
Message[2] := 'with the standard default parameter setting.'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom'...",33,40,
141657c0,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",41,48,"* --- Automatically Added Context ---
Message[1] := 'ECC 200 data codes in a sequence of images'
* --- End of Automatically Added Context ---"
141657c0,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
dev_disp_text ('Image ' + Index + ' of ' + ImageNum, 'window', 12, 12, 'black', [...",49,79,"* --- Automatically Added Context ---
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 5
read_image (Image, ImageFiles + '01')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', ..."
4b61e661,full,0,"*****************************************************************
This example program demonstrates ...","dev_update_off ()
dev_close_window ()
list_image_files ('datacode/micro_qr', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'(cell_phone)|(board)')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, '...",27,168,
4b61e661,micro,1,,"dev_update_off ()
dev_close_window ()
list_image_files ('datacode/micro_qr', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'(cell_phone)|(board)')
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, '...",26,36,
4b61e661,micro,2,,"Message := 'This program demonstrates how to read'
Message[1] := 'Micro QR data codes with manually adapted'
Message[2] := 'parameter settings.'
Message[3] := ' '
Message[4] := 'The following parameters are adapted to'
Message[5] := 'optimize the recognition and runtime:'
Message[6] := ' '
Message[7...",37,54,
4b61e661,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Micro QR Code', [], [], DataCodeHandle)",55,62,"* --- Automatically Added Context ---
Message[1] := 'Micro QR data codes with manually adapted'
* --- End of Automatically Added Context ---"
4b61e661,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, ['module_size_min', 'module_size_max'], [3, 8])
set_data_code_2d_param (DataCodeHandle, 'polarity', 'any')
set_data_code_2d_param (DataCodeHandle, 'mirrored', 'no')
set_data_code_2d_param (DataCodeHandle, 'symbol_size_min', 13)
set_data_code_2d_param (DataCode...",63,72,"* --- Automatically Added Context ---
create_data_code_2d_model ('Micro QR Code', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
4b61e661,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + (Index + 1) + '...",73,117,"* --- Automatically Added Context ---
list_image_files ('datacode/micro_qr', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
..."
4b61e661,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",129,164,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
4b61e661,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",165,182,"* --- Automatically Added Context ---
list_image_files ('datacode/micro_qr', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
TitleMessage := 'Image ' + (Index + 1) + ' of ' + |ImageFiles|..."
ef229d31,full,0,"*************************************************************
This example program demonstrates how ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/micro_qr/micro_qr_board_'
ImageNum := 6
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ...",23,74,
ef229d31,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/micro_qr/micro_qr_board_'
ImageNum := 6
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ...",22,32,
ef229d31,micro,2,,"Message := 'This simple program demonstrates how to'
Message[1] := 'read Micro QR data codes in a sequence'
Message[2] := 'of images with the standard default'
Message[3] := 'parameter setting.'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', '...",33,41,
ef229d31,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Micro QR Code', [], [], DataCodeHandle)",42,49,"* --- Automatically Added Context ---
Message[1] := 'read Micro QR data codes in a sequence'
* --- End of Automatically Added Context ---"
ef229d31,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
dev_disp_text ('Image ' + Index + ' of ' + ImageNum, 'window', 12, 12, 'black', [...",50,80,"* --- Automatically Added Context ---
ImageFiles := 'datacode/micro_qr/micro_qr_board_'
ImageNum := 6
read_image (Image, ImageFiles + '01')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bott..."
2866262d,full,0,This programs shows how to read 2d data codes of type PDF 417.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/pdf417/pdf417_bottle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
gen_rectangle1 (Rectangle, 250, 0, 600, 610)
dev_set_color ('...",8,45,
2866262d,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/pdf417/pdf417_bottle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
gen_rectangle1 (Rectangle, 250, 0, 600, 610)
dev_set_color ('...",6,16,
2866262d,micro,2,,"create_data_code_2d_model ('PDF417', [], [], DataCodeHandle)
set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'maximum_recognition')
NumImages := 6
for Index := 1 to NumImages by 1
read_image (Image, 'datacode/pdf417/pdf417_bottle_' + Index$'02')
reduce_domain (Image, Rectangle, ImageRe...",17,51,"* --- Automatically Added Context ---
read_image (Image, 'datacode/pdf417/pdf417_bottle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_rectangle1 (Rectangle, 250, 0, 600, 610)
..."
56274df6,full,0,"***************************************************************
This example program demonstrates ho...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",27,167,
56274df6,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",26,36,
56274df6,micro,2,,"Message := 'This program demonstrates how to read PDF417'
Message[1] := 'data codes with manually adapted parameter settings.'
Message[2] := ' '
Message[3] := 'The following parameters are adapted to optimize'
Message[4] := 'the recognition and runtime:'
Message[5] := ' '
Message[6] := '  - \'module...",37,55,
56274df6,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('PDF417', [], [], DataCodeHandle)",56,63,
56274df6,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, ['symbol_rows_min', 'symbol_rows_max'], [6, 16])
set_data_code_2d_param (DataCodeHandle, ['symbol_cols_min', 'symbol_cols_max'], [5, 9])
set_data_code_2d_param (DataCodeHandle, ['module_width_min', 'module_width_max'], [1.5, 4.0])
set_data_code_2d_param (DataC...",64,73,"* --- Automatically Added Context ---
create_data_code_2d_model ('PDF417', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
56274df6,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to 10 by 1
read_image (Image, ImageFiles + Index$'02')
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + Index + ' of ' + ImageN...",74,118,"* --- Automatically Added Context ---
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
de..."
56274df6,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",130,163,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
56274df6,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",164,181,"* --- Automatically Added Context ---
ImageNum := 10
read_image (Image, ImageFiles + '01')
TitleMessage := 'Image ' + Index + ' of ' + ImageNum
ResultMessage := 'Data code found in ' + Time$'.1f' + ' ..."
cf866628,full,0,"***********************************************************
This example program demonstrates how to...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",23,95,
cf866628,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",22,32,
cf866628,micro,2,,"Message := 'This simple program demonstrates how to read'
Message[1] := 'PDF417 data codes in a sequence of images'
Message[2] := 'with the standard default parameter setting.'
Message[3] := ' '
Message[4] := 'Note that there are symbols that cannot be found'
Message[5] := 'with the standard default...",33,51,
cf866628,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('PDF417', [], [], DataCodeHandle)",52,59,"* --- Automatically Added Context ---
Message[1] := 'PDF417 data codes in a sequence of images'
* --- End of Automatically Added Context ---"
cf866628,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_image_size (Image, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings + ' ', Ascent, Descent, MessageWidt...",60,101,"* --- Automatically Added Context ---
ImageFiles := 'datacode/pdf417/pdf417_misc_'
ImageNum := 10
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Me..."
a37c0d0c,full,0,"***********************************************************
This example program demonstrates how to...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",21,159,
a37c0d0c,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",20,30,
a37c0d0c,micro,2,,"Message := 'This program demonstrates how to read QR data codes'
Message[1] := 'with manually adapted parameter settings.'
Message[2] := ' '
Message[3] := 'The following parameters are adapted to optimize the'
Message[4] := 'recognition and runtime:'
Message[5] := ' '
Message[6] := '  - \'version\''...",31,46,
a37c0d0c,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('QR Code', [], [], DataCodeHandle)",47,54,
a37c0d0c,micro,4,"----------------------------------------------------
Set some selected parameters of the 2d data cod...","set_data_code_2d_param (DataCodeHandle, 'version', 1)
set_data_code_2d_param (DataCodeHandle, 'model_type', 2)
set_data_code_2d_param (DataCodeHandle, ['module_size_min', 'module_size_max'], [5, 6])
set_data_code_2d_param (DataCodeHandle, 'mirrored', 'no')",55,63,"* --- Automatically Added Context ---
create_data_code_2d_model ('QR Code', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
a37c0d0c,micro,5,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + Index + ' of ' +...",64,108,"* --- Automatically Added Context ---
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '07')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
de..."
a37c0d0c,micro,6,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",120,155,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
a37c0d0c,micro,7,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",156,173,"* --- Automatically Added Context ---
ImageNum := 9
read_image (Image, ImageFiles + '07')
TitleMessage := 'Image ' + Index + ' of ' + ImageNum
ResultMessage := 'Data code found in ' + Time$'.1f' + ' m..."
2dcee219,full,0,"*************************************************************
This example program demonstrates how ...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",23,88,
2dcee219,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('gr...",22,32,
2dcee219,micro,2,,"Message := 'This simple program demonstrates how to read'
Message[1] := 'QR data codes in a sequence of images'
Message[2] := 'with the standard default parameter setting.'
Message[3] := ' '
Message[4] := 'Note that there may be symbols that cannot be found'
Message[5] := 'with the standard default ...",33,51,
2dcee219,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('QR Code', [], [], DataCodeHandle)",52,59,"* --- Automatically Added Context ---
Message[1] := 'QR data codes in a sequence of images'
* --- End of Automatically Added Context ---"
2dcee219,micro,4,"----------------------------------------------------
Search and read the data codes in each image an...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
dev_disp_text ('Image ' + Index + ' of ' + ImageNum, 'window', 12, 12, 'black', [...",60,94,"* --- Automatically Added Context ---
ImageFiles := 'datacode/qrcode/qr_workpiece_'
ImageNum := 9
read_image (Image, ImageFiles + '01')
Message := 'This simple program demonstrates how to read'
Messag..."
db72ce89,full,0,"This example shows how to perform a vignetting correction.
By taking a reference image of a homogene...","read_image (ReferenceImage, 'vignetting/vignetted_image_reference.png')
dev_update_off ()
initialize_visualization (ReferenceImage, WindowHandleBackground, WindowHandleVignetting, WindowHandleCorrected, WindowHandleDescription)
min_max_gray (ReferenceImage, ReferenceImage, 1, Min, Max, Range)
NumSam...",12,125,
db72ce89,micro,1,,"read_image (ReferenceImage, 'vignetting/vignetted_image_reference.png')
dev_update_off ()",11,14,
db72ce89,micro,2,,"initialize_visualization (ReferenceImage, WindowHandleBackground, WindowHandleVignetting, WindowHandleCorrected, WindowHandleDescription)",15,17,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'vignetting/vignetted_image_reference.png')
* --- End of Automatically Added Context ---"
db72ce89,micro,3,by considering only 1% below the maximum.,"min_max_gray (ReferenceImage, ReferenceImage, 1, Min, Max, Range)
NumSamples := 3",18,22,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'vignetting/vignetted_image_reference.png')
* --- End of Automatically Added Context ---"
db72ce89,micro,4,,"for Index := 1 to NumSamples by 1
read_image (ImageWithVignetting, 'vignetting/vignetted_image_' + Index$'02d')
div_image (ImageWithVignetting, ReferenceImage, CorrectedImage, Max, 0)
visualization (ReferenceImage, ImageWithVignetting, CorrectedImage, WindowHandleBackground, WindowHandleDescription,...",23,140,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'vignetting/vignetted_image_reference.png')
initialize_visualization (ReferenceImage, WindowHandleBackground, WindowHandleVignetting, ..."
4701376a,full,0,"This example shows how high dynamic range images
can be created from multiple input images (acquired...","dev_update_off ()
ImageNames := 'hdr/' + ['bore_hole', 'halogen', 'engraved_surface', 'namibia']
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for Index := 0 to |ImageNames| - 1 by 1
read_image (ImageDark, Ima...",11,133,
4701376a,micro,1,"can be created from multiple input images (acquired
with different exposure times) by manipulating t...","dev_update_off ()
ImageNames := 'hdr/' + ['bore_hole', 'halogen', 'engraved_surface', 'namibia']
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for Index := 0 to |ImageNames| - 1 by 1
read_image (ImageDark, Ima...",6,68,
4701376a,micro,2,,"derivate_image (Image1, X1, Y1)
derivate_image (Image2, X2, Y2)",69,71,
4701376a,micro,3,,"max_abs_image (X1, X2, MaxX)
max_abs_image (Y1, Y2, MaxY)",72,74,"* --- Automatically Added Context ---
derivate_image (Image1, X1, Y1)
derivate_image (Image2, X2, Y2)
* --- End of Automatically Added Context ---"
4701376a,micro,4,,"real_to_vector_field (MaxY, MaxX, VectorField, 'vector_field_relative')
reconstruct_height_field_from_gradient (VectorField, HDR, 'poisson', [], [])
return ()",75,98,"* --- Automatically Added Context ---
disp_message (WindowHandle, 'HDR image', 'window', 12, 12, 'black', 'true')
max_abs_image (X1, X2, MaxX)
max_abs_image (Y1, Y2, MaxY)
* --- End of Automatically A..."
4701376a,micro,5,,"convert_image_type (Image, ImageConverted, 'real')
convol_image (ImageConverted, DerivativeY, [3, 1, 1, -1, 0, 1], 'mirrored')
convol_image (ImageConverted, DerivativeX, [1, 3, 1, -1, 0, 1], 'mirrored')
return ()",99,123,"* --- Automatically Added Context ---
convert_image_type (ImageScaled, ImageConverted, 'uint2')
* --- End of Automatically Added Context ---"
4701376a,micro,6,"maximum absolute gray value of each pixel
for the output image.","abs_image (Image1, ImageAbs1)
abs_image (Image2, ImageAbs2)
dyn_threshold (ImageAbs1, ImageAbs2, Region1Greater, 0, 'light')
reduce_domain (Image1, Region1Greater, Image1Reduced)
paint_gray (Image1Reduced, Image2, MaxImage)
return ()",124,143,"* --- Automatically Added Context ---
derivate_image (Image1, X1, Y1)
derivate_image (Image2, X2, Y2)
* --- End of Automatically Added Context ---"
8afa8a11,full,0,"This example shows how to measure the sharpness of an image using
four characteristic quantities. Th...","dev_update_off ()
dev_close_window ()
read_image (Image, 'pcb_focus/pcb_focus_telecentric_001')
get_image_size (Image, Width, Height)
dev_close_window ()
OWFMaxExtent := 600
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, '...",15,185,
8afa8a11,micro,1,"four characteristic quantities. These are the Blurriness (Auto-Correlation),
the  Image Difference o...","dev_update_off ()
dev_close_window ()
read_image (Image, 'pcb_focus/pcb_focus_telecentric_001')
get_image_size (Image, Width, Height)
dev_close_window ()
OWFMaxExtent := 600
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, '...",6,24,
8afa8a11,micro,2,,"Subsampling := 3
LowerBandPass := 0.1
UpperBandPass := 0.4
OffsetRow := 2
OffsetCol := 2",25,31,
8afa8a11,micro,3,,"FocusAutoCorrelationTuple := []
FocusBandpassTuple := []
FocusGradientTuple := []
FocusDifferenceTuple := []
NumImages := 121
for I := 1 to NumImages by 1
read_image (Image, 'pcb_focus/pcb_focus_telecentric_' + I$'.3d')
set_system ('flush_graphic', 'false')
dev_display (Image)
disp_message (WindowHa...",32,54,"* --- Automatically Added Context ---
read_image (Image, 'pcb_focus/pcb_focus_telecentric_001')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMa..."
8afa8a11,micro,4,,"dev_display (Image)
dev_set_line_width (2)
disp_message (WindowHandle, 'Sharpness functions of an image sequence' + '\ntaken with varying focus adjustment', 'window', 12, 72, 'white', 'false')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Colors := ['blue', 'cyan', 'green', 'red']
dis...",55,198,"* --- Automatically Added Context ---
read_image (Image, 'pcb_focus/pcb_focus_telecentric_001')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMa..."
0c7b33a0,full,0,"With this HDevelop program, you can play the Paddle Game
with either one or two players.
A paddle is...","BorderThickness := 20
LegalZoneRate := 0.2
ScoreRegionRate := 0.05
PaddleDilation := 3.5
Debug := 0
ScorePlayers := [0, 0]
TransRow := 10
if (rand(1) &gt; 0.5)
TransColumn := 6
else
TransColumn := -6
endif
ActivePlayers := [0, 0]
ActiveEvent := 0
AvoidDoubleTouchIndex := 0
RememberRegionIndex := 0
F...",25,1355,
0c7b33a0,micro,1,"depending on your image resolution.
Set the thickness of the borders in pixel.",BorderThickness := 20,22,25,
0c7b33a0,micro,2,,LegalZoneRate := 0.2,26,27,
0c7b33a0,micro,3,,ScoreRegionRate := 0.05,28,29,
0c7b33a0,micro,4,,PaddleDilation := 3.5,30,31,
0c7b33a0,micro,5,(frames per second and ball speed).,Debug := 0,32,35,
0c7b33a0,micro,6,Initial score.,"ScorePlayers := [0, 0]",36,38,
0c7b33a0,micro,7,,"TransRow := 10
if (rand(1) &gt; 0.5)
TransColumn := 6
else
TransColumn := -6
endif
ActivePlayers := [0, 0]
ActiveEvent := 0
AvoidDoubleTouchIndex := 0
RememberRegionIndex := 0
Flush := 'false'
DoPlayerCollisionCheck := 0
FPS := 0
MirrorImageLeftRight := 0
MirrorImageUpDown := 0
dev_close_window ()
d...",39,67,
0c7b33a0,micro,8,,"grab_image_async (Image, AcqHandle, -1)
get_image_size (Image, ImageWidth, ImageHeight)
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
get_window_extents (WindowHandle, Row, Column, WindowWidth, WindowHeight)
WindowImageRatio := WindowWidth / (1.0 * ImageWidth)
FontS...",68,83,"* --- Automatically Added Context ---
BorderThickness := 20
LegalZoneRate := 0.2
ScoreRegionRate := 0.05
ActivePlayers := [0, 0]
Flush := 'false'
open_framegrabber ('DirectShow', 1, 1, 0, 0, 0, 0, 'de..."
0c7b33a0,micro,9,,"TextColor := ['black', 'white']
NormalColor := ['black', '#ffffff33']
HighlightColor := ['black', 'orange']
MouseRow := 110
MouseColumn := 260
MouseButton := 0
ShowMenu := 1
if (Debug)
count_seconds (TimeStart)
endif
grab_image_async (Image, AcqHandle, -1)
if (MirrorImageLeftRight)
mirror_image (Ima...",84,587,"* --- Automatically Added Context ---
BorderThickness := 20
LegalZoneRate := 0.2
ScoreRegionRate := 0.05
PaddleDilation := 3.5
Debug := 0
ScorePlayers := [0, 0]
TransRow := 10
TransColumn := 6
ActiveP..."
0c7b33a0,micro,10,,"region_features (Paddle, 'max_diameter', MaxDiameter)
Acceleration := (ImageHeight / MaxDiameter) / 4
Sign := -pow(-1,PlayerIndex)
TransRowOut := cos(Angle) * Length * Acceleration
TransColumnOut := sin(Angle) * Length * Acceleration
return ()
dev_open_window (0, 0, 800, 600, 'black', WindowHandle)
...",588,788,"* --- Automatically Added Context ---
BorderThickness := 20
ScoreRegionRate := 0.05
ActivePlayers := [0, 0]
open_framegrabber ('DirectShow', 1, 1, 0, 0, 0, 0, 'default', 8, 'gray', -1, 'false', 'defau..."
0c7b33a0,micro,11,,"gen_circle (Ball, ImageHeight / 2, ImageWidth / 2, 19.5)",789,790,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, Region..."
0c7b33a0,micro,12,,"gen_rectangle1 (BoxPlayer1, 0, 0, ImageHeight - 1, (ImageWidth * LegalZoneRate) - 1)
gen_rectangle1 (BoxPlayer2, 0, ImageWidth * (1 - LegalZoneRate), ImageHeight - 1, ImageWidth - 1)
concat_obj (BoxPlayer1, BoxPlayer2, PlayerBoxes)",791,795,"* --- Automatically Added Context ---
LegalZoneRate := 0.2
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, Reg..."
0c7b33a0,micro,13,,"gen_rectangle1 (TopBorder, 0, ImageWidth * ScoreRegionRate, BorderThickness, (ImageWidth - 1) - ImageWidth * ScoreRegionRate)
gen_rectangle1 (BottomBorder, ImageHeight - BorderThickness - 1, ImageWidth * ScoreRegionRate, ImageHeight - 1, (ImageWidth - 1) - (ImageWidth * ScoreRegionRate))
union2 (Top...",796,799,"* --- Automatically Added Context ---
BorderThickness := 20
ScoreRegionRate := 0.05
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArr..."
0c7b33a0,micro,14,,"gen_rectangle1 (RectangleT, 0, 0, BorderThickness, (ImageWidth * ScoreRegionRate) - 1)
gen_rectangle1 (RectangleM, 0, 0, ImageHeight - 1, BorderThickness)
gen_rectangle1 (RectangleB, ImageHeight - BorderThickness - 1, 0, ImageHeight - 1, (ImageWidth * ScoreRegionRate) - 1)
union2 (RectangleT, Rectan...",801,806,"* --- Automatically Added Context ---
BorderThickness := 20
ScoreRegionRate := 0.05
get_image_size (Image, ImageWidth, ImageHeight)
* --- End of Automatically Added Context ---"
0c7b33a0,micro,15,,"gen_rectangle1 (RectangleT, 0, ((ImageWidth - 1) - ImageWidth * ScoreRegionRate) + 1, BorderThickness, ImageWidth - 1)
gen_rectangle1 (RectangleM, 0, ImageWidth - BorderThickness - 1, ImageHeight - 1, ImageWidth - 1)
gen_rectangle1 (RectangleB, ImageHeight - 1 - BorderThickness - 1, ((ImageWidth - 1...",807,816,"* --- Automatically Added Context ---
BorderThickness := 20
ScoreRegionRate := 0.05
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArr..."
0c7b33a0,micro,16,,"gen_pong_arrow (ArrowTmp, Size)
area_center (ArrowTmp, Area1, Row1, Column1)
move_region (ArrowTmp, RegionArrow, -Row1, -Column1)",817,821,"* --- Automatically Added Context ---
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, RegionAccelerateBall, InactivePlayerWall, EmergencyBor..."
0c7b33a0,micro,17,,"gen_double_ball (DoubleBallTmp, Size)
area_center (DoubleBallTmp, Area1, Row1, Column1)
move_region (DoubleBallTmp, RegionDoubleBall, -Row1, -Column1)",822,826,"* --- Automatically Added Context ---
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, RegionAccelerateBall, InactivePlayerWall, EmergencyBor..."
0c7b33a0,micro,18,,"gen_shrink_ball (ShrinkBallRegionTmp, Size)
area_center (ShrinkBallRegionTmp, Area1, Row1, Column1)
move_region (ShrinkBallRegionTmp, RegionShrinkBall, -Row1, -Column1)",827,831,"* --- Automatically Added Context ---
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, RegionAccelerateBall, InactivePlayerWall, EmergencyBor..."
0c7b33a0,micro,19,,"gen_accelerate_ball (AccelerateBallRegionTmp, Size)
area_center (AccelerateBallRegionTmp, Area1, Row1, Column1)
move_region (AccelerateBallRegionTmp, RegionAccelerateBall, -Row1, -Column1)",832,836,"* --- Automatically Added Context ---
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, RegionAccelerateBall, InactivePlayerWall, EmergencyBor..."
0c7b33a0,micro,20,,"gen_inactive_player_wall (InactivePlayerWall, ActivePlayers, ScoreRegionRate, ImageWidth, ImageHeight, BorderThickness)",837,839,"* --- Automatically Added Context ---
BorderThickness := 20
ScoreRegionRate := 0.05
ActivePlayers := [0, 0]
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes,..."
0c7b33a0,micro,21,,"gen_rectangle1 (EmergencyBorderRect, -100, -100, ImageHeight + 100, ImageWidth + 100)
get_region_contour (EmergencyBorderRect, Rows, Columns)
gen_region_points (Region1, Rows, Columns)
dilation_circle (Region1, EmergencyBorder, 30.5)
return ()
Row1 := .5 * Scale
Column1 := .2 * Scale
Row2 := .5 * Sc...",840,1096,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
gen_ui_regions (Image, ButtonRegio..."
0c7b33a0,micro,22,Buttons,"for I := 0 to |ButtonLabels| - 1 by 1
select_obj (ButtonRegion, ButtonSelected, I + 1)
test_region_point (ButtonSelected, MouseRow, MouseColumn, IsInside)
if (IsInside and MouseButton == 1)
ButtonPressed := I
TextColor := HighlightColor[0]
ButtonColor := HighlightColor[1]
DrawMode := 'fill'
elseif (...",1097,1126,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
WindowImageRatio := WindowWidth / (1.0 * ImageWidth)
gen_ui_regions (Image, Button..."
0c7b33a0,micro,23,,"for I := 0 to |SwitchLabels| - 1 by 1
TextColor := NormalColor[0]
select_obj (SwitchRegionVector.at(0), SwitchSelectedOff, I + 1)
select_obj (SwitchRegionVector.at(1), SwitchSelectedOn, I + 1)
test_region_point (SwitchSelectedOff, MouseRow, MouseColumn, IsInside)
if (IsInside and MouseButton == 1)
S...",1127,1158,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
WindowImageRatio := WindowWidth / (1.0 * ImageWidth)
gen_ui_regions (Image, Button..."
0c7b33a0,micro,24,,"for I := 0 to |ToggleLabels| - 1 by 1
TextColor := NormalColor[0]
select_obj (ToggleRegionVector.at(0), ToggleSelectedOff, I + 1)
select_obj (ToggleRegionVector.at(1), ToggleSelectedOn, I + 1)
test_region_point (ToggleSelectedOff, MouseRow, MouseColumn, IsInside)
if (IsInside and MouseButton == 1)
T...",1159,1247,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
WindowImageRatio := WindowWidth / (1.0 * ImageWidth)
gen_ui_regions (Image, Button..."
0c7b33a0,micro,25,,"select_obj (Ball, Ball, 1)
area_center (Ball, AreaBall, RowBall, ColumnBall)
Radius := sqrt(AreaBall / 3.14)
DilationBackToNormal := round(12.5 - Radius)
if (DilationBackToNormal &gt; 0)
dilation_circle (Ball, Ball, DilationBackToNormal)
endif
RowOffset := ImageHeight / 2 - RowBall
ColumnOffset := I...",1248,1258,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
gen_game_regions (Ball, Border, PlayerBoxes, ScoreRegions, RegionArrow, RegionDoubleBall, RegionShrinkBall, Region..."
0c7b33a0,micro,26,are not computed any more.,"BallIndex := NumberOfBalls + 1
PlayerIndex := 3",1259,1262,"* --- Automatically Added Context ---
count_obj (Ball, NumberOfBalls)
for PlayerIndex := 1 to 2 by 1
for BallIndex := 1 to NumberOfBalls by 1
* --- End of Automatically Added Context ---"
0c7b33a0,micro,27,"Player that scores the point
gets first contact.","TransColumn := -TransColumn[0]
TransRow := TransRow[0]",1263,1267,"* --- Automatically Added Context ---
TransRow := 10
TransColumn := 6
* --- End of Automatically Added Context ---"
0c7b33a0,micro,28,,"limit_ball_speed (TransRow, TransColumn, MinSpeed, MaxSpeed * 0.6, TransRowOut, TransColumnOut)",1268,1269,"* --- Automatically Added Context ---
TransRow := 10
TransColumn := 6
check_paddle_ball_collision (Paddle, Ball, NumberOfBalls, AvoidDoubleTouchIndex, TransRow, TransColumn, RowCoordinates, ColumnCoor..."
0c7b33a0,micro,29,,"ActiveEvent := 0
return ()
AvoidDoubleTouchIndexOut := AvoidDoubleTouchIndex
TransColumnOut := TransColumn
TransRowOut := TransRow
dev_set_color ('#0c94b9')
dev_display (Paddle)",1270,1324,"* --- Automatically Added Context ---
TransRow := 10
TransColumn := 6
AvoidDoubleTouchIndex := 0
ActiveEvent := 0
dilation_circle (RegionLines, Paddle, PaddleDilation)
TransColumnOut := TransColumn
Tr..."
0c7b33a0,micro,30,,"for BallIndex := 1 to NumberOfBalls by 1
select_obj (Ball, BallSelected, BallIndex)
get_ball_intersection_area (BallSelected, Paddle, Area)
if (Area &gt; 0 and AvoidDoubleTouchIndexOut[BallIndex - 1] == 0)
BallMoveDistance := sqrt((TransRowOut[BallIndex - 1] * TransRowOut[BallIndex - 1]) + (TransCol...",1325,1379,"* --- Automatically Added Context ---
PaddleDilation := 3.5
get_image_size (Image, ImageWidth, ImageHeight)
dev_open_window_fit_image (Image, 0, 0, [800, 1200], [600, 1000], WindowHandle)
DoPlayerColl..."
416f8d18,full,0,"This example demonstrates how to calculate the polarization angle
and the degree of polarization of ...","dev_close_window ()
dev_update_off ()
read_image (RAWImage, 'glasses_polarized.png')
dev_open_window_fit_image (RAWImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_display (RAWImage)
dev_...",23,336,
416f8d18,micro,1,"|   90°  |   45°  |
|        |        |
--+--------+--------+--
|        |        |
|  135°  |    0°...","dev_close_window ()
dev_update_off ()",15,25,
416f8d18,micro,2,in a separate window.,"read_image (RAWImage, 'glasses_polarized.png')
dev_open_window_fit_image (RAWImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_display (RAWImage)
dev_disp_text ('RAW image', 'window', 'top...",26,42,
416f8d18,micro,3,"RAW image into four separate images, where each image contains
the pixels of one polarization direct...","split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)",43,47,"* --- Automatically Added Context ---
read_image (RAWImage, 'glasses_polarized.png')
* --- End of Automatically Added Context ---"
416f8d18,micro,4,,"PolDirectionValues := [0, 45, 90, 135]
compose4 (Image0, Image45, Image90, Image135, PolarizationDirections)
for Index := 1 to 4 by 1
access_channel (PolarizationDirections, Image, Index)
dev_clear_window ()
dev_display (Image)
dev_disp_text ('Polarization filter in ' + PolDirectionValues[Index - 1]...",48,60,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)..."
416f8d18,micro,5,,"calculate_degree_of_polarization (Image0, Image45, Image90, Image135, DegreeOfPolarization)
dev_clear_window ()
dev_set_lut ('temperature')
dev_display (DegreeOfPolarization)
dev_disp_text ('Degree of Polarization', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Press Run (F5) to continue...",61,74,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, Width, Height)
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
dev_disp_text ('Press Run (F..."
416f8d18,micro,6,,"calculate_polarization_angle (Image0, Image45, Image90, Image135, PolarizationAngle)
convert_image_type (PolarizationAngle, ImageConverted, 'direction')
dev_clear_window ()
dev_set_lut ('default')
dev_display (PolarizationAngle)
dev_disp_text (['Angle of Polarization in [rad]', '', 'The changes in t...",75,103,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
dev_disp_text ('Polarization filter in ' + PolDirectionValues[Index - 1]$'3d' + '° directi..."
416f8d18,micro,7,"|   90°  |   45°  |
|        |        |
--+--------+--------+--, whereby each filter covers cell 4 p...","get_image_size (Image, WidthOriginal, HeightOriginal)
Factor := 0.5",109,120,"* --- Automatically Added Context ---
access_channel (PolarizationDirections, Image, Index)
* --- End of Automatically Added Context ---"
416f8d18,micro,8,,"crop_rectangle1 (Image, ImagePart, 1, 1, HeightOriginal, WidthOriginal)
zoom_image_factor (ImagePart, Image0, Factor, Factor, 'nearest_neighbor')",121,124,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
access_channel (PolarizationDirections, Image, Index)
get_image_size (Image, WidthOriginal..."
416f8d18,micro,9,,"crop_rectangle1 (Image, ImagePart, 0, 1, HeightOriginal - 1, WidthOriginal)
zoom_image_factor (ImagePart, Image45, Factor, Factor, 'nearest_neighbor')",125,128,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
access_channel (PolarizationDirections, Image, Index)
get_image_size (Image, WidthOriginal..."
416f8d18,micro,10,,"crop_rectangle1 (Image, ImagePart, 0, 0, HeightOriginal - 1, WidthOriginal - 1)
zoom_image_factor (ImagePart, Image90, Factor, Factor, 'nearest_neighbor')",129,132,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
access_channel (PolarizationDirections, Image, Index)
get_image_size (Image, WidthOriginal..."
416f8d18,micro,11,,"crop_rectangle1 (Image, ImagePart, 1, 0, HeightOriginal, WidthOriginal - 1)
zoom_image_factor (ImagePart, Image135, Factor, Factor, 'nearest_neighbor')
return ()",133,173,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
access_channel (PolarizationDirections, Image, Index)
get_image_size (Image, WidthOriginal..."
416f8d18,micro,12,"images acquired with a linear polarization filter oriented
in the 0°, 45°, 90° and 135° orientations...","add_image (Image0, Image90, ImageS0, 1, 0)
sub_image (Image0, Image90, ImageS1, 1, 0)
sub_image (Image45, Image135, ImageS2, 1, 0)
return ()",174,221,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
* --- End of Automatically Added Context ---"
416f8d18,micro,13,,"compose4 (Image0, Image45, Image90, Image135, MultiChannelImage)
get_image_type (MultiChannelImage, Type)
if (Type != 'real')
convert_image_type (MultiChannelImage, ImageReal, 'real')
decompose4 (ImageReal, Image0, Image45, Image90, Image135)
endif",227,234,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
* --- End of Automatically Added Context ---"
416f8d18,micro,14,,"calculate_stokes_parameters (Image0, Image45, Image90, Image135, ImageS0, ImageS1, ImageS2)",235,237,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
add_image (Image0, Image90, ImageS0, 1, 0)
sub_image (Image0, Image90, ImageS1, 1, 0)
sub_..."
416f8d18,micro,15,,"mult_image (ImageS1, ImageS1, ImageS1Squared, 1, 0)
mult_image (ImageS2, ImageS2, ImageS2Squared, 1, 0)
add_image (ImageS1Squared, ImageS2Squared, ImagesSAdded, 1, 0)
sqrt_image (ImagesSAdded, ImagesSqrt)
div_image (ImagesSqrt, ImageS0, DegreeOfPolarization, 1, 0)
return ()",238,278,"* --- Automatically Added Context ---
calculate_degree_of_polarization (Image0, Image45, Image90, Image135, DegreeOfPolarization)
add_image (Image0, Image90, ImageS0, 1, 0)
sub_image (Image0, Image90,..."
416f8d18,micro,16,,"compose4 (Image0, Image45, Image90, Image135, MultiChannelImage)
get_image_type (MultiChannelImage, Type)
if (Type != 'real')
convert_image_type (MultiChannelImage, ImageReal, 'real')
decompose4 (ImageReal, Image0, Image45, Image90, Image135)
endif",282,289,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
compose4 (Image0, Image45, Image90, Image135, MultiChannelImage)
get_image_type (MultiChan..."
416f8d18,micro,17,,"calculate_stokes_parameters (Image0, Image45, Image90, Image135, ImageS0, ImageS1, ImageS2)",290,292,"* --- Automatically Added Context ---
split_polarization_image (RAWImage, Image0, Image45, Image90, Image135)
add_image (Image0, Image90, ImageS0, 1, 0)
sub_image (Image0, Image90, ImageS1, 1, 0)
sub_..."
416f8d18,micro,18,,"atan2_image (ImageS2, ImageS1, AtanImage)
scale_image (AtanImage, PolarizationAngle, 0.5, 0)
return ()
gen_image_gray_ramp (ImageGrayRamp, -0.5, 0, 255, 0, 0, 100, 512)
dev_display (ImageGrayRamp)
dev_disp_text ('Scale', 'window', 'top', 'left', 'black', [], [])
dev_set_color ('gray')
for Index := 1...",293,344,"* --- Automatically Added Context ---
for Index := 1 to 4 by 1
dev_open_window (0, Width + 8, 100, 512, 'black', WindowHandleLegend)
calculate_polarization_angle (Image0, Image45, Image90, Image135, P..."
8d375a3e,full,0,,"dev_update_off ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_display (Angio)
disp_message (WindowID, 'Original image', 'window', 12, 1...",6,62,
d98174ff,full,0,"This program shows how to detect the edges of a diamond
with subpixel accuracy and calculate the ang...","dev_update_off ()
dev_close_window ()
read_image (Image, 'diamond/diamond_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_image_size (Image, Width, Height)
create_metrology_model (MetrologyHandle)
set_metrology_model...",19,109,
d98174ff,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'diamond/diamond_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_image_size (Image, Width, Height)",18,25,
d98174ff,micro,2,,create_metrology_model (MetrologyHandle),26,27,
d98174ff,micro,3,first call of apply_metrology_model.,"set_metrology_model_image_size (MetrologyHandle, Width, Height)",28,30,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
d98174ff,micro,4,,"LineRow1 := [155, 155]
LineColumn1 := [400, 400]
LineRow2 := [290, 290]
LineColumn2 := [230, 570]
Tolerance := 20",31,37,
d98174ff,micro,5,,"add_metrology_object_line_measure (MetrologyHandle, LineRow1, LineColumn1, LineRow2, LineColumn2, Tolerance, 10, 1, 20, [], [], Index1)",38,39,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
LineRow1 := [155, 155]
LineColumn1 := [400, 400]
LineRow2 := [290, 290]
LineColumn2 := [230, 570]
Tolerance := 20
* --- E..."
d98174ff,micro,6,,"gen_rectangle1 (Rectangle, LineRow1[0] - 40, LineColumn1[0] - 50, LineRow1[0] + 20, LineColumn1[0] + 50)",40,41,"* --- Automatically Added Context ---
LineRow1 := [155, 155]
LineColumn1 := [400, 400]
* --- End of Automatically Added Context ---"
d98174ff,micro,7,metrology model is given to be situated at the top of the diamond,"reduce_domain (Image, Rectangle, ImageReduced)
threshold (ImageReduced, Region, 128, 255)
get_region_points (Region, Rows, Columns)
set_metrology_model_param (MetrologyHandle, 'reference_system', [Rows[0],Columns[0],0])",42,48,"* --- Automatically Added Context ---
read_image (Image, 'diamond/diamond_01')
create_metrology_model (MetrologyHandle)
gen_rectangle1 (Rectangle, LineRow1[0] - 40, LineColumn1[0] - 50, LineRow1[0] + ..."
d98174ff,micro,8,,"for I := 1 to 5 by 1
read_image (Image, 'diamond/diamond_' + I$'02')
reduce_domain (Image, Rectangle, ImageReduced)
threshold (ImageReduced, Region, 128, 255)
get_region_points (Region, Rows, Columns)
align_metrology_model (MetrologyHandle, Rows[0], Columns[0], 0)
apply_metrology_model (Image, Metro...",49,115,"* --- Automatically Added Context ---
read_image (Image, 'diamond/diamond_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_metrology_model (MetrologyHandle)
gen_rectangle1 (Re..."
72f019a4,full,0,ball_seq.hdev: Inspection of Ball Bonding,"dev_update_off ()
ImageNames := 'die/' + ['die_02', 'die_03', 'die_04', 'die_07']
dev_set_colored (12)
read_image (Bond, ImageNames[0])
get_image_size (Bond, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 't...",8,48,
72f019a4,micro,1,,"dev_update_off ()
ImageNames := 'die/' + ['die_02', 'die_03', 'die_04', 'die_07']
dev_set_colored (12)
read_image (Bond, ImageNames[0])
get_image_size (Bond, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 't...",6,54,
2e954dd3,full,0,"In this program the size of raw fish sticks is measured
before they are coated with bread crumbs.
Fi...","dev_update_off ()
dev_close_window ()
read_image (Image, 'food/fish_sticks_raw_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_empty_region', StoreEmptyRegion)
set_system ('stor...",12,83,
2e954dd3,micro,1,"before they are coated with bread crumbs.
First, the fish sticks are segmented from the background.
...","dev_update_off ()
dev_close_window ()
read_image (Image, 'food/fish_sticks_raw_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_empty_region', StoreEmptyRegion)
set_system ('stor...",6,89,
74219caa,full,0,"The edges in the image are segmented into lines and circles.
For the edges that are part of a circle...","read_image (Image, 'double_circle')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
fast_threshold (Image, Region, 0, 120, 7)
boundary (Region, RegionBorder, 'inner')
clip_region_rel (RegionBorder, RegionClipped, 5, 5, 5, 5)
dila...",10,45,
74219caa,micro,1,"For the edges that are part of a circle, the circle parameters
are estimated and the resulting circl...","read_image (Image, 'double_circle')",7,11,
74219caa,micro,2,,"dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",12,16,"* --- Automatically Added Context ---
read_image (Image, 'double_circle')
* --- End of Automatically Added Context ---"
74219caa,micro,3,,"fast_threshold (Image, Region, 0, 120, 7)
boundary (Region, RegionBorder, 'inner')
clip_region_rel (RegionBorder, RegionClipped, 5, 5, 5, 5)
dilation_circle (RegionClipped, RegionDilation, 2.5)
reduce_domain (Image, RegionDilation, ImageReduced)",17,23,"* --- Automatically Added Context ---
read_image (Image, 'double_circle')
* --- End of Automatically Added Context ---"
74219caa,micro,4,extract subpixel precise edges.,"edges_sub_pix (ImageReduced, Edges, 'canny', 2, 20, 60)
segment_contours_xld (Edges, ContoursSplit, 'lines_circles', 5, 4, 3)
count_obj (ContoursSplit, Number)
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('white')
dev_update_window ('off')
for I := 1 to Number by 1
select_obj (Contours...",24,51,"* --- Automatically Added Context ---
read_image (Image, 'double_circle')
reduce_domain (Image, RegionDilation, ImageReduced)
* --- End of Automatically Added Context ---"
54722552,full,0,"This program demonstrates the automatic refinement of the
orientation of a measure object used for 1...","Interactive := 0
dev_close_window ()
dev_update_window ('off')
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_display (Image)
if (In...",15,120,
54722552,micro,1,,"Interactive := 0
dev_close_window ()
dev_update_window ('off')
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_display (Image)
if (In...",14,44,
54722552,micro,2,,"gen_measure_rectangle2 (Row, Column, Phi, Length1, Length2, Width, Height, 'bicubic', MeasureHandle)
measure_pairs (Image, MeasureHandle, 1, 30, 'all', 'all', RowEdgeFirst, ColumnEdgeFirst, AmplitudeFirst, RowEdgeSecond, ColumnEdgeSecond, AmplitudeSecond, IntraDistance, InterDistance)",45,48,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
smallest_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
* --- End of Automatically Ad..."
54722552,micro,3,,"gen_rectangle2 (RectangleROI, Row, Column, Phi, Length1, 4 * Length2)
reduce_domain (Image, RectangleROI, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'canny', 1, 20, 40)
get_contour_angle_xld (Edges, 'abs', 'regress', 3, Angles)",49,54,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
smallest_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
* --- End of Automatically Added Context ---"
54722552,micro,4,of the measure rectangle.,"MeanAngle := mean(Angles) - rad(90)
MeanAngleDeg := deg(MeanAngle)",55,59,"* --- Automatically Added Context ---
get_contour_angle_xld (Edges, 'abs', 'regress', 3, Angles)
* --- End of Automatically Added Context ---"
54722552,micro,5,,"gen_measure_rectangle2 (Row, Column, MeanAngle, Length1, Length2, Width, Height, 'bicubic', MeasureHandle)
gen_rectangle2 (Rectangle2, Row, Column, MeanAngle, Length1, Length2)
measure_pairs (Image, MeasureHandle, 1, 30, 'all', 'all', RowEdgeFirst2, ColumnEdgeFirst2, AmplitudeFirst2, RowEdgeSecond2,...",60,64,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
smallest_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
gen_measure_rectangle2 (Row, ..."
54722552,micro,6,,"dev_display (Image)
dev_set_draw ('margin')
p_disp_edge_marker (RowEdgeFirst, ColumnEdgeFirst, Phi, Length2, 'red', 2)
p_disp_edge_marker (RowEdgeSecond, ColumnEdgeSecond, Phi, Length2, 'red', 2)
dev_set_color ('red')
dev_display (Rectangle)
p_disp_edge_marker (RowEdgeFirst2, ColumnEdgeFirst2, MeanA...",65,95,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'Measure..."
54722552,micro,7,,"NumRows := |Rows|
NumCols := |Cols|
Num := min([NumRows,NumCols])",96,100,
54722552,micro,8,,"for i := 0 to Num - 1 by 1
Row := Rows[i]
Col := Cols[i]
RowStart := Row + Length * cos(Phi)
RowEnd := Row - Length * cos(Phi)
ColStart := Col + Length * sin(Phi)
ColEnd := Col - Length * sin(Phi)
gen_contour_polygon_xld (Marker, [RowStart,RowEnd], [ColStart,ColEnd])
dev_set_color (Color)
dev_set_li...",101,134,"* --- Automatically Added Context ---
smallest_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
Num := min([NumRows,NumCols])
NumRows := |Rows|
NumCols := |Cols|
* --- End of Automatically A..."
8e79df65,full,0,"Determine the location of single dies on a wafer by using
auto-correlation techniques in the frequen...","dev_update_off ()
read_image (Wafer, 'wafer/wafer_dies')
get_image_size (Wafer, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Wafer)
disp_message (Window...",13,61,
8e79df65,micro,1,"auto-correlation techniques in the frequency domain.
The image of the wafer is correlated with itsel...","dev_update_off ()
read_image (Wafer, 'wafer/wafer_dies')
get_image_size (Wafer, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Wafer)
disp_message (Window...",6,24,
8e79df65,micro,2,,"rft_generic (Wafer, ImageFFT, 'to_freq', 'n', 'complex', Width)
correlation_fft (ImageFFT, ImageFFT, ImageCorrelation)
rft_generic (ImageCorrelation, ImageFFTInv, 'from_freq', 'n', 'real', Width)",25,29,"* --- Automatically Added Context ---
read_image (Wafer, 'wafer/wafer_dies')
get_image_size (Wafer, Width, Height)
* --- End of Automatically Added Context ---"
8e79df65,micro,3,,"local_max_sub_pix (ImageFFTInv, 'gauss', 3, 0.0001, Row, Column)",30,31,"* --- Automatically Added Context ---
rft_generic (ImageCorrelation, ImageFFTInv, 'from_freq', 'n', 'real', Width)
* --- End of Automatically Added Context ---"
8e79df65,micro,4,,"I0 := 5
I1 := 6
I2 := 9
gen_arrow_contour_xld (Arrow, subset(Row,[I0,I0]), subset(Column,[I0,I0]), subset(Row,[I1,I2]), subset(Column,[I1,I2]), 15, 15)
gen_cross_contour_xld (Cross, Row, Column, 20, rad(45))
distance_pp (Row[I0], Column[I0], Row[I1], Column[I1], DistHor)
distance_pp (Row[I0], Column...",32,40,"* --- Automatically Added Context ---
local_max_sub_pix (ImageFFTInv, 'gauss', 3, 0.0001, Row, Column)
* --- End of Automatically Added Context ---"
8e79df65,micro,5,,"dev_display (ImageFFTInv)
disp_message (WindowHandle, 'Auto-correlation of the wafer image...', 'window', 12, 12, 'black', 'true')
dev_set_color ('yellow')
dev_display (Arrow)
disp_message (WindowHandle, DistHor$'.2f' + ' px', 'image', Row[I0] - 25, (Column[I0] + Column[I1]) * .5 - 50, 'yellow', 'fa...",41,52,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
rft_generic (ImageCorrelation, ImageFFTInv, 'from_freq', 'n', 'real', Width)
local_max_sub_pix (Image..."
8e79df65,micro,6,,"dev_display (Wafer)
disp_message (WindowHandle, ['Auto-correlation of the wafer image...', '...corresponds to the die pitch'], 'window', 12, 12, 'black', 'true')
dev_set_color ('yellow')
dev_display (Arrow)
disp_message (WindowHandle, DistHor$'.2f' + ' px', 'image', Row[I0] - 25, (Column[I0] + Colum...",53,67,"* --- Automatically Added Context ---
read_image (Wafer, 'wafer/wafer_dies')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
local_max_sub_pix (ImageFFTInv, 'gauss', 3, 0.0001, Row, Colum..."
a74f8a5f,full,0,"This program demonstrates the processing of a large image with HALCON XL.
First, a large image is cr...","get_system ('halcon_xl', IsHalconXL)
if (IsHalconXL == 'false')
dev_close_window ()
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Run this example with HALCON XL', 'window', 12, 12, 'red', 'false')
re...",14,138,
a74f8a5f,micro,1,,"get_system ('halcon_xl', IsHalconXL)
if (IsHalconXL == 'false')
dev_close_window ()
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Run this example with HALCON XL', 'window', 12, 12, 'red', 'false')
re...",13,22,
a74f8a5f,micro,2,,"dev_update_off ()
read_image (Image, 'clip')
crop_rectangle1 (Image, ImagePart, 40, 0, 770, 830)
mirror_image (ImagePart, ImageMirror, 'row')
concat_obj (ImagePart, ImageMirror, Images)
for Index := 1 to 5 by 1
concat_obj (Images, Images, Images)
endfor
tile_images (Images, Clip, 1, 'vertical')",23,33,
a74f8a5f,micro,3,,"dev_close_window ()
get_image_size (Clip, Width, Height)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (-150, -100, Width + 50, Width + 100)
dev_display (Clip)
disp_message (WindowHandle, 'Upper part of a line scan i...",34,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
tile_images (Images, Clip, 1, 'vertical')
* --- End of Automatically Added Context ---"
a74f8a5f,micro,4,,"count_seconds (Seconds1)
threshold (Clip, Dark, 0, 100)
connection (Dark, Single)
select_shape (Single, Selected, 'area', 'and', 5000, 10000)
count_seconds (Seconds2)
count_obj (Selected, NumClips)
dev_clear_window ()
dev_set_draw ('fill')
dev_set_colored (12)
dev_display (Clip)
dev_display (Selecte...",45,61,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
tile_images (Images, Clip, 1, 'vertical')
* --- End of Automatically Added Context ---"
a74f8a5f,micro,5,,"count_seconds (Seconds1)
orientation_region (Selected, Phi)
area_center (Selected, Area, Row, Column)
count_seconds (Seconds2)
dev_clear_window ()
dev_set_line_width (3)
Length := 80
gen_empty_obj (Arrows)
for i := 0 to |Phi| - 1 by 1
dev_set_color ('yellow')
gen_arrow_contour_xld (Arrow, Row[i], Co...",62,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
tile_images (Images, Clip, 1, 'vertical')
count_seconds (Seconds1)
select_shape (Single, Selected, 'area',..."
a74f8a5f,micro,6,,"get_window_extents (WindowHandle, Row0, Column0, WidthWin, HeightWin)
open_window (0, 0, WidthWin, HeightWin, 0, 'buffer', '', WindowHandleBuffer)
set_display_font (WindowHandleBuffer, 14, 'mono', 'true', 'false')
set_color (WindowHandleBuffer, 'yellow')
set_line_width (WindowHandleBuffer, 3)
get_pa...",83,152,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 100, 'black', WindowHandle)
for Index := 1 to 5 by 1
tile_images (Images, Clip, 1, 'vertical')
get_image_size (Clip, Width, Height)
co..."
ce2080dd,full,0,fin.hdev: Detection of a fin,"dev_update_window ('off')
read_image (Fins, 'fin' + [1:3])
get_image_size (Fins, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width[0], Height[0], 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
for I := 1 to 3 by 1
select_obj (Fins, Fin, I)
dev_display (Fin)...",8,39,
ce2080dd,micro,1,,"dev_update_window ('off')
read_image (Fins, 'fin' + [1:3])
get_image_size (Fins, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width[0], Height[0], 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
for I := 1 to 3 by 1
select_obj (Fins, Fin, I)
dev_display (Fin)...",6,45,
82a47f29,full,0,"Example for the application of the fuzzy measure tool
including a lot of visualization operators","dev_close_window ()
read_image (Image, 'board/board-06')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Row1 := 305.5
Col1 := 375.5
Phi1 := 0.982
Length1 := 167
Length2 := 8
gen_measure_rectangle2 (Row1, Col1, Phi1, Length1, Length2, Width, Height,...",9,169,
82a47f29,micro,1,including a lot of visualization operators,"dev_close_window ()
read_image (Image, 'board/board-06')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,13,
82a47f29,micro,2,,"Row1 := 305.5
Col1 := 375.5
Phi1 := 0.982
Length1 := 167
Length2 := 8
gen_measure_rectangle2 (Row1, Col1, Phi1, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle1)
Row2 := 188.5
Col2 := 202.5
Phi2 := Phi1 - rad(180)
gen_measure_rectangle2 (Row2, Col2, Phi2, Length1, Length2, Width, ...",14,24,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
82a47f29,micro,3,,"create_funct_1d_pairs ([0.0, 0.3], [1.0, 0.0], FuzzyAbsSizeDiffFunction)
set_fuzzy_measure_norm_pair (MeasureHandle1, 11.0, 'size_abs_diff', FuzzyAbsSizeDiffFunction)
set_fuzzy_measure_norm_pair (MeasureHandle2, 11.0, 'size_abs_diff', FuzzyAbsSizeDiffFunction)
fuzzy_measure_pairs (Image, MeasureHand...",25,31,"* --- Automatically Added Context ---
read_image (Image, 'board/board-06')
gen_measure_rectangle2 (Row1, Col1, Phi1, Length1, Length2, Width, Height, 'nearest_neighbor', MeasureHandle1)
gen_measure_re..."
82a47f29,micro,4,,dev_display (Image),32,33,"* --- Automatically Added Context ---
read_image (Image, 'board/board-06')
* --- End of Automatically Added Context ---"
82a47f29,micro,5,,"dev_display_measure_object (Row1, Col1, Phi1, Length1, Length2)
dev_display_measure_object (Row2, Col2, Phi2, Length1, Length2)",34,36,"* --- Automatically Added Context ---
Row1 := 305.5
Col1 := 375.5
Phi1 := 0.982
Length1 := 167
Length2 := 8
Row2 := 188.5
Col2 := 202.5
Phi2 := Phi1 - rad(180)
* --- End of Automatically Added Context..."
82a47f29,micro,6,,"dev_set_draw ('fill')
Pin := 1
dev_display_profile_points ([RowEdgeFirst1,RowEdgeSecond1], [ColumnEdgeFirst1,ColumnEdgeSecond1], Row1, Col1, Phi1, Length1, Length2)
for I := 0 to |ColumnEdgeFirst1| - 1 by 1
disp_message (WindowHandle, 'size:' + IntraDistance1[I]$'.2f' + ' score:' + FuzzyScore1[I]$'....",37,183,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Row1 := 305.5
Col1 := 375.5
Phi1 := 0.982
Length1 := 167
Length2 := 8
Row2 := 188.5
Col2 := 202.5
Phi..."
13546c21,full,0,,"read_image (Image, 'progres')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'white', WindowID)
dev_set_color ('red')
gen_rectangle1 (Rectangle, 260, 90, 360, 350)
reduce_domain (Image, Rectangle, ImageReduced)
threshold (ImageReduced, Dark, 0, 150)
c...",6,24,
8d60f9cc,full,0,,"read_image (Hull, 'hull')
get_image_size (Hull, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Hull)
threshold (Hull, Dark, 0, 80)
difference (Hull, Dark, Light)
connection (Light, ConnectedRegions)
select_shape (ConnectedRegions, NoHullCand,...",6,35,
8d60f9cc,micro,1,,"threshold (Hull, Dark, 0, 80)
difference (Hull, Dark, Light)
connection (Light, ConnectedRegions)
select_shape (ConnectedRegions, NoHullCand, 'area', 'and', 50000, 9999999)
closing_circle (NoHullCand, NoHull, 13.5)
difference (Hull, NoHull, Region)
opening_circle (Region, RegionOpening, 2.5)
connect...",12,23,"* --- Automatically Added Context ---
read_image (Hull, 'hull')
* --- End of Automatically Added Context ---"
8d60f9cc,micro,2,,"shape_trans (RegionHull, ConvexHull, 'convex')
difference (ConvexHull, RegionHull, Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, LargeHoles, 'area', 'and', 2000, 99999)
select_shape (LargeHoles, Holes, 'convexity', 'and', 0, 0.85)
dev_display (Hull)
dev_set_line_width...",24,41,"* --- Automatically Added Context ---
read_image (Hull, 'hull')
connection (Light, ConnectedRegions)
difference (Hull, NoHull, Region)
select_shape (ConnectedRegions, RegionHull, 'area', 'and', 5000, ..."
0af66fae,full,0,"This program shows how to calculate the pointwise
distance of two contours to inspect the camera fra...","MinWidth := 30
MaxWidth := 35
SmoothnessTolerance := .2
dev_update_off ()
dev_close_window ()
read_image (Image, 'plastic_parts/phone_camera_frame_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Colors := ['white', 'gree...",16,111,
0af66fae,micro,1,,"MinWidth := 30
MaxWidth := 35
SmoothnessTolerance := .2",15,19,
0af66fae,micro,2,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'plastic_parts/phone_camera_frame_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Colors := ['white', 'green', 'yellow', 'orange', 'red']
Legend := 'Legend:'
Legen...",20,32,
0af66fae,micro,3,Inspect the camera frame,"NumImages := 2
for I := 1 to NumImages by 1
read_image (Image, 'plastic_parts/phone_camera_frame_' + I$'02')
threshold (Image, Region, 100, 255)
dilation_rectangle1 (Region, RegionDilation, 15, 15)
reduce_domain (Image, RegionDilation, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'canny', 0.7, ...",33,117,"* --- Automatically Added Context ---
MinWidth := 30
MaxWidth := 35
SmoothnessTolerance := .2
read_image (Image, 'plastic_parts/phone_camera_frame_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, ..."
d0c8895d,full,0,"This example program shows how to use local deformable
matching to find and inspect objects that are...","dev_update_off ()
Smoothness := 25
read_image (ModelImage, 'gasket/gasket_model')
read_image (Image, 'gasket/gasket_01')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, 500, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
get_window_extents (WindowHa...",9,140,
d0c8895d,micro,1,matching to find and inspect objects that are deformed.,"dev_update_off ()
Smoothness := 25
read_image (ModelImage, 'gasket/gasket_model')
read_image (Image, 'gasket/gasket_01')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, 500, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
get_window_extents (WindowHa...",6,19,
d0c8895d,micro,2,,"sobel_amp (ModelImage, EdgeAmplitude, 'thin_max_abs', 5)
create_variation_model (425, 410, 'byte', 'direct', VariationModelID)
prepare_direct_variation_model (ModelImage, EdgeAmplitude, VariationModelID, 30, 1.5)",20,24,"* --- Automatically Added Context ---
read_image (ModelImage, 'gasket/gasket_model')
* --- End of Automatically Added Context ---"
d0c8895d,micro,3,,"create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 0.9, [], 'auto', 0.9, [], 'auto', 'none', 'use_polarity', 'auto', 'auto', [], [], ModelID)
get_deformable_model_contours (ModelContours, ModelID, 1)
area_center (ModelImage, Area, Row, Column)
hom_mat2d_identity (HomMat2DIdentity)
ho...",25,40,"* --- Automatically Added Context ---
read_image (ModelImage, 'gasket/gasket_model')
dev_open_window_fit_image (ModelImage, 0, 0, 500, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column..."
d0c8895d,micro,4,,"NumImages := 7
for Index := 1 to NumImages by 1
read_image (Image, 'gasket/gasket_' + Index$'02')
dev_set_window (WindowHandle2)
dev_display (Image)
disp_message (WindowHandle2, 'Search ...', 'window', 12, 12, 'black', 'true')
count_seconds (S1)
find_local_deformable_model (Image, ImageRectified, Ve...",41,150,"* --- Automatically Added Context ---
Smoothness := 25
read_image (Image, 'gasket/gasket_01')
dev_open_window_fit_image (ModelImage, 0, 0, 500, -1, WindowHandle1)
get_window_extents (WindowHandle1, Ro..."
3f52ecfe,full,0,"This example shows the infrared image of a harddisk, that is
tested for heat emission. The user know...","dev_close_window ()
read_image (Image, 'infrared/harddisk_temperature')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
dev_set_color ('blue')
dev_set_line_width (3)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
TemperatureSca...",12,39,
3f52ecfe,micro,1,"tested for heat emission. The user knows beforehand, which
areas on the disk must have a specific te...","dev_close_window ()
read_image (Image, 'infrared/harddisk_temperature')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
dev_set_color ('blue')
dev_set_line_width (3)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
TemperatureSca...",6,45,
49e8ef03,full,0,"Example for the application of the measure package
including a lot of visualization operators","read_image (Zeiss1, 'zeiss1')
get_image_size (Zeiss1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Zeiss1)
disp_continue_message (WindowHandle, 'black', 'true')
stop (...",9,52,
49e8ef03,micro,1,including a lot of visualization operators,"read_image (Zeiss1, 'zeiss1')
get_image_size (Zeiss1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Zeiss1)
disp_continue_message (WindowHandle, 'black', 'true')
stop (...",6,58,
b71934cc,full,0,"This example demonstrates the optical inspection after a
ball bonding process on a chip. First, the ...","dev_update_off ()
dev_close_window ()
FileName := 'bonds/ball_bond_ccd_'
read_image (Image, FileName + 1$'02')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_...",12,104,
b71934cc,micro,1,"ball bonding process on a chip. First, the pads are extracted.
Then, the ball bonds are searched wit...","dev_update_off ()
dev_close_window ()
FileName := 'bonds/ball_bond_ccd_'
read_image (Image, FileName + 1$'02')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_...",6,110,
6e3131ec,full,0,"This program shows how to measure the width of pcb tracks.
First, we use the operator lines_gauss to...","dev_update_off ()
dev_close_window ()
read_image (Image, 'pcb_color')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('yellow')
...",12,117,
6e3131ec,micro,1,"First, we use the operator lines_gauss to determine the
width of the tracks. Afterwards, the width i...","dev_update_off ()
dev_close_window ()
read_image (Image, 'pcb_color')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('yellow')",6,21,
6e3131ec,micro,2,,"MaxTrackWidth := 6.0
MinTrackWidth := 4.0",22,25,
6e3131ec,micro,3,,"Rectangle := [271, 285, 528, 718]
gen_rectangle1 (PcbPart, Rectangle[0], Rectangle[1], Rectangle[2], Rectangle[3])
dev_display (Image)
dev_display (PcbPart)
disp_message (WindowHandle, 'Measure the width of tracks using lines_gauss', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHa...",26,40,"* --- Automatically Added Context ---
read_image (Image, 'pcb_color')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
6e3131ec,micro,4,,"decompose3 (Image, ImageR, ImageG, ImageB)
reduce_domain (ImageG, PcbPart, ImageReduced)
threshold (ImageReduced, Region, 90, 255)
dilation_circle (Region, RegionDilation, 3.5)
opening_rectangle1 (Region, RegionOpening, 8, 8)
dilation_circle (RegionOpening, RegionDilation1, 3.5)
difference (Region, ...",41,54,"* --- Automatically Added Context ---
read_image (Image, 'pcb_color')
gen_rectangle1 (PcbPart, Rectangle[0], Rectangle[1], Rectangle[2], Rectangle[3])
* --- End of Automatically Added Context ---"
6e3131ec,micro,5,,"lines_gauss (ImageReducedTracks, Lines, 1.5, 1, 8, 'light', 'true', 'bar-shaped', 'true')
select_shape_xld (Lines, SelectedXLD, 'contlength', 'and', 20, 99999)
dev_display (Image)
dev_set_color ('yellow')
dev_display (PcbPart)
dev_set_color ('green')
dev_set_line_width (2)
dev_display (Lines)
disp_m...",55,67,"* --- Automatically Added Context ---
read_image (Image, 'pcb_color')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_rectangle1 (PcbPart, Rectangle[0], Rectangle[1], Rectangle[2], R..."
6e3131ec,micro,6,,"count_obj (SelectedXLD, NumberL)
RowLine := []
ColLine := []
LineWidth := []
for IndexL := 1 to NumberL by 1
select_obj (SelectedXLD, Line, IndexL)
get_contour_xld (Line, Row, Column)
get_contour_attrib_xld (Line, 'width_left', WidthL)
get_contour_attrib_xld (Line, 'width_right', WidthR)
RowLine := ...",68,82,"* --- Automatically Added Context ---
select_shape_xld (Lines, SelectedXLD, 'contlength', 'and', 20, 99999)
* --- End of Automatically Added Context ---"
6e3131ec,micro,7,,"tuple_find (min2(LineWidth,MaxTrackWidth), MaxTrackWidth, IndicesTooBroad)
tuple_find (max2(LineWidth,MinTrackWidth), MinTrackWidth, IndicesTooNarrow)
if (IndicesTooBroad == -1)
IndicesTooBroad := []
endif
if (IndicesTooNarrow == -1)
IndicesTooNarrow := []
endif
gen_region_points (RegionTooBroad, su...",83,94,"* --- Automatically Added Context ---
MaxTrackWidth := 6.0
MinTrackWidth := 4.0
RowLine := []
ColLine := []
LineWidth := []
* --- End of Automatically Added Context ---"
6e3131ec,micro,8,,"connection (RegionTooBroad, RegionTooBroad)
gen_contours_skeleton_xld (RegionTooBroad, TracksTooBroad, 1, 'filter')
smallest_circle (RegionTooBroad, RowTooBroad, ColumnTooBroad, RadiusTooBroad)
gen_circle_contour_xld (CircleTooBroad, RowTooBroad, ColumnTooBroad, min2(RadiusTooBroad + 10,20), 0, 6.28...",95,123,"* --- Automatically Added Context ---
read_image (Image, 'pcb_color')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
reduce_domain (ImageG, PcbPart, ImageReduced)
lines_gauss (ImageRedu..."
ba5bddfc,full,0,"This program shows how to detect the edges of a diamond
with subpixel accuracy and how to determine ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'diamond/diamond_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
NumImages := 5
for Index := 1 to NumIm...",16,68,
ba5bddfc,micro,1,"with subpixel accuracy and how to determine the position
of the diamond's vertex.
First, we segment ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'diamond/diamond_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
NumImages := 5
for Index := 1 to NumIm...",6,74,
5f22ea0b,full,0,"In this example a fill level check for the
pharmaceutical industry is demonstrated. The task is
to c...","dev_close_window ()
dev_update_off ()
read_image (Image, 'ampoules/ampoules_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_rectang...",14,89,
5f22ea0b,micro,1,"pharmaceutical industry is demonstrated. The task is
to check for the fill level of each single nose...","dev_close_window ()
dev_update_off ()
read_image (Image, 'ampoules/ampoules_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,22,
5f22ea0b,micro,2,,"gen_rectangle1 (Rectangle, 230, 280, 317, 330)
reduce_domain (Image, Rectangle, ImageModel)
create_shape_model (ImageModel, 'auto', 0, 0, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)",23,27,"* --- Automatically Added Context ---
read_image (Image, 'ampoules/ampoules_01')
* --- End of Automatically Added Context ---"
5f22ea0b,micro,3,,"gen_measure_rectangle2 (0, 0, rad(90), 75, 20, Width, Height, 'bilinear', MeasureHandle)
Tolerance := 15",28,31,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
5f22ea0b,micro,4,,"NumImages := 8
for Index := 1 to NumImages by 1
read_image (Image, 'ampoules/ampoules_' + Index$'.2d')
ColumnEdges := []
FillLevelHeight := []
find_shape_model (Image, ModelID, 0, 0, 0.7, 0, 0.1, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
MeanRow := mean(Row)
RefLevel := MeanRow - 160
dev_d...",32,95,"* --- Automatically Added Context ---
read_image (Image, 'ampoules/ampoules_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_shape_model (ImageModel, 'auto', 0, 0, 'auto', 'au..."
35d7dc86,full,0,"This example shows how to robustly measure the width of frames in between
the cells of an LCD displa...","dev_close_window ()
dev_update_off ()
Path := 'lcd/lcd_cells_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_col...",16,358,
35d7dc86,micro,1,"1. The frames have a very low contrast. With adequately wide ROIs
the measure tool is able to still ...","dev_close_window ()
dev_update_off ()
Path := 'lcd/lcd_cells_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_col...",9,123,
35d7dc86,micro,2,,"get_image_size (Image, Width, Height)
if (Orientation == 'vertical')
mean_image (Image, ImageMean, 0.5, Height / 3)
mean_image (ImageMean, ImageMean1, StripeWidth + 1, StripeWidth + 1)
dyn_threshold (ImageMean, ImageMean1, RegionDynThresh, 1, 'light')
connection (RegionDynThresh, ConnectedRegions)
s...",124,142,"* --- Automatically Added Context ---
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
union2 (HorizontalStripes, VerticalStripes, RegionUnion)
* --- End of Automatically Added Co..."
35d7dc86,micro,3,,"count_obj (Candidates, NStripes)
gen_empty_obj (Stripes)
if (Orientation == 'vertical')
for k := 1 to NStripes by 1
select_obj (Candidates, ObjectSelected, k)
get_region_runs (ObjectSelected, Row, ColumnBegin, ColumnEnd)
if ((min(ColumnBegin) != 0) and (max(ColumnEnd) != Width - 1))
shape_trans (Obj...",143,196,"* --- Automatically Added Context ---
select_obj (Contours, ObjectSelected, C)
get_contour_xld (ObjectSelected, Row, Col)
concat_obj (VerticalStripes, HorizontalStripes, Stripes)
get_image_size (Image..."
35d7dc86,micro,4,"the frame. MesRectHeight is the height of the measuring rectangle. Its value
should be high enough s...","Widths := []
get_image_size (Image, Width, Height)
smallest_rectangle1 (Stripes, Row1, Column1, Row2, Column2)
count_obj (Stripes, NStripes)
tuple_gen_const (NStripes, 1, Ones)
area_center (Stripes, Area, MesRectRow, MesRectCol)",197,209,"* --- Automatically Added Context ---
read_image (Image, Path + '01')
concat_obj (VerticalStripes, HorizontalStripes, Stripes)
smallest_rectangle1 (Stripes, Row1, Column1, Row2, Column2)
area_center (..."
35d7dc86,micro,5,,"if (Orientation == 'vertical')
StripeWidth := Column2 - Column1
StripeHeight := Row2 - Row1
CenterInterDist := (StripeHeight - MesRectHeight) / real(NPoints)
MesAngle := rad(0)
tuple_gen_const (NPoints, 1, Ones)
Index := cumul(Ones) - 1
RectRow := []
RectCol := []
for s := 1 to NStripes by 1
RectRow...",210,372,"* --- Automatically Added Context ---
read_image (Image, Path + '01')
concat_obj (HorzContours, VertContours, Contours)
select_obj (Contours, ObjectSelected, C)
get_contour_xld (ObjectSelected, Row, C..."
0648372b,full,0,"Measure the dimensions of pads on a die with subpixel precision
to make sure that the chip productio...","dev_update_off ()
dev_close_window ()
read_image (Image, 'die/die_pads_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_open_window (0, Width + 12, 350, 350...",15,223,
0648372b,micro,1,"to make sure that the chip production is accurate and is applied
according to the CAD data.
To check...","dev_update_off ()
dev_close_window ()
read_image (Image, 'die/die_pads_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_open_window (0, Width + 12, 350, 350...",7,25,
0648372b,micro,2,,ScaleFactor := 2.75,26,28,
0648372b,micro,3,the contours corresponding to the pad and fit a rectangle.,"NumImages := 8
for Index := 1 to NumImages by 1
read_image (Image, 'die/die_pads_' + Index$'.02')
count_seconds (T1)
segment_pads_boundary_region (Image, RegionUnion)
reduce_domain (Image, RegionUnion, ImageReduced)
fit_rectangle_to_pads_subpix (ImageReduced, Rectangles, RowPads, ColumnPads, PhiPads...",29,113,"* --- Automatically Added Context ---
read_image (Image, 'die/die_pads_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 12, 350, 350, 'black', WindowZoomed..."
0648372b,micro,4,dimensions by fitting a rectangle.,"edges_sub_pix (Image, Edges, 'canny', 0.8, 15, 80)
select_shape_xld (Edges, SelectedXLD, 'contlength', 'and', 15, 99999)
union_adjacent_contours_xld (SelectedXLD, UnionContours, 3, 1, 'attr_keep')
select_shape_xld (UnionContours, Pads, 'contlength', 'and', 100, 99999)
sort_contours_xld (Pads, Sorted...",114,146,"* --- Automatically Added Context ---
read_image (Image, 'die/die_pads_01')
fit_rectangle_to_pads_subpix (ImageReduced, Rectangles, RowPads, ColumnPads, PhiPads, HeightP, WidthP)
Column := ColumnPads[..."
0648372b,micro,5,which is later used for detailed edge extraction,"get_image_size (Image, Width, Height)
threshold (Image, Region, 200, 255)
connection (Region, ConnectedRegions)",147,151,"* --- Automatically Added Context ---
read_image (Image, 'die/die_pads_01')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
0648372b,micro,6,"excluding regions touching the border ('row1','row2','column1'.'column2')","select_shape (ConnectedRegions, SelectedRegions, ['width', 'area', 'row1', 'row2', 'column1', 'column2'], 'and', [24, 650, 1, 0, 1, 0], [40, 950,Height - 1,Height - 2,Width - 1,Width - 2])
fill_up (SelectedRegions, RegionFillUp)
boundary (RegionFillUp, RegionBorder, 'outer')
dilation_rectangle1 (Reg...",152,185,"* --- Automatically Added Context ---
segment_pads_boundary_region (Image, RegionUnion)
get_image_size (Image, Width, Height)
connection (Region, ConnectedRegions)
* --- End of Automatically Added Con..."
0648372b,micro,7,"extend its sides a bit further so that the corners, i.e., the
intersection points, become more appar...","X := [1, 1, -1, -1]
Y := [1, -1, -1, 1]
XExt := X * 1.25
YExt := Y * 1.25",186,194,
0648372b,micro,8,,"if (abs(Phi) &lt; 0.1)
XLabel := [0, 1]
YLabel := [1, 0]
else
XLabel := [1, 0]
YLabel := [0, 1]
endif",195,203,"* --- Automatically Added Context ---
Phi := PhiPads[IndexDispP]
fit_rectangle_to_pads_subpix (ImageReduced, Rectangles, RowPads, ColumnPads, PhiPads, HeightP, WidthP)
for IndexDispP := 0 to |RowPads|..."
0648372b,micro,9,to the size and position of a given pad,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, Length1, Length2, 0, 0, HomMat2DScale)
hom_mat2d_rotate (HomMat2DScale, Phi, 0, 0, HomMat2DRotate)
hom_mat2d_translate (HomMat2DRotate, Column, Row, HomMat2DTranslate)
affine_trans_point_2d (HomMat2DTranslate, X, YExt, Qx1, Qy1...",204,212,"* --- Automatically Added Context ---
Column := ColumnPads[IndexDispP]
Row := RowPads[IndexDispP]
Length1 := HeightP[IndexDispP]
Length2 := WidthP[IndexDispP]
Phi := PhiPads[IndexDispP]
gen_ext_pad_co..."
0648372b,micro,10,,"gen_empty_obj (Lines)
for IndexLines := 0 to |Qx1| - 1 by 1
if (IndexLines % 2)
gen_contour_polygon_xld (ContourLine, [Qy2[IndexLines],Qy2[(IndexLines + 1) % 4]], [Qx2[IndexLines],Qx2[(IndexLines + 1) % 4]])
else
gen_contour_polygon_xld (ContourLine, [Qy1[IndexLines],Qy1[(IndexLines + 1) % 4]], [Qx1...",213,238,"* --- Automatically Added Context ---
gen_ext_pad_contour_xld (Lines, Row, Column, Length1, Length2, Phi, LabelX, LabelY)
affine_trans_point_2d (HomMat2DTranslate, X, YExt, Qx1, Qy1)
affine_trans_poin..."
33c9eee2,full,0,"Pin Measurement: Example for the application of the measure package
including a lot of visualization...","dev_close_window ()
read_image (Image, 'ic_pin')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
*...",9,92,
33c9eee2,micro,1,including a lot of visualization operators,"dev_close_window ()
read_image (Image, 'ic_pin')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
*...",6,98,
7698690f,full,0,"This program shows how the metrology model can be used to
obtain calibrated measurements for various...","AlignmentMode := 'shape-based matching'
* AlignmentMode := 'region processing'
* AlignmentMode := 'rigid transformation'
dev_update_off ()
dev_close_window ()
dev_set_draw ('margin')
gen_empty_obj (EmptyObject)
read_image (Image, 'metal-parts/circle_plate_01')
get_image_size (Image, Width, Height)
d...",22,406,
7698690f,micro,1,,"AlignmentMode := 'shape-based matching'
* AlignmentMode := 'region processing'
* AlignmentMode := 'rigid transformation'",21,25,
7698690f,micro,2,,"dev_update_off ()
dev_close_window ()
dev_set_draw ('margin')
gen_empty_obj (EmptyObject)
read_image (Image, 'metal-parts/circle_plate_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",26,35,
7698690f,micro,3,,"gen_cam_par_area_scan_division (0.0128649, -661.434, 5.30004e-006, 5.3e-006, 620.043, 497.402, Width, Height, CameraParam)",40,41,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
7698690f,micro,4,"calibration plate in the plane of the object to be measured
and by determining its pose.","MeasurementPlane := [0.00940956, -0.00481017, 0.29128, 0.478648, 359.65, 0.785, 0]",42,45,
7698690f,micro,5,,CalibPlateThickness := 0.006,49,50,
7698690f,micro,6,,"PartHeight := 0.005
AdjustThickness := CalibPlateThickness - PartHeight
set_origin_pose (MeasurementPlane, 0, 0, AdjustThickness, MeasurementPlaneAdjusted)",51,55,"* --- Automatically Added Context ---
MeasurementPlane := [0.00940956, -0.00481017, 0.29128, 0.478648, 359.65, 0.785, 0]
CalibPlateThickness := 0.006
* --- End of Automatically Added Context ---"
7698690f,micro,7,calibrated measurements.,create_metrology_model (MetrologyHandle),56,58,
7698690f,micro,8,first call of apply_metrology_model.,"set_metrology_model_image_size (MetrologyHandle, Width, Height)",59,61,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
7698690f,micro,9,,"set_metrology_model_param (MetrologyHandle, 'camera_param', CameraParam)",62,63,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0128649, -661.434, 5.30004e-006, 5.3e-006, 620.043, 497.402, Width, Height, CameraParam)
create_metrology_model (MetrologyHandle..."
7698690f,micro,10,,"set_metrology_model_param (MetrologyHandle, 'plane_pose', MeasurementPlaneAdjusted)",64,66,"* --- Automatically Added Context ---
set_origin_pose (MeasurementPlane, 0, 0, AdjustThickness, MeasurementPlaneAdjusted)
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Cont..."
7698690f,micro,11,,"CircleParam := [354, 274, 53]
CircleParam := [CircleParam,350, 519, 53]
CircleParam := [CircleParam,345, 764, 52]
CircleParam := [CircleParam,596, 523, 53]
add_metrology_object_generic (MetrologyHandle, 'circle', CircleParam, 20, 5, 1, 30, [], [], CircleIndices1)",69,75,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
7698690f,micro,12,,"CircleParam1 := [583, 1010, 79]
CircleParam2 := [336, 1005, 77]
add_metrology_object_generic (MetrologyHandle, 'circle', CircleParam1, 20, 5, 1, 30, ['start_phi', 'end_phi'], [0,rad(185)], CircleIndices2)
add_metrology_object_generic (MetrologyHandle, 'circle', CircleParam2, 20, 5, 1, 30, ['start_ph...",76,82,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
7698690f,micro,13,,"RectangleParam := [599, 279,rad(90),62, 51]
add_metrology_object_generic (MetrologyHandle, 'rectangle2', RectangleParam, 20, 5, 1, 30, [], [], RectIndices)",83,85,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
7698690f,micro,14,,"Line1 := [143, 1122, 709, 1132]
Line2 := [151, 153, 136, 1115]
add_metrology_object_generic (MetrologyHandle, 'line', [Line1,Line2], 20, 5, 1, 30, [], [], LineIndices)",86,89,"* --- Automatically Added Context ---
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
7698690f,micro,15,,"get_metrology_object_model_contour (ModelContour, MetrologyHandle, 'all', 1.5)
get_metrology_object_measures (MeasureContour, MetrologyHandle, 'all', 'all', Row, Column)
Message := 'This example shows how to measure geometric shapes using a'
Message[1] := 'metrology model. As preparation, their roug...",90,98,"* --- Automatically Added Context ---
gen_empty_obj (EmptyObject)
read_image (Image, 'metal-parts/circle_plate_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_metrology_model..."
7698690f,micro,16,,"if (AlignmentMode == 'shape-based matching')
dev_set_part (-Height / 2 - 100, -Width / 2, 1.5 * Height - 100, 1.5 * Width)
threshold (Image, Region, 0, 50)
dilation_rectangle1 (Region, ModelRegion, 7, 7)
reduce_domain (Image, ModelRegion, ImageReduced)
create_generic_shape_model (ShapeModelID)
train...",103,145,"* --- Automatically Added Context ---
AlignmentMode := 'shape-based matching'
gen_empty_obj (EmptyObject)
read_image (Image, 'metal-parts/circle_plate_01')
get_image_size (Image, Width, Height)
dev_op..."
7698690f,micro,17,,"if (AlignmentMode == 'region processing')
threshold (Image, Region, 0, 50)
fill_up (Region, RegionFillUp)
difference (RegionFillUp, Region, OriginalRegion)
area_center (OriginalRegion, Area, RowOrig, ColumnOrig)
orientation_region (OriginalRegion, AngleOrig)
set_metrology_model_param (MetrologyHandl...",146,157,"* --- Automatically Added Context ---
AlignmentMode := 'shape-based matching'
read_image (Image, 'metal-parts/circle_plate_01')
create_metrology_model (MetrologyHandle)
threshold (Image, Region, 0, 50..."
7698690f,micro,18,,"if (AlignmentMode == 'rigid transformation')
extract_reference_points (Image, RowReference, ColumnReference)
gen_cross_contour_xld (ReferencePoints, RowReference, ColumnReference, 15, 0.785398)
dev_display (Image)
dev_set_color ('white')
dev_display (ReferencePoints)
Message := 'To prepare the align...",158,171,"* --- Automatically Added Context ---
AlignmentMode := 'shape-based matching'
read_image (Image, 'metal-parts/circle_plate_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message :=..."
7698690f,micro,19,,"for I := 2 to 5 by 1
read_image (CurrentImage, 'metal-parts/circle_plate_' + I$'02d')
dev_set_line_width (1)
dev_display (CurrentImage)
if (AlignmentMode == 'shape-based matching')
find_generic_shape_model (CurrentImage, ShapeModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result_obj...",172,353,"* --- Automatically Added Context ---
AlignmentMode := 'shape-based matching'
read_image (Image, 'metal-parts/circle_plate_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_pa..."
7698690f,micro,20,,"if (Number &gt; 0)
dev_set_color ('gray')
dev_display (MeasureContour)
endif
count_obj (ShapeModelContours, Number)
if (Number &gt; 0)
dev_set_color ('white')
dev_display (ShapeModelContours)
endif
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowH...",354,390,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_metrology_object_measures (MeasureContour, MetrologyHandle, 'all', 'all', Row, Column)
Message :..."
7698690f,micro,21,identifiable regions.,"threshold (Image, Region, 50, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, Rectangle, 'num_sides', 'and', 3.5, 4.5)
select_shape (ConnectedRegions, Snake, 'area', 'and', 3000, 5000)
select_shape (ConnectedRegions, QuarterCircles, 'area', 'and', 1000, 3000)
union1 (Quart...",391,416,"* --- Automatically Added Context ---
read_image (Image, 'metal-parts/circle_plate_01')
threshold (Image, Region, 0, 50)
project_xy_to_image (XC1, YC1, MeasurementPlaneAdjusted, CameraParam, Row1, Col..."
b9e4059f,full,0,"This example demonstrates how to measure the dimensions of the cells of
a TFT LCD display.
Two facto...","dev_close_window ()
dev_update_off ()
Path := 'lcd/tft_cells'
read_image (Image, Path + '_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_dra...",16,189,
b9e4059f,micro,1,"1. Blue cells are very dark and hard to separate from the background.
Therefore an adaptive segmenta...","dev_close_window ()
dev_update_off ()
Path := 'lcd/tft_cells'
read_image (Image, Path + '_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_dra...",10,166,
b9e4059f,micro,2,,"area_center (InnerRegion, Area, Row, Column)
smallest_rectangle1 (InnerRegion, Row1, Column1, Row2, Column2)
Length1 := 45
Length2 := 20",167,172,"* --- Automatically Added Context ---
smallest_rectangle2 (GreenColumn, Row, Column, Phi, Length1, Length2)
get_window_extents (WindowHandle, Row1, Column1, WindowWidth, WindowHeight)
* --- End of Aut..."
b9e4059f,micro,3,,"get_image_size (Image, Width, Height)
REdgeFirst := []
CEdgeFirst := []
REdgeSecond := []
CEdgeSecond := []
FrameWidth := []
for I := 0 to |Row| - 1 by 1
gen_measure_rectangle2 (Row[I], Column[I], rad(0), Length1, Length2, Width, Height, 'bilinear', MeasureHandle)
measure_pairs (Image, MeasureHandle...",173,204,"* --- Automatically Added Context ---
read_image (Image, Path + '_01')
get_image_size (Image, Width, Height)
for I := 1 to 7 by 1
smallest_rectangle2 (GreenColumn, Row, Column, Phi, Length1, Length2)
..."
5253b3cc,full,0,particle.hdev: Measurement of small particles,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_image (Image, 'particle')
dev_display (Image)
dev_disp_text ('Original image', 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to ...",8,85,
5253b3cc,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_image (Image, 'particle')
dev_display (Image)
dev_disp_text ('Original image', 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to ...",6,17,
5253b3cc,micro,2,,"dilation_circle (Large, LargeDilation, 7.5)
dev_display (Image)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('red')
dev_display (LargeDilation)
dev_set_draw ('fill')
dev_disp_text ('Exclude large areas from processing', 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F...",18,28,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
threshold (Image, Large, 110, 255)
* ---..."
5253b3cc,micro,3,Return the complement of a region,"complement (LargeDilation, NotLarge)
reduce_domain (Image, NotLarge, ParticlesRed)
mean_image (ParticlesRed, Mean, 31, 31)",29,33,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dilation_circle (Large, LargeDilation, 7.5)
* --- End of Automatically Added Context ---"
5253b3cc,micro,4,,"dyn_threshold (ParticlesRed, Mean, SmallRaw, 3, 'light')
opening_circle (SmallRaw, Small, 2.5)
connection (Small, SmallConnection)
dev_display (Image)
dev_set_colored (12)
dev_display (SmallConnection)
dev_disp_text ('Extracted small particles', 'window', 12, 12, 'black', [], [])
dev_disp_text ('Pre...",34,43,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
reduce_domain (Image, NotLarge, Particle..."
5253b3cc,micro,5,,"dev_set_color ('green')
dev_display (Image)
dev_set_draw ('margin')
dev_display (SmallConnection)
Button := 1",44,49,"* --- Automatically Added Context ---
read_image (Image, 'particle')
connection (Small, SmallConnection)
* --- End of Automatically Added Context ---"
5253b3cc,micro,6,,"MaxRow := 450
MaxColumn := 440
MinRow := 40
MinColumn := 100
while (Button == 1)
dev_disp_text (['Select object with left mouse button', 'Right button to quit'], 'window', 12, 12, 'black', 'box_color', '#fce9d4dd')
dev_set_color ('green')
get_mbutton (WindowID, Row, Column, Button)
dev_display (Imag...",50,91,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
read_image (Image, 'particle')
connection (Small, SmallConnection)
Button := 1
* --- End of Automatically Adde..."
02a41b83,full,0,"This example program shows the use of pattern matching
with shape matching to locate an object.
Furt...","dev_update_window ('off')
dev_close_window ()
read_image (Image, 'board/board_01.png')
get_image_size (Image, Width, Height)
ModelRow1 := 450
ModelColumn1 := 470
ModelRow2 := 580
ModelColumn2 := 750
gen_rectangle1 (Rectangle, ModelRow1, ModelColumn1, ModelRow2, ModelColumn2)
area_center (Rectangle, ...",17,281,
02a41b83,micro,1,"find the IC. From the found position and rotation, two
measurement rectangles are constructed to mea...","dev_update_window ('off')
dev_close_window ()
read_image (Image, 'board/board_01.png')
get_image_size (Image, Width, Height)",12,21,
02a41b83,micro,2,,"ModelRow1 := 450
ModelColumn1 := 470
ModelRow2 := 580
ModelColumn2 := 750
gen_rectangle1 (Rectangle, ModelRow1, ModelColumn1, ModelRow2, ModelColumn2)
area_center (Rectangle, Area, ModelAreaRow, ModelAreaColumn)",22,29,
02a41b83,micro,3,"We define their center point relative to the model ROI.
We will later apply the transformation of th...","RectDeltaRow := 160
RectDeltaColumn := 10
RectPhi := 0
RectLength1 := 180
RectLength2 := 10
gen_rectangle2 (Rectangle1, ModelAreaRow - RectDeltaRow, ModelAreaColumn + RectDeltaColumn, RectPhi, RectLength1, RectLength2)
gen_rectangle2 (Rectangle2, ModelAreaRow + RectDeltaRow, ModelAreaColumn + RectDe...",30,41,"* --- Automatically Added Context ---
area_center (Rectangle, Area, ModelAreaRow, ModelAreaColumn)
* --- End of Automatically Added Context ---"
02a41b83,micro,4,,"reduce_domain (Image, Rectangle, ImageModel)
create_generic_shape_model (ModelID)
train_generic_shape_model (ImageModel, ModelID)",42,46,"* --- Automatically Added Context ---
read_image (Image, 'board/board_01.png')
gen_rectangle1 (Rectangle, ModelRow1, ModelColumn1, ModelRow2, ModelColumn2)
* --- End of Automatically Added Context ---"
02a41b83,micro,5,,"disp_regions (Image, Rectangle, Rectangle1, Rectangle2, ModelID, WindowHandle, WindowHandleText)
stop ()
prepare_result_windows (WindowHandle, WindowHandleText, Width, Height)
for I := 2 to 9 by 1
read_image (SearchImage, 'board/board_' + I$'02')
dev_set_window (WindowHandle)
dev_display (SearchImag...",47,124,"* --- Automatically Added Context ---
read_image (Image, 'board/board_01.png')
get_image_size (Image, Width, Height)
gen_rectangle1 (Rectangle, ModelRow1, ModelColumn1, ModelRow2, ModelColumn2)
RectDe..."
02a41b83,micro,6,"As the model has its center at (0,0) it would be only
partially visible within the original image.
E...","get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2 * 1.1, Height / 2 * 1.1, 'black', WindowHandle)
dev_open_window (0, Width / 2 * 1.1 + 10, 400, Height / 2 * 1.1, 'black', WindowHandleText)
dev_set_window (WindowHandle)
dev_set_part (-140, -140, Height * 1.1, Width * 1.1)",125,133,"* --- Automatically Added Context ---
read_image (Image, 'board/board_01.png')
get_image_size (Image, Width, Height)
disp_regions (Image, Rectangle, Rectangle1, Rectangle2, ModelID, WindowHandle, Wind..."
02a41b83,micro,7,,"dev_display (Image)
gen_rectangle1 (ImageBorder, 0, 0, Height, Width)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('white')
dev_display (ImageBorder)",134,140,"* --- Automatically Added Context ---
read_image (Image, 'board/board_01.png')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
02a41b83,micro,8,,"get_generic_shape_model_object (ShapeModel, ModelID, 'contours')
dev_set_color ('yellow')
dev_set_line_width (1)
dev_display (ShapeModel)
area_center (Rectangle, Area, ModelAreaRow, ModelAreaColumn)",141,146,"* --- Automatically Added Context ---
gen_rectangle1 (Rectangle, ModelRow1, ModelColumn1, ModelRow2, ModelColumn2)
area_center (Rectangle, Area, ModelAreaRow, ModelAreaColumn)
create_generic_shape_mod..."
02a41b83,micro,9,,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, ModelAreaRow, ModelAreaColumn, HomMat2DTranslate)
affine_trans_contour_xld (ShapeModel, ShapeModelTrans, HomMat2DTranslate)
dev_set_color ('green')
dev_set_line_width (1)
dev_display (ShapeModelTrans)",147,153,"* --- Automatically Added Context ---
get_generic_shape_model_result_object (ShapeModelTrans, MatchResultID, 'all', 'contours')
area_center (Rectangle, Area, ModelAreaRow, ModelAreaColumn)
get_generic..."
02a41b83,micro,10,,"dev_set_color ('blue')
dev_set_line_width (3)
dev_display (Rectangle1)
dev_display (Rectangle2)
dev_set_window (WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'false', 'false')
Text := 'Displayed are'
Text[|Text|] := '- the shape model (yellow)'
Text[|Text|] := '  which has its ce...",154,203,"* --- Automatically Added Context ---
gen_rectangle2 (Rectangle1, ModelAreaRow - RectDeltaRow, ModelAreaColumn + RectDeltaColumn, RectPhi, RectLength1, RectLength2)
gen_rectangle2 (Rectangle2, ModelAr..."
02a41b83,micro,11,,"dev_set_line_width (1)
dev_set_color ('green')
dev_display (ShapeModel)",204,208,"* --- Automatically Added Context ---
get_generic_shape_model_object (ShapeModel, ModelID, 'contours')
* --- End of Automatically Added Context ---"
02a41b83,micro,12,,"dev_set_color ('blue')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_display (Rectangle1)
dev_display (Rectangle2)",209,214,"* --- Automatically Added Context ---
gen_rectangle2 (Rectangle1, ModelAreaRow - RectDeltaRow, ModelAreaColumn + RectDeltaColumn, RectPhi, RectLength1, RectLength2)
gen_rectangle2 (Rectangle2, ModelAr..."
02a41b83,micro,13,,"dev_set_line_width (1)
return ()",215,240,
02a41b83,micro,14,,"get_generic_shape_model_result (MatchResultID, 'best', 'score', Score)
Text := 'Time Matching '$'-16s' + ((Times[1] - Times[0]) * 1000)$'6.2f' + 'ms'
Text[|Text|] := 'Time Measure '$'-16s' + ((Times[3] - Times[2]) * 1000)$'6.2f' + 'ms'
Text[|Text|] := 'Num. leads: '$'-17s' + NumLeads$'2d'
Text[|Text...",241,292,"* --- Automatically Added Context ---
disp_regions (Image, Rectangle, Rectangle1, Rectangle2, ModelID, WindowHandle, WindowHandleText)
find_generic_shape_model (SearchImage, ModelID, MatchResultID, Nu..."
9f569dab,full,0,"Inspection of rim &amp; tire
The circular holes are extracted as well as the region containing
the i...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 768, 576, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
read_image (Rim, 'rim')
dev_display (Rim)
disp_continue_message (WindowID, 'black', 'true')
stop ()
threshold (Rim, Dark, 0, 128)
dev_display (Rim)
dev_s...",11,173,
9f569dab,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 768, 576, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
read_image (Rim, 'rim')
dev_display (Rim)
disp_continue_message (WindowID, 'black', 'true')
stop ()",10,18,
9f569dab,micro,2,,"threshold (Rim, Dark, 0, 128)
dev_display (Rim)
dev_set_color ('green')
dev_set_draw ('fill')
dev_display (Dark)
disp_continue_message (WindowID, 'black', 'true')
stop ()",19,26,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
* --- End of Automatically Added Context ---"
9f569dab,micro,3,,"connection (Dark, DarkRegions)",27,28,"* --- Automatically Added Context ---
threshold (Rim, Dark, 0, 128)
* --- End of Automatically Added Context ---"
9f569dab,micro,4,,"select_shape (DarkRegions, Circles, ['circularity', 'area'], 'and', [0.85, 50], [1.0, 99999])
dev_display (Rim)
dev_set_colored (12)
dev_display (Circles)
disp_continue_message (WindowID, 'black', 'true')
stop ()",29,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
connection (Dark, DarkRegions)
* --- End of Automatically Added Context ---"
9f569dab,micro,5,use dilation and erosion.,"dilation_circle (Circles, ROIOuter, 8.5)
erosion_circle (Circles, ROIInner, 8.5)
difference (ROIOuter, ROIInner, ROI)
union1 (ROI, ROIEdges)
dev_display (Rim)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (ROIEdges)
disp_continue_message (WindowID, 'black', 'true...",36,48,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
select_shape (DarkRegions, Circles, ['circularity', 'area'], 'and', [0.85, 50], [1.0, ..."
9f569dab,micro,6,regions containing the edges.,"reduce_domain (Rim, ROIEdges, RimReduced)",49,51,"* --- Automatically Added Context ---
read_image (Rim, 'rim')
union1 (ROI, ROIEdges)
* --- End of Automatically Added Context ---"
9f569dab,micro,7,,"edges_sub_pix (RimReduced, Edges, 'canny', 4, 20, 40)",52,53,"* --- Automatically Added Context ---
reduce_domain (Rim, ROIEdges, RimReduced)
* --- End of Automatically Added Context ---"
9f569dab,micro,8,,"select_contours_xld (Edges, RelEdges, 'contour_length', 30, 999999, 0, 0)
dev_display (Rim)
dev_set_colored (12)
dev_display (RelEdges)
disp_continue_message (WindowID, 'black', 'true')
stop ()",54,60,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
edges_sub_pix (RimReduced, Edges, 'canny', 4, 20, 40)
* --- End of Automatically Added..."
9f569dab,micro,9,,"fit_ellipse_contour_xld (RelEdges, 'ftukey', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Ra, Rb, StartPhi, EndPhi, PointOrder)
display_ellipses (Rim, Row, Column, Phi, Ra, Rb, WindowID)
disp_continue_message (WindowID, 'black', 'true')
stop ()",61,65,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
select_contours_xld (Edges, RelEdges, 'contour_length', 30, 999999, 0, 0)
* --- End of..."
9f569dab,micro,10,Extract small regions with low gray value.,"gauss_filter (Rim, RimGauss, 11)
dyn_threshold (Rim, RimGauss, SmallAndDarkerRegion, 5, 'dark')
dev_display (Rim)
dev_set_draw ('fill')
dev_set_color ('green')
dev_display (SmallAndDarkerRegion)
disp_continue_message (WindowID, 'black', 'true')
stop ()",66,75,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
* --- End of Automatically Added Context ---"
9f569dab,micro,11,,"connection (SmallAndDarkerRegion, SmallAndDarker)",76,77,"* --- Automatically Added Context ---
dyn_threshold (Rim, RimGauss, SmallAndDarkerRegion, 5, 'dark')
* --- End of Automatically Added Context ---"
9f569dab,micro,12,,"select_shape (SmallAndDarker, CharCandidates, 'area', 'and', 40, 400)",78,79,"* --- Automatically Added Context ---
connection (SmallAndDarkerRegion, SmallAndDarker)
* --- End of Automatically Added Context ---"
9f569dab,micro,13,a given elliptic region.,"select_shape (CharCandidates, PossibleChar, ['ra', 'rb'], 'and', [10, 5], [20, 30])
dev_display (Rim)
dev_set_colored (12)
dev_display (PossibleChar)
disp_continue_message (WindowID, 'black', 'true')
stop ()",80,87,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
select_shape (SmallAndDarker, CharCandidates, 'area', 'and', 40, 400)
* --- End of Aut..."
9f569dab,micro,14,,"union1 (PossibleChar, ROI)
closing_circle (ROI, CharRegion, 17.5)
connection (CharRegion, CharBlocks)
dev_display (Rim)
dev_set_draw ('margin')
dev_display (CharBlocks)
disp_continue_message (WindowID, 'black', 'true')
stop ()",88,96,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
difference (ROIOuter, ROIInner, ROI)
select_shape (CharCandidates, PossibleChar, ['ra'..."
9f569dab,micro,15,,"select_shape (CharBlocks, CharRegion, 'area', 'and', 400, 99999)",97,98,"* --- Automatically Added Context ---
closing_circle (ROI, CharRegion, 17.5)
connection (CharRegion, CharBlocks)
* --- End of Automatically Added Context ---"
9f569dab,micro,16,,"shape_trans (CharRegion, ROIChar, 'rectangle2')
dev_display (Rim)
dev_set_color ('green')
dev_display (ROIChar)
disp_continue_message (WindowID, 'black', 'true')
stop ()
dev_set_colored (12)
display_ellipses (Rim, Row, Column, Phi, Ra, Rb, WindowID)",99,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
read_image (Rim, 'rim')
fit_ellipse_contour_xld (RelEdges, 'ftukey', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Ra..."
9f569dab,micro,17,that lie in the extracted rectangle region.,"intersection (CharCandidates, ROIChar, Characters)",108,110,"* --- Automatically Added Context ---
select_shape (SmallAndDarker, CharCandidates, 'area', 'and', 40, 400)
shape_trans (CharRegion, ROIChar, 'rectangle2')
* --- End of Automatically Added Context ---"
9f569dab,micro,18,,"dev_set_colored (12)
dev_display (Characters)",111,113,"* --- Automatically Added Context ---
intersection (CharCandidates, ROIChar, Characters)
* --- End of Automatically Added Context ---"
9f569dab,micro,19,,"smallest_rectangle2 (ROIChar, RowChar, ColumnChar, PhiChar, Length1Char, Length2Char)",114,115,"* --- Automatically Added Context ---
shape_trans (CharRegion, ROIChar, 'rectangle2')
* --- End of Automatically Added Context ---"
9f569dab,micro,20,,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(180) - PhiChar, RowChar, ColumnChar, HomMat2DRotate)
affine_trans_region (Characters, CharRotated, HomMat2DRotate, 'constant')
affine_trans_image (Rim, RimRotated, HomMat2DRotate, 'weighted', 'false')
dev_open_window (0, 8...",116,121,"* --- Automatically Added Context ---
read_image (Rim, 'rim')
intersection (CharCandidates, ROIChar, Characters)
smallest_rectangle2 (ROIChar, RowChar, ColumnChar, PhiChar, Length1Char, Length2Char)
*..."
9f569dab,micro,21,,"union1 (CharRotated, CharRotatedAll)
smallest_rectangle1 (CharRotatedAll, Row1, Column1, Row2, Column2)
ZoomHeight := Row2 - Row1 + 1
ZoomWidth := Column2 - Column1 + 1
ZoomFactor := min([768 / ZoomWidth,576 / ZoomHeight])
ZoomRow := (Row1 + Row2) / 2
ZoomColumn := (Column1 + Column2) / 2
dev_set_pa...",122,157,"* --- Automatically Added Context ---
read_image (Rim, 'rim')
affine_trans_region (Characters, CharRotated, HomMat2DRotate, 'constant')
affine_trans_image (Rim, RimRotated, HomMat2DRotate, 'weighted',..."
9f569dab,micro,22,,"gen_ellipse_contour_xld (Ellipse, Row, Column, Phi, Ra, Rb, gen_tuple_const(|Row|,0), gen_tuple_const(|Row|,6.28318), gen_tuple_const(|Row|,'positive'), 1.5)
dev_display (Ellipse)
gen_arrow_contour_xld (Arrow1, Row - Ra * sin(Phi), Column + Ra * cos(Phi), Row + Ra * sin(Phi), Column - Ra * cos(Phi),...",158,169,"* --- Automatically Added Context ---
fit_ellipse_contour_xld (RelEdges, 'ftukey', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Ra, Rb, StartPhi, EndPhi, PointOrder)
* --- End of Automatically Added Context..."
9f569dab,micro,23,,"Diameter := 2 * Ra
disp_message (WindowID, 'd: ' + Diameter$'.4', 'window', Row - (Ra * 1.5), Column - 70, 'yellow', 'false')
return ()",170,187,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowID)
fit_ellipse_contour_xld (RelEdges, 'ftukey', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Ra, Rb, StartPhi, EndPhi, ..."
3e03e1bb,full,0,"During the bonding process every pad on a chip gets connected
to the pins on the lead frame using th...","dev_update_off ()
dev_close_window ()
Path := 'bonds/ball_bond_lead_frame_'
read_image (Image, Path + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_empty_region', StoreEmptyR...",13,108,
3e03e1bb,micro,1,"to the pins on the lead frame using thin wires (of gold).
To make sure the process was successful, e...","dev_update_off ()
dev_close_window ()
Path := 'bonds/ball_bond_lead_frame_'
read_image (Image, Path + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
get_system ('store_empty_region', StoreEmptyR...",6,116,
e85002dd,full,0,"This example demonstrates the optical inspection after a
wedge-bonding process on a chip. First the ...","dev_update_off ()
dev_set_draw ('margin')
gen_rectangle2_contour_xld (OuterRectangle, 0, 0, 0, 77, 77)
gen_rectangle2_contour_xld (InnerRectangle, 0, 0, 0, 67.5, 67.5)
concat_obj (InnerRectangle, OuterRectangle, ModelContours)
create_shape_model_xld (ModelContours, 3, 0, 0, 'auto', 'auto', 'ignore_l...",14,386,
e85002dd,micro,1,"wedge-bonding process on a chip. First the pads and wires are
extracted. Being able to narrow down t...","dev_update_off ()
dev_set_draw ('margin')",7,16,
e85002dd,micro,2,,"gen_rectangle2_contour_xld (OuterRectangle, 0, 0, 0, 77, 77)
gen_rectangle2_contour_xld (InnerRectangle, 0, 0, 0, 67.5, 67.5)
concat_obj (InnerRectangle, OuterRectangle, ModelContours)
create_shape_model_xld (ModelContours, 3, 0, 0, 'auto', 'auto', 'ignore_local_polarity', 5, PadModelID)
read_image ...",17,395,
b1ef0b63,full,0,"This program shows how to iteratively track wire bondings.
It assumes that the following values are ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'die/die_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)
W...",14,483,
b1ef0b63,micro,1,"1. Coordinates of the start and end points corresponding to the bond sites
2. Angle with which the w...","dev_update_off ()
dev_close_window ()
read_image (Image, 'die/die_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)",9,23,
b1ef0b63,micro,2,Approximated half-widths of wires in image,"WireWidths := [1.8, 0, 0, 8, 6, 1.7, 7.5]",24,26,
b1ef0b63,micro,3,,MinSegmentLength := 5,27,28,
b1ef0b63,micro,4,,AngleTolerance := rad(35),29,30,
b1ef0b63,micro,5,,"MinSearchRadius := 10
MinWireDeviation := 5",31,33,
b1ef0b63,micro,6,"that the tracking algorithm must reach to
consider the tracking as successful","AcceptanceRadius := 5
MinWireLength := 80",34,38,
b1ef0b63,micro,7,,"for Img := 1 to 7 by 1
try
read_tuple ('die_' + Img$'02' + '_params.tup', Parameters)
catch (Exception)
continue
endtry
NPads := Parameters[0]
StartPadRows := Parameters[1:NPads]
StartPadCols := Parameters[NPads + 1:2 * NPads]
StartInitOrientation := Parameters[2 * NPads + 1:3 * NPads]
EndPadRows :=...",39,203,"* --- Automatically Added Context ---
read_image (Image, 'die/die_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
WireWidths := [1.8, 0, 0, 8, 6, 1.7, 7.5]
MinSegmentLength := 5
Angl..."
b1ef0b63,micro,8,"the higher are the chances that those segments actually correspond to a
wire and, therefore, we deci...","length_xld (Segments, Lengths)
MaxDistAbs := max(Lengths)
MaxDistRel := max(Lengths) / min(Lengths)
union_collinear_contours_ext_xld (Segments, UnionContours, MaxDistAbs, MaxDistRel, 2, MaxAngle, 0, -1, 1, 1, 1, 1, 1, 0, 'attr_keep')
Iter := 0
length_xld (UnionContours, Lengths)
while (Iter &lt; Max...",208,260,"* --- Automatically Added Context ---
length_xld (UnionContours, MaxLength)
* --- End of Automatically Added Context ---"
b1ef0b63,micro,9,and define it as the new starting search point for the next iteration,"get_contour_xld (WireSegment, Row, Col)
EndPointsRow := [Row[0],Row[|Row| - 1]]
EndPointsCol := [Col[0],Col[|Col| - 1]]
distance_pp (EndPointsRow, EndPointsCol, [StartPointRowOut,StartPointRowOut], [StartPointColOut,StartPointColOut], Distance)
if (Distance[0] &gt; Distance[1])
StartPointRowOut := E...",261,274,"* --- Automatically Added Context ---
get_contour_xld (ObjectSelected, Row, Column)
get_contour_attrib_xld (ContourOut, 'distance', Distance)
StartPointColOut := StartPointCol
StartPointRowOut := Star..."
b1ef0b63,micro,10,"angle for the next iteration. The underlying idea is that the wire bends
smoothly (little) from one ...","orientation_points_xld (WireSegment, Orientation)
OrientationDiffAbs := fabs(fmod(Orientation - RefOrientation,rad(360)))
if (OrientationDiffAbs &gt; rad(90) and OrientationDiffAbs &lt; rad(270))
Orientation := Orientation + rad(180)
endif
while (Orientation &lt; -rad(180))
Orientation := Orientatio...",275,290,"* --- Automatically Added Context ---
RefOrientationOut := RefOrientation
get_contour_xld (WireSegment, Row, Col)
* --- End of Automatically Added Context ---"
b1ef0b63,micro,11,"current segment: the longer the contour, the larger the radius. The idea
thereby is that long segmen...","length_xld (WireSegment, SearchRadius)
SearchRadius := 1.5 * max([SearchRadius,MinSearchRadius])
DistSegmentThreshold := min([SearchRadius / 2.0,MaxDistSegment])
return ()
gen_empty_obj (Wire)
get_image_size (Image, Width, Height)",291,339,"* --- Automatically Added Context ---
read_image (Image, 'die/die_01')
get_image_size (Image, Width, Height)
WireWidths := [1.8, 0, 0, 8, 6, 1.7, 7.5]
MinSearchRadius := 10
MaxDistSegment := 17 * Wire..."
b1ef0b63,micro,12,,"StartPointRow := StartPadRows
StartPointCol := StartPadCols",340,342,"* --- Automatically Added Context ---
StartPadRows := Parameters[1:NPads]
StartPadCols := Parameters[NPads + 1:2 * NPads]
read_tuple ('die_' + Img$'02' + '_params.tup', Parameters)
NPads := Parameters..."
b1ef0b63,micro,13,"the search in the next iteration. The idea is that the curvature of the
wire does not change much fr...",RefOrientation := StartInitOrientation,343,346,"* --- Automatically Added Context ---
StartInitOrientation := Parameters[2 * NPads + 1:3 * NPads]
read_tuple ('die_' + Img$'02' + '_params.tup', Parameters)
NPads := Parameters[0]
* --- End of Automat..."
b1ef0b63,micro,14,,"SearchRadius := 30 * WireWidths
MinSearchRadius := 5 * WireWidths
DistSegmentThreshold := min([SearchRadius / 3.0,MaxDistSegment])
while (1)
distance_pp (StartPointRow, StartPointCol, EndPadRows, EndPadCols, Distance)
gen_search_region (SearchRegion, StartPointRow, StartPointCol, RefOrientation, min...",347,499,"* --- Automatically Added Context ---
read_image (Image, 'die/die_01')
WireWidths := [1.8, 0, 0, 8, 6, 1.7, 7.5]
MinSegmentLength := 5
AngleTolerance := rad(35)
MinSearchRadius := 10
MinWireDeviation ..."
536d97de,full,0,vessel.hdev: Segmentation &amp; Measurement of a blood vessel,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_image (Image, 'vessel')
dev_display (Image)
disp_continue_message (WindowID, 'black', 'true')
stop ()
dev_set_draw ('fill')
dev_set_color ('...",8,75,
536d97de,micro,1,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_image (Image, 'vessel')
dev_display (Image)
disp_continue_message (WindowID, 'black', 'true')
stop ()
dev_set_draw ('fill')
dev_set_color ('...",6,41,
536d97de,micro,2,,"Diameter := []
dev_set_color ('red')
dev_update_var ('off')
dev_update_time ('off')
dev_update_pc ('off')
for i := 2 to 509 by 1
gen_region_line (ScanLine, UpperRow, i, LowerRow, i)
dev_display (ScanLine)
intersection (Boundaries, ScanLine, BoundaryPoints)
get_region_points (BoundaryPoints, Rows, Co...",42,60,"* --- Automatically Added Context ---
clip_region (VesselBoundary, Boundaries, 0, 2, 511, 509)
smallest_rectangle1 (Boundaries, UpperRow, Column1, LowerRow, Column2)
* --- End of Automatically Added C..."
536d97de,micro,3,,"meanDiameter := sum(Diameter) / |Diameter|
minDiameter := min(Diameter)
dev_set_color ('green')
dev_display (Image)
dev_display (Boundaries)
dev_set_color ('yellow')
get_image_size (Image, Width, Height)
get_string_extents (WindowID, 'meanDiam: ' + meanDiameter + ', minDiameter: ' + minDiameter, Asc...",61,81,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
read_image (Image, 'vessel')
clip_region (VesselBoundary, Boundaries, 0, 2, 511, 509)
smallest_rectangle1 (Bou..."
6cc38960,full,0,Initialize the program,"dev_close_window ()
dev_open_window (0, 0, 768, 576, 'black', WindowHandle)
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
CalTabDescrFile := 'caltab_big.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000086, 0.00000...",8,180,
6cc38960,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 768, 576, 'black', WindowHandle)
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",7,14,
6cc38960,micro,2,,"CalTabDescrFile := 'caltab_big.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000086, 0.0000086, 384, 288, 768, 576, StartCamPar)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, C...",15,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
6cc38960,micro,3,,"for I := 1 to NumImages by 1
read_image (Image, 'calib/calib-3d-coord-' + I$'02d')
get_measure_positions (Image, PlateRegion, CalibDataID, I, Distance, Phi, RowCenter, ColumnCenter)
gen_rectangle2_contour_xld (Rectangle, RowCenter, ColumnCenter, Phi, Distance * 0.52, 8)
gen_measure_rectangle2 (RowCe...",44,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768, 576, 'black', WindowHandle)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
NumImages := 10
for I := 1 to NumImages by 1
r..."
6cc38960,micro,4,,"threshold (Image, Region, 0, 120)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, ['holes_num', 'rect2_len1', 'rect2_len2'], 'and', [1, 120, 120], [1, 200, 200])
fill_up (SelectedRegions, PlateRegion)",143,147,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib-3d-coord-' + I$'02d')
get_measure_positions (Image, PlateRegion, CalibDataID, I, Distance, Phi, RowCenter, ColumnCenter)
* --- End..."
6cc38960,micro,5,,"gen_contour_region_xld (PlateRegion, Contours, 'center')
segment_contours_xld (Contours, ContoursSplit, 'lines', 7, 4, 2)
regress_contours_xld (ContoursSplit, RegressContours, 'no', 1)
select_contours_xld (RegressContours, VerticalContours, 'direction', rad(45), rad(135), -0.5, 0.5)
select_contours_...",148,153,"* --- Automatically Added Context ---
get_calib_data_observ_contours (Contours, CalibDataID, 'caltab', 0, 0, I - 1)
get_measure_positions (Image, PlateRegion, CalibDataID, I, Distance, Phi, RowCenter,..."
6cc38960,micro,6,two vertical border lines of the table.,"select_obj (LongContours, Contour, 1)
get_contour_xld (Contour, Rows, Columns)
RowBegin1 := Rows[0]
ColBegin1 := Columns[0]
RowEnd1 := Rows[|Rows| - 1]
ColEnd1 := Columns[|Columns| - 1]
select_obj (LongContours, Contour, 2)
get_contour_xld (Contour, Rows, Columns)
RowBegin2 := Rows[0]
ColBegin2 := C...",154,167,"* --- Automatically Added Context ---
Rows := [RowEdge[0],RowEdge[|RowEdge| - 1]]
Columns := [ColumnEdge[0],ColumnEdge[|RowEdge| - 1]]
measure_pos (Image, MeasureHandle, 1, 40, 'all', 'all', RowEdge, ..."
6cc38960,micro,7,,"get_calib_data_observ_points (CalibDataID, 0, 0, PoseIndex - 1, Row, Column, PoseIndex, _Pose)
Row1 := Row[find(PoseIndex,21)]
Row2 := Row[find(PoseIndex,27)]
Column1 := Column[find(PoseIndex,21)]
Column2 := Column[find(PoseIndex,27)]
intersection_lines (Row1, Column1, Row2, Column2, RowBegin1, ColB...",168,195,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
get_calib_data_observ_points (CalibDataID, 0, 0, I - 1, Row, Column, Index, Pose)
get_measure_position..."
60a25d3f,full,0,"This program demonstrates how to perform the calibration
of a sheet-of-light measurement system.
The...","dev_update_off ()
dev_close_window ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001.png')
get_image_size (ProfileImage, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('lime green')
dev_set_lut (...",33,547,
60a25d3f,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001.png')
get_image_size (ProfileImage, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('lime green')
dev_set_lut (...",32,44,
60a25d3f,micro,2,,"gen_cam_par_area_scan_polynomial (0.0125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.000006, 0.000006, 376.0, 120.0, 752, 240, StartParameters)
CalTabDescription := 'caltab_30mm.descr'",48,50,
60a25d3f,micro,3,"If you adapt this example program to your application, it is necessary to determine
the thickness of...","CalTabThickness := .00063
NumCalibImages := 20",51,56,
60a25d3f,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartParameters)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescription)",57,62,"* --- Automatically Added Context ---
gen_cam_par_area_scan_polynomial (0.0125, 0.0, 0.0, 0.0, 0.0, 0.0, 0.000006, 0.000006, 376.0, 120.0, 752, 240, StartParameters)
CalTabDescription := 'caltab_30mm...."
60a25d3f,micro,5,,"dev_display (Image)
find_calib_object (Image, CalibDataID, 0, 0, Index, [], [])
get_calib_data_observ_points (CalibDataID, 0, 0, Index, Row, Column, _Index, Pose)
get_calib_data_observ_contours (Contours, CalibDataID, 'caltab', 0, 0, Index)
dev_set_color ('green')
dev_display (Contours)
gen_cross_co...",63,83,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ..."
60a25d3f,micro,6,"with respect to the world coordinate system
-------","dev_set_colored (3)
MinThreshold := 80",84,89,
60a25d3f,micro,7,"Here, the WCS is defined implicitly by choosing one
specific calibration image. In order to take the...","Index := 19
get_calib_data (CalibDataID, 'calib_obj_pose', [0,Index], 'pose', CalTabPose)
set_origin_pose (CalTabPose, 0.0, 0.0, CalTabThickness, CameraPose)
read_image (CalTabImage1, 'sheet_of_light/connection_rod_calib_' + Index$'.2')
dev_display (CalTabImage1)
get_calib_data (CalibDataID, 'camera...",90,106,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
CalTabThickness := .00063
create_calib_data ('calibration_object', 1, 1, CalibDataID)
find_calib_obje..."
60a25d3f,micro,8,"The TCS is also defined implicitly by choosing another
calibration image. Here again we shift the or...","Index := 20
get_calib_data (CalibDataID, 'calib_obj_pose', [0,Index], 'pose', CalTabPose)
set_origin_pose (CalTabPose, 0.0, 0.0, CalTabThickness, TmpCameraPose)
read_image (CalTabImage2, 'sheet_of_light/connection_rod_calib_' + Index$'.2')
dev_display (CalTabImage2)
dev_disp_3d_coord_system (WindowH...",107,122,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
CalTabThickness := .00063
create_calib_data ('calibration_object', 1, 1, CalibDataID)
find_calib_obje..."
60a25d3f,micro,9,in the plane z=0 of the WCS,"dev_clear_window ()
read_image (ProfileImage1, 'sheet_of_light/connection_rod_lightline_019.png')
compute_3d_coordinates_of_light_line (ProfileImage1, MinThreshold, CameraParameters, [], CameraPose, X19, Y19, Z19)
if (|X19| == 0 or |Y19| == 0 or |Z19| == 0)
dev_display (ProfileImage1)
disp_message (...",123,133,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'The camera calibration has been performed successfully', 'window', 12, 1..."
60a25d3f,micro,10,in the plane z=0 of the TCS,"read_image (ProfileImage2, 'sheet_of_light/connection_rod_lightline_020.png')
compute_3d_coordinates_of_light_line (ProfileImage2, MinThreshold, CameraParameters, TmpCameraPose, CameraPose, X20, Y20, Z20)
if (|X20| == 0 or |Y20| == 0 or |Z20| == 0)
disp_message (WindowHandle, 'The profile MUST be or...",134,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'The camera calibration has been performed successfully', 'window', 12, 1..."
60a25d3f,micro,11,"points computed previously. Note that this requires
nearly coplanar points. We must provide line poi...","fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
if (|Nx| == 0 or |Ny| == 0 or |Nz| == 0)
disp_message (WindowHandle, 'Too few 3d points have been provided to fit the light plane,\nor the points are (nearly) collinear!\nThe program will exit.', 'window', 12, 1...",143,159,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'The camera calibration has been performed successfully', 'window', 12, 1..."
60a25d3f,micro,12,"such that the plane defined by z=0 coincides with the
light plane.","get_light_plane_pose (Ox, Oy, Oz, Nx, Ny, Nz, LightPlanePose)
if (|LightPlanePose| != 7)
disp_message (WindowHandle, 'The pose of the light plane could not be\ndetermined. Please verify that the vector\npassed at input of the procedure\nget_light_plane_pose() is not null.\nThe program will exit!', '...",160,175,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'The camera calibration has been performed successfully', 'window', 12, 1..."
60a25d3f,micro,13,"two successive profile images, we acquire two images of a
calibration table which describe the same ...","read_image (CaltabImagePos1, 'sheet_of_light/caltab_at_position_1.png')
read_image (CaltabImagePos20, 'sheet_of_light/caltab_at_position_2.png')
StepNumber := 19",180,188,
60a25d3f,micro,14,"calibration data model to extract the following poses using
these calibrated parameters.","set_calib_data_cam_param (CalibDataID, 0, [], CameraParameters)",189,192,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParameters)
* --- End of Automatically Added..."
60a25d3f,micro,15,,"find_calib_object (CaltabImagePos1, CalibDataID, 0, 0, NumCalibImages + 1, [], [])",193,194,"* --- Automatically Added Context ---
NumCalibImages := 20
create_calib_data ('calibration_object', 1, 1, CalibDataID)
read_image (CaltabImagePos1, 'sheet_of_light/caltab_at_position_1.png')
* --- End..."
60a25d3f,micro,16,,"get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages + 1, Row1, Column1, Index1, CameraPosePos1)
find_calib_object (CaltabImagePos20, CalibDataID, 0, 0, NumCalibImages + 2, [], [])
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages + 2, Row1, Column1, Index1, CameraPosePos20)",195,199,"* --- Automatically Added Context ---
NumCalibImages := 20
create_calib_data ('calibration_object', 1, 1, CalibDataID)
read_image (CaltabImagePos20, 'sheet_of_light/caltab_at_position_2.png')
* --- En..."
60a25d3f,micro,17,"table in the two positions with respect to the world
coordinate system and determine the coordinates...","set_origin_pose (CameraPosePos1, 0.0, 0.0, CalTabThickness, CameraPosePos1)
set_origin_pose (CameraPosePos20, 0.0, 0.0, CalTabThickness, CameraPosePos20)
pose_to_hom_mat3d (CameraPosePos1, HomMat3DPos1ToCamera)
pose_to_hom_mat3d (CameraPosePos20, HomMat3DPos20ToCamera)
pose_to_hom_mat3d (CameraPose,...",200,222,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
CalTabThickness := .00063
set_origin_pose (CalTabPose, 0.0, 0.0, CalTabThickness, CameraPose)
String ..."
60a25d3f,micro,18,,"read_image (Disparity, 'sheet_of_light/connection_rod_disparity.tif')",227,228,
60a25d3f,micro,19,,"gen_rectangle1 (ProfileRegion, 120, 75, 195, 710)
create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles', 'ambiguity_solving'], [70, 290, 'first'], SheetOfLightModelID)
set_sheet_of_light_param (SheetOfLightModelID, 'calibration', 'xyz')
set_sheet_of_light_param (SheetOfLightModelID...",229,237,"* --- Automatically Added Context ---
set_origin_pose (CalTabPose, 0.0, 0.0, CalTabThickness, CameraPose)
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParameters)
get_light_plane_pose (Ox..."
60a25d3f,micro,20,get the resulting calibrated coordinates,"apply_sheet_of_light_calibration (Disparity, SheetOfLightModelID)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_sheet_of_light_result (Z, SheetOfLightModelID, 'z')",238,244,"* --- Automatically Added Context ---
read_image (Disparity, 'sheet_of_light/connection_rod_disparity.tif')
create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles', 'ambiguity_solving'..."
60a25d3f,micro,21,,"dev_close_window ()
get_image_size (Disparity, Width, Height)
dev_open_window (Height + 10, 0, Width * .5, Height * .5, 'black', WindowHandle3)
set_display_font (WindowHandle3, 14, 'mono', 'true', 'false')
dev_set_lut ('temperature')
dev_display (Z)
disp_message (WindowHandle3, 'Calibrated Z-coordin...",245,253,"* --- Automatically Added Context ---
get_image_size (ProfileImage, Width, Height)
read_image (Disparity, 'sheet_of_light/connection_rod_disparity.tif')
get_sheet_of_light_result (Z, SheetOfLightModel..."
60a25d3f,micro,22,,"dev_open_window ((Height + 10) * .5, 0, Width * .5, Height * .5, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_display (Y)
disp_message (WindowHandle2, 'Calibrated Y-coordinates', 'window', 12, 12, 'black', 'true')",254,259,"* --- Automatically Added Context ---
get_image_size (ProfileImage, Width, Height)
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
disp_message (WindowHandle3, 'Calibrated Z-coordinates', 'win..."
60a25d3f,micro,23,,"dev_open_window (0, 0, Width * .5, Height * .5, 'black', WindowHandle1)
dev_display (X)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
disp_message (WindowHandle1, 'Calibrated X-coordinates', 'window', 12, 12, 'black', 'true')",260,266,"* --- Automatically Added Context ---
get_image_size (ProfileImage, Width, Height)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
disp_message (WindowHandle3, 'Calibrated Z-coordinates', 'win..."
60a25d3f,micro,24,Note that the camera observes that part of the plane which the object traverses,"get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, ObjectModel3D)
gen_sheet_of_light_object_model_3d (SheetOfLightModelID, 0.1, 0.05, 0.3, OM3DLightPlane, OM3DMovement, OM3DCamera, OM3DCone)
dev_open_window (0, Width * .5 + 10, Width, Height * 1.5, 'black', WindowHandle)
dev_set_lut ('d...",267,297,"* --- Automatically Added Context ---
get_image_size (ProfileImage, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_sheet_of_light_model (ProfileRegion, ['min_gray',..."
60a25d3f,micro,25,,"X := []
Y := []
Z := []",313,317,"* --- Automatically Added Context ---
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_sheet_of_light_result (Z, SheetOfLightModelID,..."
60a25d3f,micro,26,"has to be applied after the projection from the camera to
the z=0 plane","if (LocalCameraPose == [])
DoTransform := 0
LocalCameraPose := ReferenceCameraPose
elseif (LocalCameraPose == ReferenceCameraPose)
DoTransform := 0
else
DoTransform := 1
endif",318,330,
60a25d3f,micro,27,local coordinate system to the plane z=0,"pose_to_hom_mat3d (LocalCameraPose, HomMat3D_LocalToCam)",331,334,"* --- Automatically Added Context ---
if (LocalCameraPose == [])
* --- End of Automatically Added Context ---"
60a25d3f,micro,28,"of points from the local coordinate system to the reference
coordinate system","if (DoTransform)
pose_to_hom_mat3d (ReferenceCameraPose, HomMat3D_ReferenceToCam)
hom_mat3d_invert (HomMat3D_ReferenceToCam, HomMat3D_CamToReference)
hom_mat3d_compose (HomMat3D_CamToReference, HomMat3D_LocalToCam, HomMat3D_LocalToReference)
endif",335,343,"* --- Automatically Added Context ---
DoTransform := 0
elseif (LocalCameraPose == ReferenceCameraPose)
pose_to_hom_mat3d (LocalCameraPose, HomMat3D_LocalToCam)
* --- End of Automatically Added Context..."
60a25d3f,micro,29,oriented roughly horizontal,"threshold (ProfileImage, Region, MinGray, 999999999)
orientation_region (Region, Phi)
if (cos(Phi) &gt; cos(rad(135)) and cos(Phi) &lt; cos(rad(45)))
return ()
endif
dilation_circle (Region, RegionDilation, 5.5)
smallest_rectangle1 (RegionDilation, Row1, Column1, Row2, Column2)
gen_rectangle1 (Profi...",344,358,"* --- Automatically Added Context ---
read_image (ProfileImage, 'sheet_of_light/connection_rod_001.png')
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages + 1, Row1, Column1, Index1, Cam..."
60a25d3f,micro,30,,"create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles'], [MinGray,1], SheetOfLightHandle)
measure_profile_sheet_of_light (ProfileImage, SheetOfLightHandle, [])
get_sheet_of_light_result (Disparity, SheetOfLightHandle, 'disparity')",359,363,"* --- Automatically Added Context ---
read_image (ProfileImage, 'sheet_of_light/connection_rod_001.png')
read_image (Disparity, 'sheet_of_light/connection_rod_disparity.tif')
gen_rectangle1 (ProfileRe..."
60a25d3f,micro,31,in the coordinate system defined by ReferenceCameraPose,"get_domain (Disparity, DisparityDomain)
get_region_points (DisparityDomain, Rows, Columns)
get_grayval (Disparity, Rows, Columns, Disparities)",364,369,"* --- Automatically Added Context ---
read_image (Disparity, 'sheet_of_light/connection_rod_disparity.tif')
* --- End of Automatically Added Context ---"
60a25d3f,micro,32,,"image_points_to_world_plane (CameraParameters, LocalCameraPose, Disparities, Columns + Column1, 1.0, X, Y)
tuple_gen_const (|Columns|, 0.0, Z)",370,373,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParameters)
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages + 1, Row1, Column1, Index1, ..."
60a25d3f,micro,33,"local coordinate system to the reference coordinate
system","if (DoTransform)
affine_trans_point_3d (HomMat3D_LocalToReference, X, Y, Z, X, Y, Z)
endif
return ()",374,409,"* --- Automatically Added Context ---
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_sheet_of_light_result (Z, SheetOfLightModelID,..."
60a25d3f,micro,34,,"LightPlanePose := []
Norm := NormalVectorX * NormalVectorX + NormalVectorY * NormalVectorY + NormalVectorZ * NormalVectorZ
if (abs(Norm) &lt; 1e-8)
return ()
endif",414,419,"* --- Automatically Added Context ---
get_light_plane_pose (Ox, Oy, Oz, Nx, Ny, Nz, LightPlanePose)
* --- End of Automatically Added Context ---"
60a25d3f,micro,35,"normal vector to the plane y=0. This provides the
vector N1.","hom_mat3d_identity (HomMat3DIdentity)
tuple_atan2 (NormalVectorY, NormalVectorZ, Alpha)
hom_mat3d_rotate (HomMat3DIdentity, Alpha, 'x', 0, 0, 0, HomMat3DRotateAlpha)
affine_trans_point_3d (HomMat3DRotateAlpha, NormalVectorX, NormalVectorY, NormalVectorZ, N1x, N1y, N1z)",429,436,
60a25d3f,micro,36,"coordinates of N1. Note that the rotation around the
y-axis with angle Beta is carried out in the co...","tuple_atan2 (N1x, N1z, Beta)
hom_mat3d_rotate (HomMat3DIdentity, -Beta, 'y', 0, 0, 0, HomMat3DRotateBeta)",437,443,"* --- Automatically Added Context ---
hom_mat3d_identity (HomMat3DIdentity)
affine_trans_point_3d (HomMat3DRotateAlpha, NormalVectorX, NormalVectorY, NormalVectorZ, N1x, N1y, N1z)
* --- End of Automat..."
60a25d3f,micro,37,,"hom_mat3d_translate (HomMat3DIdentity, -OriginX, -OriginY, -OriginZ, HomMat3DTranslate)
hom_mat3d_compose (HomMat3DRotateAlpha, HomMat3DTranslate, HomMat3DTmp)
hom_mat3d_compose (HomMat3DRotateBeta, HomMat3DTmp, HomMat3DWorldToLightplane)
hom_mat3d_to_pose (HomMat3DWorldToLightplane, LightPlanePose)...",444,481,"* --- Automatically Added Context ---
get_light_plane_pose (Ox, Oy, Oz, Nx, Ny, Nz, LightPlanePose)
hom_mat3d_identity (HomMat3DIdentity)
hom_mat3d_rotate (HomMat3DIdentity, Alpha, 'x', 0, 0, 0, HomMa..."
60a25d3f,micro,38,,"Ox := []
Oy := []
Oz := []
Nx := []
Ny := []
Nz := []
MeanResidual := []",494,502,"* --- Automatically Added Context ---
fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
* --- End of Automatically Added Context ---"
60a25d3f,micro,39,,"Size := |X|
if (Size &lt; 3 or Size != |Y| or Size != |Z|)
return ()
endif",503,508,"* --- Automatically Added Context ---
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_sheet_of_light_result (Z, SheetOfLightModelID,..."
60a25d3f,micro,40,,"tuple_mean (X, Ox)
tuple_mean (Y, Oy)
tuple_mean (Z, Oz)",509,513,"* --- Automatically Added Context ---
fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_ligh..."
60a25d3f,micro,41,"its singular value decomposition. The singular vector
of M corresponding to its smallest singular va...","create_matrix (3, |X|, [X - Ox,Y - Oy,Z - Oz], MatrixID_Mt)
transpose_matrix (MatrixID_Mt, MatrixID_M)
svd_matrix (MatrixID_M, 'reduced', 'right', MatrixID_U, MatrixID_S, MatrixID_V)
get_value_matrix (MatrixID_S, [0, 1, 2], [0, 1, 2], SingularvaluesOfM)
tuple_sort_index (SingularvaluesOfM, Indices)",514,523,"* --- Automatically Added Context ---
fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_ligh..."
60a25d3f,micro,42,"to zero. This indicates that the provided 3d points are
inappropriate to fit the plane (e.g., they a...","if (SingularvaluesOfM[Indices[0]] &lt; 1e-9 and SingularvaluesOfM[Indices[1]] &lt; 1e-9)
return ()
endif",524,531,"* --- Automatically Added Context ---
get_value_matrix (MatrixID_S, [0, 1, 2], [0, 1, 2], SingularvaluesOfM)
tuple_sort_index (SingularvaluesOfM, Indices)
* --- End of Automatically Added Context ---"
60a25d3f,micro,43,,"get_value_matrix (MatrixID_V, [0, 1, 2], [Indices[0],Indices[0],Indices[0]], N)
create_matrix (3, 1, N, MatrixID_N)
Nx := N[0]
Ny := N[1]
Nz := N[2]",532,538,"* --- Automatically Added Context ---
fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
svd_matrix (MatrixID_M, 'reduced', 'right', MatrixID_U, MatrixID_S, Matri..."
60a25d3f,micro,44,,"mult_matrix (MatrixID_M, MatrixID_N, 'AB', MatrixID_MN)
get_full_matrix (MatrixID_MN, Distances)
Distances := abs(Distances)
MeanResidual := sum(Distances) / Size
return ()",541,564,"* --- Automatically Added Context ---
fit_3d_plane_xyz ([X19,X20], [Y19,Y20], [Z19,Z20], Ox, Oy, Oz, Nx, Ny, Nz, MeanResidual)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
Size := |X|
trans..."
86695aa7,full,0,"This program checks if SMDs are nearly horizontal or if they
are tilted with respect to the camera.
...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640 * .7, 512 * .7, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_open_window (0, 640 * .7 + 12, 640 * .7, 512 * .7, 'black', GrayProfileWindow)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_d...",16,76,
86695aa7,micro,1,"are tilted with respect to the camera.
The images were taken with a small depth of field, therefore
...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640 * .7, 512 * .7, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_open_window (0, 640 * .7 + 12, 640 * .7, 512 * .7, 'black', GrayProfileWindow)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_d...",6,82,
4d429796,full,0,"Application program to illustrate the disparity results of some stereo image pairs.
Some epipolar im...","Width := [320, 256, 256, 256] * 1.2
Height := [240, 256, 256, 256] * 1.2
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, Width[0], Height[0], 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, Width[0] + 12, Width[0], Height[0], 'bl...",11,54,
4d429796,micro,1,"horizontal epipolar lines) are processed and the resulting disparity images are displayed.
---------...","Width := [320, 256, 256, 256] * 1.2
Height := [240, 256, 256, 256] * 1.2
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, Width[0], Height[0], 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, Width[0] + 12, Width[0], Height[0], 'bl...",8,20,
4d429796,micro,2,(make sure that your HALCONIMAGES environment variable is set to the HALCON images directory),"Names := ['baseball', 'fruit', 'plant', 'cube']
ImgPath := 'stereo/epipolar/'",21,24,
4d429796,micro,3,,"DMin := [-45, -25, -12, -50]
DMax := [-10, 30, -8, -20]
Size := [19, 25, 5, 11]
Levels := 2
for Index := 0 to |Names| - 1 by 1
read_image (LImage, ImgPath + Names[Index] + '_l')
read_image (RImage, ImgPath + Names[Index] + '_r')
binocular_disparity (LImage, RImage, DisparityNCC, Score, 'ncc', Size[I...",25,60,"* --- Automatically Added Context ---
Width := [320, 256, 256, 256] * 1.2
Height := [240, 256, 256, 256] * 1.2
dev_open_window (0, 0, Width[0], Height[0], 'black', WindowHandle1)
dev_open_window (0, W..."
eccc0a23,full,0,"This example shows the inspection of planar intersections of
3D objects.  The intersections are deri...","NumDisparityProfiles := 441
read_image (DisparityProfile, 'sheet_of_light/metal_part_1_disparity_line_000')
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightModelID)
ScaleX := 1
ScaleY := 4
ScaleZ := 0.5
set_sheet_of_light_param (SheetOfLightModelID, 'scale_x...",43,638,
eccc0a23,micro,1,,"NumDisparityProfiles := 441
read_image (DisparityProfile, 'sheet_of_light/metal_part_1_disparity_line_000')
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightModelID)",42,45,
eccc0a23,micro,2,"such that the reconstructed 3D object model is given approximately
in mm","ScaleX := 1
ScaleY := 4
ScaleZ := 0.5
set_sheet_of_light_param (SheetOfLightModelID, 'scale_x', ScaleX)
set_sheet_of_light_param (SheetOfLightModelID, 'scale_y', ScaleY)
set_sheet_of_light_param (SheetOfLightModelID, 'scale_z', ScaleZ)",46,55,"* --- Automatically Added Context ---
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightModelID)
* --- End of Automatically Added Context ---"
eccc0a23,micro,3,the background,MinZ := 220,56,59,
eccc0a23,micro,4,,"dev_update_off ()
set_system ('clip_region', 'false')
dev_close_window ()
get_image_size (DisparityProfile, DisparityProfileWidth, DisparityProfileHeight)
WindowEnlargement := 350
WindowWidth := DisparityProfileWidth + WindowEnlargement
WindowHeight := NumDisparityProfiles
dev_open_window (0, 0, Win...",60,73,"* --- Automatically Added Context ---
NumDisparityProfiles := 441
read_image (DisparityProfile, 'sheet_of_light/metal_part_1_disparity_line_000')
* --- End of Automatically Added Context ---"
eccc0a23,micro,5,,"VisualizationPlaneSize := 150
gen_cam_par_area_scan_division (0.01, 0, 6e-6, 6e-6, WindowWidth / 2, WindowHeight / 2, WindowWidth, WindowHeight, VisualizationCamParam)
create_pose (-1550, 680, 5390, 122, 1, 357, 'Rp+T', 'gba', 'point', VisualizationPose)
VisualizationColors := ['magenta', 'blue', 'o...",74,79,"* --- Automatically Added Context ---
NumDisparityProfiles := 441
WindowWidth := DisparityProfileWidth + WindowEnlargement
WindowHeight := NumDisparityProfiles
get_image_size (DisparityProfile, Dispar..."
eccc0a23,micro,6,"disparity profiles in a sheet-of-light model and
transforming them to a 3D object model","gen_image_const (DisparityImageVis, 'uint2', DisparityProfileWidth, NumDisparityProfiles)
for Index := 0 to NumDisparityProfiles - 1 by 1
read_image (ImageModel, 'sheet_of_light/metal_part_1_disparity_line_' + Index$'03d')
set_profile_sheet_of_light (ImageModel, SheetOfLightModelID, [])
get_grayval ...",80,97,"* --- Automatically Added Context ---
NumDisparityProfiles := 441
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightModelID)
get_image_size (DisparityProfile, D..."
eccc0a23,micro,7,,"dev_display (DisparityImageVis)
disp_message (WindowHandle, 'Disparity image of the reference sample', 'window', 12, 12, 'black', 'true')",98,100,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
gen_image_const (DisparityImageVis, 'uint2', DisparityProfileWidth, NumDisparityProfiles)..."
eccc0a23,micro,8,the background from the respective 3D object model,"get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, Model3DFull)
get_object_model_3d_params (Model3DFull, 'bounding_box1', BoundingBox1)
MaxZ := BoundingBox1[5]
select_points_object_model_3d (Model3DFull, 'point_coord_z', MinZ, MaxZ, Model3D)
disp_continue_message (WindowHandle, 'black',...",101,109,"* --- Automatically Added Context ---
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightModelID)
MinZ := 220
dev_open_window (0, 0, WindowWidth, WindowHeight, '..."
eccc0a23,micro,9,"the planes and to allow the alignment of the intersection
planes to the objects to be inspected","dev_clear_window ()
dev_set_part (PartRow1, PartColumn1, PartRow2, PartColumn2)
disp_object_model_3d (WindowHandle, Model3D, VisualizationCamParam, VisualizationPose, [], [])
Message := 'Prepare the reference model'
Message[1] := ' - triangulate 3D object model and'
Message[2] := ' - create surface ...",110,119,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
get_part (WindowHandle, PartRow1, PartColumn1, PartRow2, PartColumn2)
gen_cam_par_area_sc..."
eccc0a23,micro,10,,"surface_normals_object_model_3d (Model3D, 'mls', 'mls_force_inwards', 'true', ObjectModel3DNormals)
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small_surfaces', 200, ObjectModel3DReference, Information)",120,122,"* --- Automatically Added Context ---
select_points_object_model_3d (Model3DFull, 'point_coord_z', MinZ, MaxZ, Model3D)
* --- End of Automatically Added Context ---"
eccc0a23,micro,11,,"create_surface_model (ObjectModel3DReference, 0.03, 'model_invert_normals', 'true', SurfaceModelID)",123,125,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small_surfaces', 200, ObjectModel3DReference, Information)
* --- End of Automatically ..."
eccc0a23,micro,12,,"create_pose (300, 230, 250, -90, 0, 0, 'Rp+T', 'gba', 'point', PoseIntersectionPlane1)
create_pose (300, 900, 250, -90, 0, 0, 'Rp+T', 'gba', 'point', PoseIntersectionPlane2)
create_pose (300, 1570, 250, -90, 0, 0, 'Rp+T', 'gba', 'point', PoseIntersectionPlane3)
gen_plane_object_model_3d (PoseInterse...",130,143,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
get_part (WindowHandle, PartRow1, PartColumn1, PartRow2, PartColumn2)
VisualizationPlaneS..."
eccc0a23,micro,13,defined planes,"intersect_plane_object_model_3d (ObjectModel3DReference, PoseIntersectionPlane1, ObjectModel3DIntersection1)
intersect_plane_object_model_3d (ObjectModel3DReference, PoseIntersectionPlane2, ObjectModel3DIntersection2)
intersect_plane_object_model_3d (ObjectModel3DReference, PoseIntersectionPlane3, O...",144,149,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small_surfaces', 200, ObjectModel3DReference, Information)
create_pose (300, 230, 250,..."
eccc0a23,micro,14,,"project_object_model_3d_lines_to_contour_xld (Intersection1, PoseIntersectionPlane1, ObjectModel3DIntersection1)
project_object_model_3d_lines_to_contour_xld (Intersection2, PoseIntersectionPlane2, ObjectModel3DIntersection2)
project_object_model_3d_lines_to_contour_xld (Intersection3, PoseIntersect...",150,154,"* --- Automatically Added Context ---
create_pose (300, 230, 250, -90, 0, 0, 'Rp+T', 'gba', 'point', PoseIntersectionPlane1)
create_pose (300, 900, 250, -90, 0, 0, 'Rp+T', 'gba', 'point', PoseIntersec..."
eccc0a23,micro,15,analyzing the measurements from the reference sample,"OrientationRef := 20
OrientationTolerance := 20
analyze_intersection (Intersection1, FittedLines1, OrientationRef, OrientationTolerance, MinDistance1, MaxDistance1, Angle1)
analyze_intersection (Intersection2, FittedLines2, OrientationRef, OrientationTolerance, MinDistance2, MaxDistance2, Angle2)
an...",155,162,"* --- Automatically Added Context ---
project_object_model_3d_lines_to_contour_xld (Intersection1, PoseIntersectionPlane1, ObjectModel3DIntersection1)
project_object_model_3d_lines_to_contour_xld (Int..."
eccc0a23,micro,16,intersections and measurement results,hom_mat2d_identity (HomMat2DIdentity),163,165,
eccc0a23,micro,17,,"Message := 'Intersections with measurement lines'
MessageWrapped := regexp_replace(Message + ' ',['(.{0,20})\\s', 'replace_all'],'$1\n')
disp_message (WindowHandle, MessageWrapped, 'window', 12, 330, 'black', 'true')
Message := 'Measurement results'
MessageWrapped := regexp_replace(Message + ' ',['(...",166,172,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
Message := 'Disparity image of the reference sample'
disp_message (WindowHandle, 'Dispari..."
eccc0a23,micro,18,,"hom_mat2d_translate (HomMat2DIdentity, 350, 390, HomMat2DTranslate1)
affine_trans_contour_xld (Intersection1, Intersection1Vis, HomMat2DTranslate1)
affine_trans_contour_xld (FittedLines1, FittedLines1Vis, HomMat2DTranslate1)
dev_set_color (VisualizationColors[0])
dev_set_line_width (5)
dev_display (...",173,186,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
VisualizationColors := ['magenta', 'blue', 'orange']
Message := 'Disparity image of the r..."
eccc0a23,micro,19,,"hom_mat2d_translate (HomMat2DIdentity, 250, 410, HomMat2DTranslate2)
affine_trans_contour_xld (Intersection2, Intersection2Vis, HomMat2DTranslate2)
affine_trans_contour_xld (FittedLines2, FittedLines2Vis, HomMat2DTranslate2)
dev_set_color (VisualizationColors[1])
dev_set_line_width (5)
dev_display (...",187,200,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
VisualizationColors := ['magenta', 'blue', 'orange']
Message := 'Disparity image of the r..."
eccc0a23,micro,20,,"hom_mat2d_translate (HomMat2DIdentity, 150, 430, HomMat2DTranslate3)
affine_trans_contour_xld (Intersection3, Intersection3Vis, HomMat2DTranslate3)
affine_trans_contour_xld (FittedLines3, FittedLines3Vis, HomMat2DTranslate3)
dev_set_color (VisualizationColors[2])
dev_set_line_width (5)
dev_display (...",201,217,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
VisualizationColors := ['magenta', 'blue', 'orange']
Message := 'Disparity image of the r..."
eccc0a23,micro,21,on the measurements of the reference sample,"AngleRef := mean([Angle1,Angle2,Angle3])
MaxAngleDev := 2
MinAngle := AngleRef - MaxAngleDev
MaxAngle := AngleRef + MaxAngleDev
MinDistance := 0.95 * mean([MinDistance1,MinDistance2,MinDistance3])
MaxDistance := 1.05 * mean([MaxDistance1,MaxDistance2,MaxDistance3])",218,225,"* --- Automatically Added Context ---
analyze_intersection (Intersection1, FittedLines1, OrientationRef, OrientationTolerance, MinDistance1, MaxDistance1, Angle1)
analyze_intersection (Intersection2, ..."
eccc0a23,micro,22,,"dev_clear_window ()
Message := 'Tolerance limits for the angle and the distance of the mounting tabs, derived from the three measurements on the reference sample:'
MessageWrapped := regexp_replace(Message + ' ',['(.{0,75})\\s', 'replace_all'],'$1\n')
Message := MessageWrapped
Message[1] := ' '
Messa...",226,241,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
Message := 'Disparity image of the reference sample'
disp_message (WindowHandle, 'Dispari..."
eccc0a23,micro,23,,"NumScenes := 4
for SceneIndex := 1 to NumScenes by 1
dev_clear_window ()
dev_set_part (PartRow1, PartColumn1, PartRow2, PartColumn2)
reset_sheet_of_light_model (SheetOfLightModelID)
gen_image_const (DisparityImageVis, 'uint2', DisparityProfileWidth, NumDisparityProfiles)
for Index := 0 to NumDispari...",245,470,"* --- Automatically Added Context ---
* WARNING: Context truncated at 50 lines
NumDisparityProfiles := 441
create_sheet_of_light_model (DisparityProfile, 'calibration', 'offset_scale', SheetOfLightMod..."
eccc0a23,micro,24,,"gen_polygons_xld (Intersection, Polygons, 'ramer', 2)
split_contours_xld (Polygons, ContoursSplit, 'polygon', 1, 5)",476,478,
eccc0a23,micro,25,,"select_shape_xld (ContoursSplit, SelectedXLD, ['orientation_points', 'orientation_points'], 'or', rad([OrientationRef,OrientationRef - 180]) - rad(OrientationTolerance), rad([OrientationRef,OrientationRef - 180]) + rad(OrientationTolerance))
union_adjacent_contours_xld (SelectedXLD, UnionContours, 1...",479,481,"* --- Automatically Added Context ---
OrientationRef := 20
OrientationTolerance := 20
split_contours_xld (Polygons, ContoursSplit, 'polygon', 1, 5)
* --- End of Automatically Added Context ---"
eccc0a23,micro,26,,"length_xld (UnionContours, Length)
SelectedId := sort_index(-Length)[0:2] + 1
select_obj (UnionContours, ObjectSelected1, SelectedId[0])
select_obj (UnionContours, ObjectSelected2, SelectedId[1])
select_obj (UnionContours, ObjectSelected3, SelectedId[2])",482,487,"* --- Automatically Added Context ---
union_adjacent_contours_xld (SelectedXLD, UnionContours, 10, 1, 'attr_keep')
* --- End of Automatically Added Context ---"
eccc0a23,micro,27,"to decide, which of them represents the mounting tab","distance_cc_min (ObjectSelected1, ObjectSelected2, 'fast_point_to_segment', DistanceMin12)
distance_cc_min (ObjectSelected1, ObjectSelected3, 'fast_point_to_segment', DistanceMin13)
distance_cc_min (ObjectSelected2, ObjectSelected3, 'fast_point_to_segment', DistanceMin23)",488,492,"* --- Automatically Added Context ---
select_obj (UnionContours, ObjectSelected1, SelectedId[0])
select_obj (UnionContours, ObjectSelected2, SelectedId[1])
select_obj (UnionContours, ObjectSelected3, ..."
eccc0a23,micro,28,"another represent the ground plane, while the remaining
segment represents the mounting tab","LargestDistId := sort_index(-[DistanceMin12,DistanceMin13,DistanceMin23])[0]
switch (LargestDistId)
case 0:
concat_obj (ObjectSelected1, ObjectSelected2, GroundPlane)
copy_obj (ObjectSelected3, MountingTab, 1, 1)
break
case 1:
concat_obj (ObjectSelected1, ObjectSelected3, GroundPlane)
copy_obj (Obje...",493,514,"* --- Automatically Added Context ---
select_obj (UnionContours, ObjectSelected1, SelectedId[0])
select_obj (UnionContours, ObjectSelected2, SelectedId[1])
select_obj (UnionContours, ObjectSelected3, ..."
eccc0a23,micro,29,,"union_adjacent_contours_xld (GroundPlane, GroundPlaneUnion, 1000, 50, 'attr_keep')
fit_line_contour_xld (GroundPlaneUnion, 'tukey', -1, 0, 5, 2, RowBegin, ColBegin, RowEnd, ColEnd, Nr, Nc, Dist)
if (ColEnd &lt; ColBegin)
T := ColEnd
ColEnd := ColBegin
ColBegin := T
T := RowEnd
RowEnd := RowBegin
Row...",515,544,"* --- Automatically Added Context ---
create_pose (-1550, 680, 5390, 122, 1, 357, 'Rp+T', 'gba', 'point', VisualizationPose)
concat_obj (ObjectSelected1, ObjectSelected2, GroundPlane)
copy_obj (Object..."
eccc0a23,micro,30,,"distance_pl ([RowBeginMT,RowEndMT], [ColBeginMT,ColEndMT], RowBegin, ColBegin, RowEnd, ColEnd, Distances)
MinDistance := min(Distances)
MaxDistance := max(Distances)
angle_ll (0, 0, NrMT, NcMT, 0, 0, Nr, Nc, AngleRad)
Angle := deg(AngleRad)",545,550,"* --- Automatically Added Context ---
MinDistance := 0.95 * mean([MinDistance1,MinDistance2,MinDistance3])
MaxDistance := 1.05 * mean([MaxDistance1,MaxDistance2,MaxDistance3])
Message[2] := 'Min Angle..."
eccc0a23,micro,31,,"if (Angle &lt; -90)
Angle := Angle + 180
elseif (Angle &gt; 90)
Angle := Angle - 180
endif
return ()",551,626,"* --- Automatically Added Context ---
Message[2] := 'Min Angle    = ' + MinAngle$'.1f' + ' deg'
* --- End of Automatically Added Context ---"
eccc0a23,micro,32,,"pose_invert (PoseIntersectionPlane, PoseInvert)",629,630,
eccc0a23,micro,33,,"get_object_model_3d_params (ObjectModel3DIntersection, 'diameter_axis_aligned_bounding_box', Diameter)
PoseInvert[2] := PoseInvert[2] + Diameter",631,633,"* --- Automatically Added Context ---
pose_invert (PoseIntersectionPlane, PoseInvert)
* --- End of Automatically Added Context ---"
eccc0a23,micro,34,,"Scale := 1
gen_cam_par_area_scan_telecentric_division (1.0, 0, 1.0 / Scale, 1.0 / Scale, 0, 0, 512, 512, CamParam)
project_object_model_3d (Intersection, ObjectModel3DIntersection, CamParam, PoseInvert, 'data', 'lines')
return ()",634,667,"* --- Automatically Added Context ---
gen_polygons_xld (Intersection, Polygons, 'ramer', 2)
pose_invert (PoseIntersectionPlane, PoseInvert)
get_object_model_3d_params (ObjectModel3DIntersection, 'diam..."
5d97681f,full,0,"This program demonstrates the measurement of the height of a
workpiece by using targets and a stereo...","dev_update_off ()
dev_close_window ()
Scale := .7
gen_cam_par_area_scan_division (0.0128583, -533.075, 7.40044e-006, 7.4e-006, 310.243, 243.807, 640, 480, CamParamLeft)
gen_cam_par_area_scan_division (0.0130659, -512.699, 7.41508e-006, 7.4e-006, 333.347, 237.374, 640, 480, CamParamRight)
create_pose...",14,105,
5d97681f,micro,1,"workpiece by using targets and a stereo setup.
First, the targets are detected in both the left
and ...","dev_update_off ()
dev_close_window ()
Scale := .7",6,17,
5d97681f,micro,2,,"gen_cam_par_area_scan_division (0.0128583, -533.075, 7.40044e-006, 7.4e-006, 310.243, 243.807, 640, 480, CamParamLeft)
gen_cam_par_area_scan_division (0.0130659, -512.699, 7.41508e-006, 7.4e-006, 333.347, 237.374, 640, 480, CamParamRight)
create_pose (0.154132, -0.00585068, 0.0429294, 359.932, 336.4...",18,22,
5d97681f,micro,3,,"read_image (ImageLeft, 'stereo/targets/targets_l')
read_image (ImageRight, 'stereo/targets/targets_r')
get_image_size (ImageLeft, Width, Height)
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandleLeft)
dev_set_color ('yellow')
dev_set_line_width (2)
set_display_font (WindowHa...",23,41,"* --- Automatically Added Context ---
Scale := .7
* --- End of Automatically Added Context ---"
5d97681f,micro,4,,"critical_points_sub_pix (ImageLeft, 'facet', 2.0, 5, RowMin, ColMin, RowMax, ColMax, RowPointLeft, ColumnPointLeft)
gen_cross_contour_xld (CrossLeft, RowPointLeft, ColumnPointLeft, 20, rad(45))
dev_set_window (WindowHandleLeft)
dev_display (CrossLeft)",44,49,"* --- Automatically Added Context ---
read_image (ImageLeft, 'stereo/targets/targets_l')
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandleLeft)
* --- End of Automatically Add..."
5d97681f,micro,5,,"critical_points_sub_pix (ImageRight, 'facet', 2.0, 5, RowMin, ColMin, RowMax, ColMax, RowPointRight, ColumnPointRight)
gen_cross_contour_xld (CrossRight, RowPointRight, ColumnPointRight, 20, rad(45))
dev_set_window (WindowHandleRight)
dev_display (CrossRight)
disp_continue_message (WindowHandleLeft,...",50,57,"* --- Automatically Added Context ---
read_image (ImageRight, 'stereo/targets/targets_r')
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandleLeft)
dev_open_window (0, Width * S..."
5d97681f,micro,6,targets and convert them into [mm],"intersect_lines_of_sight (CamParamLeft, CamParamRight, RelPose, RowPointLeft, ColumnPointLeft, RowPointRight, ColumnPointRight, X, Y, Z, Dist)
X := X * 1000
Y := Y * 1000
Z := Z * 1000",58,64,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0128583, -533.075, 7.40044e-006, 7.4e-006, 310.243, 243.807, 640, 480, CamParamLeft)
gen_cam_par_area_scan_division (0.0130659, ..."
5d97681f,micro,7,"First, define a new (non orthogonal) coordinate system
whose plane z=0 is defined by the vectors NX=...","NX := [X[3] - X[2],Y[3] - Y[2],Z[3] - Z[2]]
NY := [X[0] - X[2],Y[0] - Y[2],Z[0] - Z[2]]",65,69,"* --- Automatically Added Context ---
intersect_lines_of_sight (CamParamLeft, CamParamRight, RelPose, RowPointLeft, ColumnPointLeft, RowPointRight, ColumnPointRight, X, Y, Z, Dist)
* --- End of Automa..."
5d97681f,micro,8,the cross product of NX and NX,"NZ := [NX[1] * NY[2] - NX[2] * NY[1],NX[2] * NY[0] - NY[2] * NX[0],NX[0] * NY[1] - NY[0] * NX[1]]
NZ := NZ / sqrt(sum(NZ * NZ))",70,73,"* --- Automatically Added Context ---
intersect_lines_of_sight (CamParamLeft, CamParamRight, RelPose, RowPointLeft, ColumnPointLeft, RowPointRight, ColumnPointRight, X, Y, Z, Dist)
NX := [X[3] - X[2],..."
5d97681f,micro,9,"projection of the vector P2P1 onto the vector NZ. This is
done by computing the dot product P2P1.NZ","P2P1 := [X[1] - X[2],Y[1] - Y[2],Z[1] - Z[2]]
WorkpieceHeight := sum(NZ * P2P1)",74,79,"* --- Automatically Added Context ---
intersect_lines_of_sight (CamParamLeft, CamParamRight, RelPose, RowPointLeft, ColumnPointLeft, RowPointRight, ColumnPointRight, X, Y, Z, Dist)
NX := [X[3] - X[2],..."
5d97681f,micro,10,,"gen_arrow_contour_xld (ArrowNXRight, RowPointRight[2], ColumnPointRight[2], RowPointRight[0], ColumnPointRight[0], 20, 20)
gen_arrow_contour_xld (ArrowNYRight, RowPointRight[2], ColumnPointRight[2], RowPointRight[3], ColumnPointRight[3], 20, 20)
gen_arrow_contour_xld (ArrowRight1, 225.5, 322.5, 225....",80,111,"* --- Automatically Added Context ---
read_image (ImageLeft, 'stereo/targets/targets_l')
get_image_size (ImageLeft, Width, Height)
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', Window..."
abb479c8,full,0,"This program reconstructs the height of a single solder
ball on a BGA using depth from focus.","dev_update_off ()
dev_close_window ()
read_image (Image, 'dff/focus_bga_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_paint ('default')
dev_display (Image)
disp_message (WindowHandle, 'Read a sequence of focus ...",9,43,
abb479c8,micro,1,ball on a BGA using depth from focus.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'dff/focus_bga_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_paint ('default')
dev_display (Image)",6,16,
abb479c8,micro,2,,"disp_message (WindowHandle, 'Read a sequence of focus images ...', 'image', 20, 20, 'white', 'false')
Sequence := [37:-1:1]
Names := 'dff/focus_bga_' + Sequence$'02'
read_image (ImageArray, Names)
channels_to_image (ImageArray, Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
for...",17,31,"* --- Automatically Added Context ---
read_image (Image, 'dff/focus_bga_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
abb479c8,micro,3,,"dev_display (ImageDisp)
disp_message (WindowHandle, 'Compute the depth map', 'image', 20, 20, 'white', 'false')
depth_from_focus (Image, Depth, Confidence, ['bandpass', 3, 3], 'next_maximum')
scale_image_max (Depth, DepthScaleMax)
select_grayvalues_from_channels (Image, Depth, Sharp)
scale_image (Sh...",32,49,"* --- Automatically Added Context ---
read_image (Image, 'dff/focus_bga_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
access_channel (Image, ImageDisp, Index)
* --- End of Automat..."
0681f389,full,0,"This program performs a 3D measurement of solder paste on
a BGA pad using depth from focus.
First, t...","dev_update_off ()
dev_close_window ()
read_image (Image, 'dff/focus_pcb_solder_paste_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_image_size (Image, Width, Height)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_paint ('default')
dev_display (Image)
dis...",12,55,
0681f389,micro,1,"a BGA pad using depth from focus.
First, the dff image sequence is read. Then, it is processed
in or...","dev_update_off ()
dev_close_window ()
read_image (Image, 'dff/focus_pcb_solder_paste_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_image_size (Image, Width, Height)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_paint ('default')
dev_display (Image)",6,20,
0681f389,micro,2,,"disp_message (WindowHandle, 'Measure solder paste on pad using Depth From Focus', 'window', 12, 12, 'black', 'true')
NumImages := 91
Sequence := [NumImages:-1:1]
read_image (ImageArray, 'dff/focus_pcb_solder_paste_' + Sequence$'02')
channels_to_image (ImageArray, Image)
disp_continue_message (Window...",21,37,"* --- Automatically Added Context ---
read_image (Image, 'dff/focus_pcb_solder_paste_37')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
0681f389,micro,3,,"depth_from_focus (Image, Depth, Confidence, 'bandpass', 'next_maximum')
select_grayvalues_from_channels (Image, Depth, SharpenedImage)
scale_image (SharpenedImage, ImageScaled, 4, 0)
scale_image_max (Depth, ImageScaleMax)
median_rect (ImageScaleMax, DepthMean, 25, 25)",38,44,"* --- Automatically Added Context ---
read_image (Image, 'dff/focus_pcb_solder_paste_37')
disp_message (WindowHandle, 'Measure solder paste on pad using Depth From Focus', 'window', 12, 12, 'black', '..."
0681f389,micro,4,,"dev_set_window_extents (0, 0, Width * 0.7, Height * 0.7)
dev_display (SharpenedImage)
disp_message (WindowHandle, 'Sharpened image', 'window', 12, 12, 'black', 'true')
dev_open_window (0, Width * 0.7 + 5, Width * 0.7, Height * 0.7, 'black', WindowHandle3D)
set_display_font (WindowHandle3D, 16, 'mono...",45,61,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_image_size (Image, Width, Height)
select_grayvalues_from_channels (Image, Depth, SharpenedImage)..."
76b1efa3,full,0,"Example program to demonstrate photometric stereo
Input are 6 images taken from braille with light c...","dev_close_window ()
dev_update_off ()
read_image (Image, 'photometric_stereo/embossed_01')
get_image_size (Image, WindowWidth, WindowHeight)
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'tr...",10,106,
76b1efa3,micro,1,"Input are 6 images taken from braille with light coming
from different orientations and angles. Afte...","dev_close_window ()
dev_update_off ()
read_image (Image, 'photometric_stereo/embossed_01')
get_image_size (Image, WindowWidth, WindowHeight)
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'tr...",6,20,
76b1efa3,micro,2,,"FileNames := []
for I := 1 to 6 by 1
FileNames := [FileNames,'photometric_stereo/embossed_' + I$'.2']
endfor
read_image (Images, FileNames)
count_obj (Images, NumImages)
for I := 1 to NumImages by 1
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
wait_seconds (0.5)
endfor",21,33,
76b1efa3,micro,3,,"photometric_stereo (Images, Height, Gradient, Albedo, [70, 50, 70, 50, 70, 50], [0, 0, 90, 90, 180, 180], 'all', 'rft_cyclic', [], [])
mean_image (Height, ImageMean, 61, 61)
sub_image (Height, ImageMean, ImageSub, 1, 0)
dev_display (ImageSub)
disp_continue_message (WindowHandle, 'black', 'true')
dis...",34,43,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandl..."
76b1efa3,micro,4,,"disp_message (WindowHandle, 'Shade the height field\nof the braille dots', 'window', 10, 10, 'black', 'true')
wait_seconds (2)
for I := 0 to 360 by 10
shade_height_field (ImageSub, ShadedFace, 45, I, 1, 0, 'false')
dev_display (ShadedFace)
endfor
disp_continue_message (WindowHandle, 'black', 'true')...",44,53,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandle)
for I := 1 to 6 by 1
sub_image (Height, ImageMean,..."
76b1efa3,micro,5,,"threshold (ImageSub, Region, 0.35, 1000)
dev_set_draw ('margin')
dev_set_line_width (4)
dev_set_color ('green')
dev_display (Image)
dev_display (Region)
disp_continue_message (WindowHandle, 'black', 'true')
disp_message (WindowHandle, 'Segment single dots', 'window', 10, 10, 'black', 'true')
stop ()",54,64,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandl..."
76b1efa3,micro,6,,"closing_rectangle1 (Region, RegionClosing, 200, 60)
connection (RegionClosing, ConnectedRegions)
count_obj (ConnectedRegions, Number)
dev_display (Image)
dev_set_colored (12)
for I := 1 to Number by 1
select_obj (ConnectedRegions, ObjectSelected, I)
intersection (ObjectSelected, Region, RegionInters...",65,80,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandl..."
76b1efa3,micro,7,This version is faster because no height field must be calculated.,"photometric_stereo (Images, Height1, Gradient1, Albedo1, [70, 50, 70, 50, 70, 50], [0, 0, 90, 90, 180, 180], 'gradient', 'rft_cyclic', [], [])
derivate_vector_field (Gradient1, Result, 1, 'mean_curvature')
dev_display (Result)
disp_message (WindowHandle, 'Alternative Solution: Use Gauss curvature of...",81,112,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, WindowWidth * 0.6, WindowHeight * 0.6, WindowHandl..."
63a1a303,full,0,"This program demonstrates how to perform a calibrated
measurement by using the sheet-of-light techni...","dev_update_off ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
dev_close_window ()
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle1)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
dev_set_lut ('default')
gen_cam_par_area_scan_polynomia...",17,104,
63a1a303,micro,1,,"dev_update_off ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
dev_close_window ()
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle1)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
dev_set_lut ('default')",16,25,
63a1a303,micro,2,a calibrated measurement,"gen_cam_par_area_scan_polynomial (0.0126514, 640.275, -2.07143e+007, 3.18867e+011, -0.0895689, 0.0231197, 6.00051e-006, 6e-006, 387.036, 120.112, 752, 240, CamParam)
create_pose (-0.00164029, 1.91372e-006, 0.300135, 0.575347, 0.587877, 180.026, 'Rp+T', 'gba', 'point', CamPose)
create_pose (0.0027098...",26,32,
63a1a303,micro,3,and set the required parameters for the model.,"gen_rectangle1 (ProfileRegion, 120, 75, 195, 710)
create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles', 'ambiguity_solving'], [70, 290, 'first'], SheetOfLightModelID)
set_sheet_of_light_param (SheetOfLightModelID, 'calibration', 'xyz')
set_sheet_of_light_param (SheetOfLightModelID...",33,43,"* --- Automatically Added Context ---
gen_cam_par_area_scan_polynomial (0.0126514, 640.275, -2.07143e+007, 3.18867e+011, -0.0895689, 0.0231197, 6.00051e-006, 6e-006, 387.036, 120.112, 752, 240, CamPar..."
63a1a303,micro,4,,"for Index := 1 to 290 by 1
read_image (ProfileImage, 'sheet_of_light/connection_rod_' + Index$'.3')
dev_display (ProfileImage)
dev_display (ProfileRegion)
measure_profile_sheet_of_light (ProfileImage, SheetOfLightModelID, [])
endfor",44,50,"* --- Automatically Added Context ---
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
gen_rectangle1 (ProfileRegion, 120, 75, 195, 710)
create_sheet_of_light_model (ProfileRegion, ['min..."
63a1a303,micro,5,,"get_sheet_of_light_result (Disparity, SheetOfLightModelID, 'disparity')
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_sheet_of_light_result (Z, SheetOfLightModelID, 'z')
get_sheet_of_light_result_object_model_3d (SheetOfLightModel...",51,57,"* --- Automatically Added Context ---
create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles', 'ambiguity_solving'], [70, 290, 'first'], SheetOfLightModelID)
* --- End of Automatically..."
63a1a303,micro,6,,"get_image_size (Disparity, Width, Height)
dev_set_window_extents (0, 0, Width, Height)
dev_set_lut ('temperature')
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_clear_window ()
dev_display (Disparity)
disp_message (WindowHandle1, 'Disparity', 'window', 12, 12, 'black', 'true')
di...",58,68,"* --- Automatically Added Context ---
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle1)
get_sheet_of_light_result (Disparity, SheetOfLightModelID, 'disparity')
* --- End of Auto..."
63a1a303,micro,7,,"dev_close_window ()
dev_open_window (Height + 10, 0, Width * .5, Height * .5, 'black', WindowHandle3)
set_display_font (WindowHandle3, 14, 'mono', 'true', 'false')
dev_display (Z)
disp_message (WindowHandle3, 'Calibrated Z-coordinates', 'window', 12, 12, 'black', 'true')",69,75,"* --- Automatically Added Context ---
get_sheet_of_light_result (Z, SheetOfLightModelID, 'z')
get_image_size (Disparity, Width, Height)
* --- End of Automatically Added Context ---"
63a1a303,micro,8,,"dev_open_window ((Height + 10) * .5, 0, Width * .5, Height * .5, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_display (Y)
disp_message (WindowHandle2, 'Calibrated Y-coordinates', 'window', 12, 12, 'black', 'true')",76,81,"* --- Automatically Added Context ---
get_sheet_of_light_result (Y, SheetOfLightModelID, 'y')
get_image_size (Disparity, Width, Height)
disp_message (WindowHandle3, 'Calibrated Z-coordinates', 'window..."
63a1a303,micro,9,,"dev_open_window (0, 0, Width * .5, Height * .5, 'black', WindowHandle1)
dev_display (X)
dev_set_lut ('default')
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
disp_message (WindowHandle1, 'Calibrated X-coordinates', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandl...",82,90,"* --- Automatically Added Context ---
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle1)
get_sheet_of_light_result (X, SheetOfLightModelID, 'x')
get_image_size (Disparity, Width,..."
63a1a303,micro,10,,"gen_cam_par_area_scan_division (0.012, 0, 6e-006, 6e-006, 376, 240, 752, 480, CameraParam1)
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
create_pose (0, -10, 300, -30, 0, -30, 'Rp+T', 'gba', 'point', PoseIn...",91,110,"* --- Automatically Added Context ---
create_pose (-0.00164029, 1.91372e-006, 0.300135, 0.575347, 0.587877, 180.026, 'Rp+T', 'gba', 'point', CamPose)
get_sheet_of_light_result_object_model_3d (SheetOf..."
4c3d3508,full,0,"This program demonstrates how to perform a non calibrated
measurement by using the sheet-of-light te...","dev_update_off ()
dev_close_window ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('lime green')
dev_set_lut ('default')
gen_rectangle1 (ProfileRegi...",15,66,
4c3d3508,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
dev_open_window_fit_image (ProfileImage, 0, 0, 1024, 768, WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('lime green')
dev_set_lut ('default')",14,23,
4c3d3508,micro,2,,"gen_rectangle1 (ProfileRegion, 120, 75, 195, 710)",24,26,
4c3d3508,micro,3,"the sheet-of-light technique. Simultaneously set some
parameters for the model.","create_sheet_of_light_model (ProfileRegion, ['min_gray', 'num_profiles', 'ambiguity_solving', 'score_type'], [70, 290, 'first', 'width'], SheetOfLightModelID)
for Idx := 1 to 3 by 1
for Index := 1 to 290 by 1
read_image (ProfileImage, 'sheet_of_light/connection_rod_' + Index$'.3')
dev_display (Profi...",27,72,"* --- Automatically Added Context ---
read_image (ProfileImage, 'sheet_of_light/connection_rod_001')
gen_rectangle1 (ProfileRegion, 120, 75, 195, 710)
* --- End of Automatically Added Context ---"
5f3f4ebe,full,0,Extract depth using multiple focus levels,"Names := []
dev_close_window ()
for i := 1 to 10 by 1
Names := [Names,'dff/focus_' + (i$'.2')]
endfor
read_image (Image, Names)
channels_to_image (Image, Image)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
for i := 1 to 10 by 1
access_channel (Im...",8,41,
5f3f4ebe,micro,1,,"Names := []
dev_close_window ()
for i := 1 to 10 by 1
Names := [Names,'dff/focus_' + (i$'.2')]
endfor
read_image (Image, Names)
channels_to_image (Image, Image)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,16,
5f3f4ebe,micro,2,,"for i := 1 to 10 by 1
access_channel (Image, Image1, i)
endfor
depth_from_focus (Image, Depth, Confidence, 'highpass', 'next_maximum')",17,21,"* --- Automatically Added Context ---
read_image (Image, Names)
* --- End of Automatically Added Context ---"
5f3f4ebe,micro,3,,"mean_image (Depth, DepthHighConf, 11, 11)
scale_image_max (DepthHighConf, ImageScaleMax)
mean_image (ImageScaleMax, DepthMean, 51, 51)
threshold (DepthMean, Resistor, 158, 255)
connection (Resistor, ConnectedRes)",22,27,"* --- Automatically Added Context ---
depth_from_focus (Image, Depth, Confidence, 'highpass', 'next_maximum')
* --- End of Automatically Added Context ---"
5f3f4ebe,micro,4,,"select_shape_std (ConnectedRes, FinalRes, 'max_area', 0)
threshold (DepthMean, Solder, 125, 158)
connection (Solder, ConnectedSol)
select_shape_std (ConnectedSol, SelectedSol, 'max_area', 0)",28,32,"* --- Automatically Added Context ---
mean_image (ImageScaleMax, DepthMean, 51, 51)
connection (Resistor, ConnectedRes)
* --- End of Automatically Added Context ---"
5f3f4ebe,micro,5,,"fill_up (SelectedSol, FinalSol)
dev_set_line_width (3)
dev_set_draw ('margin')
dev_display (Image)
dev_set_color ('red')
dev_display (FinalSol)
dev_set_color ('blue')
dev_display (FinalRes)",33,47,"* --- Automatically Added Context ---
read_image (Image, Names)
select_shape_std (ConnectedRes, FinalRes, 'max_area', 0)
select_shape_std (ConnectedSol, SelectedSol, 'max_area', 0)
* --- End of Automa..."
f8708a9c,full,0,"This example program shows how to use the camera calibration
for images taken with linescan cameras....","dev_close_window ()
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
OWFMaxExtent := 750
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_...",12,401,
f8708a9c,micro,1,,"dev_close_window ()
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
OWFMaxExtent := 750
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_...",11,20,
f8708a9c,micro,2,,"gen_cam_par_line_scan_division (0.06, 0, 10e-6, 10e-6, Width / 2.0, 0, Width, Height, 0, 5e-5, 0, StartCamParam)",21,22,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
f8708a9c,micro,3,,"CalTabDescrFile := 'caltab_30mm.descr'
FMAPAlpha := 0.5
DCScaleFac := 1",23,27,
f8708a9c,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamParam)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescrFile)",28,32,"* --- Automatically Added Context ---
gen_cam_par_line_scan_division (0.06, 0, 10e-6, 10e-6, Width / 2.0, 0, Width, Height, 0, 5e-5, 0, StartCamParam)
CalTabDescrFile := 'caltab_30mm.descr'
* --- End ..."
f8708a9c,micro,5,"for all the calibration images and accumulate them in the
calibration data model.","for I := 1 to NumCalibImages by 1
read_image (Image, 'calib/calib_line_scan_' + I$'02d')
find_calib_object (Image, CalibDataID, 0, 0, I - 1, 'alpha', FMAPAlpha)
get_calib_data (CalibDataID, 'camera', 0, 'init_params', StartCamPar)
get_calib_data_observ_contours (Caltab, CalibDataID, 'caltab', 0, 0, ...",33,50,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
FMAPA..."
f8708a9c,micro,6,"By default all camera parameters are estimated by the camera
calibration.","dev_clear_window ()
disp_message (WindowHandle, 'Please wait...', 'window', 12, 12, 'black', 'true')
calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
dev_clear_window ()
Message := ['Error of the','calibration = ' + Error$'.2f']
disp_message (Windo...",51,63,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
Message := 'T..."
f8708a9c,micro,7,,"read_image (Image, 'caliper/caliper_line_scan')",64,66,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_01')
* --- End of Automatically Added Context ---"
f8708a9c,micro,8,as the new start parameter in the model.,"set_calib_data_cam_param (CalibDataID, 0, [], CamParam)",71,73,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
* --- End of Automatically Added Context..."
f8708a9c,micro,9,pose of the calibration plate.,"set_calib_data (CalibDataID, 'camera', 'general', 'excluded_settings', 'all')
set_calib_data (CalibDataID, 'camera', 'general', 'calib_settings', 'pose')
find_calib_object (Image, CalibDataID, 0, 0, NumCalibImages, 'alpha', FMAPAlpha)",74,78,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
FMAPAlpha := 0.5
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Auto..."
f8708a9c,micro,10,,"get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages, Row1, Column1, Index1, Pose)
calibrate_cameras (CalibDataID, ErrorPoseOnly)",79,81,"* --- Automatically Added Context ---
NumCalibImages := 17
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
f8708a9c,micro,11,,"get_calib_data (CalibDataID, 'calib_obj_pose', [0,NumCalibImages], 'pose', NFinalPose)
dev_display (Image)
get_calib_data_observ_contours (Caltab, CalibDataID, 'caltab', 0, 0, NumCalibImages)
dev_display (Caltab)
get_calib_data_observ_points (CalibDataID, 0, 0, I - 1, Row, Column, Index, StartPose)
...",82,93,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
creat..."
f8708a9c,micro,12,,"SCGrayBackground := 5
SCGrayCaltab := 120
SCGrayMarks := 15
SCScaleFac := 1
sim_caltab (SimImage, CalTabDescrFile, CamParam, NFinalPose, SCGrayBackground, SCGrayCaltab, SCGrayMarks, SCScaleFac)
dev_display (SimImage)
Message := ['Simulated image', 'of the calibration plate']
disp_message (WindowHand...",94,105,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
CalTabDescrFile := 'caltab_30mm.descr'
Message := 'The start pose of the ..."
f8708a9c,micro,13,"can be modified by transformations in the world coordinate system,
the calibration plate was not pla...","HMRLPhi := rad(21.8)
HMTLTx := 0
HMTLTy := 0
HMTLTz := 0.00673
pose_to_hom_mat3d (NFinalPose, HomMat3D)
hom_mat3d_rotate_local (HomMat3D, HMRLPhi, 'x', HomMat3D)
hom_mat3d_translate_local (HomMat3D, HMTLTx, HMTLTy, HMTLTz, HomMat3D)
hom_mat3d_to_pose (HomMat3D, PoseNewOrigin)",106,123,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'calib_obj_pose', [0,NumCalibImages], 'pose', NFinalPose)
* --- End of Automatically Added Context ---"
f8708a9c,micro,14,,"if (true)
Row := 1960
Col := 1525
Phi := 0.955
Length1 := 840
Length2 := 10
else
dev_display (Image)
draw_rectangle2 (WindowHandle, Row, Col, Phi, Length1, Length2)
endif
MPSigma := 1.5
MPThreshold := 3
MPTransition := 'negative'
MPSelect := 'all'
GCCXSize := 6
GCCXAngle := 0
gen_measure_rectangle2 ...",126,152,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, Wi..."
f8708a9c,micro,15,,"image_points_to_world_plane (CamParam, PoseNewOrigin, RowPitchLine, ColPitchLine, 'mm', X1, Y1)",153,155,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
hom_mat3d_to_pose (HomMat3D, PoseNewOrigin)
RowPitchLine := (RowEdgeFirst + RowEdgeSecond) / 2.0
Col..."
f8708a9c,micro,16,,"distance_pp (Y1[0:|Y1| - 2], X1[0:|X1| - 2], Y1[1:|Y1| - 1], X1[1:|X1| - 1], Distance)
ErrorPitchLines := gen_tuple_const(|Distance|,1) - Distance
disp_message (WindowHandle, 'Mean distance = ' + mean(Distance)$'.5f' + ' mm', 'window', 12, 12, 'black', 'true')
Message := 'Error:'
Message[1] := '  Me...",156,167,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
Message := 'The start pose of the          '
calibrate_cameras (CalibData..."
f8708a9c,micro,17,image that is projected into the measurement plane.,"dev_clear_window ()
parameters_image_to_world_plane_entire (Image, CamParam, PoseNewOrigin, Width, Height, ScaleForEntireImage, PoseForEntireImage)
if (true)
gen_image_to_world_plane_map (Map, CamParam, PoseForEntireImage, Width, Height, Width, Height, ScaleForEntireImage, 'bilinear')
map_image (Ima...",168,197,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, Wi..."
f8708a9c,micro,18,,"distance_pp (RowPitchLine[0:|RowPitchLine| - 2], ColPitchLine[0:|ColPitchLine| - 2], RowPitchLine[1:|RowPitchLine| - 1], ColPitchLine[1:|ColPitchLine| - 1], Distance)
Distance := Distance * ScaleForEntireImage * 1000.0
ErrorPitchLines := gen_tuple_const(|Distance|,1) - Distance
disp_message (WindowH...",198,210,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
Message := 'The start pose of the          '
calibrate_cameras (CalibData..."
f8708a9c,micro,19,the original image into the measurement plane,"ESPAlpha := 2
ESPLow := 20
ESPHigh := 40
SSXMin := 0.7
SSXMax := 1.0
FECXMaxNumPoints := -1
FECXMaxClosureDist := 0
FECXClippingEndPoints := 0
FECXVossTabSize := 200
FECXIterations := 3
FECXClippingFactor := 2",211,223,
f8708a9c,micro,20,,"get_calib_data_observ_contours (CaltabCont, CalibDataID, 'caltab', 0, 0, NumCalibImages)
gen_region_contour_xld (CaltabCont, Caltab, 'filled')
dev_clear_window ()
reduce_domain (Image, Caltab, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'canny', ESPAlpha, ESPLow, ESPHigh)
select_shape_xld (Edg...",224,242,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
creat..."
f8708a9c,micro,21,,"PITWPCCenterRow := 2500
PITWPCCenterCol := 1500
dev_clear_window ()
dev_display (ImageReduced)
dev_display (CrossMark)
parameters_image_to_world_plane_centered (CamParam, NFinalPose, PITWPCCenterRow, PITWPCCenterCol, Width, Height, ScaleForCenteredImage, PoseForCenteredImage)
image_to_world_plane (I...",245,253,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data ..."
f8708a9c,micro,22,,"dev_set_color ('yellow')
find_calib_object (ImageMappedCP, CalibDataID, 0, 0, NumCalibImages + 1, 'alpha', FMAPAlpha)
get_calib_data_observ_contours (CaltabCont, CalibDataID, 'caltab', 0, 0, NumCalibImages + 1)
gen_region_contour_xld (CaltabCont, Caltab, 'filled')
reduce_domain (ImageMappedCP, Calta...",254,262,"* --- Automatically Added Context ---
NumCalibImages := 17
FMAPAlpha := 0.5
create_calib_data ('calibration_object', 1, 1, CalibDataID)
get_calib_data_observ_contours (Caltab, CalibDataID, 'caltab', 0..."
f8708a9c,micro,23,,"pose_to_hom_mat3d (PoseForCenteredImage, HomMat3DForCenteredImage)
affine_trans_point_3d (HomMat3DForCenteredImage, XMarkFromWorldContours * ScaleForCenteredImage, YMarkFromWorldContours * ScaleForCenteredImage, gen_tuple_const(|XMarkFromWorldContours|,0), XCamMark, YCamMark, ZCamMark)
project_3d_po...",263,294,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, OWFMaxExtent, OWFMaxExtent, WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
GCCXSize :=..."
f8708a9c,micro,24,,"full_domain (Image, ImageFull)
get_domain (ImageFull, Domain)
gen_contour_region_xld (Domain, ImageBorder, 'border')
contour_to_world_plane_xld (ImageBorder, ImageBorderWCS, CamParam, Pose, 1)
smallest_rectangle1_xld (ImageBorderWCS, MinY, MinX, MaxY, MaxX)",295,300,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_01')
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data_observ_points (CalibDataID, 0, 0, NumC..."
f8708a9c,micro,25,,"ExtentX := MaxX - MinX
ExtentY := MaxY - MinY
ScaleX := ExtentX / WidthMappedImage
ScaleY := ExtentY / HeightMappedImage
ScaleForEntireImage := max([ScaleX,ScaleY])",301,306,"* --- Automatically Added Context ---
parameters_image_to_world_plane_entire (Image, CamParam, PoseNewOrigin, Width, Height, ScaleForEntireImage, PoseForEntireImage)
smallest_rectangle1_xld (ImageBord..."
f8708a9c,micro,26,,"set_origin_pose (Pose, MinX, MinY, 0, PoseForEntireImage)
return ()
DR := []
DC := []
D := []
num := |Row1|
for i := 0 to num - 1 by 1
distance_pp (gen_tuple_const(num,Row1[i]), gen_tuple_const(num,Col1[i]), Row2, Col2, Distance)
tuple_sort_index (Distance, Indices)
DR := [DR,Row1[i] - Row2[Indices[...",307,380,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages, Row1, Column1, Index1, Pose)
distance_pp (Y1[0:|Y1| - 2], X1[0:|X1| - 2], Y1[1:|Y1| - 1], X1[1:|X..."
f8708a9c,micro,27,"(here, the scale is determined such that in the
surroundings of the given point  the image scale of ...","Dist_ICS := 1
image_points_to_world_plane (CamParam, Pose, CenterRow, CenterCol, 1, CenterX, CenterY)
image_points_to_world_plane (CamParam, Pose, CenterRow + Dist_ICS, CenterCol, 1, BelowCenterX, BelowCenterY)
image_points_to_world_plane (CamParam, Pose, CenterRow, CenterCol + Dist_ICS, 1, RightOfC...",381,393,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages, Row1, Column1, Index1, Pose)
parame..."
f8708a9c,micro,28,"that the point given via get_mbutton will be in the center of the
mapped image","DX := CenterX - ScaleForCenteredImage * WidthMappedImage / 2.0
DY := CenterY - ScaleForCenteredImage * HeightMappedImage / 2.0
DZ := 0
set_origin_pose (Pose, DX, DY, DZ, PoseForCenteredImage)
return ()",394,417,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, 0, 0, NumCalibImages, Row1, Column1, Index1, Pose)
parameters_image_to_world_plane_centered (CamParam, NFinalPose, PITW..."
e320234f,full,0,autobahn.hdev: Fast detection of lane markers,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 768, 575, 'black', WindowID)
MinSize := 30
get_system ('init_new_image', Information)
set_system ('init_new_image', 'false')
gen_grid_region (Grid, MinSize, MinSize, 'lines', 512, 512)
clip_region (Grid, StreetGrid, 130, 10, 450, 5...",8,37,
e320234f,micro,1,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 768, 575, 'black', WindowID)
MinSize := 30
get_system ('init_new_image', Information)
set_system ('init_new_image', 'false')
gen_grid_region (Grid, MinSize, MinSize, 'lines', 512, 512)
clip_region (Grid, StreetGrid, 130, 10, 450, 5...",6,43,
88d8992c,full,0,"Application program to illustrate the segmentation
of board components with stereo methods
We have a...","dev_update_off ()
ImgPath := 'stereo/board/'
CalDescrFile := 'caltab_30mm.descr'
read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')
dev_close_window ()
get_image_size (ImageL, WidthL, HeightL)
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_se...",32,418,
88d8992c,micro,1,,dev_update_off (),30,32,
88d8992c,micro,2,,"ImgPath := 'stereo/board/'
CalDescrFile := 'caltab_30mm.descr'",33,35,
88d8992c,micro,3,,"read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')",36,38,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
* --- End of Automatically Added Context ---"
88d8992c,micro,4,,"dev_close_window ()
get_image_size (ImageL, WidthL, HeightL)
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_set_draw ('margin')
dev_set_color ('green')
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
get_image_size (ImageR, WidthR, HeightR)
dev_open_window (0, Widt...",39,50,"* --- Automatically Added Context ---
read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')
* --- End of Automatically Added Context ---"
88d8992c,micro,5,,"gen_cam_par_area_scan_division (0.0125, 0, 1.48e-5, 1.48e-5, WidthL / 2.0, HeightL / 2.0, WidthL, HeightL, StartCamPar)
create_calib_data ('calibration_object', 2, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 'all', [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, CalDescrFile...",54,59,"* --- Automatically Added Context ---
CalDescrFile := 'caltab_30mm.descr'
get_image_size (ImageL, WidthL, HeightL)
* --- End of Automatically Added Context ---"
88d8992c,micro,6,,"read_image (ImagesL, ImgPath + 'calib_l_' + [1:15]$'02d')
read_image (ImagesR, ImgPath + 'calib_r_' + [1:15]$'02d')",60,62,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
* --- End of Automatically Added Context ---"
88d8992c,micro,7,,"calibrate_stereo_setup (ImagesL, ImagesR, WindowHandle1, WindowHandle2, CalibDataID, StartCamPar, CalDescrFile, CamParamL, CamParamR, cLPcR, Errors)",63,64,"* --- Automatically Added Context ---
CalDescrFile := 'caltab_30mm.descr'
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', Win..."
88d8992c,micro,8,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, cLPcR, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",65,67,"* --- Automatically Added Context ---
calibrate_stereo_setup (ImagesL, ImagesR, WindowHandle1, WindowHandle2, CalibDataID, StartCamPar, CalDescrFile, CamParamL, CamParamR, cLPcR, Errors)
* --- End of ..."
88d8992c,micro,9,"The differences in row coordinates of all
calibration point correspondences should be minimal","map_image (ImagesL, MapL, ImagesRectL)
map_image (ImagesR, MapR, ImagesRectR)
check_epipolar_constraint (ImagesRectL, ImagesRectR, RectCamParL, RectCamParR, WindowHandle1, WindowHandle2, CalDescrFile, EpipolarError)
if (EpipolarError[1] &gt; 0.3)
disp_continue_message (WindowHandle2, 'black', 'true'...",69,82,"* --- Automatically Added Context ---
CalDescrFile := 'caltab_30mm.descr'
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', Win..."
88d8992c,micro,10,,"* gen_cam_par_area_scan_division (0.0131205, -665.85466, 1.4803422e-005, 1.48e-005, 155.90117, 126.703971, 320, 240, CamParamL)
* gen_cam_par_area_scan_division (0.0131712, -728.9579, 1.4799849e-005, 1.48e-005, 163.265701, 119.310684, 320, 240, CamParamR)
* cLPcR := [0.15350044, -0.003732778, 0.0448...",85,88,"* --- Automatically Added Context ---
calibrate_stereo_setup (ImagesL, ImagesR, WindowHandle1, WindowHandle2, CalibDataID, StartCamPar, CalDescrFile, CamParamL, CamParamR, cLPcR, Errors)
* --- End of ..."
88d8992c,micro,11,,"MaskWidth := 17
MaskHeight := 17
TextureThresh := 5
MinDisparity := 10
MaxDisparity := 40
NumLevels := 1
ScoreThresh := 0.1",89,96,
88d8992c,micro,12,,"dev_set_window (WindowHandle1)
read_image (ImageL, ImgPath + 'board_l_01')
emphasize (ImageL, ImageL, 7, 7, 1)
map_image (ImageL, MapL, ImageRectifiedL)
dev_display (ImageRectifiedL)
dev_set_window (WindowHandle2)
read_image (ImageR, ImgPath + 'board_r_01')
emphasize (ImageR, ImageR, 7, 7, 1)
map_im...",97,111,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')
dev_open_window (0, 0, WidthL, HeightL, 'black'..."
88d8992c,micro,13,,"binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', MaskWidth, MaskHeight, TextureThresh, MinDisparity, MaxDisparity, NumLevels, ScoreThresh, 'left_right_check', 'interpolation')",112,113,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, cLPcR, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR..."
88d8992c,micro,14,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (DistanceImage)",114,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamPa..."
88d8992c,micro,15,"(Attention: the distance values are not measured
in the rectified coordinate system anymore!)
Define...","gen_circle (Circle, [15, 208, 95], [58, 32, 211], [8, 8, 8])
union1 (Circle, RegionDefiningReferencePlane)
tilt_correction (DistanceImage, RegionDefiningReferencePlane, DistanceImageCorrected)
dev_set_window (WindowHandle2)
dev_clear_window ()
dev_display (DistanceImageCorrected)
disp_message (Windo...",118,133,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', WindowHandle2)
binocular_distance (Imag..."
88d8992c,micro,16,,"height_range_above_reference_plane (DistanceImageCorrected, HeightAboveReferencePlaneReduced, MinHeight, MaxHeight)
visualize_height_ranges (ImageRectifiedL, HeightAboveReferencePlaneReduced, WindowHandle2, 0.0004, 0.0015, 0.0015, 0.0025, 0.0025, 0.004)
dev_set_window (WindowHandle1)
dev_clear_windo...",134,167,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', WindowHandle2)
map_image (ImageL, MapL,..."
88d8992c,micro,17,,"count_obj (ImagesL, Number)
for I := 1 to Number by 1
select_obj (ImagesL, ImageL, I)
select_obj (ImagesR, ImageR, I)
find_calib_object (ImageL, CalibDataID, 0, 0, I, [], [])
find_calib_object (ImageR, CalibDataID, 1, 0, I, [], [])
get_calib_data_observ_points (CalibDataID, 0, 0, I, Row, Column, Ind...",168,187,"* --- Automatically Added Context ---
CalDescrFile := 'caltab_30mm.descr'
read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')
dev_open_window (0, 0, WidthL, HeightL..."
88d8992c,micro,18,,"calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParamL)
get_calib_data (CalibDataID, 'camera', 1, 'params', CamParamR)
get_calib_data (CalibDataID, 'camera', 1, 'pose', cLPcR)
return ()",188,221,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
calibrate_stereo_setup (ImagesL, ImagesR, WindowHandle1, WindowHandle2, CalibDataID, StartCamPar, CalD..."
88d8992c,micro,19,,"get_domain (DistanceImage, Domain)
intersection (RegionDefiningReferencePlane, Domain, RegionDefiningReferencePlane)",222,224,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', MaskWidth, MaskHeight, Te..."
88d8992c,micro,20,,"moments_gray_plane (RegionDefiningReferencePlane, DistanceImage, MRow, MCol, Alpha, Beta, Mean)",225,226,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', MaskWidth, MaskHeight, Te..."
88d8992c,micro,21,,"get_image_pointer1 (DistanceImage, Pointer, Type, Width, Height)
area_center (RegionDefiningReferencePlane, Area, Row, Column)
gen_image_surface_first_order (ReferencePlaneDistance, Type, Alpha, Beta, Mean, Row, Column, Width, Height)",227,230,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', MaskWidth, MaskHeight, Te..."
88d8992c,micro,22,,"sub_image (DistanceImage, ReferencePlaneDistance, DistanceImageWithoutTilt, 1, 0)",231,232,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', MaskWidth, MaskHeight, Te..."
88d8992c,micro,23,,CosGamma := 1.0 / sqrt(Alpha * Alpha + Beta * Beta + 1),233,234,"* --- Automatically Added Context ---
moments_gray_plane (RegionDefiningReferencePlane, DistanceImage, MRow, MCol, Alpha, Beta, Mean)
* --- End of Automatically Added Context ---"
88d8992c,micro,24,,"scale_image (DistanceImageWithoutTilt, DistanceImageCorrected, CosGamma, 0)
return ()",235,261,"* --- Automatically Added Context ---
tilt_correction (DistanceImage, RegionDefiningReferencePlane, DistanceImageCorrected)
moments_gray_plane (RegionDefiningReferencePlane, DistanceImage, MRow, MCol,..."
88d8992c,micro,25,"of the object. Then, the inverted corrected distance values
correspond to heights above the ground p...","invert_image (DistanceImageCorrected, HeightAboveReferencePlane)",262,265,"* --- Automatically Added Context ---
tilt_correction (DistanceImage, RegionDefiningReferencePlane, DistanceImageCorrected)
* --- End of Automatically Added Context ---"
88d8992c,micro,26,,"threshold (HeightAboveReferencePlane, Region, MinHeight, MaxHeight)
reduce_domain (HeightAboveReferencePlane, Region, HeightAboveReferencePlaneReduced)
return ()
dev_set_window (WindowHandle1)
dev_clear_window ()
get_image_size (HeightAboveReferencePlaneReduced, Width, Height)
dev_set_part (0, 0, He...",266,346,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
MinHeight := -0.0005
MaxHeight := 0.05
height_range_above_reference_plane (DistanceImageCorrected,..."
88d8992c,micro,27,"(the differences of the features' row coordinates should be small)
Parameter settings for find_calta...","SizeGauss := 3
MarkThresh := 120
MinDiamMarks := 5
StartThresh := 128
DeltaThresh := 10
MinThresh := 18
Alpha := 0.9
MinContLength := 15
MaxDiamMarks := 100
X := []
Rows := []
Cols := []
count_obj (ImagesRectL, NumImages)
if (NumImages &gt; 0)
RowsL := []
ColsL := []
RowsR := []
ColsR := []
for I :=...",347,433,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', WindowHandle2)
gen_binocular_rectificat..."
6c970b65,full,0,"**************************************************************************************************
P...","dev_close_window ()
dev_update_window ('off')
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
scale_image_max (Image1, Image1)
scale_image_max (Image2, Image2)
get_image_pointer1 (Image1, Pointer, Type, Width, Height)
ScaleImage := 0.4
dev_open_window (0...",10,88,
6c970b65,micro,1,"Projective rectification of a circuit board
********************************************************...","dev_close_window ()
dev_update_window ('off')
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
scale_image_max (Image1, Image1)
scale_image_max (Image2, Image2)
get_image_pointer1 (Image1, Pointer, Type, Width, Height)
ScaleImage := 0.4
dev_open_window (0...",6,26,
6c970b65,micro,2,,"points_harris (Image1, 3, 1, 0.2, 1e5, Row1, Col1)
points_harris (Image2, 3, 1, 0.2, 1e5, Row2, Col2)
match_fundamental_matrix_ransac (Image1, Image2, Row1, Col1, Row2, Col2, 'ncc', 21, 0, 200, 20, 50, 0, 0.9, 'gold_standard', 0.3, 1, FMatrix, CovFMat, Error, Points1, Points2)
Row1 := subset(Row1,Po...",27,37,"* --- Automatically Added Context ---
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
* --- End of Automatically Added Context ---"
6c970b65,micro,3,,"gen_binocular_proj_rectification (Map1, Map2, FMatrix, [], Width, Height, Width, Height, 1, 'bilinear_map', CovFMatRect, H1, H2)
map_image (Image1, Map1, Image1)
map_image (Image2, Map2, Image2)
projective_trans_pixel (H1, Row1, Col1, Row1, Col1)
projective_trans_pixel (H2, Row2, Col2, Row2, Col2)",38,46,"* --- Automatically Added Context ---
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
get_image_pointer1 (Image1, Pointer, Type, Width, Height)
points_har..."
6c970b65,micro,4,"Then, the left image is transformed such that points lying in this dominant plane do coincide in bot...","proj_match_points_ransac (Image1, Image2, Row1, Col1, Row2, Col2, 'ncc', 11, 0, 200, 100, 100, 0, 0.6, 'normalized_dlt', 2, 1, HomMat, Points1, Points2)
projective_trans_image (Image1, Image1, HomMat, 'bilinear', 'false', 'true')",47,52,"* --- Automatically Added Context ---
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
points_harris (Image1, 3, 1, 0.2, 1e5, Row1, Col1)
points_harris (Im..."
6c970b65,micro,5,"Regions close to the dominant plane are gray, whereas regions distant to this plane are red or cyan.","disp_continue_message (Window1, 'black', 'true')
stop ()
compose3 (Image1, Image2, Image2, Image)
get_image_pointer1 (Image, Pointer, Type, Width, Height)
dev_set_window (Window2)
dev_close_window ()
dev_set_window (Window1)
dev_clear_window ()
ScaleImage := 0.4
dev_set_window_extents (-1, -1, Width...",53,68,"* --- Automatically Added Context ---
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
get_image_pointer1 (Image1, Pointer, Type, Width, Height)
ScaleImage..."
6c970b65,micro,6,from the space point the reference plane.,"binocular_disparity (Image1, Image2, Disparity, Score, 'ncc', 15, 15, 5, -5, 5, 1, 0.8, 'left_right_check', 'interpolation')
disp_continue_message (Window1, 'black', 'true')
stop ()
dev_clear_window ()
dev_display (Disparity)
disp_message (Window1, 'Disparity map', 'window', 12, 12, 'black', 'true')...",69,94,"* --- Automatically Added Context ---
read_image (Image1, '/stereo/uncalib/board_l')
read_image (Image2, '/stereo/uncalib/board_r')
dev_open_window (0, 0, Width * ScaleImage, Height * ScaleImage, 'bla..."
e004b42a,full,0,"This example shows how to use the calculate_feature_set
procedure library together with the automati...","dev_close_window ()
dev_update_off ()
read_image (Image, 'color/pills_class_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_colored (12)
PillNames := ['big_round_red...",19,139,
e004b42a,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'color/pills_class_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_colored (12)
PillNames := ['big_round_red...",18,31,
e004b42a,micro,2,,"query_feature_group_names (AvailableGroupNames)
query_feature_names_by_group (AvailableGroupNames, AvailableFeatureNames, AvailableCorrespondingGroups)",32,35,
e004b42a,micro,3,calculate_feature_set library procedures.,"FeatureGroups := ['region', 'color']
get_feature_names (FeatureGroups, FeatureNames)
get_feature_lengths (FeatureNames, FeatureLengths)",36,41,
e004b42a,micro,4,,"create_class_train_data (sum(FeatureLengths), ClassTrainDataHandle)
set_feature_lengths_class_train_data (ClassTrainDataHandle, FeatureLengths, FeatureNames)",42,45,"* --- Automatically Added Context ---
get_feature_names (FeatureGroups, FeatureNames)
get_feature_lengths (FeatureNames, FeatureLengths)
* --- End of Automatically Added Context ---"
e004b42a,micro,5,,"for I := 1 to 10 by 1
read_image (Image, 'color/pills_class_' + I$'.2d')
segment_pills (Image, Pills)
dev_display (Image)
dev_set_color ('white')
dev_display (Pills)
disp_message (WindowHandle, 'Collecting ' + PillNames[I - 1] + ' samples', 'window', 12, 12, 'black', 'true')
count_obj (Pills, Number...",46,74,"* --- Automatically Added Context ---
read_image (Image, 'color/pills_class_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
PillNames := ['big_round_red', 'round_green', 'small_roun..."
e004b42a,micro,6,,"disp_message (WindowHandle, 'Selecting optimal features...', 'window', 90, 12, 'black', 'true')
select_feature_set_svm (ClassTrainDataHandle, 'greedy', [], [], SVMHandle, SelectedFeatures, Score)
disp_message (WindowHandle, ['Selected:',SelectedFeatures], 'window', 120, 12, 'black', 'true')
disp_con...",75,81,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_class_train_data (sum(FeatureLengths), ClassTrainDataHandle)
* --- End of Automatically Added..."
e004b42a,micro,7,"using the automatically trained classifier with the
automatically selected features","dev_set_line_width (4)
dev_set_colored (12)
for I := 1 to 3 by 1
read_image (Image, 'color/pills_test_' + I$'.2d')
dev_display (Image)
segment_pills (Image, Pills)
PillsIDs := []
count_obj (Pills, NPills)
for P := 1 to NPills by 1
select_obj (Pills, PillSelected, P)
calculate_features (PillSelected,...",82,129,"* --- Automatically Added Context ---
read_image (Image, 'color/pills_class_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
PillColors := ['#D08080', '#ADC691', '#FFB0A1', '#D5C398'..."
e004b42a,micro,8,,"decompose3 (Image, ImageR, ImageG, ImageB)
threshold (ImageR, RegionR, 0, 60)
threshold (ImageB, RegionB, 0, 100)
union2 (RegionR, RegionB, RegionUnion)
closing_circle (RegionUnion, RegionClosing, 2.5)
connection (RegionClosing, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'are...",130,148,"* --- Automatically Added Context ---
read_image (Image, 'color/pills_class_01')
segment_pills (Image, Pills)
* --- End of Automatically Added Context ---"
5d6a2c42,full,0,"Extraction of high objects from a digital surface model (DSM)
Read DSM and gray image","read_image (Mreut, 'mreut_y')
read_image (DSM, 'mreut_dgm_2.0')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Mreut)
disp_message (WindowHandle, 'Gray image', 'window', 12, 12, 'black', 'true')
di...",9,54,
5d6a2c42,micro,1,,"read_image (Mreut, 'mreut_y')
read_image (DSM, 'mreut_dgm_2.0')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)",8,12,
5d6a2c42,micro,2,,"set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",13,14,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
5d6a2c42,micro,3,,"dev_display (Mreut)
disp_message (WindowHandle, 'Gray image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",15,19,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
5d6a2c42,micro,4,,"dev_set_lut ('change3')
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, 8, 8, 0, 0, HomMat2DScale)
hom_mat2d_translate (HomMat2DScale, -250, -600, HomMat2DTranslate)
affine_trans_image (DSM, DSMAffineTrans, HomMat2DTranslate, 'constant', 'false')
crop_part (DSMAffineTrans, D...",20,34,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
read_image (DSM, 'mreut_dgm_2.0')
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
* --- End of Automatically Added Context -..."
5d6a2c42,micro,5,,"zoom_image_factor (DSMPart, DSMZoomed, 0.125, 0.125, 'weighted')
dual_rank (DSMZoomed, DEMZoomed, 'circle', 9, 10, 'mirrored')
zoom_image_factor (DEMZoomed, DEM, 8, 8, 'weighted')
scale_image_max (DEM, DEMScaled)
dev_set_paint ('3d_plot')
dev_clear_window ()
dev_display (DEMScaled)
disp_message (Win...",35,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
crop_part (DSMAffineTrans, DSMPart, 0, 0, 512, 512)
disp_message (WindowHandle, 'Digital Surface Model', '..."
5d6a2c42,micro,6,,"sub_image (DSMPart, DEM, HighObjects, 1, 0)
scale_image_max (HighObjects, HighObjectsScaled)
compose2 (HighObjectsScaled, Mreut, HighObjectsTextured)
dev_set_paint (['3d_plot', 'texture'])
dev_clear_window ()
dev_display (HighObjectsTextured)
disp_message (WindowHandle, 'High Objects', 'window', 12,...",46,60,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
crop_part (DSMAffineTrans, DSMPart, 0, 0, 512, 512)
zoom_image_factor (DEMZo..."
7465fa8d,full,0,,"dev_close_window ()
read_image (Mreut, 'mreut_y')
read_image (MreutDem, 'mreut_dgm_2.0')
get_image_size (Mreut, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
get_system ('clip_region', Information)
set_system ('clip_region', 'false')
dev_set_draw ('margin')
dev_set_colo...",6,39,
7465fa8d,micro,1,,"texture_laws (Mreut, ImageTexture, 'ee', 2, 5)
median_separate (ImageTexture, ImageSMedian, 25, 25, 'mirrored')
threshold (ImageSMedian, TexturedRegion, 30, 255)
dev_display (Mreut)
dev_display (TexturedRegion)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",15,22,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
7465fa8d,micro,2,,"scale_image_max (MreutDem, ImageScaleMax)
dual_rank (ImageScaleMax, ImageRank, 'circle', 15, 10, 'mirrored')
sub_image (ImageScaleMax, ImageRank, ImageSubRank, 1, 0)
threshold (ImageSubRank, High, 5, 255)
zoom_region (High, HighLarge, 8, 8)
move_region (HighLarge, HighLargeMoved, -250, -600)
clip_re...",23,45,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
read_image (MreutDem, 'mreut_dgm_2.0')
get_system ('clip_region', Information)
threshold (ImageSMedian, TexturedRegion, 30, 255)
* -..."
e282f18c,full,0,"This example finds pages of articles in a picture database.
In the first step different pages are tr...","dev_update_off ()
dev_close_window ()
read_image (Image, 'brochure/brochure_page_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_display (Image)
ModelIDs ...",12,134,
e282f18c,micro,1,"In the first step different pages are trained and models are created.
Afterwards unknown images are ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'brochure/brochure_page_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_display (Image)",6,20,
e282f18c,micro,2,,"ModelIDs := []
ModelsFound := 0
NumPoints := []
NumModels := 3
TotalTime := 0",21,27,
e282f18c,micro,3,,"RowRoi := [10, 10,Height - 10,Height - 10]
ColRoi := [10,Width - 10,Width - 10,10]
gen_rectangle1 (Rectangle, 10, 10, Height - 10, Width - 10)
disp_message (WindowHandle, ['Press \'Run\' to start model creation ...', '(may take a few minutes)'], 'window', 10, 10, 'black', 'true')
disp_continue_messa...",28,35,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
e282f18c,micro,4,,"for Index := 1 to NumModels by 1
read_image (Image, 'brochure/brochure_page_' + Index$'.2')
rgb1_to_gray (Image, ImageGray)
get_image_size (ImageGray, Width, Height)
reduce_domain (ImageGray, Rectangle, ImageReduced)
dev_clear_window ()
dev_display (ImageGray)
disp_message (WindowHandle, 'Creating m...",36,62,"* --- Automatically Added Context ---
read_image (Image, 'brochure/brochure_page_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
ModelIDs := []..."
e282f18c,micro,5,,"dev_display (ImageGray)
disp_message (WindowHandle, NumModels + ' models created in ' + TotalTime$'.4' + ' seconds.', 'window', 10, 10, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",63,68,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
NumModels := 3
TotalTime := 0
rgb1_to_gray (Image, ImageGray)
* --- End of Automatically Added Conte..."
e282f18c,micro,6,,"read_image (Image, 'brochure/brochure_01')
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",69,73,"* --- Automatically Added Context ---
read_image (Image, 'brochure/brochure_page_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
e282f18c,micro,7,Search the models in all images,"for Index1 := 1 to 12 by 1
OutputString := []
NumMsgs := 0
ModelsFound := 0
TotalTime := 0
read_image (Image, 'brochure/brochure_' + Index1$'.2')
rgb1_to_gray (Image, ImageGray)
dev_display (Image)
disp_message (WindowHandle, 'Searching image ...', 'window', 10, 10, 'black', 'true')
for Index2 := 0 ...",74,140,"* --- Automatically Added Context ---
read_image (Image, 'brochure/brochure_page_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
ModelIDs := []
ModelsFound := 0
NumPoints := []
Tota..."
0120d7df,full,0,,"dev_close_window ()
dev_update_window ('off')
read_image (Forest, 'forest_air1')
get_image_size (Forest, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
decompose3 (Forest, Red, Green, Blue)
dev_display (Red)
threshold (Blue, BlueBright, 80, 255)
connection (BlueBright, B...",6,71,
9e24a39f,full,0,"Example program which demonstrates
The principal component analysis
Data reduction based on the prin...","read_image (BavariaNorth7Channels, 'bavaria_north_7_channels.jp2')
get_image_size (BavariaNorth7Channels, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_principal_comp_trans (Bav...",11,69,
9e24a39f,micro,1,"The principal component analysis
Data reduction based on the principal component analysis
Classifica...","read_image (BavariaNorth7Channels, 'bavaria_north_7_channels.jp2')
get_image_size (BavariaNorth7Channels, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,15,
9e24a39f,micro,2,,"gen_principal_comp_trans (BavariaNorth7Channels, Trans, TransInv, Mean, Cov, InfoPerComp)
linear_trans_color (BavariaNorth7Channels, ImageTrans, Trans)
decompose7 (ImageTrans, Channel1, Channel2, Channel3, Channel4, Channel5, Channel6, Channel7)
scale_image (Channel1, ImageScaled1, 1, 100)
scale_ima...",16,23,"* --- Automatically Added Context ---
read_image (BavariaNorth7Channels, 'bavaria_north_7_channels.jp2')
* --- End of Automatically Added Context ---"
9e24a39f,micro,3,,"gen_rectangle1 (Water, 970, 598, 998, 624)
gen_rectangle1 (Forest, 38, 428, 95, 488)
gen_rectangle1 (Field, 300, 462, 320, 483)
gen_cluster (Water, Channel1Byte, Channel2Byte, ClusterWater)
gen_cluster (Forest, Channel1Byte, Channel2Byte, ClusterForest)
gen_cluster (Field, Channel1Byte, Channel2Byte...",24,30,"* --- Automatically Added Context ---
convert_image_type (ImageScaled1, Channel1Byte, 'byte')
convert_image_type (ImageScaled2, Channel2Byte, 'byte')
* --- End of Automatically Added Context ---"
9e24a39f,micro,4,,"class_2dim_sup (Channel1Byte, Channel2Byte, ClusterWater, Water)
class_2dim_sup (Channel1Byte, Channel2Byte, ClusterForest, Forest)
class_2dim_sup (Channel1Byte, Channel2Byte, ClusterField, Field)",31,34,"* --- Automatically Added Context ---
convert_image_type (ImageScaled1, Channel1Byte, 'byte')
convert_image_type (ImageScaled2, Channel2Byte, 'byte')
gen_rectangle1 (Water, 970, 598, 998, 624)
gen_rec..."
9e24a39f,micro,5,,"dev_display (Channel1Byte)
dev_set_color ('blue')
dev_display (Water)
dev_set_color ('lime green')
dev_display (Field)
dev_set_color ('forest green')
dev_display (Forest)
disp_message (WindowHandle, 'Forest', 'window', 10, 10, 'forest green', 'true')
disp_message (WindowHandle, 'Water', 'window', 50...",35,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
convert_image_type (ImageScaled1, Channel1Byte, 'byte')
convert_image_type (ImageScaled2, Cha..."
4058a22c,full,0,Different methods to extract high objects,"dev_close_window ()
read_image (Mreut, 'mreut_y')
get_image_size (Mreut, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (MreutDem, 'mreut_dgm_2.0')
scale_image_max (MreutDem, ImageScaleMax)
get_system ('clip_region', Information)
set_system ('clip_region', 'fa...",8,50,
4058a22c,micro,1,,dev_close_window (),6,8,
4058a22c,micro,2,,"read_image (Mreut, 'mreut_y')
get_image_size (Mreut, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (MreutDem, 'mreut_dgm_2.0')
scale_image_max (MreutDem, ImageScaleMax)",9,14,
4058a22c,micro,3,,"get_system ('clip_region', Information)
set_system ('clip_region', 'false')
dev_set_draw ('margin')
dev_set_color ('red')",15,19,
4058a22c,micro,4,,"dual_rank (ImageScaleMax, ImageRank, 'circle', 15, 10, 'mirrored')
sub_image (ImageScaleMax, ImageRank, ImageSubRank, 1, 0)
threshold (ImageSubRank, High, 7, 255)
zoom_region (High, HighZoomed, 8, 8)
move_region (HighZoomed, HighZoomedMoved, -250, -600)
clip_region (HighZoomedMoved, HighAreas, 0, 0,...",20,30,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
scale_image_max (MreutDem, ImageScaleMax)
* --- End of Automatically Ad..."
4058a22c,micro,5,,"gen_disc_se (SE, 'real', 30, 30, 0)
gray_tophat (MreutDem, SE, ImageTopHat)
threshold (ImageTopHat, High, 4, 1000)
zoom_region (High, HighZoomed, 8, 8)
move_region (HighZoomed, HighZoomedMoved, -250, -600)
clip_region (HighZoomedMoved, HighAreas, 0, 0, 511, 511)
dev_display (Mreut)
dev_display (High...",31,41,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (MreutDem, 'mreut_dgm_2.0')
threshold (ImageSubRank, High, 7..."
4058a22c,micro,6,,"mean_image (ImageScaleMax, ImageMean, 51, 51)
dyn_threshold (ImageScaleMax, ImageMean, High, 4, 'light')
zoom_region (High, HighZoomed, 8, 8)
move_region (HighZoomed, HighZoomedMoved, -250, -600)
clip_region (HighZoomedMoved, HighAreas, 0, 0, 511, 511)
dev_display (Mreut)
dev_display (HighAreas)
set...",42,56,"* --- Automatically Added Context ---
read_image (Mreut, 'mreut_y')
scale_image_max (MreutDem, ImageScaleMax)
get_system ('clip_region', Information)
threshold (ImageSubRank, High, 7, 255)
zoom_region..."
75daeea6,full,0,"This example shows how to find a cookie box aligned in different
directions with the descriptor base...","ReCreateDescrModel := false
dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (4)
dev_set_color ('bl...",15,139,
75daeea6,micro,1,"directions with the descriptor based matching feature. First, a
model and a reference pose are compu...","ReCreateDescrModel := false
dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (4)
dev_set_color ('bl...",6,32,
75daeea6,micro,2,,"vector_to_pose (WorldX, WorldY, [], RowsRoi, ColumnsRoi, CamParam, 'iterative', 'error', Pose, Quality)
image_points_to_world_plane (CamParam, Pose, RowsRoi, ColumnsRoi, 'm', XOuterBox, YOuterBox)",33,35,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0155565, -109.42, 1.28008e-005, 1.28e-005, 322.78, 240.31, 640, 480, CamParam)
RowsRoi := [224, 224, 406, 406]
ColumnsRoi := [11..."
75daeea6,micro,3,,"gen_rectangle1 (Rectangle, 224, 115, 406, 540)
reduce_domain (Image, Rectangle, ImageReduced)",36,39,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_01')
* --- End of Automatically Added Context ---"
75daeea6,micro,4,several minutes dependent on the hardware.,"dev_display (Image)
if (ReCreateDescrModel)
dev_display (Rectangle)
disp_message (WindowHandle, 'Creating the descriptor-based model ... \n(may take a minute)', 'window', 10, 10, 'black', 'true')
count_seconds (SecondsCreation1)
create_calib_descriptor_model (ImageReduced, CamParam, Pose, 'harris_bi...",40,86,"* --- Automatically Added Context ---
ReCreateDescrModel := false
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_divi..."
75daeea6,micro,5,search model in image sequence,"for Index := 1 to 10 by 1
OutputString := []
read_image (Image, 'packaging/cookie_box_' + Index$'.02')
dev_display (Image)
count_seconds (Seconds1)
find_calib_descriptor_model (Image, ModelID, [], [], [], [], 0.25, 1, CamParam, 'num_points', Pose, Score)
count_seconds (Seconds2)
Time := Seconds2 - S...",87,145,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0155565, -109.42, 1...."
cb9693ef,full,0,"This example shows a cookie box from different views.
First, models from reference poses are trained...","dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Row1Roi := [224, 224, 224, 128]
Col1Roi := [122, 112, 218, ...",12,136,
cb9693ef,micro,1,"First, models from reference poses are trained.
In the second step these models are searched in ever...","dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",6,18,
cb9693ef,micro,2,,"Row1Roi := [224, 224, 224, 128]
Col1Roi := [122, 112, 218, 130]
Row2Roi := [406, 406, 410, 406]
Col2Roi := [550, 540, 497, 556]
XWorldBox := []
YWorldBox := []
Models := []
NumModels := 4
TimeCreation := 0
TotalTime := 0",19,30,
cb9693ef,micro,3,,"XMod1To4 := [-189, 189, 189, -189, -189, 189, 189, -189, -120, 120, 120, -120, -185, 185, 185, -185] / 1000.0
YMod1To4 := [-80, -80, 80, 80, -80, -80, 80, 80, -80, -80, 80, 80, -120, -120, 120, 120] / 1000.0",31,34,
cb9693ef,micro,4,,"gen_cam_par_area_scan_division (0.0155565, -109.42, 1.28008e-005, 1.28e-005, 322.78, 240.31, 640, 480, CamParam)
dev_display (Image)
disp_message (WindowHandle, ['Press \'Run\' to start model creation ...', '(will take a few minutes)'], 'window', 10, 10, 'black', 'true')
disp_continue_message (Windo...",35,41,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
cb9693ef,micro,5,,"for IndexR := 0 to NumModels - 1 by 1
read_image (Image, 'packaging/cookie_box_reference_' + (IndexR + 1)$'.02')
gen_rectangle1 (Rectangle, Row1Roi[IndexR], Col1Roi[IndexR], Row2Roi[IndexR], Col2Roi[IndexR])
dev_display (Image)
dev_set_line_width (4)
dev_set_color ('blue')
dev_display (Rectangle)
re...",42,68,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Row1Roi := [224, 224, 224, 128]
Col1Roi := [..."
cb9693ef,micro,6,,"dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
disp_message (WindowHandle, NumModels + ' models created in ' + TimeCreation + ' seconds.', 'window', 10, 10, 'black', 'true')
stop ()",69,74,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
NumModels := 4
TimeCreation := 0
* --- End o..."
cb9693ef,micro,7,Search the models in all images,"for Index := 11 to 21 by 1
InstancesFound := 0
OutputString := []
TextRow := 10
TotalTime := 0
dev_clear_window ()
read_image (Image, 'packaging/cookie_box_' + Index$'.02')
dev_display (Image)
disp_message (WindowHandle, 'Searching image ...', 'window', 10, 10, 'black', 'true')
for Index1 := 0 to Nu...",75,142,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_reference_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
XWorldBox := []
YWorldBox := []
Models := []..."
88ff665c,full,0,"This example program shows how to read DXF files and how to
use this CAD description of objects to g...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
Colors := ['red...",35,206,
88ff665c,micro,1,"- The model images are created from the DXF description of
the objects.
- The parameters of the oper...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)",11,43,
88ff665c,micro,2,models in the visualization code below.,"Colors := ['red', 'green', 'cyan']",44,46,
88ff665c,micro,3,"represent the different models. They are used below to overlay
the found models on the current image...","gen_empty_obj (Models)
IndexS := []
IndexE := []",47,57,
88ff665c,micro,4,created below.,ModelIDs := [],58,60,
88ff665c,micro,5,"of the different models.  They are necessary to transform the
models to the found instances in the c...","for J := 1 to 3 by 1
dev_clear_window ()
read_contour_xld_dxf (Contours, 'metal-part-' + J$'02', [], [], DxfStatus)
gen_model_image_of_bright_object_with_holes (Contours, Image, 3.38, 646, 482)
dev_display (Image)
dev_set_color ('green')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandl...",61,165,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
Colors := ['red', 'green', 'cyan']
gen_empty_obj (Models)
IndexS := []
IndexE := []
ModelIDs := []
* --- E..."
88ff665c,micro,6,to classify the contours into outer boundaries and holes,"gen_empty_obj (EmptyObject)
difference_closed_contours_xld (Contours, EmptyObject, ContoursClassified)
gen_empty_obj (Boundaries)
gen_empty_obj (Holes)
count_obj (ContoursClassified, Number)
for i := 1 to Number by 1
select_obj (ContoursClassified, ObjectSelected, i)
get_contour_global_attrib_xld (O...",166,219,"* --- Automatically Added Context ---
read_contour_xld_dxf (Contours, 'metal-part-' + J$'02', [], [], DxfStatus)
area_center (Domain, Area, Row, Column)
vector_angle_to_rigid (0, 0, 0, Row[J], Column[..."
fd72bf97,full,0,"This example program shows how to use HALCON's shape-based
matching to find multiple different model...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
Colors := ['blue', 'orange', 'yellow']
Row1 := [135, 150, 185]
Colum...",9,98,
fd72bf97,micro,1,"matching to find multiple different models in one call to
find_generic_shape_model.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",6,15,
fd72bf97,micro,2,models in the visualization code below.,"Colors := ['blue', 'orange', 'yellow']",16,18,
fd72bf97,micro,3,,"Row1 := [135, 150, 185]
Column1 := [250, 170, 220]
Row2 := [375, 310, 335]
Column2 := [355, 395, 375]",20,24,
fd72bf97,micro,4,maximal performance.,"MinScore := [0.55, 0.6, 0.75]
Greediness := [0.6, 0.6, 0.95]
MaxOverlap := [0.15, 0.45, 0.0]
MinContrast := [20, 25, 7]",25,30,
fd72bf97,micro,5,created below.,"ModelIDs := []
for J := 0 to 2 by 1
read_image (Image, 'metal-parts/metal-part-model-' + (J + 1)$'02d')
dev_display (Image)
dev_disp_text ('Generating shape model ' + (J + 1)$'d', 'window', 20, 20, 'green', 'box', 'false')
gen_rectangle1 (ModelROI, Row1[J], Column1[J], Row2[J], Column2[J])
area_cent...",31,104,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
Colors := ['blue', 'orange', 'yellow']
Row1 := [135, 150, 185]
Column1 := [250, 170, 220]
Row2 := [375, 31..."
9e3e803d,full,0,"This example demonstrates how to extract roads from an aerial
image.
For the road extraction it is a...","dev_update_off ()
dev_close_window ()
dev_close_window ()
read_image (Image, 'mreut4_3')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle1, 'Extract the roads from an aerial ima...",19,162,
9e3e803d,micro,1,"image.
For the road extraction it is assumed that a road consists of
two parallel edges with homogen...","dev_update_off ()
dev_close_window ()
dev_close_window ()",6,22,
9e3e803d,micro,2,,"read_image (Image, 'mreut4_3')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle1, 'Extract the roads from an aerial image', 'window', 12, 12, 'black', 'true')
disp_continue_mess...",23,31,
9e3e803d,micro,3,,"threshold (Image, Region, 160, 255)
reduce_domain (Image, Region, ImageReduced)",32,35,"* --- Automatically Added Context ---
read_image (Image, 'mreut4_3')
* --- End of Automatically Added Context ---"
9e3e803d,micro,4,,"MaxLineWidth := 5
Contrast := 70
calculate_lines_gauss_parameters (MaxLineWidth, Contrast, Sigma, Low, High)
lines_gauss (ImageReduced, RoadCenters, Sigma, Low, High, 'light', 'true', 'bar-shaped', 'true')
dev_set_color ('red')
dev_display (Image)
dev_display (RoadCenters)
disp_message (WindowHandle...",36,47,"* --- Automatically Added Context ---
read_image (Image, 'mreut4_3')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
reduce_domain (Image, Region, ImageReduced)
* --- End of Automatical..."
9e3e803d,micro,5,of the first image,"read_image (ImagePart, 'mreut_y')
get_image_size (ImagePart, PartWidth, PartHeight)
dev_resize_window_fit_image (ImagePart, 0, 0, -1, -1)
dev_set_part (0, 0, PartWidth - 1, PartHeight - 1)
dev_set_line_width (2)
dev_display (ImagePart)
disp_message (WindowHandle1, 'Zoomed image part of the aerial im...",48,59,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
9e3e803d,micro,6,"-------------------------
Extract and segment edges","edges_image (ImagePart, PartAmp, PartDir, 'mderiche2', 0.3, 'nms', 20, 40)
threshold (PartAmp, EdgeRegion, 1, 255)",60,65,"* --- Automatically Added Context ---
read_image (ImagePart, 'mreut_y')
* --- End of Automatically Added Context ---"
9e3e803d,micro,7,and convert it into XLD contours,"clip_region (EdgeRegion, ClippedEdges, 2, 2, PartWidth - 3, PartHeight - 3)
skeleton (ClippedEdges, EdgeSkeleton)
gen_contours_skeleton_xld (EdgeSkeleton, EdgeContours, 1, 'filter')",66,71,"* --- Automatically Added Context ---
get_image_size (ImagePart, PartWidth, PartHeight)
threshold (PartAmp, EdgeRegion, 1, 255)
* --- End of Automatically Added Context ---"
9e3e803d,micro,8,,"gen_polygons_xld (EdgeContours, EdgePolygons, 'ramer', 2)",72,74,"* --- Automatically Added Context ---
gen_contours_skeleton_xld (EdgeSkeleton, EdgeContours, 1, 'filter')
* --- End of Automatically Added Context ---"
9e3e803d,micro,9,,"dev_set_color ('blue')
dev_display (ImagePart)
dev_display (EdgePolygons)
disp_message (WindowHandle1, 'Approximated edges', 'window', 12, 12, 'blue', 'true')
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",75,82,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
read_image (ImagePart, 'mreut_y')
gen_polygons_xld (EdgeContours, EdgePolygons, 'ramer', 2)
* --- E..."
9e3e803d,micro,10,,"gen_parallels_xld (EdgePolygons, ParallelEdges, 10, 30, 0.15, 'true')",89,91,"* --- Automatically Added Context ---
gen_polygons_xld (EdgeContours, EdgePolygons, 'ramer', 2)
* --- End of Automatically Added Context ---"
9e3e803d,micro,11,"polygons with a quality factor &gt; 0.3 (ModParallelRoadEdges).
These polygons are then extended by ...","mod_parallels_xld (ParallelEdges, ImagePart, ModParallelEdges, ExtParallelEdges, 0.3, 160, 220, 10)",92,97,"* --- Automatically Added Context ---
read_image (ImagePart, 'mreut_y')
gen_parallels_xld (EdgePolygons, ParallelEdges, 10, 30, 0.15, 'true')
* --- End of Automatically Added Context ---"
9e3e803d,micro,12,,"dev_set_color ('green')
dev_display (ModParallelEdges)
disp_message (WindowHandle1, 'Parallel edges', 'window', 35, 12, 'forest green', 'true')
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()
dev_set_color ('orange')
dev_display (ExtParallelEdges)
disp_message (WindowHandle1, 'Extende...",98,109,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
mod_parallels_xld (ParallelEdges, ImagePart, ModParallelEdges, ExtParallelEdges, 0.3, 160, 220, 10)..."
9e3e803d,micro,13,and then add a scaling and a translation,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, 8, 8, 0, 0, HomMat2DScale)
hom_mat2d_translate (HomMat2DScale, -250, -600, HomMat2DTranslate)",115,120,
9e3e803d,micro,14,,"affine_trans_contour_xld (RoadCenters, ScaledRoadCenters, HomMat2DTranslate)",121,123,"* --- Automatically Added Context ---
lines_gauss (ImageReduced, RoadCenters, Sigma, Low, High, 'light', 'true', 'bar-shaped', 'true')
hom_mat2d_translate (HomMat2DScale, -250, -600, HomMat2DTranslate..."
9e3e803d,micro,15,and then approximate them by polygons,"clip_contours_xld (ScaledRoadCenters, ClippedRoadCenters, 0, 0, 512, 512)
gen_polygons_xld (ClippedRoadCenters, RoadCenterPolygons, 'ramer', 2)",124,128,"* --- Automatically Added Context ---
affine_trans_contour_xld (RoadCenters, ScaledRoadCenters, HomMat2DTranslate)
* --- End of Automatically Added Context ---"
9e3e803d,micro,16,,"dev_set_color ('red')
dev_display (RoadCenterPolygons)
disp_message (WindowHandle1, 'Road centers', 'window', 58, 12, 'red', 'true')
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",129,135,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
disp_message (WindowHandle1, 'Road centers', 'window', 12, 12, 'black', 'true')
gen_polygons_xld (C..."
9e3e803d,micro,17,------------------,"combine_roads_xld (EdgePolygons, ModParallelEdges, ExtParallelEdges, RoadCenterPolygons, RoadSides, rad(40), rad(20), 40, 40)",136,139,"* --- Automatically Added Context ---
gen_polygons_xld (EdgeContours, EdgePolygons, 'ramer', 2)
mod_parallels_xld (ParallelEdges, ImagePart, ModParallelEdges, ExtParallelEdges, 0.3, 160, 220, 10)
gen_..."
9e3e803d,micro,18,,"dev_open_window (0, PartWidth + 10, 512, 512, 'black', WindowHandle2)
dev_set_part (0, 0, PartWidth - 1, PartHeight - 1)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_set_color ('green')
dev_display (ImagePart)
dev_display (RoadSides)
disp_message (WindowHa...",140,149,"* --- Automatically Added Context ---
read_image (ImagePart, 'mreut_y')
get_image_size (ImagePart, PartWidth, PartHeight)
combine_roads_xld (EdgePolygons, ModParallelEdges, ExtParallelEdges, RoadCente..."
9e3e803d,micro,19,and road centers again for visualization,"dev_set_window (WindowHandle1)
dev_display (ImagePart)
dev_set_color ('blue')
dev_display (EdgePolygons)
dev_set_color ('orange')
dev_display (ExtParallelEdges)
dev_set_color ('red')
dev_display (RoadCenterPolygons)
disp_message (WindowHandle1, 'Approximated edges', 'window', 12, 12, 'blue', 'true')...",150,168,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
disp_message (WindowHandle1, 'Road centers', 'window', 12, 12, 'black', 'true')
read_image (ImagePa..."
2d555b3b,full,0,Find textured areas (trees and bushes),"dev_close_window ()
Interactive := 0
dev_close_window ()
read_image (MreutHill, 'mreut_y')
get_image_size (MreutHill, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
texture_laws (MreutHill, SS, 'ss', 0, 5)
texture_laws (MreutHill, EE, 'ee', 2, 5)
median_separate (SS, SSM...",8,47,
2d555b3b,micro,1,,"dev_close_window ()
Interactive := 0
dev_close_window ()
read_image (MreutHill, 'mreut_y')
get_image_size (MreutHill, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,13,
2d555b3b,micro,2,,"texture_laws (MreutHill, SS, 'ss', 0, 5)
texture_laws (MreutHill, EE, 'ee', 2, 5)",14,16,"* --- Automatically Added Context ---
read_image (MreutHill, 'mreut_y')
* --- End of Automatically Added Context ---"
2d555b3b,micro,3,,"median_separate (SS, SSMed, 25, 25, 'mirrored')
median_separate (EE, EEMed, 25, 25, 'mirrored')
dev_display (MreutHill)
if (Interactive)
draw_region (TestReg, WindowHandle)
else
gen_rectangle1 (TestReg, 376, 221, 466, 246)
endif",17,25,"* --- Automatically Added Context ---
Interactive := 0
read_image (MreutHill, 'mreut_y')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
texture_laws (MreutHill, SS, 'ss', 0, 5)
texture_l..."
2d555b3b,micro,4,,"histo_2dim (TestReg, SSMed, EEMed, Histo2Dim)
threshold (Histo2Dim, RegionFeat, 3, 1000000)
fill_up (RegionFeat, RegionFillUpFeat)
opening_circle (RegionFillUpFeat, FeatOpen, 1.5)
dilation_circle (FeatOpen, FeatureSpace, 1.5)",26,31,"* --- Automatically Added Context ---
median_separate (SS, SSMed, 25, 25, 'mirrored')
median_separate (EE, EEMed, 25, 25, 'mirrored')
draw_region (TestReg, WindowHandle)
* --- End of Automatically Add..."
2d555b3b,micro,5,,"class_2dim_sup (SSMed, EEMed, FeatureSpace, RegionClass)
opening_circle (RegionClass, ResultClass2, 3.5)
dev_set_color ('red')
dev_set_draw ('margin')
dev_display (MreutHill)
dev_display (ResultClass2)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",32,40,"* --- Automatically Added Context ---
read_image (MreutHill, 'mreut_y')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
median_separate (SS, SSMed, 25, 25, 'mirrored')
median_separate (EE..."
2d555b3b,micro,6,,"threshold (SSMed, RegionThre, 35, 255)
connection (RegionThre, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 150.000000, 99999.000000)
closing_circle (SelectedRegions, ResultClass1, 3.5)
dev_display (MreutHill)
dev_display (ResultClass1)",41,53,"* --- Automatically Added Context ---
read_image (MreutHill, 'mreut_y')
median_separate (SS, SSMed, 25, 25, 'mirrored')
* --- End of Automatically Added Context ---"
4fdf38aa,full,0,"This example demonstrates a 3D application, which combines
a stereo setup and the 3D shape-based mat...","dev_close_window ()
dev_close_window ()
dev_update_off ()
Path := 'metal_cylinders/'
dev_open_window (0, 0, 752 * 0.5, 480 * 0.5, 'black', WindowHandleL)
dev_set_part (0, 0, 480, 752)
dev_set_lut ('default')
dev_set_line_width (2)
set_display_font (WindowHandleL, 11, 'mono', 'true', 'false')
dev_ope...",18,204,
4fdf38aa,micro,1,"a stereo setup and the 3D shape-based matching feature. Given
a box of aluminum cylinders, the task ...","dev_close_window ()
dev_close_window ()
dev_update_off ()
Path := 'metal_cylinders/'
dev_open_window (0, 0, 752 * 0.5, 480 * 0.5, 'black', WindowHandleL)
dev_set_part (0, 0, 480, 752)
dev_set_lut ('default')
dev_set_line_width (2)
set_display_font (WindowHandleL, 11, 'mono', 'true', 'false')
dev_ope...",6,117,
4fdf38aa,micro,2,,"scale_image_max (Disparity, ImageScaleMax)
gray_histo (ImageScaleMax, ImageScaleMax, AbsoluteHisto, RelativeHisto)
Percent := RelativeHisto[255]
i := 254
while (Percent &lt; Threshold)
Percent := RelativeHisto[i] + Percent
i := i - 1
endwhile
threshold (ImageScaleMax, Region, i, 255)
overpaint_regio...",122,153,"* --- Automatically Added Context ---
read_shape_model_3d ('cylinder.sm3', ShapeModel3DID)
binocular_disparity (ImageMapped2, ImageMapped1, Disparity, Score, 'ncc', 7, 7, 0, -20, 140, 1, 0.7, 'left_ri..."
4fdf38aa,micro,3,,"pose_to_hom_mat3d (Pose, HomMat3D)
affine_trans_point_3d (HomMat3D, ReferencePoint[0], ReferencePoint[1], ReferencePoint[2], X, Y, Z)
project_3d_point (X, Y, Z, CamParam, Row, Column)",154,159,"* --- Automatically Added Context ---
find_shape_model_3d (Image, ShapeModel3DID, 0.8, 0.7, [0, 2], [], [], Pose, CovPose, Score_CTRL)
get_shape_model_3d_params (ShapeModel3DID, 'reference_point', Ref..."
4fdf38aa,micro,4,,"project_shape_model_3d (ModelContours, ShapeModel3DID, CamParam, Pose, 'true', rad(30))
dev_display (ModelContours)
return ()
full_domain (Disparity, DisparityFull)
scale_image_max (DisparityFull, ImageScaleMax2)
gray_dilation_shape (ImageScaleMax2, ImageMax, 3, 3, 'octagon')
regiongrowing_n (ImageM...",160,213,"* --- Automatically Added Context ---
read_shape_model_3d ('cylinder.sm3', ShapeModel3DID)
binocular_disparity (ImageMapped2, ImageMapped1, Disparity, Score, 'ncc', 7, 7, 0, -20, 140, 1, 0.7, 'left_ri..."
d55c5607,full,0,"bottle.hdev: Segment and read numbers on a beer bottle
Step 0: Preparations
Specify the name of the ...","FontName := 'Universal_0-9_NoRej'
* FontName := 'bottle'
dev_update_window ('off')
read_image (Bottle, 'bottle2')
get_image_size (Bottle, Width, Height)
dev_close_window ()
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_d...",14,46,
d55c5607,micro,1,"Specify the name of the font to use for reading the date on the bottle.
It is easiest to use the pre...","FontName := 'Universal_0-9_NoRej'
* FontName := 'bottle'",9,16,
d55c5607,micro,2,,"dev_update_window ('off')
read_image (Bottle, 'bottle2')
get_image_size (Bottle, Width, Height)
dev_close_window ()
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Bottle)
disp_continue_message (WindowID, 'black',...",17,27,
d55c5607,micro,3,,"create_text_model_reader ('auto', FontName, TextModel)",28,29,"* --- Automatically Added Context ---
FontName := 'Universal_0-9_NoRej'
* --- End of Automatically Added Context ---"
d55c5607,micro,4,,"set_text_model_param (TextModel, 'min_stroke_width', 6)",30,31,"* --- Automatically Added Context ---
create_text_model_reader ('auto', FontName, TextModel)
* --- End of Automatically Added Context ---"
d55c5607,micro,5,,"set_text_model_param (TextModel, 'text_line_structure', '2 2 2')",32,34,"* --- Automatically Added Context ---
create_text_model_reader ('auto', FontName, TextModel)
* --- End of Automatically Added Context ---"
d55c5607,micro,6,,"find_text (Bottle, TextModel, TextResultID)",35,37,"* --- Automatically Added Context ---
read_image (Bottle, 'bottle2')
create_text_model_reader ('auto', FontName, TextModel)
* --- End of Automatically Added Context ---"
d55c5607,micro,7,,"get_text_object (Characters, TextResultID, 'all_lines')
dev_display (Bottle)
dev_display (Characters)
stop ()",38,42,"* --- Automatically Added Context ---
read_image (Bottle, 'bottle2')
find_text (Bottle, TextModel, TextResultID)
* --- End of Automatically Added Context ---"
d55c5607,micro,8,,"get_text_result (TextResultID, 'class', Classes)
area_center (Characters, Area, Row, Column)
disp_message (WindowID, Classes, 'image', 80, Column - 3, 'green', 'false')",43,52,"* --- Automatically Added Context ---
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
find_text (Bottle, TextModel, TextResultID)
get_text_object (Characters, TextResultID, 'all_lines..."
b4c6b288,full,0,"Training of the OCR
The font is used in ""bottle.hdev""
Step 0: Preparations","FontName := 'bottle'
dev_update_window ('off')
read_image (Bottle, 'bottle2')
get_image_size (Bottle, Width, Height)
dev_close_window ()
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 27, 'mono', 'true', 'false')
threshold (Bottle, RawSegmentation, 0, 95...",12,57,
b4c6b288,micro,1,,FontName := 'bottle',11,13,
b4c6b288,micro,2,,"dev_update_window ('off')
read_image (Bottle, 'bottle2')
get_image_size (Bottle, Width, Height)
dev_close_window ()
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 27, 'mono', 'true', 'false')
threshold (Bottle, RawSegmentation, 0, 95)
fill_up_shape (RawS...",14,36,
b4c6b288,micro,3,,"TrainingNames := ['0', '1', '0', '8', '9', '4']
TrainingFileName := FontName + '.trf'
sort_region (FinalNumbers, SortedRegions, 'first_point', 'true', 'column')
shape_trans (SortedRegions, RegionTrans, 'rectangle1')
area_center (RegionTrans, Area, Row, Column)
MeanRow := mean(Row)
dev_set_check ('~g...",37,52,"* --- Automatically Added Context ---
FontName := 'bottle'
read_image (Bottle, 'bottle2')
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
sort_region (Numbers, FinalNumbers, 'first_po..."
b4c6b288,micro,4,,"CharNames := uniq(sort(TrainingNames))
create_ocr_class_mlp (8, 10, 'constant', 'default', CharNames, 10, 'none', 10, 42, OCRHandle)
trainf_ocr_class_mlp (OCRHandle, TrainingFileName, 200, 1, 0.01, Error, ErrorLog)
write_ocr_class_mlp (OCRHandle, FontName)",53,63,"* --- Automatically Added Context ---
FontName := 'bottle'
TrainingNames := ['0', '1', '0', '8', '9', '4']
TrainingFileName := FontName + '.trf'
* --- End of Automatically Added Context ---"
26d12278,full,0,dotprt.hdev: Segmentation of a dot printing,"dev_update_window ('off')
read_image (Needle, 'needle1')
dev_close_window ()
get_image_size (Needle, Width, Height)
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Needle)
disp_continue_message (WindowID, 'black',...",8,99,
26d12278,micro,1,,"dev_update_window ('off')
read_image (Needle, 'needle1')
dev_close_window ()
get_image_size (Needle, Width, Height)
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Needle)
disp_continue_message (WindowID, 'black',...",6,24,
26d12278,micro,2,,"text_line_orientation (Rectangle1, Needle, 35, -0.523599, 0.523599, OrientationAngle)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, -OrientationAngle, Px, Py, HomMat2DRotate)
affine_trans_image (Needle, Rotated, HomMat2DRotate, 'constant', 'false')
dev_display (Rotated)
d...",25,105,"* --- Automatically Added Context ---
read_image (Needle, 'needle1')
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowID)
Column1 := 90
Row2 := 250
Px := Column1 + (Column2 - Column1) / 2
..."
f1a4df6a,full,0,"Example program for using the OCR
Step0: Preparation
Specify the name of the font to use for reading...","FontName := 'Industrial_0-9A-Z_NoRej'
* FontName := 'engraved'
dev_update_window ('off')
read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
...",15,56,
f1a4df6a,micro,1,"Specify the name of the font to use for reading the serial number.
It is easiest to use the pre-trai...","FontName := 'Industrial_0-9A-Z_NoRej'
* FontName := 'engraved'
dev_update_window ('off')",10,18,
f1a4df6a,micro,2,,"read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
gray_ra...",19,42,
f1a4df6a,micro,3,,"dev_set_shape ('rectangle1')
dev_display (Image)
dev_display (SortedRegions)
shape_trans (SortedRegions, RegionTrans, 'rectangle1')
area_center (RegionTrans, Area, Row, Column)
MeanRow := mean(Row)
count_obj (SortedRegions, Number)
read_ocr_class_mlp (FontName, OCRHandle)
for I := 1 to Number by 1
s...",43,62,"* --- Automatically Added Context ---
FontName := 'Industrial_0-9A-Z_NoRej'
read_image (Image, 'engraved')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
invert_image (ImageResult, Image..."
dbc50fa2,full,0,"Example program to train the characters for OCR
The font is used in ""engraved.hdev""
Step0: Preparati...","FontName := 'engraved'
dev_update_window ('off')
read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
dev_display (Image)
disp_continue_messag...",12,63,
dbc50fa2,micro,1,,"FontName := 'engraved'
dev_update_window ('off')",11,14,
dbc50fa2,micro,2,,"read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
gray_ra...",15,37,
dbc50fa2,micro,3,,"TrainingNames := ['0', '3', 'F', 'A', 'L', 'D', '0']
TrainingFileName := FontName + '.trf'
sort_region (SelectedRegions, SortedRegions, 'first_point', 'true', 'column')
shape_trans (SortedRegions, RegionTrans, 'rectangle1')
area_center (RegionTrans, Area, Row, Column)
MeanRow := mean(Row)
dev_set_ch...",38,55,"* --- Automatically Added Context ---
FontName := 'engraved'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
invert_image (ImageResult, ImageInvert)
select_shape (ConnectedRegions, Select..."
dbc50fa2,micro,4,,"CharNames := uniq(sort(TrainingNames))
create_ocr_class_mlp (8, 10, 'constant', 'default', CharNames, 5, 'none', 10, 42, OCRHandle)
trainf_ocr_class_mlp (OCRHandle, TrainingFileName, 200, 1, 0.01, Error, ErrorLog)
write_ocr_class_mlp (OCRHandle, FontName)
disp_continue_message (WindowHandle, 'black'...",56,69,"* --- Automatically Added Context ---
FontName := 'engraved'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
TrainingNames := ['0', '3', 'F', 'A', 'L', 'D', '0']
TrainingFileName := FontN..."
e45f4049,full,0,"Example program for using the CNN-based OCR classifier.
Step 0: Preparation
Specify the name of the ...","FontName := 'Universal_Rej'
dev_update_off ()
read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_disp_text ('Origina...",12,57,
e45f4049,micro,1,"Specify the name of the font to use for reading the serial number.
It is easiest to use the pretrain...","FontName := 'Universal_Rej'
dev_update_off ()",9,14,
e45f4049,micro,2,,"read_image (Image, 'engraved')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_disp_text ('Original image', 'window', 'top', 'left', 'black', []...",15,30,
e45f4049,micro,3,,"dev_set_colored (6)
dev_set_draw ('margin')
dev_set_shape ('original')
dev_set_line_width (2)
dev_display (ImageResult)
dev_display (SortedRegions)
dev_disp_text ('Segmented characters on filtered image', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window'...",31,41,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
gray_range_rect (Image, ImageResult, 7, 7)
sort_region (SelectedRegions..."
e45f4049,micro,4,,"dev_set_shape ('rectangle1')
dev_display (Image)
dev_display (SortedRegions)
dev_disp_text ('Result', 'window', 'top', 'left', 'black', [], [])
set_display_font (WindowHandle, 36, 'mono', 'true', 'false')
shape_trans (SortedRegions, RegionTrans, 'rectangle1')
area_center (RegionTrans, Area, Row, Col...",42,63,"* --- Automatically Added Context ---
FontName := 'Universal_Rej'
read_image (Image, 'engraved')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
invert_image (ImageResult, ImageInvert)
so..."
89a0827d,full,0,"This example uses the operator find_text to segment
text on a bottle label.
First, a text model is c...","dev_update_off ()
read_image (Image, 'ocr/bottle_label_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle)
create_text_model_reader ('manual', [], TextM...",16,115,
89a0827d,micro,1,,"dev_update_off ()
read_image (Image, 'ocr/bottle_label_01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle)",15,22,
89a0827d,micro,2,,"create_text_model_reader ('manual', [], TextModel)
set_text_model_param (TextModel, 'manual_char_width', 18)
set_text_model_param (TextModel, 'manual_char_height', 40)
set_text_model_param (TextModel, 'manual_stroke_width', 3)
set_text_model_param (TextModel, 'manual_is_dotprint', 'true')
set_text_m...",23,33,
89a0827d,micro,3,"separator. Therefore, we specify two different text line
structures to ensure a robust detection of ...","set_text_model_param (TextModel, 'manual_text_line_structure_0', '5 11')
set_text_model_param (TextModel, 'manual_text_line_structure_1', '2 2 11')",34,39,"* --- Automatically Added Context ---
create_text_model_reader ('manual', [], TextModel)
* --- End of Automatically Added Context ---"
89a0827d,micro,4,,"NumImages := 8
for ImageIndex := 1 to NumImages by 1
read_image (ImageIn, 'ocr/bottle_label_' + ImageIndex$'02')
correct_text_orientation (ImageIn, Image, TextModel, Phi)
find_text (Image, TextModel, TextResult)
get_text_result (TextResult, 'manual_num_lines', NumLines)
dev_display (Image)
for LineI...",40,96,"* --- Automatically Added Context ---
read_image (Image, 'ocr/bottle_label_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle)
create..."
89a0827d,micro,5,"- ImageOut: The corrected image
- Phi: The determined orientation angle","get_text_model_param (TextModel, 'manual_polarity', Polarity)
get_text_model_param (TextModel, 'manual_char_height', CharHeight)
if (Polarity == 'light_on_dark')
invert_image (Image, Image)
endif
text_line_orientation (Image, Image, CharHeight, rad(-45), rad(45), Phi)
rotate_image (Image, ImageOut, ...",104,126,"* --- Automatically Added Context ---
read_image (Image, 'ocr/bottle_label_01')
create_text_model_reader ('manual', [], TextModel)
correct_text_orientation (ImageIn, Image, TextModel, Phi)
* --- End o..."
f8d1f871,full,0,"This example demonstrates how to use the operator
find_text to segment text in an image before
perfo...","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/dongle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
read_ocr_class_mlp ('DotPrint_NoRej', OCRHandle)
create_text_model_reader ('manual', [], TextModel)
set...",10,89,
f8d1f871,micro,1,"find_text to segment text in an image before
performing OCR.","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/dongle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",6,15,
f8d1f871,micro,2,,"read_ocr_class_mlp ('DotPrint_NoRej', OCRHandle)",16,18,
f8d1f871,micro,3,,"create_text_model_reader ('manual', [], TextModel)
set_text_model_param (TextModel, 'manual_char_width', 24)
set_text_model_param (TextModel, 'manual_char_height', 33)
set_text_model_param (TextModel, 'manual_is_dotprint', 'true')
set_text_model_param (TextModel, 'manual_max_line_num', 2)
set_text_m...",19,29,
f8d1f871,micro,4,"Note that for the second line two structures are defined,
because sometimes the '/' is classified as...","set_text_model_param (TextModel, 'manual_text_line_structure_0', '6 1 8')
set_text_model_param (TextModel, 'manual_text_line_structure_1', '8 10')
set_text_model_param (TextModel, 'manual_text_line_structure_2', '19')",30,36,"* --- Automatically Added Context ---
create_text_model_reader ('manual', [], TextModel)
* --- End of Automatically Added Context ---"
f8d1f871,micro,5,in do_ocr_word_mlp to increase the robustness of the OCR.,"TextPattern1 := '(FLEXID[0-9][A-Z][0-9]{3}[A-F0-9]{4})'
TextPattern2 := '([A-Z]{3}[0-9]{5}.?[A-Z][0-9]{4}[A-Z][0-9]{4})'
Expression := TextPattern1 + '|' + TextPattern2",37,42,
f8d1f871,micro,6,,"NumImages := 7
for I := 1 to NumImages by 1
read_image (Image, 'ocr/dongle_' + I$'02')
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
opening_rectangle1 (Region, RegionOpening, 400, 50)
erosion_rectangle1 (RegionOpening, RegionOpening, 11, 11)
connection (RegionOpening, ...",43,95,"* --- Automatically Added Context ---
read_image (Image, 'ocr/dongle_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
read_ocr_class_mlp ('DotPrint_NoRej', OCRHandle)
create_text_mod..."
9986c3b6,full,0,"This example shows how find_text can be used to find and read
expiration dates from medication packa...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 960, 768, 600, 600, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_text_model_reader ('auto', 'Industrial_Rej', TextModel)
Order := ['front', 'left', 'back', 'right', 'bottom', 'top']
disp_messag...",14,253,
9986c3b6,micro,1,"expiration dates from medication packages. In general, the
expiration dates of medication packages f...","dev_update_off ()
dev_close_window ()",6,15,
9986c3b6,micro,2,,"dev_open_window_fit_size (0, 0, 960, 768, 600, 600, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",16,19,
9986c3b6,micro,3,,"create_text_model_reader ('auto', 'Industrial_Rej', TextModel)",20,22,
9986c3b6,micro,4,,"Order := ['front', 'left', 'back', 'right', 'bottom', 'top']
disp_message (WindowHandle, 'This example shows how find_text can be used to \nfind and read expiration dates from medication \npackages. \nIn general, the expiration dates of medication \npackages from different manufacturers are \nlocate...",24,30,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 600, 600, WindowHandle)
* --- End of Automatically Added Context ---"
9986c3b6,micro,5,,"dev_open_window (0, 605, 400, 400, 'black', WindowHandleBox)
set_display_font (WindowHandleBox, 16, 'mono', 'true', 'false')
for BoxIdx := 0 to 2 by 1
Dates := ''
Finished := 0
for ImageIdx := 0 to 5 by 1
ImageString := 'ocr/medication_package_' + (BoxIdx + 1)$'0.2d' + '_' + Order[ImageIdx]
read_ima...",31,100,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 600, 600, WindowHandle)
create_text_model_reader ('auto', 'Industrial_Rej', TextModel)
Order := ['front', 'left', 'back'..."
9986c3b6,micro,6,"Dates of the form MM/YYYY are extracted. Different forms of expiry
dates could also be set. As an al...","DatesOut := Dates
gen_empty_obj (Date)
for LineIdx := 0 to NumLines - 1 by 1
get_text_result (TextResult, ['class_line',LineIdx], Characters)
tuple_regexp_replace (Characters, 'O', '0', TextLineChars)
tuple_sum (TextLineChars, SelectedDigits)
tuple_regexp_match (SelectedDigits, '\\d\\d/\\d\\d\\d\\d'...",101,151,"* --- Automatically Added Context ---
Dates := ''
for ImageIdx := 0 to 5 by 1
find_text (Image, TextModel, TextResult)
get_text_result (TextResult, 'num_lines', NumLines)
select_expiry_date (Date, Num..."
9986c3b6,micro,7,"highlighted. If Finished is true, then the corresponding side is highlighted
in green, otherwise in ...","create_pose (-0.595188, -0.424915, 28.466, 8.36578, 10.6173, 358.628, 'Rp+T', 'gba', 'point', Pose)
Alpha := 0.2
Color := 'red'
DisplayColor := [Color,Color,Color,Color,Color,Color,'yellow']
DisplayAlpha := [Alpha,Alpha,Alpha,Alpha,Alpha,Alpha,1.0]
DisplayLines := ['1.0 1.0 1.0', '0.0 0.0 0.0', '0.5...",152,175,"* --- Automatically Added Context ---
Finished := 0
* --- End of Automatically Added Context ---"
9986c3b6,micro,8,,"X := [0, 0, 1, 1, 0, 0, 1, 1]
Y := [0, 1, 1, 0, 0, 1, 0, 1]
Z := [0, 0, 0, 0, 1, 1, 1, 1]",176,180,
9986c3b6,micro,9,,"gen_plane_object_model_3d ([0, 0, 0, 0, 0, 0, 0], X[0:3], Y[0:3], OM3DFront)
gen_plane_object_model_3d ([0, 0, 1, 0, 0, 0, 0], X[0:3], Y[0:3], OM3DBack)
gen_plane_object_model_3d ([0, 0, 0, 0, -90, 0, 0], X[0:3], Y[0:3], OM3DLeft)
gen_plane_object_model_3d ([0, 1, 0, 90, 0, 0, 0], X[0:3], Y[0:3], OM...",181,188,"* --- Automatically Added Context ---
X := [0, 0, 1, 1, 0, 0, 1, 1]
Y := [0, 1, 1, 0, 0, 1, 0, 1]
* --- End of Automatically Added Context ---"
9986c3b6,micro,10,,"if (Side != 0)
gen_empty_object_model_3d (OM3DFront)
endif
if (Side != 3)
gen_empty_object_model_3d (OM3DRight)
endif",189,196,"* --- Automatically Added Context ---
Side := find(['front', 'left', 'back', 'right', 'bottom', 'top'],SideString)
gen_plane_object_model_3d ([0, 0, 0, 0, 0, 0, 0], X[0:3], Y[0:3], OM3DFront)
gen_plan..."
9986c3b6,micro,11,,"gen_object_model_3d_from_points (X, Y, Z, OM3DCorners)
set_object_model_3d_attrib (OM3DCorners, 'lines', [], [2, 0, 1, 2, 1, 2, 2, 2, 3, 2, 3, 0, 2, 0, 4, 2, 4, 5, 2, 5, 1, 2, 6, 3, 2, 7, 2, 2, 4, 5, 2, 5, 7, 2, 7, 6, 2, 6, 4], OM3DLines)",197,200,"* --- Automatically Added Context ---
X := [0, 0, 1, 1, 0, 0, 1, 1]
Y := [0, 1, 1, 0, 0, 1, 0, 1]
Z := [0, 0, 0, 0, 1, 1, 1, 1]
* --- End of Automatically Added Context ---"
9986c3b6,micro,12,,"DisplayOptions := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'color_6', 'alpha_0', 'alpha_1', 'alpha_2', 'alpha_3', 'alpha_4', 'alpha_5', 'alpha_6', 'light_ambient', 'light_diffuse', 'light_position', 'disp_lines', 'line_color', 'point_size']
disp_object_model_3d (WindowHandl...",201,230,"* --- Automatically Added Context ---
create_pose (-0.595188, -0.424915, 28.466, 8.36578, 10.6173, 358.628, 'Rp+T', 'gba', 'point', Pose)
Side := find(['front', 'left', 'back', 'right', 'bottom', 'top..."
9986c3b6,micro,13,,"count_obj (Date, Number)
if (Number == 0)
disp_message (WindowHandle, 'No Date found', 'window', 12, 12, 'red', 'true')
Finished := 0
else
union1 (Date, RegionUnion)
smallest_rectangle1 (RegionUnion, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangle, Row1 - 10, Column1 - 10, Row2 + 10, Column2...",231,265,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 600, 600, WindowHandle)
Dates := ''
Finished := 0
select_expiry_date (Date, NumLines, TextResult, Dates, ImageIdx, DateI..."
519cf206,full,0,"OCR
Specify the name of the font to use for reading the date on the bottle.
It is easiest to use the...","OCRFontName := 'Document_NoRej'
* OCRFontName := 'arial'
FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
dev_update_off ()
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
dev_close_window ()
get_image_size (Image, Width...",15,74,
519cf206,micro,1,"It is easiest to use the pre-trained font Document_NoRej.  If you have
run the program fontt.hdev in...","OCRFontName := 'Document_NoRej'
* OCRFontName := 'arial'
FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
dev_update_off ()
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
dev_close_window ()
get_image_size (Image, Width...",9,26,
519cf206,micro,2,,"read_ocr_class_mlp (OCRFontName, OCRHandle)
get_params_ocr_class_mlp (OCRHandle, WidthCharacter, HeightCharacter, Interpolation, Features, Char, NumHidden, Preprocessing, NumComponents)
NumChar := |Char|",27,30,"* --- Automatically Added Context ---
OCRFontName := 'Document_NoRej'
* --- End of Automatically Added Context ---"
519cf206,micro,3,,"dev_set_draw ('margin')
NumSamples := 0
for I := 1 to NumImages by 1
dev_set_colored (12)
read_image (Image, 'fonts/' + FontName + '_' + FontImages[I - 1])
char_threshold (Image, Image, DarkRegion, 5, 99, Threshold)
closing_circle (DarkRegion, CharRegion, 7.5)
connection (CharRegion, CharConnected)
...",31,80,"* --- Automatically Added Context ---
FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
read_image (Image, 'fonts/' + FontName + '_' + ..."
1f9a3634,full,0,OCR (Training),"dev_close_window ()
dev_update_off ()
FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, '...",9,94,
1f9a3634,micro,1,,"dev_close_window ()
dev_update_off ()",7,10,
1f9a3634,micro,2,,"FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (Wi...",11,20,
1f9a3634,micro,3,,"Char := []
for I := 0 to 25 by 1
Char[I] := chr(round(I + ord('A')))
endfor
for I := 0 to 25 by 1
Char[I + 26] := chr(round(I + ord('a')))
endfor
for I := 0 to 9 by 1
Char[I + 52] := chr(round(I + ord('0')))
endfor
NumChar := |Char|",21,32,
1f9a3634,micro,4,,"dev_set_check ('~give_error')
delete_file (FontName + '.trf')
dev_set_check ('give_error')
gen_empty_obj (TrainImage)
gen_empty_obj (TrainRegion)
dev_set_colored (12)
dev_set_draw ('margin')
for I := 1 to NumImages by 1
read_image (Image, 'fonts/' + FontName + '_' + FontImages[I - 1])
char_threshold...",33,67,"* --- Automatically Added Context ---
FontName := 'arial'
FontImages := ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9']
NumImages := |FontImages|
read_image (Image, 'fonts/' + FontName + '_' + ..."
1f9a3634,micro,5,,"dev_display (Image)
disp_message (WindowID, 'Train the font classifier', 'window', 12, 12, 'black', 'true')
create_ocr_class_mlp (8, 10, 'constant', 'default', Char, 10, 'none', 10, 42, OCRHandle)
trainf_ocr_class_mlp (OCRHandle, FontName + '.trf', 200, 1, 0.01, Error, ErrorLog)
disp_continue_messag...",68,74,"* --- Automatically Added Context ---
FontName := 'arial'
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
Char := []
* --..."
1f9a3634,micro,6,,"dev_set_color ('green')
for I := 1 to NumImages by 1
select_obj (TrainImage, Image, I)
copy_obj (TrainRegion, Characters, 1 + (I - 1) * NumChar, NumChar)
dev_clear_window ()
dev_display (Image)
dev_set_color ('green')
dev_display (Characters)
disp_message (WindowID, 'Check result', 'window', 12, 12,...",75,92,"* --- Automatically Added Context ---
NumImages := |FontImages|
read_image (Image, 'fonts/' + FontName + '_' + FontImages[0])
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
Char := [..."
1f9a3634,micro,7,,"write_ocr_class_mlp (OCRHandle, FontName)",93,100,"* --- Automatically Added Context ---
FontName := 'arial'
create_ocr_class_mlp (8, 10, 'constant', 'default', Char, 10, 'none', 10, 42, OCRHandle)
* --- End of Automatically Added Context ---"
bda8c264,full,0,"This example program shows how to create OCR training samples from system fonts.
First, the samples ...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 14, ['Arial', 'Garuda', 'Luxi Sans', 'DejaVu Sans', 'FreeSans'], 'false', 'false')
get_font (WindowHandle, Font)
FontName := regexp_replace(Font,'-[^-]+-[^-]+$','')
FontSize := 40
FontTypeface...",12,1135,
bda8c264,micro,1,"First, the samples are created from the specified system font. Then, the
samples are artificially al...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)",6,14,
bda8c264,micro,2,,"set_display_font (WindowHandle, 14, ['Arial', 'Garuda', 'Luxi Sans', 'DejaVu Sans', 'FreeSans'], 'false', 'false')
get_font (WindowHandle, Font)
FontName := regexp_replace(Font,'-[^-]+-[^-]+$','')",15,19,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
bda8c264,micro,3,,"FontSize := 40
FontTypeface := ['Regular', 'Bold']",20,23,
bda8c264,micro,4,,"OrdsNumbers := [48:57]
OrdsUpperCaseLetters := [65:90]
OrdsLowerCaseLetters := [97:122]
Symbols := chr([OrdsNumbers,OrdsUpperCaseLetters,OrdsLowerCaseLetters])
* Symbols := [Symbols,'/']",24,30,
bda8c264,micro,5,,IndependentDeformations := true,31,33,
bda8c264,micro,6,,"set_display_font (WindowHandle, 14, 'sans', 'true', 'false')",34,36,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
bda8c264,micro,7,,"Message := 'This example program shows how to create OCR training samples\nfrom system fonts.\n \nFirst, the samples are created from the specified system font.\nThen, the samples are artificially altered and distorted to increase\nthe number of different training samples for each class.\n \nFinally...",37,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
FontName := regexp_replace(Font,'-[^-]+-[^-]+$','')
get_font (WindowHandle, Font)
FontSize := 40
FontTypef..."
bda8c264,micro,8,,"dev_clear_window ()
disp_message (WindowHandle, 'Create samples...', 'window', 12, 12, 'black', 'false')
try
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
catch (Exception)
throw (Exception)
endtry
copy_obj (Characters, AllCharact...",45,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
FontName := regexp_replace(Font,'-[^-]+-[^-]+$','')
get_font (WindowHandle, Font)
FontSize := 40
FontTypef..."
bda8c264,micro,9,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate variations of the stroke width...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_stroke_width (Characters, CharactersStrokeWidth, Classes, 0.5, 1.5, ClassesStrokeWidth)
else
simulate_character_stroke_wid...",56,66,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,10,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate radial deformations...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_radial_deformation (Characters, CharactersRadDeformed, Classes, ClassesRadDeformed)
else
simulate_character_radial_deformation (AllCh...",67,77,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,11,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate local deformations...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_local_deformation (Characters, CharactersLocDeformed, Classes, 20, 1.5 * MaxFontWidth / 100.0, 2.0, ClassesLocDeformed)
else
simulate_...",78,88,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,12,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate segmentation errors...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_segmentation_error (Characters, CharactersSegmError, Classes, 10 * MaxFontWidth / 100.0, 10 * MaxFontWidth / 100.0, 1, 1, ClassesSegm...",89,99,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,13,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate shear...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_shear (Characters, CharactersSheared, Classes, 10, ClassesSheared)
else
simulate_character_shear (AllCharacters, CharactersSheared, AllClasses, 10,...",100,110,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,14,,"dev_clear_window ()
disp_message (WindowHandle, 'Simulate rotation...', 'window', 12, 12, 'black', 'false')
if (IndependentDeformations)
simulate_character_rotation (Characters, CharactersRotated, Classes, 10, ClassesRotated)
else
simulate_character_rotation (AllCharacters, CharactersRotated, AllCla...",111,121,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
IndependentDeformations := true
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypefa..."
bda8c264,micro,15,,"eliminate_duplicate_samples (AllCharacters, AllCharactersWithoutDup, AllClasses, AllClassesWithoutDup)",122,124,"* --- Automatically Added Context ---
copy_obj (Characters, AllCharacters, 1, -1)
AllClasses := Classes
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWi..."
bda8c264,micro,16,,"Indices := sort_index(AllClassesWithoutDup)
select_obj (AllCharactersWithoutDup, SortedCharacters, Indices + 1)
SortedClasses := subset(AllClassesWithoutDup,Indices)
write_ocr_trainf_image (SortedCharacters, SortedClasses, 'train_ocr')",125,130,"* --- Automatically Added Context ---
eliminate_duplicate_samples (AllCharacters, AllCharactersWithoutDup, AllClasses, AllClassesWithoutDup)
* --- End of Automatically Added Context ---"
bda8c264,micro,17,,"shuffle_trainfile ('train_ocr', 'train_ocr_shuffle')",131,133,
bda8c264,micro,18,,"dev_clear_window ()
disp_message (WindowHandle, ['Train the OCR classifier...', '(Please check status bar for progress)'], 'window', 12, 12, 'black', 'false')
create_ocr_class_mlp (8, 10, 'constant', ['gradient_8dir', 'pixel_invar', 'ratio'], Symbols, 80, 'none', 10, 42, OCRHandle)
trainf_ocr_class_...",134,140,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
Symbols := chr([OrdsNumbers,OrdsUpperCaseLetters,OrdsLowerCaseLetters])
OrdsNumbers := [48:57]
OrdsUpperCa..."
bda8c264,micro,19,,"read_ocr_class_mlp ('ocr', OCRHandle)
create_text_model_reader ('manual', [], TextModel)
set_text_model_param (TextModel, 'char_width', 60)
set_text_model_param (TextModel, 'char_height', 60)
set_text_model_param (TextModel, 'stroke_width', 14)
set_text_model_param (TextModel, 'fragment_size_min', 1...",141,200,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
create_ocr_class_mlp (8, 10, 'constant', ['gradient_8dir', 'pixel_invar', 'ratio'], Symbols, 80, 'none', 1..."
bda8c264,micro,20,,"dev_update_off ()
gen_empty_obj (Characters)
Classes := []
MaxFontWidth := 0
MaxFontHeight := 0
for IndexTF := 0 to |FontTypeface| - 1 by 1
if (regexp_test(FontTypeface[IndexTF],'^(Regular|Italic|Bold|BoldItalic)$') == 0)
throw ('Wrong value for Parameter FontTypeface: ' + FontTypeface[IndexTF])
end...",201,299,"* --- Automatically Added Context ---
FontName := regexp_replace(Font,'-[^-]+-[^-]+$','')
get_font (WindowHandle, Font)
FontSize := 40
FontTypeface := ['Regular', 'Bold']
Symbols := chr([OrdsNumbers,O..."
bda8c264,micro,21,,"gen_empty_obj (CharactersLocDeformed)
ClassesLocDeformed := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
for Index1 := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index1)
Class := Classes[Index1 - 1]
for Index2 := 1 to NumVariations by 1
try
deform_one_chara...",300,364,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_local_deformation (Characte..."
bda8c264,micro,22,,"gen_empty_obj (CharactersStrokeWidth)
ClassesStrokeWidth := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
for Index := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index)
Class := Classes[Index - 1]
get_image_size (ObjectSelected, Width, Height)
get_domain (Ob...",365,453,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_stroke_width (Characters, C..."
bda8c264,micro,23,,"gen_empty_obj (CharactersRotated)
ClassesRotated := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
for Index := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index)
Class := Classes[Index - 1]
get_image_size (ObjectSelected, Width, Height)
add_border (ObjectSele...",454,518,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_rotation (Characters, Chara..."
bda8c264,micro,24,,"gen_empty_obj (CharactersSheared)
ClassesSheared := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
hom_mat2d_identity (HomMat2DIdentity)
for Index := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index)
Class := Classes[Index - 1]
get_image_size (ObjectSelected,...",519,584,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_shear (Characters, Characte..."
bda8c264,micro,25,,"gen_empty_obj (CharactersRadDeformed)
ClassesRadDeformed := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
get_image_size (Characters, WidthAll, HeightAll)
WidthTiled := max(WidthAll) * 2
HeightTiled := max(HeightAll) * 2",585,594,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_radial_deformation (Charact..."
bda8c264,micro,26,,"gen_empty_obj (Maps)
for W := WidthTiled / 10.0 * 2.0 to WidthTiled / 10.0 * 8.0 + 1e-5 by WidthTiled / 10.0 * 3.0
for H := HeightTiled / 10.0 * 2.0 to HeightTiled / 10.0 * 8.0 + 1e-5 by HeightTiled / 10.0 * 3.0
Kappa := 100000000.0 / HeightTiled
gen_cam_par_area_scan_division (0.01, Kappa, 6e-06, 6...",595,605,"* --- Automatically Added Context ---
WidthTiled := max(WidthAll) * 2
HeightTiled := max(HeightAll) * 2
get_image_size (Characters, WidthAll, HeightAll)
* --- End of Automatically Added Context ---"
bda8c264,micro,27,,"count_obj (Maps, NumberMaps)
for Index := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index)
Class := Classes[Index - 1]
add_border_size (ObjectSelected, TiledImage, WidthTiled, HeightTiled)
gen_image_proto (TiledImage, ImageRegion, 255)
paint_region (TiledImage, ImageRegion, ImageRegio...",606,665,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_radial_deformation (Charact..."
bda8c264,micro,28,,"gen_empty_obj (CharactersSegmError)
ClassesSegmError := []
gen_empty_obj (ObjTmp)
ClassesTmp := []
count_obj (Characters, Number)
for Index := 1 to Number by 1
select_obj (Characters, ObjectSelected, Index)
Class := Classes[Index - 1]
get_image_size (ObjectSelected, Width, Height)
add_border (Object...",666,778,"* --- Automatically Added Context ---
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWidth, MaxFontHeight)
simulate_character_segmentation_error (Charact..."
bda8c264,micro,29,,"read_ocr_trainf (CharactersOrig, TrainFile, CharacterNamesOrig)",779,782,
bda8c264,micro,30,,"Indices := sort_index(CharacterNamesOrig)
select_obj (CharactersOrig, CharactersSorted, Indices + 1)
CharacterNamesSorted := subset(CharacterNamesOrig,Indices)
tuple_strstr ([CharacterNamesSorted,CharacterNamesSorted[0]], [CharacterNamesSorted[|CharacterNamesSorted| - 1],CharacterNamesSorted], Posit...",785,794,"* --- Automatically Added Context ---
eliminate_duplicate_samples (AllCharacters, AllCharactersWithoutDup, AllClasses, AllClassesWithoutDup)
Indices := sort_index(AllClassesWithoutDup)
read_ocr_trainf..."
bda8c264,micro,31,,"Sequence := [0:|CharacterNamesSorted| - 1]
tuple_remove (Sequence, IndicesFirst, IndicesRemaining)
select_obj (CharactersSorted, CharactersRemaining, IndicesRemaining + 1)
CharacterNamesRemaining := subset(CharacterNamesSorted,IndicesRemaining)
IndicesRandom := sort_index(rand(|IndicesRemaining|))
s...",795,803,"* --- Automatically Added Context ---
read_ocr_trainf (CharactersOrig, TrainFile, CharacterNamesOrig)
select_obj (CharactersOrig, CharactersSorted, Indices + 1)
CharacterNamesSorted := subset(Characte..."
bda8c264,micro,32,,"concat_obj (CharactersFirst, CharactersRemainingRand, CharactersReordered)
CharacterNamesReordered := [CharacterNamesFirst,CharacterNamesRemainingRand]
write_ocr_trainf_image (CharactersReordered, CharacterNamesReordered, TrainFileShuffled)
return ()",804,831,"* --- Automatically Added Context ---
eliminate_duplicate_samples (AllCharacters, AllCharactersWithoutDup, AllClasses, AllClassesWithoutDup)
Indices := sort_index(AllClassesWithoutDup)
read_ocr_trainf..."
bda8c264,micro,33,,"Border := int(ceil(MaxDeformation))
add_border (Character, TiledImage, Border)
get_image_size (TiledImage, Width, Height)
gen_image_proto (TiledImage, ImageRegion, 255)
paint_region (TiledImage, ImageRegion, ImageRegion, 0, 'fill')
DeformationFrequency := max([rand(1) * (MaxDeformationFrequency - 1)...",832,878,"* --- Automatically Added Context ---
threshold (Image, Region, 0, 254)
reduce_domain (Image, Region, ImageReduced)
deform_one_character_sample (ObjectSelected, CharacterDeformed, MaxDeformation, MaxD..."
bda8c264,micro,34,,"IsOK := true
RejectReason := ''
min_max_gray (CharSample, CharSample, 0, Min, Max, RangeLocal)
area_center (CharSample, Area, Row, Column)
get_image_size (CharSample, Width, Height)
Size := Width * Height
ForegroundRatio := real(Area) / Size
full_domain (CharSample, ImageFull)
difference (ImageFull,...",879,977,"* --- Automatically Added Context ---
check_sample_quality (CharacterDeformed, 10, 0.1, 4, 4, 50, IsOK, RejectReason)
min_max_gray (Domain, DistanceImage, 5, Min, Max, Range)
get_image_size (ObjectSel..."
bda8c264,micro,35,and overpaints this border with the gray value 255.,"get_image_size (ImageIn, Width, Height)
tile_images_offset (ImageIn, TiledImage, Border, Border, -1, -1, -1, -1, Width + 2 * Border, Height + 2 * Border)
get_domain (TiledImage, Domain)
get_image_size (TiledImage, WidthTiled, HeightTiled)
gen_rectangle1 (Rectangle, 0, 0, HeightTiled - 1, WidthTiled ...",978,1013,"* --- Automatically Added Context ---
deform_one_character_sample (ObjectSelected, CharacterDeformed, MaxDeformation, MaxDeformationFrequency)
get_domain (ObjectSelected, Domain)
add_border (ObjectSel..."
bda8c264,micro,36,"is placed in the center of the new image and the new image has the
given image size. Finally, it ove...","get_image_size (ImageIn, WidthI, HeightI)
BorderRow := (Height - HeightI) / 2
BorderCol := (Width - WidthI) / 2
tile_images_offset (ImageIn, TiledImage, BorderRow, BorderCol, -1, -1, -1, -1, Width, Height)
get_domain (TiledImage, Domain)
gen_rectangle1 (Rectangle, 0, 0, Height - 1, Width - 1)
differ...",1014,1051,"* --- Automatically Added Context ---
get_domain (ObjectSelected, Domain)
add_border (ObjectSelected, TiledImage, int(ceil(max(fabs(MorphList)))))
get_image_size (ObjectSelected, Width, Height)
differ..."
bda8c264,micro,37,"a vector field, which then can be used to distort an image.","Ratio := max([1.0 * Width / Height,0.3])
gen_image_const (Image, 'real', round(2.0 * MaxDeformationFrequency * Ratio), round(2.0 * MaxDeformationFrequency / Ratio))
add_noise_white (Image, ImageNoise, MaxDeformation)
zoom_image_size (ImageNoise, ImageZoom, Width, Height, 'weighted')
gen_rectangle1 (...",1052,1146,"* --- Automatically Added Context ---
copy_obj (Characters, AllCharacters, 1, -1)
AllClasses := Classes
gen_character_samples (Characters, Symbols, FontName, FontSize, FontTypeface, Classes, MaxFontWi..."
ecb0e179,full,0,OCR,"dev_update_window ('off')
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_display (Letters)
disp_continue_message (WindowID, 'blac...",9,74,
ecb0e179,micro,1,,"dev_update_window ('off')
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_display (Letters)
disp_continue_message (WindowID, 'blac...",7,17,
ecb0e179,micro,2,"Read the classifier to use for reading the text.
It is easiest to use the pre-trained font Document_...","read_ocr_class_mlp ('Document_NoRej', OCRHandle)
* read_ocr_class_mlp ('letters', OCRHandle)
disp_continue_message (WindowID, 'black', 'true')
stop ()",18,26,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
* --- End of Automatically Added Context ---"
ecb0e179,micro,3,,"binary_threshold (Letters, DarkRegion, 'max_separability', 'dark', UsedThreshold)
dilation_circle (DarkRegion, CharRegion, 2.500000)
connection (CharRegion, CharConnected)
intersection (CharConnected, DarkRegion, CharOrig)
sort_region (CharOrig, Characters, 'character', 'true', 'row')
dev_display (L...",27,39,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
* --- End of Automatically Added Context ---"
ecb0e179,micro,4,,"shape_trans (Characters, CharConvex, 'rectangle1')
dev_set_color ('green')
dev_open_window (0, Width / 2 + 50, 128, 128, 'black', WindowChar)
set_display_font (WindowChar, 26, 'mono', 'true', 'false')
dev_set_window (WindowID)
dev_display (Letters)
DoLoop := 1
while (DoLoop == 1)
dev_set_color ('red...",40,80,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
read_ocr_class_mlp ('Docu..."
ad8a3425,full,0,OCR (Training),"dev_update_off ()
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (Letters)
Cha...",9,80,
ad8a3425,micro,1,,"dev_update_off ()
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (Letters)",7,16,
ad8a3425,micro,2,,"Char := []
for i := 0 to 25 by 1
Char[i] := chr(i + 97)
endfor
Char[26] := '.'
NumChar := |Char|",17,23,
ad8a3425,micro,3,,"binary_threshold (Letters, DarkRegion, 'max_separability', 'dark', UsedThreshold)
dilation_circle (DarkRegion, CharRegion, 2.5)
connection (CharRegion, CharConnected)
intersection (CharConnected, DarkRegion, CharOrig)
sort_region (CharOrig, Characters, 'character', 'true', 'row')
dev_display (Letter...",24,39,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
NumChar := |Char|
Char := []
* --- End of Automatically Added Con..."
ad8a3425,micro,4,,"dev_display (Letters)
disp_message (WindowID, ' Train characters ', 'window', 12, 12, 'black', 'true')
dev_set_check ('~give_error')
delete_file ('letters.trf')
dev_set_check ('give_error')
for c := 1 to NumChar by 1
C := []
for i := 1 to SamplesPerChar by 1
C[i - 1] := Char[c - 1]
endfor
copy_obj (...",40,57,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
Char := []
NumChar := |Char|
sort_region (CharOrig, Characters, '..."
ad8a3425,micro,5,,"dev_set_color ('green')
for c := 1 to NumChar by 1
dev_display (Letters)
disp_message (WindowID, 'Check classification', 'window', 12, 12, 'black', 'true')
C := []
for i := 1 to SamplesPerChar by 1
C[i - 1] := Char[c - 1]
endfor
copy_obj (Characters, Samples, 1 + (c - 1) * SamplesPerChar, SamplesPer...",58,76,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
Char := []
NumChar := |Char|
sort_region (CharOrig, Characters, '..."
ad8a3425,micro,6,,"write_ocr_class_mlp (OCRHandle, 'letters')
dev_set_shape ('original')
dev_update_on ()",77,86,"* --- Automatically Added Context ---
create_ocr_class_mlp (8, 10, 'constant', 'default', Char, 20, 'none', 10, 42, OCRHandle)
* --- End of Automatically Added Context ---"
d11d01f5,full,0,OCR (numbers) with color segmentation,"read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_line_width (3)
dev_set_draw ('margin')
dev_update_window ('off')
rea...",9,90,
d11d01f5,micro,1,,"read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_line_width (3)
dev_set_draw ('margin')
dev_update_window ('off')",7,16,
d11d01f5,micro,2,"It is easiest to use the pre-trained font Industrial_0-9_NoRej.  If you
have run the program ocrcolo...","read_ocr_class_mlp ('Industrial_0-9_NoRej', OCRHandle)
* read_ocr_class_mlp ('ocrcolor', OCRHandle)",17,23,
d11d01f5,micro,3,,"NumImages := 8
for img := 1 to NumImages by 1
read_image (Image, 'ocr/color_form_0' + img)
mean_image (Image, Mean, 3, 3)
decompose3 (Mean, Red, Green, Blue)
threshold (Green, ForegroundRaw, 0, 220)
clip_region (ForegroundRaw, Foreground, 3, 3, Height - 4, Width - 4)
reduce_domain (Red, Foreground, ...",24,96,"* --- Automatically Added Context ---
read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_open_window (0, 0, Width, Heigh..."
8b85a9b1,full,0,"OCR (numbers) with color segmentation
Creation of training files","read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_line_width (3)
dev_set_draw ('margin')
dev_set_colored (12)
* dev_update_window ('off')
...",10,89,
8b85a9b1,micro,1,Creation of training files,"read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_line_width (3)
dev_set_draw ('margin')
dev_set_colored (12)
* dev_update_window ('off')
...",7,21,
8b85a9b1,micro,2,,"TrainChar := ['0', '0', '5', '1', '5', '3', '6', '1', '4', '3', '3', '6', '0', '8', '6', '4', '2', '5', '1', '4', '3', '3', '6', '0', '6', '2', '0', '0', '6', '2', '1', '1', '6', '0', '5', '0', '0', '5', '1', '5', '0', '0', '5', '1', '5', '0', '0', '5', '1', '5']
NumTrainChar := [8, 8, 8, 5, 6, 5, 5...",22,95,"* --- Automatically Added Context ---
read_image (Image, 'ocr/color_form_01')
get_image_pointer3 (Image, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
dev_open_window (0, 0, Width, Heigh..."
90f3ffb9,full,0,"This example demonstrates how to perform OCR
of symbols printed along a non-linear pattern.
In parti...","dev_update_off ()
dev_close_window ()
WidthP := 900
HeightP := 20
read_image (Image, 'ocr/cd_print')
get_image_size (Image, Width, Height)
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display ...",12,90,
90f3ffb9,micro,1,"of symbols printed along a non-linear pattern.
In particular, this example reads the characters
prin...","dev_update_off ()
dev_close_window ()
WidthP := 900
HeightP := 20
read_image (Image, 'ocr/cd_print')
get_image_size (Image, Width, Height)
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",7,20,
90f3ffb9,micro,2,,"dev_display (Image)
disp_message (WindowHandle, 'Read the number on the outer ring', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",21,26,"* --- Automatically Added Context ---
read_image (Image, 'ocr/cd_print')
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
* --- End of Automatically Added Contex..."
90f3ffb9,micro,3,,"mean_image (Image, ImageMean, 211, 211)
dyn_threshold (Image, ImageMean, RegionDynThresh, 15, 'dark')
connection (RegionDynThresh, ConnectedRegions)
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
gen_contour_region_xld (SelectedRegions, Contours, 'border')
fit_circle_contour_xld...",27,46,"* --- Automatically Added Context ---
read_image (Image, 'ocr/cd_print')
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
* --- End of Automatically Added Contex..."
90f3ffb9,micro,4,"so that the characters now are aligned along an
horizontal line","polar_trans_image_ext (Image, ImagePolar, Row, Column, 0, rad(360), Radius - 30, Radius - 5, WidthP, HeightP, 'bilinear')
dev_open_window (0, 0, WidthP, HeightP, 'black', WindowHandle2)
rotate_image (ImagePolar, ImageRotate, 180, 'constant')",47,53,"* --- Automatically Added Context ---
WidthP := 900
HeightP := 20
read_image (Image, 'ocr/cd_print')
fit_circle_contour_xld (Contours, 'ahuber', -1, 0, 0, 3, 2, Row, Column, Radius, StartPhi, EndPhi, ..."
90f3ffb9,micro,5,,"mean_image (ImageRotate, ImageMeanRotate, 51, 9)
dyn_threshold (ImageRotate, ImageMeanRotate, RegionDynThreshChar, 5, 'dark')
connection (RegionDynThreshChar, ConnectedRegions1)
select_shape (ConnectedRegions1, SelectedRegions, ['area', 'width'], 'and', [30, 4], [150, 10])
sort_region (SelectedRegio...",54,59,"* --- Automatically Added Context ---
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
rotate_image (ImagePolar, ImageRotate, 180, 'constant')
* --- End of Automatically Added Conte..."
90f3ffb9,micro,6,"From all the candidate regions pickup those consisting of dark regions
on light background","threshold (ImageMeanRotate, Region, 90, 255)
intersection (SelectedRegions, Region, RegionIntersection)",60,64,"* --- Automatically Added Context ---
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
mean_image (ImageRotate, ImageMeanRotate, 51, 9)
* --- End of Automatically Added Context ---"
90f3ffb9,micro,7,,"area_center (RegionIntersection, Area, Row1, Column1)
select_mask_obj (RegionIntersection, Characters, Area [&gt;] 0)
dev_display (ImageRotate)
Message := [Message,'2. Calculate polar transform']
disp_message (WindowHandle, Message, 'window', 36, 12, 'black', 'true')
disp_continue_message (WindowHan...",65,74,"* --- Automatically Added Context ---
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
Message := '1. Segment ring'
rotate_image (ImagePolar, ImageRotate, 180, '..."
90f3ffb9,micro,8,,"read_ocr_class_mlp ('Industrial_0-9A-Z_NoRej', OCRHandle)
sort_region (Characters, SortedRegions, 'character', 'true', 'row')
do_ocr_multi_class_mlp (SortedRegions, ImageRotate, OCRHandle, Class, Confidence)",75,78,"* --- Automatically Added Context ---
rotate_image (ImagePolar, ImageRotate, 180, 'constant')
sort_region (SelectedRegions, SortedRegions, 'character', 'false', 'column')
select_mask_obj (RegionInters..."
90f3ffb9,micro,9,"In a more general situation one may use a more
complex regular expression or else the operator
do_oc...","tuple_regexp_replace (sum(Class), 'O', '0', Result)
dev_set_colored (6)
dev_set_draw ('fill')
dev_display (RegionIntersection)
Message := [Message,'3. Segment and read text']
disp_message (WindowHandle, Message, 'window', 36, 12, 'black', 'true')
disp_message (WindowHandle, Result, 'image', Height /...",79,96,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (HeightP + 60, 0, Width * 2 / 3, Height * 2 / 3, 'black', WindowHandle)
Message := '1. Segment ring'
interse..."
09de4124,full,0,"Example that shows how to combine OCR and the postprocessing of the resulting string
with regular ex...","dev_close_window ()
get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'true')
read_image (Image, 'ocr/dongle_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update...",13,97,
09de4124,micro,1,"1. they allow the user to check the integrity of the results
2. even if some areas are wrongly inter...","dev_close_window ()
get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'true')
read_image (Image, 'ocr/dongle_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update...",8,106,
c8660df8,full,0,"This program demonstrates the use of the photometric stereo technique
to read embossed numbers on a ...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 533, 223, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Read the lot number of a tube of toothpaste'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different lig...",12,64,
c8660df8,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 533, 223, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Read the lot number of a tube of toothpaste'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different lig...",10,22,
c8660df8,micro,2,,"read_image (Images, 'photometric_stereo/toothpaste_embossed_0' + [1:4])
for I := 1 to 4 by 1
Message := 'Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor...",23,37,"* --- Automatically Added Context ---
dev_open_window (0, 0, 533, 223, 'black', WindowHandle)
Message := 'Read the lot number of a tube of toothpaste'
* --- End of Automatically Added Context ---"
c8660df8,micro,3,,"dev_display (Albedo)
disp_message (WindowHandle, 'In the albedo image the number is nearly invisible', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",38,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, 533, 223, 'black', WindowHandle)
Message[1] := 'using photometric stereo. In this case four'
photometric_stereo (Images, HeightField, Gradi..."
c8660df8,micro,4,"using the gradient field as input for the operator
derivate_vector_field.
Segmentation and reading o...","derivate_vector_field (Gradient, MeanCurvature, 0.1, 'mean_curvature')
scale_image_max (MeanCurvature, ImageScaleMax)
dev_display (ImageScaleMax)
disp_message (WindowHandle, 'But the curvature image makes segmentation easy', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'bl...",44,70,"* --- Automatically Added Context ---
dev_open_window (0, 0, 533, 223, 'black', WindowHandle)
read_image (Images, 'photometric_stereo/toothpaste_embossed_0' + [1:4])
photometric_stereo (Images, Height..."
4da2de42,full,0,"This example program compares the 'gradient_8dir' feature to the 'pixel_invar' feature.
The stroke w...","dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
binary_threshold (Image, Regio...",13,225,
4da2de42,micro,1,"The stroke width of the trained characters is subsequently decreased by gray value dilation,
while t...","dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)",6,21,
4da2de42,micro,2,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",22,24,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
4da2de42,micro,3,,"dilation_circle (Region, RegionDilation, 3.5)",25,26,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
4da2de42,micro,4,,"connection (RegionDilation, ConnectedRegions)",27,28,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
4da2de42,micro,5,,"intersection (ConnectedRegions, Region, RegionIntersection)",29,30,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
4da2de42,micro,6,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
dev_display (Characters)
disp_message (WindowHandle, ['Press Run to start training!', '(this may take several seconds)'], 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_disp...",31,37,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End ..."
4da2de42,micro,7,,"count_obj (Characters, Number)
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(20,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(20,'.')]",38,44,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
4da2de42,micro,8,,"write_ocr_trainf (Characters, Image, Classes, 'letters.trf')",45,47,"* --- Automatically Added Context ---
read_image (Image, 'letters')
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
Classes := []
* --- End of Automatically Added Context ---"
4da2de42,micro,9,"the training part of the program is generic and can be used to train any MLP
OCR classifier.","read_ocr_trainf_names ('letters.trf', CharacterNames, CharacterCount)",48,51,
4da2de42,micro,10,Note that the 'default' feature is a combination of 'pixel_invar' and 'ratio',"create_ocr_class_mlp (8, 10, 'weighted', 'pixel_invar', CharacterNames, 60, 'none', 26, 42, OCRHandleDefault)
create_ocr_class_mlp (8, 10, 'weighted', 'gradient_8dir', CharacterNames, 60, 'none', 26, 42, OCRHandleGradient)
create_ocr_class_svm (8, 10, 'weighted', 'gradient_8dir', CharacterNames, 'rb...",52,65,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
disp_message (WindowHandle, ['Press Run to start training!', '(this may take several seconds)'], 'wi..."
4da2de42,micro,11,in combination with the 'pixel_invar' feature vector,"dev_clear_window ()
dev_display (Image)
disp_message (WindowHandle, 'First using the \'pixel_invar\' feature.', 'window', 12, 12, 'black', 'true')
wait_seconds (2)
WronglyClassifiedDefault := []",66,73,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
4da2de42,micro,12,,"get_window_extents (WindowHandle, Row, Column, Width, Height)
set_window_param (WindowHandle, 'flush', 'false')
ClassificationTimeMLPDefault := 0
for DilationRadius := 2.5 to 7.0 by 0.2
filter_image (Image, ImageMax, DilationRadius)
count_seconds (TimeBefore)
do_ocr_multi_class_mlp (Characters, Imag...",74,90,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (RegionIntersection,..."
4da2de42,micro,13,in combination with the 'gradient_8dir' feature vector,"dev_display (Image)
disp_message (WindowHandle, 'Now using the \'gradient_8dir\' feature.', 'window', 12, 12, 'black', 'true')
wait_seconds (2)
set_window_param (WindowHandle, 'flush', 'false')
WronglyClassifiedGradient := []
DilationRadii := []
ClassificationTimeMLPGradient := 0
for DilationRadius ...",91,114,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (RegionIntersection,..."
4da2de42,micro,14,in combination with the 'gradient_8dir' feature vector,"dev_display (Image)
disp_message (WindowHandle, ['Now using the \'gradient_8dir\' feature', 'and SVM.'], 'window', 12, 12, 'black', 'true')
wait_seconds (2)
set_window_param (WindowHandle, 'flush', 'false')
WronglyClassifiedGradientSVM := []
ClassificationTimeSVMGradient := 0
for DilationRadius := 2...",115,135,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (RegionIntersection,..."
4da2de42,micro,15,,"IncorrectPercent := [WronglyClassifiedDefault,WronglyClassifiedGradient,WronglyClassifiedGradientSVM] / real(|Classes|) * 100.0
Title := ['MLP: \'pixel_invar\'', 'MLP: \'gradient_8dir\'', 'SVM: \'gradient_8dir\'']
Colors := ['magenta', 'cyan', 'green']
dev_set_part (0, 0, Height / 2 - 1, Width / 2 -...",136,144,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Classes := []
disp_message (WindowHandle, 'Training \'pixel_in..."
4da2de42,micro,16,,"NumRadii := |DilationRadii|
TotalClassifications := NumRadii * |Classes|
ClassificationTimeMLPDefault := 1000 * ClassificationTimeMLPDefault / TotalClassifications
ClassificationTimeMLPGradient := 1000 * ClassificationTimeMLPGradient / TotalClassifications
ClassificationTimeSVMGradient := 1000 * Cla...",145,235,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row..."
18b9de1c,full,0,This example shows how to use the automatic text reader to detect and read dot print text.,"dev_close_window ()
dev_update_pc ('off')
dev_update_window ('off')
read_image (Image, 'ocr/lot_number_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
create_t...",8,46,
18b9de1c,micro,1,,"dev_close_window ()
dev_update_pc ('off')
dev_update_window ('off')
read_image (Image, 'ocr/lot_number_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')",6,16,
18b9de1c,micro,2,'true' in order to find dot printed text.,"create_text_model_reader ('auto', 'Universal_0-9A-Z_Rej', TextModel)
set_text_model_param (TextModel, 'dot_print', 'true')",17,21,
18b9de1c,micro,3,which show a lower contrast.,"set_text_model_param (TextModel, 'min_contrast', 40)
for Index := 1 to 12 by 1
read_image (Image, 'ocr/lot_number_' + Index$'.2')
dev_display (Image)
find_text (Image, TextModel, TextResultID)
get_text_object (Characters, TextResultID, 'all_lines')
get_text_result (TextResultID, 'class', Class)
dev_...",22,52,"* --- Automatically Added Context ---
read_image (Image, 'ocr/lot_number_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_text_model_reader ('auto', 'Universal_0-9A-Z_Rej', Tex..."
96d0eeef,full,0,"This program demonstrates the use of the photometric stereo technique
to read imprinted letters on a...","PolarTransWidth := 512
PolarTransHeight := 80
dev_close_window ()
dev_update_off ()
read_image (Images, 'photometric_stereo/tire_0' + [1:4])
select_obj (Images, ObjectSelected, 1)
dev_open_window_fit_image (ObjectSelected, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true...",13,92,
96d0eeef,micro,1,,"PolarTransWidth := 512
PolarTransHeight := 80
dev_close_window ()
dev_update_off ()
read_image (Images, 'photometric_stereo/tire_0' + [1:4])
select_obj (Images, ObjectSelected, 1)
dev_open_window_fit_image (ObjectSelected, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true...",12,28,
96d0eeef,micro,2,and therefore use only very rough estimates.,"Tilts := [180, 270, 0, 90]
Slants := [45, 45, 45, 45]",29,33,
96d0eeef,micro,3,,"photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, 'gradient', 'poisson', [], [])",34,36,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/tire_0' + [1:4])
Tilts := [180, 270, 0, 90]
Slants := [45, 45, 45, 45]
* --- End of Automatically Added Context ---"
96d0eeef,micro,4,,"derivate_vector_field (Gradient, Result, 3, 'mean_curvature')",37,38,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, 'gradient', 'poisson', [], [])
* --- End of Automatically Added Context ---"
96d0eeef,micro,5,,"dev_display (Result)
disp_message (WindowHandle, 'Surface curvature image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",39,44,"* --- Automatically Added Context ---
dev_open_window_fit_image (ObjectSelected, 0, 0, -1, -1, WindowHandle)
derivate_vector_field (Gradient, Result, 3, 'mean_curvature')
* --- End of Automatically Ad..."
96d0eeef,micro,6,"The base line of the text is used to align
the text horizontally (to simplify the OCR)","threshold (Result, Region, -0.2, -0.01)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, BaseLine, ['width', 'row'], 'and', [600, 280], [99999, 350])",45,50,"* --- Automatically Added Context ---
derivate_vector_field (Gradient, Result, 3, 'mean_curvature')
* --- End of Automatically Added Context ---"
96d0eeef,micro,7,"to determine the radius of the line by fitting
a circle to the contour","gen_contour_region_xld (BaseLine, Contours, 'center')
segment_contours_xld (Contours, ContoursSplit, 'lines_circles', 8, 14, 12)
select_contours_xld (ContoursSplit, SelectedContours, 'contour_length', 500, 1e10, -0.5, 0.5)
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column,...",51,57,"* --- Automatically Added Context ---
select_shape (ConnectedRegions, BaseLine, ['width', 'row'], 'and', [600, 280], [99999, 350])
* --- End of Automatically Added Context ---"
96d0eeef,micro,8,,"* gen_circle_contour_xld (ContCircle, Row, Column, Radius, StartPhi, EndPhi, PointOrder, 1)",58,59,"* --- Automatically Added Context ---
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
* --- End of Automatically Added Context ---"
96d0eeef,micro,9,choose the one with the largest radius,I := sort_index(Radius)[|Radius| - 1],60,62,"* --- Automatically Added Context ---
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
* --- End of Automatically Added Context ---"
96d0eeef,micro,10,start and end angle have to be swapped for the polar transform,"if (PointOrder[I] == 'positive')
Tmp := StartPhi[I]
StartPhi[I] := EndPhi[I]
EndPhi[I] := Tmp
endif",63,69,"* --- Automatically Added Context ---
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
I := sort_index(Radius)[|Radius| - 1]
* --- En..."
96d0eeef,micro,11,to align the text with the base line,"polar_trans_region (Region, RegionPolarTrans, Row[I], Column[I], StartPhi[I], EndPhi[I], Radius[I] + PolarTransHeight, Radius[I], PolarTransWidth, PolarTransHeight, 'nearest_neighbor')",70,72,"* --- Automatically Added Context ---
PolarTransWidth := 512
PolarTransHeight := 80
threshold (Result, Region, -0.2, -0.01)
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column..."
96d0eeef,micro,12,,"connection (RegionPolarTrans, ConnectedTransRegions)
select_shape (ConnectedTransRegions, Letters, ['height', 'width'], 'and', [40, 20], [60, 50])
sort_region (Letters, SortedLetters, 'character', 'true', 'row')",73,76,"* --- Automatically Added Context ---
polar_trans_region (Region, RegionPolarTrans, Row[I], Column[I], StartPhi[I], EndPhi[I], Radius[I] + PolarTransHeight, Radius[I], PolarTransWidth, PolarTransHeigh..."
96d0eeef,micro,13,,"region_to_bin (SortedLetters, BinImage, 0, 255, 512, 100)",77,78,"* --- Automatically Added Context ---
sort_region (Letters, SortedLetters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
96d0eeef,micro,14,,"read_ocr_class_mlp ('Industrial_NoRej', OCRHandle)
do_ocr_multi_class_mlp (SortedLetters, BinImage, OCRHandle, Class, Confidence)",79,82,"* --- Automatically Added Context ---
sort_region (Letters, SortedLetters, 'character', 'true', 'row')
region_to_bin (SortedLetters, BinImage, 0, 255, 512, 100)
* --- End of Automatically Added Contex..."
96d0eeef,micro,15,,"dev_display (ObjectSelected)
area_center (SortedLetters, Area, Row, Column)
dev_open_window (60, 12, PolarTransWidth, PolarTransHeight + 50, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_part (-30, 0, PolarTransHeight - 1 + 20, PolarTransWidth - 1)
dev...",83,98,"* --- Automatically Added Context ---
PolarTransWidth := 512
PolarTransHeight := 80
select_obj (Images, ObjectSelected, 1)
fit_circle_contour_xld (ContoursSplit, 'ahuber', -1, 0, 0, 3, 1, Row, Column,..."
1cbaddf7,full,0,"This example describes one step from the semiconductor product chain.
In the front-end-of-line step,...","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/wafer_semi_font_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_set_colored (12)
read_ocr_class_mlp ('SEMI_...",12,78,
1cbaddf7,micro,1,"In the front-end-of-line step, the ICs are printed on the wafer. To
tag a single wafer from the prod...","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/wafer_semi_font_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_set_colored (12)
read_ocr_class_mlp ('SEMI_...",7,88,
03ad04e7,full,0,"This example demonstrates how to segment the expiration date of
a yoghurt cap. After the segmentatio...","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)
read_ocr_class_cnn ('Universal_...",12,70,
03ad04e7,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)
read_ocr_class_cnn ('Universal_...",11,21,
03ad04e7,micro,2,,DotDiameter := 6,22,23,
03ad04e7,micro,3,,"CharHeight := 60
CharWidth := 50",24,26,
03ad04e7,micro,4,,"NCandidates := 5
for I := 1 to 4 by 1
read_image (Image, 'ocr/yogurt_lid_' + I$'02')
decompose3 (Image, ImageR, ImageG, ImageB)
diff_of_gauss (ImageR, DiffOfGauss, DotDiameter / 2, 2)
scale_image_max (DiffOfGauss, ImageScaleMax)
gray_dilation_shape (ImageScaleMax, ImageMax, 3, 3, 'octagon')
invert_i...",27,76,"* --- Automatically Added Context ---
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
read_ocr_class_cnn ('Universal_NoRej.occ', OCRHandle)
DotDia..."
23e51c9d,full,0,"This example demonstrates how to segment the expiration date of
a yoghurt cap on a bilaterally filte...","dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)
create_text_model_reader ('auto...",11,66,
23e51c9d,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (2)
create_text_model_reader ('auto...",10,29,
23e51c9d,micro,2,,"for I := 1 to 4 by 1
read_image (Image, 'ocr/yogurt_lid_' + I$'02')
decompose3 (Image, ImageR, ImageG, ImageB)
gen_image_proto (ImageR, ImageJoint, 128)
for Index := 1 to 5 by 1
bilateral_filter (ImageR, ImageJoint, ImageJoint, 4, 30, [], [])
endfor
find_text (ImageJoint, TextModelDigits, TextResult...",30,72,"* --- Automatically Added Context ---
read_image (Image, 'ocr/yogurt_lid_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_text_model_reader ('auto', 'Universal_0-9+_Rej.occ', ..."
1ccd22a1,full,0,"This program demonstrates the use of the photometric stereo technique
for the inspection and reading...","dev_close_window ()
dev_update_off ()
read_image (Images, 'photometric_stereo/braille_0' + [1:4])
select_obj (Images, Image, 1)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_...",12,144,
1ccd22a1,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Images, 'photometric_stereo/braille_0' + [1:4])
select_obj (Images, Image, 1)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (12)
dev_...",11,26,
1ccd22a1,micro,2,"of the braille pattern and the corresponding character.
In this case a German 6-dot code is used.","CodeTable := ['', 'a', ',', 'b', '.', 'k', ';', 'l', '´', 'c', 'i', 'f', 'äu', 'm', 's', 'p', '', 'e', ':', 'h', '*', 'o', '!', 'r', 'CAPS', 'd', 'j', 'g', 'ä', 'n', 't', 'q', 'lcase', 'au', '?', 'eu', '-', 'u', '""', 'v', 'Cap', 'ei', 'ö', '', 'ie', 'x', 'ß', '', '', 'sch', '', 'ü', '""', 'z', '()', ...",27,31,
1ccd22a1,micro,3,,"for I := 1 to 4 by 1
Message := 'Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor",32,40,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/braille_0' + [1:4])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'Inspect and read braille tex..."
1ccd22a1,micro,4,curvature of the surface,"Tilts := [6.1, 95.0, -176.1, -86.8]
Slants := [41.4, 42.6, 41.7, 40.9]
ResultType := ['gradient', 'albedo']
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])",41,47,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/braille_0' + [1:4])
* --- End of Automatically Added Context ---"
1ccd22a1,micro,5,,"dev_display (Albedo)
disp_message (WindowHandle, 'The albedo image still has some artefacts', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",48,53,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [],..."
1ccd22a1,micro,6,"using the gradient field as input for the operator
derivate_vector_field.","derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')",54,58,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
1ccd22a1,micro,7,,"dev_display (MeanCurvature)
disp_message (WindowHandle, 'But it is easy to segment the dots in the curvature image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",59,64,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')
* --- End of Automatically Adde..."
1ccd22a1,micro,8,,"threshold (MeanCurvature, Regions, -0.14, -0.017)
connection (Regions, ConnectedRegions)
dilation_circle (ConnectedRegions, RegionDilation, 1.5)
select_shape (RegionDilation, Braille, ['area', 'roundness'], 'and', [191.82, 0.8108], [360.12, 1])
union1 (Braille, RegionUnion)",65,71,"* --- Automatically Added Context ---
derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')
* --- End of Automatically Added Context ---"
1ccd22a1,micro,9,,"closing_rectangle1 (Regions, RegionClosing, 90, 40)
connection (RegionClosing, ConnectedRegions)
shape_trans (ConnectedRegions, RegionTrans, 'rectangle1')
select_shape (RegionTrans, SelectedRegions, 'height', 'and', 50, 90)
dilation_rectangle1 (SelectedRegions, RegionDilation1, 21, 1)
partition_dyna...",72,80,"* --- Automatically Added Context ---
threshold (MeanCurvature, Regions, -0.14, -0.017)
connection (Regions, ConnectedRegions)
union1 (Braille, RegionUnion)
* --- End of Automatically Added Context --..."
1ccd22a1,micro,10,,"dev_display (MeanCurvature)
dev_set_draw ('margin')
dev_set_line_width (2)
dev_display (Partitioned)
dev_display (Letters)
disp_message (WindowHandle, 'Result', 'window', 12, 12, 'black', 'true')",81,88,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')
partition_dynamic (RegionDilati..."
1ccd22a1,micro,11,,"count_obj (Letters, NumLetters)
for I := 1 to NumLetters by 1
select_obj (Partitioned, CurrentRectangle, I)
region_features (CurrentRectangle, ['row1', 'height', 'column'], Limits)
MaxFirstRow := Limits[0] + Limits[1] / 3.0
MaxSecondRow := Limits[0] + Limits[1] * 2 / 3.0
MaxFirstColumn := Limits[2]
...",89,150,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
CodeTable := ['', 'a', ',', 'b', '.', 'k', ';', 'l', '´', 'c', 'i', 'f', 'äu', 'm', 's', 'p', '', 'e..."
ded83b5f,full,0,This example shows how to estimate the inclination of characters,"dev_update_window ('off')
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_display (Letters)
disp_message (WindowID, 'Original imag...",8,48,
ded83b5f,micro,1,,"dev_update_window ('off')
read_image (Letters, 'letters')
dev_close_window ()
get_image_size (Letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_display (Letters)
disp_message (WindowID, 'Original imag...",6,54,
9e529f2d,full,0,clip.hdev: Orientation of clips,"dev_update_window ('off')
read_image (Clip, 'clip')
get_image_size (Clip, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
dev_display (Clip)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
...",8,36,
9e529f2d,micro,1,,"dev_update_window ('off')
read_image (Clip, 'clip')
get_image_size (Clip, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
dev_display (Clip)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
...",6,42,
bc25b320,full,0,"This example shows how to use Fourier transforms to determine
the rotation angle of a grid.
First, a...","dev_close_window ()
dev_update_off ()
read_image (ImagePattern, 'grid/grid_01')
get_image_size (ImagePattern, Width, Height)
Scale := .7
HistoBorder := .15
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (Window...",14,326,
bc25b320,micro,1,"the rotation angle of a grid.
First, a reference image (rotation angle 0°) is used to create
a refer...","dev_close_window ()
dev_update_off ()
read_image (ImagePattern, 'grid/grid_01')
get_image_size (ImagePattern, Width, Height)
Scale := .7
HistoBorder := .15
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (Window...",6,29,
bc25b320,micro,2,,"optimize_fft_speed (180, 1, 'standard')
compute_edge_direction_histogram (ImagePattern, ImageDirRef, HistogramDirRef)
rft_generic (ImageDirRef, ImageFFTRef, 'to_freq', 'none', 'complex', 180)
dev_set_window (WindowHandle)
dev_display (ImagePattern)
disp_message (WindowHandle, 'Reference image', 'win...",30,48,"* --- Automatically Added Context ---
read_image (ImagePattern, 'grid/grid_01')
get_image_size (ImagePattern, Width, Height)
HistoBorder := .15
dev_open_window (0, 0, Width * Scale, Height * Scale, 'b..."
bc25b320,micro,3,,"NumImages := 7
for Index := 1 to 7 by 1
read_image (Image, 'grid/grid_' + Index$'.2d')
compute_edge_direction_histogram (Image, ImageTest, HistogramDirTest)
rft_generic (ImageTest, ImageFFTTest, 'to_freq', 'none', 'complex', 180)
correlation_fft (ImageFFTRef, ImageFFTTest, ImageCorrelation)
rft_gene...",49,106,"* --- Automatically Added Context ---
get_image_size (ImagePattern, Width, Height)
HistoBorder := .15
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
dev_open_window (0, (..."
bc25b320,micro,4,,"sobel_amp (Image, EdgeAmplitude, 'sum_abs', 3)
threshold (EdgeAmplitude, Region, 30, 255)
reduce_domain (Image, Region, ImageReduced)
edges_image (ImageReduced, ImageAmp, ImageDir, 'canny', 1, 'nms', 20, 40)",110,115,"* --- Automatically Added Context ---
read_image (Image, 'grid/grid_' + Index$'.2d')
* --- End of Automatically Added Context ---"
bc25b320,micro,5,,"gray_histo_range (ImageDir, ImageDir, 0, 179, 180, DirectionHisto, BinSize)
gen_image_const (ImageDirHistogram, 'real', 180, 1)
Row := gen_tuple_const(180,0)
Column := [0:179]
set_grayval (ImageDirHistogram, Row, Column, DirectionHisto[0:179] * 1.0)
return ()",116,141,"* --- Automatically Added Context ---
Row := gen_tuple_const(180,0)
Column := [0:179]
edges_image (ImageReduced, ImageAmp, ImageDir, 'canny', 1, 'nms', 20, 40)
* --- End of Automatically Added Context..."
bc25b320,micro,6,"corresponds to the relative angle between the two
images.","local_min_max_funct_1d (Function, 'plateaus_center', 'true', MinPos, MaxPos)
tuple_thresh (MaxPos, 1, 181, InnerMaxPos)
get_y_value_funct_1d (Function, InnerMaxPos, 'constant', MaxY)
tuple_find (MaxY, max(MaxY), MaxPosAbs)
Angle := 2 * (InnerMaxPos[MaxPosAbs] - 1)
if (Angle &gt; 180)
Angle := Angle ...",142,154,"* --- Automatically Added Context ---
plot_histo_scale (HistogramDirRef, WindowHisto, 'Angle [°]', 0, 359, 0, ValueYMax, 'black', 'blue', HistoBorder)
create_funct_1d_array ([Grayval[179],Grayval,Gray..."
bc25b320,micro,7,,"* local_min_max_funct_1d (Function, 'plateaus_center', 'true', MinPos, MaxPos)",155,157,"* --- Automatically Added Context ---
create_funct_1d_array ([Grayval[179],Grayval,Grayval[0]], Function)
local_min_max_funct_1d (Function, 'plateaus_center', 'true', MinPos, MaxPos)
* --- End of Auto..."
bc25b320,micro,8,"for the correlation (182 instead of 180 values), but ignore
values near the border.","* GlobalMax := 0
* GlobalX := 0
* for I := 0 to |MaxPos| - 1 by 1
*     get_y_value_funct_1d (Function, MaxPos[I], 'constant', Y)
*     if (Y &gt; GlobalMax and MaxPos[I] &gt;= 1 and MaxPos[I] &lt; 181)
*         GlobalMax := Y
*         GlobalX := MaxPos[I]
*     endif
* endfor",158,169,"* --- Automatically Added Context ---
create_funct_1d_array ([Grayval[179],Grayval,Grayval[0]], Function)
local_min_max_funct_1d (Function, 'plateaus_center', 'true', MinPos, MaxPos)
* --- End of Auto..."
bc25b320,micro,9,"from the interval (1,181) back to (0,179). Because the angle
is coded as half its value in the origi...",* Angle := (GlobalX - 1.0) * 2.0,170,174,"* --- Automatically Added Context ---
plot_histo_scale (HistogramDirRef, WindowHisto, 'Angle [°]', 0, 359, 0, ValueYMax, 'black', 'blue', HistoBorder)
* GlobalX := 0
* --- End of Automatically Added C..."
bc25b320,micro,10,,"* if (Angle &gt; 180)
*     Angle := Angle - 360
* endif
return ()",175,203,"* --- Automatically Added Context ---
plot_histo_scale (HistogramDirRef, WindowHisto, 'Angle [°]', 0, 359, 0, ValueYMax, 'black', 'blue', HistoBorder)
* --- End of Automatically Added Context ---"
bc25b320,micro,11,"[LabelXMin,LabelXMax] into the WindowHandle by leaving a
relative border around the plot.","if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
disp_message (WindowHandle, 'Failed to plot histogram', 'window', 12, 12, 'black', 'true')
return ()
endif",204,212,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
bc25b320,micro,12,,"get_part (WindowHandle, Row1, Column1, Row2, Column2)
PlotAreaX := (Column2 - Column1 + 1) * (1 - Border * 2)
PlotAreaY := (Row2 - Row1 + 1) * (1 - Border * 2)
OriginX := Column1 + Border * (Column2 - Column1 + 1)
OriginY := Row2 - Border * (Row2 - Column1 + 1)",213,219,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
* --- End of Automaticall..."
bc25b320,micro,13,,"MinY := min([Histogram,0,ValueYMin])
MaxY := max([Histogram,ValueYMax])",220,223,"* --- Automatically Added Context ---
ValueYMax := max(HistogramDirRef)
compute_edge_direction_histogram (ImagePattern, ImageDirRef, HistogramDirRef)
get_y_value_funct_1d (Function, InnerMaxPos, 'cons..."
bc25b320,micro,14,,"ScaleX := PlotAreaX / |Histogram|
if (MaxY == MinY)
ScaleY := PlotAreaY
MaxY := ''
else
ScaleY := PlotAreaY / (MaxY - MinY)
endif",224,232,"* --- Automatically Added Context ---
get_y_value_funct_1d (Function, InnerMaxPos, 'constant', MaxY)
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
PlotAreaX := (Column2 - Column1 + 1) * ..."
bc25b320,micro,15,,"polyX := []
polyY := []
for Value := 0 to |Histogram| - 1 by 1
polyX := [polyX,OriginX + Value * ScaleX]
polyY := [polyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
polyX := [polyX,OriginX + (Value + 1) * ScaleX]
polyY := [polyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
endfor
polyX := [polyX,...",233,248,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
OriginX := Column1 + Bord..."
bc25b320,micro,16,,"dev_set_color (ColorAxis)
gen_arrow_contour_xld (ArrowX, OriginY, OriginX, OriginY, OriginX + PlotAreaX, 5, 5)
gen_arrow_contour_xld (ArrowY, OriginY, OriginX, OriginY - PlotAreaY, OriginX, 5, 5)
dev_display (ArrowX)
dev_display (ArrowY)
dev_set_color (ColorAxis)
get_string_extents (WindowHandle, La...",249,312,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle)
get_y_value_funct_1d (Function, InnerMaxPos, 'constant', MaxY)
if (|Histogram| &lt;= ..."
bc25b320,micro,17,fulfill the equation Low &lt;= X &lt; High,"IndicesBelowHighThreshold := find(sgn(Tuple - High),-1)
if (IndicesBelowHighThreshold == -1)
IndicesBelowHighThreshold := []
endif
Tmp := subset(Tuple,IndicesBelowHighThreshold)
IndicesBelowLowThreshold := find(sgn(Tmp - Low),-1)
if (IndicesBelowLowThreshold == -1)
IndicesBelowLowThreshold := []
end...",313,337,
f39efabc,full,0,"This example shows how the orientation of a
almost rotationally symmetric object is determined
robus...","Interactive := false
Tolerance := 2.5
MinScoreMain := 0.7
MinScorePolar := 0.4
ContrastMain := 30
ContrastPolar := 20
Greediness := 0.5
MinContrast := 10
dev_update_off ()
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
threshold (Image, Region, 128, 255)
boundary (Region, RegionBord...",47,804,
f39efabc,micro,1,"If  this parameter is set to 1 (true),
the user will be asked to choose the model edges
for step 2 (...",Interactive := false,40,47,
f39efabc,micro,2,polar transformed image for step 2,Tolerance := 2.5,48,50,
f39efabc,micro,3,,MinScoreMain := 0.7,51,52,
f39efabc,micro,4,,MinScorePolar := 0.4,53,54,
f39efabc,micro,5,,ContrastMain := 30,55,56,
f39efabc,micro,6,,ContrastPolar := 20,57,58,
f39efabc,micro,7,,"Greediness := 0.5
MinContrast := 10",59,62,
f39efabc,micro,8,,"dev_update_off ()
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')",67,70,
f39efabc,micro,9,"It is important, that the center of the model
is equal to the rotation center of the object.","threshold (Image, Region, 128, 255)
boundary (Region, RegionBorder, 'inner')
dilation_circle (RegionBorder, RegionDilation, 3.5)
reduce_domain (Image, RegionDilation, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'canny', 1, 20, 40)
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowF...",71,80,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
* --- End of Automatically Added Context ---"
f39efabc,micro,10,,"RegionRadius := Radius + 10
Clip := RegionRadius + 50
gen_circle (ModelRegion, RowFittedCircle, ColumnFittedCircle, RegionRadius)
reduce_domain (Image, ModelRegion, ModelImage)
create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'metric', 'use_polarity')
set_generic_shape_mo...",81,88,"* --- Automatically Added Context ---
ContrastMain := 30
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, Col..."
f39efabc,micro,11,"in the correct barycenter of the model region
(which is in the middle of the top left pixel).
Thus, ...","set_generic_shape_model_param (ModelID, 'origin_row', 0.5)
set_generic_shape_model_param (ModelID, 'origin_column', 0.5)
set_generic_shape_model_param (ModelID, 'min_contrast', MinContrast)
train_generic_shape_model (ModelImage, ModelID)",89,97,"* --- Automatically Added Context ---
MinContrast := 10
reduce_domain (Image, ModelRegion, ModelImage)
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
f39efabc,micro,12,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
get_window_extents (WindowHandle, WindowRow, WindowColumn, WindowWidth, WindowHeight)
get_image_size (Image, ImageWidth, ImageHeight)
Aspect := real(ImageWidth) / ImageHeight
set_display_font (Window...",100,115,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, ColumnFittedCircle, Ra..."
f39efabc,micro,13,,"AsymModelReady := 0
while (not AsymModelReady)
dev_set_part (RowFittedCircle - Clip, ColumnFittedCircle - Clip * Aspect, RowFittedCircle + Clip, ColumnFittedCircle + Clip * Aspect)
draw_model_region (Image, ModelRegion, 'white')
display_model (ModelID, 'yellow', RowFittedCircle, ColumnFittedCircle)
...",116,151,"* --- Automatically Added Context ---
Interactive := false
ContrastPolar := 20
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2..."
f39efabc,micro,14,,"distance_pr (AsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RadiusInner, RadiusOuter)
area_center (AsymEdgesRegion, Area, RowAsymEdgesRegion, ColumnAsymEdgesRegion)
angle_lx (RowFittedCircle, ColumnFittedCircle, RowAsymEdgesRegion, ColumnAsymEdgesRegion, RefAngle)
PolarWidth := round(RadiusOu...",156,162,"* --- Automatically Added Context ---
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, ColumnFittedCircle, Radius, StartPhi, EndPhi, PointOrder)
draw_refinement_region (Asym..."
f39efabc,micro,15,,"polar_trans_region (AsymEdgesRegion, PolarTransAsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RefAngle + rad(180), RefAngle + rad(540), RadiusInner, RadiusOuter, PolarWidth, PolarHeight, 'bilinear')
smallest_rectangle1 (PolarTransAsymEdgesRegion, Row1, Column1, Row2, Column2)
RegionWidth := C...",163,166,"* --- Automatically Added Context ---
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, ColumnFittedCircle, Radius, StartPhi, EndPhi, PointOrder)
draw_refinement_region (Asym..."
f39efabc,micro,16,"model region to make sure, that the asymmetric part is
completely visible even if it is near the bor...","AngleOverlap := RegionWidth * rad(360) / PolarWidth
PolarStartAngle := RefAngle - AngleOverlap / 2
PolarEndAngle := RefAngle + rad(360) + AngleOverlap / 2
PolarAngleRangeExtended := PolarEndAngle - PolarStartAngle
PolarWidthExtended := round(RadiusOuter * PolarAngleRangeExtended)
Data := dict{['pola...",167,177,"* --- Automatically Added Context ---
distance_pr (AsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RadiusInner, RadiusOuter)
angle_lx (RowFittedCircle, ColumnFittedCircle, RowAsymEdgesRegion, Co..."
f39efabc,micro,17,,"polar_trans_image_ext (Image, PolarTransModelImage, RowFittedCircle, ColumnFittedCircle, PolarStartAngle, PolarEndAngle, RadiusInner, RadiusOuter, PolarWidthExtended, PolarHeight, 'bilinear')
polar_trans_region (AsymEdgesRegion, PolarTransModelRegion, RowFittedCircle, ColumnFittedCircle, PolarStartA...",178,181,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, ColumnFittedCircle, Ra..."
f39efabc,micro,18,transformed image,"shape_trans (PolarTransModelRegion, RegionTrans, 'convex')
reduce_domain (PolarTransModelImage, RegionTrans, PolarModelImage)
create_generic_shape_model (ModelIDPolar)
set_generic_shape_model_param (ModelIDPolar, 'num_levels', 1)
set_generic_shape_model_param (ModelIDPolar, 'angle_start', 0)
set_gen...",182,195,"* --- Automatically Added Context ---
ContrastPolar := 20
MinContrast := 10
Data := dict{['polar_extension']: dict{['polar_height']: PolarHeight, ['polar_angle_range_extended']: PolarAngleRangeExtende..."
f39efabc,micro,19,,"set_generic_shape_model_param (ModelIDPolar, 'num_matches', 1)
set_generic_shape_model_param (ModelIDPolar, 'min_score', MinScorePolar)
set_generic_shape_model_param (ModelIDPolar, 'greediness', Greediness)
find_generic_shape_model (PolarModelImage, ModelIDPolar, MatchPolarRefResultID, NumMatchPolar...",196,204,"* --- Automatically Added Context ---
MinScorePolar := 0.4
Greediness := 0.5
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RadiusIn..."
f39efabc,micro,20,,"dev_set_part (0, 0, ImageHeight - 1, ImageWidth - 1)
dev_set_line_width (1)
dev_open_window (0, WindowWidth + 12, 1, 1, 'black', WindowHandlePolar)
set_display_font (WindowHandlePolar, 14, 'mono', 'true', 'false')
set_generic_shape_model_param (ModelID, 'greediness', Greediness)
set_generic_shape_mo...",209,304,"* --- Automatically Added Context ---
Tolerance := 2.5
MinScoreMain := 0.7
Greediness := 0.5
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
create_generic_shape_model (ModelID)
dev_op..."
f39efabc,micro,21,and let the user choose one of either options.,"Message := 'Please choose whether the selected model'
Message[1] := 'is acceptable or not by clicking'
Message[2] := 'on one of the buttons below.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
OKButtonRow := CenterRow + Border / 2
OKButtonColumn := CenterColumn + Border
Ca...",307,327,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
* --- End of Automatically Added Context ---"
f39efabc,micro,22,,"Cancel := 0
Ready := 0
while (not (Cancel or Ready))
get_mbutton (WindowHandle, Row, Column, Button)
test_region_point (OKButton, Row, Column, Ready)
test_region_point (CancelButton, Row, Column, Cancel)
endwhile
return ()",328,365,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
get_generic_shape_model_result (MatchRoughResultID, IndMatch, 'row', Row)
get_generic_shape_model_r..."
f39efabc,micro,23,for the interactive part.,"Offset1 := 111
Offset2 := 333
crop_rectangle1 (Image, ImagePart, RowFittedCircle - Offset1, ColumnFittedCircle - Offset1, RowFittedCircle + Offset1, ColumnFittedCircle + Offset1)
concat_obj (ImagePart, ImagePart, ObjectsConcat)
tile_images (ObjectsConcat, TiledImage, 1, 'vertical')
dev_open_window_f...",366,413,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
fit_circle_contour_xld (Edges, 'geohuber', -1, 0, 0, 3, 2, RowFittedCircle, ColumnFittedCircle, Ra..."
f39efabc,micro,24,"(More accurately, the edges determined and displayed in the
original image, the actual model may dif...","reduce_domain (Image, AsymEdgesRegion, ImageReduced)
inspect_shape_model (ImageReduced, ModelImages, ModelRegions, 1, ContrastPolar)
dev_set_color ('white')
dev_display (AsymEdgesRegion)
dev_set_color ('blue')
dev_set_draw ('fill')
dev_display (ModelRegions)
return ()
Message := 'To determine the co...",414,467,"* --- Automatically Added Context ---
ContrastPolar := 20
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
reduce_domain (Image, RegionDilation, ImageReduced)
dev_open_window_fit_image ..."
f39efabc,micro,25,,"Message := 'Use the mouse to mark the NOT rotationally symmetric edges'
Message[|Message|] := 'that will be used for the refinement step'
Message[|Message|] := 'by re-drawing them with the left mouse button pressed.'
Message[|Message|] := '(Right-click to continue.)'
disp_message (WindowHandleMain, ...",468,518,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
draw_refinement_region (AsymEdgesRegion, WindowHandle)
Message := 'Please choose whether the select..."
f39efabc,micro,26,"in the image.
Note, as this is the original model it is
neither rotated nor scaled.","dev_set_color (Color)
get_generic_shape_model_param (ModelID, 'origin_row', ModelOriginRow)
get_generic_shape_model_param (ModelID, 'origin_column', ModelOriginCol)",519,528,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
f39efabc,micro,27,,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, TranslateRow, TranslateCol, HomMat2DTranslate)
get_generic_shape_model_object (ModelContours, ModelID, 'contours')
affine_trans_contour_xld (ModelContours, ModelAffineTrans, HomMat2DTranslate)
dev_display (ModelAffineTrans)",529,535,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
f39efabc,micro,28,,"hom_mat2d_translate (HomMat2DIdentity, -0.5, -0.5, EC_T_PC)
hom_mat2d_compose (EC_T_PC, HomMat2DTranslate, HomMat2DTranslate)
affine_trans_point_2d (HomMat2DTranslate, ModelOriginRow, ModelOriginCol, ModelOriginRow, ModelOriginCol)
gen_cross_contour_xld (ModelCenter, ModelOriginRow, ModelOriginCol, ...",536,593,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
gen_circle (ModelRegion, RowFittedCircle, ColumnFittedCircle, RegionRadius)
dev_set_color (Color)
..."
f39efabc,micro,29,"with their angle as well as their corresponding
refined orientation.","dev_set_window (WindowHandle)
dev_display (Data.image)",594,600,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, Colu..."
f39efabc,micro,30,,"Title := 'Image ' + Data.image_index + '/' + Data.num_images
disp_message (WindowHandle, Title, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Rough result', 'image', 960, 24, 'yellow', 'false')
disp_message (WindowHandle, '             /', 'image', 960, 24, 'white', 'false')
disp_m...",601,607,"* --- Automatically Added Context ---
read_image (Image, 'plastic_parts/cistern_valve_diaphragms_01')
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - ..."
f39efabc,micro,31,,"MatchRoughResultID := Data.match_rough_result
get_generic_shape_model_result (MatchRoughResultID, 'all', 'num_match_result', NumMatches)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, -0.5, -0.5, EC_T_PC)",608,614,"* --- Automatically Added Context ---
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RadiusInner, RadiusOuter)
angle_lx (RowFittedCi..."
f39efabc,micro,32,,"RefinementFailed := []
for IndMatch := 0 to NumMatches - 1 by 1
get_generic_shape_model_result (MatchRoughResultID, IndMatch, 'row', Row)
get_generic_shape_model_result (MatchRoughResultID, IndMatch, 'column', Column)
disp_message (WindowHandle, '#' + (IndMatch + 1), 'image', Row - 110, Column - 25,...",615,673,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, Colu..."
f39efabc,micro,33,"as well as the contours and origins of the refined
matches.
For comparison show the model and its ce...","BorderLeft := 40
BorderRight := 160
BorderUp := 90
BorderDown := 40
ScaleFactor := .66",674,686,
f39efabc,micro,34,,"MatchRoughResultID := Data.match_rough_result
get_generic_shape_model_result (MatchRoughResultID, 'all', 'num_match_result', NumMatches)
gen_empty_obj (PolarResultImages)
for IndMatch := 0 to NumMatches - 1 by 1
concat_obj (PolarResultImages, Data.['match_'+IndMatch].polar_trans_image, PolarResultIm...",687,704,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, Colu..."
f39efabc,micro,35,to calculate the visualization placements.,"MatchPolarRefResultID := Data.match_polar_ref_result
get_generic_shape_model_result (MatchPolarRefResultID, 'all', 'column', ColumnRefPolar)
PolarExtension := Data.polar_extension
AngleToColumnScale := (PolarExtension.polar_width_extended - 1) / PolarExtension.polar_angle_range_extended
ColumnScale3...",705,711,"* --- Automatically Added Context ---
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, ColumnFittedCircle, RadiusInner, RadiusOuter)
angle_lx (RowFittedCi..."
f39efabc,micro,36,,"PolarHeight := PolarExtension.polar_height
gen_contour_polygon_xld (Scale, NumMatches * [PolarHeight,PolarHeight,PolarHeight,PolarHeight] + [0, 15, 15, 0], [ColumnRefPolar,ColumnRefPolar,ColumnScale360,ColumnScale360])
dev_display (Scale)
disp_message (WindowHandle, '0°', 'image', NumMatches * Polar...",712,720,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, Colu..."
f39efabc,micro,37,,"for IndMatch := 0 to NumMatches - 1 by 1
MatchPolarID := Data.['match_' + IndMatch].match_polar_result
get_generic_shape_model_result (MatchPolarID, 'all', 'num_match_result', NumMatchesRefined)
if (NumMatchesRefined == 0)
continue
endif
dev_set_color ('green')
get_generic_shape_model_result_object ...",721,794,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, 500, WindowHandle)
PolarHeight := round(RadiusOuter - RadiusInner)
distance_pr (AsymEdgesRegion, RowFittedCircle, Colu..."
f39efabc,micro,38,,"TwoPi := rad(360)
AngleOut := AngleIn
while (AngleOut &lt; 0)
AngleOut := AngleOut + TwoPi
endwhile
while (AngleOut &gt;= TwoPi)
AngleOut := AngleOut - TwoPi
endwhile
return ()",795,813,
ceee0bfc,full,0,"This example shows how to determine the angle of
rotation leading to a correct alignment of a wafer
...","dev_update_off ()
dev_close_window ()
read_image (Image, 'wafer/wafer_rotated')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
RotCenterRow := 360.13
RotCenterCol := 359.99
gen_cross_contour_xld (Cros...",12,53,
ceee0bfc,micro,1,"rotation leading to a correct alignment of a wafer
using the operator text_line_orientation. For tha...","dev_update_off ()
dev_close_window ()
read_image (Image, 'wafer/wafer_rotated')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')",6,18,
ceee0bfc,micro,2,"e.g., by using the operator optical_flow_mg.
See also the example: rotation_from_optical_flow.hdev","RotCenterRow := 360.13
RotCenterCol := 359.99
gen_cross_contour_xld (Cross, RotCenterCol, RotCenterCol, 20, 0.785398)
gen_rectangle1 (Rectangle, RotCenterRow - 55, RotCenterCol - 300, RotCenterRow + 55, RotCenterCol + 300)
dev_display (Image)
dev_set_line_width (3)
dev_set_color ('yellow')
dev_displ...",19,36,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_rotated')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
ceee0bfc,micro,3,correct the alignment,"reduce_domain (Image, Rectangle, ImageReduced)
text_line_orientation (Rectangle, ImageReduced, 25, rad(-30), rad(30), OrientationAngle)
Angle := -deg(OrientationAngle)
rotate_image (Image, ImageRotate, Angle, 'constant')",37,43,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_rotated')
gen_rectangle1 (Rectangle, RotCenterRow - 55, RotCenterCol - 300, RotCenterRow + 55, RotCenterCol + 300)
* --- End of Au..."
ceee0bfc,micro,4,,"dev_clear_window ()
dev_display (ImageRotate)
dev_set_line_width (3)
dev_set_color ('yellow')
dev_display (Rectangle)
dev_set_line_width (2)
dev_set_color ('white')
dev_display (Cross)
disp_message (WindowHandle, 'The wafer must be rotated by ' + Angle$'.2f' + '° \nto be correctly aligned', 'window'...",44,59,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cross_contour_xld (Cross, RotCenterCol, RotCenterCol, 20, 0.785398)
gen_rectangle1 (Rectangle, R..."
d7212a89,full,0,"This example program shows how to use local deformable
matching to find objects that are deformed.
N...","dev_update_off ()
read_image (ModelImage, 'food/cocoa_package_model')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 1, [], 'auto', ...",25,123,
d7212a89,micro,1,"deformable matching. You can compare it to the example
'find_cocoa_packages_max_deformation.hdev', w...","dev_update_off ()
read_image (ModelImage, 'food/cocoa_package_model')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",14,30,
d7212a89,micro,2,,"create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 1, [], 'auto', 1, [], 'auto', 'none', 'use_polarity', [40, 60], 'auto', [], [], ModelID)
get_deformable_model_contours (ModelContours, ModelID, 1)
area_center (ModelImage, Area, Row, Column)
hom_mat2d_identity (HomMat2DIdentity)
hom_...",31,94,"* --- Automatically Added Context ---
read_image (ModelImage, 'food/cocoa_package_model')
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context --..."
d7212a89,micro,3,The step width is given by the parameter Step.,"gen_empty_obj (WarpedMesh)
count_obj (VectorField, Number)
for Index := 1 to Number by 1
select_obj (VectorField, ObjectSelected, Index)
vector_field_to_real (ObjectSelected, DRow, DColumn)
get_image_size (VectorField, Width, Height)
for ContR := 0.5 to Height[0] - 1 by Step
Column := [0.5:Width[0] ...",95,133,"* --- Automatically Added Context ---
area_center (ModelImage, Area, Row, Column)
for Index := 1 to NumImages by 1
find_local_deformable_model (Image, ImageRectified, VectorField, DeformedContours, Mo..."
0e3995d5,full,0,"This example program shows how to use shape-based
matching to find objects that are slightly deforme...","dev_update_off ()
read_image (ModelImage, 'food/cocoa_package_model')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_shape_model (ModelImage, 'auto', rad(-20), rad(40), 'auto', 'auto', 'use_po...",27,69,
0e3995d5,micro,1,"matching and the parameter 'max_deformation'.
You can compare it to the example
'find_cocoa_packages...","dev_update_off ()
read_image (ModelImage, 'food/cocoa_package_model')
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",15,32,
0e3995d5,micro,2,,"create_shape_model (ModelImage, 'auto', rad(-20), rad(40), 'auto', 'auto', 'use_polarity', [40, 60, 'auto_min_size'], 10, ModelID)
get_shape_model_contours (ModelContours, ModelID, 1)
area_center (ModelImage, Area, Row, Column)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdent...",33,75,"* --- Automatically Added Context ---
read_image (ModelImage, 'food/cocoa_package_model')
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context --..."
1cc1ce74,full,0,"Many dies are typically etched on a wafer. Before the single
dies can be picked by a die bonder and ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'wafer/wafer_mirror_dies_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_display (Image)
disp_message (WindowHandle, 'Determine the posi...",13,57,
1cc1ce74,micro,1,"dies can be picked by a die bonder and placed onto a lead
frame, they must be diced from the wafer. ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'wafer/wafer_mirror_dies_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_display (Image)
disp_message (WindowHandle, 'Determine the posi...",6,23,
1cc1ce74,micro,2,,"gen_rectangle1 (Rectangle, 362, 212, 414, 262)
reduce_domain (Image, Rectangle, ImageReduced)
create_generic_shape_model (ModelID)
train_generic_shape_model (ImageReduced, ModelID)
set_generic_shape_model_param (ModelID, 'angle_start', 0)
set_generic_shape_model_param (ModelID, 'angle_end', rad(1))
...",24,34,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_mirror_dies_01')
* --- End of Automatically Added Context ---"
1cc1ce74,micro,3,,"for Index := 1 to 4 by 1
read_image (Image, 'wafer/wafer_mirror_dies_' + Index$'02')
count_seconds (S1)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
count_seconds (S2)
Runtime := (S2 - S1) * 1000
dev_display (Image)
dev_set_color ('lime green')
get_generic_shape_model_res...",35,63,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_mirror_dies_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_generic_shape_model (ModelID)
* --- End of A..."
f83b1e2b,full,0,"This example program shows how to find pads in an image and how to
determine their position, rotatio...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'die_pads')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
fast_threshold (Image, Regio...",9,40,
f83b1e2b,micro,1,"determine their position, rotation, and size robustly and accurately using
fit_rectangle2_contour_xl...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'die_pads')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)",6,16,
f83b1e2b,micro,2,,"fast_threshold (Image, Region, 180, 255, 20)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, ['area', 'anisometry'], 'and', [200, 1], [1200, 2])",17,20,"* --- Automatically Added Context ---
read_image (Image, 'die_pads')
* --- End of Automatically Added Context ---"
f83b1e2b,micro,3,,"fill_up (SelectedRegions, RegionFillUp)
shape_trans (RegionFillUp, RegionTrans, 'convex')
boundary (RegionTrans, RegionBorder, 'inner')
dilation_circle (RegionBorder, RegionDilation, 2.5)
union1 (RegionDilation, RegionUnion)",21,26,"* --- Automatically Added Context ---
select_shape (ConnectedRegions, SelectedRegions, ['area', 'anisometry'], 'and', [200, 1], [1200, 2])
* --- End of Automatically Added Context ---"
f83b1e2b,micro,4,,"reduce_domain (Image, RegionUnion, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'sobel_fast', 0.5, 20, 40)",27,29,"* --- Automatically Added Context ---
read_image (Image, 'die_pads')
union1 (RegionDilation, RegionUnion)
* --- End of Automatically Added Context ---"
f83b1e2b,micro,5,,"select_shape_xld (Edges, SelectedContours, 'contlength', 'and', 10, 200)",30,31,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'sobel_fast', 0.5, 20, 40)
* --- End of Automatically Added Context ---"
f83b1e2b,micro,6,,"union_adjacent_contours_xld (SelectedContours, UnionContours, 2, 1, 'attr_keep')",32,33,"* --- Automatically Added Context ---
select_shape_xld (Edges, SelectedContours, 'contlength', 'and', 10, 200)
* --- End of Automatically Added Context ---"
f83b1e2b,micro,7,,"fit_rectangle2_contour_xld (UnionContours, 'tukey', -1, 0, 0, 3, 2, Row, Column, Phi, Length1, Length2, PointOrder)",34,35,"* --- Automatically Added Context ---
union_adjacent_contours_xld (SelectedContours, UnionContours, 2, 1, 'attr_keep')
* --- End of Automatically Added Context ---"
f83b1e2b,micro,8,,"gen_rectangle2_contour_xld (Rectangle, Row, Column, Phi, Length1, Length2)
dev_display (Image)
dev_set_colored (12)
dev_display (Rectangle)",36,46,"* --- Automatically Added Context ---
read_image (Image, 'die_pads')
fit_rectangle2_contour_xld (UnionContours, 'tukey', -1, 0, 0, 3, 2, Row, Column, Phi, Length1, Length2, PointOrder)
* --- End of Au..."
4589ff4d,full,0,"This example program shows how to use local deformable
matching to find objects that are deformed.
T...","dev_update_off ()
dev_close_window ()
read_image (ModelImage, 'food/peanut_chocolate_candies_model')
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 1, [...",17,116,
4589ff4d,micro,1,"'find_cocoa_packages_local_deformable.hdev' and
'find_cocoa_packages_max_deformation.hdev'","dev_update_off ()
dev_close_window ()
read_image (ModelImage, 'food/peanut_chocolate_candies_model')
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",13,22,
4589ff4d,micro,2,,"create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 1, [], 'auto', 1, [], 'auto', 'none', 'use_polarity', 65, 25, [], [], ModelID)
get_deformable_model_contours (ModelContours, ModelID, 1)
area_center (ModelImage, Area, Row, Column)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_tran...",23,37,"* --- Automatically Added Context ---
read_image (ModelImage, 'food/peanut_chocolate_candies_model')
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added..."
4589ff4d,micro,3,,"Smoothness := 19
NumImages := 12
for Index := 1 to NumImages by 1
read_image (Image, 'food/peanut_chocolate_candies_' + Index$'02')
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
dev_display (Image)
disp_message (WindowHandle, 'Search ...', 'window', 12, 12, 'black', 'true')
count_seconds (S1)
fi...",38,87,"* --- Automatically Added Context ---
dev_open_window_fit_image (ModelImage, 0, 0, -1, -1, WindowHandle)
create_local_deformable_model (ModelImage, 'auto', [], [], 'auto', 1, [], 'auto', 1, [], 'auto'..."
4589ff4d,micro,4,The step width is given by the parameter Step.,"gen_empty_obj (WarpedMesh)
count_obj (VectorField, Number)
for Index := 1 to Number by 1
select_obj (VectorField, ObjectSelected, Index)
vector_field_to_real (ObjectSelected, DRow, DColumn)
get_image_size (VectorField, Width, Height)
for ContR := 0.5 to Height[0] - 1 by Step
Column := [0.5:Width[0] ...",88,126,"* --- Automatically Added Context ---
area_center (ModelImage, Area, Row, Column)
for Index := 1 to NumImages by 1
find_local_deformable_model (Image, ImageRectified, VectorField, DeformedContours, Mo..."
784fdaf5,full,0,"This program shows how to detect the position of SMDs on a
back illuminated plate very fast.","dev_update_off ()
dev_close_window ()
read_image (Image, 'smd/smd_backlight_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Locate SMDs in the short...",9,45,
784fdaf5,micro,1,back illuminated plate very fast.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'smd/smd_backlight_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Locate SMDs in the short...",6,19,
784fdaf5,micro,2,,"NumImages := 16
for Index := 1 to NumImages by 1
read_image (Image, 'smd/smd_backlight_' + Index$'02')
count_seconds (S1)
fast_threshold (Image, Region, 0, 100, 100)
connection (Region, ConnectedRegions)
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
smallest_rectangle2 (Selecte...",20,51,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_backlight_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
98556c4b,full,0,"This example program shows the use of the operator find_shape_model
with the increased tolerance mod...","read_image (Image, 'pcb_focus/pcb_focus_telecentric_060')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)
gen_rectangle1 (Rectangle, ...",20,53,
98556c4b,micro,1,"Unfortunately, the PCB cannot always be imaged in focus.
If find_shape_model is used in standard mod...","read_image (Image, 'pcb_focus/pcb_focus_telecentric_060')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)",10,27,
98556c4b,micro,2,,"gen_rectangle1 (Rectangle, 50, 120, 400, 600)
reduce_domain (Image, Rectangle, ImageReduced)
create_shape_model (ImageReduced, 'auto', -0.39, 0.78, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)
area_center (Rectangle, Area, Row, Column)
dev_clear_window ()
dev_display (Image)
dev_display_...",28,59,"* --- Automatically Added Context ---
read_image (Image, 'pcb_focus/pcb_focus_telecentric_060')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
* --- End of Automatically Added Context..."
02d1339c,full,0,"This example program shows the use of the operator find_shape_model
with the increased tolerance mod...","list_image_files ('halogen_bulb', [], 'recursive', ImageFiles)
tuple_regexp_select (ImageFiles, 'good', ImageFilesGood)
read_image (Image, ImageFilesGood[0])
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mon...",22,59,
02d1339c,micro,1,"Unfortunately, the geometry of the leads varies slightly and the
reflections from the glass body dis...","list_image_files ('halogen_bulb', [], 'recursive', ImageFiles)
tuple_regexp_select (ImageFiles, 'good', ImageFilesGood)
read_image (Image, ImageFilesGood[0])
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mon...",10,31,
02d1339c,micro,2,,"gen_rectangle1 (Rectangle, 400, 300, 900, 1000)
reduce_domain (Image, Rectangle, ImageReduced)
create_shape_model (ImageReduced, 'auto', -0.39, 0.78, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)
area_center (Rectangle, Area, Row, Column)
dev_clear_window ()
dev_display (Image)
dev_displa...",32,65,"* --- Automatically Added Context ---
list_image_files ('halogen_bulb', [], 'recursive', ImageFiles)
read_image (Image, ImageFilesGood[0])
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandl..."
f7c7836d,full,0,"This program demonstrates how object instances
extending beyond the image border can be found
using ...","dev_close_window ()
dev_update_off ()
Files := ['multiple_dies_01', 'multiple_dies_02']
read_image (Image, Files[0])
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')...",10,58,
f7c7836d,micro,1,"extending beyond the image border can be found
using shape-based matching.","dev_close_window ()
dev_update_off ()
Files := ['multiple_dies_01', 'multiple_dies_02']
read_image (Image, Files[0])
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')...",6,65,
691c336a,full,0,"This example demonstrates shape based matching with multi channel images.
A robot is supposed to gra...","Mode := 'multi channel'
* Mode := 'gray'
dev_update_off ()
set_system ('border_shape_models', 'false')
read_image (Image, 'color/clamp_front_model')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (Window...",15,76,
691c336a,micro,1,,"Mode := 'multi channel'
* Mode := 'gray'",14,16,
691c336a,micro,2,,"dev_update_off ()
set_system ('border_shape_models', 'false')
read_image (Image, 'color/clamp_front_model')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_...",19,28,
691c336a,micro,3,"Because the pieces may be flipped, two models are created.","if (Mode == 'gray')
rgb1_to_gray (Image, Image)
endif
dev_display (Image)
disp_message (WindowHandle, 'Create Shape Model 1', 'window', 12, 12, 'black', 'true')
create_aniso_shape_model (Image, 5, rad(0), rad(360), 'auto', 0.7, 1.3, 'auto', 1, 1, 'auto', 'auto', 'ignore_color_polarity', 'auto', 'aut...",29,54,"* --- Automatically Added Context ---
Mode := 'multi channel'
read_image (Image, 'color/clamp_front_model')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
* --- End of Automatica..."
691c336a,micro,4,,"for Index := 1 to 8 by 1
read_image (Image, 'color/clamp_pile_' + Index$'02')
if (Mode == 'gray')
rgb1_to_gray (Image, Image)
endif
find_aniso_shape_models (Image, [ModelID1,ModelID2], rad(0), rad(360), 0.7, 1.3, 1, 1, 0.80, 1, 0.5, 'least_squares', 0, 0.80, Row, Column, Angle, ScaleR, ScaleC, Score...",55,82,"* --- Automatically Added Context ---
Mode := 'multi channel'
read_image (Image, 'color/clamp_front_model')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
disp_message (WindowHan..."
a888fd91,full,0,"This example demonstrates shape based matching
with multi channel images
Init display","dev_update_off ()
Mode := 'multi channel'
ModelColor := 'green'
CircleColor := 'white'
Names := ['Pear Apple Hazelnut', 'Cherry Currant', 'Strawberry']
read_image (Image, 'color/yogurt_model_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black',...",10,83,
a888fd91,micro,1,,"dev_update_off ()
Mode := 'multi channel'
ModelColor := 'green'
CircleColor := 'white'
Names := ['Pear Apple Hazelnut', 'Cherry Currant', 'Strawberry']
read_image (Image, 'color/yogurt_model_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black',...",9,20,
a888fd91,micro,2,,"ModelIDs := []
for Index := 1 to 3 by 1
read_image (Image, 'color/yogurt_model_' + Index$'02')
dev_display (Image)
access_channel (Image, Channel1, 1)
fast_threshold (Channel1, Region, 75, 255, 20)
fill_up (Region, RegionFillUp)
opening_circle (RegionFillUp, RegionOpening, 170.5)
gen_contour_region_...",21,54,"* --- Automatically Added Context ---
ModelColor := 'green'
CircleColor := 'white'
Names := ['Pear Apple Hazelnut', 'Cherry Currant', 'Strawberry']
read_image (Image, 'color/yogurt_model_01')
dev_open..."
a888fd91,micro,3,,"for Index := 1 to 10 by 1
read_image (Image, 'color/yogurt_' + Index$'02')
access_channel (Image, Channel1, 1)
fast_threshold (Channel1, Region, 50, 255, 20)
fill_up (Region, RegionFillUp)
erosion_rectangle1 (RegionFillUp, RegionErosion, 210, 210)
reduce_domain (Image, RegionErosion, ImageReduced)
f...",55,89,"* --- Automatically Added Context ---
ModelColor := 'green'
CircleColor := 'white'
Names := ['Pear Apple Hazelnut', 'Cherry Currant', 'Strawberry']
read_image (Image, 'color/yogurt_model_01')
dev_open..."
a684a733,full,0,"This example program shows how to recognize planar objects
using HALCON's shape-based matching if th...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
CalTabDescription := 'caltab_30mm.descr'
gen_cam_par_area_scan_divis...",20,226,
a684a733,micro,1,"using HALCON's shape-based matching if the camera is not
mounted perpendicular to the plane in which...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
dev_set_part (0, 0, 481, 645)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",6,26,
a684a733,micro,2,,"CalTabDescription := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000073, 0.0000073, 323, 241, 646, 482, StartCamPar)",27,30,
a684a733,micro,3,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescription)
NumImages := 15
for I := 1 to NumImages by 1
read_image (Image, 'radius-gauges/calib-' + I$'02d')
dev_display (Image)...",31,48,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
CalTabDescription := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000073, 0.0000073, 3..."
a684a733,micro,4,"plane that is parallel to the plane in which the objects lie.
This pose can be used to see how much ...","get_calib_data (CalibDataID, 'calib_obj_pose', [0, 1], 'pose', PoseCalib)",49,53,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
a684a733,micro,5,"plane that is offset from the plane in which the objects lie by
the thickness of the calibration tar...","set_origin_pose (PoseCalib, -0.066, -0.048, 0.00063, Pose)",54,65,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, 0, 0, I, Row, Column, Index, Pose)
get_calib_data (CalibDataID, 'calib_obj_pose', [0, 1], 'pose', PoseCalib)
* --- End ..."
a684a733,micro,6,"image. In this case, we set it to 0.2mm (i.e., 0.0002m).",PixelDist := 0.0002,66,68,
a684a733,micro,7,"because it does not change (the camera does not move with
respect to the world plane).","gen_image_to_world_plane_map (Map, CamParam, Pose, 646, 482, 596, 448, PixelDist, 'bilinear')",69,72,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, 0, 0, I, Row, Column, Index, Pose)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
PixelDist := 0.0002
* ..."
a684a733,micro,8,"system, i.e., the coordinate system of the plane, to the camera
coordinate system. This transformati...","pose_to_hom_mat3d (Pose, HomMat3D)",73,78,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, 0, 0, I, Row, Column, Index, Pose)
* --- End of Automatically Added Context ---"
a684a733,micro,9,shape model.,"read_image (Image, 'radius-gauges/radius-gauges-00')
dev_display (Image)",79,82,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
* --- End of Automatically Added Context ---"
a684a733,micro,10,,"disp_message (WindowHandle, 'Rotation of the camera:', 'image', 350, 20, 'green', 'false')
disp_message (WindowHandle, 'x axis: ' + PoseCalib[3]$'7.3f' + '°', 'image', 380, 20, 'green', 'false')
disp_message (WindowHandle, 'y axis: ' + PoseCalib[4]$'7.3f' + '°', 'image', 410, 20, 'green', 'false')
d...",83,88,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
get_calib_data (CalibDataID, 'calib_obj_pose', [0, 1], 'pose', PoseCalib)
* --- End of Automatically Added..."
a684a733,micro,11,rectified image.,"map_image (Image, Map, ImageRectified)
gen_rectangle1 (Rectangle, 120, 220, 340, 450)
area_center (Rectangle, Area, RowRef, ColumnRef)
reduce_domain (ImageRectified, Rectangle, ImageReduced)
create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'num_levels', 6)
set_generic_sha...",89,101,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
gen_image_to_world_plane_map (Map, CamParam, Pose, 646, 482, 596, 448, PixelDist, 'bilinear')
* --- End of Au..."
a684a733,micro,12,"to the outer boundary of the object. To visualize the model in
the original image, we first need to ...","get_generic_shape_model_object (ModelContours, ModelID, 'contours')
vector_angle_to_rigid (0, 0, 0, RowRef, ColumnRef, 0, HomMat2D)
affine_trans_contour_xld (ModelContours, ModelContoursTrans, HomMat2D)
disp_projected_model_and_arrow (ModelContoursTrans, WindowHandle, PixelDist, HomMat3D, CamParam, ...",102,110,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
PixelDist := 0.0002
pose_to_hom_mat3d (Pose,..."
a684a733,micro,13,"Up to three objects will be visible in the images. Note that
these objects are not exactly identical...","disp_message (WindowHandle, ['Press left button to start', 'and stop the demo'], 'image', 50, 20, 'yellow', 'false')
get_mbutton (WindowHandle, Row1, Column1, Button1)
wait_seconds (0.5)
dev_set_color ('red')
Button := 0
ImgNo := 1
while (Button != 1)
read_image (Image, 'radius-gauges/radius-gauges-...",111,186,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
for I := 1 to NumImages by 1
read_image (Image, 'radius-gauges/calib-' + I$'02d')
get_calib_data_observ_po..."
a684a733,micro,14,"because the model contains a hole, and hence consists of
multiple contours. This allows us to visual...","select_shape_xld (ModelContours, ModelContoursSelected, 'contlength', 'and', 200, 1000)",191,195,"* --- Automatically Added Context ---
get_generic_shape_model_object (ModelContours, ModelID, 'contours')
* --- End of Automatically Added Context ---"
a684a733,micro,15,the coordinates of the model points.,"get_contour_xld (ModelContoursSelected, Ys, Xs)",196,198,"* --- Automatically Added Context ---
select_shape_xld (ModelContours, ModelContoursSelected, 'contlength', 'and', 200, 1000)
* --- End of Automatically Added Context ---"
a684a733,micro,16,"to 0.2mm increments. Since the projection operator expects
coordinates in meters, multiply them by t...","X := Xs * PixelDist
Y := Ys * PixelDist
Z := gen_tuple_const(|X|,0.0)",199,204,"* --- Automatically Added Context ---
PixelDist := 0.0002
get_contour_xld (ModelContoursSelected, Ys, Xs)
* --- End of Automatically Added Context ---"
a684a733,micro,17,,"affine_trans_point_3d (HomMat3D, X, Y, Z, Xc, Yc, Zc)",205,206,"* --- Automatically Added Context ---
PixelDist := 0.0002
pose_to_hom_mat3d (Pose, HomMat3D)
get_contour_xld (ModelContoursSelected, Ys, Xs)
X := Xs * PixelDist
Y := Ys * PixelDist
Z := gen_tuple_cons..."
a684a733,micro,18,to the image plane.,"project_3d_point (Xc, Yc, Zc, CamParam, R, C)",207,209,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_mposition (WindowHandle, R, C, Button)
affine_trans_point_3d (HomMat3D, X, Y, Z, Xc, Yc, Zc)
* -..."
a684a733,micro,19,,"gen_contour_polygon_xld (ModelWorld, R, C)
dev_set_color ('green')
dev_display (ModelWorld)",210,213,"* --- Automatically Added Context ---
get_mposition (WindowHandle, R, C, Button)
* --- End of Automatically Added Context ---"
a684a733,micro,20,"The arrow is exactly 10mm long and oriented horizontally in
the world coordinate system. As with the...","X := [Column * PixelDist,Column * PixelDist + cos(Angle) / 100]
Y := [Row * PixelDist,Row * PixelDist - sin(Angle) / 100]
Z := gen_tuple_const(|X|,0.0)
affine_trans_point_3d (HomMat3D, X, Y, Z, Xc, Yc, Zc)
project_3d_point (Xc, Yc, Zc, CamParam, R, C)
dev_set_color ('orange')
disp_arrow (WindowHandl...",214,241,"* --- Automatically Added Context ---
dev_open_window (0, 0, 646, 482, 'black', WindowHandle)
get_calib_data_observ_points (CalibDataID, 0, 0, I, Row, Column, Index, Pose)
get_calib_data (CalibDataID,..."
ea4ba4c2,full,0,"This program demonstrates how to estimate the center of a rotation
between two succeeding images wit...","ImageFilenames := 'pcb_rotation/pcb_rotated_'
BorderSize := 5
GridWidth := 10
NumImages := 10
Threshold := 50
Step := 1
CenterRows := []
CenterColumns := []
dev_update_off ()
dev_close_window ()
read_image (Image1, ImageFilenames + '01')
get_image_size (Image1, Width, Height)
dev_open_window_fit_ima...",15,102,
ea4ba4c2,micro,1,,"ImageFilenames := 'pcb_rotation/pcb_rotated_'
BorderSize := 5
GridWidth := 10
NumImages := 10
Threshold := 50
Step := 1
CenterRows := []
CenterColumns := []",14,23,
ea4ba4c2,micro,2,,"dev_update_off ()
dev_close_window ()
read_image (Image1, ImageFilenames + '01')
get_image_size (Image1, Width, Height)
dev_open_window_fit_image (Image1, 0, 0, Width, Height, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image1)
gen_r...",24,34,"* --- Automatically Added Context ---
ImageFilenames := 'pcb_rotation/pcb_rotated_'
BorderSize := 5
* --- End of Automatically Added Context ---"
ea4ba4c2,micro,3,,"for Index := 1 + Step to NumImages by Step
read_image (Image2, ImageFilenames + Index$'02')
optical_flow_mg (Image1, Image2, VectorField, 'fdrig', 0.8, 1, 20, 5, 'default_parameters', 'fast_accurate')
sobel_amp (Image1, EdgeAmplitude1, 'sum_abs', 3)
threshold (EdgeAmplitude1, Region1, Threshold, 255...",35,89,"* --- Automatically Added Context ---
ImageFilenames := 'pcb_rotation/pcb_rotated_'
GridWidth := 10
NumImages := 10
Threshold := 50
Step := 1
CenterRows := []
CenterColumns := []
read_image (Image1, I..."
ea4ba4c2,micro,4,,"dev_display (Image2)
dev_set_color ('blue')
dev_display (VectorFieldReduced)
gen_cross_contour_xld (Cross, CenterRows, CenterColumns, 25, Alpha)
disp_message (WindowHandle, 'Rotation centers and mean', 'window', 12, 12, 'black', 'true')
dev_set_colored (12)
dev_display (Cross)
gen_circle (Center, me...",90,108,"* --- Automatically Added Context ---
CenterRows := []
CenterColumns := []
dev_open_window_fit_image (Image1, 0, 0, Width, Height, WindowHandle)
read_image (Image2, ImageFilenames + Index$'02')
reduce..."
cea5dfea,full,0,Traffic monitoring by comparing two successive images,"Thresh := 35
dev_update_window ('off')
dev_update_pc ('off')
dev_update_var ('off')
dev_close_window ()
read_image (Img_n_1, 'xing/init')
get_image_size (Img_n_1, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (...",7,31,
cea5dfea,micro,1,,"Thresh := 35
dev_update_window ('off')
dev_update_pc ('off')
dev_update_var ('off')
dev_close_window ()
read_image (Img_n_1, 'xing/init')
get_image_size (Img_n_1, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (...",6,37,
81685228,full,0,"This example program shows how to use HALCON's 3D-Matching
to find the 3D pose of clamps that exhibi...","ReCreateShapeModel3D := false
* ReCreateShapeModel3D := true
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
dev_close_window ()
dev_open_windo...",16,1673,
81685228,micro,1,"to find the 3D pose of clamps that exhibit a 6 degree of freedom
motion.
If the 3D shape model shoul...","ReCreateShapeModel3D := false
* ReCreateShapeModel3D := true",6,18,
81685228,micro,2,,"gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_fo...",19,28,
81685228,micro,3,,"read_object_model_3d ('clamp_sloped', 'mm', [], [], ObjectModel3DID, DxfStatus)",29,30,
81685228,micro,4,,"prepare_object_model_3d (ObjectModel3DID, 'shape_based_matching_3d', 'true', [], [])",31,33,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', [], [], ObjectModel3DID, DxfStatus)
* --- End of Automatically Added Context ---"
81685228,micro,5,,"gen_empty_obj (Images)
for Index := 1 to 3 by 1
read_image (Image, 'clamp_sloped/clamp_sloped_' + Index$'02')
concat_obj (Images, Image, Images)
endfor",34,40,
81685228,micro,6,in which the 3D shape model is to be created,"inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, LongitudeMax, LatitudeMin, LatitudeMax, CamRollMin, CamRollMax, DistMin, DistMax, MinFaceAngle)
dev_clear_window ()
if (ReCreateShapeModel3D)
Message := 'Creating the 3D shape model (may take several...",41,76,"* --- Automatically Added Context ---
ReCreateShapeModel3D := false
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
dev_open_window (0, 0, Width,..."
81685228,micro,7,,"for ImageNo := 1 to 35 by 1
read_image (Image, 'clamp_sloped/clamp_sloped_' + ImageNo$'02')
dev_display (Image)
count_seconds (Seconds1)
find_shape_model_3d (Image, ShapeModel3DID, 0.7, 0.9, 5, ['num_matches', 'pose_refinement'], [2, 'least_squares_very_high'], Pose, CovPose, Score)
count_seconds (S...",77,132,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_height', Height)
dev_ope..."
81685228,micro,8,,"if (TopBottom != 'top' and TopBottom != 'bottom')
stop ()
endif
get_part (WindowHandle, PartRow1, PartCol1, PartRow2, PartCol2)
Height := PartRow2 - PartRow1 + 1
Width := PartCol2 - PartCol1 + 1
MenuHeight := Height * PercentageHeight / 100.0
MenuWidth := Width
ButtonHeight := MenuHeight / NumRows
B...",133,292,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)..."
81685228,micro,9,,"get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
get_object_model_3d_params (ObjectModel3DID, 'reference_point', ReferencePoint)",293,296,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', [], [], ObjectModel3DID, DxfStatus)
* --- End of Automatically Added Context ---"
81685228,micro,10,,"P1 := [BoundingBox[0],BoundingBox[1],BoundingBox[2]]
P2 := [BoundingBox[3],BoundingBox[1],BoundingBox[2]]
P3 := [BoundingBox[0],BoundingBox[4],BoundingBox[2]]
P4 := [BoundingBox[0],BoundingBox[1],BoundingBox[5]]
P5 := [BoundingBox[3],BoundingBox[4],BoundingBox[2]]
P6 := [BoundingBox[3],BoundingBox[1...",297,306,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
* --- End of Automatically Added Context ---"
81685228,micro,11,the bounding box,"D := sum((P1 - ReferencePoint) * (P1 - ReferencePoint))
D := max([D,sum((P2 - ReferencePoint) * (P2 - ReferencePoint))])
D := max([D,sum((P3 - ReferencePoint) * (P3 - ReferencePoint))])
D := max([D,sum((P4 - ReferencePoint) * (P4 - ReferencePoint))])
D := max([D,sum((P5 - ReferencePoint) * (P5 - Ref...",307,317,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3DID, 'reference_point', ReferencePoint)
get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
P1 := [..."
81685228,micro,12,image part.,"get_cam_par_data (CamParam, 'sx', Sx)
get_cam_par_data (CamParam, 'sy', Sy)
get_cam_par_data (CamParam, 'focus', Focus)
MaxProjectionRadius := 0.5 * ImageCoverage * MinImageSize * min([Sx,Sy])
Aperture := atan2(MaxProjectionRadius,Focus)
Dist := sqrt(D) / sin(Aperture)
return ()
OffsetRowOut := Offs...",318,635,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_p..."
81685228,micro,13,,"count_obj (MenuRegions, NumberRegions)
NumberTexts := |Texts|
if (NumberRegions != NumberTexts)
stop ()
endif
for i := 1 to NumberRegions by 1
select_obj (MenuRegions, MenuRegion, i)
Text := Texts[i - 1]
set_color (WindowHandle, 'light gray')
dev_set_window (WindowHandle)
dev_set_draw ('fill')
dev_s...",636,692,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_empty_obj (MenuRegions)
count_obj (MenuRegions, NumberRegions)
NumberTexts := |Texts|
select_obj ..."
81685228,micro,14,,"project_point_on_trackball (MX1, MY1, VirtualTrackball, TrackballSize, P1)
project_point_on_trackball (MX2, MY2, VirtualTrackball, TrackballSize, P2)",693,695,"* --- Automatically Added Context ---
if (VirtualTrackball == 'shoemake')
if (R &lt;= TrackballSize)
test_region_point (MenuRegion, Row, Col, IsInside)
get_object_model_3d_params (ObjectModel3DID, 'bo..."
81685228,micro,15,,"tuple_vector_cross_product (P1, P2, RotAxis)",696,697,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
P1 := [BoundingBox[0],BoundingBox[1],BoundingBox[2]]
P2 := [BoundingBox[3],BoundingBox[..."
81685228,micro,16,,"D := P2 - P1
T := sqrt(sum(D * D)) / (2.0 * TrackballSize)
if (T &gt; 1.0)
T := 1.0
endif
if (T &lt; -1.0)
T := -1.0
endif
RotAngle := 2.0 * asin(T)
Len := sqrt(sum(RotAxis * RotAxis))
if (Len &gt; 0.)
LenInv := 1. / Len
RotAxis := RotAxis * LenInv
endif
axis_angle_to_quat (RotAxis[0], RotAxis[1], R...",698,744,"* --- Automatically Added Context ---
if (R &lt;= TrackballSize)
get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
get_object_model_3d_params (ObjectModel3DID, 'reference_poin..."
81685228,micro,17,,"Length := 7
Angle := 40
MinArrowLength := 2
DRow := Row2 - Row1
DCol := Column2 - Column1
ArrowLength := sqrt(DRow * DRow + DCol * DCol)
if (ArrowLength &lt; MinArrowLength)
Length := 0
endif
tuple_atan2 (DRow, -DCol, Phi)
P1R := Row2 - Length * sin(Phi - rad(Angle))
P1C := Column2 + Length * cos(Ph...",745,804,"* --- Automatically Added Context ---
test_region_point (MenuRegion, Row, Col, IsInside)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
DRow := MRow2 - MRow1
MRow1 := Row
MRow2 := Row..."
81685228,micro,18,,"CoordAxesLength := 50
get_window_extents (WindowHandle, Row, Column, Width, Height)
gen_image_const (Image1, 'byte', Width, Height)
gen_image_const (Image2, 'byte', Width, Height)
gen_image_const (Image3, 'byte', Width, Height)
MinImageSize := min([Width,Height])
Cx := MinImageSize / 2
Cy := MinImag...",805,821,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
81685228,micro,19,,"gen_contour_polygon_xld (CirclesLon, [SpherePos - SphereRadius,SpherePos + SphereRadius], [SpherePos,SpherePos])
for Lon := 30 to 90 by 30
gen_ellipse_contour_xld (CircleLon, SpherePos, SpherePos, 0, SphereRadius * sin(rad(Lon)), SphereRadius, 0, 6.28318, 'positive', 1.5)
concat_obj (CirclesLon, Cir...",822,833,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
SphereRadius := MinImageSize * 0.8 / 2
SpherePos := MinImage..."
81685228,micro,20,,"quat_to_hom_mat3d (RelQuaternion, RelHomMat)
hom_mat3d_to_pose (RelHomMat, RelPose)
RelPose[2] := Dist
pose_to_hom_mat3d (RelPose, RelHomMat)
hom_mat3d_invert (RelHomMat, RelHomMatInv)
affine_trans_point_3d (RelHomMatInv, 0, 0, 0, X, Y, Z)
CamPos := [X,Y,Z]
affine_trans_point_3d (RelHomMatInv, 1., 0...",834,847,"* --- Automatically Added Context ---
get_object_model_3d_params (ObjectModel3DID, 'reference_point', ReferencePoint)
get_object_model_3d_params (ObjectModel3DID, 'bounding_box1', BoundingBox)
P1 := [..."
81685228,micro,21,,"ScaleFactor := SphereRadius / sqrt(sum(CamPos * CamPos))
CamPosProj := ScaleFactor * CamPos
CamXAxProj := ScaleFactor * CamXAx
CamYAxProj := ScaleFactor * CamYAx
CamZAxProj := ScaleFactor * CamZAx",848,853,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
SphereRadius := MinImageSize * 0.8 / 2
MinImageSize := min([..."
81685228,micro,22,,"Vec := CamXAxProj - CamPosProj
ScaleFactor := CoordAxesLength / sqrt(sum(Vec * Vec))
CamXAxProj := CamPosProj + ScaleFactor * (CamXAxProj - CamPosProj)
CamYAxProj := CamPosProj + ScaleFactor * (CamYAxProj - CamPosProj)
CamZAxProj := CamPosProj + ScaleFactor * (CamZAxProj - CamPosProj)
CamRow := Sphe...",854,871,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
CoordAxesLength := 50
SpherePos := MinImageSize / 2
MinImage..."
81685228,micro,23,,"convert_point_3d_cart_to_spher (CamPos[0], CamPos[1], CamPos[2], '-y', '-z', CamLon, CamLat, Radius)
CamRoll := -RelPose[5]
while (CamRoll &gt; 180.0)
CamRoll := CamRoll - 360.0
endwhile
while (CamRoll &lt; -180.0)
CamRoll := CamRoll + 360.0
endwhile
CamRoll := CamRoll * 3.1416 / 180.",872,882,"* --- Automatically Added Context ---
hom_mat3d_to_pose (RelHomMat, RelPose)
CamPos := [X,Y,Z]
affine_trans_point_3d (RelHomMatInv, 0, 0, 0, X, Y, Z)
* --- End of Automatically Added Context ---"
81685228,micro,24,,"gen_contour_polygon_xld (LineLong, [SpherePos,SpherePos], [SpherePos,SpherePos + SphereRadius * sin(CamLon)])
XRangeCamPos := []
YRangeCamPos := []
StepLat := rad(1)
if (CamLat &gt; 0)
StepLat := rad(1)
else
StepLat := -rad(1)
endif
for Lat := 0 to CamLat by StepLat
convert_point_3d_spher_to_cart (C...",883,899,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
SphereRadius := MinImageSize * 0.8 / 2
SpherePos := MinImage..."
81685228,micro,25,,"determine_optimum_viewing_distance (ObjectModel3DID, CamParamSmall, MinImageSize, 0.7, ViewingDist)
RefPose[2] := RefPose[2] + ViewingDist
project_object_model_3d (ModelContours, ObjectModel3DID, CamParamSmall, RefPose, HiddenSurfaceRemoval, MinFaceAngle)
gen_cross_contour_xld (ReferencePointCross, ...",900,905,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', [], [], ObjectModel3DID, DxfStatus)
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefR..."
81685228,micro,26,,"LongitudeMinDisp := max([LongitudeMin,-rad(90)])
LongitudeMaxDisp := min([LongitudeMax,rad(90)])
LatitudeMinDisp := max([LatitudeMin,-rad(90)])
LatitudeMaxDisp := min([LatitudeMax,rad(90)])",906,911,"* --- Automatically Added Context ---
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, LongitudeMax, LatitudeMin, LatitudeMax, CamRollMin, CamRollMa..."
81685228,micro,27,,"XRangeLatMin := []
YRangeLatMin := []
XRangeLatMax := []
YRangeLatMax := []
for Long := LongitudeMinDisp to LongitudeMaxDisp by rad(1)
convert_point_3d_spher_to_cart (Long, LatitudeMinDisp, SphereRadius, '-y', '-z', X, Y, Z)
XRangeLatMin := [XRangeLatMin,X]
YRangeLatMin := [YRangeLatMin,Y]
convert_p...",912,925,"* --- Automatically Added Context ---
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, LongitudeMax, LatitudeMin, LatitudeMax, CamRollMin, CamRollMa..."
81685228,micro,28,,"XRangeLongMin := []
YRangeLongMin := []
XRangeLongMax := []
YRangeLongMax := []
for Lat := LatitudeMinDisp to LatitudeMaxDisp by rad(1)
convert_point_3d_spher_to_cart (LongitudeMinDisp, Lat, SphereRadius, '-y', '-z', X, Y, Z)
XRangeLongMin := [XRangeLongMin,X]
YRangeLongMin := [YRangeLongMin,Y]
conv...",926,942,"* --- Automatically Added Context ---
read_image (Image, 'clamp_sloped/clamp_sloped_' + Index$'02')
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin,..."
81685228,micro,29,,"dev_set_window (WindowHandle)
dev_display (Image)
dev_set_color ('blue')
dev_display (CirclesLon)
dev_display (CirclesLat)
dev_set_color (ModelColor)
dev_display (ModelContours)
dev_set_color ('light gray')
dev_display (ReferencePointCross)
dev_set_color ('magenta')
dev_display (ContPoseRange)
if (C...",943,974,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (Image, 'clamp_sloped/clamp_sloped_' + Index$'02')
project_shape_model_3d (ModelContours, ..."
81685228,micro,30,Compute the format string in dependence of the distance magnitude,"MaxDist := max([Dist,DistMin,DistMax])
if (MaxDist &gt; 0)
Precision := max([0,4 - int(log10(MaxDist))])
Precision := min([Precision,4])
else
Precision := 4
endif
DistFormat := '6.' + Precision + 'f'
dev_set_color ('white')
set_tposition (WindowHandle, MinImageSize, 30)
write_string (WindowHandle, '...",975,1081,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, ..."
81685228,micro,31,,"LongitudeMinOut := LongitudeMinIn
LongitudeMaxOut := LongitudeMaxIn
LatitudeMinOut := LatitudeMinIn
LatitudeMaxOut := LatitudeMaxIn
CamRollMinOut := CamRollMinIn
CamRollMaxOut := CamRollMaxIn
DistMinOut := DistMinIn
DistMaxOut := DistMaxIn
MinFaceAngleOut := MinFaceAngleIn
RefPoseOut := RefPoseIn
Re...",1082,1097,"* --- Automatically Added Context ---
quat_compose (DeltaQuatRotation, RelQuaternionIn, RelQuaternionIn)
RelQuaternionOut := RelQuaternionIn
* --- End of Automatically Added Context ---"
81685228,micro,32,,"if (SelectedButton == 'Set Reference Pose')
pose_to_hom_mat3d (RefPoseOut, RefHomMat)
quat_to_hom_mat3d (RelQuaternionOut, RelHomMat)
hom_mat3d_compose (RelHomMat, RefHomMat, AbsHomMat)
hom_mat3d_to_pose (AbsHomMat, RefPoseOut)
RelQuaternionOut := [1, 0, 0, 0]
endif
if (SelectedButton == 'Add to Pos...",1098,1246,"* --- Automatically Added Context ---
read_image (Image, 'clamp_sloped/clamp_sloped_' + Index$'02')
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin,..."
81685228,micro,33,,"VC := V1[1] * V2[2] - V1[2] * V2[1]
VC := [VC,V1[2] * V2[0] - V1[0] * V2[2]]
VC := [VC,V1[0] * V2[1] - V1[1] * V2[0]]
return ()",1247,1289,
81685228,micro,34,to the smaller image dimension.,TrackballSize := 0.8,1369,1372,"* --- Automatically Added Context ---
if (R &lt;= TrackballSize)
* --- End of Automatically Added Context ---"
81685228,micro,35,"- 'always': always displays the trackball
- 'never': never displays the trackball
- 'on_button': dis...","VisualizeTrackball := 'always'
* VisualizeTrackball := 'never'
* VisualizeTrackball := 'on_button'",1374,1381,"* --- Automatically Added Context ---
if (VisualizeTrackball == 'always')
* --- End of Automatically Added Context ---"
81685228,micro,36,shall be used ('shoemake' or 'bell').,"VirtualTrackball := 'shoemake'
* VirtualTrackball := 'bell'",1382,1386,"* --- Automatically Added Context ---
if (VirtualTrackball == 'shoemake')
* --- End of Automatically Added Context ---"
81685228,micro,37,,ModelColor := 'green',1387,1389,"* --- Automatically Added Context ---
set_color (WindowHandleBuffer, ModelColor)
* --- End of Automatically Added Context ---"
81685228,micro,38,"if the original camera image is too large to fit onto the screen. If ImageScale is
set to 1, the ima...","ImageScale := 1.0
dev_set_preferences ('graphics_window_context_menu', 'false')
get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_update_time ('off')
Deg2Rad := 0.017453292",1390,1406,
81685228,micro,39,camera type,"get_cam_par_data (CamParam, 'camera_type', CameraType)
if (CameraType =~ 'telecentric' or CameraType =~ 'line_scan')
throw ('The camera type ' + CameraType + ' is not supported for shape-based 3D matching')
endif",1407,1413,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
* --- End of Automatically Added Context ---"
81685228,micro,40,,"get_cam_par_data (CamParam, 'sx', Sx)
get_cam_par_data (CamParam, 'sy', Sy)
get_cam_par_data (CamParam, 'cx', Cx)
get_cam_par_data (CamParam, 'cy', Cy)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
set_cam_par_data (CamParam, 'sx', Sx / ImageSc...",1414,1428,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_p..."
81685228,micro,41,,"zoom_image_factor (BackgroundImages, BackgroundImages, ImageScale, ImageScale, 'weighted')
get_cam_par_data (CamParam, 'cx', Cx)
get_cam_par_data (CamParam, 'cy', Cy)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_par_data (CamParam, 'image_height', Height)
WidthPose := 300
HeightPose := ...",1429,1439,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
ImageScale := 1.0
get_cam_par_data (CamParam, 'image_width'..."
81685228,micro,42,,"WidthMenu := max([Width + 7 + WidthPose,840])
HeightMenu := 100
dev_open_window (-50, 0, WidthMenu, HeightMenu, 'black', WindowHandleMenu)
dev_set_part (0, 0, HeightMenu - 1, WidthMenu - 1)",1440,1445,"* --- Automatically Added Context ---
get_selected_button (MenuRegions, MenuText, WindowHandleMenu, Row, Col, SelectedButton)
get_cam_par_data (CamParam, 'image_width', Width)
WidthPose := 300
* --- E..."
81685228,micro,43,,"dev_open_window (102, Width + 7, WidthPose, HeightPose, 'black', WindowHandlePose)
dev_set_part (0, 0, HeightPose - 1, WidthPose - 1)
dev_set_line_width (1)",1446,1450,"* --- Automatically Added Context ---
get_cam_par_data (CamParam, 'image_width', Width)
WidthPose := 300
HeightPose := max([Height,480])
get_cam_par_data (CamParam, 'image_height', Height)
* --- End o..."
81685228,micro,44,,"dev_open_window (102, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_set_line_width (1)
open_window (115, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
set_line_width (WindowHandleBuffer, 1)",1451,1458,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_color (WindowHandleBuffer, ModelColor)
get_cam_par_data (CamParam, 'image_width', Width)
get_cam_..."
81685228,micro,45,,"MinImageSize := min([Width,Height])
TrackballRadiusPixel := TrackballSize * MinImageSize / 2.0
gen_ellipse_contour_xld (TrackballContour, Cy, Cx, 0, TrackballRadiusPixel, TrackballRadiusPixel, 0, 6.28318, 'positive', 1.5)",1459,1463,"* --- Automatically Added Context ---
if (R &lt;= TrackballSize)
disp_xld (TrackballContour, WindowHandleBuffer)
MinImageSize := min([Width,Height])
get_cam_par_data (CamParam, 'image_width', Width)
g..."
81685228,micro,46,"coordinate system, the position is at the center of gravity of the model.","get_object_model_3d_params (ObjectModel3DID, 'reference_point', ReferencePoint)
create_pose (-ReferencePoint[0], -ReferencePoint[1], -ReferencePoint[2], 0, 0, 0, 'Rp+T', 'gba', 'point', RefPose)",1464,1468,"* --- Automatically Added Context ---
read_object_model_3d ('clamp_sloped', 'mm', [], [], ObjectModel3DID, DxfStatus)
if (R &lt;= TrackballSize)
get_object_model_3d_params (ObjectModel3DID, 'reference..."
81685228,micro,47,,RefPoseReset := RefPose,1469,1471,"* --- Automatically Added Context ---
pose_to_hom_mat3d (RefPose, RefHomMat)
* --- End of Automatically Added Context ---"
81685228,micro,48,,"determine_optimum_viewing_distance (ObjectModel3DID, CamParam, MinImageSize, 0.8, Dist)
CamPose := replace(RefPose,2,RefPose[2] + Dist)
project_object_model_3d (ModelContours, ObjectModel3DID, CamParam, CamPose, 'true', rad(10))
FontSize := 12
set_display_font (WindowHandle, FontSize, 'mono', 'true'...",1472,1486,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
81685228,micro,49,,"dev_error_var (ErrorVar, 1)
RelQuaternion := [1, 0, 0, 0]
NumAdd := 0
count_obj (BackgroundImages, NumImage)
ImageNo := 0
HiddenSurfaceRemoval := 'true'
MouseMode := 'move_camera'
OffsetRow := gen_tuple_const(NumImage,0)
OffsetCol := gen_tuple_const(NumImage,0)",1487,1497,"* --- Automatically Added Context ---
for ImageNo := 1 to 35 by 1
dev_error_var (ErrorVar, 1)
project_object_model_3d (ModelContours, ObjectModel3DID, CamParam, AbsPose, HiddenSurfaceRemoval, MinFaceA..."
81685228,micro,50,,"LongitudeMin := 0
LongitudeMax := 0
LatitudeMin := 0
LatitudeMax := 0
CamRollMin := 0
CamRollMax := 0
DistMin := Dist
DistMax := Dist
RefRotX := 0
RefRotY := 0
RefRotZ := 0
MinFaceAngle := rad(30)",1498,1511,"* --- Automatically Added Context ---
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, LongitudeMax, LatitudeMin, LatitudeMax, CamRollMin, CamRollMa..."
81685228,micro,51,,"hom_mat2d_identity (HomMat2DIdentity)
while (1)
pose_to_hom_mat3d (RefPose, RefHomMat)
quat_to_hom_mat3d (RelQuaternion, RelHomMat)
hom_mat3d_compose (RelHomMat, RefHomMat, AbsHomMat)
hom_mat3d_to_pose (AbsHomMat, AbsPose)
AbsPose[2] := AbsPose[2] + Dist
project_object_model_3d (ModelContours, Objec...",1512,1599,"* --- Automatically Added Context ---
* WARNING: Context truncated at 50 lines
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
dev_open_window (0..."
81685228,micro,52,,"RefRotX := RefPose[3] * Deg2Rad
RefRotY := RefPose[4] * Deg2Rad
RefRotZ := RefPose[5] * Deg2Rad",1600,1604,"* --- Automatically Added Context ---
inspect_object_model_3d (Images, ObjectModel3DID, CamParam, RefRotX, RefRotY, RefRotZ, LongitudeMin, LongitudeMax, LatitudeMin, LatitudeMax, CamRollMin, CamRollMa..."
81685228,micro,53,,"set_system ('clip_region', ClipRegion)
close_window (WindowHandleBuffer)
dev_set_preferences ('graphics_window_context_menu', 'true')
dev_set_window (WindowHandleMenu)
dev_close_window ()
dev_set_window (WindowHandlePose)
dev_close_window ()
dev_set_window (WindowHandle)
dev_close_window ()
return (...",1605,1652,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
81685228,micro,54,,"pose_to_hom_mat3d (Pose, HomMat3D)
affine_trans_point_3d (HomMat3D, ReferencePoint[0], ReferencePoint[1], ReferencePoint[2], X, Y, Z)
project_3d_point (X, Y, Z, CamParam, Row, Column)",1653,1657,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01221, -2791, 7.3958e-6, 7.4e-6, 308.21, 245.92, 640, 480, CamParam)
find_shape_model_3d (Image, ShapeModel3DID, 0.7, 0.9, 5, ['..."
81685228,micro,55,,"set_tposition (WindowHandle, Row, Column - 10)
write_string (WindowHandle, 'Pose:')
set_tposition (WindowHandle, Row + 15, Column)
write_string (WindowHandle, 'X: ' + (1000 * Pose[0])$'4.1f' + ' mm')
set_tposition (WindowHandle, Row + 30, Column)
write_string (WindowHandle, 'Y: ' + (1000 * Pose[1])$...",1658,1687,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
find_shape_model_3d (Image, ShapeModel3DID, 0.7, 0.9, 5, ['num_matches', 'pose_refinement'], [2, 'lea..."
fbeb3887,full,0,"This example program shows how to use the operator get_circle_pose.
First, the contours of the drill...","dev_update_off ()
read_image (Image, 'rim')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_line_width (3)
p_determine_ellipse_contours (Image, EllipseC...",12,204,
fbeb3887,micro,1,,"dev_update_off ()
read_image (Image, 'rim')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_line_width (3)",11,19,
fbeb3887,micro,2,,"p_determine_ellipse_contours (Image, EllipseContoursLarge, EllipseContoursSmall, false, NumberLarge, NumberSmall)
concat_obj (EllipseContoursLarge, EllipseContoursSmall, EllipseContours)",20,23,"* --- Automatically Added Context ---
read_image (Image, 'rim')
* --- End of Automatically Added Context ---"
fbeb3887,micro,3,(result from a camera calibration),"RadiusLarge := 10.25 / 1000.0
RadiusSmall := 5.91 / 1000.0
gen_cam_par_area_scan_division (0.0122, -261.04, 7.39e-6, 7.4e-6, 303.12, 234.17, 652, 494, CamParam)",24,29,
fbeb3887,micro,4,"and orientation of the circles. Note that in this case the
operator get_circle_pose is called two ti...","get_circle_pose (EllipseContours, CamParam, [gen_tuple_const(NumberLarge,RadiusLarge),gen_tuple_const(NumberSmall,RadiusSmall)], 'pose', Pose1, Pose2)
get_circle_pose (EllipseContours, CamParam, [gen_tuple_const(NumberLarge,RadiusLarge),gen_tuple_const(NumberSmall,RadiusSmall)], 'center_normal', Cen...",30,43,"* --- Automatically Added Context ---
p_determine_ellipse_contours (Image, EllipseContoursLarge, EllipseContoursSmall, false, NumberLarge, NumberSmall)
concat_obj (EllipseContoursLarge, EllipseContour..."
fbeb3887,micro,5,,"dev_display (Image)
dev_set_colored (12)
dev_display (EllipseContours)
for i := 0 to NumberLarge + NumberSmall - 1 by 1
pose_to_hom_mat3d (ClusterP1[i * 7:i * 7 + 6], HomMat3D)
affine_trans_point_3d (HomMat3D, 0, 0, 0, Qx, Qy, Qz)
project_3d_point (Qx, Qy, Qz, CamParam, Row, Column)
Row := Row - 95
...",44,218,"* --- Automatically Added Context ---
read_image (Image, 'rim')
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
p_determine_ellipse_contours (Image, EllipseContoursLarge, EllipseC..."
d1a467f5,full,0,"This program demonstrates how to use get_rectangle_pose to
estimate the pose of rectangular objects ...","Width := 800
Height := 800
RectWidth := 0.095
RectHeight := 0.035
get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
set_system ('clip_region', 'false')
set_system ('store_empty_region', 'true')
set_system ...",16,218,
d1a467f5,micro,1,"estimate the pose of rectangular objects in space. After the pose
of a work sheet is estimated, it i...","Width := 800
Height := 800
RectWidth := 0.095
RectHeight := 0.035",6,21,
d1a467f5,micro,2,,"get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
set_system ('clip_region', 'false')
set_system ('store_empty_region', 'true')
set_system ('empty_region_result', 'true')
dev_close_window ()
dev_open_windo...",22,37,"* --- Automatically Added Context ---
Width := 800
Height := 800
* --- End of Automatically Added Context ---"
d1a467f5,micro,3,,"CaltabName := 'caltab_30mm.descr'
Dir := 'metal-parts'
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)
dev_set_colored (12)
dev_set_line_width (1)
gen_rectangle1 (ImageBorder, 2, 2, Height - 2, Width - 2)
complement (ImageBorder, Ima...",38,72,"* --- Automatically Added Context ---
Width := 800
Height := 800
RectWidth := 0.095
RectHeight := 0.035
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
* --- End of Automatically ..."
d1a467f5,micro,4,,"set_system ('clip_region', ClipRegion)
set_system ('store_empty_region', StoreEmptyRegion)
set_system ('empty_region_result', EmptyRegionResult)
dev_set_check ('~give_error')
dev_error_var (ErrorVar, 1)
PoseOut := []",73,103,"* --- Automatically Added Context ---
get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
* --- End of Auto..."
d1a467f5,micro,5,,"dilation_rectangle1 (RectangularRegions, RectDilated, 9, 9)
erosion_rectangle1 (RectangularRegions, RectEroded, 9, 9)
difference (RectDilated, RectEroded, RectBorders)
select_shape (RectBorders, RectBorders, 'area', 'and', 600, 99999)
count_obj (RectBorders, Number)
for I := 1 to Number by 1
select_...",104,192,"* --- Automatically Added Context ---
RectWidth := 0.095
RectHeight := 0.035
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)
for I :=..."
d1a467f5,micro,6,,"dev_set_line_width (3)
pose_to_hom_mat3d (Pose, HomMat3D)
hW := RectWidth / 2
hH := RectHeight / 2
Ofst := 0.005
XCoord := [hW,hW - Ofst,-hW + Ofst,-hW,-hW,-hW + Ofst,hW - Ofst,hW,hW]
XCoord := [XCoord,XCoord]
YCoord := [hH - Ofst,hH,hH,hH - Ofst,-hH + Ofst,-hH,-hH,-hH + Ofst,hH - Ofst]
YCoord := [Y...",193,229,"* --- Automatically Added Context ---
RectWidth := 0.095
RectHeight := 0.035
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)
area_cen..."
a42e74b9,full,0,"This program demonstrates how to determine the pose of an
object having a rectangular shaped surface...","dev_update_off ()
dev_close_window ()
read_image (Image, 'square_tube/square_tube_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_lut ('cubic_root')
gen_cam_par_area_scan_division (0.0168781, -758.977, 5.20077e-0...",17,243,
a42e74b9,micro,1,"object having a rectangular shaped surface.
First, the contour of the rectangular shaped surface is
...","dev_update_off ()
dev_close_window ()
read_image (Image, 'square_tube/square_tube_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_lut ('cubic_root')",6,23,
a42e74b9,micro,2,,"gen_cam_par_area_scan_division (0.0168781, -758.977, 5.20077e-006, 5.2e-006, 645.492, 545.222, 1280, 1024, CamParam)
RectWidth := 0.024
RectHeight := RectWidth",24,28,
a42e74b9,micro,3,operator get_rectangle_pose,"NumImages := 5
for Index := 1 to NumImages by 1
PoseOut := []
read_image (Image, 'square_tube/square_tube_' + Index$'02')
extract_rectangle_contour (Image, ClosedContours)
get_rectangle_pose (ClosedContours, CamParam, 0.024, 0.024, 'tukey', 2, Pose, CovPose, Error)
pose_to_hom_mat3d (Pose, HomMat3D)...",29,70,"* --- Automatically Added Context ---
read_image (Image, 'square_tube/square_tube_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0168781, -758.977..."
a42e74b9,micro,4,operator vector_to_pose,"hW := RectWidth * 0.5
for Index := 1 to NumImages by 1
PoseOut := []
read_image (Image, 'square_tube/square_tube_' + Index$'02')
extract_rectangle_contour (Image, ClosedContours)
segment_contours_xld (ClosedContours, ContoursSplit, 'lines', 10, 10, 2)
union_collinear_contours_xld (ContoursSplit, Uni...",71,171,"* --- Automatically Added Context ---
read_image (Image, 'square_tube/square_tube_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0168781, -758.977..."
a42e74b9,micro,5,,"pose_to_hom_mat3d (Pose, HomMat3D)
hW := RectWidth / 2
hH := RectHeight / 2
XCoord := [hW,hW,-hW,-hW,hW]
XCoord := [XCoord,XCoord]
YCoord := [hH,-hH,-hH,hH,hH]
YCoord := [YCoord,YCoord]
tuple_gen_const (5, -0.06, ZCoord)
ZCoord := [ZCoord,0, 0, 0, 0, 0]
affine_trans_point_3d (HomMat3D, XCoord, YCoor...",175,189,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0168781, -758.977, 5.20077e-006, 5.2e-006, 645.492, 545.222, 1280, 1024, CamParam)
RectWidth := 0.024
RectHeight := RectWidth
ge..."
a42e74b9,micro,6,,"dev_set_line_width (2)
set_line_style (WindowHandle, [2, 2])
dev_set_color ('red')
for J := 0 to 4 by 1
gen_contour_polygon_xld (Edge, [Row[J],Row[J + 5]], [Column[J],Column[J + 5]])
dev_display (Edge)
endfor
set_line_style (WindowHandle, [5, 5])
dev_set_color ('dark green')
dev_display (Bottom)
set...",190,226,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
for J := 0 to 3 by 1
intersection_lines (RowBegin[J], ColBegin[J], RowEnd[J], ColEnd[J], RowBegin[(J..."
a42e74b9,micro,7,"the domain with some morphology, and afterwards
extracting and unifying the edges.","median_image (Image, ImageMedian, 'circle', 2, 'mirrored')
hysteresis_threshold (ImageMedian, RegionHysteresis, 25, 25, 60)
closing_circle (RegionHysteresis, RegionClosing, 8)
shape_trans (RegionClosing, RegionTrans, 'convex')
dilation_circle (RegionTrans, RegionDilation, 10)
erosion_circle (RegionT...",227,252,"* --- Automatically Added Context ---
read_image (Image, 'square_tube/square_tube_01')
extract_rectangle_contour (Image, ClosedContours)
union_collinear_contours_xld (ContoursSplit, UnionContours, 30,..."
34bfab5d,full,0,"This example program demonstrates the application of get_rectangle_pose
(see details in the procedur...","dev_close_window ()
Width := 800
Height := 800
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
set_system ('clip_region', 'false')
set...",13,319,
34bfab5d,micro,1,,"dev_close_window ()
Width := 800
Height := 800
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
set_system ('clip_region', 'false')
set...",11,30,
34bfab5d,micro,2,,"CaltabName := 'caltab_30mm.descr'
Dir := 'barcode/ean13/'
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)",31,35,
34bfab5d,micro,3,,"gen_rectangle1 (ImageBorder, 1, 1, Height - 3, Width - 3)
complement (ImageBorder, ImageBorder)
create_bar_code_model ([], [], BarCodeHandle)",36,40,"* --- Automatically Added Context ---
Width := 800
Height := 800
* --- End of Automatically Added Context ---"
34bfab5d,micro,4,,"for I := 1 to 10 by 1
read_image (Image, Dir + '/tea_box_' + I$'02d')
dev_set_window (WindowHandle)
dev_display (Image)
find_rectangular_regions (Image, ImageBorder, RectangularRegions, NumberOfRegions)
if (NumberOfRegions &gt; 0)
select_shape (RectangularRegions, BigField, 'area', 'and', 10000, 999...",41,75,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_open_window (0, 405, 320, 200, 'black', WindowHandle2)
Dir := 'barcode/ean13/'
gen_cam_pa..."
34bfab5d,micro,5,,"set_system ('clip_region', ClipRegion)
set_system ('store_empty_region', StoreEmptyRegion)
set_system ('empty_region_result', EmptyRegionResult)",76,104,"* --- Automatically Added Context ---
get_system ('clip_region', ClipRegion)
get_system ('store_empty_region', StoreEmptyRegion)
get_system ('empty_region_result', EmptyRegionResult)
* --- End of Auto..."
34bfab5d,micro,6,,"dev_set_check ('~give_error')
dev_error_var (ErrorVar, 1)",105,107,
34bfab5d,micro,7,,"XCoord := 0.5 * [-RectWidth,RectWidth,RectWidth,-RectWidth,-RectWidth]
XCoord := [XCoord,XCoord]
YCoord := 0.5 * [-RectHeight,-RectHeight,RectHeight,RectHeight,-RectHeight]
YCoord := [YCoord,YCoord]
ZCoord := [0.01, 0.01, 0.01, 0.01, 0.01]
ZCoord := [0, 0, 0, 0, 0,ZCoord]",108,114,
34bfab5d,micro,8,,"dilation_rectangle1 (RectangularRegions, RectDilated, 9, 9)
erosion_rectangle1 (RectangularRegions, RectEroded, 9, 9)
difference (RectDilated, RectEroded, RectBorders)
select_shape (RectBorders, RectBorders, 'area', 'and', 600, 99999)
count_obj (RectBorders, Number)
PoseOut := []
gen_empty_obj (Cont...",115,168,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)
for I := 1 to 10 by 1
read_image (Image, Dir + ..."
34bfab5d,micro,9,,"dev_error_var (ErrorVar, 0)
dev_set_check ('give_error')
return ()
contour_to_world_plane_xld (Frame, ContoursTrans, CamParam, Pose, 1)
smallest_rectangle1_xld (ContoursTrans, MinY, MinX, MaxY, MaxX)
set_origin_pose (Pose, MinX, MinY, 0, PoseNewOrigin)
if (|Width| == 1)
Scale := ((MaxX - MinX) / Wid...",169,248,"* --- Automatically Added Context ---
Width := 800
Height := 800
gen_cam_par_area_scan_division (0.0136446, 830.197, 4.58317e-006, 4.65e-006, 509.153, 487.791, 800, 800, CamParam)
read_image (Image, D..."
34bfab5d,micro,10,,"mean_image (Image, ImageMean, 201, 201)
dyn_threshold (Image, ImageMean, Region, 5, 'light')
connection (Region, ConnectedRegions)
fill_up (ConnectedRegions, RegionFillUp)",249,253,"* --- Automatically Added Context ---
read_image (Image, Dir + '/tea_box_' + I$'02d')
* --- End of Automatically Added Context ---"
34bfab5d,micro,11,,"select_shape (RegionFillUp, Objects, ['area', 'convexity', 'rectangularity'], 'and', [2000, 0.85, 0.60], [400000, 1, 1])",254,255,"* --- Automatically Added Context ---
fill_up (ConnectedRegions, RegionFillUp)
* --- End of Automatically Added Context ---"
34bfab5d,micro,12,,"intersection (Objects, ImageBorder, RegionIntersection)
area_center (RegionIntersection, Area, Row, Column)",256,258,"* --- Automatically Added Context ---
gen_rectangle1 (ImageBorder, 1, 1, Height - 3, Width - 3)
project_3d_point (Qx, Qy, Qz, CamParam, Row, Column)
select_shape (RegionFillUp, Objects, ['area', 'conv..."
34bfab5d,micro,13,,"select_mask_obj (Objects, RectangularRegions, Area [==] 0)
count_obj (RectangularRegions, NumberOfRegions)
return ()",259,283,"* --- Automatically Added Context ---
find_rectangular_regions (Image, ImageBorder, RectangularRegions, NumberOfRegions)
select_shape (RegionFillUp, Objects, ['area', 'convexity', 'rectangularity'], '..."
34bfab5d,micro,14,,"PoseOut := Pose
PoseOut[3] := Pose[3] + 180
PoseOut[4] := -Pose[4]
PoseOut[5] := -Pose[5]
return ()
PoseIsGood := 1
if (Error &gt; 0.7)
PoseIsGood := 0
return ()
endif
if (PoseCov[21] &gt; 0.05 or PoseCov[28] &gt; 0.05 or abs(PoseCov[22]) &gt; 0.05)
PoseIsGood := 0
return ()
endif
return ()",284,330,"* --- Automatically Added Context ---
PoseOut := []
get_rectangle_pose (UnionEdges, CamParam, RectWidth, RectHeight, 'huber', 2, Pose, PoseCov, Error)
pose_quality (PoseCov, Error, PoseIsGood)
* --- E..."
16a8d7ab,full,0,"This example shows an application case from the automotive
industry.
The task is to locate a car doo...","dev_update_off ()
dev_close_window ()
read_image (Image, 'automotive/car_door_calib_plate')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
CalTabDescrName := '...",25,121,
16a8d7ab,micro,1,"industry.
The task is to locate a car door put in different orientations
and positions by using the ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'automotive/car_door_calib_plate')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)",6,32,
16a8d7ab,micro,2,,"CalTabDescrName := 'caltab_200mm.descr'
gen_cam_par_area_scan_division (0.0160522, -402.331, 9.30632e-006, 9.3e-006, 315.431, 273.525, 640, 512, CamParam)
caltab_points (CalTabDescrName, X, Y, Z)
find_caltab (Image, Caltab, CalTabDescrName, 3, 112, 5)
find_marks_and_pose (Image, Caltab, CalTabDescrN...",33,49,"* --- Automatically Added Context ---
read_image (Image, 'automotive/car_door_calib_plate')
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
* --- End of Automatically Added Contex..."
16a8d7ab,micro,3,,"read_image (Image, 'automotive/car_door_init_pose')
dev_display (Image)",50,52,"* --- Automatically Added Context ---
read_image (Image, 'automotive/car_door_calib_plate')
* --- End of Automatically Added Context ---"
16a8d7ab,micro,4,,"read_region (ROI, 'automotive/car_door_region')
reduce_domain (Image, ROI, ImageReduced)",53,55,"* --- Automatically Added Context ---
read_image (Image, 'automotive/car_door_calib_plate')
* --- End of Automatically Added Context ---"
16a8d7ab,micro,5,"calibration plate. However, there is the depth of the
calibration plate and an additional displaceme...","set_origin_pose (Pose, 0, 0, 0.03, PoseNewOrigin)",56,59,"* --- Automatically Added Context ---
find_marks_and_pose (Image, Caltab, CalTabDescrName, CamParam, 128, 10, 18, 0.9, 15, 100, RCoord, CCoord, Pose)
* --- End of Automatically Added Context ---"
16a8d7ab,micro,6,,"create_planar_calib_deformable_model (ImageReduced, CamParam, PoseNewOrigin, 'auto', -0.1, 0.2, 'auto', 0.6, 1, 'auto', 0.6, 1, 'auto', 'none', 'use_polarity', 'auto', 'auto', [], [], ModelID)",60,61,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0160522, -402.331, 9.30632e-006, 9.3e-006, 315.431, 273.525, 640, 512, CamParam)
reduce_domain (Image, ROI, ImageReduced)
set_or..."
16a8d7ab,micro,7,easily visualize the matching poses later,"set_deformable_model_param (ModelID, 'get_deformable_model_contours_coord_system', 'world')
get_deformable_model_contours (ModelContours, ModelID, 1)
count_obj (ModelContours, NumberContour)",62,67,"* --- Automatically Added Context ---
create_planar_calib_deformable_model (ImageReduced, CamParam, PoseNewOrigin, 'auto', -0.1, 0.2, 'auto', 0.6, 1, 'auto', 0.6, 1, 'auto', 'none', 'use_polarity', 'a..."
16a8d7ab,micro,8,,"get_deformable_model_params (ModelID, 'model_pose', ModelPose)
dev_set_colored (3)
disp_message (WindowHandle, 'Calibrated Pose of Object\n X: ' + ModelPose[0]$'.4f' + ' m\n Y: ' + ModelPose[1]$'.4f' + ' m\n Z: ' + ModelPose[2]$'.4f' + ' m', 'window', 12, 12, 'black', 'true')
dev_disp_3d_coord_syste...",68,75,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0160522, -402.331, 9.30632e-006, 9.3e-006, 315.431, 273.525..."
16a8d7ab,micro,9,,"gen_rectangle1 (Rectangle2, 200, 50, 420, 620)
for Index := 1 to 20 by 1
read_image (ImageSearch, 'automotive/car_door_' + Index$'.02')
reduce_domain (ImageSearch, Rectangle2, ImageReducedSearch)
dev_display (ImageSearch)
count_seconds (Seconds1)
find_planar_calib_deformable_model (ImageReducedSearc...",76,127,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0160522, -402.331, 9.30632e-006, 9.3e-006, 315.431, 273.525..."
13028722,full,0,"This example demonstrates planar calibrated deformable matching
and its use in a typical bin picking...","dev_close_window ()
read_image (ImageInit, 'automotive/engine_parts_01')
get_image_size (ImageInit, Width, Height)
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
dev_update_off ()
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_l...",12,142,
13028722,micro,1,"and its use in a typical bin picking application setup.
First a deformable model of an engine part i...","dev_close_window ()
read_image (ImageInit, 'automotive/engine_parts_01')
get_image_size (ImageInit, Width, Height)
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
dev_update_off ()
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_l...",6,22,
13028722,micro,2,"Here, the upper part of the engine part, consisting of six
boreholes can be used.","dev_clear_window ()
read_image (Image, 'automotive/engine_parts_01')
dev_display (Image)
gen_rectangle2 (Rectangle1, 285.69, 284.554, -1.66101, 58.923, 17.3983)
gen_rectangle2 (Rectangle2, 282.154, 373.738, -1.50165, 56.3435, 14.8286)
union2 (Rectangle1, Rectangle2, RegionUnion)
reduce_domain (Image...",23,41,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
* --- End of Automatically Added Context ---"
13028722,micro,3,"Here the plane of the object is extracted from measured well
defined points.
Note that it is also po...",dev_display (Image),42,48,"* --- Automatically Added Context ---
read_image (Image, 'automotive/engine_parts_01')
* --- End of Automatically Added Context ---"
13028722,micro,4,"(e.g., with the calibration assistant).","gen_cam_par_area_scan_division (0.0124068, -268.149, 9.30326e-006, 9.3e-006, 290.95, 268.404, 640, 512, CamParam)",49,51,
13028722,micro,5,,"ObjectRow := [254.344, 253.433, 311.613, 316.545]
ObjectCol := [284.269, 368.903, 373.356, 286.666]
gen_cross_contour_xld (Cross, ObjectRow, ObjectCol, 6, 0.785398)
WorldX := [-29.0, 26, 27, -30.0] / 1000.0
WorldY := [-21.5, -19, 19, 19] / 1000.0",52,57,
13028722,micro,6,object.,"WorldZ := [0.0, 0.0, 0.0, 0.0]",58,60,
13028722,micro,7,extracted with vector_to_pose.,"vector_to_pose (WorldX, WorldY, WorldZ, ObjectRow, ObjectCol, CamParam, 'planar_analytic', 'error', PoseModelPlane, Quality)
dev_disp_3d_coord_system (WindowHandle, CamParam, PoseModelPlane, 0.05)
create_planar_calib_deformable_model (ImageReduced, CamParam, PoseModelPlane, 3, [], [], 'auto', 1, [],...",61,65,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
reduce_domain (Image, RegionUnion, ImageReduced)
gen_cam_par_area_scan_division (0.012406..."
13028722,micro,8,coordinate system for later visualization.,"get_deformable_model_contours (ModelContours, ModelID, 1)
get_deformable_model_params (ModelID, 'model_row', ModelRow)
get_deformable_model_params (ModelID, 'model_col', ModelCol)
get_deformable_model_params (ModelID, 'model_pose', ModelPose)
get_deformable_model_params (ModelID, 'cam_param_rect', C...",66,72,"* --- Automatically Added Context ---
create_planar_calib_deformable_model (ImageReduced, CamParam, PoseModelPlane, 3, [], [], 'auto', 1, [], 'auto', 1, [], 'auto', 'none', 'use_polarity', 'auto', 'au..."
13028722,micro,9,"does not suffice. Instead we have to project the metric model
into world coordinates, transform it i...","affine_trans_contour_xld (ModelContours, ContoursAffineTrans, [1, 0,ModelRow,0, 1,ModelCol])
contour_to_world_plane_xld (ContoursAffineTrans, ContoursTrans, CamParamRect, ModelPose, 'm')
count_obj (ContoursTrans, NumberContour)
pose_to_hom_mat3d (ModelPose, HomMat3D)",73,81,"* --- Automatically Added Context ---
get_deformable_model_contours (ModelContours, ModelID, 1)
get_deformable_model_params (ModelID, 'model_row', ModelRow)
get_deformable_model_params (ModelID, 'mode..."
13028722,micro,10,project them into the image.,"gen_empty_obj (FoundContour)
for Index2 := 1 to NumberContour by 1
select_obj (ContoursTrans, ObjectSelected, Index2)
get_contour_xld (ObjectSelected, Y, X)
Z := gen_tuple_const(|X|,0.0)
affine_trans_point_3d (HomMat3D, X, Y, Z, Xc, Yc, Zc)
project_3d_point (Xc, Yc, Zc, CamParam, R, C)
gen_contour_p...",82,98,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
gen_cam_par_area_scan_division (0.0124068, -268.149, 9.30326e-006, 9.3e-006, 290.95, 268...."
13028722,micro,11,border_shape_models must be set to true.,"get_system ('border_shape_models', BorderShapeModels)
set_system ('border_shape_models', 'true')",99,102,
13028722,micro,12,object instances.,"for Index := 1 to 25 by 1
TotalTime := 0
read_image (Image, 'automotive/engine_parts_' + Index$'.02')
count_seconds (Seconds1)
find_planar_calib_deformable_model (Image, ModelID, rad(0), rad(360), 1, 1, 1, 1, 0.65, 0, 0, 3, 0.75, [], [], Pose, CovPose, Score)
count_seconds (Seconds2)
dev_display (Im...",103,140,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageInit, 0, 0, Width, Height, WindowHandle)
read_image (Image, 'automotive/engine_parts_01')
gen_cam_par_area_scan_division (0.012406..."
13028722,micro,13,,"set_system ('border_shape_models', BorderShapeModels)",141,148,"* --- Automatically Added Context ---
get_system ('border_shape_models', BorderShapeModels)
* --- End of Automatically Added Context ---"
451dafaf,full,0,,"read_image (Image, 'a01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
threshold (Image, Region, 0, 100)
shape_trans (Region, RegionTrans, 'rectangle1')
dilation_rectangle1 (RegionTrans, RegionDilation, 10,...",6,42,
deaa9f83,full,0,"This HDevelop example program shows how to create one single
mosaic image that shows the unrolled la...","global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
PixelSizeInMM := 0.2
ColorMosaic := true
HighImageQuality := true
BackgroundMayContainTexture := false
InteractivelyDefineRegion := false
DisplayIntermediateResultsFor := 'first'
PerformF...",18,1802,
deaa9f83,micro,1,,"global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit",17,21,
deaa9f83,micro,2,- Specify the final mosaic image.,"PixelSizeInMM := 0.2
ColorMosaic := true
HighImageQuality := true",22,26,
deaa9f83,micro,3,,BackgroundMayContainTexture := false,27,28,
deaa9f83,micro,4,,InteractivelyDefineRegion := false,29,30,
deaa9f83,micro,5,first image set or for all image sets (set to 'first' or 'all').,DisplayIntermediateResultsFor := 'first',31,34,
deaa9f83,micro,6,- Parameters for the fine tuning of the fine adjustment.,"PerformFineAdjustment := true
FineAdjustmentMatchingWidth := 30
FineAdjustmentMaxShift := 30
BlendingSeam := 10",35,40,
deaa9f83,micro,7,,"SilhouetteMeasureDistance := 10
SilhouetteMeasureLength2 := 30
SilhouetteMeasureSigma := 0.5
SilhouetteMeasureThreshold := 5
SilhouetteMaxTilt := rad(10)",41,47,
deaa9f83,micro,8,,"WindowWidthLimit := 800
WindowHeightLimit := 600
dev_update_off ()",48,52,"* --- Automatically Added Context ---
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
* --- End of Automatically Added Context ---"
deaa9f83,micro,9,set initial state for displaying intermediate results,"if (DisplayIntermediateResultsFor != 'first' and DisplayIntermediateResultsFor != 'all')
throw ('Wrong value of DisplayIntermediateResultsFor (must be first or all)')
endif
DisplayIntermediateResults := true",53,60,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
DisplayIntermediateResultsFor := 'first'
* --- End of Automatically Added Context ---"
deaa9f83,micro,10,,"PathCsm := 'inspect_bottle_camera_setup_model.csm'
PathImg := 'bottle_label'",61,64,
deaa9f83,micro,11,,"list_image_files (PathImg, 'default', [], ImageFiles)
RegExpression := '(freixenet|got2b|jever|wala)_0[1-2]_cam_[1-4].*'
tuple_regexp_select (ImageFiles, RegExpression, ImageFiles)
read_image (Image, ImageFiles[0])
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (...",65,75,"* --- Automatically Added Context ---
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
PathImg := 'bottle_label'
* --- End of Automatically Added Context ---"
deaa9f83,micro,12,,"read_camera_setup_model (PathCsm, CameraSetupModel)",76,78,"* --- Automatically Added Context ---
PathCsm := 'inspect_bottle_camera_setup_model.csm'
* --- End of Automatically Added Context ---"
deaa9f83,micro,13,projection center of camera 0.,"get_camera_setup_param (CameraSetupModel, 0, 'pose', CamPose0)
set_camera_setup_param (CameraSetupModel, 'general', 'coord_transf_pose', CamPose0)",79,83,"* --- Automatically Added Context ---
read_camera_setup_model (PathCsm, CameraSetupModel)
* --- End of Automatically Added Context ---"
deaa9f83,micro,14,,"Objects := ['jever', 'freixenet', 'got2b', 'wala']
for Obj := 0 to |Objects| - 1 by 1
Object := Objects[Obj]
LabelMinCol := -1
LabelMaxCol := -1
if (Object == 'jever')
CylinderRadiusInMM := 30.04
LabelMinCol := 100
LabelMaxCol := 1250
elseif (Object == 'freixenet')
CylinderRadiusInMM := 31.3
LabelMi...",84,255,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
PixelSizeInMM := 0.2
ColorMosaic := true
HighImag..."
deaa9f83,micro,15,Note that only the first three values of the given vectors are taken into account,"CrossProduct := [V1[1] * V2[2] - V1[2] * V2[1],V1[2] * V2[0] - V1[0] * V2[2],V1[0] * V2[1] - V1[1] * V2[0]]
return ()
global tuple DisplayIntermediateResults",256,295,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
* --- End of Automatically Added Context ---"
deaa9f83,micro,16,,"Circumference := 2.0 * CylinderRadius * 3.1415926
NumPointsPerSlice := int(Circumference / PixelSize) + 1
ActualPixelSize := Circumference / NumPointsPerSlice
AngleStep := ActualPixelSize / CylinderRadius
FullAngle := AngleStep * (NumPointsPerSlice - 1)
Angles := -0.5 * FullAngle - AngleStep + cumul...",296,303,"* --- Automatically Added Context ---
PixelSizeInMM := 0.2
PixelSize := 0.001 * PixelSizeInMM
CylinderRadius := 0.001 * CylinderRadiusInMM
gen_cylinder_model (PixelSize, CylinderRadius, MinZ, MaxZ, Nu..."
deaa9f83,micro,17,,"MinZI := (int(fabs(MinZ) / ActualPixelSize) + 1) * sgn(MinZ)
MaxZI := (int(fabs(MaxZ) / ActualPixelSize) + 1) * sgn(MaxZ)
NumSlices := abs(MinZI) + abs(MaxZI) + 1
NumNM := NumSlices * NumPointsPerSlice
PxSampled := gen_tuple_const(NumNM,0)
PySampled := gen_tuple_const(NumNM,0)
PzSampled := gen_tuple...",304,372,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
CylinderRadius := 0.001 * CylinderRadiusInMM
dete..."
deaa9f83,micro,18,assuming that it stands upright in the center of the cameras.,"XCam := []
YCam := []
ZCam := []
for Cam := 0 to NumCameras - 1 by 1
get_camera_setup_param (CameraSetupModelZeroDist, Cam, 'pose', CamPose)
XCam[Cam] := CamPose[0]
YCam[Cam] := CamPose[1]
ZCam[Cam] := CamPose[2]
endfor
CylinderPointApprox := [mean(XCam),mean(YCam),mean(ZCam)]
LenI := 1.0 / sqrt(sum...",373,388,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
* --- End of Automatically Added Context ---"
deaa9f83,micro,19,,"get_camera_setup_param (CameraSetupModelZeroDist, 0, 'pose', CamPose)
pose_to_hom_mat3d (CamPose, HomMat3DCamPose0)
DirTest := sum(CylinderZTmp * HomMat3DCamPose0[[0, 4, 7]])
if (DirTest &gt; 0)
CylinderZTmp := -CylinderZTmp
endif",389,395,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
get_camera_setup_param (CameraSetupModelZeroDist, Cam, 'pos..."
deaa9f83,micro,20,,"cross_product (CylinderZTmp, CylinderXTmp, CylinderYTmp)
HomMat3DCylinderApprox := [CylinderXTmp[0],CylinderYTmp[0],CylinderZTmp[0],CylinderPointApprox[0],CylinderXTmp[1],CylinderYTmp[1],CylinderZTmp[1],CylinderPointApprox[1],CylinderXTmp[2],CylinderYTmp[2],CylinderZTmp[2],CylinderPointApprox[2]]
ho...",396,400,"* --- Automatically Added Context ---
determine_approximate_cylinder_pose_in_center_of_cameras (CameraSetupModelZeroDist, NumCameras, PoseCylinderApprox, HomMat3DCylinderApprox)
CylinderPointApprox :=..."
deaa9f83,micro,21,,"serialize_camera_setup_model (CameraSetupModelZeroDist, SerializedItemHandle)
deserialize_camera_setup_model (SerializedItemHandle, CameraSetupModelZeroDistCylApprox)
set_camera_setup_param (CameraSetupModelZeroDistCylApprox, 'general', 'coord_transf_pose', PoseCylinderApprox)",401,405,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
determine_approximate_cylinder_pose_in_center_of_cameras (C..."
deaa9f83,micro,22,,"A2x := []
A2y := []
A2z := []
B2x := []
B2y := []
B2z := []",406,412,
deaa9f83,micro,23,,"SilhRow := []
SilhCol := []
SilhCam := []
SilhRowElim := []
SilhColElim := []
SilhCamElim := []
for Cam := 0 to NumCameras - 1 by 1
select_obj (ImagesRectified, ImageRectified, Cam + 1)
select_obj (ImagesGrayRectified, GrayImage, Cam + 1)
get_camera_setup_param (CameraSetupModelZeroDistCylApprox, Ca...",413,485,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
BackgroundMayContainTexture := false
SilhouetteMe..."
deaa9f83,micro,24,,"for CamI := 0 to NumCameras - 1 by 1
NumPoints[CamI] := sum(find(SilhCam,CamI) [!=] -1)
endfor",486,490,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
SilhCam := []
* --- End of Automatically Added Context ---"
deaa9f83,micro,25,,"A1x := 0.0
A1y := 0.0
A1z := 0
B1x := 0.0
B1y := 0.0
B1z := 1
Dx := 99999
ErrorLog := []
Iter := 0
IterInter := 0
MaxIter := 100
MaxIterInter := 5
LastError := 99999
SDevFactor := 5.0
while (Iter &lt; MaxIter)
distance_skew_lines (A1x, A1y, A1z, B1x, B1y, B1z, A2x, A2y, A2z, B2x, B2y, B2z, Dist)
E :...",491,600,"* --- Automatically Added Context ---
get_camera_setup_param (CameraSetupModel, 0, 'pose', CamPose0)
CylinderRadius := 0.001 * CylinderRadiusInMM
prepare_distortion_removal (RectificationMaps, CameraS..."
deaa9f83,micro,26,,"pose_compose (PoseCylinderEst, [0, 0, 0, 0, 0, 0, 0], PoseCylinder)",601,602,"* --- Automatically Added Context ---
determine_rotation_axis_3d (ImagesRectified, ImagesGrayRectified, CylinderRadius, BackgroundMayContainTexture, MeasureHandles, Width, Height, CameraSetupModelZero..."
deaa9f83,micro,27,,"serialize_camera_setup_model (CameraSetupModelZeroDistCylApprox, SerializedItemHandle)
deserialize_camera_setup_model (SerializedItemHandle, CameraSetupModelZeroDistInCylinderOrigin)
set_camera_setup_param (CameraSetupModelZeroDistInCylinderOrigin, 'general', 'coord_transf_pose', PoseCylinder)",603,607,"* --- Automatically Added Context ---
determine_rotation_axis_3d (ImagesRectified, ImagesGrayRectified, CylinderRadius, BackgroundMayContainTexture, MeasureHandles, Width, Height, CameraSetupModelZero..."
deaa9f83,micro,28,,"if (DisplayIntermediateResults)
WL := 400
HL := 300
WH := []
gen_cylinder_object_model_3d ([0, 0, 0, 0, 0, 0, 0], CylinderRadius, -0.1, 0.1, ObjectModel3DCylinder)
for Cam := 0 to NumCameras - 1 by 1
select_obj (ImagesRectified, Image, Cam + 1)
dev_open_window_fit_image (GrayImage, Cam / 2 * (HL + 6...",608,716,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
read_image (Image, ImageFiles[0])
CylinderRadius ..."
deaa9f83,micro,29,given area of the label in the first image,"Indices := [0,cumul(gen_tuple_const(NumSlices - 1,NumPointsPerSlice))]
SamplePX := CylinderPointsX[Indices]
SamplePY := CylinderPointsY[Indices]
SamplePZ := CylinderPointsZ[Indices]
get_camera_setup_param (CameraSetupModelZeroDistInCylinderOrigin, 0, 'params', CamParam0)
get_camera_setup_param (Came...",717,1238,"* --- Automatically Added Context ---
global def tuple DisplayIntermediateResults
global def tuple WindowWidthLimit
global def tuple WindowHeightLimit
ColorMosaic := true
HighImageQuality := true
Perf..."
deaa9f83,micro,30,,Indices := [-MinZI * NumPointsPerSlice:-MinZI * NumPointsPerSlice + NumPointsPerSlice - 1],1239,1240,"* --- Automatically Added Context ---
gen_cylinder_model (PixelSize, CylinderRadius, MinZ, MaxZ, NumSlices, NumPointsPerSlice, MinZI, MaxZI, ActualPixelSize, CylinderPointsX, CylinderPointsY, Cylinder..."
deaa9f83,micro,31,if InteractivelyDefineRegion is true.,"Positive := Indices [&gt;=] 0
if (sum(Positive) != |Positive|)
throw ('Not enough points on silhouette.\nPlease choose a bigger part of the bottle to be unrolled.')
endif
Slice0X := CylinderPointsX[Indices]
Slice0Y := CylinderPointsY[Indices]
Slice0Z := CylinderPointsZ[Indices]
CamAngle := gen_tuple...",1241,1269,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
gen_cylinder_model (PixelSize, CylinderRadius, MinZ, MaxZ, ..."
deaa9f83,micro,32,a particular camera image,"gen_image_const (ImageLabel1, 'byte', MosaicWidth, 1)
set_grayval (ImageLabel1, gen_tuple_const(MosaicWidth,0), [0:MosaicWidth - 1], BestFromCamIdx0)
zoom_image_size (ImageLabel1, ImageLabel, MosaicWidth, MosaicHeight, 'nearest_neighbor')
label_to_region (ImageLabel, Regions)
return ()
gen_empty_obj...",1270,1488,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
get_image_size (Image, Width, Height)
CylinderRadius := 0.001 * CylinderRadiusInMM
BorderLeft := LabelMinCol
BorderRight := Widt..."
deaa9f83,micro,33,"opposite silhouettes of the cylinder in the images assuming that this
distance is measured perpendic...","MinPairDist := []
MaxPairDist := []
for Cam := 0 to NumCameras - 1 by 1
MinPairDist[Cam] := 2.0 * Focus / (MaxDist[Cam] + MaxShift) * CylinderRadius / S
MaxPairDist[Cam] := 2.0 * Focus / (MinDist[Cam] - MaxShift) * CylinderRadius / S
endfor
return ()
serialize_camera_setup_model (CameraSetupModel, S...",1489,1529,"* --- Automatically Added Context ---
read_camera_setup_model (PathCsm, CameraSetupModel)
CylinderRadius := 0.001 * CylinderRadiusInMM
prepare_distortion_removal (RectificationMaps, CameraSetupModel, ..."
deaa9f83,micro,34,,"get_camera_setup_param (CameraSetupModelZeroDist, 'general', 'num_cameras', NumCameras)
gen_empty_obj (RectificationMaps)
for Cam := 0 to NumCameras - 1 by 1
get_camera_setup_param (CameraSetupModelZeroDist, Cam, 'params', CamParIn)
get_camera_setup_param (CameraSetupModelZeroDist, Cam, 'type', Came...",1530,1574,"* --- Automatically Added Context ---
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZeroDist, NumCameras)
select_obj (RectificationMaps, Map, Cam + 1)
for Cam := 0 t..."
deaa9f83,micro,35,,Num := |X|,1575,1577,"* --- Automatically Added Context ---
solve_matrix (A, 'general', 0, y, X)
* --- End of Automatically Added Context ---"
deaa9f83,micro,36,,"XM := mean(X)
YM := mean(Y)
ZM := mean(Z)",1578,1582,"* --- Automatically Added Context ---
solve_matrix (A, 'general', 0, y, X)
* --- End of Automatically Added Context ---"
deaa9f83,micro,37,,"DX := X - XM
DY := Y - YM
DZ := Z - ZM
MA11 := sum(DX * DX)
MA22 := sum(DY * DY)
MA33 := sum(DZ * DZ)
MA12 := sum(DX * DY)
MA13 := sum(DX * DZ)
MA23 := sum(DY * DZ)
create_matrix (3, 3, [MA11,MA12,MA13,MA12,MA22,MA23,MA13,MA23,MA33], MatrixID)",1583,1594,"* --- Automatically Added Context ---
solve_matrix (A, 'general', 0, y, X)
XM := mean(X)
YM := mean(Y)
ZM := mean(Z)
* --- End of Automatically Added Context ---"
deaa9f83,micro,38,eigenvalue of the matrix MatrixID,"eigenvalues_symmetric_matrix (MatrixID, 'true', EigenvaluesID, EigenvectorsID)
get_value_matrix (EigenvectorsID, 0, 0, NX)
get_value_matrix (EigenvectorsID, 1, 0, NY)
get_value_matrix (EigenvectorsID, 2, 0, NZ)",1595,1601,"* --- Automatically Added Context ---
fit_plane (XCam, YCam, ZCam, NX, NY, NZ, C)
create_matrix (3, 3, [MA11,MA12,MA13,MA12,MA22,MA23,MA13,MA23,MA33], MatrixID)
* --- End of Automatically Added Contex..."
deaa9f83,micro,39,,"C := NX * XM + NY * YM + NZ * ZM
if (C &lt; 0.0)
NX := -NX
NY := -NY
NZ := -NZ
C := -C
endif
return ()
switch (FootOnLine)
case 1:
a1 := L1a
b1 := L1b
a2 := L2a
b2 := L2b
break
case 2:
a1 := L2a
b1 := L2b
a2 := L1a
b2 := L1b
break
default:
throw ('Wrong value of FootOnLine: ' + FootOnLine)
break
end...",1602,1768,"* --- Automatically Added Context ---
throw ('Wrong value of DisplayIntermediateResultsFor (must be first or all)')
prepare_distortion_removal (RectificationMaps, CameraSetupModel, CameraSetupModelZer..."
deaa9f83,micro,40,,"if (NX &gt; 0)
CylinderZTmp := -CylinderZTmp
endif
cross_product (CylinderZTmp, CylinderXTmp, CylinderYTmp)
HomMat3DCylinderApprox := [CylinderXTmp[0],CylinderYTmp[0],CylinderZTmp[0],CylinderPointApprox[0],CylinderXTmp[1],CylinderYTmp[1],CylinderZTmp[1],CylinderPointApprox[1],CylinderXTmp[2],Cylinde...",1769,1826,"* --- Automatically Added Context ---
determine_approximate_cylinder_pose_in_center_of_cameras (CameraSetupModelZeroDist, NumCameras, PoseCylinderApprox, HomMat3DCylinderApprox)
cross_product (Cylinde..."
0c8b6e10,full,0,"This example program shows how to use HALCON's variation model
operators to perform a typical print ...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_display (Image)
threshold (Image, Region,...",19,115,
0c8b6e10,micro,1,"operators to perform a typical print quality inspection.
The program detects incorrect prints on the...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_display (Image)",6,26,
0c8b6e10,micro,2,computed automatically based on a simple image segmentation.,"threshold (Image, Region, 100, 255)
fill_up (Region, RegionFillUp)
difference (RegionFillUp, Region, RegionDifference)
shape_trans (RegionDifference, RegionTrans, 'convex')
dilation_circle (RegionTrans, RegionDilation, 8.5)
reduce_domain (Image, RegionDilation, ImageReduced)
create_generic_shape_mod...",27,46,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
* --- End of Automatically Added Context ---"
0c8b6e10,micro,3,"model origin (0,0) to the position in the reference image.","find_generic_shape_model (ImageReduced, ShapeModelID, MatchResultID, Matches)
get_generic_shape_model_result (MatchResultID, 'all', 'hom_mat_2d', HomMat2DModel)
get_generic_shape_model_result_object (Model, MatchResultID, 'all', 'contours')
create_variation_model (Width, Height, 'byte', 'standard', ...",47,70,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
reduce_domain (Image, RegionDilation, ImageReduced)
create_generic_shape_model (ShapeModelI..."
0c8b6e10,micro,4,"region of the clip. Sometimes the print is also in an incorrect
position of the clip. This will lead...","erosion_rectangle1 (RegionFillUp, RegionROI, 1, 15)
dev_display (MeanImage)
dev_disp_text ('Reference image', 'window', 12, 12, 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (VarImage)
dev_disp_text ('Variation image', 'window', 12, 12, 'black', [], [])
d...",71,121,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
fill_up (Region, RegionFillUp)
reduce_domain (Image, RegionDilation,..."
a8d78b90,full,0,"This example program shows how to use HALCON's variation model operators
to perform a typical print ...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('red')
dev_display (Image)
threshold (Image, Region, 1...",26,186,
a8d78b90,micro,1,"to perform a typical print quality inspection.  The program detects incorrect
prints on the clips of...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('red')
dev_display (Image)",6,33,
a8d78b90,micro,2,automatically based on a simple image segmentation.,"threshold (Image, Region, 100, 255)
fill_up (Region, RegionFillUp)
difference (RegionFillUp, Region, RegionDifference)
shape_trans (RegionDifference, RegionTrans, 'convex')
dilation_circle (RegionTrans, RegionDilation, 8.5)
reduce_domain (Image, RegionDilation, ImageReduced)
threshold (ImageReduced,...",34,74,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
a8d78b90,micro,3,,"gen_empty_obj (Models)
for I := 1 to Number by 1
select_obj (ShapeModels, ModelSelected, I)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, Row1[I - 1], Column1[I - 1], HomMat2D)
affine_trans_contour_xld (ModelSelected, ModelTrans, HomMat2D)
concat_obj (Models, ModelTran...",75,93,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
smallest_rectangle1 (RegionDilation, Row1, Column1, Row2, Column2)
c..."
a8d78b90,micro,4,,"for J := 1 to 15 by 1
read_image (Image, 'pen/pen-' + J$'02d')
find_shape_models (Image, ShapeModelIDs, rad(-10), rad(20), 0.5, [1, 1, 1, 1, 1], 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score, Model)
for K := 0 to |Score| - 1 by 1
vector_angle_to_rigid (Row[K], Column[K], Angle[K], RowsRef[...",94,105,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
Heights := Row2 - Row1 + 5
Widths := Column2 - Column1 + 5
gen_empty_obj (VariationModelROIs)
ShapeModelIDs := []
VariationModelI..."
a8d78b90,micro,5,,"get_image_size (Image, Width, Height)
gen_empty_obj (MeanImages)
gen_empty_obj (VarImages)
gen_empty_obj (ROIs)
for I := 1 to Number by 1
get_variation_model (MeanImage, VarImage, VariationModelIDs[I - 1])
prepare_variation_model (VariationModelIDs[I - 1], 20, 3)
select_obj (VariationModelROIs, ROI,...",106,150,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
smallest_rectangle1 (RegionDil..."
a8d78b90,micro,6,,"for J := 1 to 30 by 1
read_image (Image, 'pen/pen-' + J$'02d')
gen_empty_obj (RegionsErrorTrans)
find_shape_models (Image, ShapeModelIDs, rad(-10), rad(20), 0.5, [1, 1, 1, 1, 1], 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score, Model)
NumberFound := |Score|
for K := 0 to NumberFound - 1 by 1...",151,192,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
connection (Region, ConnectedRegions)
count_obj (RegionDilation, Num..."
6fdafabc,full,0,,"read_image (Image, 'fonts/arial_a1')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2 + 42, 'black', WindowHandle)
dev_set_part (-84, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
dev_s...",6,48,
4768cefc,full,0,,"gen_rectangle1 (Rect, 0, 0, 5, 5)
dev_update_var ('off')
dev_update_window ('off')
dev_close_window ()
read_image (Image, 'stamps/swiss1')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, round(Width / 1.5), round(Height / 1.5), 'black', WindowID)
set_display_font (WindowID, 14, 'mono', ...",6,49,
cd3d6b1b,full,0,"Reconstruct the three-dimensional surface of a pile of pipe
joints by using a multi-view stereo setu...","dev_close_window ()
dev_update_off ()
ImagePath := '3d_machine_vision/multi_view/'
ImagePrefix := 'multi_view_pipe_joints'
read_image (Image, ImagePath + ImagePrefix + '_cam_0_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_open_window_fit...",16,239,
cd3d6b1b,micro,1,*****,"dev_close_window ()
dev_update_off ()
ImagePath := '3d_machine_vision/multi_view/'
ImagePrefix := 'multi_view_pipe_joints'
read_image (Image, ImagePath + ImagePrefix + '_cam_0_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_open_window_fit...",13,26,
cd3d6b1b,micro,2,"Part 1: Initialize cameras, get the parameters and poses of the cameras.
*****","init_camera_setup (CameraSetupModelID)
get_camera_setup_param (CameraSetupModelID, 'general', 'num_cameras', NumCameras)
get_camera_setup_param (CameraSetupModelID, 0, 'pose', Pose0)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CamParam0)",27,35,
cd3d6b1b,micro,3,"the camera setup, which is no longer required.","create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)",36,38,"* --- Automatically Added Context ---
init_camera_setup (CameraSetupModelID)
* --- End of Automatically Added Context ---"
cd3d6b1b,micro,4,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')
set_stereo_model_param (StereoModelID, 'rectif_sub_sampling', 1.2)",39,41,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
cd3d6b1b,micro,5,,"set_stereo_model_image_pairs (StereoModelID, [0, 2], [1, 3])
set_stereo_model_param (StereoModelID, 'bounding_box', [-0.2, -0.07, -0.075, 0.2, 0.07, -0.004])",42,44,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
cd3d6b1b,micro,6,,"set_stereo_model_param (StereoModelID, 'sub_sampling_step', 3)",45,46,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
cd3d6b1b,micro,7,,"set_stereo_model_param (StereoModelID, 'binocular_filter', 'left_right_check')",47,49,"* --- Automatically Added Context ---
create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
cd3d6b1b,micro,8,"Part 2: Create a surface model of the pipe fittings to be matched.
*****","read_object_model_3d ('pipe_joint', 'm', [], [], PipeJointOM3DID, Status)
create_surface_model (PipeJointOM3DID, 0.03, [], [], PipeJointSMID)",50,55,
cd3d6b1b,micro,9,"Part 3: Reconstruct the surface of the pile of pipe fittings
and detect the position of up to MaxNum...","NumMatches := 5
MinScore := .3
Params := ['num_matches', 'pose_ref_scoring_dist_rel', 'scene_normal_computation']
Values := [NumMatches,0.02, 'mls']
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
pose_invert ...",56,150,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/multi_view/'
ImagePrefix := 'multi_view_pipe_joints'
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0,..."
cd3d6b1b,micro,10,,"read_image (Images, ImagePath + ImagePrefix + '_cam_0_' + SceneIndex$'.02')
for Index := 1 to NumCamera - 1 by 1
read_image (Img, ImagePath + ImagePrefix + '_cam_' + Index + '_' + SceneIndex$'.02')
concat_obj (Images, Img, Images)
endfor
return ()",151,179,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/multi_view/'
ImagePrefix := 'multi_view_pipe_joints'
for Index := 1 to NumImages by 1
read_multi_view_stereo_images (Images, Image..."
cd3d6b1b,micro,11,consisting of four cameras,"dev_set_window (WindowHandle)
count_obj (Images, NumImages)
if (NumImages != 4)
disp_message (WindowHandle, 'Wrong number of images provided!', 'window', 12, 12, 'black', 'true')
stop ()
endif
NumCols := 2
select_obj (Images, Img, 1)
get_image_size (Img, Width, Height)
tile_images (Images, TiledImag...",180,220,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
NumImages := 15
for Index := 1 to NumImages by 1
read_multi_vi..."
cd3d6b1b,micro,12,,"gen_cam_par_area_scan_polynomial (0.00850373, 4008.61, -2.95892e+008, 2.37315e+013, 0.139749, -0.00367983, 5.99965e-006, 6e-006, 362.715, 236.769, 752, 480, CamParam0)
gen_cam_par_area_scan_polynomial (0.00854019, 3445.26, -1.18075e+008, 6.40715e+012, -0.0527818, -0.192439, 5.99894e-006, 6e-006, 406...",221,231,"* --- Automatically Added Context ---
get_camera_setup_param (CameraSetupModelID, 0, 'pose', Pose0)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CamParam0)
create_pose (0.0, 0.0, 0.5, -30,..."
cd3d6b1b,micro,13,,"create_camera_setup_model (4, CameraSetupModelID)
set_camera_setup_cam_param (CameraSetupModelID, 0, [], CamParam0, Pose0)
set_camera_setup_cam_param (CameraSetupModelID, 1, [], CamParam1, Pose1)
set_camera_setup_cam_param (CameraSetupModelID, 2, [], CamParam2, Pose2)
set_camera_setup_cam_param (Cam...",232,247,"* --- Automatically Added Context ---
init_camera_setup (CameraSetupModelID)
get_camera_setup_param (CameraSetupModelID, 0, 'pose', Pose0)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CamP..."
8455bfae,full,0,"***********************************************************
This example program shows the workflow ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'screws/screws_backlight/screws_backlight_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
dev...",14,377,
8455bfae,micro,1,,"dev_update_off ()
dev_close_window ()",13,16,
8455bfae,micro,2,,"read_image (Image, 'screws/screws_backlight/screws_backlight_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
dev_set_draw ('margin')
dev_set_line_widt...",17,25,
8455bfae,micro,3,,"get_handle_tuple (WindowHandle, 'Width', WindowWidth)
get_handle_tuple (WindowHandle, 'Height', WindowHeight)
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')",26,31,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
8455bfae,micro,4,,"dev_set_window (WindowHandle)
dev_display (Image)
dev_disp_description_text_introduction (WindowHandleText)
stop ()",32,37,"* --- Automatically Added Context ---
read_image (Image, 'screws/screws_backlight/screws_backlight_01')
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
dev_open_window_fit_size (0..."
8455bfae,micro,5,"Create the shape model (offline step)                     *
****************************************...",create_generic_shape_model (ModelID),38,43,
8455bfae,micro,6,"Define the model template (offline step)                  *
****************************************...","gen_rectangle1 (ROI, 1685, 2710, 2215, 3120)
reduce_domain (Image, ROI, ImageReduced)",44,50,"* --- Automatically Added Context ---
read_image (Image, 'screws/screws_backlight/screws_backlight_01')
* --- End of Automatically Added Context ---"
8455bfae,micro,7,,"dev_display_template (ROI, WindowHandle)
dev_disp_description_text_model_template (WindowHandleText)
stop ()",51,55,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHand..."
8455bfae,micro,8,"Define the clutter region (offline step)                  *
****************************************...","gen_rectangle2 (ROI_0, 1761, 2781, rad(-110), 55, 40)
gen_rectangle2 (ROI_1, 1856, 3083, rad(75), 55, 40)
union2 (ROI_0, ROI_1, ClutterRegion)",56,63,
8455bfae,micro,9,,"dev_display_clutter_region (ClutterRegion, WindowHandle)
dev_disp_description_text_define_clutter_region (WindowHandleText)
stop ()",64,68,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHand..."
8455bfae,micro,10,"Set the model parameters/objects (offline step)           *
****************************************...","set_generic_shape_model_object (ClutterRegion, ModelID, 'clutter_region')
dev_disp_description_text_model_parameters (WindowHandleText)
stop ()",69,77,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHandleText)
create_generic_shape_model (ModelID)
union2 (ROI_0, ROI_1, Cl..."
8455bfae,micro,11,"Train the shape model (offline step)                      *
****************************************...","train_generic_shape_model (ImageReduced, ModelID)",78,83,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
reduce_domain (Image, ROI, ImageReduced)
* --- End of Automatically Added Context ---"
8455bfae,micro,12,,"set_generic_shape_model_param (ModelID, 'min_score', 0.4)
set_generic_shape_model_param (ModelID, 'clutter_contrast', 10)
set_generic_shape_model_param (ModelID, 'max_clutter', 0.06)
dev_disp_description_text_search_parameters (WindowHandleText)
stop ()",88,95,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHandleText)
create_generic_shape_model (ModelID)
* --- End of Automatical..."
8455bfae,micro,13,"Find the model (online step)                              *
****************************************...","dev_disp_description_text_find_model (WindowHandleText)
dev_set_window (WindowHandle)
NumImages := 5
for Index := 1 to NumImages by 1
read_image (Image, 'screws/screws_backlight/screws_backlight_' + Index$'02')
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shap...",96,121,"* --- Automatically Added Context ---
read_image (Image, 'screws/screws_backlight/screws_backlight_01')
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
dev_open_window_fit_size (0..."
8455bfae,micro,14,"End of program                                            *
****************************************...","disp_end_of_program_message (WindowHandle, 'black', 'true')
dev_set_window (WindowHandleText)
dev_close_window ()
dev_update_on ()",122,140,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
dev_open_window_fit_size (0, WindowWidth + 8, Width / 2, Height, -1, WindowHeight, WindowHand..."
8455bfae,micro,15,,"Text := 'This example shows how the clutter'
Text[|Text|] := 'feature of the shape-based matching'
Text[|Text|] := 'can be used with a pick and place'
Text[|Text|] := 'application of screws.'
Text[|Text|] := ''
Text[|Text|] := 'The main offline steps are as follows:'
Text[|Text|] := ''
Text[|Text|] ...",141,179,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
8455bfae,micro,16,,"dev_set_window (WindowHandle)
dev_clear_window ()
Text := 'Online step - Find the shape model in'
Text[|Text|] := 'the image:'
Text[|Text|] := ''
Text[|Text|] := 'Find only objects that have enough'
Text[|Text|] := 'quiet zone such that they can be'
Text[|Text|] := 'for instance gripped by a robot.'...",180,212,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Text := 'This example shows how the clutter'
Text[|Text|] := '4. Find object instances.'
* --..."
8455bfae,micro,17,can be useful for pick and place applications.,"Text := 'Define the clutter region: '
Text[|Text|] := ''
Text[|Text|] := 'In order to enable the robot to grip'
Text[|Text|] := 'a screw, it is important that there'
Text[|Text|] := 'are no other screws around the'
Text[|Text|] := 'gripping point.'
Text[|Text|] := ''
Text[|Text|] := 'This can be ens...",213,250,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Text := 'This example shows how the clutter'
Text[|Text|] := '   - Define the model template...."
8455bfae,micro,18,,"dev_set_window (WindowHandle)
dev_set_color ('blue')
dev_display (ClutterRegion)
return ()",251,274,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
union2 (ROI_0, ROI_1, ClutterRegion)
* --- End of Automatically Added Context ---"
8455bfae,micro,19,,"dev_set_window (WindowHandle)
dev_set_color ('orange')
dev_display (ROI)
return ()",275,295,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
gen_rectangle1 (ROI, 1685, 2710, 2215, 3120)
* --- End of Automatically Added Context ---"
8455bfae,micro,20,,"Text := 'Define the template region for'
Text[|Text|] := 'model creation and reduce the'
Text[|Text|] := 'image domain.'
dev_set_window (WindowHandle)
dev_clear_window ()
dev_disp_text (Text, 'window', 'top', 'left', 'white', 'box', 'false')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bo...",296,320,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Text := 'This example shows how the clutter'
Text[|Text|] := '   - Define the model template...."
8455bfae,micro,21,parameters of the clutter feature.,"Text := 'Set the model parameters/objects:'
Text[|Text|] := ''
Text[|Text|] := 'The \'clutter_region\' can be easily set'
Text[|Text|] := 'without defining the associated'
Text[|Text|] := 'HomMat2D explicitly.'
Text[|Text|] := ''
Text[|Text|] := 'The \'clutter_hom_mat_2d\' will be'
Text[|Text|] := '...",321,354,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Text := 'This example shows how the clutter'
Text[|Text|] := 'The main offline steps are as f..."
8455bfae,micro,22,,"Text := 'Set the search parameters:'
Text[|Text|] := ''
Text[|Text|] := 'We want to find only matches that'
Text[|Text|] := 'have a \'score\' of at least 0.4'
Text[|Text|] := '(\'min_score\').'
Text[|Text|] := ''
Text[|Text|] := 'As our images have very low noise,'
Text[|Text|] := 'we set the \'clut...",355,385,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
Text := 'This example shows how the clutter'
Text[|Text|] := '   - Set the model parameters.'..."
722aa722,full,0,"In this example program, a robot with a camera attached to it
is used to find objects in 2D with sha...","initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
stop ()
dev_disp_read_hand_eye_calib_data_instructions (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
dev_set_window (WindowHandleGraphics)
dev_c...",10,1742,
722aa722,micro,1,"is used to find objects in 2D with shape-based matching.
Then, the found object is grasped with the ...","initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
stop ()",6,13,
722aa722,micro,2,,"dev_disp_read_hand_eye_calib_data_instructions (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
dev_set_window (WindowHandleGraphics)
dev_close_window ()",16,21,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
* --- End of Automatically Added Context ---"
722aa722,micro,3,,"read_image (Image2DMatching, ImageDir + 'corner_bracket_model_moving_cam')",24,25,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
722aa722,micro,4,when the image was acquired.,"read_pose (DataDir + 'tool_in_base_pose_2d_matching_moving_cam.dat', ToolInBasePose2DMatching)",26,28,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
722aa722,micro,5,,"ObjectHeight := 0.032
dev_disp_2d_matching_instructions (Image2DMatching, ToolInBasePose2DMatching, ObjectHeight)
stop ()",29,33,"* --- Automatically Added Context ---
read_image (Image2DMatching, ImageDir + 'corner_bracket_model_moving_cam')
read_pose (DataDir + 'tool_in_base_pose_2d_matching_moving_cam.dat', ToolInBasePose2DMa..."
722aa722,micro,6,and compute the rectification map.,"prepare_poses_and_rectification_data_moving_cam (ToolInBasePose2DMatching, ObjectHeight, 'only_rectify', HandEyeCalibData, Poses, RectificationData)
rectify_image_and_compute_matching_plane_moving_cam (Image2DMatching, ImageRectified, ToolInBasePose2DMatching, HandEyeCalibData, Poses, RectificationD...",34,38,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
read_image (Image2DMatching, ImageDir + 'corner_bracket_model_moving_cam')
read_pose (DataDir + 'tool_in_base..."
722aa722,micro,7,"Depending on the shape of your object, you may want to
draw a different shape or use the ROI dialog ...","dev_disp_draw_region_of_interest_instructions (ImageRectified, WindowHandle)
draw_rectangle1 (WindowHandle, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangle, Row1, Column1, Row2, Column2)
reduce_domain (ImageRectified, Rectangle, ImageReduced)
median_image (ImageReduced, ImageReduced, 'circle...",39,49,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
rectify_image_and_compute_matching_plane_moving_cam (Image2DMatching, ImageRectified, ToolInBasePose2DMatchin..."
722aa722,micro,8,,"visualize_setup_in_3d (ImageRectified, ModelID, ObjectHeight, WindowHandle, HandEyeCalibData, Poses, RectificationData, ToolInBasePose2DMatching, ObjectModels3DData)",50,52,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
read_pose (DataDir + 'tool_in_base_pose_2d_matching_movi..."
722aa722,micro,9,and move the object.,"NumRobotPathSteps := 2
dev_disp_robot_path_steps_instructions (WindowHandle, WindowHandleGraphics)
stop ()
if (NumRobotPathSteps &gt; 0)
train_robot_paths_steps (NumRobotPathSteps, ModelID, ImageDir, DataDir, RectificationData, HandEyeCalibData, Poses, ObjectModels3DData, WindowHandle, ToolInModelRo...",53,63,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibDat..."
722aa722,micro,10,,"NumImages := 6
create_pose (0.18, 0.12, 9.57, 126.7, 4.6, 74.3, 'Rp+T', 'gba', 'point', PoseIn)
dev_open_window_for_3d_visualization (WindowHandle, WindowHandle3D)
for Index := 1 to NumImages by 1
read_image (Image, ImageDir + 'corner_bracket_moving_cam_' + Index$'02')
read_pose (DataDir + 'corner_b...",64,360,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibDat..."
722aa722,micro,11,please refer to hand_eye_movingcam_calibration.hdev.,"read_cam_par (DataDir + 'campar_hand_eye_moving_cam.dat', CamParam)
read_pose (DataDir + 'plane_in_base_pose_hand_eye_moving_cam.dat', PlaneInBasePose0)
read_pose (DataDir + 'tool_in_cam_pose_hand_eye_moving_cam.dat', ToolInCamPose)
stop ()",361,368,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
722aa722,micro,12,,"HandEyeCalibData := dict{}
HandEyeCalibData.CamParam := CamParam
HandEyeCalibData.PlaneInBasePose0 := PlaneInBasePose0
HandEyeCalibData.ToolInCamPose := ToolInCamPose
return ()
dev_set_window (WindowHandle)
dev_clear_window ()
dev_display (Image)
Text := '2) Please specify the region of the matching...",369,543,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
ObjectHeight := 0.032
prepare_poses_and_rectification_da..."
722aa722,micro,13,,"gen_robot_tool_and_base_object_model_3d (0.005, 0.05, OM3DToolOrigin, OM3DBase)
gen_current_setup_moving_cam_object_model_3d (0.05, ToolInBasePose2DMatching, HandEyeCalibData, OM3DToolOrigin, OM3DBase, OM3DCamera, OM3DTool, OM3DPlane)
find_shape_model (Image, ModelID, 0, rad(360), 0.5, 1, 0.5, 'leas...",544,556,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
read_pose (DataDir + 'tool_in_base_pose_2d_matching_moving_cam.dat', ToolInBasePose2DMatching)
ObjectHeight :..."
722aa722,micro,14,,"GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'color_6', 'color_7', 'color_8', 'alpha_8', 'color_9', 'color_10', 'color_11', 'alpha_11', 'point_size']
GenParamValue := ['red', 'red', 'green', 'blue', 'red', 'green', 'blue', 'gray', 'gray', 0.7, 'magenta', 'plum',...",557,559,
722aa722,micro,15,,"tuple_gen_const (12, '', Label)
Label[0] := 'Matched Object'
Label[1] := 'Robot\'s Tool'
Label[4] := 'Robot\'s Base'
gen_3d_instructions (Instructions)
visualize_object_model_3d (WindowHandle, [OM3DMatch,OM3DTool,OM3DBase,OM3DPlane,OM3DCamera], [], VisualizationPose, GenParamName, GenParamValue, Tit...",560,569,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
Text[1] := '   Please check the resulting contours whether they seem'
gen_robot_tool_and_base_object_model_3d..."
722aa722,micro,16,,"ObjectModels3DData := dict{}
ObjectModels3DData.OM3DModel := OM3DModel
ObjectModels3DData.OM3DCamera := OM3DCamera
ObjectModels3DData.OM3DPlane := OM3DPlane
ObjectModels3DData.OM3DBase := OM3DBase
ObjectModels3DData.OM3DToolOrigin := OM3DToolOrigin
ObjectModels3DData.OM3DMatch := OM3DMatch
return ()",570,675,"* --- Automatically Added Context ---
visualize_setup_in_3d (ImageRectified, ModelID, ObjectHeight, WindowHandle, HandEyeCalibData, Poses, RectificationData, ToolInBasePose2DMatching, ObjectModels3DDa..."
722aa722,micro,17,,Index := 0,679,680,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
* --- End of Automatically Added Context ---"
722aa722,micro,18,,"GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
Index := Index + 1",681,684,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
* --- End of Automatically Added Context ---"
722aa722,micro,19,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'color_' + (Index + 3)]
Index := Index + 4
GenParamValueRobotPath := [GenParamValueRobotPath,'red', 'green', 'blue', 'gray']",685,688,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
722aa722,micro,20,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'alpha_' + Index]
GenParamValueRobotPath := [GenParamValueRobotPath,'gray', 0.7]
Index := Index + 1",689,692,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
722aa722,micro,21,,"PathLabelPositions := []
for Index1 := 0 to |OM3DsRobotPath| - 2 by 3
GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2)]
Index := Index + 3
PathLabelPositions := [PathLabelPositions,Index]
GenParamValueRobotPath := [GenParamValueRobotPath,...",693,700,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
722aa722,micro,22,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'alpha_' + (Index + 2)]
GenParamValueRobotPath := [GenParamValueRobotPath,'magenta', 'plum', 'white', 0.3]
Index := Index + 3",701,704,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
722aa722,micro,23,,"GenParamNameRobotPath := [GenParamNameRobotPath,'point_size']
GenParamValueRobotPath := [GenParamValueRobotPath,1]",705,708,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
722aa722,micro,24,,"tuple_gen_const (|GenParamNameRobotPath| - 3, '', LabelsRobotPath)
LabelsRobotPath[0] := 'Matched Object'
LabelsRobotPath[1] := 'Robot\'s Base'
for Index1 := 1 to |PathLabelPositions| by 1
LabelsRobotPath[PathLabelPositions[Index1 - 1] - 1] := 'Robot Path Pose ' + Index1
endfor
return ()",709,788,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
Label[0] := 'Matched Object'
Label[1] := 'Robot\'s Tool'
Label[4] := 'Robot\'s Base'
GenParamNameRobotPath := 'color_' + Index
Pa..."
722aa722,micro,25,,"read_image (Image, ImageDir + 'corner_bracket_model_moving_cam')",789,790,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_image (Image, ImageDir + 'corner_bracket_moving_cam_' + Index$'02')
* --- End of Automatically Added Con..."
722aa722,micro,26,,"read_pose (DataDir + 'tool_in_base_pose_2d_matching_moving_cam.dat', ToolInBasePose)
dev_disp_acquire_image_and_pose_for_teaching_path_steps_instructions (Image)
stop ()
rectify_image_and_compute_matching_plane_moving_cam (Image, ImageRectified, ToolInBasePose, HandEyeCalibData, Poses, Rectification...",791,796,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
prepare_poses_and_rectification_data_moving_cam (ToolInB..."
722aa722,micro,27,"when approaching, grasping, ... the object.","for Index := 1 to NumRobotPathSteps by 1
read_pose (DataDir + 'tool_in_base_pose_moving_cam_robot_path_0' + Index + '.dat', ToolInBaseRobotPathPose)
dev_disp_read_robot_path_poses (ImageRectified, Index, NumRobotPathSteps, ModelID)
stop ()
ToolInBaseRobotPathPoses.at(Index-1) := ToolInBaseRobotPathP...",797,804,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
rectify_image_and_compute_matching_plane_moving_cam (Image2DMatching, ImageRectified, ToolInBasePose2DMatchin..."
722aa722,micro,28,,"find_shape_model (Image, ModelID, 0, rad(360), 0.5, 1, 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
obtain_3d_pose_of_match_moving_cam (Row, Column, Angle, ToolInBasePose, HandEyeCalibData, Poses, RectificationData, ModelInBaseRobotPathPose)
calculate_tool_in_model_robot_path_poses (Mode...",805,809,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
prepare_poses_and_rectification_data_moving_cam (ToolInBasePose2DMatching, ObjectHeight, 'only_rectify', Hand..."
722aa722,micro,29,,"visualize_robot_path_poses (ToolInBaseRobotPathPoses, ModelInBaseRobotPathPose, WindowHandle, HandEyeCalibData, ObjectModels3DData)",810,812,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
visualize_setup_in_3d (ImageRectified, ModelID, ObjectHe..."
722aa722,micro,30,for the online computation of the robot path poses.,"get_pose_type (ToolInBaseRobotPathPose, Poses.OrderOfTransform, Poses.OrderOfRotation, Poses.ViewOfTransform)
return ()
OM3DPlane := ObjectModels3DData.OM3DPlane
OM3DModel := ObjectModels3DData.OM3DModel
OM3DToolOrigin := ObjectModels3DData.OM3DToolOrigin
OM3DBase := ObjectModels3DData.OM3DBase
OM3D...",813,1323,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
prepare_poses_and_rectification_data_moving_cam (ToolInB..."
722aa722,micro,31,,"OM3DToolGrasp := []
for Index := 0 to ToolInBaseRobotPathPoses.length() - 1 by 1
rigid_trans_object_model_3d (OM3DToolOrigin, ToolInBaseRobotPathPoses.at(Index), OM3DToolOriginRigidTrans)
OM3DToolGrasp := [OM3DToolGrasp,OM3DToolOriginRigidTrans]
endfor
gen_3d_instructions (Instructions)
assemble_gen...",1326,1438,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
visualize_setup_in_3d (ImageRectified, ModelID, ObjectHeight, WindowHandle, HandEyeCalibData, Poses, Rectific..."
722aa722,micro,32,,"GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'color_6', 'color_7', 'color_8', 'alpha_8', 'color_9', 'color_10', 'color_11', 'alpha_11', 'point_size']
GenParamValue := ['red', 'red', 'green', 'blue', 'red', 'green', 'blue', 'gray', 'gray', 0.7, 'magenta', 'plum',...",1439,1443,"* --- Automatically Added Context ---
GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'color_6', 'color_7', 'color_8', 'alpha_8', 'color_9', 'color_10', 'color_11', ..."
722aa722,micro,33,,"tuple_gen_const (12, '', Label)
Label[0] := 'Matched Object'
Label[1] := 'Robot\'s Tool'
Label[4] := 'Robot\'s Base'
visualize_object_model_3d (WindowHandle3D, [OM3DMatch,OM3DTool,OM3DBase,OM3DPlane,OM3DCamera], [], PoseIn, GenParamName, GenParamValue, 'Found object', Label, Instructions, PoseOut)
r...",1444,1533,"* --- Automatically Added Context ---
create_pose (0.18, 0.12, 9.57, 126.7, 4.6, 74.3, 'Rp+T', 'gba', 'point', PoseIn)
dev_open_window_for_3d_visualization (WindowHandle, WindowHandle3D)
gen_robot_too..."
722aa722,micro,34,,Index := 0,1537,1538,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
* --- End of Automatically Added Context ---"
722aa722,micro,35,,"GenParamNameGrasp := 'color_' + Index
GenParamValueGrasp := 'red'
Index := Index + 1",1539,1542,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added..."
722aa722,micro,36,,"GenParamNameGrasp := [GenParamNameGrasp,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2)]
GenParamValueGrasp := [GenParamValueGrasp,'red', 'green', 'blue']
Index := Index + 3",1543,1546,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added..."
722aa722,micro,37,,"GenParamNameGrasp := [GenParamNameGrasp,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'color_' + (Index + 3)]
GenParamValueGrasp := [GenParamValueGrasp,'red', 'green', 'blue', 'gray']
Index := Index + 4",1547,1550,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added..."
722aa722,micro,38,,"GenParamNameGrasp := [GenParamNameGrasp,'color_' + Index,'alpha_' + Index]
GenParamValueGrasp := [GenParamValueGrasp,'gray', 0.7]
Index := Index + 1",1551,1554,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added..."
722aa722,micro,39,,"PathLabelPositions := []
for Index1 := 0 to |OM3DToolGrasp| - 2 by 3
GenParamNameGrasp := [GenParamNameGrasp,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2)]
Index := Index + 3
PathLabelPositions := [PathLabelPositions,Index]
GenParamValueGrasp := [GenParamValueGrasp,'red', 'green', '...",1555,1562,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
PathLabelPositions := []
for Index1 := 0 to |OM3DsRobotPath| - 2 by 3
OM3DToolGrasp := []
assemble_generic_parameters2 (OM3DToolG..."
722aa722,micro,40,,"GenParamNameGrasp := [GenParamNameGrasp,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'alpha_' + (Index + 2)]
GenParamValueGrasp := [GenParamValueGrasp,'magenta', 'plum', 'white', 0.3]
Index := Index + 3",1563,1566,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added..."
722aa722,micro,41,,"GenParamNameGrasp := [GenParamNameGrasp,'point_size']
GenParamValueGrasp := [GenParamValueGrasp,1]",1567,1570,"* --- Automatically Added Context ---
assemble_generic_parameters2 (OM3DToolGrasp, GenParamNameGrasp, GenParamValueGrasp, LabelsGrasp)
* --- End of Automatically Added Context ---"
722aa722,micro,42,,"tuple_gen_const (|GenParamNameGrasp| - 3, '', LabelsGrasp)
LabelsGrasp[0] := 'Matched Object'
LabelsGrasp[4] := 'Robot\'s Base'
for Index1 := 1 to |PathLabelPositions| by 1
LabelsGrasp[PathLabelPositions[Index1 - 1] - 1] := 'Robot Path Pose ' + Index1
endfor
return ()
read_image (Image, '3d_machine_...",1571,1688,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
NumRobotPathSteps := 2
read_image (Image, ImageDir..."
722aa722,micro,43,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
return ()",1689,1722,"* --- Automatically Added Context ---
gen_3d_instructions (Instructions)
* --- End of Automatically Added Context ---"
722aa722,micro,44,,"dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
get_window_extents (WindowHandle, Row, Column, Width, Height)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_part_style (WindowHandle, 2)
dev_set_line_width (2)
dev_update_off ()",1723,1731,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
get_window_extents (WindowHandle, Row, Column, Width, Height)
* --- End of Automatically Added Context ---"
722aa722,micro,45,,ImageDir := '3d_machine_vision/hand_eye/',1732,1734,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
722aa722,micro,46,,"get_current_dir (CurrentDir)
DataDir := CurrentDir + '/'",1735,1738,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
722aa722,micro,47,,"set_system ('border_shape_models', 'true')
set_system ('clip_region', 'false')
return ()",1739,1780,
0c7fd903,full,0,"In this example program, a stationary camera setup is used
to find objects in 2D with shape-based ma...","initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
stop ()
dev_disp_read_hand_eye_calib_data_instructions (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
dev_set_window (WindowHandleGraphics)
dev_c...",10,1581,
0c7fd903,micro,1,"to find objects in 2D with shape-based matching.
Then, the found object is grasped with a robot.","initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
stop ()",6,13,
0c7fd903,micro,2,,"dev_disp_read_hand_eye_calib_data_instructions (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
dev_set_window (WindowHandleGraphics)
dev_close_window ()",16,21,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
* --- End of Automatically Added Context ---"
0c7fd903,micro,3,,"read_image (Image2DMatching, ImageDir + 'corner_bracket_model_stationary_cam')",24,25,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
0c7fd903,micro,4,,"ObjectHeight := 0.032
dev_disp_2d_matching_instructions (Image2DMatching, ObjectHeight)
stop ()",26,30,"* --- Automatically Added Context ---
read_image (Image2DMatching, ImageDir + 'corner_bracket_model_stationary_cam')
* --- End of Automatically Added Context ---"
0c7fd903,micro,5,and compute the rectification map.,"prepare_poses_and_rectification_data_stationary_cam (ObjectHeight, 'true', HandEyeCalibData, Poses, RectificationData)
rectify_image (Image2DMatching, ImageRectified, RectificationData)",31,35,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
read_image (Image2DMatching, ImageDir + 'corner_bracket_model_stationary_cam')
ObjectHeight := 0.032
* --- En..."
0c7fd903,micro,6,"Depending on the shape of your object, you may want to draw a
different shape or use the ROI dialog ...","dev_disp_draw_region_of_interest_instructions (ImageRectified, WindowHandle)
draw_rectangle1 (WindowHandle, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangle, Row1, Column1, Row2, Column2)
reduce_domain (ImageRectified, Rectangle, ImageReduced)
median_image (ImageReduced, ImageReduced, 'circle...",36,47,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
rectify_image (Image2DMatching, ImageRectified, RectificationData)
* --- End of Automatically Added Context -..."
0c7fd903,micro,7,,"visualize_setup_in_3d (ImageRectified, ModelID, ObjectHeight, WindowHandle, HandEyeCalibData, Poses, RectificationData, ObjectModels3DData)",48,50,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
ObjectHeight := 0.032
prepare_poses_and_rectification_da..."
0c7fd903,micro,8,the object.,"NumRobotPathSteps := 2
dev_disp_robot_path_steps_instructions (WindowHandle, WindowHandleGraphics)
stop ()
if (NumRobotPathSteps &gt; 0)
train_robot_paths_steps (NumRobotPathSteps, ModelID, ImageDir, DataDir, RectificationData, HandEyeCalibData, Poses, ObjectModels3DData, WindowHandle, ToolInModelRo...",51,61,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibDat..."
0c7fd903,micro,9,,"NumImages := 4
create_pose (0.089, 0.5, 20, 106, 0.65, 93.5, 'Rp+T', 'gba', 'point', PoseIn)
dev_open_window_for_3d_visualization (WindowHandle, WindowHandle3D)
for Index := 1 to NumImages by 1
read_image (Image, ImageDir + 'corner_bracket_stationary_cam_' + Index$'02')
dev_clear_window ()
dev_disp_...",62,314,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
read_hand_eye_calib_data (DataDir, HandEyeCalibDat..."
0c7fd903,micro,10,,Index := 0,318,319,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
* --- End of Automatically Added Context ---"
0c7fd903,micro,11,,"GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
Index := Index + 1",320,323,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
* --- End of Automatically Added Context ---"
0c7fd903,micro,12,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'color_' + (Index + 3)]
Index := Index + 4
GenParamValueRobotPath := [GenParamValueRobotPath,'red', 'green', 'blue', 'gray']",324,327,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
0c7fd903,micro,13,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'alpha_' + Index]
GenParamValueRobotPath := [GenParamValueRobotPath,'gray', 0.7]
Index := Index + 1",328,331,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
0c7fd903,micro,14,,"PathLabelPositions := []
for Index1 := 0 to |OM3DsRobotPath| - 2 by 3
GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2)]
Index := Index + 3
PathLabelPositions := [PathLabelPositions,Index]
GenParamValueRobotPath := [GenParamValueRobotPath,...",332,339,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
0c7fd903,micro,15,,"GenParamNameRobotPath := [GenParamNameRobotPath,'color_' + Index,'color_' + (Index + 1),'color_' + (Index + 2),'alpha_' + (Index + 2)]
GenParamValueRobotPath := [GenParamValueRobotPath,'magenta', 'plum', 'white', 0.3]
Index := Index + 3",340,343,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
0c7fd903,micro,16,,"GenParamNameRobotPath := [GenParamNameRobotPath,'point_size']
GenParamValueRobotPath := [GenParamValueRobotPath,1]",344,347,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
GenParamValueRobotPath := 'red'
* --- End of Automatically Added Context ---"
0c7fd903,micro,17,,"tuple_gen_const (|GenParamNameRobotPath| - 3, '', LabelsRobotPath)
LabelsRobotPath[0] := 'Matched Object'
LabelsRobotPath[1] := 'Robot\'s Base'
for Index1 := 1 to |PathLabelPositions| by 1
LabelsRobotPath[PathLabelPositions[Index1 - 1] - 1] := 'Robot Path Pose ' + Index1
endfor
return ()",348,419,"* --- Automatically Added Context ---
for Index := 1 to NumImages by 1
GenParamNameRobotPath := 'color_' + Index
PathLabelPositions := []
for Index1 := 0 to |OM3DsRobotPath| - 2 by 3
* --- End of Auto..."
0c7fd903,micro,18,please refer to calibrate_hand_eye_stationary_cam_approx.hdev.,"HandEyeCalibData := dict{}
read_cam_par (DataDir + 'campar_hand_eye_stationary_cam.dat', HandEyeCalibData.CamParam)
read_pose (DataDir + 'plane_in_cam_pose_hand_eye_stationary_cam.dat', HandEyeCalibData.PlaneInCamPose0)
read_pose (DataDir + 'base_in_cam_pose_hand_eye_stationary_cam.dat', HandEyeCali...",420,486,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
ObjectHeight := 0.032
prepare_poses_and_rectification_da..."
0c7fd903,micro,19,,"gen_current_setup_stationary_cam_object_model_3d (0.005, 0.05, 0.05, HandEyeCalibData, OM3DCamera, OM3DPlane, OM3DBase, OM3DToolOrigin)
find_shape_model (Image, ModelID, 0, rad(360), 0.5, 1, 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
obtain_3d_pose_of_match_stationary_cam (Row, Column,...",487,498,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
ObjectHeight := 0.032
prepare_poses_and_rectification_data_stationary_cam (ObjectHeight, 'true', HandEyeCalib..."
0c7fd903,micro,20,,"GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'alpha_5', 'color_6', 'color_7', 'color_8', 'alpha_8', 'point_size']
GenParamValue := ['red', 'red', 'green', 'blue', 'gray', 'gray', 0.7, 'magenta', 'plum', 'white', 0.3, 1]",499,501,
0c7fd903,micro,21,,"tuple_gen_const (9, '', Label)
Label[0] := 'Matched Object'
Label[1] := 'Robot\'s Base'
gen_3d_instructions (Instructions)
visualize_object_model_3d (WindowHandle, [OM3DMatch,OM3DBase,OM3DPlane,OM3DCamera], [], VisualizationPose, GenParamName, GenParamValue, Title, Label, Instructions, PoseOut)",502,510,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
LabelsRobotPath[0] := 'Matched Object'
LabelsRobotPath[1] := 'Robot\'s Base'
* Title := '2) 3D model of the o..."
0c7fd903,micro,22,,"ObjectModels3DData := dict{}
ObjectModels3DData.OM3DModel := OM3DModel
ObjectModels3DData.OM3DCamera := OM3DCamera
ObjectModels3DData.OM3DPlane := OM3DPlane
ObjectModels3DData.OM3DBase := OM3DBase
ObjectModels3DData.OM3DToolOrigin := OM3DToolOrigin
ObjectModels3DData.OM3DMatch := OM3DMatch
return ()...",511,662,"* --- Automatically Added Context ---
prepare_poses_and_rectification_data_stationary_cam (ObjectHeight, 'true', HandEyeCalibData, Poses, RectificationData)
rectify_image (Image2DMatching, ImageRectif..."
0c7fd903,micro,23,,"read_image (Image, ImageDir + 'corner_bracket_model_stationary_cam')
dev_disp_acquire_image_for_teaching_path_steps_instructions (Image)
stop ()
rectify_image (Image, ImageRectified, RectificationData)",663,668,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
prepare_poses_and_rectification_data_stationary_cam (ObjectHeight, 'true', HandEyeCalibData, Poses, Rectifica..."
0c7fd903,micro,24,"when approaching, grasping, ... the object.","for Index := 1 to NumRobotPathSteps by 1
read_pose (DataDir + 'tool_in_base_pose_stationary_cam_robot_path_0' + Index + '.dat', ToolInBaseRobotPathPose)
dev_disp_read_robot_path_poses (ImageRectified, Index, NumRobotPathSteps, ModelID)
stop ()
ToolInBaseRobotPathPoses.at(Index-1) := ToolInBaseRobotP...",669,676,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
rectify_image (Image2DMatching, ImageRectified, RectificationData)
create_shape_model (ImageReduced, 'auto', ..."
0c7fd903,micro,25,,"find_shape_model (Image, ModelID, 0, rad(360), 0.5, 1, 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
obtain_3d_pose_of_match_stationary_cam (Row, Column, Angle, HandEyeCalibData, Poses, RectificationData, ModelInBaseRobotPathPose)
calculate_tool_in_model_robot_path_poses (ModelInBaseRobot...",677,681,"* --- Automatically Added Context ---
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
prepare_poses_and_rectification_data_stationary_cam (ObjectHeight, 'true', HandEyeCalibData, Poses, Rectifica..."
0c7fd903,micro,26,,"visualize_robot_path_poses (ToolInBaseRobotPathPoses, ModelInBaseRobotPathPose, WindowHandle, HandEyeCalibData, ObjectModels3DData)",682,684,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
read_hand_eye_calib_data (DataDir, HandEyeCalibData)
visualize_setup_in_3d (ImageRectified, ModelID, ObjectHe..."
0c7fd903,micro,27,for the online computation of the robot path poses.,"get_pose_type (ToolInBaseRobotPathPose, Poses.OrderOfTransform, Poses.OrderOfRotation, Poses.ViewOfTransform)
return ()
OM3DPlane := ObjectModels3DData.OM3DPlane
OM3DModel := ObjectModels3DData.OM3DModel
OM3DToolOrigin := ObjectModels3DData.OM3DToolOrigin
OM3DBase := ObjectModels3DData.OM3DBase
OM3D...",685,1375,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
prepare_poses_and_rectification_data_stationary_ca..."
0c7fd903,micro,28,,"GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_5', 'alpha_5', 'color_6', 'color_7', 'color_8', 'alpha_8', 'point_size']
GenParamValue := ['red', 'red', 'green', 'blue', 'gray', 'gray', 0.7, 'magenta', 'plum', 'white', 0.3, 1]
gen_3d_instructions (Instructions)",1376,1380,"* --- Automatically Added Context ---
* visualize_object_model_3d (WindowHandle, OM3DModel, [], VisualizationPose, ['color_0', 'disp_pose'], ['red', 'true'], Title, [], Instructions, PoseOut)
GenParam..."
0c7fd903,micro,29,,"tuple_gen_const (12, '', Label)
Label[0] := 'Matched Object'
Label[4] := 'Robot\'s Base'
visualize_object_model_3d (WindowHandle3D, [OM3DMatch,OM3DBase,OM3DPlane,OM3DCamera], [], PoseIn, GenParamName, GenParamValue, 'Found object', Label, Instructions, PoseOut)
return ()",1381,1442,"* --- Automatically Added Context ---
create_pose (0.089, 0.5, 20, 106, 0.65, 93.5, 'Rp+T', 'gba', 'point', PoseIn)
dev_open_window_for_3d_visualization (WindowHandle, WindowHandle3D)
LabelsRobotPath[..."
0c7fd903,micro,30,,"dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_part_style (WindowHandle, 2)
dev_set_line_width (2)
dev_update_off ()",1443,1450,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
0c7fd903,micro,31,,ImageDir := '3d_machine_vision/hand_eye/',1451,1453,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
0c7fd903,micro,32,,"get_current_dir (CurrentDir)
DataDir := CurrentDir + '/'",1454,1457,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
0c7fd903,micro,33,,"set_system ('border_shape_models', 'true')
set_system ('clip_region', 'false')
return ()
read_image (Image, '3d_machine_vision/hand_eye/instruction_images/setup_with_object_stationary_cam')
get_window_extents (WindowHandle, Row, Column, Width1, Height1)
dev_open_window_fit_image (Image, 0, Width1 + ...",1458,1576,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction (WindowHandle, WindowHandleGraphics)
read_image (Image, ImageDir + 'corner_bracket_stat..."
0c7fd903,micro,34,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
return ()",1577,1601,"* --- Automatically Added Context ---
* visualize_object_model_3d (WindowHandle, OM3DModel, [], VisualizationPose, ['color_0', 'disp_pose'], ['red', 'true'], Title, [], Instructions, PoseOut)
* --- En..."
64ae599d,full,0,"This example shows the complete pipeline from
3D object acquisition and model creation to matching
T...","dev_update_off ()
list_image_files ('universal_joint_part', 'default', [], AllImageFiles)
tuple_regexp_select (AllImageFiles, 'intensities', ImageFiles)
ImageFiles := sort(ImageFiles)
dev_close_window ()
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
dev_open_window (0, 0, 748 / 2,...",18,584,
64ae599d,micro,1,"- pairwise registration of 3D data
- global   registration of all 3D data
- union of the registered ...",dev_update_off (),9,18,
64ae599d,micro,2,,"list_image_files ('universal_joint_part', 'default', [], AllImageFiles)
tuple_regexp_select (AllImageFiles, 'intensities', ImageFiles)
ImageFiles := sort(ImageFiles)",19,23,
64ae599d,micro,3,,"dev_close_window ()
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
dev_open_window (0, 0, 748 / 2, 240, 'black', WindowHandle1)
dev_open_window (0, 748 / 2 + 12, 748 / 2, 240, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (Wi...",24,32,
64ae599d,micro,4,,"Color1 := 'green'
Color2 := 'yellow'
Color3 := 'gray'
dev_set_window (WindowHandle1)
dev_set_draw ('margin')
dev_set_color (Color1)
dev_set_window (WindowHandle2)
dev_set_draw ('margin')
dev_set_color (Color2)",33,42,"* --- Automatically Added Context ---
dev_open_window (0, 0, 748 / 2, 240, 'black', WindowHandle1)
dev_open_window (0, 748 / 2 + 12, 748 / 2, 240, 'black', WindowHandle2)
* --- End of Automatically Ad..."
64ae599d,micro,5,,"gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 150.0, 760, 300, CamParam1)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
create_pose (70, -20, 1800, 125, 345, 185, 'Rp+T', 'gba', 'point', PoseVisualize)
Instructions[0] := 'Rotate: Left b...",43,73,"* --- Automatically Added Context ---
tuple_regexp_select (AllImageFiles, 'intensities', ImageFiles)
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
dev_open_window (0, 0, 748 / 2, 24..."
64ae599d,micro,6,,"read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], ObjectModel3D, Status)
PreviousOM3 := ObjectModel3D
RegisteredOM3s := ObjectModel3D
copy_object_model_3d (ObjectModel3D, 'all', CollectedAffineObjects)
Offsets := []
hom_mat3d_identity (HomMat3DStart)
HomMat3D...",78,85,
64ae599d,micro,7,,"NumTrainingImages := 15
NumSearchImages := |ImageFiles| - NumTrainingImages
for Index := 1 to NumTrainingImages - 1 by 1
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_' + Index$'02d', 'm', [], [], ObjectModel3D, Status)
get_object_model_3d_params (ObjectModel3D, 'num_points', ...",86,135,"* --- Automatically Added Context ---
tuple_regexp_select (AllImageFiles, 'intensities', ImageFiles)
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
dev_open_window (0, 0, 748 / 2, 24..."
64ae599d,micro,8,,"dev_set_window (WindowHandle1)
dev_close_window ()
dev_set_window (WindowHandle2)
dev_close_window ()
dev_set_window (WindowHandle3D)
dev_set_window_extents (0, 0, 760, 550)
dev_clear_window ()",136,143,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
dev_open_window (0, 0, 748 / 2, 240, 'black', WindowHandle1)
dev_open_window (0, 748 / 2 + 12, 74..."
64ae599d,micro,9,,"Message := 'Result of the pairwise registration'
disp_message (WindowHandle3D, Message, 'window', 12, 12, 'black', 'true')
Message := 'Pairwise registration carries the risk of'
Message[1] := 'accumulating errors over many images.'
Message[2] := 'Therefore, the results will be refined globally'
Mess...",144,153,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
creat..."
64ae599d,micro,10,"relative poses (represented by homogeneous matrices)
as input.
In this example, the results of the p...","dev_clear_window ()
Message := 'Step 2:'
Message[2] := ' '
Message[3] := 'Global registration of 3D sensor data'
Message[4] := 'to refine the results.'
Message[5] := ' '
Message[6] := 'This may take a minute, please wait...'
disp_message (WindowHandle3D, Message, 'window', 12, 12, 'white', 'false')
...",159,175,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
Message := 'This program creates a 3D model for surface-based 3D-matching'
Message[6] := 'Step 1:..."
64ae599d,micro,11,,"affine_trans_object_model_3d (RegisteredOM3s, HomMat3DRefined, GloballyRegisteredOM3s)
Title := 'Result of the global registration'
visualize_object_model_3d (WindowHandle3D, GloballyRegisteredOM3s, CamParam2, PoseVisualize, 'colored', 12, Title, [], Instructions, Pose)",176,181,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
creat..."
64ae599d,micro,12,,"union_object_model_3d (GloballyRegisteredOM3s, 'points_surface', UnionOptimized)
dev_clear_window ()
Title := 'Union of the registered models'
Message := 'The result still is very noisy.'
Message[2] := 'Therefore further processing is done in the next steps.'
disp_message (WindowHandle3D, Message, '...",184,194,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
creat..."
64ae599d,micro,13,"In sampling mode 'accurate', a voxel of this size must
contain at least 'min_num_points' points to b...","MinNumPoints := 5
SamplingParam := 0.5
sample_object_model_3d (UnionOptimized, 'accurate', SamplingParam, 'min_num_points', MinNumPoints, SampleExact)
Title := 'Subsampled object (SamplingParam: ' + SamplingParam + 'mm)'
Message := 'Subsampling reduces the number of points in overlapping areas.'
Mes...",203,219,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
Instr..."
64ae599d,micro,14,"Move the object temporarily, so that the origin of the coordinate system
lies conveniently below the...","get_object_model_3d_params (SampleExact, 'center', Center)
get_object_model_3d_params (SampleExact, 'bounding_box1', BoundingBox)
hom_mat3d_identity (HomMat3DTrans)
hom_mat3d_translate_local (HomMat3DTrans, -Center[0], -Center[1], -BoundingBox[2], HomMat3DTranslate)
affine_trans_object_model_3d (Sam...",220,239,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
Instr..."
64ae599d,micro,15,,"Message := 'Please wait while triangulating...'
Message[1] := 'Check the status bar for progress information.'
dev_clear_window ()
disp_message (WindowHandle3D, Message, 'window', 12, 12, 'white', 'false')
triangulate_object_model_3d (SmoothObject3D, 'greedy', [], [], Surface3D, Information)
Title :...",240,249,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
Instr..."
64ae599d,micro,16,"the processed data and train a model for
surface-based 3D matching from it.","connection_object_model_3d (Surface3D, 'mesh', 1, ObjectModel3DConnected)",252,256,"* --- Automatically Added Context ---
triangulate_object_model_3d (SmoothObject3D, 'greedy', [], [], Surface3D, Information)
* --- End of Automatically Added Context ---"
64ae599d,micro,17,,"select_object_model_3d (ObjectModel3DConnected, ['has_triangles', 'num_triangles'], 'and', [1, 2000], [1, 100000], ObjectModel3DSelected)
Title := 'Large connected components in different colors'
Message := 'After triangulation, the desired object can easily be'
Message[1] := 'segmented as a trainin...",257,271,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 275.0, 760, 550, CamParam2)
Instr..."
64ae599d,micro,18,,"test_normal_direction (ObjectModel3DCross, InvertNormals)",272,273,"* --- Automatically Added Context ---
select_object_model_3d (ObjectModel3DSelected, ['central_moment_2_x', 'central_moment_2_y'], 'and', [150, 200], [400, 230], ObjectModel3DCross)
* --- End of Autom..."
64ae599d,micro,19,,"create_surface_model (ObjectModel3DCross, 0.03, 'model_invert_normals', InvertNormals, SurfaceModelID)",274,276,"* --- Automatically Added Context ---
select_object_model_3d (ObjectModel3DSelected, ['central_moment_2_x', 'central_moment_2_y'], 'and', [150, 200], [400, 230], ObjectModel3DCross)
test_normal_direct..."
64ae599d,micro,20,"as used for the registration/triangulation pipeline. In this step we assess how
accurate the model i...","Message := 'First, we try to find the model in 3D data'
Message := 'acquired by the same sensor than the training data.'
for Index := 1 to NumSearchImages by 1
read_image (Image, ImageFiles[NumTrainingImages + Index - 1])
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_' + (NumT...",282,313,"* --- Automatically Added Context ---
tuple_regexp_select (AllImageFiles, 'intensities', ImageFiles)
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0...."
64ae599d,micro,21,"a different sensor.
In this case: stereo reconstruction","init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
tuple_regexp_select (AllImageFiles, 'camera_0', ImageFiles1)
tuple_regexp_select (AllImageFiles, 'camera_1', ImageFiles2)
tuple_regexp_select (AllImageFiles, 'camera_2', ImageFiles3)
tuple_regexp_select (AllImageFiles, 'camera_3', I...",316,325,"* --- Automatically Added Context ---
list_image_files ('universal_joint_part', 'default', [], AllImageFiles)
* --- End of Automatically Added Context ---"
64ae599d,micro,22,,"HomMat3DScale[0] := 0.001
HomMat3DScale[5] := 0.001
HomMat3DScale[10] := 0.001
affine_trans_object_model_3d (ObjectModel3DCross, HomMat3DScale, OM3DModelTmp)
get_object_model_3d_params (OM3DModelTmp, 'center', Center)
hom_mat3d_identity (HomMat3DTrans)
hom_mat3d_translate_local (HomMat3DTrans, -Cent...",326,338,"* --- Automatically Added Context ---
get_object_model_3d_params (SampleExact, 'center', Center)
hom_mat3d_identity (HomMat3DTrans)
hom_mat3d_translate_local (HomMat3DTrans, -Center[0], -Center[1], -B..."
64ae599d,micro,23,"This direction is not predictable in a multicam setup, since
it depends on which camera pair was use...","create_surface_model (OM3DModel, 0.03, 'model_invert_normals', 'false', SurfaceModelID)",339,342,"* --- Automatically Added Context ---
create_surface_model (ObjectModel3DCross, 0.03, 'model_invert_normals', InvertNormals, SurfaceModelID)
affine_trans_object_model_3d (OM3DModelTmp, HomMat3DTransla..."
64ae599d,micro,24,,"for IndexScene := 0 to |ImageFiles1| - 1 by 1
gen_empty_obj (Images)
read_image (Image1, ImageFiles1[IndexScene])
concat_obj (Images, Image1, Images)
read_image (Image2, ImageFiles2[IndexScene])
concat_obj (Images, Image2, Images)
read_image (Image3, ImageFiles3[IndexScene])
concat_obj (Images, Imag...",343,444,"* --- Automatically Added Context ---
dev_open_window (250, 0, 748 + 12, 300, 'black', WindowHandle3D)
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 380.0, 150.0, 760, 300, CamParam1)
gen_c..."
64ae599d,micro,25,"the camera setup, which is no longer required","create_stereo_model (CameraSetupModelID, 'surface_pairwise', [], [], StereoModelID)",445,447,"* --- Automatically Added Context ---
init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
read_camera_setup_model ('four_camera_setup_model.csm', CameraSetupModelID)
* --- End of Autom..."
64ae599d,micro,26,,"set_stereo_model_param (StereoModelID, 'sub_sampling_step', 1)",448,449,"* --- Automatically Added Context ---
init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
* --- End of Automatically Added Context ---"
64ae599d,micro,27,,"set_stereo_model_param (StereoModelID, 'rectif_interpolation', 'bilinear')
set_stereo_model_param (StereoModelID, 'rectif_sub_sampling', 2.0)",450,453,"* --- Automatically Added Context ---
init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
* --- End of Automatically Added Context ---"
64ae599d,micro,28,,"set_stereo_model_param (StereoModelID, 'binocular_method', 'ncc')
set_stereo_model_param (StereoModelID, 'binocular_num_levels', 1)
set_stereo_model_param (StereoModelID, 'binocular_mask_width', 11)
set_stereo_model_param (StereoModelID, 'binocular_mask_height', 11)
set_stereo_model_param (StereoMod...",454,462,"* --- Automatically Added Context ---
init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
* --- End of Automatically Added Context ---"
64ae599d,micro,29,,"set_stereo_model_param (StereoModelID, 'bounding_box', [-0.1, -0.1, -0.07, 0.1, 0.1, 0.0])
set_stereo_model_image_pairs (StereoModelID, [0, 1, 2], [1, 2, 3])
ref_P_cam := Pose0
pose_to_hom_mat3d (ref_P_cam, ref_H_cam)
hom_mat3d_invert (ref_H_cam, cam_H_ref)
hom_mat3d_to_pose (cam_H_ref, cam_P_ref)
r...",463,492,"* --- Automatically Added Context ---
init_stereo_and_surface_model (CamParam0, StereoModelID, cam_H_ref)
get_camera_setup_param (CameraSetupModelID, 0, 'pose', Pose0)
* --- End of Automatically Added..."
64ae599d,micro,30,,"affine_trans_object_model_3d (SmoothObject3D, HomMat3D, SmoothObject3DInCam)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_x', X)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_y', Y)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_z', Z)",493,497,"* --- Automatically Added Context ---
pose_to_hom_mat3d (Pose, HomMat3D)
affine_trans_object_model_3d (SmoothObject3DTrans, HomMat3DInvert, SmoothObject3D)
* --- End of Automatically Added Context ---"
64ae599d,micro,31,,"project_3d_point (X, Y, Z, CamParam, Row, Column)",498,499,"* --- Automatically Added Context ---
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_x', X)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_y', Y)
get_object_model_3d_para..."
64ae599d,micro,32,,"get_cam_par_data (CamParam, 'image_width', ImageWidth)
get_cam_par_data (CamParam, 'image_height', ImageHeight)
tuple_gen_const (|Row|, ImageHeight - 1, RowMax)
tuple_gen_const (|Row|, 0, RowMin)
tuple_min2 (RowMax, Row, Row)
tuple_max2 (RowMin, Row, Row)
tuple_gen_const (|Column|, ImageWidth - 1, C...",500,510,"* --- Automatically Added Context ---
project_3d_point (X, Y, Z, CamParam, Row, Column)
* --- End of Automatically Added Context ---"
64ae599d,micro,33,extended points attribute '&amp;gray',"get_grayval_interpolated (Image, Row, Column, 'bilinear', Grayval)
set_object_model_3d_attrib_mod (SmoothObject3D, '&amp;gray', 'points', Grayval)
return ()",511,535,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
affine_trans_object_model_3d (SmoothObject3DTrans, HomMat3DInvert, SmoothObject3D)
project_3d_point (X, Y, Z, CamParam, Row, Col..."
64ae599d,micro,34,,"get_object_model_3d_params (ObjectModel3D, 'mapping_row', Rows)
get_object_model_3d_params (ObjectModel3D, 'mapping_col', Columns)",536,538,"* --- Automatically Added Context ---
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
64ae599d,micro,35,,"access_channel (Image, ImageGray, 1)
get_grayval (ImageGray, Rows, Columns, Grayval)
set_object_model_3d_attrib_mod (ObjectModel3D, '&amp;gray', 'points', Grayval)
return ()",539,561,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], ObjectModel3D, Status)
get_grayval_in..."
64ae599d,micro,36,,"get_object_model_3d_params (ObjectModel3D, 'diameter', Diameter)",562,563,"* --- Automatically Added Context ---
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], ObjectModel3D, Status)
get_object_model_3d_params (OM3DModelTmp, 'diame..."
64ae599d,micro,37,,"sample_object_model_3d (ObjectModel3D, 'fast_compute_normals', Diameter * 0.01, [], [], SampledObjectModel3D)",564,565,"* --- Automatically Added Context ---
read_object_model_3d ('universal_joint_part/universal_joint_part_xyz_00.om3', 'm', [], [], ObjectModel3D, Status)
get_object_model_3d_params (OM3DModelTmp, 'diame..."
64ae599d,micro,38,,"get_object_model_3d_params (SampledObjectModel3D, 'point_normal_x', NX)
get_object_model_3d_params (SampledObjectModel3D, 'point_normal_y', NY)
get_object_model_3d_params (SampledObjectModel3D, 'point_normal_z', NZ)
get_object_model_3d_params (SampledObjectModel3D, 'point_coord_x', X)
get_object_mod...",566,572,"* --- Automatically Added Context ---
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_x', X)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_y', Y)
get_object_model_3d_para..."
64ae599d,micro,39,,"moments_object_model_3d (SampledObjectModel3D, 'mean_points', M)",573,574,"* --- Automatically Added Context ---
sample_object_model_3d (ObjectModel3D, 'fast_compute_normals', Diameter * 0.01, [], [], SampledObjectModel3D)
* --- End of Automatically Added Context ---"
64ae599d,micro,40,,"Test1 := mean(((X + NX * Diameter * 0.03) - M[0]) * ((X + NX * Diameter * 0.03) - M[0]) + ((Y + NY * Diameter * 0.03) - M[1]) * ((Y + NY * Diameter * 0.03) - M[1]) + ((Z + NZ * Diameter * 0.03) - M[2]) * ((Z + NZ * Diameter * 0.03) - M[2]))
Test2 := mean(((X - NX * Diameter * 0.03) - M[0]) * ((X - N...",575,577,"* --- Automatically Added Context ---
get_object_model_3d_params (OM3DModelTmp, 'diameter', Diameter)
get_object_model_3d_params (SmoothObject3DInCam, 'point_coord_x', X)
get_object_model_3d_params (S..."
64ae599d,micro,41,,"if (Test1 &lt; Test2)
InvertNormals := 'true'
else
InvertNormals := 'false'
endif
return ()",578,626,"* --- Automatically Added Context ---
test_normal_direction (ObjectModel3DCross, InvertNormals)
get_object_model_3d_params (OM3DModelTmp, 'diameter', Diameter)
get_object_model_3d_params (SmoothObject..."
5b7069bf,full,0,"This example shows how to efficiently perform a tracking task using
perspective deformable matching....","dev_update_off ()
dev_close_window ()
read_image (Image, 'automotive/engine_part_001')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (3)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
AngleExtent := 90
AngleExtentTracking := 20
Min...",13,106,
5b7069bf,micro,1,"perspective deformable matching. The basic idea is to speed up the
search by using the pose that was...","dev_update_off ()
dev_close_window ()
read_image (Image, 'automotive/engine_part_001')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_line_width (3)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)",6,20,
5b7069bf,micro,2,,"AngleExtent := 90
AngleExtentTracking := 20
MinScore := 0.4
MinScoreTracking := 0.5
TrackingRadius := 80
ScaleROffset := 0.1
ScaleCOffset := 0.0
Metric := 'use_polarity'
gen_cam_par_area_scan_division (12.0 / 1000, 0.0, (4.65 / 1000000) * 2, (4.65 / 1000000) * 2, 320, 256, 640, 512, CamParam)
read_r...",21,112,"* --- Automatically Added Context ---
read_image (Image, 'automotive/engine_part_001')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
dd6eabf2,full,0,"This example program shows how to use optical_flow_mg to compute the
optical flow in an image sequen...","dev_update_off ()
dev_close_window ()
read_image (Image1, 'xing/xing000')
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)
dev_set_paint (['vector_field', 6, 1, 2])
dev_set_draw ('margin')
for I := 1 to 95 by 1
read_image (Image2, 'xing/xing' + I$'03')
optical_flow_mg (Image1, Image2, ...",8,37,
dd6eabf2,micro,1,optical flow in an image sequence and how to segment the optical flow.,"dev_update_off ()
dev_close_window ()",6,9,
dd6eabf2,micro,2,,"read_image (Image1, 'xing/xing000')
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)",10,12,
dd6eabf2,micro,3,,"dev_set_paint (['vector_field', 6, 1, 2])
dev_set_draw ('margin')
for I := 1 to 95 by 1
read_image (Image2, 'xing/xing' + I$'03')
optical_flow_mg (Image1, Image2, VectorField, 'fdrig', 0.8, 1, 8, 5, 'default_parameters', 'accurate')
threshold (VectorField, Region, 1, 10000)
dev_display (Image2)
dev_...",13,43,"* --- Automatically Added Context ---
read_image (Image1, 'xing/xing000')
* --- End of Automatically Added Context ---"
03ff946c,full,0,"This example demonstrates the use of the optical flow for
the detection of moving objects in an imag...","dev_update_off ()
read_image (Image1, 'bicycle/bicycle_01')
ZoomFactor := 0.5
zoom_image_factor (Image1, Image1, ZoomFactor, ZoomFactor, 'constant')
dev_close_window ()
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
gen_contour_polygon_xld (ROI, [0, 0, 283, 34...",12,73,
03ff946c,micro,1,,"dev_update_off ()
read_image (Image1, 'bicycle/bicycle_01')
ZoomFactor := 0.5
zoom_image_factor (Image1, Image1, ZoomFactor, ZoomFactor, 'constant')
dev_close_window ()
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')",11,19,
03ff946c,micro,2,,"gen_contour_polygon_xld (ROI, [0, 0, 283, 348, 479, 479] * ZoomFactor, [0, 379, 379, 434, 639, 0] * ZoomFactor)
gen_region_contour_xld (ROI, RegionROI, 'filled')
reduce_domain (Image1, RegionROI, Image1ROI)",20,24,"* --- Automatically Added Context ---
read_image (Image1, 'bicycle/bicycle_01')
ZoomFactor := 0.5
* --- End of Automatically Added Context ---"
03ff946c,micro,3,,"for I := 2 to 27 by 1
read_image (Image2, 'bicycle/bicycle_' + I$'.2')
zoom_image_factor (Image2, Image2, ZoomFactor, ZoomFactor, 'constant')
reduce_domain (Image2, RegionROI, Image2ROI)
optical_flow_mg (Image1ROI, Image2ROI, VectorField, 'fdrig', 0.8, 1, 10, 5, ['default_parameters', 'warp_zoom_fac...",25,79,"* --- Automatically Added Context ---
ZoomFactor := 0.5
gen_region_contour_xld (ROI, RegionROI, 'filled')
reduce_domain (Image1, RegionROI, Image1ROI)
* --- End of Automatically Added Context ---"
c743ec84,full,0,"This example demonstrates the use of the optical flow operators.
By calculating the optical flow bet...","dev_update_off ()
dev_close_window ()
read_image (Image1, 'hydraulic_engineering/hydraulic_engineering_01')
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
RCenter := -1
CCenter := -1
MeanR := 0
MeanC := 0
tanDir := 0
ArrowLength := 15
MinLength := 0.375
for In...",10,70,
c743ec84,micro,1,"By calculating the optical flow between two images, the
position, speed, and movement direction of p...","dev_update_off ()
dev_close_window ()
read_image (Image1, 'hydraulic_engineering/hydraulic_engineering_01')
dev_open_window_fit_image (Image1, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
RCenter := -1
CCenter := -1
MeanR := 0
MeanC := 0
tanDir := 0
ArrowLength := 15
MinLength := 0.375
for In...",6,76,
f46ff93f,full,0,xing.hdev: Traffic monitoring (by Kalman filtering),"dev_update_off ()
dev_close_window ()
read_image (Image, 'xing/init')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_region (XingRegion, 'xing/xing_region')
dev_set_draw ('margin')
dev_set_c...",8,48,
f46ff93f,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'xing/init')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
read_region (XingRegion, 'xing/xing_region')
dev_set_draw ('margin')
dev_set_c...",6,54,
ea00fcb7,full,0,"This example shows the usage of a calibrated sheet-of-light
setup for surface comparison. In particu...","DisplayAlignmentResult := false
read_image (Disparity, 'sheet_of_light/injection_mold_01_disparity')
get_image_size (Disparity, Width, Height)
NumProfiles := Height
gen_rectangle1 (Rectangle, 0, 0, Height - 1, Width - 1)
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightModelID)
gen_cam_pa...",32,664,
ea00fcb7,micro,1,parameter DisplayAlignmentResult to true,DisplayAlignmentResult := false,30,33,
ea00fcb7,micro,2,and set the calibration information for the reconstruction.,"read_image (Disparity, 'sheet_of_light/injection_mold_01_disparity')
get_image_size (Disparity, Width, Height)
NumProfiles := Height
gen_rectangle1 (Rectangle, 0, 0, Height - 1, Width - 1)
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightModelID)",34,40,
ea00fcb7,micro,3,,"gen_cam_par_area_scan_division (0.016, -1250.34, 4.65114e-006, 4.65e-006, 623.43, 515.23, 1280, 1024, CameraParam)
create_pose (0.00139524828192, 0.00258352345828, 0.53764418409, 157.80940798, 359.84685912, 181.53116168, 'Rp+T', 'gba', 'point', CameraPose)
create_pose (-0.047567497224, -0.7309160250...",41,52,"* --- Automatically Added Context ---
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightModelID)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,4,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Disparity, 0, 0, 500, 480, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, Width1, Height1)
dev_open_window_fit_image (Disparity, 0, Width1 + 8, 500, 480, WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true...",53,62,"* --- Automatically Added Context ---
read_image (Disparity, 'sheet_of_light/injection_mold_01_disparity')
* --- End of Automatically Added Context ---"
ea00fcb7,micro,5,,"ErrorTypesText := ['unknown', 'additional hole', 'missing hole', 'hole too large', 'hole too small', 'wrong position', 'unknown (missing in test object)', 'unknown (missing in reference object)']
ErrorTypesColor := ['white', 'magenta', 'red', 'blue', 'yellow', 'cyan', 'white', 'white']",63,66,
ea00fcb7,micro,6,,"set_profile_sheet_of_light (Disparity, SheetOfLightModelID, [])",67,69,"* --- Automatically Added Context ---
read_image (Disparity, 'sheet_of_light/injection_mold_01_disparity')
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightModelID)
* --- End of Automatical..."
ea00fcb7,micro,7,,"get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, ReferenceOrig)",70,72,"* --- Automatically Added Context ---
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightModelID)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,8,,"select_points_object_model_3d (ReferenceOrig, 'point_coord_z', 0.0187, 1, Reference)",73,75,"* --- Automatically Added Context ---
get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, ReferenceOrig)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,9,,"create_surface_model (Reference, 0.02, [], [], SurfaceModelID)",76,78,"* --- Automatically Added Context ---
select_points_object_model_3d (ReferenceOrig, 'point_coord_z', 0.0187, 1, Reference)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,10,,"dev_clear_window ()
get_window_extents (WindowHandle1, Row2, Column2, Width2, Height2)
dev_set_part (0, 0, Height2 - 1, Width2 - 1)
Introduction := 'This example shows the usage of a calibrated'
Introduction[1] := 'sheet-of-light setup for surface comparison.'
Introduction[2] := 'In particular, in t...",79,94,"* --- Automatically Added Context ---
create_pose (0.00139524828192, 0.00258352345828, 0.53764418409, 157.80940798, 359.84685912, 181.53116168, 'Rp+T', 'gba', 'point', CameraPose)
dev_open_window_fit_..."
ea00fcb7,micro,11,test object,"dev_set_window (WindowHandle2)
get_window_extents (WindowHandle2, Row2, Column2, Width2, Height2)
dev_set_part (0, 0, Height2 - 1, Width2 - 1)
dev_clear_window ()
disp_object_model_3d (WindowHandle2, Reference, [], PoseDisplay, ['color', 'color_attrib'], ['gray', 'coord_z'])
disp_message (WindowHand...",95,103,"* --- Automatically Added Context ---
dev_open_window_fit_image (Disparity, 0, Width1 + 8, 500, 480, WindowHandle2)
select_points_object_model_3d (ReferenceOrig, 'point_coord_z', 0.0187, 1, Reference)..."
ea00fcb7,micro,12,,"NumScenes := 6
MaxDist := 0.001
for SceneIndex := 1 to NumScenes by 1
dev_set_window (WindowHandle1)
dev_clear_window ()
disp_message (WindowHandle1, 'Match test object with reference object ...', 'window', 12, 12, 'black', 'true')
read_image (Disparity, 'sheet_of_light/injection_mold_' + SceneIndex...",104,327,"* --- Automatically Added Context ---
DisplayAlignmentResult := false
read_image (Disparity, 'sheet_of_light/injection_mold_01_disparity')
create_sheet_of_light_model (Rectangle, [], [], SheetOfLightM..."
ea00fcb7,micro,13,,"IdxMax := sort_index(-fabs(N))[0]
Val := C / N[IdxMax]
PointOnPlane := [0, 0, 0]
PointOnPlane[IdxMax] := Val",328,332,"* --- Automatically Added Context ---
N := [NX,NY,NZ]
* --- End of Automatically Added Context ---"
ea00fcb7,micro,14,,"ZAxis := N
XAxis := [0, 0, 0]
XAxis[(IdxMax + 1) % 3] := -N[IdxMax]
cross_product (ZAxis, XAxis, YAxis)
HomMat3D[0:3] := [XAxis[0],YAxis[0],ZAxis[0],PointOnPlane[0]]
HomMat3D[4:7] := [XAxis[1],YAxis[1],ZAxis[1],PointOnPlane[1]]
HomMat3D[8:11] := [XAxis[2],YAxis[2],ZAxis[2],PointOnPlane[2]]
return ()",333,413,"* --- Automatically Added Context ---
N := [NX,NY,NZ]
IdxMax := sort_index(-fabs(N))[0]
PointOnPlane := [0, 0, 0]
* --- End of Automatically Added Context ---"
ea00fcb7,micro,15,,"get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
get_object_model_3d_params (ErrorObject, 'point_coord_y', Y)
get_object_model_3d_params (ErrorObject, 'point_coord_z', Z)",414,417,"* --- Automatically Added Context ---
ErrorObject := ErrorObjects[ErrorIndex]
ErrorObjects := [SurfacePointsMissingInTestObject,SurfacePointsMissingInReference]
for ErrorIndex := 0 to NumErrors - 1 by..."
ea00fcb7,micro,16,,"fit_plane (X, Y, Z, NX, NY, NZ, C)
hnf_to_hom_mat3d (NX, NY, NZ, C, HomMat3D)",418,420,"* --- Automatically Added Context ---
HomMat3D[0:3] := [XAxis[0],YAxis[0],ZAxis[0],PointOnPlane[0]]
get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
get_object_model_3d_params (ErrorObject..."
ea00fcb7,micro,17,,"affine_trans_point_3d (HomMat3D, X, Y, Z, Qx, Qy, Qz)",421,422,"* --- Automatically Added Context ---
HomMat3D[0:3] := [XAxis[0],YAxis[0],ZAxis[0],PointOnPlane[0]]
get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
get_object_model_3d_params (ErrorObject..."
ea00fcb7,micro,18,"- First, determine the necessary resolution","create_class_knn (2, KNNHandle)
Seq := [0:2:2 * |Qx| - 2]
Features[Seq] := Qx
Features[Seq + 1] := Qy
add_sample_class_knn (KNNHandle, Features, 0)
train_class_knn (KNNHandle, [], [])
set_params_class_knn (KNNHandle, ['method', 'k'], ['neighbors_distance', 4])
classify_class_knn (KNNHandle, Features...",423,443,"* --- Automatically Added Context ---
visualize_object_model_3d (WindowHandle1, [Reference,TestObjectTrans], [], PoseDisplay, ['color_0', 'color_1'], ['forest green', 'gray'], 'Result of surface based..."
ea00fcb7,micro,19,,"Rows := int((Qy - QyMin) / Resolution + 0.5)
Cols := int((Qx - QxMin) / Resolution + 0.5)
gen_region_points (RegionRaw, Rows, Cols)",444,447,"* --- Automatically Added Context ---
test_symmetry_object_model_3d (ErrorObjectsUnknownMIT[IndexMIT], ErrorObjectsUnknownMIR[IndexMIR], MaxHoleDiameter, Rating)
affine_trans_point_3d (HomMat3D, X, Y,..."
ea00fcb7,micro,20,,"dilation_circle (RegionRaw, Region, DilationRad)
return ()
Inspection := false",448,472,"* --- Automatically Added Context ---
create_region_from_error_points (Region, ErrorObject)
test_symmetry_object_model_3d (ErrorObjectsUnknownMIT[IndexMIT], ErrorObjectsUnknownMIR[IndexMIR], MaxHoleDi..."
ea00fcb7,micro,21,,"get_object_model_3d_params (OM1, 'point_coord_x', X1)
get_object_model_3d_params (OM1, 'point_coord_y', Y1)
get_object_model_3d_params (OM1, 'point_coord_z', Z1)
get_object_model_3d_params (OM2, 'point_coord_x', X2)
get_object_model_3d_params (OM2, 'point_coord_y', Y2)
get_object_model_3d_params (OM...",473,498,"* --- Automatically Added Context ---
find_surface_model (SurfaceModelID, TestObject, 0.02, 0.5, 0, 'false', 'pose_ref_sub_sampling', 1, Pose, Score, NotUsed)
test_symmetry_object_model_3d (ErrorObjec..."
ea00fcb7,micro,22,symmetry plane is the plane z=0,"hom_mat3d_invert (HomMat3D, HomMat3DInvert)
affine_trans_point_3d (HomMat3DInvert, X1, Y1, Z1, X1T, Y1T, Z1T)
affine_trans_point_3d (HomMat3DInvert, X2, Y2, Z2, X2T, Y2T, Z2T)",501,506,"* --- Automatically Added Context ---
get_object_model_3d_params (ErrorObjectsUnknownMIT[IndexMIT], 'point_coord_x', X1)
get_object_model_3d_params (ErrorObjectsUnknownMIT[IndexMIT], 'point_coord_y', ..."
ea00fcb7,micro,23,,"create_class_knn (3, KNN1)
Seq1 := [0:3:3 * |X1T| - 3]
Features1 := gen_tuple_const(3 * |X1T|,0)
Features1[Seq1] := X1T
Features1[Seq1 + 1] := Y1T
Features1[Seq1 + 2] := Z1T
add_sample_class_knn (KNN1, Features1, 0)
train_class_knn (KNN1, [], [])",507,516,"* --- Automatically Added Context ---
affine_trans_point_3d (HomMat3DInvert, X1, Y1, Z1, X1T, Y1T, Z1T)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,24,,"create_class_knn (3, KNN2)
Seq2 := [0:3:3 * |X2T| - 3]
Features2 := gen_tuple_const(3 * |X2T|,0)
Features2[Seq2] := X2T
Features2[Seq2 + 1] := Y2T
Features2[Seq2 + 2] := Z2T
add_sample_class_knn (KNN2, Features2, 0)
train_class_knn (KNN2, [], [])
set_params_class_knn (KNN2, ['method', 'k'], ['neighb...",517,527,"* --- Automatically Added Context ---
affine_trans_point_3d (HomMat3DInvert, X2, Y2, Z2, X2T, Y2T, Z2T)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,25,,"set_params_class_knn (KNN1, ['method', 'k'], ['neighbors_distance', 2])
classify_class_knn (KNN1, Features1, Result1, Rating1)
Rating1 := subset(Rating1,[1:2:|Rating1| - 1])",535,538,"* --- Automatically Added Context ---
affine_trans_point_3d (HomMat3DInvert, X1, Y1, Z1, X1T, Y1T, Z1T)
create_class_knn (3, KNN1)
Features1 := gen_tuple_const(3 * |X1T|,0)
* --- End of Automatically ..."
ea00fcb7,micro,26,,"set_params_class_knn (KNN2, ['method', 'k'], ['neighbors_distance', 2])
classify_class_knn (KNN2, Features2, Result2, Rating2)
Rating2 := subset(Rating2,[1:2:|Rating2| - 1])",539,542,"* --- Automatically Added Context ---
affine_trans_point_3d (HomMat3DInvert, X2, Y2, Z2, X2T, Y2T, Z2T)
create_class_knn (3, KNN2)
Features2 := gen_tuple_const(3 * |X2T|,0)
* --- End of Automatically ..."
ea00fcb7,micro,27,,"set_params_class_knn (KNN1, ['method', 'k'], ['neighbors_distance', 1])
Features1[Seq1 + 2] := -Z1T
classify_class_knn (KNN2, Features1, Result1In2, Rating1In2)",543,546,"* --- Automatically Added Context ---
affine_trans_point_3d (HomMat3DInvert, X1, Y1, Z1, X1T, Y1T, Z1T)
create_class_knn (3, KNN1)
Seq1 := [0:3:3 * |X1T| - 3]
Features1 := gen_tuple_const(3 * |X1T|,0)..."
ea00fcb7,micro,28,,"Features2[Seq2 + 2] := -Z2T
classify_class_knn (KNN1, Features2, Result2In1, Rating2In1)
MeanRating1 := mean(Rating1)
StdDevRating1 := deviation(Rating1)
MeanRating2 := mean(Rating2)
StdDevRating2 := deviation(Rating2)
PercBadRating2In1 := sum(Rating2In1 [&gt;] MeanRating1 + 3 * StdDevRating1) / rea...",547,595,"* --- Automatically Added Context ---
visualize_object_model_3d (WindowHandle2, Reference, [], PoseDisplay, ['color', 'color_attrib'], ['gray', 'coord_z'], Title, [], Instructions, PoseOut)
test_symme..."
ea00fcb7,micro,29,,Num := |X|,596,598,"* --- Automatically Added Context ---
get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,30,,"XM := mean(X)
YM := mean(Y)
ZM := mean(Z)",599,603,"* --- Automatically Added Context ---
get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
get_object_model_3d_params (ErrorObject, 'point_coord_y', Y)
get_object_model_3d_params (ErrorObject,..."
ea00fcb7,micro,31,,"DX := X - XM
DY := Y - YM
DZ := Z - ZM
MA11 := sum(DX * DX)
MA22 := sum(DY * DY)
MA33 := sum(DZ * DZ)
MA12 := sum(DX * DY)
MA13 := sum(DX * DZ)
MA23 := sum(DY * DZ)
create_matrix (3, 3, [MA11,MA12,MA13,MA12,MA22,MA23,MA13,MA23,MA33], MatrixID)",604,615,"* --- Automatically Added Context ---
get_object_model_3d_params (ErrorObject, 'point_coord_x', X)
get_object_model_3d_params (ErrorObject, 'point_coord_y', Y)
get_object_model_3d_params (ErrorObject,..."
ea00fcb7,micro,32,eigenvalue of the matrix MatrixID,"eigenvalues_symmetric_matrix (MatrixID, 'true', EigenvaluesID, EigenvectorsID)
get_value_matrix (EigenvectorsID, 0, 0, NX)
get_value_matrix (EigenvectorsID, 1, 0, NY)
get_value_matrix (EigenvectorsID, 2, 0, NZ)",616,622,"* --- Automatically Added Context ---
fit_plane (X, Y, Z, NX, NY, NZ, C)
create_matrix (3, 3, [MA11,MA12,MA13,MA12,MA22,MA23,MA13,MA23,MA33], MatrixID)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,33,,"C := NX * XM + NY * YM + NZ * ZM
if (C &lt; 0.0)
NX := -NX
NY := -NY
NZ := -NZ
C := -C
endif
return ()",623,660,"* --- Automatically Added Context ---
fit_plane (X, Y, Z, NX, NY, NZ, C)
XM := mean(X)
YM := mean(Y)
ZM := mean(Z)
* --- End of Automatically Added Context ---"
ea00fcb7,micro,34,Note that only the first three values of the given vectors are taken into account,"CrossProduct := [V1[1] * V2[2] - V1[2] * V2[1],V1[2] * V2[0] - V1[0] * V2[2],V1[0] * V2[1] - V1[1] * V2[0]]
return ()",661,679,
da88f878,full,0,"This example shows the usage of an uncalibrated
sheet of light setup for surface comparison.
The ins...","NumProfiles := 441
DisparityRange := 512
ProfileWidth := 626
get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'false')
gen_rectangle1 (Rectangle, 0, 0, DisparityRange - 1, ProfileWidth - 1)
set_system ('clip_region', ClipRegion)
create_sheet_of_light_model (Rectangle, 'calibration',...",32,202,
da88f878,micro,1,,"NumProfiles := 441
DisparityRange := 512
ProfileWidth := 626",31,34,
da88f878,micro,2,"Instead, they are obtained directly from the sheet-of-light
sensor. Nevertheless the profile width i...","get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'false')
gen_rectangle1 (Rectangle, 0, 0, DisparityRange - 1, ProfileWidth - 1)
set_system ('clip_region', ClipRegion)
create_sheet_of_light_model (Rectangle, 'calibration', 'offset_scale', SheetOfLightModelID)",35,43,"* --- Automatically Added Context ---
DisparityRange := 512
ProfileWidth := 626
* --- End of Automatically Added Context ---"
da88f878,micro,3,"of neighboring 3D points is approximately the same
as in the real object.","ScaleX := 2
ScaleY := 8
ScaleZ := 1
Clip := 435
set_sheet_of_light_param (SheetOfLightModelID, 'scale_x', ScaleX)
set_sheet_of_light_param (SheetOfLightModelID, 'scale_y', ScaleY)
set_sheet_of_light_param (SheetOfLightModelID, 'scale_z', ScaleZ)",44,55,"* --- Automatically Added Context ---
create_sheet_of_light_model (Rectangle, 'calibration', 'offset_scale', SheetOfLightModelID)
* --- End of Automatically Added Context ---"
da88f878,micro,4,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",60,65,"* --- Automatically Added Context ---
NumProfiles := 441
ProfileWidth := 626
* --- End of Automatically Added Context ---"
da88f878,micro,5,,"gen_image_const (Image, 'uint2', ProfileWidth, NumProfiles)",66,68,"* --- Automatically Added Context ---
NumProfiles := 441
ProfileWidth := 626
* --- End of Automatically Added Context ---"
da88f878,micro,6,the measured profiles in a sheet-of-light model.,"for Index := 0 to NumProfiles - 1 by 1
read_image (ImageModel, 'sheet_of_light/metal_part_1_disparity_line_' + Index$'03d')
set_profile_sheet_of_light (ImageModel, SheetOfLightModelID, [])
get_grayval (ImageModel, gen_tuple_const(ProfileWidth,0), [0:ProfileWidth - 1], Grayval)
set_grayval (Image, ge...",69,87,"* --- Automatically Added Context ---
NumProfiles := 441
ProfileWidth := 626
create_sheet_of_light_model (Rectangle, 'calibration', 'offset_scale', SheetOfLightModelID)
dev_open_window_fit_size (0, 0,..."
da88f878,micro,7,"Prepare reference object for a more robust
surface comparison
**************************************...","Message := 'Prepare the model for distance measurement ...'
disp_message (WindowHandle, Message, 'window', 60, 12, 'black', 'true')
Status := ' ... triangulate object ...'
Status[1] := ' ... subsample object ...'
Status[2] := ' ... create surface model for alignment ...'",88,97,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
Message := 'Measure reference object'
* --- End of Automatically Added Context --..."
da88f878,micro,8,,"get_sheet_of_light_result_object_model_3d (SheetOfLightModelID, Model3DAll)
select_points_object_model_3d (Model3DAll, 'point_coord_z', Clip, 800, Model3D)",98,101,"* --- Automatically Added Context ---
create_sheet_of_light_model (Rectangle, 'calibration', 'offset_scale', SheetOfLightModelID)
Clip := 435
* --- End of Automatically Added Context ---"
da88f878,micro,9,,"disp_message (WindowHandle, Status[0], 'window', 100, 12, 'white', 'false')
surface_normals_object_model_3d (Model3D, 'mls', 'mls_force_inwards', 'true', ObjectModel3DNormals)
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small_surfaces', 200, TriangulatedObjectModel3D,...",107,110,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
Status := ' ... triangulate object ...'
select_points_object_model_3d (Model3DAll..."
da88f878,micro,10,,"disp_message (WindowHandle, [Status[0] + ' ready.',Status[1]], 'window', 100, 12, 'white', 'false')
max_diameter_object_model_3d (TriangulatedObjectModel3D, Diameter)
sample_object_model_3d (TriangulatedObjectModel3D, 'fast', Diameter * 0.002, [], [], Model3DSampled)
disp_message (WindowHandle, [Sta...",111,116,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
Status := ' ... triangulate object ...'
triangulate_object_model_3d (ObjectModel3..."
da88f878,micro,11,,"create_surface_model (TriangulatedObjectModel3D, 0.03, 'model_invert_normals', 'true', SurfaceModelID)",117,118,"* --- Automatically Added Context ---
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small_surfaces', 200, TriangulatedObjectModel3D, Information)
* --- End of Automatical..."
da88f878,micro,12,,"Message := Message + ' ready.'
disp_message (WindowHandle, Status + ' ready.', 'window', 100, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",119,123,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
Message := 'Measure reference object'
Status := ' ... triangulate object ...'
* -..."
da88f878,micro,13,,"dev_clear_window ()
create_pose (1100, 1300, 35000, 140, 350, 55, 'Rp+T', 'gba', 'point', PoseDisplay)
Title := 'Reference object (uncalibrated measurement)'
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
vis...",124,133,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, ProfileWidth, NumProfiles, -1, -1, WindowHandle)
triangulate_object_model_3d (ObjectModel3DNormals, 'greedy', 'greedy_remove_small..."
da88f878,micro,14,"Perform a surface comparison on a number of objects
************************************************...","NumScenes := 4
for SceneIndex := 1 to NumScenes by 1
reset_sheet_of_light_model (SheetOfLightModelID)
gen_image_const (Image, 'uint2', ProfileWidth, NumProfiles)
for Index := 0 to NumProfiles - 1 by 1
read_image (ImageSearch, 'sheet_of_light/metal_part_' + (SceneIndex + 1) + '_disparity_line_' + Ind...",134,208,"* --- Automatically Added Context ---
NumProfiles := 441
ProfileWidth := 626
create_sheet_of_light_model (Rectangle, 'calibration', 'offset_scale', SheetOfLightModelID)
ScaleY := 8
Clip := 435
dev_ope..."
c6295cd6,full,0,"This program demonstrates how to detect small texture
defects on the surface of plastic items by usi...","dev_update_off ()
dev_close_window ()
read_image (Image, 'plastics/plastics_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colo...",16,78,
c6295cd6,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'plastics/plastics_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colo...",15,25,
c6295cd6,micro,2,,"optimize_rft_speed (Width, Height, 'standard')",26,28,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
c6295cd6,micro,3,filters,"Sigma1 := 10.0
Sigma2 := 3.0
gen_gauss_filter (GaussFilter1, Sigma1, Sigma1, 0.0, 'none', 'rft', Width, Height)
gen_gauss_filter (GaussFilter2, Sigma2, Sigma2, 0.0, 'none', 'rft', Width, Height)
sub_image (GaussFilter1, GaussFilter2, Filter, 1, 0)",29,36,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
c6295cd6,micro,4,,"NumImages := 11
for Index := 1 to NumImages by 1
read_image (Image, 'plastics/plastics_' + Index$'02')
rgb1_to_gray (Image, Image)
rft_generic (Image, ImageFFT, 'to_freq', 'none', 'complex', Width)
convol_fft (ImageFFT, Filter, ImageConvol)
rft_generic (ImageConvol, ImageFiltered, 'from_freq', 'n', ...",37,84,"* --- Automatically Added Context ---
read_image (Image, 'plastics/plastics_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
sub_image (GaussFilt..."
b6470d3e,full,0,"this example shows how to detect mura defects
in blurred images","dev_close_window ()
dev_update_off ()
Path := 'lcd/mura_defects_blur_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev...",9,47,
b6470d3e,micro,1,in blurred images,"dev_close_window ()
dev_update_off ()
Path := 'lcd/mura_defects_blur_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 640, 480, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev...",6,53,
a6744796,full,0,"This example shows how to detect mura defects
in highly textured images","dev_close_window ()
dev_update_off ()
Path := 'lcd/mura_defects_texture_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_wi...",9,65,
a6744796,micro,1,in highly textured images,"dev_close_window ()
dev_update_off ()
Path := 'lcd/mura_defects_texture_'
read_image (Image, Path + '01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_wi...",6,74,
de7185fd,full,0,"Determine the orientation of the light sources (tilt
and slant values) of a photometric stereo setup...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 494, 500, 500, WindowHandle)
Color := 'green'
dev_set_color (Color)
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ApproxSphereRadius := 200
ImageFiles := 'photomet...",11,357,
de7185fd,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 494, 500, 500, WindowHandle)
Color := 'green'
dev_set_color (Color)
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ApproxSphereRadius := 200",10,20,
de7185fd,micro,2,,"ImageFiles := 'photometric_stereo/shaded_sphere_' + [1:6]$'02'
read_image (Images, ImageFiles)
channels_to_image (Images, MultiChannelImage)
count_channels (MultiChannelImage, NumImages)
dev_display (Images)",21,27,
de7185fd,micro,3,from the multichannel image.,"disp_message (WindowHandle, 'Detect the position of the sphere ...', 'window', 12, 12, 'black', 'true')
gen_circle_contour_xld (ContourCircle, 200, 200, ApproxSphereRadius, 0, 6.28318, 'positive', 1)
create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'iso_scale_min', 0.9)
s...",28,53,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 494, 500, 500, WindowHandle)
Color := 'green'
ApproxSphereRadius := 200
channels_to_image (Images, MultiChannelImage)
* --- E..."
de7185fd,micro,4,"1. The background of the scene is excluded from
processing.
2. Overexposed and underexposed parts of...","MinGray := 170
MaxGray := 255
measure_light_source_orientation_from_sphere (MultiChannelImage, RadiusSphere, RowSphere, ColumnSphere, MinGray, MaxGray, Tilt, Slant)",57,68,"* --- Automatically Added Context ---
ApproxSphereRadius := 200
channels_to_image (Images, MultiChannelImage)
get_generic_shape_model_result (MatchResultID, 'best', 'row', RowSphere)
get_generic_shape..."
de7185fd,micro,5,,"get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle2)
dev_set_part (0, 0, 493, 639)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
PointO := [RowSphere,ColumnSphere]
PointE := PointO + [0,RadiusSphere + 10]...",69,128,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 494, 500, 500, WindowHandle)
Color := 'green'
ApproxSphereRadius := 200
channels_to_image (Images, MultiChannelImage)
count_c..."
de7185fd,micro,6,"the normals at each point. These normals are used for
visualization.
Typically, metric measurements ...","ResultType := 'normalized_surface_normal'
photometric_stereo (Images, HeightField, Gradient, Albedo, Slant, Tilt, ResultType, 'poisson', [], [])",129,140,"* --- Automatically Added Context ---
read_image (Images, ImageFiles)
measure_light_source_orientation_from_sphere (MultiChannelImage, RadiusSphere, RowSphere, ColumnSphere, MinGray, MaxGray, Tilt, Sl..."
de7185fd,micro,7,"which is returned in Gradient with the option
'normalized_surface_normal'.","vector_field_to_real (Gradient, NY, NX)
get_image_size (NX, Width, Height)",141,146,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, Width, Height)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slant, Tilt, ResultType, 'poisson', [], [..."
de7185fd,micro,8,"1 = sqrt(NX*NX + NY*NY + NZ*NZ)
NZ = sqrt(1- NX*NX - NY*NY)","mult_image (NY, NY, NYSQ, 1, 0)
mult_image (NX, NX, NXSQ, 1, 0)
gen_image_proto (NXSQ, One, 1.0)
sub_image (One, NXSQ, ImageSub, 1, 0)
sub_image (ImageSub, NYSQ, ImageNZSQ, 1, 0)
sqrt_image (ImageNZSQ, NZ)",148,158,"* --- Automatically Added Context ---
vector_field_to_real (Gradient, NY, NX)
* --- End of Automatically Added Context ---"
de7185fd,micro,9,,"compose3 (NX, NY, NZ, NormalColorImage)
dev_set_window (WindowHandle2)
dev_close_window ()
dev_set_window (WindowHandle)
dev_display (NormalColorImage)
dev_disp_text ('The surface normals encoded in color.', 'window', 12, 12, 'black', [], [])
stop ()",159,167,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 494, 500, 500, WindowHandle)
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle2)
vector_field_to_real (Gra..."
de7185fd,micro,10,and the z-axis.,"acos_image (NZ, AngleRadImage)
scale_image (AngleRadImage, AngleDegImage, 180 / rad(180), 0)
dev_display (AngleDegImage)
dev_disp_text ('The angle between surface normals and z axis in degree.', 'window', 12, 12, 'black', [], [])
stop ()",168,197,"* --- Automatically Added Context ---
sqrt_image (ImageNZSQ, NZ)
dev_disp_text ('The surface normals encoded in color.', 'window', 12, 12, 'black', [], [])
* --- End of Automatically Added Context ---"
de7185fd,micro,11,the surface of the sphere,"get_image_size (ShadeImages, Width, Height)
compute_sphere_heights_and_normal_vectors (Heights, NormalVectors, Radius, RowCenter, ColumnCenter, Width, Height)",220,224,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, Width, Height)
* --- End of Automatically Added Context ---"
de7185fd,micro,12,,"threshold (Heights, Region, 0.01, 1.2 * Radius)
reduce_domain (Heights, Region, Heights)
reduce_domain (NormalVectors, Region, NormalVectors)",231,235,"* --- Automatically Added Context ---
compute_sphere_heights_and_normal_vectors (Heights, NormalVectors, Radius, RowCenter, ColumnCenter, Width, Height)
* --- End of Automatically Added Context ---"
de7185fd,micro,13,,"count_channels (ShadeImages, NumChannels)
Tilts := []
Slants := []
for Index := 1 to NumChannels by 1
access_channel (ShadeImages, ShadeImage, Index)
reduce_domain (ShadeImage, Region, ShadeImage)
threshold (ShadeImage, RegionShade, MinGray, MaxGray)
get_region_points (RegionShade, Rows, Columns)
ge...",236,314,"* --- Automatically Added Context ---
MinGray := 170
MaxGray := 255
measure_light_source_orientation_from_sphere (MultiChannelImage, RadiusSphere, RowSphere, ColumnSphere, MinGray, MaxGray, Tilt, Slan..."
de7185fd,micro,14,the coordinates of the center,"gen_image_surface_second_order (Parabola, 'real', -1, -1, 0, 0, 0, Radius * Radius, RowCenter, ColumnCenter, ImageWidth, ImageHeight)
sqrt_image (Parabola, SphereHeight)",336,339,"* --- Automatically Added Context ---
compute_sphere_heights_and_normal_vectors (Heights, NormalVectors, Radius, RowCenter, ColumnCenter, Width, Height)
* --- End of Automatically Added Context ---"
de7185fd,micro,15,,"gen_image_surface_first_order (dX, 'real', 0, 1, 0, 0, ColumnCenter, ImageWidth, ImageHeight)
gen_image_surface_first_order (dY, 'real', -1, 0, 0, RowCenter, 0, ImageWidth, ImageHeight)
threshold (SphereHeight, Region, .01, 1.2 * Radius)
reduce_domain (dX, Region, dXReduced)
reduce_domain (dY, Regio...",340,371,"* --- Automatically Added Context ---
compute_sphere_heights_and_normal_vectors (Heights, NormalVectors, Radius, RowCenter, ColumnCenter, Width, Height)
threshold (Heights, Region, 0.01, 1.2 * Radius)..."
04c2df12,full,0,"This program demonstrates the use of the photometric stereo technique
for the inspection of the back...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the backside of a blister'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light orienta...",12,84,
04c2df12,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the backside of a blister'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light orienta...",11,22,
04c2df12,micro,2,,"read_image (Images, 'photometric_stereo/blister_back_0' + [1:4])
for I := 1 to 4 by 1
Message := 'Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor",23,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Message := 'Inspect the backside of a blister'
* --- End of Automatically Added Context ---"
04c2df12,micro,3,and the surface gradient.,"Tilts := [6.1, 95.0, -176.1, -86.8]
Slants := [41.4, 42.6, 41.7, 40.9]
ResultType := ['gradient', 'albedo']
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])",33,39,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/blister_back_0' + [1:4])
* --- End of Automatically Added Context ---"
04c2df12,micro,4,,"dev_display (Albedo)
disp_message (WindowHandle, 'Albedo image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",40,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
*..."
04c2df12,micro,5,"using the gradient field as input for the operator
derivate_vector_field.
Defects are usually easy t...","derivate_vector_field (Gradient, GaussCurvature, 1, 'gauss_curvature')",46,51,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
04c2df12,micro,6,,"regiongrowing (GaussCurvature, Regions, 1, 1, 0.001, 250)
select_shape (Regions, TabletRegions, ['width', 'height'], 'and', [150, 150], [200, 200])
shape_trans (TabletRegions, TabletRegions, 'convex')
union1 (TabletRegions, TabletRegions)
erosion_circle (TabletRegions, TabletRegions, 3.5)",54,59,"* --- Automatically Added Context ---
derivate_vector_field (Gradient, GaussCurvature, 1, 'gauss_curvature')
* --- End of Automatically Added Context ---"
04c2df12,micro,7,,"reduce_domain (GaussCurvature, TabletRegions, ImageReduced)
abs_image (ImageReduced, ImageAbs)
threshold (ImageAbs, Region, 0.03, 255)
closing_circle (Region, RegionClosing, 10.5)
connection (RegionClosing, ConnectedRegions)
select_shape (ConnectedRegions, Defects, 'area', 'and', 10, 99999)
area_cen...",60,68,"* --- Automatically Added Context ---
derivate_vector_field (Gradient, GaussCurvature, 1, 'gauss_curvature')
select_shape (Regions, TabletRegions, ['width', 'height'], 'and', [150, 150], [200, 200])
*..."
04c2df12,micro,8,,"dev_set_draw ('margin')
dev_set_color ('red')
dev_set_line_width (2)
dev_display (GaussCurvature)
dev_display (Circle)
Message := 'The defect can easily be detected'
Message[1] := 'in the surface curvature image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",69,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Message := 'Inspect the backside of a blister'
derivate_vector_field (Gradient, GaussCurvature, 1, 'gauss_..."
04c2df12,micro,9,,"dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Albedo)
dev_display (Circle)
disp_message (WindowHandle, 'Defect in albedo image', 'window', 12, 12, 'black', 'true')",79,90,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
g..."
3c44ec1c,full,0,"This program demonstrates the use of the photometric stereo technique
for the inspection of the floo...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the label of flooring panels'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light orie...",12,80,
3c44ec1c,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the label of flooring panels'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light orie...",11,86,
c061e295,full,0,"This program demonstrates the use of the
uncalibrated photometric stereo technique
for the inspectio...","dev_close_window ()
dev_update_off ()
read_image (Image, 'photometric_stereo/flooring_1_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
Text := 'Use uncalibrated photometric stereo to detect surface d...",15,73,
c061e295,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'photometric_stereo/flooring_1_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",14,20,
c061e295,micro,2,,"dev_display (Image)
Text := 'Use uncalibrated photometric stereo to detect surface defects.'
Text[1] := 'For this setup, no prior calibration was used, e.g., '
Text[2] := 'the tilts and slants of the light source are not specified.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
dev_...",21,29,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/flooring_1_01')
* --- End of Automatically Added Context ---"
c061e295,micro,3,,"for Index := 1 to 2 by 1
read_image (Images, 'photometric_stereo/flooring_' + Index + '_0' + [1:4])
for I := 1 to 4 by 1
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
Text := 'Acquire image ' + I + ' of 4.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
wait_sec...",30,79,"* --- Automatically Added Context ---
Text := 'Use uncalibrated photometric stereo to detect surface defects.'
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], []..."
65ed24d3,full,0,"This program demonstrates the use of the photometric stereo technique
for the inspection of leather ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect leather samples using photometric stereo'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_contin...",12,151,
65ed24d3,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect leather samples using photometric stereo'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_contin...",11,20,
65ed24d3,micro,2,,"read_image (Images, 'photometric_stereo/leather_1_0' + [1:4])
for I := 1 to 4 by 1
Message := 'Sample 1: Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor",23,33,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Inspect leather samples using photometric stereo'
* --- End of Automatically Added Context ---"
65ed24d3,micro,3,,"Tilts := [6.1, 95.0, -176.1, -86.8]
Slants := [41.4, 42.6, 41.7, 40.9]
ResultType := ['gradient', 'albedo']
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])",34,39,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/leather_1_0' + [1:4])
* --- End of Automatically Added Context ---"
65ed24d3,micro,4,,"dev_display (Albedo)
disp_message (WindowHandle, 'The defect is clearly visible in the albedo image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",40,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
*..."
65ed24d3,micro,5,,"var_threshold (Albedo, Region, 15, 15, 0.4, 0.4, 'light')
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10, 99999)
union1 (SelectedRegions, RegionUnion)
closing_circle (RegionUnion, RegionClosing, 3.5)
connection (RegionClosing, Defects)
area_c...",46,55,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
65ed24d3,micro,6,,"dev_display (Albedo)
dev_set_color ('red')
dev_set_draw ('margin')
dev_set_line_width (4)
dev_display (Circle)
disp_message (WindowHandle, 'Albedo image with defect', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",56,65,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
g..."
65ed24d3,micro,7,,"read_image (Images, 'photometric_stereo/leather_2_0' + [1:4])
for I := 1 to 4 by 1
Message := 'Sample 2: Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor",68,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Inspect leather samples using photometric stereo'
read_image (Images, 'photometric_stereo/leat..."
65ed24d3,micro,8,,"photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
threshold (Albedo, Region1, 128, 255)",79,82,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/leather_1_0' + [1:4])
Tilts := [6.1, 95.0, -176.1, -86.8]
Slants := [41.4, 42.6, 41.7, 40.9]
ResultType := ['gradient', 'a..."
65ed24d3,micro,9,,"dev_display (Albedo)
Message := 'These defects are difficult to detect in the albedo image.'
Message[1] := 'Therefore, we use the gradient information to detect them.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop (...",83,90,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Inspect leather samples using photometric stereo'
photometric_stereo (Images, HeightField, Gra..."
65ed24d3,micro,10,We are looking for areas with little surface changes.,"derivate_vector_field (Gradient, Curl, 1, 'curl')
derivate_gauss (Curl, CurlGradient, 1, 'gradient')",91,96,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
65ed24d3,micro,11,,"dev_display (CurlGradient)
Message := 'Changes in the gradient curl'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",97,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Inspect leather samples using photometric stereo'
derivate_gauss (Curl, CurlGradient, 1, 'grad..."
65ed24d3,micro,12,,"threshold (CurlGradient, Region, 0, 0.01)
rank_region (Region, RegionCount, 10, 10, 30)
connection (RegionCount, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 2000, 99999)
union1 (SelectedRegions, RegionUnion)
rank_region (RegionUnion, RegionCount1, 25, 25, 170)
c...",104,112,"* --- Automatically Added Context ---
var_threshold (Albedo, Region, 15, 15, 0.4, 0.4, 'light')
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10..."
65ed24d3,micro,13,,"dev_display (Albedo)
dev_set_draw ('margin')
dev_set_color ('red')
dev_set_line_width (3)
dev_display (NoTextured)
disp_message (WindowHandle, 'Non-textured areas on leather', 'window', 12, 12, 'black', 'true')
stop ()",113,121,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
c..."
65ed24d3,micro,14,We are looking for areas with high curvature,"derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')",122,126,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
65ed24d3,micro,15,,"dev_display (MeanCurvature)
Message := 'Mean curvature of the surface'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Press F5', 'image', 720, 850, 'black', 'true')
stop ()",127,133,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Inspect leather samples using photometric stereo'
derivate_vector_field (Gradient, MeanCurvatu..."
65ed24d3,micro,16,,"abs_image (MeanCurvature, ImageAbs)
threshold (ImageAbs, Region2, 0.15, 255)
connection (Region2, ConnectedRegions1)
select_shape (ConnectedRegions1, SelectedRegions1, 'area', 'and', 10, 99999)
union1 (SelectedRegions1, RegionUnion1)
closing_circle (RegionUnion1, RegionClosing, 1.5)
connection (Regi...",134,144,"* --- Automatically Added Context ---
closing_circle (RegionUnion, RegionClosing, 3.5)
derivate_vector_field (Gradient, MeanCurvature, 1, 'mean_curvature')
* --- End of Automatically Added Context ---"
65ed24d3,micro,17,,"dev_display (Albedo)
dev_set_draw ('margin')
dev_set_color ('red')
dev_set_line_width (3)
dev_display (SelectedRegions3)
disp_message (WindowHandle, 'Deep scratch', 'window', 12, 12, 'black', 'true')",145,157,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
s..."
42282bbb,full,0,"This program demonstrates the use of the photometric stereo technique
for the inspection of the labe...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the label of a shampoo bottle'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light ori...",12,75,
42282bbb,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'Inspect the label of a shampoo bottle'
Message[1] := 'using photometric stereo. In this case four'
Message[2] := 'different light ori...",11,22,
42282bbb,micro,2,,"read_image (Images, 'photometric_stereo/shampoo_label_0' + [1:4])
for I := 1 to 4 by 1
Message := 'Acquire image ' + I + ' of 4'
select_obj (Images, ObjectSelected, I)
dev_display (ObjectSelected)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
endfor",23,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
Message := 'Inspect the label of a shampoo bottle'
* --- End of Automatically Added Context ---"
42282bbb,micro,3,and the surface gradient.,"Tilts := [6.1, 95.0, -176.1, -86.8]
Slants := [41.4, 42.6, 41.7, 40.9]
ResultType := ['gradient', 'albedo']
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])",33,39,"* --- Automatically Added Context ---
read_image (Images, 'photometric_stereo/shampoo_label_0' + [1:4])
* --- End of Automatically Added Context ---"
42282bbb,micro,4,,"dev_display (Albedo)
disp_message (WindowHandle, 'Albedo image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",40,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
*..."
42282bbb,micro,5,"using the gradient field as input for the operator
derivate_vector_field.
Defects are usually easy t...","derivate_vector_field (Gradient, MeanCurvature, 1.0, 'mean_curvature')",46,51,"* --- Automatically Added Context ---
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
* --- End of Automatically Added Context ---"
42282bbb,micro,6,,"threshold (MeanCurvature, Region, -10, -0.07)
opening_circle (Region, RegionOpening, 1)
connection (RegionOpening, ConnectedRegions)
select_shape (ConnectedRegions, Defects, 'area', 'and', 50, 99999)
shape_trans (Defects, Circle, 'outer_circle')",54,59,"* --- Automatically Added Context ---
derivate_vector_field (Gradient, MeanCurvature, 1.0, 'mean_curvature')
* --- End of Automatically Added Context ---"
42282bbb,micro,7,,"dev_set_draw ('margin')
dev_set_color ('red')
dev_set_line_width (2)
dev_display (MeanCurvature)
dev_display (Circle)
Message := 'The defect can easily be detected'
Message[1] := 'in the surface curvature image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",60,69,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
Message := 'Inspect the label of a shampoo bottle'
derivate_vector_field (Gradient, MeanCurvature, 1.0, 'm..."
42282bbb,micro,8,,"dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Albedo)
dev_display (Circle)
disp_message (WindowHandle, 'Defect in albedo image', 'window', 12, 12, 'black', 'true')",70,81,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
photometric_stereo (Images, HeightField, Gradient, Albedo, Slants, Tilts, ResultType, 'poisson', [], [])
s..."
9f0e7a37,full,0,"This program shows how to separate foreground information
from a disturbing background texture by fi...","dev_update_off ()
dev_close_window ()
Scale := [1.0, .65]
MinGray := [50, 100]
for Index := 0 to 1 by 1
read_image (Image, 'plan_' + (Index + 1)$'02')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * Scale[Index], Height * Scale[Index], 'black', WindowHandle)
set_display_font (Wi...",18,136,
9f0e7a37,micro,1,"from a disturbing background texture by filtering in the
frequency domain.
First, the image is Fouri...","dev_update_off ()
dev_close_window ()
Scale := [1.0, .65]
MinGray := [50, 100]
for Index := 0 to 1 by 1
read_image (Image, 'plan_' + (Index + 1)$'02')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * Scale[Index], Height * Scale[Index], 'black', WindowHandle)
set_display_font (Wi...",6,121,
9f0e7a37,micro,2,"WindowHandle: The window, where the text shall be displayed
Color: defines the text color.
If set to...","ContinueMessage := 'Press Run (F5) to continue'
get_window_extents (WindowHandle, Row, Column, Width, Height)
get_string_extents (WindowHandle, ' ' + ContinueMessage + ' ', Ascent, Descent, TextWidth, TextHeight)
disp_message (WindowHandle, ContinueMessage, 'window', Height - TextHeight - 6, Width -...",126,244,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * Scale[Index], Height * Scale[Index], 'black', WindowHandle)
* --- End of Automatically Added ..."
0566f96d,full,0,"This program shows how to separate foreground information
from a disturbing background texture using...","dev_update_off ()
dev_close_window ()
NumImages := 2
for Index := 1 to NumImages by 1
read_image (Image, 'plan_' + Index$'02')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'O...",9,56,
0566f96d,micro,1,from a disturbing background texture using a guided filter.,"dev_update_off ()
dev_close_window ()
NumImages := 2
for Index := 1 to NumImages by 1
read_image (Image, 'plan_' + Index$'02')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'O...",6,62,
1e9104c7,full,0,"This example shows an application case from the automobile
industry. A monitoring system in a car ch...","dev_close_window ()
read_image (ImageInit, 'road_signs/street_01')
dev_open_window_fit_image (ImageInit, 0, 0, -1, -1, WindowHandle)
dev_update_off ()
dev_set_line_width (2)
dev_set_color ('green')
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Channel := [3, 1]...",14,156,
1e9104c7,micro,1,"industry. A monitoring system in a car checks the sidewalk
for road signs to support the driver in c...",dev_close_window (),6,14,
1e9104c7,micro,2,"While the attention sign is from a synthetic source,
the model for the dead end sign is from another...","read_image (ImageInit, 'road_signs/street_01')
dev_open_window_fit_image (ImageInit, 0, 0, -1, -1, WindowHandle)
dev_update_off ()
dev_set_line_width (2)
dev_set_color ('green')
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",15,26,
1e9104c7,micro,3,"The Attention sign has a significant red part, the
dead end sign a blue one. Hence, we can extract t...","Channel := [3, 1]",27,31,
1e9104c7,micro,4,,"ScaleRMin := [0.5, 0.4]
ScaleRMax := [0.8, 2.0]",32,34,
1e9104c7,micro,5,"However, this makes the detection slower and is not required here.","ScaleCMin := [1.0, 1.0]
ScaleCMax := [1.0, 1.0]",35,38,
1e9104c7,micro,6,,"RoadSign := ['Attention', 'Dead end']
HFac := [47.0, 50.0]",39,42,
1e9104c7,micro,7,creation process.,"access_channel (ImageAttentionSign, Image, Channel[0])
zoom_image_factor (Image, ImageZoomed, 0.1, 0.1, 'weighted')
inspect_shape_model (ImageZoomed, ModelImages, ModelRegions, 3, 20)
create_planar_uncalib_deformable_model (ImageZoomed, 3, [], [], 0.1, ScaleRMin[0], [], 0.05, ScaleCMin[0], [], 0.5, ...",43,60,"* --- Automatically Added Context ---
Channel := [3, 1]
ScaleRMin := [0.5, 0.4]
ScaleCMin := [1.0, 1.0]
* --- End of Automatically Added Context ---"
1e9104c7,micro,8,"query specific parameters of a model.
Practically, the derived information is not needed
within the ...","get_deformable_model_params (ModelID, 'angle_step', AngleStep)
get_deformable_model_params (ModelID, 'scale_r_step', ScaleRStep)
Models := [Models,ModelID]",61,68,"* --- Automatically Added Context ---
create_planar_uncalib_deformable_model (ImageZoomed, 3, [], [], 0.1, ScaleRMin[0], [], 0.05, ScaleCMin[0], [], 0.5, 'none', 'use_polarity', 'auto', 'auto', [], []..."
1e9104c7,micro,9,"We can discard not significant parts of the image, in which
no road sign can be located.","gen_rectangle1 (Rectangle, 115, 0, 360, 640)",69,73,
1e9104c7,micro,10,,"OutputString := []
TotalTime := 0
determine_area_of_interest (Image, Rectangle, AreaOfInterest)
reduce_domain (Image, AreaOfInterest, ImageReduced)
dev_display (Image)
for Index2 := 0 to |Models| - 1 by 1
access_channel (ImageReduced, ImageChannel, Channel[Index2])
count_seconds (Time1)
find_planar_...",74,166,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageInit, 0, 0, -1, -1, WindowHandle)
Channel := [3, 1]
ScaleRMin := [0.5, 0.4]
ScaleRMax := [0.8, 2.0]
ScaleCMin := [1.0, 1.0]
ScaleC..."
32fcbc8b,full,0,"************************************************************
This example illustrates a wafer inspec...","dev_update_off ()
dev_close_window ()
list_image_files ('wafer', '.png', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'wafer_[0-9]{2}.png')
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)
initialize_visualization_windows (ImageWidth / 4, ImageHeigh...",33,1100,
32fcbc8b,micro,1,,"dev_update_off ()
dev_close_window ()",32,34,
32fcbc8b,micro,2,,"list_image_files ('wafer', '.png', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'wafer_[0-9]{2}.png')
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)",35,40,
32fcbc8b,micro,3,,"initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
visualize_image_data (ImageInit, ImageWindowHandle, TextWindowHandle, WaferMapWindowHandle)
stop ()",41,45,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,4,,"dev_set_window (WaferMapWindowHandle)
dev_close_window ()",46,50,"* --- Automatically Added Context ---
visualize_image_data (ImageInit, ImageWindowHandle, TextWindowHandle, WaferMapWindowHandle)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,5,variation model.,"get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
display_matching_introduction (ImageInit, ChipRegion, ImageWidth, ImageHeight, ImageWindowHandle, TextWindowHandle)
stop ()",55,61,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, Image..."
32fcbc8b,micro,6,"train_generic_shape_model_sample_workflow.hdev
for further details on extended parameter estimation.","dev_set_window (TextWindowHandle)
dev_clear_window ()
dev_disp_text ('Training shape model...', 'window', 'top', 'left', 'black', [], [])",66,73,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
* --- End of Automatically Added Cont..."
32fcbc8b,micro,7,parameter estimation.,"NumTrainingSamples := 10
generate_training_samples (ImageFiles, NumTrainingSamples, TrainingSamples)
prepare_and_train_matching_model (TemplateImage, TrainingSamples, MatchingModelID)",74,79,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
* --- ..."
32fcbc8b,micro,8,,"visualize_matching_model_contours (ImageInit, MatchingRegion, MatchingModelID, ImageWindowHandle, TextWindowHandle)
stop ()",80,83,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)..."
32fcbc8b,micro,9,"3. Prepare the Variation Model (offline step)              *
***************************************...","display_variation_model_introduction (ImageInit, ImageWindowHandle, TextWindowHandle)
stop ()
dev_close_window ()
dev_set_window (ImageWindowHandle)
dev_close_window ()
get_region_size (ChipRegion, ChipWidth, ChipHeight)
initialize_visualization_windows (ChipWidth / 2, ChipHeight / 2, ImageWidth / 6...",84,96,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, Image..."
32fcbc8b,micro,10,"desired chip in the image and crop the image such
that only the chip is visible.
These cropped image...","crop_training_images (ChipRegion, ImageObjects, NumTrainingSamples, ImageFiles, MatchingModelID, TemplateToChipRegionHomMat2D, ImageWindowHandle, TextWindowHandle)
dev_set_window (TextWindowHandle)
dev_clear_window ()
dev_disp_text ('Training variation model...', 'window', 'top', 'left', 'black', []...",97,107,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, Text..."
32fcbc8b,micro,11,,"create_variation_model_from_images (ImageObjects, VariationModelID)",108,110,"* --- Automatically Added Context ---
crop_training_images (ChipRegion, ImageObjects, NumTrainingSamples, ImageFiles, MatchingModelID, TemplateToChipRegionHomMat2D, ImageWindowHandle, TextWindowHandle..."
32fcbc8b,micro,12,,"dev_close_window ()
dev_close_window ()",111,114,
32fcbc8b,micro,13,,"visualize_variation_model_training_results (VariationModelID)
stop ()
dev_close_window ()",115,120,"* --- Automatically Added Context ---
create_variation_model_from_images (ImageObjects, VariationModelID)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,14,,"AbsThreshold := [30, 150]
VarThreshold := [15, 15]
prepare_variation_model (VariationModelID, AbsThreshold, VarThreshold)
initialize_visualization_windows (ChipWidth / 2, ChipHeight / 2, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
display_wafer_map (WaferMapImage, WaferMap, 380 + 64, C...",125,191,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
get_image_size (ImageInit, ImageWidth, ImageHeight)
initialize_visualization_windows (ImageWidth / 4, ImageHeig..."
32fcbc8b,micro,15,,create_generic_shape_model (ModelID),192,194,
32fcbc8b,micro,16,,"set_generic_shape_model_param (ModelID, 'num_matches', 1)
set_generic_shape_model_param (ModelID, 'max_overlap', 0.0)
set_generic_shape_model_param (ModelID, 'angle_start', 0.0)
set_generic_shape_model_param (ModelID, 'angle_end', 0.0)
set_generic_shape_model_param (ModelID, 'subpixel', 'interpolati...",195,202,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,17,extended parameter estimation.,"set_generic_shape_model_param (ModelID, 'training_samples', TrainingSamples)
set_generic_shape_model_param (ModelID, 'extended_parameter_estimation', 'per_level')",203,207,"* --- Automatically Added Context ---
generate_training_samples (ImageFiles, NumTrainingSamples, TrainingSamples)
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,18,,"train_generic_shape_model (TemplateImage, ModelID)
return ()",208,231,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
create_generic_shape_model (ModelID)
* --- End of Automat..."
32fcbc8b,micro,19,variation model.,"select_obj (ImageObjects, ImagePart, 1)
get_image_size (ImagePart, Width, Height)",232,236,"* --- Automatically Added Context ---
crop_training_images (ChipRegion, ImageObjects, NumTrainingSamples, ImageFiles, MatchingModelID, TemplateToChipRegionHomMat2D, ImageWindowHandle, TextWindowHandle..."
32fcbc8b,micro,20,"a variation model even if some training samples
contain defective parts.","create_variation_model (Width, Height, 'byte', 'robust', VariationModelID)
train_variation_model (ImageObjects, VariationModelID)
return ()
compare_variation_model (ImageAffineTrans, Region, VariationModelID)
connection (Region, SeparateDefectRegion)
select_shape (SeparateDefectRegion, SelectedRegio...",237,292,"* --- Automatically Added Context ---
crop_training_images (ChipRegion, ImageObjects, NumTrainingSamples, ImageFiles, MatchingModelID, TemplateToChipRegionHomMat2D, ImageWindowHandle, TextWindowHandle..."
32fcbc8b,micro,21,,"edges_sub_pix (Image, Edges, 'canny', 5, 10, 40)
select_contours_xld (Edges, SelectedContours, 'contour_length', 50, 10000, -0.5, 0.5)
segment_contours_xld (SelectedContours, ContoursSplit, 'lines', 4, 6, 3)
union_adjacent_contours_xld (ContoursSplit, UnionContours, 15, 1, 'attr_keep')
gen_region_co...",293,325,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[Index])
compare_variation_model (ImageAffineTrans, Region, VariationModelID)
select_shape (SeparateDefectRegion, SelectedRegions, 'a..."
32fcbc8b,micro,22,wafer map.,"get_image_size (Image, ImageWidth, ImageHeight)",326,330,"* --- Automatically Added Context ---
get_image_size (ImageInit, ImageWidth, ImageHeight)
read_image (Image, ImageFiles[Index])
* --- End of Automatically Added Context ---"
32fcbc8b,micro,23,,"detect_chip_in_image (Image, ChipRegion)
smallest_rectangle1 (ChipRegion, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangle, Row1, Column1, Row2, Column2)",331,335,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
read_image (Image, ImageFiles[Index])
* --- End of Automa..."
32fcbc8b,micro,24,,"dev_set_window (ImageWindowHandle)
dev_display (Image)
dev_set_color ('green')
dev_set_draw ('margin')
dev_display (Rectangle)
dev_disp_text ('Original image', 'window', 'top', 'left', 'black', [], [])",336,343,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
read_image (Image, ImageFiles[Index])..."
32fcbc8b,micro,25,,"ScaleBarHeight := 20
ScaleBarWidth := ImageWidth / 10
ScaleBarPosRow := ImageHeight - 100
ScaleBarPosCol := ImageWidth - ScaleBarWidth - 20
gen_rectangle1 (ScaleBar, ScaleBarPosRow, ScaleBarPosCol, ScaleBarPosRow + ScaleBarHeight, ScaleBarPosCol + ScaleBarWidth)
dev_set_color ('green')
dev_set_draw ...",344,356,"* --- Automatically Added Context ---
get_image_size (ImageInit, ImageWidth, ImageHeight)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,26,,"dev_set_window (TextWindowHandle)
Message := 'This example focuses on inspecting the central'
Message[|Message|] := 'rectangular structure of a 12inch wafer.'
Message[|Message|] := 'The inspection area is roughly 5x5mm large and'
Message[|Message|] := 'the whole FOV of the camera covers an area of'
...",357,370,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
dev_disp_text ('Press Run (F5) to con..."
32fcbc8b,micro,27,,"display_wafer_map (WaferMapImage, WaferMap, 380 + 64, (ImageWidth / 4) + 8, WaferMapWindowHandle, WaferMapChipStatus, WaferMapChipIndex)
return ()",371,403,"* --- Automatically Added Context ---
get_image_size (ImageInit, ImageWidth, ImageHeight)
visualize_image_data (ImageInit, ImageWindowHandle, TextWindowHandle, WaferMapWindowHandle)
display_wafer_map ..."
32fcbc8b,micro,28,,"WindowWidth := 412
WindowHeight := 512
OrangeColor := '#FBBA00'
BlueColor := '#062D64'
ColorNeutral := [6, 45, 100]
ColorOK := [0, 191, 99]
ColorNOK := [255, 0, 0]",404,412,
32fcbc8b,micro,29,,"NumRows := 11
NumCols := 9
ChipWidth := 45
ChipHeight := 45
RowOffset := 30",413,418,"* --- Automatically Added Context ---
get_region_size (ChipRegion, ChipWidth, ChipHeight)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,30,,"WaferOccupies := [5, 7, 7, 9, 9, 9, 7, 7, 5]
dev_open_window (WindowRow, WindowCol, WindowWidth, WindowHeight, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",419,424,"* --- Automatically Added Context ---
WindowWidth := 412
WindowHeight := 512
* --- End of Automatically Added Context ---"
32fcbc8b,micro,31,,"gen_empty_obj (WaferMap)
WaferMapChipIndex := []",425,428,"* --- Automatically Added Context ---
display_wafer_map (WaferMapImage, WaferMap, 380 + 64, ChipWidth / 2 + 8, WaferMapWindowHandle, WaferMapChipStatus, WaferMapChipIndex)
* --- End of Automatically A..."
32fcbc8b,micro,32,,"for Row := 0 to NumRows - 1 by 1
for Col := 0 to NumCols - 1 by 1
RowCoord := Row * ChipHeight + RowOffset
ColCoord := Col * ChipWidth
gen_rectangle1 (Rectangle, RowCoord, ColCoord, RowCoord + ChipHeight, ColCoord + ChipWidth)
erosion_rectangle1 (Rectangle, Rectangle, 5, 5)
concat_obj (WaferMap, Rec...",429,446,"* --- Automatically Added Context ---
get_region_size (ChipRegion, ChipWidth, ChipHeight)
display_wafer_map (WaferMapImage, WaferMap, 380 + 64, ChipWidth / 2 + 8, WaferMapWindowHandle, WaferMapChipSta..."
32fcbc8b,micro,33,,"for MapRow := 0 to |WaferOccupies| - 1 by 1
NumWaferChip := WaferOccupies[MapRow]
EmptyMap := (NumCols - NumWaferChip) / 2
StartCoord := EmptyMap + NumCols * MapRow + 1
EndCoord := StartCoord + NumWaferChip - 1
select_obj (WaferMap, CurrentMap, [StartCoord:1:EndCoord])
WaferMapChipIndex := [WaferMap...",447,461,"* --- Automatically Added Context ---
display_wafer_map (WaferMapImage, WaferMap, 380 + 64, ChipWidth / 2 + 8, WaferMapWindowHandle, WaferMapChipStatus, WaferMapChipIndex)
ColorNeutral := [6, 45, 100]..."
32fcbc8b,micro,34,,"gen_circle (CircleOK, 512 - 45, 100, ChipWidth / 2)
gen_circle (CircleNOK, 512 - 45, 300, ChipWidth / 2)
overpaint_region (RImage, CircleOK, ColorOK[0], 'fill')
overpaint_region (GImage, CircleOK, ColorOK[1], 'fill')
overpaint_region (BImage, CircleOK, ColorOK[2], 'fill')
overpaint_region (RImage, C...",462,508,"* --- Automatically Added Context ---
get_region_size (ChipRegion, ChipWidth, ChipHeight)
display_wafer_map (WaferMapImage, WaferMap, 380 + 64, ChipWidth / 2 + 8, WaferMapWindowHandle, WaferMapChipSta..."
32fcbc8b,micro,35,,"ColorNeutral := [6, 45, 100]
ColorOK := [0, 191, 99]
ColorNOK := [255, 0, 0]
for Index := 0 to |WaferMapChipStatus| - 1 by 1
select_obj (WaferMap, CurrentChip, WaferMapChipIndex[Index])
Color := ColorNeutral
if (WaferMapChipStatus[Index] == 0)
Color := ColorOK
elseif (WaferMapChipStatus[Index] == 1)...",509,562,"* --- Automatically Added Context ---
visualize_image_data (ImageInit, ImageWindowHandle, TextWindowHandle, WaferMapWindowHandle)
get_region_size (ChipRegion, ChipWidth, ChipHeight)
create_variation_m..."
32fcbc8b,micro,36,,"RowOffset := 60
RowCoord := [0, 0, 0]
ColCoord := [0,TileWidth,2 * TileWidth]
RowText := 40
ColText := [15,TileWidth + 20,2 * TileWidth + 20]
NoCrop := gen_tuple_const(3,-1)
gen_empty_obj (VariationModelResults)
convert_image_type (VarImage, VarImageByte, 'byte')
convert_image_type (SqrtImage, SqrtI...",563,579,"* --- Automatically Added Context ---
get_region_size (ChipRegion, ChipWidth, ChipHeight)
RowOffset := 30
RowCoord := Row * ChipHeight + RowOffset
ColCoord := Col * ChipWidth
for Row := 0 to NumRows -..."
32fcbc8b,micro,37,outputs.,"tile_images_offset (ImageZoomed, TiledVariationModelOutput, RowCoord, ColCoord, NoCrop, NoCrop, NoCrop, NoCrop, TileWidth * 3, TileHeight)
dev_display (TiledVariationModelOutput)
Text := 'After the training of the variation model we can inspect the resulting model'
dev_disp_text (Text, 'window', 'to...",580,608,"* --- Automatically Added Context ---
get_region_size (ChipRegion, ChipWidth, ChipHeight)
read_image (Image, ImageFiles[Index])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right'..."
32fcbc8b,micro,38,than one defect detected.,"connection (DefectRegion, DefectiveRegions)
count_obj (DefectiveRegions, NumberDefectRegions)
EvaluationResult := NumberDefectRegions &gt; 1
return ()
TrainingSamples := []
for Index := 0 to NumTrainingImages - 1 by 1
read_image (Image, ImageFiles[Index])
get_domain (Image, Domain)
TrainingSamples[I...",609,668,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
generate_training_samples (ImageFiles, NumTrainingSamples, TrainingSamples)
for Index := NumTrainingSamples to ..."
32fcbc8b,micro,39,,"detect_chip_in_image (MatchingImage, ChipRegion)",672,674,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,40,"the matching region in this case. As long as the unique
features of the object are preserved, this r...","erosion_rectangle1 (ChipRegion, RegionErosion, 600, 1000)
intersection (ChipRegion, RegionErosion, TemplateRegion)
reduce_domain (MatchingImage, TemplateRegion, TemplateImage)",675,682,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
detect_chip_in_image (MatchingImage, ChipRegion)
* --- En..."
32fcbc8b,micro,41,ChipRegion used for the Variation Model.,"area_center (TemplateRegion, _, TemplateRow, TemplateColumn)
area_center (ChipRegion, _, ChipRegionRow, ChipRegionColumn)
hom_mat2d_identity (TemplateToChipRegionHomMat2D)
hom_mat2d_translate (TemplateToChipRegionHomMat2D, TemplateRow - ChipRegionRow, TemplateColumn - ChipRegionColumn, TemplateToChi...",683,716,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
intersection (ChipRegion, RegionErosion, TemplateRegion)
..."
32fcbc8b,micro,42,"matrix that shifts the image in a way that the upper
left corner of the ChipRegion is located in the...","hom_mat2d_identity (HomMat2DIdentity)
get_generic_shape_model_result (MatchingResultID, 'best', 'hom_mat_2d', HomMat2DMatch)
hom_mat2d_invert (HomMat2DMatch, HomMat2DMatchInvert)",720,725,
32fcbc8b,micro,43,,"hom_mat2d_compose (HomMat2DMatchInvert, HomMat2DIdentity, HomMat2DCompose)",726,727,"* --- Automatically Added Context ---
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_invert (HomMat2DMatch, HomMat2DMatchInvert)
* --- End of Automatically Added Context ---"
32fcbc8b,micro,44,and the center of the ChipRegion.,"hom_mat2d_compose (TemplateToChipRegionHomMat2D, HomMat2DCompose, HomMat2DCompose)",728,730,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
hom_mat2d_compose (HomMat2DMatchInvert, HomMat2DIdentity,..."
32fcbc8b,micro,45,half of ChipRegion's size into the image.,"get_region_size (ChipRegion, Width, Height)
hom_mat2d_translate (HomMat2DIdentity, Height / 2.0, Width / 2.0, HomMat2DForCrop)
hom_mat2d_compose (HomMat2DForCrop, HomMat2DCompose, HomMat2DCompose)",731,736,"* --- Automatically Added Context ---
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
get_image_size (ImagePart, Width, Height)
hom_mat2d_ident..."
32fcbc8b,micro,46,,"affine_trans_image_size (Image, CroppedImage, HomMat2DCompose, 'constant', Width, Height)
return ()
get_generic_shape_model_object (ModelContours, ModelID, 'contours')
area_center (ModelRegion, ModelRegionArea, RefRow, RefColumn)
vector_angle_to_rigid (0, 0, 0, RefRow, RefColumn, 0, HomMat2D)
affine...",737,823,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)..."
32fcbc8b,micro,47,,"get_image_size (CroppedImage, ImageWidth, ImageHeight)
ScaleBarHeight := 10
ScaleBarWidth := ImageWidth / 5
ScaleBarPosRow := ImageHeight - 50
ScaleBarPosCol := ImageWidth - ScaleBarWidth - 20
gen_rectangle1 (ScaleBar, ScaleBarPosRow, ScaleBarPosCol, ScaleBarPosRow + ScaleBarHeight, ScaleBarPosCol +...",824,954,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
read_image (ImageInit, ImageFiles[0])
get_image_size (ImageInit, ImageWidth, ImageHeight)
initialize_visualizat..."
32fcbc8b,micro,48,,"dev_set_window (ImageWindowHandle)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (ImageInit)
dev_display (ChipRegion)",955,962,"* --- Automatically Added Context ---
read_image (ImageInit, ImageFiles[0])
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)..."
32fcbc8b,micro,49,,"dev_set_window (TextWindowHandle)
dev_clear_window ()
Text := 'The inspection process is approached in two steps:'
Text[|Text|] := '1) Training a generic shape-based matching model to robustly '
Text[|Text|] := '   locate the chip area in the image, even if the chip'
Text[|Text|] := '   position var...",963,1018,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
dev_disp_text ('Training shape model...."
32fcbc8b,micro,50,using our matching model.,"gen_empty_obj (ImageObjects)
for Index := 0 to NumTrainingSamples - 1 by 1
read_image (Image, ImageFiles[Index])
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
crop_image_to_chip (ChipRegion, Image, ImagePart, MatchResultID, TemplateToChipRegionHomMat2D)
dev_display (ImageP...",1019,1064,"* --- Automatically Added Context ---
list_image_files ('wafer', '.png', [], ImageFiles)
get_template_region (ImageInit, TemplateImage, ChipRegion, MatchingRegion, TemplateToChipRegionHomMat2D)
NumTra..."
32fcbc8b,micro,51,,"dev_open_window (0, 0, ImageWindowWidth, ImageWindowHeight, 'black', ImageWindowHandle)
set_display_font (ImageWindowHandle, 16, 'mono', 'true', 'false')",1065,1068,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
* --- End of Automatically Added Cont..."
32fcbc8b,micro,52,,"dev_open_window (0, ImageWindowWidth + 8, TextWindowWidth, TextWindowHeight, 'black', TextWindowHandle)
set_display_font (TextWindowHandle, 16, 'mono', 'true', 'false')
return ()
smallest_rectangle1 (Region, Row1, Column1, Row2, Column2)
Width := Column2 - Column1 + 1
Height := Row2 - Row1 + 1
retur...",1069,1113,"* --- Automatically Added Context ---
initialize_visualization_windows (ImageWidth / 4, ImageHeight / 4, ImageWidth / 6, 380, ImageWindowHandle, TextWindowHandle)
get_image_size (ImagePart, Width, Hei..."
7fede310,full,0,"Application program to demonstrate the calibration of
a binocular stereo system using the operators
...","ImgPath := 'stereo/board/'
Index := 1
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
dev_close_window ()
dev_update_off ()
get_image_size (ImageL, WidthL, HeightL)
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_set...",20,187,
7fede310,micro,1,"Both cameras will be calibrated by a couple of images of
a 30mm calibration plate. An image pair wil...",ImgPath := 'stereo/board/',14,20,
7fede310,micro,2,,"Index := 1
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')",21,24,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
* --- End of Automatically Added Context ---"
7fede310,micro,3,,"dev_close_window ()
dev_update_off ()
get_image_size (ImageL, WidthL, HeightL)
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_set_draw ('margin')
dev_set_color ('green')
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
get_image_size (ImageR, WidthR, HeightR)
dev_op...",25,36,"* --- Automatically Added Context ---
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
* --- End of Automatically Added Context ---"
7fede310,micro,4,,"CaltabFile := 'caltab_30mm.descr'
caltab_points (CaltabFile, X, Y, Z)",37,39,
7fede310,micro,5,,"gen_cam_par_area_scan_division (0.0125, 0, 1.48e-5, 1.48e-5, WidthL / 2.0, HeightL / 2.0, WidthL, HeightL, StartCamParL)
StartCamParR := StartCamParL",40,42,"* --- Automatically Added Context ---
get_image_size (ImageL, WidthL, HeightL)
* --- End of Automatically Added Context ---"
7fede310,micro,6,,"SizeGauss := 3
MarkThresh := 120
MinDiamMarks := 5
StartThresh := 128
DeltaThresh := 10
MinThresh := 18
Alpha := 0.9
MinContLength := 15
MaxDiamMarks := 100",43,52,
7fede310,micro,7,calibration marks and the initial poses will be accumulated,"RowsL := []
ColsL := []
StartPosesL := []
RowsR := []
ColsR := []
StartPosesR := []",53,60,
7fede310,micro,8,,"for Index := 1 to 15 by 1
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
find_caltab (ImageL, CaltabL, CaltabFile, SizeGauss, MarkThresh, MinDiamMarks)
find_caltab (ImageR, CaltabR, CaltabFile, SizeGauss, MarkThresh, MinDiamMarks)
dev_...",61,93,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
Index := 1
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
dev_open_win..."
7fede310,micro,9,,"binocular_calibration (X, Y, Z, RowsL, ColsL, RowsR, ColsR, StartCamParL, StartCamParR, StartPosesL, StartPosesR, 'all', CamParamL, CamParamR, NFinalPoseL, NFinalPoseR, cLPcR, Errors)",94,95,"* --- Automatically Added Context ---
caltab_points (CaltabFile, X, Y, Z)
gen_cam_par_area_scan_division (0.0125, 0, 1.48e-5, 1.48e-5, WidthL / 2.0, HeightL / 2.0, WidthL, HeightL, StartCamParL)
Start..."
7fede310,micro,10,,"* write_cam_par (CamParamL, 'cam_left-125.dat')
* write_cam_par (CamParamR, 'cam_right-125.dat')
* write_pose (cLPcR, 'pos_right2left.dat')",96,99,"* --- Automatically Added Context ---
binocular_calibration (X, Y, Z, RowsL, ColsL, RowsR, ColsR, StartCamParL, StartCamParR, StartPosesL, StartPosesR, 'all', CamParamL, CamParamR, NFinalPoseL, NFinal..."
7fede310,micro,11,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, cLPcR, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",100,101,"* --- Automatically Added Context ---
binocular_calibration (X, Y, Z, RowsL, ColsL, RowsR, ColsR, StartCamParL, StartCamParR, StartPosesL, StartPosesR, 'all', CamParamL, CamParamR, NFinalPoseL, NFinal..."
7fede310,micro,12,"which has been calibrated, just now.","read_image (ImageL, ImgPath + 'calib_l_01')
read_image (ImageR, ImgPath + 'calib_r_01')",102,105,"* --- Automatically Added Context ---
ImgPath := 'stereo/board/'
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
* --- End of Automatica..."
7fede310,micro,13,,"map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",106,108,"* --- Automatically Added Context ---
read_image (ImageL, ImgPath + 'calib_l_' + Index$'02d')
read_image (ImageR, ImgPath + 'calib_r_' + Index$'02d')
gen_binocular_rectification_map (MapL, MapR, CamPa..."
7fede310,micro,14,"(the differences of the features' row coordinates should be small)
and visualize the result (includi...","check_epipolar_constraint (ImageRectifiedL, ImageRectifiedR, RectCamParL, RectCamParR, WindowHandle1, WindowHandle2, CaltabFile, EpipolarError)",109,135,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', WindowHandle2)
CaltabFile := 'caltab_30..."
7fede310,micro,15,"(the differences of the features' row coordinates should be small)
Parameter settings for find_calta...","SizeGauss := 3
MarkThresh := 120
MinDiamMarks := 5
StartThresh := 128
DeltaThresh := 10
MinThresh := 18
Alpha := 0.9
MinContLength := 15
MaxDiamMarks := 100",136,148,"* --- Automatically Added Context ---
SizeGauss := 3
MarkThresh := 120
MinDiamMarks := 5
StartThresh := 128
DeltaThresh := 10
MinThresh := 18
Alpha := 0.9
MinContLength := 15
MaxDiamMarks := 100
* ---..."
7fede310,micro,16,,"find_caltab (ImageRectifiedL, CaltabL, CaltabFile, SizeGauss, MarkThresh, MinDiamMarks)
find_marks_and_pose (ImageRectifiedL, CaltabL, CaltabFile, RectCamParL, StartThresh, DeltaThresh, MinThresh, Alpha, MinContLength, MaxDiamMarks, RCoordL, CCoordL, StartPoseL)
find_caltab (ImageRectifiedR, CaltabR...",149,154,"* --- Automatically Added Context ---
CaltabFile := 'caltab_30mm.descr'
find_caltab (ImageL, CaltabL, CaltabFile, SizeGauss, MarkThresh, MinDiamMarks)
find_caltab (ImageR, CaltabR, CaltabFile, SizeGau..."
7fede310,micro,17,,"get_cam_par_data (RectCamParL, 'image_width', ImageWidthL)
get_cam_par_data (RectCamParL, 'image_height', ImageHeightL)
dev_set_window (WindowHandle1)
dev_set_color ('yellow')
dev_clear_window ()
dev_set_part (0, 0, ImageHeightL - 1, ImageWidthL - 1)
dev_display (ImageRectifiedL)
for Index := 6 to 4...",155,202,"* --- Automatically Added Context ---
Index := 1
dev_open_window (0, 0, WidthL, HeightL, 'black', WindowHandle1)
dev_open_window (0, WidthL + 12, WidthL, HeightL, 'black', WindowHandle2)
find_marks_an..."
e5862c01,full,0,"This example explains how to perform the hand-eye calibration for
a SCARA robot. In this case, the c...","CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687, 1280, 1024, CameraParam)
dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
set_display_font (WindowH...",12,227,
e5862c01,micro,1,camera parameters of the previously calibrated camera,"CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687, 1280, 1024, CameraParam)
dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
set_display_font (WindowH...",10,19,
e5862c01,micro,2,,"create_calib_data ('hand_eye_scara_moving_cam', 1, 1, CalibDataID)",22,23,
e5862c01,micro,3,,"set_calib_data_cam_param (CalibDataID, 0, [], CameraParam)",24,25,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687, 1280, 1024, CameraParam)
create_calib_data ('hand_eye_scara_movin..."
e5862c01,micro,4,,"set_calib_data_calib_object (CalibDataID, 0, CalibObjDescr)
for Index := 1 to 10 by 1
read_image (CalibImage, '3d_machine_vision/hand_eye/scara_moving_cam_setup_01_calib_' + Index$'02')
read_pose ('scara_moving_cam_setup_01_tool_in_base_pose_' + Index$'02' + '.dat', ToolInBasePose)
set_calib_data (C...",26,48,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687,..."
e5862c01,micro,5,,"check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_inspect_ctrl (Warnings)
stop ()
endif",49,58,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_moving_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
e5862c01,micro,6,,"calibrate_hand_eye (CalibDataID, Errors)",59,61,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_moving_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
e5862c01,micro,7,the robot base in the camera coordinate system,"get_calib_data (CalibDataID, 'camera', 0, 'tool_in_cam_pose', ToolInCamPosePre)",62,64,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_moving_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
e5862c01,micro,8,,"disp_preliminary_result (WindowHandle, ToolInCamPosePre, Errors)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",65,69,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
calibrate_hand_eye (CalibDataID, Errors)
get_calib_data (CalibDataID, 'camera', 0, 'tool_in_cam..."
e5862c01,micro,9,,"read_image (ImageRef1, '3d_machine_vision/hand_eye/scara_moving_cam_setup_01_calib_ref_1')
get_calib_plate_pose (ImageRef1, CameraParam, CalibObjDescr, ObjInCamPoseRef1)
read_pose ('scara_moving_cam_setup_01_tool_in_base_pose_ref_1.dat', ToolInBasePoseRef1)
read_pose ('scara_moving_cam_setup_01_tool...",89,96,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687,..."
e5862c01,micro,10,,"disp_final_results (WindowHandle, ToolInCamPosePre, ToolInCamPose)
disp_end_of_program_message (WindowHandle, 'black', 'true')",97,100,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'tool_in_cam_pose', ToolInCamPosePre)
set_origin_pose..."
e5862c01,micro,11,,"pose_invert (ToolInCamPose, CamInToolPose)
create_pose (-0.0043, 0.0085, 0.087, 0.445, 0.068, 355.9, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.2612, 0.084, 0.1731, 0, 0, 178.128, 'Rp+T', 'gba', 'point', ToolInBasePose)
pose_compose (CamInToolPose, ObjInCamPose, ObjInToolPose)
pose_compose...",110,237,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.004938, -10379.136, 4.65138e-006, 4.65e-006, 617.294, 534.687,..."
51813bab,full,0,"This example explains how to perform the hand-eye calibration for
a SCARA robot. In this case, the c...","CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
CalibrationPlateThickness := 0.003
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
ObjectThickness := 0.001
dev_close_window ()
dev_open_window_fit_size (0, 0, 12...",17,237,
51813bab,micro,1,camera parameters of the previously calibrated camera,"CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
CalibrationPlateThickness := 0.003
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)",15,20,
51813bab,micro,2,define the pose of the measurement plane correctly,"ObjectThickness := 0.001
dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()",21,29,
51813bab,micro,3,,"create_calib_data ('hand_eye_scara_stationary_cam', 1, 1, CalibDataID)",32,33,
51813bab,micro,4,,"set_calib_data_cam_param (CalibDataID, 0, [], CameraParam)",34,35,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
create_calib_data ('hand_eye_scara_station..."
51813bab,micro,5,,"set_calib_data_calib_object (CalibDataID, 0, CalibObjDescr)
for Index := 1 to 10 by 1
read_image (CalibImage, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_' + Index$'02')
read_pose ('scara_stationary_cam_setup_01_tool_in_base_pose_' + Index$'02' + '.dat', ToolInBasePose)
set_calib...",36,58,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1..."
51813bab,micro,6,,"check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_inspect_ctrl (Warnings)
stop ()
endif",59,68,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
51813bab,micro,7,,"calibrate_hand_eye (CalibDataID, Errors)",69,71,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
51813bab,micro,8,the robot base in the camera coordinate system,"get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam_pose', BaseInCamPosePre)",72,74,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_scara_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
51813bab,micro,9,,"disp_preliminary_result (WindowHandle, BaseInCamPosePre, Errors)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",75,79,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
calibrate_hand_eye (CalibDataID, Errors)
get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam..."
51813bab,micro,10,"all pose parameters unambiguously. In case of a stationary
camera, the Z translation of ObjInToolPos...","read_image (ImageRef, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_ref')
get_calib_plate_pose (ImageRef, CameraParam, CalibObjDescr, ObjInCamPoseRef)
read_pose ('scara_stationary_cam_setup_01_tool_in_base_pose_ref.dat', ToolInBasePoseRef)
fix_scara_ambiguity_stationary_cam (BaseIn...",82,100,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1..."
51813bab,micro,11,,"disp_final_results (WindowHandle, BaseInCamPosePre, BaseInCamPose)
disp_end_of_program_message (WindowHandle, 'black', 'true')",101,104,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam_pose', BaseInCamPosePre)
set_origin_pose..."
51813bab,micro,12,,"pose_invert (BaseInCamPose, CamInBasePose)
create_pose (0.0035, -0.0128, 0.7981, 1.345, 356.158, 180.194, 'Rp+T', 'gba', 'point', ObjInCamPose)
pose_compose (CamInBasePose, ObjInCamPose, ObjInBasePose)",113,117,"* --- Automatically Added Context ---
set_origin_pose (BaseInCamPosePre, 0, 0, ZCorrection, BaseInCamPose)
* --- End of Automatically Added Context ---"
51813bab,micro,13,,"set_origin_pose (ObjInCamPoseRef, 0, 0, CalibrationPlateThickness - ObjectThickness, MPInCamPose)",121,123,"* --- Automatically Added Context ---
CalibrationPlateThickness := 0.003
ObjectThickness := 0.001
get_calib_plate_pose (ImageRef, CameraParam, CalibObjDescr, ObjInCamPoseRef)
* --- End of Automaticall..."
51813bab,micro,14,- Results of hand-eye calibration,"write_pose (CamInBasePose, 'cam_in_base_pose.dat')",124,126,"* --- Automatically Added Context ---
pose_invert (BaseInCamPose, CamInBasePose)
* --- End of Automatically Added Context ---"
51813bab,micro,15,from the original image,"write_cam_par (CameraParam, 'camera_parameters.dat')
write_pose (MPInCamPose, 'measurement_plane_in_cam_pose.dat')
pose_invert (BaseInCamPosePre, CamInBasePose)
pose_compose (CamInBasePose, ObjInCamPose, ObjInBasePose)
ZCorrection := ObjInBasePose[2] - ToolInBasePose[2]
return ()
create_calib_data (...",127,247,"* --- Automatically Added Context ---
CalibObjDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1..."
07dc81a7,full,0,"This example explains how to perform an approximate hand-eye calibration
for a SCARA robot without a...","dev_update_off ()
dev_close_window ()
read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_approx_01')
dev_clear_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example...",47,208,
07dc81a7,micro,1,"for a SCARA robot without a calibration plate. The approximate calibration
or ""alignment"" of the rob...","dev_update_off ()
dev_close_window ()
read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_approx_01')
dev_clear_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example...",6,58,
07dc81a7,micro,2,,"gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)",59,61,
07dc81a7,micro,3,"calibration points. In real applications, these values must be
determined as explained above.","CalibrationPointsRow := [139.5, 111.5, 485.5, 809.5, 915.5]
CalibrationPointsColumn := [252.0, 1069.5, 629.5, 217.0, 1042.0]
CalibrationPointsRobotPose := {[0.309454, 0.147978, 0.122474, 0.0, 0.0, 379.475, 0], [0.204182, 0.150825, 0.123036, 0.0, 0.0, 405.695, 0], [0.257784, 0.191762, 0.123514, 0.0, ...",62,69,
07dc81a7,micro,4,,"read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_approx_01')
dev_set_line_width (2)
for Index := 0 to NumCalibrationPoints - 1 by 1
dev_clear_window ()
dev_display (Image)
dev_set_color ('yellow')
gen_cross_contour_xld (Cross, CalibrationPointsRow[Index], Calibratio...",70,95,"* --- Automatically Added Context ---
read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_approx_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Messa..."
07dc81a7,micro,5,"the robot, we must also determine the pose of the measurement plane.
For this, the calibration point...","calibrate_hand_eye_scara_stationary_cam_approx (CameraParam, CalibrationPointsRow, CalibrationPointsColumn, CalibrationPointsRobotPose, CamInBasePose, CPInCamPose)",106,119,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
CalibrationPointsRow := [139.5, 111.5, 485..."
07dc81a7,micro,6,"the grasping points lie, e.g., because the calibration points were
just marked on a sheet of paper (...","CalibrationObjectThickness := 0.001
ObjectThickness := 0.001
set_origin_pose (CPInCamPose, 0, 0, CalibrationObjectThickness - ObjectThickness, MPInCamPose)",120,130,"* --- Automatically Added Context ---
calibrate_hand_eye_scara_stationary_cam_approx (CameraParam, CalibrationPointsRow, CalibrationPointsColumn, CalibrationPointsRobotPose, CamInBasePose, CPInCamPose..."
07dc81a7,micro,7,- Results of hand-eye calibration,"write_pose (CamInBasePose, 'cam_in_base_pose.dat')",131,133,"* --- Automatically Added Context ---
calibrate_hand_eye_scara_stationary_cam_approx (CameraParam, CalibrationPointsRow, CalibrationPointsColumn, CalibrationPointsRobotPose, CamInBasePose, CPInCamPose..."
07dc81a7,micro,8,from the original image,"write_cam_par (CameraParam, 'camera_parameters.dat')
write_pose (MPInCamPose, 'measurement_plane_in_cam_pose.dat')
disp_end_of_program_message (WindowHandle, 'black', 'true')
ToolInBasePose := CalibrationPointsRobotPose.at(0)
pose_invert (ToolInBasePose, BaseInToolPose)
CalibrationPointsXBase := []
...",134,197,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280,..."
07dc81a7,micro,9,,"vector_to_pose (CalibrationPointsXBase, CalibrationPointsYBase, CalibrationPointsZBase, CalibrationPointsRow, CalibrationPointsColumn, CameraParam, 'iterative', 'error', BaseInCamPose, Quality)
pose_invert (BaseInCamPose, CamInBasePose)",198,201,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
CalibrationPointsRow := [139.5, 111.5, 485..."
07dc81a7,micro,10,,"vector_to_pose (CalibrationPointsXObj, CalibrationPointsYObj, CalibrationPointsZObj, CalibrationPointsRow, CalibrationPointsColumn, CameraParam, 'iterative', 'error', CPInCamPose, Quality)
return ()",206,287,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
CalibrationPointsRow := [139.5, 111.5, 485..."
1d553ab9,full,0,"This example explains how to use the hand-eye calibration for the case where
a 3D sensor is stationa...","dev_update_off ()
dev_set_color ('green')
dev_close_window ()
WindowWidth := 512
WindowHeight := 384
ImagesDir := '3d_machine_vision/hand_eye/robot_gripper_gray_'
dev_open_window (0, WindowWidth + 10, WindowWidth, WindowHeight, 'black', ImageWindowHandle)
dev_open_window (0, 0, WindowWidth, WindowHe...",30,222,
1d553ab9,micro,1,"- the pose of the robot base in the coordinate system
of the sensor (BaseInSensorPose).
- the pose o...","dev_update_off ()
dev_set_color ('green')",13,31,
1d553ab9,micro,2,,"dev_close_window ()
WindowWidth := 512
WindowHeight := 384",32,35,
1d553ab9,micro,3,,"ImagesDir := '3d_machine_vision/hand_eye/robot_gripper_gray_'
dev_open_window (0, WindowWidth + 10, WindowWidth, WindowHeight, 'black', ImageWindowHandle)
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
set_display...",36,42,"* --- Automatically Added Context ---
WindowWidth := 512
WindowHeight := 384
* --- End of Automatically Added Context ---"
1d553ab9,micro,4,This object model will serve as the calibration object.,"read_object_model_3d ('hand_eye/robot_gripper_3d_model.om3', 1, [], [], OM3DModel, Status)
create_surface_model (OM3DModel, 0.03, [], [], SurfaceModelID)
Message := 'Surface model to be searched'",43,47,
1d553ab9,micro,5,,"sample_object_model_3d (OM3DModel, 'fast', 0.0009, [], [], SampledObjectModel3D)
visualize_object_model_3d (WindowHandle, SampledObjectModel3D, [], [], 'color_0', 'gray', Message, [], Instruction, PoseOut)",48,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
Instruction := ['Rotate: Left button', 'Zoom:   Shift + left button', 'Move:   Ctrl  + le..."
1d553ab9,micro,6,,NumCalibrationScenes := 15,51,52,
1d553ab9,micro,7,"using a stationary 3D sensor. Since not camera calibration using
a calibration object is performed a...","create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)",53,57,
1d553ab9,micro,8,,"set_calib_data (HECCalibDataID, 'model', 'general', 'optimization_method', 'nonlinear')",58,60,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)
* --- End of Automatically Added Context ---"
1d553ab9,micro,9,in all scenes using surface-based matching.,"for I := 1 to NumCalibrationScenes by 1
read_image (ImageRobotGripperGray, ImagesDir + I$'02d')
read_pose ('tool_in_base_pose_' + I$'02d' + '.dat', ToolInBasePose)
filename := 'hand_eye/robot_gripper_3d_scene_' + I$'02d'
read_object_model_3d (filename, 1, [], [], OM3DScene, Status1)
find_surface_mod...",61,131,"* --- Automatically Added Context ---
ImagesDir := '3d_machine_vision/hand_eye/robot_gripper_gray_'
dev_open_window (0, WindowWidth + 10, WindowWidth, WindowHeight, 'black', ImageWindowHandle)
dev_ope..."
1d553ab9,micro,10,,"check_hand_eye_calibration_input_poses (HECCalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_inspect_ctrl (Warnings)
stop ()
endif",132,139,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)
* --- End of Automatically Added Context ---"
1d553ab9,micro,11,the hand-eye calibration can be performed.,"dev_clear_window ()
disp_message (WindowHandle, 'Performing the hand-eye calibration', 'window', 12, 12, 'black', 'true')
calibrate_hand_eye (HECCalibDataID, HECPoseError)",140,144,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)
* --- End of Automati..."
1d553ab9,micro,12,,"get_calib_data (HECCalibDataID, 'camera', 0, 'base_in_cam_pose', BaseInSensorPose)
get_calib_data (HECCalibDataID, 'calib_obj', 0, 'obj_in_tool_pose', ObjInToolPose)
dev_clear_window ()",145,148,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)
* --- End of Automatically Added Context ---"
1d553ab9,micro,13,,"Message := 'Quality of the results:'
Message[1] := ' '
Message[2] := 'Translation errors in mm: '
MeanTransError := HECPoseError[0] * 1000
MaxTransError := HECPoseError[2] * 1000
Message[3] := 'root mean square    ' + MeanTransError$'6.4f'
Message[4] := 'maximum             ' + MaxTransError$'6.4f'
...",149,163,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle)
Message := 'Surface model to be searched'
calibrate_hand_eye (HECCalibDataID, HECPoseErro..."
1d553ab9,micro,14,calibration object indices.,"query_calib_data_observ_indices (HECCalibDataID, 'camera', 0, CalibObjIdx, PoseIds)",164,166,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 0, 0, HECCalibDataID)
* --- End of Automatically Added Context ---"
1d553ab9,micro,15,system via calibrated poses and the ToolInBasePose and visualize it.,"dev_clear_window ()
for J := 1 to NumCalibrationScenes by 1
read_image (ImageRobotGripperGray, ImagesDir + J$'02d')
filename := 'hand_eye/robot_gripper_3d_scene_' + J$'02d'
read_object_model_3d (filename, 1, [], [], OM3DScene, Status1)
get_calib_data (HECCalibDataID, 'tool', PoseIds[J - 1], 'tool_in...",167,217,"* --- Automatically Added Context ---
ImagesDir := '3d_machine_vision/hand_eye/robot_gripper_gray_'
dev_open_window (0, WindowWidth + 10, WindowWidth, WindowHeight, 'black', ImageWindowHandle)
dev_ope..."
1d553ab9,micro,16,= BaseInCamPose*ToolInBasePose*CalObjInToolPose,"pose_compose (BaseInCamPose, ToolInBasePose, ToolInCamPose)
pose_compose (ToolInCamPose, CalObjInToolPose, CalObjInCamPose)
return ()",218,234,"* --- Automatically Added Context ---
read_pose ('tool_in_base_pose_' + I$'02d' + '.dat', ToolInBasePose)
calc_calplate_pose_stationarycam (ObjInToolPose, BaseInSensorPose, ToolInBasePose, CalObjInCam..."
2088b98c,full,0,"This example shows how to perform an easy-to-use hand-eye calibration
with a stationary camera.
You ...","initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction_and_calib_plate_decision (WindowHandle, UseCalibrationPlate)
dev_disp_touching_point_decision (WindowHandle, GetRobotTouchingPointInToolCoordinates)
if (GetRobotTouchingPointInToolCoordinates == 'true')
calibrate_robot_touchi...",12,1169,
2088b98c,micro,1,"1) Use a calibration plate (more accurate).
2) Use user-defined target points.","initialize_program (WindowHandle, ImageDir, DataDir)",8,13,
2088b98c,micro,2,whether to use a calibration plate.,"dev_disp_introduction_and_calib_plate_decision (WindowHandle, UseCalibrationPlate)",14,17,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
2088b98c,micro,3,"robot is with respect to the tool coordinates.
You can either specify these coordinates or calibrate...","dev_disp_touching_point_decision (WindowHandle, GetRobotTouchingPointInToolCoordinates)
if (GetRobotTouchingPointInToolCoordinates == 'true')
calibrate_robot_touching_point (DataDir, RobotTouchingPointInToolCoordinates)
else
RobotTouchingPointInToolCoordinates := [-0.00724364, -0.0869252, 0.162111]
...",18,27,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
2088b98c,micro,4,,"RowsTouchingPointInPlane := []
ColumnsTouchingPointInPlane := []
ContinueCalibration := 1
Index := 1
ErrorOccurred := 0
if (UseCalibrationPlate == 'true')
gen_cam_par_area_scan_division (0.025, 0, 5.3e-006, 5.3e-006, 640, 512, 1280, 1024, StartCamParam)
collect_single_image_calibration_data (ImageDi...",28,120,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction_and_calib_plate_decision (WindowHandle, UseCalibrationPlate)
calibrate_robot_touching_p..."
2088b98c,micro,5,,"visualize_results_in_3d (ToolInBasePoses, WindowHandle, RobotTouchingPointInToolCoordinates, HandEyeCalibData)",121,123,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
calibrate_robot_touching_point (DataDir, RobotTouchingPointInToolCoordinates)
ToolInBasePoses.at(Index-1) := ..."
2088b98c,micro,6,,"WriteDir := DataDir
dev_disp_write_dir_instructions ()
stop ()
write_hand_eye_calib_results (HandEyeCalibData, WriteDir)
dev_disp_text (['Results written to',WriteDir], 'window', 100, 'left', 'white', 'box', 'false')
dev_disp_text ('      End of program      ', 'window', 'bottom', 'right', 'black', ...",124,430,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
ContinueCalibration := 1
ErrorOccurred := 0
collect_single_image_calibration_data (ImageDir + 'calplate_320mm..."
2088b98c,micro,7,,"align_gripper_at_plane (PlaneInBasePose, ToolInBasePoseOrthToPlane, RobotTouchingPointInToolCoordinates, GripperInToolPose)
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', IdentityPose)
gen_box_object_model_3d (IdentityPose, GripperLength, GripperLength, GripperLength / 4, OM3DToolPlateOrigin...",431,591,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
calibrate_robot_touching_point (DataDir, RobotTouchingPointInToolCoordinates)
Index := 1
ToolInBasePoses.at(I..."
2088b98c,micro,8,"where the gripper was positioned orthogonal to the plane.
Here we use the third position.",ToolInBasePoseOrthToPlane := ToolInBasePoses.at(2),592,595,"* --- Automatically Added Context ---
ToolInBasePoses.at(Index-1) := ToolInBasePoseApproached
align_gripper_at_plane (PlaneInBasePose, ToolInBasePoseOrthToPlane, RobotTouchingPointInToolCoordinates, G..."
2088b98c,micro,9,,"GripperLength := 0.1
if (|ToolInBasePoseOrthToPlane| &gt; 0)
ToolInBasePoseOrthToPlane := ToolInBasePoses.at(2)
gen_gripper_object_model_3d (HandEyeCalibData.PlaneInBasePose, ToolInBasePoseOrthToPlane, RobotTouchingPointInToolCoordinates, GripperLength, ToolInBasePoses, OM3DGripper)
visualize_object...",596,659,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
calibrate_robot_touching_point (DataDir, RobotTouchingPointInToolCoordinates)
ToolInBasePoses.at(Index-1) := ..."
2088b98c,micro,10,,"dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_part_style (WindowHandle, 2)
dev_update_off ()",660,666,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
2088b98c,micro,11,,ImageDir := '3d_machine_vision/hand_eye/',667,669,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
* --- End of Automatically Added Context ---"
2088b98c,micro,12,,"get_current_dir (CurrentDir)
DataDir := CurrentDir + '/'
return ()
read_image (Image, '3d_machine_vision/hand_eye/instruction_images/setup_without_object_stationary_cam')
get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_open_window_fit_image (Image, 0, Width + 8, 600, -1, WindowHand...",670,1007,"* --- Automatically Added Context ---
initialize_program (WindowHandle, ImageDir, DataDir)
dev_disp_introduction_and_calib_plate_decision (WindowHandle, UseCalibrationPlate)
dev_disp_touching_point_de..."
2088b98c,micro,13,,"Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'",1008,1012,"* --- Automatically Added Context ---
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, GenParamValueTools, GenParamValueGripper, LabelsTools, L..."
2088b98c,micro,14,,"IndexTools := 0
GenParamNameTools := []
GenParamValueTools := []
LabelsTools := []
for Index1 := 1 to ToolInBasePoses.length() by 1
GenParamNameTools := [GenParamNameTools,'color_' + IndexTools,'color_' + (IndexTools + 1),'color_' + (IndexTools + 2)]
GenParamValueTools := [GenParamValueTools,'red', ...",1016,1026,"* --- Automatically Added Context ---
ToolInBasePoses.at(Index-1) := ToolInBasePoseApproached
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, ..."
2088b98c,micro,15,,"IndexGripper := 0
GenParamNameGripper := []
GenParamValueGripper := []
LabelsGripper := []
for Index1 := 1 to ToolInBasePoses.length() by 1
GenParamNameGripper := [GenParamNameGripper,'color_' + IndexGripper,'color_' + (IndexGripper + 1)]
GenParamValueGripper := [GenParamValueGripper,'red', 'green']...",1027,1037,"* --- Automatically Added Context ---
ToolInBasePoses.at(Index-1) := ToolInBasePoseApproached
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, ..."
2088b98c,micro,16,,"GenParamNameTools := [GenParamNameTools,'color_' + IndexTools,'alpha_' + IndexTools]
GenParamValueTools := [GenParamValueTools,'gray', 0.7]
GenParamNameGripper := [GenParamNameGripper,'color_' + IndexGripper,'alpha_' + IndexGripper]
GenParamValueGripper := [GenParamValueGripper,'gray', 0.7]
LabelsGr...",1038,1046,"* --- Automatically Added Context ---
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, GenParamValueTools, GenParamValueGripper, LabelsTools, L..."
2088b98c,micro,17,,"GenParamNameTools := [GenParamNameTools,'color_' + IndexTools,'color_' + (IndexTools + 1),'color_' + (IndexTools + 2),'alpha_' + (IndexTools + 2)]
GenParamValueTools := [GenParamValueTools,'magenta', 'plum', 'white', 0.3]
GenParamNameGripper := [GenParamNameGripper,'color_' + IndexGripper,'color_' +...",1047,1055,"* --- Automatically Added Context ---
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, GenParamValueTools, GenParamValueGripper, LabelsTools, L..."
2088b98c,micro,18,,"GenParamNameTools := [GenParamNameTools,'color_' + IndexTools,'color_' + (IndexTools + 1),'color_' + (IndexTools + 2),'color_' + (IndexTools + 3)]
GenParamValueTools := [GenParamValueTools,'red', 'green', 'blue', 'gray']
GenParamNameGripper := [GenParamNameGripper,'color_' + IndexGripper,'color_' + ...",1056,1064,"* --- Automatically Added Context ---
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, GenParamValueTools, GenParamValueGripper, LabelsTools, L..."
2088b98c,micro,19,,"GenParamNameTools := [GenParamNameTools,'point_size']
GenParamValueTools := [GenParamValueTools,1]
GenParamNameGripper := [GenParamNameGripper,'point_size']
GenParamValueGripper := [GenParamValueGripper,1]
return ()",1065,1157,"* --- Automatically Added Context ---
assemble_visualization_parameters (ToolInBasePoses, Instructions, GenParamNameTools, GenParamNameGripper, GenParamValueTools, GenParamValueGripper, LabelsTools, L..."
2088b98c,micro,20,,"pose_invert (PlaneInBasePose, BaseInPlanePose)
pose_compose (BaseInPlanePose, ToolInBasePoseOrthToPlane, ToolInPlanePoseOrthToPlane)
pose_to_hom_mat3d (ToolInPlanePoseOrthToPlane, HomMat3D)
affine_trans_point_3d (HomMat3D, RobotTouchingPointInToolCoordinates[0], RobotTouchingPointInToolCoordinates[1...",1158,1162,"* --- Automatically Added Context ---
calibrate_robot_touching_point (DataDir, RobotTouchingPointInToolCoordinates)
align_gripper_at_plane (PlaneInBasePose, ToolInBasePoseOrthToPlane, RobotTouchingPoi..."
2088b98c,micro,21,,"create_pose (Qx, Qy, Qz, 0, 0, 0, 'Rp+T', 'gba', 'point', GripperInPlanePoseOrthToPlane)",1163,1164,"* --- Automatically Added Context ---
create_pose (0, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', IdentityPose)
affine_trans_point_3d (HomMat3D, RobotTouchingPointInToolCoordinates[0], RobotTouchingPointIn..."
2088b98c,micro,22,,"pose_compose (PlaneInBasePose, GripperInPlanePoseOrthToPlane, GripperInBasePoseOrthToPlane)
pose_invert (ToolInBasePoseOrthToPlane, BaseInToolPoseOrthToPlane)
pose_compose (BaseInToolPoseOrthToPlane, GripperInBasePoseOrthToPlane, GripperInToolPose)
return ()",1165,1213,"* --- Automatically Added Context ---
align_gripper_at_plane (PlaneInBasePose, ToolInBasePoseOrthToPlane, RobotTouchingPointInToolCoordinates, GripperInToolPose)
create_pose (Qx, Qy, Qz, 0, 0, 0, 'Rp+..."
647c8db0,full,0,"This example shows how to perform a quick and easy-to-use
approximate hand-eye calibration with a st...","dev_update_off ()
SphereRadius := 0.02
MinDistanceFromBackground := 0.01
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1
WindowWidth := 800
EstimateVisualizationPose := false
ColorSnippetRGB := ['red', 'green', 'blue']
ColorSphere := 'green'
ColorBase := 'magenta'
ColorCamera := 'cornflower ...",9,647,
647c8db0,micro,1,approximate hand-eye calibration with a stationary 3D sensor.,dev_update_off (),6,10,
647c8db0,micro,2,,SphereRadius := 0.02,11,14,
647c8db0,micro,3,,"MinDistanceFromBackground := 0.01
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1",15,19,
647c8db0,micro,4,,"WindowWidth := 800
EstimateVisualizationPose := false
ColorSnippetRGB := ['red', 'green', 'blue']
ColorSphere := 'green'
ColorBase := 'magenta'
ColorCamera := 'cornflower blue'
PathData := '3d_machine_vision/hand_eye/stationary_cam_approx_sphere/'
get_image_dir (ImageDir)
ImageDir := ImageDir[0]
dev...",20,35,
647c8db0,micro,5,,"dev_disp_intro_text ()
stop ()",36,39,
647c8db0,micro,6,,"gen_sphere_object_model_3d ([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0], SphereRadius, SphereOM3D)
convex_hull_object_model_3d (SphereOM3D, SphereOM3D)
create_surface_model (SphereOM3D, 0.03, [], [], SphereSurfaceModelID)",40,43,"* --- Automatically Added Context ---
SphereRadius := 0.02
* --- End of Automatically Added Context ---"
647c8db0,micro,7,,"get_surface_model_param (SphereSurfaceModelID, 'sampled_model', SampledModel)
Title := 'Calibration sphere that will be used for surface-based matching.'
Title[|Title|] := 'Radius: ' + SphereRadius
visualize_object_model_3d (WindowHandle, [SampledModel,SphereOM3D], [], [], 'color', ColorSphere, Titl...",44,49,"* --- Automatically Added Context ---
SphereRadius := 0.02
ColorSphere := 'green'
dev_open_window (0, 0, WindowWidth, WindowWidth * 0.75, 'black', WindowHandle)
gen_sphere_object_model_3d ([0.0, 0.0, ..."
647c8db0,micro,8,See also the procedure,"* calibrate_robot_touching_point ('.\\', Offset_XYZ)",50,52,
647c8db0,micro,9,"In this example, the gripper transmits its offset to the robot,
we only need to incorporate a Z-offs...","Offset_X := 0
Offset_Y := 0
Offset_Z := -0.02",53,59,
647c8db0,micro,10,,"create_pose (Offset_X, Offset_Y, Offset_Z, 0, 0, 0, 'Rp+T', 'gba', 'point', Tool_P_Gripper)
create_pose (0, 0, SphereRadius, 0, 0, 0, 'Rp+T', 'gba', 'point', Gripper_P_Obj)
pose_compose (Tool_P_Gripper, Gripper_P_Obj, Tool_P_Obj)",60,64,"* --- Automatically Added Context ---
SphereRadius := 0.02
Offset_X := 0
Offset_Y := 0
Offset_Z := -0.02
* --- End of Automatically Added Context ---"
647c8db0,micro,11,,"read_image (XYZI, PathData + 'background_xyzi')
select_obj (XYZI, XBG, 1)
select_obj (XYZI, YBG, 2)
select_obj (XYZI, ZBG, 3)
select_obj (XYZI, IntensityBG, 4)
threshold (ZBG, Region, MinDistanceFromCamera, MaxDistanceFromCamera)
reduce_domain (ZBG, Region, ZBG)
xyz_attrib_to_object_model_3d (XBG, Y...",65,75,"* --- Automatically Added Context ---
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1
PathData := '3d_machine_vision/hand_eye/stationary_cam_approx_sphere/'
* --- End of Automatically Added Co..."
647c8db0,micro,12,,"dev_open_window_fit_image (IntensityBG, 0, WindowWidth + 10, WindowWidth, -1, WindowHandleIntensity)
dev_display (IntensityBG)
set_display_font (WindowHandleIntensity, 16, 'mono', 'true', 'false')
dev_disp_text ('Rectified intensity image of one of the cameras\nof the stereo sensor', 'window', 'top'...",76,91,"* --- Automatically Added Context ---
WindowWidth := 800
EstimateVisualizationPose := false
dev_open_window (0, 0, WindowWidth, WindowWidth * 0.75, 'black', WindowHandle)
Title := 'Calibration sphere ..."
647c8db0,micro,13,,"X_Robot := []
Y_Robot := []
Z_Robot := []
X_Camera := []
Y_Camera := []
Z_Camera := []
CalibPoses := dict{}
NumCalibrationPoses := 8",92,104,
647c8db0,micro,14,to project the matches into the 3D images later.,"estimate_camera_parameters_from_object_model_3d (OM3DEmptyScene, CameraParam, CameraPose)
for I := 1 to NumCalibrationPoses by 1
read_pose (ImageDir + '/' + PathData + 'calib_base_p_tool_' + I$'02' + '.dat', Base_P_Tool)
read_xyz_intensity (X, Y, Z, Intensity, PathData + 'calib_xyzi_', I)
pose_compo...",105,153,"* --- Automatically Added Context ---
MinDistanceFromBackground := 0.01
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1
ColorSphere := 'green'
PathData := '3d_machine_vision/hand_eye/stationar..."
647c8db0,micro,15,camera coordinates to robot base coordinates.,"vector_to_hom_mat3d ('rigid', X_Camera, Y_Camera, Z_Camera, X_Robot, Y_Robot, Z_Robot, Base_H_Cam)",154,157,"* --- Automatically Added Context ---
X_Robot := []
Y_Robot := []
Z_Robot := []
X_Camera := []
Y_Camera := []
Z_Camera := []
* --- End of Automatically Added Context ---"
647c8db0,micro,16,,"write_tuple (Base_H_Cam, './Base_H_Cam.tup')",158,160,"* --- Automatically Added Context ---
vector_to_hom_mat3d ('rigid', X_Camera, Y_Camera, Z_Camera, X_Robot, Y_Robot, Z_Robot, Base_H_Cam)
* --- End of Automatically Added Context ---"
647c8db0,micro,17,,"gen_robot_tool_and_base_object_model_3d (0.005, 0.1, OM3DToolOrigin, OM3DBase)
hom_mat3d_to_pose (Base_H_Cam, Base_P_Cam)
pose_invert (Base_P_Cam, Cam_P_Base)
rigid_trans_object_model_3d (OM3DBase, Cam_P_Base, OM3DBase)",165,170,"* --- Automatically Added Context ---
vector_to_hom_mat3d ('rigid', X_Camera, Y_Camera, Z_Camera, X_Robot, Y_Robot, Z_Robot, Base_H_Cam)
* --- End of Automatically Added Context ---"
647c8db0,micro,18,,"gen_camera_object_model_3d ([0, 0, 0, 0, 0, 0, 0], 0.08, OM3DCamera)
OM3D := [OM3DBase,OM3DCamera,OM3DEmptyScene]
GenParamName := ['color_0', 'color_1', 'color_2', 'color_3', 'color_4', 'color_attrib_5', 'disp_pose', 'point_size']
GenParamValue := [ColorSnippetRGB,ColorBase,ColorCamera,'&amp;gray', ...",171,184,"* --- Automatically Added Context ---
ColorSnippetRGB := ['red', 'green', 'blue']
ColorBase := 'magenta'
ColorCamera := 'cornflower blue'
dev_open_window (0, 0, WindowWidth, WindowWidth * 0.75, 'black..."
647c8db0,micro,19,"in the camera coordinate system and the movement of the tool
in the robot base coordinate system for...","check_hand_eye_calibration_input_poses_translation (CalibPoses, 0.005, NumCalibrationPoses, Warnings)",185,191,"* --- Automatically Added Context ---
CalibPoses := dict{}
NumCalibrationPoses := 8
* --- End of Automatically Added Context ---"
647c8db0,micro,20,"1.) in camera coordinates,
2.) transform the robot coordinates into camera coordinates,
3.) visualiz...","gen_marker_object_model_3d (X_Camera, Y_Camera, Z_Camera, 0, 0.002, 20, OM3DMarkerCam)
gen_marker_object_model_3d (X_Robot, Y_Robot, Z_Robot, 45, 0.002, 20, OM3DMarkerRobot)
hom_mat3d_invert (Base_H_Cam, Cam_H_Base)
affine_trans_point_3d (Cam_H_Base, X_Robot, Y_Robot, Z_Robot, X_Camera_Trans, Y_Came...",192,201,"* --- Automatically Added Context ---
X_Robot := []
Y_Robot := []
Z_Robot := []
X_Camera := []
Y_Camera := []
Z_Camera := []
vector_to_hom_mat3d ('rigid', X_Camera, Y_Camera, Z_Camera, X_Robot, Y_Robo..."
647c8db0,micro,21,,"X_diff := X_Camera_Trans - X_Camera
Y_diff := Y_Camera_Trans - Y_Camera
Z_diff := Z_Camera_Trans - Z_Camera
PoseErr := sqrt(X_diff * X_diff + Y_diff * Y_diff + Z_diff * Z_diff)
PoseErrMean := mean(PoseErr)
PoseErrMax := max(PoseErr)
dev_open_window (0, WindowWidth + 10, 400, 600, 'black', WindowHand...",202,243,"* --- Automatically Added Context ---
WindowWidth := 800
ColorSnippetRGB := ['red', 'green', 'blue']
ColorBase := 'magenta'
ColorCamera := 'cornflower blue'
dev_open_window (0, 0, WindowWidth, WindowW..."
647c8db0,micro,22,,"dev_open_window_fit_image (Intensity, 0, WindowWidth + 10, WindowWidth, -1, WindowHandleIntensity)
NumScenes := 3
for K := 1 to NumScenes by 1
read_xyz_intensity (X, Y, Z, Intensity, PathData + 'scene_xyzi_', K)
filter_z (Z, ZBG, Z, ZVisualization, MinDistanceFromCamera, MaxDistanceFromCamera, MinDi...",244,534,"* --- Automatically Added Context ---
MinDistanceFromBackground := 0.01
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1
WindowWidth := 800
ColorSnippetRGB := ['red', 'green', 'blue']
ColorSphe..."
647c8db0,micro,23,,"regiongrowing (Z, Regions, 3, 3, 6, 2000)
union1 (Regions, RegionUnion)
reduce_domain (Z, RegionUnion, Z)",535,539,"* --- Automatically Added Context ---
read_xyz_intensity (X, Y, Z, Intensity, PathData + 'calib_xyzi_', I)
* --- End of Automatically Added Context ---"
647c8db0,micro,24,,"threshold (Z, Region, MinDistanceFromCamera, MaxDistanceFromCamera)
reduce_domain (Z, Region, ZOutVisualization)",540,543,"* --- Automatically Added Context ---
MinDistanceFromCamera := 0.3
MaxDistanceFromCamera := 1
threshold (ZBG, Region, MinDistanceFromCamera, MaxDistanceFromCamera)
read_xyz_intensity (X, Y, Z, Intensi..."
647c8db0,micro,25,,"abs_diff_image (ZOutVisualization, ZBG, ZDiff, 1)
threshold (ZDiff, Region, MinDistanceFromBackground, 100)
reduce_domain (ZOutVisualization, Region, ZOut)
return ()
read_image (XYZI, Path + Index$'02')
select_obj (XYZI, X, 1)
select_obj (XYZI, Y, 2)
select_obj (XYZI, Z, 3)
select_obj (XYZI, Intensi...",544,661,"* --- Automatically Added Context ---
MinDistanceFromBackground := 0.01
create_pose (Offset_X, Offset_Y, Offset_Z, 0, 0, 0, 'Rp+T', 'gba', 'point', Tool_P_Gripper)
read_image (XYZI, PathData + 'backgr..."
d3dd91c9,full,0,"This example explains the optimization method 'stochastic'
for hand-eye calibration. This method mod...","ImageNameStart := '3d_machine_vision/hand_eye/stationary_cam_stochastic/calib_'
CalibObjDescr := 'stationary_cam_stochastic/calplate.cpd'
gen_cam_par_area_scan_division (0.016, 0, 4.485e-06, 4.485e-06, 480, 400, 960, 800, StartCamParam)
read_image (Image, ImageNameStart + '00')
get_image_size (Image...",26,421,
d3dd91c9,micro,1,"robot with a stationary camera, the optimization method
'stochastic' can be used analogously for SCA...",ImageNameStart := '3d_machine_vision/hand_eye/stationary_cam_stochastic/calib_',19,26,
d3dd91c9,micro,2,,CalibObjDescr := 'stationary_cam_stochastic/calplate.cpd',27,28,
d3dd91c9,micro,3,,"gen_cam_par_area_scan_division (0.016, 0, 4.485e-06, 4.485e-06, 480, 400, 960, 800, StartCamParam)",29,31,
d3dd91c9,micro,4,,"read_image (Image, ImageNameStart + '00')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_disp_init ()
stop ()",32,42,"* --- Automatically Added Context ---
ImageNameStart := '3d_machine_vision/hand_eye/stationary_cam_stochastic/calib_'
* --- End of Automatically Added Context ---"
d3dd91c9,micro,5,,"create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)",45,46,
d3dd91c9,micro,6,,"set_calib_data (CalibDataID, 'model', 'general', 'optimization_method', 'stochastic')",47,48,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,7,,"set_calib_data_cam_param (CalibDataID, 0, [], StartCamParam)",49,50,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.016, 0, 4.485e-06, 4.485e-06, 480, 400, 960, 800, StartCamParam)
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID..."
d3dd91c9,micro,8,,"set_calib_data_calib_object (CalibDataID, 0, CalibObjDescr)
for Index := 0 to 28 by 1
read_image (CalibImage, ImageNameStart + Index$'02')
read_pose ('stationary_cam_stochastic/tool_in_base_pose_' + Index$'02d' + '.dat', ToolInBasePose)
set_calib_data (CalibDataID, 'tool', Index, 'tool_in_base_pose'...",51,74,"* --- Automatically Added Context ---
ImageNameStart := '3d_machine_vision/hand_eye/stationary_cam_stochastic/calib_'
CalibObjDescr := 'stationary_cam_stochastic/calplate.cpd'
gen_cam_par_area_scan_di..."
d3dd91c9,micro,9,,"dev_clear_window ()
dev_disp_text ('Checking the input poses for consistency...', 'window', 'top', 'left', 'white', 'box', 'false')
check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_inspect_ctrl (Warnings)
stop ()
endif",75,86,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,10,,"dev_clear_window ()
dev_disp_text ('Performing hand-eye calibration...', 'window', 'top', 'left', 'white', 'box', 'false')",87,90,
d3dd91c9,micro,11,simultaneously.,"calibrate_hand_eye (CalibDataID, HEErrors)",91,93,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,12,,"get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam_pose', BaseInCamPose)
get_calib_data (CalibDataID, 'calib_obj', 0, 'obj_in_tool_pose', ObjInToolPose)",94,97,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,13,translation/rotation of the input tool poses.,"get_calib_data (CalibDataID, 'tool', 'general', 'tool_translation_deviation', ToolTranslationDeviation)
get_calib_data (CalibDataID, 'tool', 'general', 'tool_rotation_deviation', ToolRotationDeviation)",98,101,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,14,- directly from calibration plate to the camera,"get_calib_data (CalibDataID, 'model', 'general', 'camera_calib_error', CamCalibError)",104,106,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,15,corrected tool to camera,"get_calib_data (CalibDataID, 'model', 'general', 'camera_calib_error_corrected_tool', CamCalibErrorCorrectedTool)",107,109,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,16,tool poses.,"get_calib_data (CalibDataID, 'model', 'general', 'hand_eye_calib_error_corrected_tool', HEErrorsCorrectedTool)
try
write_cam_par (CamParam, 'final_campar.dat')
write_pose (BaseInCamPose, 'final_pose_cam_base.dat')
write_pose (ObjInToolPose, 'final_pose_tool_calplate.dat')
catch (Exception)
endtry",110,121,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data (CalibDataID, 'camer..."
d3dd91c9,micro,17,,"disp_results (WindowHandle, CamCalibError, CamCalibErrorCorrectedTool, HEErrors, HEErrorsCorrectedTool)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",122,126,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
calibra..."
d3dd91c9,micro,18,"The back projection of the calibration marks via the resulting
pose chain using the corrected tool p...","dev_close_window ()
dev_disp_description (ToolTranslationDeviation, ToolRotationDeviation, WindowDict, PartRow1, PartColumn1, PartRow2, PartColumn2)",127,134,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'tool', 'general', 'tool_translation_deviation', ToolTranslationDeviation)
get_calib_data (CalibDataID, 'tool', 'general', 'tool_rota..."
d3dd91c9,micro,19,which does not take uncertainty of observations into account.,"get_results_nonlinear_calibration (CalibDataID, CamParamNonlinear, BaseInCamPoseNonlinear, ObjInToolPoseNonlinear)",135,137,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,20,,"query_calib_data_observ_indices (CalibDataID, 'camera', 0, CalibObjIdx, PoseIds)",138,139,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,21,coordinate system via the robot chain and visualize it.,"for I := 0 to 28 by 1
read_image (Image, ImageNameStart + PoseIds[I]$'02')
get_calib_data (CalibDataID, 'tool', PoseIds[I], 'tool_in_base_pose', ToolInBasePose)
get_calib_data (CalibDataID, 'tool', PoseIds[I], 'tool_in_base_pose_corrected', ToolInBasePoseCorr)
calc_calplate_pose_stationarycam (ObjIn...",140,172,"* --- Automatically Added Context ---
ImageNameStart := '3d_machine_vision/hand_eye/stationary_cam_stochastic/calib_'
CalibObjDescr := 'stationary_cam_stochastic/calplate.cpd'
read_image (Image, Image..."
d3dd91c9,micro,22,"BaseInCamPose can be used in robotic grasping applications.
To grasp an object with the robot, typic...",ObjInCamPose := CalObjInCamPose,173,179,"* --- Automatically Added Context ---
calc_calplate_pose_stationarycam (ObjInToolPose, BaseInCamPose, ToolInBasePose, CalObjInCamPose)
* --- End of Automatically Added Context ---"
d3dd91c9,micro,23,"and an object detected at ObjInCamPose shall be grasped,
the pose of the detected object relative
to...","pose_invert (BaseInCamPose, CamInBasePose)
pose_compose (CamInBasePose, ObjInCamPose, ObjInBasePose)
dev_clear_window ()
dev_disp_text ('Quality of the results:', 'window', 12, 12, 'white', 'box', 'false')
dev_disp_text ('Back projection error of the camera calibration:', 'window', 52, 12, 'white', ...",180,243,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam_pose', BaseInCamPose)
get_calib_data (CalibDataID, 'model', 'general', 'camera_calib_error', CamCalibError)..."
d3dd91c9,micro,24,= BaseInCamPose*ToolInBasePose*CalObjInToolPose,"pose_compose (BaseInCamPose, ToolInBasePose, ToolInCamPose)
pose_compose (ToolInCamPose, CalObjInToolPose, CalObjInCamPose)
return ()",244,271,"* --- Automatically Added Context ---
read_pose ('stationary_cam_stochastic/tool_in_base_pose_' + Index$'02d' + '.dat', ToolInBasePose)
get_calib_data (CalibDataID, 'camera', 0, 'base_in_cam_pose', Ba..."
d3dd91c9,micro,25,,"serialize_calib_data (CalibDataID, SerializedItemHandle)
deserialize_calib_data (SerializedItemHandle, CalibDataIDCopy)
set_calib_data (CalibDataIDCopy, 'model', 'general', 'optimization_method', 'nonlinear')
calibrate_hand_eye (CalibDataIDCopy, HEErrorsNonlinear)
get_calib_data (CalibDataIDCopy, 'c...",272,305,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
get_results_nonlinear_calibration (CalibDataID, CamParamNonlinear, BaseInCamPoseNonlinear, ObjInT..."
d3dd91c9,micro,26,,"PartRow1 := 350
PartColumn1 := 430
PartRow2 := 450
PartColumn2 := 530
WindowDict := dict{}
WidthPart := PartColumn2 - PartColumn1 + 1
HeightPart := PartRow2 - PartRow1 + 1
dev_open_window_fit_size (0, 0, WidthPart, HeightPart, [400, 500], [400, 500], WindowDict.Nonlinear)
dev_set_line_width (2)
get_...",306,428,"* --- Automatically Added Context ---
CalibObjDescr := 'stationary_cam_stochastic/calplate.cpd'
read_image (Image, ImageNameStart + '00')
get_image_size (Image, Width, Height)
dev_open_window_fit_imag..."
206fbf7b,full,0,"This example shows how to use the procedure
check_hand_eye_calibration_input_poses to identify error...","CalPlateDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
CalibrationPlateThickness := 0.003
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, Window...",18,175,
206fbf7b,micro,1,modify one robot pose to simulate an erroneous pose.,"CalPlateDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
CalibrationPlateThickness := 0.003
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1280, 1024, CameraParam)
dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, 640, -1, Window...",15,29,
206fbf7b,micro,2,we selected 'hand_eye_stationary_cam' to simulate an error.,"create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], CameraParam)
set_calib_data_calib_object (CalibDataID, 0, CalPlateDescr)
for Index := 1 to 10 by 1
read_image (CalibImage, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_calib_' ...",32,50,"* --- Automatically Added Context ---
CalPlateDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1..."
206fbf7b,micro,3,,"check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_disp_text (['Inspect the variable \'Warnings\' for the result of', 'check_hand_eye_calibration_input_poses.', '', '-&gt; It indicates that a wrong calibration setup type was selected.'], 'window', 80...",51,63,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
206fbf7b,micro,4,,"create_calib_data ('hand_eye_scara_stationary_cam', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], CameraParam)
set_calib_data_calib_object (CalibDataID, 0, CalPlateDescr)
for Index := 1 to 10 by 1
read_image (CalibImage, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_ca...",64,86,"* --- Automatically Added Context ---
CalPlateDescr := 'calibrate_hand_eye_scara_setup_01_calplate.cpd'
gen_cam_par_area_scan_division (0.0165251, -642.277, 4.65521e-006, 4.65e-006, 595.817, 521.75, 1..."
206fbf7b,micro,5,,"check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
if (|Warnings| != 0)
dev_disp_text (['Inspect the variable \'Warnings\' for the result of', 'check_hand_eye_calibration_input_poses.', '', '-&gt; Because pose 5 occurs in multiple inconsistent pose pairs,', '   it is very li...",87,111,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
check_hand_eye_calibration_input_poses (CalibDataID, 0.05, 0.005, Warnings)
dev_disp_text (['Insp..."
206fbf7b,micro,6,,"calibrate_hand_eye (CalibDataID, ErrorsAfter)
dev_clear_window ()
disp_message_block_2 (ErrorsBefore, ErrorsAfter)
Message := []
Message := [Message,'This example shows how to use the procedure']
Message := [Message,'check_hand_eye_calibration_input_poses to identify errors']
Message := [Message,'in...",112,197,"* --- Automatically Added Context ---
create_calib_data ('hand_eye_stationary_cam', 1, 1, CalibDataID)
calibrate_hand_eye (CalibDataID, ErrorsBefore)
dev_disp_text ('Press Run (F5) to continue', 'wind..."
a3516b2b,full,0,"This example shows how to perform a pick-and-place application with
a SCARA robot based on the calib...","RectifyImages := true
try
read_pose ('cam_in_base_pose.dat', CamInBasePose)
read_cam_par ('camera_parameters.dat', CameraParam)
read_pose ('measurement_plane_in_cam_pose.dat', MPInCamPose)
catch (Exception)
create_pose (0.0559, 0.195, 0.4803, 180.0982, 29.8559, 179.9439, 'Rp+T', 'gba', 'point', CamI...",22,304,
a3516b2b,micro,1,"may only be omitted if the camera looks exactly orthogonal onto the
measurement plane. To run the ex...",RectifyImages := true,17,23,
a3516b2b,micro,2,"example programs calibrate_hand_eye_scara_stationary_cam.hdev
or calibrate_hand_eye_scara_stationary...","try
read_pose ('cam_in_base_pose.dat', CamInBasePose)
read_cam_par ('camera_parameters.dat', CameraParam)
read_pose ('measurement_plane_in_cam_pose.dat', MPInCamPose)
catch (Exception)
create_pose (0.0559, 0.195, 0.4803, 180.0982, 29.8559, 179.9439, 'Rp+T', 'gba', 'point', CamInBasePose)
gen_cam_par...",24,41,
a3516b2b,micro,3,distortions of the images,"if (RectifyImages)
prepare_rectification_map (Map, CameraParam, MPInCamPose, MappingScale, MPInCamPoseMapping)
endif
dev_update_off ()
set_system ('border_shape_models', 'true')",42,50,"* --- Automatically Added Context ---
RectifyImages := true
read_cam_par ('camera_parameters.dat', CameraParam)
read_pose ('measurement_plane_in_cam_pose.dat', MPInCamPose)
* --- End of Automatically ..."
a3516b2b,micro,4,- Acquire an image for model generation,"read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_metal_parts_01')
if (RectifyImages)
map_image (Image, Map, ModelImage)
else
copy_image (Image, ModelImage)
endif
dev_close_window ()
dev_open_window_fit_image (ModelImage, 0, 0, 600, 600, WindowHandle)
set_display_font (Win...",55,69,"* --- Automatically Added Context ---
RectifyImages := true
prepare_rectification_map (Map, CameraParam, MPInCamPose, MappingScale, MPInCamPoseMapping)
* --- End of Automatically Added Context ---"
a3516b2b,micro,5,,"gen_rectangle1 (ROI, 400, 300, 1100, 1300)
gauss_filter (ModelImage, ImageGauss, 5)
reduce_domain (ImageGauss, ROI, ImageReduced)
get_domain (ImageReduced, ModelROI)
create_shape_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 'auto', 'use_polarity', [10, 50], 'auto', ModelID)
area_center (Mo...",70,77,"* --- Automatically Added Context ---
map_image (Image, Map, ModelImage)
* --- End of Automatically Added Context ---"
a3516b2b,micro,6,"it in the image (only if the object can be picked up by the tool in any orientation)
or by grasping ...","DefineGraspingPointByRobot := true
if (DefineGraspingPointByRobot)
dev_set_colored (12)
create_pose (0.2592, 0.1997, 0.1224, 0, 0, 1.2572, 'Rp+T', 'gba', 'point', GraspingPointModelInBasePose)
pose_invert (CamInBasePose, BaseInCamPose)
pose_to_hom_mat3d (BaseInCamPose, BaseInCamHomMat3D)
affine_tran...",78,121,"* --- Automatically Added Context ---
RectifyImages := true
read_pose ('cam_in_base_pose.dat', CamInBasePose)
read_cam_par ('camera_parameters.dat', CameraParam)
create_pose (0.0559, 0.195, 0.4803, 18..."
a3516b2b,micro,7,,"if (RectifyImages)
pose_to_hom_mat3d (MPInCamPoseMapping, MPInCamHomMat3DMapping)
endif
for ImageIdx := 2 to 6 by 1
read_image (Image, '3d_machine_vision/hand_eye/scara_stationary_cam_setup_01_metal_parts_' + ImageIdx$'02d')
if (RectifyImages)
map_image (Image, Map, SearchImage)
else
copy_image (Ima...",122,203,"* --- Automatically Added Context ---
RectifyImages := true
read_pose ('cam_in_base_pose.dat', CamInBasePose)
read_cam_par ('camera_parameters.dat', CameraParam)
read_pose ('measurement_plane_in_cam_p..."
a3516b2b,micro,8,,"set_system ('border_shape_models', 'false')",206,227,
a3516b2b,micro,9,"is zero to ensure that the rectified image has the same orientation
as the original one","pose_to_hom_mat3d (ObjInCamPose, HomMat3D)
hom_mat3d_rotate_local (HomMat3D, rad(-ObjInCamPose[5]), 'z', HomMat3DRotate)
hom_mat3d_to_pose (HomMat3DRotate, ObjInCamPoseZ0)",228,233,
a3516b2b,micro,10,the same resolution as the original image,"get_cam_par_data (CameraParameters, 'image_width', Width)
get_cam_par_data (CameraParameters, 'image_height', Height)
gen_grid_region (RegionGrid, 20, 20, 'points', Width, Height)
get_region_points (RegionGrid, Rows, Columns)
gen_circle_contour_xld (ContCircle, Rows, Columns, gen_tuple_const(|Rows|,...",234,243,"* --- Automatically Added Context ---
smallest_rectangle2 (RegionErosion, GraspingPointModelRow, GraspingPointModelColumn, Phi, Length1, Length2)
find_shape_model (SearchImage, ModelID, rad(0), rad(36..."
a3516b2b,micro,11,the origin of the pose used to create the map,"get_system ('clip_region', ClipRegion)
set_system ('clip_region', 'false')
gen_rectangle1 (ImageArea, 0, 0, Height - 1, Width - 1)
boundary (ImageArea, RegionBorder, 'outer')
set_system ('clip_region', ClipRegion)
get_region_points (RegionBorder, BorderRows, BorderColumns)
image_points_to_world_plan...",244,284,"* --- Automatically Added Context ---
prepare_rectification_map (Map, CameraParam, MPInCamPose, MappingScale, MPInCamPoseMapping)
get_image_size (SearchImage, Width, Height)
hom_mat3d_to_pose (HomMat3..."
a3516b2b,micro,12,"position of the object to be grasped in camera coordinates
(note that the orientation is just set to...","if (RectifyImages)
GraspingPointXMP := GraspingPointColumn * MappingScale
GraspingPointYMP := GraspingPointRow * MappingScale
affine_trans_point_3d (MPInCamHomMat3DMapping, GraspingPointXMP, GraspingPointYMP, 0, GraspingPointXCam, GraspingPointYCam, GraspingPointZCam)
else
image_points_to_world_plan...",285,299,"* --- Automatically Added Context ---
RectifyImages := true
read_pose ('cam_in_base_pose.dat', CamInBasePose)
read_cam_par ('camera_parameters.dat', CameraParam)
read_pose ('measurement_plane_in_cam_p..."
a3516b2b,micro,13,"the z axis of the base pose and that the rotation of the
object is taken into account","ObjInBasePose[3:5] := [0, 0,fmod(deg(GraspingPointAngle),360.0)]
return ()",300,444,"* --- Automatically Added Context ---
GraspingPointAngle := Angle[LeftmostIdx]
calculate_point_to_approach_scara_stationary (GraspingPointRow, GraspingPointColumn, GraspingPointAngle + rad(GraspingPoi..."
22a42f10,full,0,"This example demonstrates how to calibrate a camera
with a hypercentric lens and how to unroll the l...","dev_close_window ()
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
CalTabName := 'calplate_40mm.cpd'
ImageWidth := 1970
ImageHeight := 1970
gen_cam_par_area_scan_hypercentric_polynomial (0.008, 0, 0, 0, 0, 0, 3.1...",12,625,
22a42f10,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()",11,16,
22a42f10,micro,2,,CalTabName := 'calplate_40mm.cpd',19,20,
22a42f10,micro,3,,"ImageWidth := 1970
ImageHeight := 1970
gen_cam_par_area_scan_hypercentric_polynomial (0.008, 0, 0, 0, 0, 0, 3.1e-006, 3.1e-006, ImageWidth / 2, ImageHeight / 2, ImageWidth, ImageHeight, CameraParamStart)",21,24,
22a42f10,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], CameraParamStart)
set_calib_data_calib_object (CalibDataID, 0, CalTabName)
get_window_param (WindowHandle, 'flush', Flush)
set_window_param (WindowHandle, 'flush', 'false')
for J := 1 to 25 by 1...",25,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
CalTabName := 'calplate_40mm.cpd'
gen_cam_par_area_scan_hypercentric_polynomial (0.008, 0, 0, 0, 0, 0, 3.1..."
22a42f10,micro,5,,"calibrate_cameras (CalibDataID, Error)",46,47,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
22a42f10,micro,6,,"get_calib_data (CalibDataID, 'camera', 0, 'params_labels', CameraParamLabels)
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)",48,50,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
22a42f10,micro,7,,"display_camera_parameters (CameraParamStart, CameraParam, Error, CameraParamLabels$'-5', WindowHandle)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",51,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
gen_cam_par_area_scan_hypercentric_polynomial (0.008, 0, 0, 0, 0, 0, 3.1e-006, 3.1e-006, ImageWidth / 2, I..."
22a42f10,micro,8,of a cylindrical object (offline).,"read_image (Image, 'bottle_label/eye_drops_vial_hypercentric')
dev_display (Image)
dev_disp_text ('Top view of a vial with eye drops\nacquired with a hypercentric lens.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], ...",56,63,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of A..."
22a42f10,micro,9,and at its circular screw cap on top.,"VialRadiusBase := 0.0112
VialRadiusTop := 0.0034",64,67,
22a42f10,micro,10,,"get_vial_pose (Image, CameraParam, VialRadiusBase, VialRadiusTop, WindowHandle, VialBase, VialAxis)
stop ()",68,70,"* --- Automatically Added Context ---
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
get_calib_data (CalibDataID, 'camera', 0, 'params..."
22a42f10,micro,11,"Specify the range along the cylinder axis that should be unrolled.
CylinderZStart = 0 and CylinderZE...","CylinderZStart := 0.0
CylinderZEnd := 0.026
CylinderUnrollAngleStart := rad(40)
MapWidth := 1500
MapHeight := 500
gen_cylinder_unrolling_map (Map, CameraParam, VialBase, VialAxis, VialRadiusBase, CylinderZStart, CylinderZEnd, CylinderUnrollAngleStart, ImageWidth, ImageHeight, MapWidth, MapHeight)",71,82,"* --- Automatically Added Context ---
ImageWidth := 1970
ImageHeight := 1970
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
VialRadiusBase := 0.0112
get_vial_pose (Image, CameraParam..."
22a42f10,micro,12,of the unrolled image.,"dev_resize_window_fit_size (0, 0, MapWidth, MapHeight, -1, -1)",85,87,"* --- Automatically Added Context ---
MapWidth := 1500
MapHeight := 500
* --- End of Automatically Added Context ---"
22a42f10,micro,13,"at the same position, the map can be used in runtime images
to efficiently unwrap the surface of the...","map_image (Image, Map, ImageMapped)
dev_display (ImageMapped)
dev_disp_text ('Unrolled label', 'window', 'top', 'left', 'black', [], [])",88,118,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
gen_cylinder_unrolling_map (Map, CameraParam, VialBase, VialAxis, VialRadiusBase, CylinderZStart, Cylinde..."
22a42f10,micro,14,into the xy plane of the cylinder.,"CamXAxisProjX := 1 - CylinderZAxis[0] * CylinderZAxis[0]
CamXAxisProjY := -CylinderZAxis[0] * CylinderZAxis[1]
CamXAxisProjZ := -CylinderZAxis[0] * CylinderZAxis[2]
L := sqrt(sum(CamXAxisProjX * CamXAxisProjX + CamXAxisProjY * CamXAxisProjY + CamXAxisProjZ * CamXAxisProjZ))
CylinderXAxis := [CamXAxi...",129,137,
22a42f10,micro,15,"See the documentation of map_image for details about
creating maps that can be used for general imag...","gen_image_const (MapL, 'int4', MapWidth, MapHeight)
gen_image_const (MapW1, 'uint2', MapWidth, MapHeight)
gen_image_const (MapW2, 'uint2', MapWidth, MapHeight)
gen_image_const (MapW3, 'uint2', MapWidth, MapHeight)
gen_image_const (MapW4, 'uint2', MapWidth, MapHeight)
CAxisStep := (CylinderEnd - Cyli...",138,336,"* --- Automatically Added Context ---
ImageWidth := 1970
ImageHeight := 1970
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
CylinderUnrollAngleStart := rad(40)
MapWidth := 1500
MapHe..."
22a42f10,micro,16,,"threshold (Image, Region, 20, 255)
fill_up (Region, RegionFillUp)
connection (RegionFillUp, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 1e6, 1e20)
boundary (SelectedRegions, RegionBorder, 'inner')
dilation_rectangle1 (RegionBorder, RegionEdgeExtraction, 31, 31)
...",347,354,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
* --- End of Automatically Added Context ---"
22a42f10,micro,17,,"edges_sub_pix (ImageReduced, Edges, 'canny', 2.5, 10, 20)",355,356,"* --- Automatically Added Context ---
reduce_domain (Image, RegionEdgeExtraction, ImageReduced)
* --- End of Automatically Added Context ---"
22a42f10,micro,18,"we would have to extract ellipses. However, because the viewing axis
of the camera is approximately ...","segment_contours_xld (Edges, Edges, 'lines_circles', 5, 4, 2)",357,361,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'canny', 2.5, 10, 20)
* --- End of Automatically Added Context ---"
22a42f10,micro,19,,"union_cocircular_contours_xld (Edges, UnionContours, 0.5, 0.1, 0.2, 30, 300, 300, 'true', 1)",362,363,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'canny', 2.5, 10, 20)
* --- End of Automatically Added Context ---"
22a42f10,micro,20,the circular ground plane of the bottle.,"length_xld (UnionContours, Length)
tuple_sort_index (Length, Indices)
select_obj (UnionContours, LongestContourA, Indices[|Indices| - 1] + 1)",364,368,"* --- Automatically Added Context ---
union_cocircular_contours_xld (Edges, UnionContours, 0.5, 0.1, 0.2, 30, 300, 300, 'true', 1)
* --- End of Automatically Added Context ---"
22a42f10,micro,21,,"get_circle_pose (LongestContourA, CameraParam, VialRadiusBase, 'center_normal', CenterNormalA1, CenterNormalA2)
CircleACenter1 := CenterNormalA1[0:2]
CircleANormal1 := -CenterNormalA1[3:5]
CircleACenter2 := CenterNormalA2[0:2]
CircleANormal2 := -CenterNormalA2[3:5]",369,374,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
VialRadiusBase := 0.0112
select_obj (UnionContours, LongestContourA, Indices[|Indices| - 1] + 1)
..."
22a42f10,micro,22,"we have to determine the correct one: Because the camera
was mounted such that its optical axis was ...","Angle1 := abs(acos(-CircleANormal1[2]))
Angle2 := abs(acos(-CircleANormal2[2]))
if (Angle1 &lt; Angle2)
CircleACenter := CircleACenter1
CircleANormal := CircleANormal1
else
CircleACenter := CircleACenter2
CircleANormal := CircleANormal2
endif",375,390,"* --- Automatically Added Context ---
CircleACenter1 := CenterNormalA1[0:2]
CircleANormal1 := -CenterNormalA1[3:5]
CircleACenter2 := CenterNormalA2[0:2]
CircleANormal2 := -CenterNormalA2[3:5]
get_circ..."
22a42f10,micro,23,the edge of the screw cap and determine its pose.,"ApproxHeightTop := 0.055
Phi := rad([0:5:359])
X := VialRadiusTop * cos(Phi)
Y := VialRadiusTop * sin(Phi)
Z := gen_tuple_const(|Phi|,ApproxHeightTop)
AxZ := CircleANormal
tuple_cross_product (AxZ, [1.0, 0.0, 0.0], AxY)
tuple_cross_product (AxY, AxZ, AxX)
HomMat3D := [AxX[0],AxY[0],AxZ[0],CircleACen...",391,408,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
VialRadiusTop := 0.0034
CylinderUnrollAn..."
22a42f10,micro,24,,"segment_contours_xld (Edges, Edges, 'lines_circles', 5, 4, 2)",409,410,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'canny', 2.5, 10, 20)
* --- End of Automatically Added Context ---"
22a42f10,micro,25,,"union_cocircular_contours_xld (Edges, UnionContours, 0.5, 0.1, 0.2, 30, 300, 300, 'true', 1)",411,412,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'canny', 2.5, 10, 20)
union_cocircular_contours_xld (Edges, UnionContours, 0.5, 0.1, 0.2, 30, 300, 300, 'true', 1)
* --- End o..."
22a42f10,micro,26,of the circular screw cap.,"length_xld (UnionContours, Length)
tuple_sort_index (Length, Indices)
select_obj (UnionContours, LongestContourB, Indices[|Indices| - 1] + 1)",413,417,"* --- Automatically Added Context ---
length_xld (UnionContours, Length)
tuple_sort_index (Length, Indices)
union_cocircular_contours_xld (Edges, UnionContours, 0.5, 0.1, 0.2, 30, 300, 300, 'true', 1)..."
22a42f10,micro,27,,"get_circle_pose (LongestContourB, CameraParam, VialRadiusTop, 'center_normal', CenterNormalB1, CenterNormalB2)
CircleBCenter1 := CenterNormalB1[0:2]
CircleBNormal1 := -CenterNormalB1[3:5]
CircleBCenter2 := CenterNormalB2[0:2]
CircleBNormal2 := -CenterNormalB2[3:5]
Angle1 := abs(acos(-CircleBNormal1[...",418,425,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
VialRadiusTop := 0.0034
CircleANormal1 := -CenterNormalA1[3:5]
CircleANormal2 := -CenterNormalA2[..."
22a42f10,micro,28,,"if (Angle1 &lt; Angle2)
CircleBCenter := CircleBCenter1
CircleBNormal := CircleBNormal1
else
CircleBCenter := CircleBCenter2
CircleBNormal := CircleBNormal2
endif",426,433,"* --- Automatically Added Context ---
CircleANormal1 := -CenterNormalA1[3:5]
CircleANormal2 := -CenterNormalA2[3:5]
get_circle_pose (LongestContourA, CameraParam, VialRadiusBase, 'center_normal', Cent..."
22a42f10,micro,29,to one pose of the vial.,"VialAxis := CircleBCenter - CircleACenter
L := sqrt(sum(VialAxis * VialAxis))
VialAxis := VialAxis / L
VialBase := CircleACenter",434,439,"* --- Automatically Added Context ---
get_vial_pose (Image, CameraParam, VialRadiusBase, VialRadiusTop, WindowHandle, VialBase, VialAxis)
L := sqrt(sum(CamXAxisProjX * CamXAxisProjX + CamXAxisProjY * ..."
22a42f10,micro,30,,"dev_display (Image)
dev_set_line_width (2)
dev_set_color ('green')
dev_display (LongestContourA)
dev_set_color ('blue')
dev_display (LongestContourB)
Text := 'Circles that are used to determine the vial pose. '
Text := [Text,'The vial pose is used to create a map that']
Text := [Text,'unrolls the la...",440,541,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_hypercentric_' + J$'02')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
select_obj (Un..."
22a42f10,micro,31,"vectors Vector1 and Vector2, which both must be represented
by tuples with three elements.","CrossProduct := Vector1[1] * Vector2[2] - Vector1[2] * Vector2[1]
CrossProduct := [CrossProduct,Vector1[2] * Vector2[0] - Vector1[0] * Vector2[2]]
CrossProduct := [CrossProduct,Vector1[0] * Vector2[1] - Vector1[1] * Vector2[0]]
return ()",542,603,
22a42f10,micro,32,,"dev_clear_window ()
Text := 'Compare initial and calibrated camera parameters'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Residual calibration error = ' + Error$'.3f' + ' px', 'window', 72, 22, 'white', 'box', 'false')
Text := ['Initial parameters:', ' ']
Style :=...",604,611,"* --- Automatically Added Context ---
calibrate_cameras (CalibDataID, Error)
Text := 'Circles that are used to determine the vial pose. '
* --- End of Automatically Added Context ---"
22a42f10,micro,33,,"Unit := [' m', '', '', '', '', '', ' m', ' m', ' px', ' px']
for Index := 1 to |StartCamParam| - 3 by 1
Text := [Text,ParLabels[Index] + ' = ' + StartCamParam[Index]$Style[Index - 1] + Unit[Index - 1]]
endfor
dev_disp_text (Text, 'window', 102, 22, 'white', 'box', 'false')",612,617,"* --- Automatically Added Context ---
Text := 'Circles that are used to determine the vial pose. '
Style := ['.4f', '.4e', '.4e', '.4e', '.4f', '.4f', '.3e', '.3e', '.2f', '.2f']
* --- End of Automati..."
22a42f10,micro,34,,"Text := ['Calibrated parameters:', ' ']
for Index := 1 to |CamParam| - 3 by 1
Text := [Text,ParLabels[Index] + ' = ' + CamParam[Index]$Style[Index - 1] + Unit[Index - 1]]
endfor
get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_disp_text (Text, 'window', 102, Width / 2, 'white', 'box...",618,687,"* --- Automatically Added Context ---
dev_open_window (0, 0, 700, 700, 'black', WindowHandle)
project_3d_point (XC, YC, ZC, CameraParam, Row, Column)
Text := 'Circles that are used to determine the vi..."
cf496fdc,full,0,"This example shows how to perform the basic calibration of a single
camera with multiple images of a...","dev_update_off ()
list_image_files ('calib', 'default', [], AllCalibImageFiles)
tuple_regexp_select (AllCalibImageFiles, 'calib_single_camera', ImageFiles)
read_image (Image, ImageFiles[0])
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, 600, ...",8,486,
cf496fdc,micro,1,camera with multiple images of a calibration object.,dev_update_off (),6,9,
cf496fdc,micro,2,,"list_image_files ('calib', 'default', [], AllCalibImageFiles)
tuple_regexp_select (AllCalibImageFiles, 'calib_single_camera', ImageFiles)
read_image (Image, ImageFiles[0])
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, 600, -1, WindowHandle)
...",10,22,
cf496fdc,micro,3,of camera and calibration plate. This may take a moment.,"Message := 'Creating 3D object models for visualization...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'gray', 'false')
create_models (MarksModel, PlateModel, CamModel, BaseModel)
disp_message (WindowHandle, 'Ready.\nNow starting example...', 'window', 32, 12, 'gray', 'false')
wait_secon...",23,30,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, 600, -1, WindowHandle)
* --- End of Automatically Added Context ---"
cf496fdc,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)",35,36,
cf496fdc,micro,5,description file,"CalPlateDescr := 'calplate_80mm.cpd'
set_calib_data_calib_object (CalibDataID, 0, CalPlateDescr)",37,40,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
cf496fdc,micro,6,"focus: 0.008 (use the nominal focal length of the used lens)
kappa: 0 (parameter for the division mo...","gen_cam_par_area_scan_division (0.008, 0, 3.7e-006, 3.7e-006, 646, 482, 1292, 964, StartParam)
set_calib_data_cam_param (CalibDataID, 0, [], StartParam)",41,50,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
cf496fdc,micro,7,,"for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
find_calib_object (Image, CalibDataID, 0, 0, Index, [], [])
get_calib_data_observ_pose (CalibDataID, 0, 0, Index, StartPose)
if (Index == 0)
create_pose (0.0, 0.0, StartPose[2] + 0.01, 0, 0, 0, 'Rp+T', 'gba', 'point', Base...",53,113,"* --- Automatically Added Context ---
tuple_regexp_select (AllCalibImageFiles, 'calib_single_camera', ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_size (0, 0, Width, Height, 600, ..."
cf496fdc,micro,8,,"calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParametersCalibrated)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)",116,121,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
cf496fdc,micro,9,,"dev_set_window (WindowHandle)
dev_clear_window ()
if (|ParLabels| == 13)
Units := ['', 'm', '', '', '', '', '', 'm', 'm', 'px', 'px', 'px', 'px']
else
Units := ['', 'm', '', 'm', 'm', 'px', 'px', 'px', 'px']
endif
FormatStringLabels := max(strlen(ParLabels))$'0' + 's'
FormatStringParams := ''
CamPar...",122,226,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, 600, -1, WindowHandle)
get_window_extents (WindowHandle, Row, Column, WindowWidth, WindowHeight)
Message := 'Creati..."
cf496fdc,micro,10,,"FX := [FinderX,FinderX + 1,FinderX,FinderX,FinderX + 1,FinderX + 1,FinderX - 1]
FY := [FinderY,FinderY - 1,FinderY - 1,FinderY + 1,FinderY,FinderY + 1,FinderY]
FX[5] := FX[5] - 1
FX[10] := FX[10] - 1
FX[15] := FX[15] - 1
FX[25] := FX[25] - 1
Linear := XNum * FY + FX
XSeq := [0:1:XNum - 1]
YSeq := ge...",227,245,
cf496fdc,micro,11,,"for I := 0 to |RX| - 1 by 1
X := RX[I]
Y := RY[I]
if (Y % 2 == 1)
add_circle_offset (-OffsetX + (X - 0.25) * Spacing, -OffsetY + Y * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
else
add_circle_offset (-OffsetX + (X + 0.25) * Spacing, -OffsetY + Y * S...",246,261,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, XOff, YOff, Radius, 0, 6.28318, 'positive', 0.05 * Radius)
PointX := []
PointY := []
PointZ := []
PolySequence := []
Spacing :..."
cf496fdc,micro,12,,"add_circle_with_hole_offset (-OffsetX + (FinderX[0] - 1 + 0.25) * Spacing, -OffsetY + (FinderY[0] - 1) * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
add_circle_with_hole_offset (-OffsetX + (FinderX[0] + 0.25) * Spacing, -OffsetY + (FinderY[0] - 1) * ...",262,272,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, XOff, YOff, Radius, 0, 6.28318, 'positive', 0.05 * Radius)
PointX := []
PointY := []
PointZ := []
PolySequence := []
Spacing :..."
cf496fdc,micro,13,,"Fdx := 1
add_circle_with_hole_offset (-OffsetX + (FinderX[Fdx] - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
add_circle_offset (-OffsetX + (FinderX[Fdx] + 1 - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] ...",273,285,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, XOff, YOff, Radius, 0, 6.28318, 'positive', 0.05 * Radius)
PointX := []
PointY := []
PointZ := []
PolySequence := []
Spacing :..."
cf496fdc,micro,14,,"Fdx := 2
add_circle_offset (-OffsetX + (FinderX[Fdx] - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
add_circle_offset (-OffsetX + (FinderX[Fdx] + 1 - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * Spa...",286,298,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, XOff, YOff, Radius, 0, 6.28318, 'positive', 0.05 * Radius)
PointX := []
PointY := []
PointZ := []
PolySequence := []
Spacing :..."
cf496fdc,micro,15,,"Fdx := 3
add_circle_offset (-OffsetX + (FinderX[Fdx] - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
add_circle_offset (-OffsetX + (FinderX[Fdx] + 1 - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * Spa...",299,311,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, XOff, YOff, Radius, 0, 6.28318, 'positive', 0.05 * Radius)
PointX := []
PointY := []
PointZ := []
PolySequence := []
Spacing :..."
cf496fdc,micro,16,,"Fdx := 4
add_circle_with_hole_offset (-OffsetX + (FinderX[Fdx] - 0.25) * Spacing, -OffsetY + (FinderY[Fdx] - 1) * SpacingY, Radius, PointX, PointY, PointZ, PolySequence, PointX, PointY, PointZ, PolySequence)
add_circle_with_hole_offset (-OffsetX + (FinderX[Fdx] + 1 - 0.25) * Spacing, -OffsetY + (Fin...",312,368,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, WindowWidth, WindowHeight)
PointXOut := PointX
PointYOut := PointY
PointZOut := PointZ
PolySequenceOut := PolySeque..."
cf496fdc,micro,17,have to triangulate this by hand,"Sequence := []
Num := |Row|
Off := |PointX|
for Idx := 0 to Num - 2 by 1
Sequence := [Sequence,3,Off + Idx,Off + Idx + Num,Off + Idx + 1]
Sequence := [Sequence,3,Off + Idx + 1,Off + Idx + Num,Off + Idx + Num + 1]
endfor
Sequence := [Sequence,3,Off + Num - 1,Off + Num - 1 + Num,Off + 0]
Sequence := [...",369,431,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
get_window_extents (WindowHandle, Row, Column, WindowWidth, WindowHeight)
gen_cam_par_area_scan_division (0.008, 0, 3.7e-006..."
cf496fdc,micro,18,,"Factor := (Dist - SensorZ) * Length / SensorZ
FarX := SensorX + Factor * SensorX / Length
FarY := SensorY + Factor * SensorY / Length
FarZ := SensorZ + Factor * SensorZ / Length
gen_empty_object_model_3d (VolumeModel)
PointX := [SensorX,FarX]
PointY := [SensorY,FarY]
PointZ := [SensorZ,FarZ]
PolySeq...",432,466,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
create_viewing_volume (StartParam, StartPose[2] + 0.001, VolumeModel)
PointX := []
PointY := []
PointZ := []
PolySequence :=..."
cf496fdc,micro,19,,"XNum := 31
YNum := 27
FinderX := [15, 6, 24, 6, 24]
FinderY := [13, 6, 6, 20, 20]
MarkDist := 0.00258065
DiameterRatio := 0.5",467,474,"* --- Automatically Added Context ---
for R := 0 to YNum - 1 by 1
add_circle_with_hole_offset (-OffsetX + (FinderX[0] - 1 + 0.25) * Spacing, -OffsetY + (FinderY[0] - 1) * SpacingY, Radius, PointX, Poi..."
cf496fdc,micro,20,,"create_caltab_object_model (XNum, YNum, MarkDist, DiameterRatio, FinderX, FinderY, MarksModel)",475,477,"* --- Automatically Added Context ---
create_models (MarksModel, PlateModel, CamModel, BaseModel)
for R := 0 to YNum - 1 by 1
add_circle_with_hole_offset (-OffsetX + (FinderX[0] - 1 + 0.25) * Spacing,..."
cf496fdc,micro,21,,"create_pose (0.0, 0.0, 0.0005, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
gen_box_object_model_3d (Pose, (XNum + 2) * MarkDist, (YNum + 2) * sqrt(0.75) * MarkDist, 0.00099, PlateModel)
create_pose (0.0, 0.0, 0.0005, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)",478,482,"* --- Automatically Added Context ---
create_models (MarksModel, PlateModel, CamModel, BaseModel)
create_pose (0.0, 0.0, StartPose[2] + 0.01, 0, 0, 0, 'Rp+T', 'gba', 'point', BasePoseWorld)
for R := 0..."
cf496fdc,micro,22,,"gen_box_object_model_3d (Pose, 0.02, 0.02, 0.03, CamModel)
gen_box_object_model_3d (Pose, 0.15, 0.15, 0.001, BaseModel)
return ()",483,497,"* --- Automatically Added Context ---
create_models (MarksModel, PlateModel, CamModel, BaseModel)
create_pose (0.0, 0.0, 0.0005, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatically Added..."
886a7fad,full,0,"This program performs the calibration of a multi-view stereo
setup consisting of 4 identical cameras...","dev_update_off ()
ImgPath := '3d_machine_vision/multi_view/'
ImgPrefix := 'multi_view_calib_'
FileName := ImgPath + ImgPrefix + 'cam_0_00'
read_image (Image, FileName)
get_image_size (Image, Width, Height)
Scale := .5
CaltabDescr := 'caltab_100mm.descr'
CaltabThickness := 0.0064
NumCameras := 4
NumC...",10,348,
886a7fad,micro,1,,"dev_update_off ()
ImgPath := '3d_machine_vision/multi_view/'
ImgPrefix := 'multi_view_calib_'
FileName := ImgPath + ImgPrefix + 'cam_0_00'
read_image (Image, FileName)
get_image_size (Image, Width, Height)
Scale := .5",9,17,
886a7fad,micro,2,,"CaltabDescr := 'caltab_100mm.descr'
CaltabThickness := 0.0064
NumCameras := 4
NumCalibObjects := 1
NumPoses := 20
gen_cam_par_area_scan_polynomial (0.0085, 0.0, 0.0, 0.0, 0.0, 0.0, 6e-6, 6e-6, Width * .5, Height * .5, Width, Height, StartCamPar)",18,25,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
886a7fad,micro,3,,"create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)",26,27,"* --- Automatically Added Context ---
NumCameras := 4
NumCalibObjects := 1
* --- End of Automatically Added Context ---"
886a7fad,micro,4,,"set_calib_data_cam_param (CalibDataID, 'all', [], StartCamPar)",28,29,"* --- Automatically Added Context ---
gen_cam_par_area_scan_polynomial (0.0085, 0.0, 0.0, 0.0, 0.0, 0.0, 6e-6, 6e-6, Width * .5, Height * .5, Width, Height, StartCamPar)
create_calib_data ('calibratio..."
886a7fad,micro,5,,"set_calib_data_calib_object (CalibDataID, 0, CaltabDescr)",30,32,"* --- Automatically Added Context ---
CaltabDescr := 'caltab_100mm.descr'
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context --..."
886a7fad,micro,6,,"open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
NumIgnoredImg := 0
for PoseIndex := 0 to NumPoses - 1 by 1
for CameraIndex := 0 to NumCameras - 1 by 1
FileName := ImgPath + ImgPrefix + 'cam_' + CameraIndex + '_' + PoseIndex$'02'
read_image (Image, FileName)
set_system ('flush_gra...",33,89,"* --- Automatically Added Context ---
ImgPath := '3d_machine_vision/multi_view/'
ImgPrefix := 'multi_view_calib_'
FileName := ImgPath + ImgPrefix + 'cam_0_00'
read_image (Image, FileName)
get_image_si..."
886a7fad,micro,7,images per camera were extracted before,"if ((NumPoses * NumCameras) - NumIgnoredImg &gt;= NumCameras * 10)
calibrate_cameras (CalibDataID, Error)
else
Message := 'Too few marks were provided!'
Message[1] := 'Please adapt the parameters for'
Message[2] := 'extraction of the marks or provide'
Message[3] := 'more images with better quality.'...",90,103,"* --- Automatically Added Context ---
NumCameras := 4
NumPoses := 20
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
open_windows_multi_view_setup (Height, Width, Sc..."
886a7fad,micro,8,coordinate system,"get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)",104,106,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
886a7fad,micro,9,"by the position of the calibration table in the
calibration image with the pose index 0","RefPoseIndex := 0
get_calib_data (CalibDataID, 'model', 'general', 'reference_camera', RefCameraID)
get_calib_data (CalibDataID, 'calib_obj_pose', [0,RefPoseIndex], 'pose', PoseCam0Indx0)
set_origin_pose (PoseCam0Indx0, 0, 0, CaltabThickness, ReferencePose)",107,113,"* --- Automatically Added Context ---
CaltabThickness := 0.0064
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
886a7fad,micro,10,camera setup model and write the model to file,"set_camera_setup_param (CameraSetupModelID, 'general', 'coord_transf_pose', ReferencePose)
file_exists ('four_camera_setup_model.csm', FileExists)
if (not FileExists)
write_camera_setup_model (CameraSetupModelID, 'four_camera_setup_model.csm')
endif",114,121,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSetupModelID)
set_origin_pose (PoseCam0Indx0, 0, 0, CaltabThickness, ReferencePose)
*..."
886a7fad,micro,11,-&gt; Camera parameters,"get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CamPar0)
get_camera_setup_param (CameraSetupModelID, 1, 'params', CamPar1)
get_camera_setup_param (CameraSetupModelID, 2, 'params', CamPar2)
get_camera_setup_param (CameraSe...",122,128,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSe..."
886a7fad,micro,12,,"get_calib_data (CalibDataID, 'camera', 0, 'pose_labels', PoseLabels)
get_camera_setup_param (CameraSetupModelID, 0, 'pose', CamPose0)
get_camera_setup_param (CameraSetupModelID, 1, 'pose', CamPose1)
get_camera_setup_param (CameraSetupModelID, 2, 'pose', CamPose2)
get_camera_setup_param (CameraSetupM...",129,135,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CameraSe..."
886a7fad,micro,13,"-&gt; First, display the camera parameters","disp_camera_parameters_multi_view_4 (WindowHandles, ParLabels, CamPar0, CamPar1, CamPar2, CamPar3)
disp_continue_message (WindowHandles[3], 'black', 'true')
stop ()",136,140,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
get_camera_setup_param (..."
886a7fad,micro,14,,"disp_camera_poses_multi_view_4 (WindowHandles, PoseLabels, CamPose0, CamPose1, CamPose2, CamPose3)",141,143,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
get_calib_data (CalibDataID, 'camera', 0, 'pose_labels', PoseLabels)
get_camera_setup_param (C..."
886a7fad,micro,15,,"get_calib_data (CalibDataID, 'calib_obj', 0, 'x', X)
get_calib_data (CalibDataID, 'calib_obj', 0, 'y', Y)
get_calib_data (CalibDataID, 'calib_obj', 0, 'z', Z)
gen_object_model_3d_from_points (X, Y, Z, OM3DCaltab)
OM3DsCaltab := []
for i := 1 to NumPoses - 1 by 1
get_calib_data (CalibDataID, 'calib_o...",144,171,"* --- Automatically Added Context ---
NumPoses := 20
create_calib_data ('calibration_object', NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
886a7fad,micro,16,specified within WindowHandles,"set_system ('flush_graphic', 'true')
for Index := 0 to |WindowHandles| - 1 by 1
write_string (WindowHandles[Index], '')
endfor
return ()",172,198,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
* --- End of Automatically Added Context ---"
886a7fad,micro,17,,"if (|WindowHandles| &lt; 4)
disp_message (WindowHandles[0], 'Not enough opened windows!', 'window', 12, 12, 'black', 'true')
endif",203,207,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
* --- End of Automatically Added Context ---"
886a7fad,micro,18,they all are identical),"get_cam_par_data (CamPar0, 'camera_type', CameraType)
if (CameraType == 'area_scan_polynomial')
Style := ['.2e', '.2e', '.2e', '.2e', '.2e', '.2e', '.1e', '.1e', '.2f', '.2f']
Unit := [' m', '', '', '', '', '', ' m', ' m', ' px', ' px']
elseif (CameraType == 'area_scan_division')
Style := ['.2e', '....",208,222,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
get_camera_setup_param (CameraSetupModelID, 0, 'params', CamPar0)
* --- End of Automatically A..."
886a7fad,micro,19,,"Message0 := 'Parameters of Camera 0'
Message1 := 'Parameters of Camera 1'
Message2 := 'Parameters of Camera 2'
Message3 := 'Parameters of Camera 3'
for Index := 1 to |CamPar1| - 3 by 1
Message0 := [Message0,'  ' + ParLabels[Index] + ' = ' + CamPar0[Index]$Style[Index - 1] + Unit[Index - 1]]
Message1...",223,262,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
get_camera_setup_param (..."
886a7fad,micro,20,,"Style := ['.2e', '.2e', '.2e', '.2f', '.2f', '.2f']
Unit := [' m', ' m', ' m', '°', '°', '°']
for Index := 0 to 3 by 1
dev_set_window (WindowHandles[Index])
dev_clear_window ()
endfor
Message0 := 'Pose of Camera 0'
Message1 := 'Pose of Camera 1'
Message2 := 'Pose of Camera 2'
Message3 := 'Pose of Ca...",272,319,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
get_calib_data (CalibDataID, 'camera', 0, 'pose_labels', PoseLabels)
get_camera_setup_param (C..."
886a7fad,micro,21,"the images of a multi-view stereo setup consisting
of four cameras","dev_open_window ((Height * Scale) + 10, (Width * Scale) + 10, Width * Scale, Height * Scale, 'black', WindowHandle3)
dev_set_draw ('margin')
dev_set_line_width (1)
dev_set_color ('green')
set_display_font (WindowHandle3, 14, 'mono', 'true', 'false')
dev_open_window ((Height * Scale) + 10, 0, Width *...",320,359,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
Scale := .5
open_windows_multi_view_setup (Height, Width, Scale, WindowHandles)
* --- End of Automatically Added Context ---"
7c39ab5b,full,0,"This example compares the calibration results obtained
for the camera models 'division' and 'polynom...","dev_update_off ()
dev_close_window ()
read_image (Image, 'calib/calib_distorted_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
get_window_extents (WindowHandle, MainR, MainC, MainWidth, MainHeight)
set_display_font (WindowHandle, 14, 'mono'...",15,554,
7c39ab5b,micro,1,"for the camera models 'division' and 'polynomial'.
A sequence of calibration images was acquired wit...","dev_update_off ()
dev_close_window ()
read_image (Image, 'calib/calib_distorted_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
get_window_extents (WindowHandle, MainR, MainC, MainWidth, MainHeight)
set_display_font (WindowHandle, 14, 'mono'...",6,42,
7c39ab5b,micro,2,"set_calib_model_params_specific (DivCalibDataID, 'camera', 0, 'excluded_params', 'pose')
set_calib_m...","StatFDiv := []
StatKappaDiv := []
StatSxDiv := []
StatCyDiv := []
StatFPoly := []
StatK1Poly := []
StatSxPoly := []
StatCyPoly := []
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'calib/calib_distorted_'",43,56,
7c39ab5b,micro,3,,Indices := [1:NumImgs],59,60,"* --- Automatically Added Context ---
NumImgs := 69
* --- End of Automatically Added Context ---"
7c39ab5b,micro,4,,"* Indices := [34, 16, 52, 29, 63, 65, 45, 14, 10, 3, 38, 18, 49, 36, 59, 6, 21, 43, 50, 47, 1, 11, 26, 44, 13, 28, 66, 68, 48, 54, 40, 67, 2, 55, 30, 17, 69, 64, 56, 60, 23, 5, 58, 27, 20, 57, 9, 31, 25, 46, 4, 53, 61, 39, 37, 32, 7, 15, 22, 41, 19, 51, 12, 42, 62, 33, 8, 35, 24]",62,64,"* --- Automatically Added Context ---
NumImgs := 69
Indices := [1:NumImgs]
* --- End of Automatically Added Context ---"
7c39ab5b,micro,5,,"* Indices := sort_index(rand(NumImgs)) + 1
MaxDF := 0
MaxDSx := 0
MaxDSy := 0
for K := 1 to NumImgs by 1
I := Indices[K - 1]
read_image (Image, ImgsBaseFN + I$'02')
find_calib_object (Image, DivCalibDataID, 0, 0, K, [], [])
find_calib_object (Image, PolyCalibDataID, 0, 0, K, [], [])
dev_display (Ima...",75,140,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
get_window_extents (WindowHandle, MainR, MainC, Mai..."
7c39ab5b,micro,6,,"ImgNumRange := [NumImgsSkip + 1,NumImgs]
plot_stats_graph (StatFDiv, WindowHandleDiv, 'Focal length - Division', [], true, ['Focal length', 'Std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_stats_graph (StatFPoly, WindowHandlePoly, 'Focal length - Polynomial', [], true, ['Focal length', 'St...",141,147,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
StatFDiv := []
StatFPoly := []
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'calib/calib_distorte..."
7c39ab5b,micro,7,,"plot_stats_graph (StatKappaDiv, WindowHandleDiv, 'Kappa - Division', [], false, ['kappa', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_stats_graph (StatK1Poly, WindowHandlePoly, 'K1 - Polynomial', [], false, ['K1', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
dev_set_window (W...",148,155,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
StatKappaDiv := []
StatK1Poly := []
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'calib/calib_dis..."
7c39ab5b,micro,8,,"plot_stats_graph (StatSxDiv, WindowHandleDiv, 'Sx - Division', [], true, ['sx', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_stats_graph (StatSxPoly, WindowHandlePoly, 'Sx - Polynomial', [], true, ['sx', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_compare_graph (StatSxPo...",156,161,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
StatSxDiv := []
StatSxPoly := []
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'calib/calib_distor..."
7c39ab5b,micro,9,,"plot_stats_graph (StatCyDiv, WindowHandleDiv, 'Cy - Division', [], true, ['sy', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_stats_graph (StatCyPoly, WindowHandlePoly, 'Cy - Polynomial', [], true, ['sy', 'std. deviation'], ImgNumRange, PlotStartC, PlotEndC)
plot_compare_graph (StatCyPo...",162,206,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
StatCyDiv := []
StatCyPoly := []
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'calib/calib_distor..."
7c39ab5b,micro,10,,"Resolut := real(GraphWidth) / (|F| - 1)
X := [PlotStartC + 5:Resolut:PlotStartC + 5 + GraphWidth]",207,209,"* --- Automatically Added Context ---
WinWidth := 600
plot_stats_graph (StatFDiv, WindowHandleDiv, 'Focal length - Division', [], true, ['Focal length', 'Std. deviation'], ImgNumRange, PlotStartC, Plo..."
7c39ab5b,micro,11,,"MinDFF := min([F + DF,F - DF])
MaxDFF := max([F + DF,F - DF])
RangeDFF := MaxDFF - MinDFF
MaxDFF := MaxDFF + 0.2 * RangeDFF
MinDFF := MinDFF - 0.2 * RangeDFF
if (PositiveOnly)
MinDFF := max([MinDFF,0.0])
endif",210,218,"* --- Automatically Added Context ---
F := subset(Stat,Sequence)
DF := subset(Stat,Sequence + 1)
Sequence := [0:2:|Stat| - 2]
* --- End of Automatically Added Context ---"
7c39ab5b,micro,12,,"RangeDFF := MaxDFF - MinDFF
NormF := (F - MinDFF) / RangeDFF",219,221,"* --- Automatically Added Context ---
F := subset(Stat,Sequence)
Sequence := [0:2:|Stat| - 2]
DF := subset(Stat,Sequence + 1)
MinDFF := min([F + DF,F - DF])
MaxDFF := max([F + DF,F - DF])
RangeDFF := ..."
7c39ab5b,micro,13,,"Y := GraphHeight * (F - MinDFF) / RangeDFF
DY := GraphHeight * DF / RangeDFF
gen_contour_polygon_xld (Graph, PlotEndR - Y, X)
gen_contour_polygon_xld (FinalF, (PlotEndR - Y[|Y| - 1]) * [1, 1], [PlotStartC - Marker,PlotStartC])
gen_empty_obj (ErrBars)
for I := 0 to |X| - 1 by 1
gen_contour_polygon_xl...",222,234,"* --- Automatically Added Context ---
Indices := [1:NumImgs]
I := Indices[K - 1]
for K := 1 to NumImgs by 1
WinHeight := 300
WinWidth := 600
plot_stats_graph (StatFDiv, WindowHandleDiv, 'Focal length ..."
7c39ab5b,micro,14,,"DF := subset(Stat,Sequence + 1)
MinDF := min(DF)
if (|MaxDev| == 1)
MaxDF := MaxDev
else
MaxDF := max(DF)
endif
RangeDF := MaxDF - MinDF
MaxDF := MaxDF + 0.2 * RangeDF
MinDF := MinDF - 0.2 * RangeDF
if (PositiveOnly)
MinDF := max([MinDF,0.0])
endif",235,248,"* --- Automatically Added Context ---
MaxDF := 0
Sequence := [0:2:|Stat| - 2]
DF := subset(Stat,Sequence + 1)
if (PositiveOnly)
* --- End of Automatically Added Context ---"
7c39ab5b,micro,15,,"RangeDF := MaxDF - MinDF
Z := GraphHeight * (DF - MinDF) / RangeDF
gen_contour_polygon_xld (DevGraph, PlotEndR - Z, X)
gen_contour_polygon_xld (FinalDF, (PlotEndR - Z[|Z| - 1]) * [1, 1], [PlotEndC,PlotEndC + Marker])
gen_contour_polygon_xld (XAxis, [PlotEndR + 3,PlotEndR,PlotEndR,PlotEndR + 3], [Plo...",249,293,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
Indices := [1:NumImgs]
MaxDF := 0
I := Indices[K - 1]
for K := 1 to NumImgs by 1
WinHeight := 300
..."
7c39ab5b,micro,16,,"disp_message (WindowHandle, Name, 'window', 10, PlotCenterC - StrWidth / 2, 'white', 'false')
disp_message (WindowHandle, MaxDFF$'g', 'window', PlotStartR - StrHeight / 2, 10, GraphColor, 'false')
disp_message (WindowHandle, F[|F| - 1]$'g', 'window', PlotEndR - Y[|Y| - 1] - StrHeight / 2, 10, GraphC...",294,300,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
WinHeight := 300
plot_stats_graph (StatFDiv, WindowHandleDiv, 'Focal length - Division', [], true,..."
7c39ab5b,micro,17,,"disp_message (WindowHandle, MaxDF$'g', 'window', PlotStartR - StrHeight / 2, PlotEndC + Marker + 10, DevColor, 'false')
disp_message (WindowHandle, DF[|DF| - 1]$'g', 'window', PlotEndR - Z[|Z| - 1] - StrHeight / 2, PlotEndC + Marker + 10, DevColor, 'false')
if (abs(Z[|Z| - 1]) &gt; StrHeight)
disp_m...",301,369,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
NumImgs := 69
NumImgsSkip := 13
MaxDF := 0
get_calib_data_observ_points (DivCalibDataID, 0, 0, K, ..."
7c39ab5b,micro,18,,"Indices := find(Poly,0.0)
if (Indices != -1)
Poly[Indices] := 1e-10
endif
PolyLg := log10(Poly)
DivLg := log10(Div)
MinV := min([PolyLg,DivLg])
MaxV := max([PolyLg,DivLg])
RangeV := MaxV - MinV
MaxV := MaxV + 0.1 * RangeV
MinV := MinV - 0.1 * RangeV",370,381,"* --- Automatically Added Context ---
NumImgs := 69
Indices := [1:NumImgs]
Sequence := [0:2:|Stat| - 2]
Poly := subset(StatPoly,Sequence)
Div := subset(StatDiv,Sequence)
* --- End of Automatically Add..."
7c39ab5b,micro,19,,"RangeV := MaxV - MinV
PolyY := GraphHeight * (PolyLg - MinV) / RangeV
DivY := GraphHeight * (DivLg - MinV) / RangeV
LastPoly := Poly[|Poly| - 1]
LastDiv := Div[|Div| - 1]
LastPolyY := PolyY[|PolyY| - 1]
LastDivY := DivY[|DivY| - 1]
MinLg := ceil(MinV) - MinV
MaxLg := floor(MaxV) - MinV
gen_empty_obj...",382,442,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
Indices := [1:NumImgs]
I := Indices[K - 1]
for K := 1 to NumImgs by 1
WinHeight := 300
WinWidth :=..."
7c39ab5b,micro,20,,"disp_message (WindowHandle, exp(log(10) * MaxV)$FXX, 'window', PlotStartR - StrHeight / 2, 10, 'white', 'false')
if (LastPolyY &gt; LastDivY and LastPolyY - LastDivY &lt; StrHeight)
disp_message (WindowHandle, LastPoly$FXX, 'window', PlotEndR - LastPolyY - StrHeight, 10, ColorPoly, 'false')
disp_mes...",443,562,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandle)
NumImgs := 69
NumImgsSkip := 13
ImgsBaseFN := 'cali..."
034f6004,full,0,"This example shows how to calibrate a stereo setup of two
telecentric line scan cameras. Additionall...","dev_close_window ()
dev_update_off ()
I := 1
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_calib_plate_' + (I + 1)$'02')
read_image (ImageFront, 'stereo/telecentric_line_scan/cam_1_calib_plate_' + (I + 1)$'02')
get_image_size (ImageBack, WidthBack, HeightBack)
get_image_size (ImageFront...",12,490,
034f6004,micro,1,,"dev_close_window ()
dev_update_off ()
I := 1
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_calib_plate_' + (I + 1)$'02')
read_image (ImageFront, 'stereo/telecentric_line_scan/cam_1_calib_plate_' + (I + 1)$'02')
get_image_size (ImageBack, WidthBack, HeightBack)
get_image_size (ImageFront...",11,38,
034f6004,micro,2,,"gen_cam_par_line_scan_telecentric_division (0.228, 0, 7.0e-6, 7.0e-6, WidthBack / 2, 0, WidthBack, HeightBack, 0, 2.7e-5, 0, StartCamParamBack)
gen_cam_par_line_scan_telecentric_division (0.268, 0, 7.0e-6, 7.0e-6, WidthFront / 2, 0, WidthFront, HeightFront, 0, 2.7e-5, 0, StartCamParamFront)",41,44,"* --- Automatically Added Context ---
get_image_size (ImageBack, WidthBack, HeightBack)
get_image_size (ImageFront, WidthFront, HeightFront)
* --- End of Automatically Added Context ---"
034f6004,micro,3,"including the image coordinates of the calibration marks and
the observation poses of the calibratio...","create_calib_data ('calibration_object', 2, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamParamBack)
set_calib_data_cam_param (CalibDataID, 1, [], StartCamParamFront)
CalibObjDescr := 'calplate_80mm.cpd'
set_calib_data_calib_object (CalibDataID, 0, CalibObjDescr)",45,53,"* --- Automatically Added Context ---
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7.0e-6, 7.0e-6, WidthBack / 2, 0, WidthBack, HeightBack, 0, 2.7e-5, 0, StartCamParamBack)
gen_cam_par_line_s..."
034f6004,micro,4,"object is moved linearly in front of the cameras, only one
common motion vector needs to be determin...","set_calib_data (CalibDataID, 'model', 'general', 'common_motion_vector', 'true')",54,58,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
034f6004,micro,5,,"NumImages := 16
gen_empty_obj (ImagesBack)
gen_empty_obj (ImagesFront)
for I := 0 to NumImages - 1 by 1
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_calib_plate_' + (I + 1)$'02')
read_image (ImageFront, 'stereo/telecentric_line_scan/cam_1_calib_plate_' + (I + 1)$'02')
find_calib_object...",59,83,"* --- Automatically Added Context ---
I := 1
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_calib_plate_' + (I + 1)$'02')
read_image (ImageFront, 'stereo/telecentric_line_scan/cam_1_calib_..."
034f6004,micro,6,,"calibrate_cameras (CalibDataID, Errors)",84,85,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
034f6004,micro,7,,"get_calib_data (CalibDataID, 'camera', 0, 'params', CamParamBack)
get_calib_data (CalibDataID, 'camera', 1, 'params', CamParamFront)
dev_set_window (WindowHandle1)
dev_disp_calibration_results (CalibDataID)
dev_set_window (WindowHandle2)
dev_disp_text_calibration_error ()
stop ()",86,94,"* --- Automatically Added Context ---
dev_open_window (0, 0, WidthBack / WindowSizeFactor1, HeightBack / WindowSizeFactor1, 'black', WindowHandle1)
dev_open_window (0, WidthBack / WindowSizeFactor1 + ..."
034f6004,micro,8,,ResScale := 50.0,97,98,
034f6004,micro,9,,"NumImagesToDisplay := 4
for I := 0 to NumImagesToDisplay - 1 by 1
dev_set_window (WindowHandle1)
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_calib_plate_' + (I + 1)$'02')
dev_display (ImageBack)
calculate_and_display_residuals (CalibDataID, 0, I, ResScale, ResRowBack, ResColBack)
dev_...",99,125,"* --- Automatically Added Context ---
I := 1
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
dev_open_window (0, 0, WidthBack / WindowSizeFactor1, HeightBack / WindowSizeFactor1, 'black', Wind..."
034f6004,micro,10,,"dev_disp_reconstruction_text ()
stop ()",126,130,
034f6004,micro,11,,"get_calib_data (CalibDataID, 'model', 'general', 'camera_setup_model', CamSetupModel)
create_stereo_model (CamSetupModel, 'surface_pairwise', [], [], StereoModelID)",131,133,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
034f6004,micro,12,,"BoundingBox := [-0.03, -0.02, 0.95, 0.03, 0.11, 1.05]
set_stereo_model_param (StereoModelID, 'bounding_box', BoundingBox)
set_stereo_model_param (StereoModelID, 'persistence', 1)
set_stereo_model_param (StereoModelID, 'disparity_method', 'binocular_mg')
set_stereo_model_param (StereoModelID, 'binocu...",134,145,"* --- Automatically Added Context ---
create_stereo_model (CamSetupModel, 'surface_pairwise', [], [], StereoModelID)
* --- End of Automatically Added Context ---"
034f6004,micro,13,,"gen_bounding_box_object_model_3d (StereoModelID, ObjectModel3DBoundingBox)
gen_camera_setup_object_model_3d (CamSetupModel, 'auto', 'auto', ObjectModel3DCamera, ObjectModel3DCone)
visualize_object_model_3d (WindowHandle, [ObjectModel3DBoundingBox,ObjectModel3DCamera,ObjectModel3DCone], [], [0.25, -0...",146,152,"* --- Automatically Added Context ---
Instructions[0] := 'Rotate: Left button'
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', []..."
034f6004,micro,14,,"for I := 0 to 1 by 1
dev_clear_window ()
dev_disp_text ('Reconstructing the 3D surface...', 'window', 'top', 'left', 'black', [], [])
read_image (ImageBack, 'stereo/telecentric_line_scan/cam_0_board_' + (I + 1)$'02')
read_image (ImageFront, 'stereo/telecentric_line_scan/cam_1_board_' + (I + 1)$'02')...",153,230,"* --- Automatically Added Context ---
I := 1
dev_open_window (0, 0, WidthBack / WindowSizeFactor1, HeightBack / WindowSizeFactor1, 'black', WindowHandle1)
dev_open_window (0, WidthBack / WindowSizeFac..."
034f6004,micro,15,,"R := gen_tuple_const(|X|,Radius)
gen_circle_contour_xld (ContCircle, Y, X, R, 0, 6.28318, 'positive', Radius / 20.0)
count_obj (ContCircle, NumMarks)
pose_to_hom_mat3d (CalibObjPose, HomMat3D)
gen_empty_obj (ProjMarkContours)",231,236,
034f6004,micro,16,calibrated pose of the calibration plate.,"for Index := 1 to NumMarks by 1
select_obj (ContCircle, Contour, Index)
get_contour_xld (Contour, Y, X)
affine_trans_point_3d (HomMat3D, X, Y, gen_tuple_const(|X|,0), XC, YC, ZC)
project_3d_point (XC, YC, ZC, CameraParam, Row, Column)
gen_contour_polygon_xld (ContourMark, Row, Column)
concat_obj (Pr...",237,303,"* --- Automatically Added Context ---
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Camera 1 (Front): C..."
034f6004,micro,17,,"get_calib_data (CalibDataID, 'model', 'general', 'camera_calib_error', Errors)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParamBack)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', CamParamLabelsBack)
get_calib_data (CalibDataID, 'camera', 1, 'params', CamParamFront)
get_calib...",304,321,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', ..."
034f6004,micro,18,the camera parameters.,"Format := ['', '10.5f', '7.2f', '7.2f', '7.2f', '7.2f', '7.2f', 'd', 'd', '7.2f', '7.2f', '7.2f']
Scale := [1.0, 1.0, 1.0, 1e6, 1e6, 1.0, 1.0, 1.0, 1.0, 1e6, 1e6, 1e6]
Unit := ['', '', '', ' um/px', ' um/px', ' px', ' px', ' px', ' px', ' um/px', ' um/px', ' um/px']",322,327,
034f6004,micro,19,,"Text := 'Camera 0:'
for Index := 1 to |CamParamBack| - 1 by 1
if (CamParamLabelsBack[Index] == 'image_width' or CamParamLabelsBack[Index] == 'image_height' or CamParamLabelsBack[Index] == 'p1' or CamParamLabelsBack[Index] == 'p2')
continue
endif
Text := [Text,CamParamLabelsBack[Index]$'-13' + ' = ' ...",329,337,"* --- Automatically Added Context ---
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', [], [])
Text := 'Camera 0 (Back):'
for Inde..."
034f6004,micro,20,,"Text := 'Camera 1:'
for Index := 1 to |CamParamFront| - 1 by 1
if (CamParamLabelsFront[Index] == 'image_width' or CamParamLabelsFront[Index] == 'image_height' or CamParamLabelsFront[Index] == 'p1' or CamParamLabelsFront[Index] == 'p2')
continue
endif
Text := [Text,CamParamLabelsFront[Index]$'-13' + ...",338,347,"* --- Automatically Added Context ---
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', [], [])
Text := 'Camera 0 (Back):'
for Inde..."
034f6004,micro,21,,"Format := ['8.4f', '8.4f', '8.4f', '8.4f', '8.4f', '8.4f']
Unit := [' m', ' m', ' m', ' deg', ' deg', ' deg']
Text := 'Pose of camera 1 relative to camera 0:'
for Index := 0 to |Back_P_Front| - 2 by 1
Text := [Text,Back_P_Front[Index]$Format[Index] + Unit[Index]]
endfor
dev_disp_text (Text, 'window'...",348,419,"* --- Automatically Added Context ---
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', [], [])
Text := 'Camera 0 (Back):'
dev_disp..."
034f6004,micro,22,,"get_calib_data (CalibDataID, 'calib_obj', 0, 'x', X)
get_calib_data (CalibDataID, 'calib_obj', 0, 'y', Y)
get_calib_data (CalibDataID, 'calib_obj', 0, 'z', Z)
get_calib_data (CalibDataID, 'camera', CameraIdx, 'params', CamParam)
get_calib_data (CalibDataID, 'camera', CameraIdx, 'pose', World_P_Cam)
...",420,428,"* --- Automatically Added Context ---
I := 1
create_calib_data ('calibration_object', 2, 1, CalibDataID)
gen_circle_contour_xld (ContCircle, Y, X, R, 0, 6.28318, 'positive', Radius / 20.0)
* --- End o..."
034f6004,micro,23,,Radius := 0.000645161290322581,429,430,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, Y, X, R, 0, 6.28318, 'positive', Radius / 20.0)
* --- End of Automatically Added Context ---"
034f6004,micro,24,,"gen_contour_calib_marks (ProjMarkContours, X, Y, Z, Radius, Cam_P_Obj, CamParam)
dev_set_color ('green')
dev_set_line_width (1)
dev_display (ProjMarkContours)",431,435,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, Y, X, R, 0, 6.28318, 'positive', Radius / 20.0)
gen_empty_obj (ProjMarkContours)
get_calib_data (CalibDataID, 'calib_obj', 0, ..."
034f6004,micro,25,,"get_calib_data_observ_points (CalibDataID, CameraIdx, 0, I, ObsRow, ObsCol, ObsIndex, Pose)",436,437,"* --- Automatically Added Context ---
I := 1
create_calib_data ('calibration_object', 2, 1, CalibDataID)
get_calib_data (CalibDataID, 'camera', CameraIdx, 'params', CamParam)
* --- End of Automaticall..."
034f6004,micro,26,centers and select the visible marks.,"pose_to_hom_mat3d (Cam_P_Obj, Cam_H_Object)
affine_trans_point_3d (Cam_H_Object, X, Y, Z, CX, CY, CZ)
project_3d_point (CX, CY, CZ, CamParam, ProjRow, ProjCol)
ProjRowSel := ProjRow[ObsIndex]
ProjColumnSel := ProjCol[ObsIndex]",438,444,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, Y, X, R, 0, 6.28318, 'positive', Radius / 20.0)
get_calib_data (CalibDataID, 'calib_obj', 0, 'z', Z)
get_calib_data (CalibData..."
034f6004,micro,27,,"ResRow := ProjRowSel - ObsRow
ResCol := ProjColumnSel - ObsCol",445,447,"* --- Automatically Added Context ---
get_calib_data_observ_points (CalibDataID, CameraIdx, 0, I, ObsRow, ObsCol, ObsIndex, Pose)
ProjRowSel := ProjRow[ObsIndex]
ProjColumnSel := ProjCol[ObsIndex]
pro..."
034f6004,micro,28,,"gen_empty_obj (ResContours)
for IndexM := 0 to |ResRow| - 1 by 1
gen_contour_polygon_xld (ResContour, [ObsRow[IndexM],ObsRow[IndexM] + ResScale * ResRow[IndexM]], [ObsCol[IndexM],ObsCol[IndexM] + ResScale * ResCol[IndexM]])
concat_obj (ResContours, ResContour, ResContours)
endfor
dev_set_color ('red...",448,496,"* --- Automatically Added Context ---
I := 1
dev_disp_text ('Camera 0 (Back): Calibration image ' + (I + 1) + ' of ' + NumImages, 'window', 'top', 'left', 'black', [], [])
ResScale := 50.0
Text := 'Ca..."
c49f7460,full,0,"This example demonstrates the benefit of a tilt lens
and calibrates a camera with a telecentric tilt...","dev_update_off ()
dev_close_window ()
WindowWidth := 500
WindowHeight := 400
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
Message[1] := 'tilt lens and calibrates a camera with a'
Message[2] := 'telecentric tilt lens.'
di...",13,381,
c49f7460,micro,1,,"dev_update_off ()
dev_close_window ()
WindowWidth := 500
WindowHeight := 400
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)",12,18,
c49f7460,micro,2,a tiltable lens. First explain the application.,"Message := 'This example demonstrates the benefit of a'
Message[1] := 'tilt lens and calibrates a camera with a'
Message[2] := 'telecentric tilt lens.'
disp_message (WindowHandles[1], Message, 'window', 12, 12, 'black', 'true')
Message := 'With a standard camera and lens, best results'
Message[1] :=...",19,33,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
* --- End of Automatically Added Context ---"
c49f7460,micro,3,"measurement plane, the volume of the depth of focus
is not parallel to the measurement plane.
As a c...","dev_set_window (WindowHandles[0])
read_image (ImageBlurred, 'caliper/caliper_no_tilt')
get_image_size (ImageBlurred, Width, Height)
crop_rectangle1 (ImageBlurred, ImagePart, 134, 134, 1000, 1000)",34,42,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
* --- End of Automatically Added Context ---"
c49f7460,micro,4,,"show_setup (ImagePart, WindowHandles[0], 0)
disp_continue_message (WindowHandles[1], 'black', 'true')
stop ()
Message := 'If the optical axis is not perpendicular'
Message[1] := 'to the measurement plane...'
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')
dev_set_window (...",43,62,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
read_image (ImageBlurred, 'caliper/ca..."
c49f7460,micro,5,"the lens can be tilted so that the whole measurement
plane is in focus.","show_setup (ImagePart, WindowHandles[0], 1)
Message := 'If the camera is equipped with a tilt lens ...'
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')",63,68,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
crop_rectangle1 (ImageBlurred, ImageP..."
c49f7460,micro,6,,"read_image (ImageSharp, 'caliper/caliper_with_tilt')
dev_set_window (WindowHandles[1])
dev_display (ImageSharp)
Message := '... the lens can be tilted so that the entire'
Message[1] := 'measurement plane is in focus.'
disp_message (WindowHandles[1], Message, 'window', 12, 12, 'black', 'true')
disp_c...",69,78,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
* --- End of Automatically Added Cont..."
c49f7460,micro,7,,"dev_set_window (WindowHandles[0])
dev_clear_window ()
Message := 'Calibrate camera with a telecentric tilt lens'
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')
dev_set_window (WindowHandles[1])
dev_set_color ('green')",79,85,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
* --- End of Automatically Added Cont..."
c49f7460,micro,8,"The tilt angle defines the angle by which the
lens is tilted.",Tilt := 8.5,86,89,
c49f7460,micro,9,"the axis around which the tilt is performed.
It is the angle between the x-axis of
the sensor and th...",Rot := 270,90,94,
c49f7460,micro,10,,Magnification := 0.35,95,96,
c49f7460,micro,11,,"Sx := 5.4e-6
Sy := Sx
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, 0.0, Tilt, Rot, Sx, Sy, Width / 2, Height / 2, Width, Height, StartCamParam)
DescrFile := 'calplate_40mm.cpd'",97,101,"* --- Automatically Added Context ---
get_image_size (ImageBlurred, Width, Height)
Tilt := 8.5
Rot := 270
Magnification := 0.35
* --- End of Automatically Added Context ---"
c49f7460,micro,12,"overlaps in a large area for both cameras, the depth of field is
wedge-shaped, where the wedge of on...",Sigma := 2.5,102,110,
c49f7460,micro,13,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamParam)
set_calib_data_calib_object (CalibDataID, 0, DescrFile)",111,115,"* --- Automatically Added Context ---
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, 0.0, Tilt, Rot, Sx, Sy, Width / 2, Height / 2, Width, Height, StartCamParam)
DescrFile :..."
c49f7460,micro,14,,"for Index := 1 to 8 by 1
read_image (Image, 'stereo/telecentric_tilt/cam_0_calib_plate_' + Index$'02')
find_calib_object (Image, CalibDataID, 0, 0, Index, 'sigma', Sigma)
get_calib_data_observ_contours (Caltab, CalibDataID, 'caltab', 0, 0, Index)
get_calib_data_observ_contours (Circles, CalibDataID,...",116,128,"* --- Automatically Added Context ---
Sigma := 2.5
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
c49f7460,micro,15,,"calibrate_cameras (CalibDataID, Error)
dev_set_window (WindowHandles[1])
dev_clear_window ()",129,132,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added ..."
c49f7460,micro,16,,"get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)",133,134,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
c49f7460,micro,17,,"get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)",135,137,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
c49f7460,micro,18,,"display_camera_parameters (StartCamParam, CamParam, Error, ParLabels$'-5', WindowHandles[1])
dev_set_window (WindowHandles[0])
dev_clear_window ()
Message := 'Discussion of the calibration results:'
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')
Message[0] := 'The calibr...",138,162,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
Message[3] := 'that contains the obje..."
c49f7460,micro,19,,"dev_set_window (WindowHandles[0])
dev_clear_window ()
Message := 'Use the calibration results:'
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')
Message := 'Measure the mean distance of the pitch lines'
Message[1] := 'of a caliper with high accuracy.'
disp_message (WindowH...",163,174,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
Message := 'This example demonstrates the benefit of a'
read_image (ImageSharp, 'caliper/cali..."
c49f7460,micro,20,camera parameters,"read_image (ImageMeasurementPlane, 'caliper/caliper_measurement_plane')
find_calib_object (ImageMeasurementPlane, CalibDataID, 0, 0, 0, 'sigma', 0.5)
get_calib_data_observ_points (CalibDataID, 0, 0, 0, RowCoor, ColumnCoord, Indices, Poses)",175,180,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
c49f7460,micro,21,,"gen_measure_rectangle2 (670, 640, rad(0), 635, 31, Width, Height, 'bilinear', MeasureHandle)
gen_rectangle2 (Rectangle, 670, 640, rad(0), 635, 31)",188,191,"* --- Automatically Added Context ---
get_image_size (ImageBlurred, Width, Height)
* --- End of Automatically Added Context ---"
c49f7460,micro,22,,"measure_pairs (ImageSharp, MeasureHandle, 2, 50, 'all', 'all', RowEdgeFirst, ColumnEdgeFirst, AmplitudeFirst, RowEdgeSecond, ColumnEdgeSecond, AmplitudeSecond, IntraDistance, InterDistance)
Row := (RowEdgeFirst + RowEdgeSecond) / 2.0
Col := (ColumnEdgeFirst + ColumnEdgeSecond) / 2.0
gen_cross_contou...",192,199,"* --- Automatically Added Context ---
read_image (ImageSharp, 'caliper/caliper_with_tilt')
gen_measure_rectangle2 (670, 640, rad(0), 635, 31, Width, Height, 'bilinear', MeasureHandle)
* --- End of Aut..."
c49f7460,micro,23,,"image_points_to_world_plane (CamParam, Poses, Row, Col, 'mm', X1, Y1)
distance_pp (X1[0:2], Y1[0:2], X1[1:3], Y1[1:3], Distance)",200,203,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
get_calib_data_observ_points (CalibDataID, 0, 0, 0, RowCoor, ColumnCoord, Indices, Poses)
Row := (Ro..."
c49f7460,micro,24,,"MeanDistance := mean(Distance)
DeviationDistance := deviation(Distance)
disp_message (WindowHandles[1], ['Mean distance: ' + MeanDistance$'.3f' + ' mm','Deviation:'$'-15' + DeviationDistance$'.3f' + ' mm'], 'window', 12, 12, 'black', 'true')",204,224,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
distance_pp (X1[0:2], Y1[0:2], X1[1:3], Y1[1:3], Distance)
* --- End of Automatically Added C..."
c49f7460,micro,25,the images and results for this example,"dev_open_window (0, 0, Width * Scale, Height * Scale, 'white', WindowHandle1)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_set_draw ('margin')
dev_set_line_width (1)
dev_set_color ('green')
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_open_window (0, (Width * Scale) + 8, Width...",225,262,"* --- Automatically Added Context ---
open_two_windows_setup (WindowWidth, WindowHeight, 1, WindowHandles)
get_image_size (ImageBlurred, Width, Height)
* --- End of Automatically Added Context ---"
c49f7460,micro,26,,"dev_get_window (WindowHandleTmp)
dev_set_window (WindowHandle)
dev_clear_window ()
Message := 'Compare initial and calibrated camera'
Message[1] := 'parameters'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
get_window_extents (WindowHandle, Row, Column, Width, Height)
disp_...",263,272,"* --- Automatically Added Context ---
Message := 'This example demonstrates the benefit of a'
get_image_size (ImageBlurred, Width, Height)
calibrate_cameras (CalibDataID, Error)
Message[6] := 'This ti..."
c49f7460,micro,27,,"for Index := 1 to |ParLabels| - 1 by 1
if (strlen(ParLabels[Index]) &gt; 5)
ParLabels[Index] := ParLabels[Index]{0:3} + '.'
endif
endfor",273,278,"* --- Automatically Added Context ---
for Index := 1 to 8 by 1
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
* --- End of Automatically Added Context ---"
c49f7460,micro,28,,"Message := ['Initial parameters:', ' ']
Style := ['.4f', '.2f', '.2f', '.2f', '.2e', '.2e', '.2f', '.2f']
Unit := [' ', '', ' deg', ' deg', ' m', ' m', ' px', ' px']
for Index := 1 to |StartCamParam| - 3 by 1
Message := [Message,ParLabels[Index] + ' = ' + StartCamParam[Index]$Style[Index - 1] + Unit...",279,286,"* --- Automatically Added Context ---
Message := 'This example demonstrates the benefit of a'
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, 0.0, Tilt, Rot, Sx, Sy, Width / ..."
c49f7460,micro,29,,"Message := ['Calibrated parameters:', ' ']
Style := ['.4f', '.2f', '.2f', '.2f', '.2e', '.2e', '.2f', '.2f']
Unit := [' ', '', ' deg', ' deg', ' m', ' m', ' px', ' px']
for Index := 1 to |CamParam| - 3 by 1
Message := [Message,ParLabels[Index] + ' = ' + CamParam[Index]$Style[Index - 1] + Unit[Index ...",287,319,"* --- Automatically Added Context ---
Message := 'This example demonstrates the benefit of a'
get_image_size (ImageBlurred, Width, Height)
for Index := 1 to 8 by 1
get_calib_data (CalibDataID, 'camera..."
c49f7460,micro,30,,"dev_set_window (WindowHandle)
dev_clear_window ()
get_window_extents (WindowHandle, WRow, WColumn, WindowWidth, WindowHeight)
S := [340, 10]
LP := [170, 210]
OP := [S[0],410]
L := 240
Phi1 := rad(135)
Phi2 := rad(155)
CP := [S[0] + L * cos(Phi2),S[1] + L * sin(Phi2)]
gen_rectangle1 (Obstacle, 0, 258...",320,391,"* --- Automatically Added Context ---
WindowWidth := 500
WindowHeight := 400
crop_rectangle1 (ImageBlurred, ImagePart, 134, 134, 1000, 1000)
Tilt := 8.5
Row := (RowEdgeFirst + RowEdgeSecond) / 2.0
mea..."
780d770d,full,0,"This example demonstrates how to calibrate a stereo camera
system with telecentric tilt lenses using...","dev_update_off ()
dev_close_window ()
read_image (Image, 'stereo/telecentric_tilt/cam_0_calib_plate_01.png')
get_image_size (Image, Width, Height)
NumCameras := 2
NumCalibObjects := 1
CalibSetup := 'calibration_object'
DescrFile := 'calplate_40mm.cpd'
Magnification := 1.0 / 2.8
Sx := 5.2e-6
Sy := 5....",10,283,
780d770d,micro,1,"system with telecentric tilt lenses using the new
HALCON calibration plate.","dev_update_off ()
dev_close_window ()",6,12,
780d770d,micro,2,,"read_image (Image, 'stereo/telecentric_tilt/cam_0_calib_plate_01.png')
get_image_size (Image, Width, Height)",13,16,
780d770d,micro,3,,"NumCameras := 2
NumCalibObjects := 1
CalibSetup := 'calibration_object'
DescrFile := 'calplate_40mm.cpd'",17,22,
780d770d,micro,4,Magnification,Magnification := 1.0 / 2.8,23,25,
780d770d,micro,5,,"Sx := 5.2e-6
Sy := 5.2e-6",26,28,
780d770d,micro,6,,"Tilt_Cam_0 := 8.5
Tilt_Cam_1 := 0.5",29,31,
780d770d,micro,7,"which the tilt is performed. It is the angle between the x-axis
of the sensor and the tilt axis of t...","Rot_Cam_0 := 270
Rot_Cam_1 := 90
Kappa := 0
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, Kappa, Tilt_Cam_0, Rot_Cam_0, Sx, Sy, Width / 2, Height / 2, Width, Height, InitialCamParam_Cam_0)
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, Kappa, Ti...",32,39,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
Magnification := 1.0 / 2.8
Sx := 5.2e-6
Sy := 5.2e-6
Tilt_Cam_0 := 8.5
Tilt_Cam_1 := 0.5
* --- End of Automatically Added Co..."
780d770d,micro,8,"overlaps in a large area for both cameras, the depth of field is
wedge-shaped, where the wedge of on...",Sigma := 2.5,40,48,
780d770d,micro,9,,"create_calib_data (CalibSetup, NumCameras, NumCalibObjects, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, DescrFile)",49,52,"* --- Automatically Added Context ---
NumCameras := 2
NumCalibObjects := 1
CalibSetup := 'calibration_object'
DescrFile := 'calplate_40mm.cpd'
* --- End of Automatically Added Context ---"
780d770d,micro,10,,"set_calib_data_cam_param (CalibDataID, 0, [], InitialCamParam_Cam_0)
set_calib_data_cam_param (CalibDataID, 1, [], InitialCamParam_Cam_1)",53,56,"* --- Automatically Added Context ---
gen_cam_par_area_scan_tilt_bilateral_telecentric_division (Magnification, Kappa, Tilt_Cam_0, Rot_Cam_0, Sx, Sy, Width / 2, Height / 2, Width, Height, InitialCamPa..."
780d770d,micro,11,,"open_windows_multi_view_setup (Height, Width, 0.4, WindowHandles)
for Index := 1 to 8 by 1
read_image (Image0, 'stereo/telecentric_tilt/cam_0_calib_plate_' + Index$'02')
read_image (Image1, 'stereo/telecentric_tilt/cam_1_calib_plate_' + Index$'02')
find_calib_object (Image0, CalibDataID, 0, 0, Index...",57,83,"* --- Automatically Added Context ---
read_image (Image, 'stereo/telecentric_tilt/cam_0_calib_plate_01.png')
get_image_size (Image, Width, Height)
Sigma := 2.5
create_calib_data (CalibSetup, NumCamera..."
780d770d,micro,12,,"calibrate_cameras (CalibDataID, Error)",84,86,"* --- Automatically Added Context ---
create_calib_data (CalibSetup, NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
780d770d,micro,13,,"get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParams0)
get_calib_data (CalibDataID, 'camera', 1, 'params', CamParams1)",87,90,"* --- Automatically Added Context ---
create_calib_data (CalibSetup, NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
780d770d,micro,14,,"get_calib_data (CalibDataID, 'camera', 0, 'pose_labels', PoseLabels)",91,92,"* --- Automatically Added Context ---
create_calib_data (CalibSetup, NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
780d770d,micro,15,,"get_calib_data (CalibDataID, 'camera', 1, 'pose', RelCamPose)",93,95,"* --- Automatically Added Context ---
create_calib_data (CalibSetup, NumCameras, NumCalibObjects, CalibDataID)
* --- End of Automatically Added Context ---"
780d770d,micro,16,,"Units := ['', '', '', '°', '°', 'm', 'm', 'px', 'px', 'px', 'px']
FormatStringLabels := max(strlen(ParLabels))$'0' + 's'
FormatStringParams := ''
CamParTable0 := ParLabels$FormatStringLabels + ' = ' + CamParams0 + ' ' + Units
CamParTable1 := ParLabels$FormatStringLabels + ' = ' + CamParams1 + ' ' + ...",96,105,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params_labels', ParLabels)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParams0)
get_calib_data (CalibDataID,..."
780d770d,micro,17,,"dev_set_window (WindowHandles[0])
dev_clear_window ()
Message := [Text,CamParTable0,' ','Back projection error = ' + Error$'.3f' + ' px']
disp_message (WindowHandles[0], Message, 'window', 12, 12, 'black', 'true')",106,110,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, 0.4, WindowHandles)
calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels'..."
780d770d,micro,18,,"dev_set_window (WindowHandles[1])
dev_clear_window ()
Text[2] := 'The final camera parameters of camera 1 are:'
Message := [Text,CamParTable1,' ','Back projection error = ' + Error$'.3f' + ' px']
disp_message (WindowHandles[1], Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (Windo...",111,119,"* --- Automatically Added Context ---
open_windows_multi_view_setup (Height, Width, 0.4, WindowHandles)
calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params_labels'..."
780d770d,micro,19,"the calibrated stereo camera system
*************************************************
Set image file...","ImageFiles := ['stereo/telecentric_tilt/cam_0_cartridge', 'stereo/telecentric_tilt/cam_1_cartridge', 'stereo/telecentric_tilt/cam_0_tissue', 'stereo/telecentric_tilt/cam_1_tissue']",120,124,
780d770d,micro,20,the distance values,"GrayConstancy := 0.07
GradientConstancy := 80
Smoothness := 10
InitialGuess := 0",125,131,
780d770d,micro,21,distance values to the camera system,"for Index := 0 to |ImageFiles| - 1 by 2
read_image (Image0, ImageFiles[Index])
read_image (Image1, ImageFiles[Index + 1])
get_image_size (Image0, Width, Height)
gen_binocular_rectification_map (Map1, Map2, CamParams0, CamParams1, RelCamPose, 1, 'viewing_direction', 'bilinear', CamParamRect0, CamPara...",132,206,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
open_windows_multi_view_setup (Height, Width, 0.4, WindowHandles)
for Index := 1 to 8 by 1
read_image (Image0, 'stereo/telec..."
780d770d,micro,22,"the images of a multi-view stereo setup consisting
of four cameras","dev_open_window (0, 0, Width * Scale, Height * Scale, 'black', WindowHandle0)
dev_set_draw ('margin')
dev_set_line_width (2)
dev_set_color ('forest green')
set_display_font (WindowHandle0, 14, 'mono', 'true', 'false')
dev_open_window (0, (Width * Scale) + 8, Width * Scale, Height * Scale, 'black', W...",207,264,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
open_windows_multi_view_setup (Height, Width, 0.4, WindowHandles)
* --- End of Automatically Added Context ---"
780d770d,micro,23,to the domain of the distance image,"get_domain (DistanceImage, Domain)
intersection (RegionDefiningReferencePlane, Domain, RegionDefiningReferencePlane)",265,268,"* --- Automatically Added Context ---
binocular_distance_mg (ImageRectified0, ImageRectified1, DistanceImage, ScoreImage, CamParamRect0, CamParamRect1, RelPoseRect, GrayConstancy, GradientConstancy, S..."
780d770d,micro,24,,"fit_surface_first_order (RegionDefiningReferencePlane, DistanceImage, 'tukey', 5, 2, Alpha, Beta, Mean)
moments_gray_plane (RegionDefiningReferencePlane, DistanceImage, MRow, MCol, Alpha, Beta, Mean)",269,271,"* --- Automatically Added Context ---
binocular_distance_mg (ImageRectified0, ImageRectified1, DistanceImage, ScoreImage, CamParamRect0, CamParamRect1, RelPoseRect, GrayConstancy, GradientConstancy, S..."
780d770d,micro,25,,"get_image_pointer1 (DistanceImage, Pointer, Type, Width, Height)
area_center (RegionDefiningReferencePlane, Area, Row, Column)
gen_image_surface_first_order (ReferencePlaneDistance, Type, Alpha, Beta, Mean, Row, Column, Width, Height)",272,275,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
binocular_distance_mg (ImageRectified0, ImageRectified1, DistanceImage, ScoreImage, CamParamRect0, CamParamRect1, RelPoseRec..."
780d770d,micro,26,from the distance image of the object,"sub_image (DistanceImage, ReferencePlaneDistance, DistanceImageWithoutTilt, 1, 0)",276,278,"* --- Automatically Added Context ---
binocular_distance_mg (ImageRectified0, ImageRectified1, DistanceImage, ScoreImage, CamParamRect0, CamParamRect1, RelPoseRect, GrayConstancy, GradientConstancy, S..."
780d770d,micro,27,,CosGamma := 1.0 / sqrt(Alpha * Alpha + Beta * Beta + 1),279,280,"* --- Automatically Added Context ---
fit_surface_first_order (RegionDefiningReferencePlane, DistanceImage, 'tukey', 5, 2, Alpha, Beta, Mean)
* --- End of Automatically Added Context ---"
780d770d,micro,28,,"scale_image (DistanceImageWithoutTilt, DistanceImageCorrected, CosGamma, 0)
return ()",281,294,"* --- Automatically Added Context ---
tilt_correction (DistanceImage, RegionDefiningReferencePlane, DistanceImageCorrected)
fit_surface_first_order (RegionDefiningReferencePlane, DistanceImage, 'tukey..."
2b53d98f,full,0,"This example program calculates evaluation measures
for calibration images similar to the Calibratio...","ImagePath := 'calib/check_calib_image_quality'
list_image_files (ImagePath, 'default', [], ImageFiles)
CalibObjDescr := 'calplate_160mm.cpd'
CalTabDescrFilePath := ''
read_caltab_descr_version (CalibObjDescr, CalTabDescrFilePath, PlateDescriptionVersion)
read_image (Image, ImageFiles[0])
get_image_s...",13,857,
2b53d98f,micro,1,,"ImagePath := 'calib/check_calib_image_quality'
list_image_files (ImagePath, 'default', [], ImageFiles)
CalibObjDescr := 'calplate_160mm.cpd'",12,15,
2b53d98f,micro,2,,"CalTabDescrFilePath := ''
read_caltab_descr_version (CalibObjDescr, CalTabDescrFilePath, PlateDescriptionVersion)
read_image (Image, ImageFiles[0])
get_image_size (Image, ImageWidth, ImageHeight)",16,20,"* --- Automatically Added Context ---
list_image_files (ImagePath, 'default', [], ImageFiles)
CalibObjDescr := 'calplate_160mm.cpd'
* --- End of Automatically Added Context ---"
2b53d98f,micro,3,,"gen_cam_par_area_scan_division (0.012, 0, 3.7e-006, 3.7e-006, ImageWidth / 2, ImageHeight / 2, ImageWidth, ImageHeight, StartCamParam)",21,23,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
* --- End of Automatically Added Context ---"
2b53d98f,micro,4,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandleImage)
set_display_font (WindowHandleImage, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)
get_window_extents (WindowHandleImage, Row1, Column1, Width1, Height1)
TestString ...",24,35,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
* --- End of Automatically Added Context ---"
2b53d98f,micro,5,,"FieldOfViewCoverageScore := 0
MarksDiameter := 0
OverexposureScore := 0
HomogeneityScore := 0
ContrastScore := 0
FocusScore := 0
TiltScore := 0
MarksDistributionScore := 0
NumImagesScore := 0",36,45,
2b53d98f,micro,6,,"NumImages := 0
ObservPointsRows := []
ObservPointsColumns := []
ObservPoses := []
gen_empty_obj (DistanceImage)
gen_empty_obj (CoverageRegion)",46,52,
2b53d98f,micro,7,,"for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
count_channels (Image, Channels)
if (Channels &gt; 1)
rgb1_to_gray (Image, Image)
endif
NumImages := NumImages + 1
gen_empty_region (CalibPlateMarks)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_da...",53,167,"* --- Automatically Added Context ---
list_image_files (ImagePath, 'default', [], ImageFiles)
CalibObjDescr := 'calplate_160mm.cpd'
read_caltab_descr_version (CalibObjDescr, CalTabDescrFilePath, Plate..."
2b53d98f,micro,8,,"WarningThreshold := 0.7
ColorText := 'white'
ColorResOK := 'white'
ColorResNOK := 'orange'",168,173,
2b53d98f,micro,9,,"TopMargin := 10
SideMargin := 10
Offset := 10",174,177,
2b53d98f,micro,10,,"get_string_extents (WindowHandle, 'Field of View Coverage: ', Ascent, Descent, ColumnWidth, StringHeight)
Column1StartWidth := SideMargin
Column2StartWidth := SideMargin + ColumnWidth + Offset
CurrentTextHeight := TopMargin",178,183,"* --- Automatically Added Context ---
get_string_extents (WindowHandleImage, TestString, Ascent, Descent, StringWidth, StringHeight)
dev_set_window (WindowHandle)
TopMargin := 10
SideMargin := 10
Offs..."
2b53d98f,micro,11,Header.,"TextHeader := 'Quality Scores: Single Image'
TextHeader[|TextHeader|] := '----------------------------'
dev_disp_text (TextHeader, 'window', CurrentTextHeight, Column1StartWidth, ColorText, 'box', 'false')
get_string_extents (WindowHandle, TextHeader, Ascent, Descent, StringWidth, StringHeight)
Curr...",184,191,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
get_string_extents (WindowHandleImage, TestString, Ascent, Descent, StringWidth, StringHeight)
dev_set_window (WindowHandle)
Col..."
2b53d98f,micro,12,,"Text := 'Finder Pattern: '
Text[|Text|] := 'Diameter of Marks: '
Text[|Text|] := 'Exposure: '
Text[|Text|] := 'Homogeneity: '
Text[|Text|] := 'Contrast: '
Text[|Text|] := 'Focus: '
dev_disp_text (Text, 'window', CurrentTextHeight, Column1StartWidth, ColorText, 'box', 'false')
get_string_extents (Win...",192,201,"* --- Automatically Added Context ---
get_string_extents (WindowHandleImage, TestString, Ascent, Descent, StringWidth, StringHeight)
evaluate_caltab_image_contrast_homogeneity (Image, CalibPlateMarks,..."
2b53d98f,micro,13,,"TextRes := PatternCoverageScore$'.2f'
TextRes[|TextRes|] := MarksDiameterScore$'.2f' + '  (' + MarksDiameter$'.1f' + ' px)'
TextRes[|TextRes|] := OverexposureScore$'.2f'
TextRes[|TextRes|] := HomogeneityScore$'.2f'
TextRes[|TextRes|] := ContrastScore$'.2f'
TextRes[|TextRes|] := FocusScore$'.2f'",202,208,"* --- Automatically Added Context ---
MarksDiameter := 0
OverexposureScore := 0
HomogeneityScore := 0
ContrastScore := 0
FocusScore := 0
evaluate_caltab_image_pattern_coverage (Image, CalibDataID, Pat..."
2b53d98f,micro,14,,"ColorRes := gen_tuple_const(|TextRes|,ColorResOK)
if (PatternCoverageScore &lt;= WarningThreshold)
ColorRes[0] := ColorResNOK
endif
if (MarksDiameterScore &lt;= WarningThreshold)
ColorRes[1] := ColorResNOK
endif
if (OverexposureScore &lt;= WarningThreshold)
ColorRes[2] := ColorResNOK
endif
if (Homog...",209,232,"* --- Automatically Added Context ---
get_string_extents (WindowHandleImage, TestString, Ascent, Descent, StringWidth, StringHeight)
OverexposureScore := 0
HomogeneityScore := 0
ContrastScore := 0
Foc..."
2b53d98f,micro,15,Header.,"TextHeader := 'Quality Scores: Whole Sequence'
TextHeader[|TextHeader|] := '------------------------------'
dev_disp_text (TextHeader, 'window', CurrentTextHeight, Column1StartWidth, ColorText, 'box', 'false')
get_string_extents (WindowHandle, TextHeader, Ascent, Descent, StringWidth, StringHeight)
...",233,239,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
get_string_extents (WindowHandleImage, TestString, Ascent, Descent, StringWidth, StringHeight)
dev_set_window (WindowHandle)
Col..."
2b53d98f,micro,16,,"Text := 'Number of Images: '
Text[|Text|] := 'Field of View Coverage: '
Text[|Text|] := 'Tilt Angles: '
dev_disp_text (Text, 'window', CurrentTextHeight, Column1StartWidth, ColorText, 'box', 'false')",240,244,"* --- Automatically Added Context ---
ColorText := 'white'
TopMargin := 10
SideMargin := 10
get_string_extents (WindowHandle, 'Field of View Coverage: ', Ascent, Descent, ColumnWidth, StringHeight)
Co..."
2b53d98f,micro,17,,"TextRes := NumImagesScore$'.2f'
TextRes[|TextRes|] := MarksDistributionScore$'.2f'
TextRes[|TextRes|] := TiltScore$'.2f'",245,248,"* --- Automatically Added Context ---
TiltScore := 0
MarksDistributionScore := 0
NumImagesScore := 0
evaluate_caltab_image_pattern_coverage (Image, CalibDataID, PatternCoverageScore)
TextRes := Patter..."
2b53d98f,micro,18,,"ColorRes := gen_tuple_const(|TextRes|,ColorResOK)
if (NumImagesScore &lt;= WarningThreshold)
ColorRes[0] := ColorResNOK
endif
if (MarksDistributionScore &lt;= WarningThreshold)
ColorRes[1] := ColorResNOK
endif
if (TiltScore &lt;= WarningThreshold)
ColorRes[2] := ColorResNOK
endif
dev_disp_text (Text...",249,323,"* --- Automatically Added Context ---
TiltScore := 0
MarksDistributionScore := 0
NumImagesScore := 0
gen_empty_obj (DistanceImage)
evaluate_caltab_image_pattern_coverage (Image, CalibDataID, PatternCo..."
2b53d98f,micro,19,"of the amount of overexposure
in the calibration plate image.","OverexposureScore := 0.0
area_center (RegionCalibPlate, AreaCalibPlate, Row, Column)
if (AreaCalibPlate == 0 or AreaCalibPlate == [])
return ()
endif
reduce_domain (ImageCalibPlate, RegionCalibPlate, ImageReduced)",324,332,"* --- Automatically Added Context ---
OverexposureScore := 0
get_calib_data_observ_points (CalibDataID, 0, 0, 0, Row, Column, I, Pose)
shape_trans (RegionUnion, RegionCalibPlate, 'convex')
* --- End o..."
2b53d98f,micro,20,we interpret this as overexposure.,"threshold (ImageReduced, Region, 240, 255)
area_center (Region, AreaOverexp, Row, Column)
MaxRatio := 0.15
Ratio := real(AreaOverexp) / AreaCalibPlate
if (Ratio &lt; MaxRatio)
OverexposureScore := min([1.0,1 - Ratio / MaxRatio])
endif
return ()
ContrastScore := 0.0
Contrast := 0.0
HomogeneityScore :...",333,391,"* --- Automatically Added Context ---
OverexposureScore := 0
HomogeneityScore := 0
ContrastScore := 0
gen_empty_region (CalibPlateMarks)
get_calib_data_observ_points (CalibDataID, 0, 0, 0, Row, Column..."
2b53d98f,micro,21,,"gen_region_contour_xld (CalibPlateMarks, Region, 'margin')
dilation_circle (Region, RegionDilation, 5.5)
min_max_gray (RegionDilation, ImageCalibPlate, 3, Min, Max, Range)
Contrast := mean(Range)",392,396,"* --- Automatically Added Context ---
gen_empty_region (CalibPlateMarks)
gen_region_contour_xld (CalibPlateMarks, Region, 'filled')
evaluate_caltab_image_contrast_homogeneity (Image, CalibPlateMarks, ..."
2b53d98f,micro,22,Indicates the average contrast of the calibration mark,"MinContrast := 70.0
SufficientContrast := 100.0
if (Contrast &gt; MinContrast)
ContrastScore := (Contrast - MinContrast) / (SufficientContrast - MinContrast)
ContrastScore := min([ContrastScore,1.0])
endif",397,404,"* --- Automatically Added Context ---
ContrastScore := 0
evaluate_caltab_image_contrast_homogeneity (Image, CalibPlateMarks, Contrast, ContrastScore, HomogeneityScore)
* --- End of Automatically Added..."
2b53d98f,micro,23,"Indicates the homogeneity of the calibration marks
concerning their brightness.","HomogeneityScore := 1.1 - (deviation(Max) / 40.0)
HomogeneityScore := max([min([HomogeneityScore,1.0]),0.0])
return ()",405,468,"* --- Automatically Added Context ---
HomogeneityScore := 0
min_max_gray (RegionDilation, ImageCalibPlate, 3, Min, Max, Range)
* --- End of Automatically Added Context ---"
2b53d98f,micro,24,"the contrast of the markers boundary
(= MeanGradient)
with the contrast values found
around the boun...","FocusScore := 0.0
if (Contrast == 0)
return ()
endif
count_obj (CalibPlateMarks, Number)
if (Number &lt; 4)
return ()
endif
gen_region_contour_xld (CalibPlateMarks, Region, 'margin')
union1 (Region, RegionUnion)
reduce_domain (ImageCalibPlate, RegionUnion, ImageReduced)
derivate_gauss (ImageReduced,...",469,488,"* --- Automatically Added Context ---
FocusScore := 0
gen_empty_region (CalibPlateMarks)
gen_region_contour_xld (CalibPlateMarks, Region, 'filled')
union1 (Region, RegionUnion)
evaluate_caltab_image_c..."
2b53d98f,micro,25,,RawResult := MeanGradient / Contrast,489,490,"* --- Automatically Added Context ---
evaluate_caltab_image_contrast_homogeneity (Image, CalibPlateMarks, Contrast, ContrastScore, HomogeneityScore)
intensity (Region, DerivGauss, MeanGradient, Deviat..."
2b53d98f,micro,26,,"FocusScore := sort(RawResult * 4.5)[round(|RawResult| / 20.0)]
FocusScore := min([max([FocusScore - MinScore,0.0]),1.0])
return ()",491,532,"* --- Automatically Added Context ---
FocusScore := 0
evaluate_caltab_image_contrast_homogeneity (Image, CalibPlateMarks, Contrast, ContrastScore, HomogeneityScore)
MinScore := 0.25
intensity (Region,..."
2b53d98f,micro,27,the mean diameter of the calibration marks.,"MarksDiameter := 0.0
MarksDiameterScore := 0.0
count_obj (Marks, Number)
if (Number &lt; 4)
return ()
endif
gen_region_contour_xld (Marks, Region, 'filled')
diameter_region (Region, Row11, Column11, Row2, Column2, MarksDiameter)
MarksDiameter := mean(MarksDiameter)
DiameterScoreFull := 20
DiameterSc...",533,585,"* --- Automatically Added Context ---
MarksDiameter := 0
gen_region_contour_xld (CalibPlateMarks, Region, 'filled')
evaluate_caltab_image_marks_diameter (CalibPlateMarks, MarksDiameter, MakrsDiameterS..."
2b53d98f,micro,28,calibration marks cover the whole field of view.,"gen_region_points (Region, ObservPointsRows, ObservPointsColumns)
ImageWidth := max([ImageWidth,ObservPointsColumns])
ImageHeight := max([ImageHeight,ObservPointsRows])
distance_transform (Region, DistanceImage, 'octagonal', 'false', ImageWidth, ImageHeight)",586,592,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
ObservPointsRows := []
ObservPointsColumns := []
gen_empty_obj (DistanceImage)
gen_region_contour_xld (CalibPlateM..."
2b53d98f,micro,29,,"Border := max([ImageWidth,ImageHeight]) / 15
gen_rectangle1 (Mask, Border, Border, ImageHeight - 1 - Border, ImageWidth - 1 - Border)",593,595,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
* --- End of Automatically Added Context ---"
2b53d98f,micro,30,,"min_max_gray (Mask, DistanceImage, 0, Min, Max, Range)",596,597,"* --- Automatically Added Context ---
gen_empty_obj (DistanceImage)
min_max_gray (RegionDilation, ImageCalibPlate, 3, Min, Max, Range)
gen_rectangle1 (Mask, Border, Border, ImageHeight - 1 - Border, I..."
2b53d98f,micro,31,,"distance_pp (0, 0, ImageHeight - 1, ImageWidth - 1, ImageDiagonal)
MinThresh := 0.3
MaxThresh := 0.85
Ratio := Max / ImageDiagonal * 2.5
Tmp1 := 1 - Ratio
Tmp2 := (Tmp1 - MinThresh) / (MaxThresh - MinThresh)
FieldOfViewCoverageScore := max([min([Tmp2,1.0]),0.0])",598,607,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
FieldOfViewCoverageScore := 0
area_center (RegionCalibPlate, AreaCalibPlate, Row, Column)
Ratio := real(AreaOverex..."
2b53d98f,micro,32,,"dilation_circle (Region, RegionDilation, MarksDiameter * 1.25)
distance_transform (RegionDilation, DistanceImage, 'octagonal', 'false', ImageWidth, ImageHeight)
return ()",608,634,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
gen_empty_obj (DistanceImage)
MarksDiameter := 0
gen_region_contour_xld (CalibPlateMarks, Region, 'filled')
dilati..."
2b53d98f,micro,33,,NrPoses := |ObservPoses| / 7,638,639,"* --- Automatically Added Context ---
ObservPoses := []
* --- End of Automatically Added Context ---"
2b53d98f,micro,34,,"PoseIsDupl := gen_tuple_const(NrPoses,0)
if (NrPoses &gt; 1)
for IndPose1 := 0 to NrPoses - 2 by 1
if (PoseIsDupl[IndPose1])
continue
endif
Pose1 := ObservPoses[IndPose1 * 7:(IndPose1 + 1) * 7 - 1]
for IndPose2 := IndPose1 + 1 to NrPoses - 1 by 1
Pose2 := ObservPoses[IndPose2 * 7:(IndPose2 + 1) * 7 ...",640,655,"* --- Automatically Added Context ---
ObservPoses := []
NrPoses := |ObservPoses| / 7
* --- End of Automatically Added Context ---"
2b53d98f,micro,35,"Bring the values into the interval (-180, 180].","Slant := []
Pan := []
for IndPose := 0 to NrPoses - 1 by 1
if (not PoseIsDupl[IndPose])
SlantPose := ObservPoses[7 * IndPose + 3]
if (SlantPose &gt; 180)
SlantPose := 360 - SlantPose
endif
Slant := [Slant,SlantPose]
PanPose := ObservPoses[7 * IndPose + 4]
if (PanPose &gt; 180)
PanPose := 360 - PanPo...",656,674,"* --- Automatically Added Context ---
ObservPoses := []
NrPoses := |ObservPoses| / 7
PoseIsDupl := gen_tuple_const(NrPoses,0)
* --- End of Automatically Added Context ---"
2b53d98f,micro,36,,"SlantFunctVal := min2(abs(Slant),75)
SlantFunctVal := SlantFunctVal * 90.0 / 75.0
PanFunctVal := min2(abs(Pan),75)
PanFunctVal := PanFunctVal * 90.0 / 75.0",675,680,"* --- Automatically Added Context ---
Slant := []
Pan := []
* --- End of Automatically Added Context ---"
2b53d98f,micro,37,Sort the scores in decreasing order in order to pick the highest values easily.,"PanScores := 1 - abs(pow(cos(rad(PanFunctVal * 2)),2))
PanScores := min2(PanScores * 1.05,1.0)
PanScores := inverse(sort(PanScores))
SlantScores := 1 - abs(pow(cos(rad(SlantFunctVal * 2)),2))
SlantScores := min2(SlantScores * 1.05,1.0)
SlantScores := inverse(sort(SlantScores))",681,688,"* --- Automatically Added Context ---
Slant := []
Pan := []
SlantFunctVal := min2(abs(Slant),75)
PanFunctVal := min2(abs(Pan),75)
* --- End of Automatically Added Context ---"
2b53d98f,micro,38,,"MinNumImFullScore := 4
NumImUsedForScore := min([MinNumImFullScore,|SlantScores|])
SlantScore := sum(SlantScores[0:NumImUsedForScore - 1]) / MinNumImFullScore
PanScore := sum(PanScores[0:NumImUsedForScore - 1]) / MinNumImFullScore",689,694,"* --- Automatically Added Context ---
Slant := []
Pan := []
SlantFunctVal := min2(abs(Slant),75)
PanFunctVal := min2(abs(Pan),75)
PanScores := 1 - abs(pow(cos(rad(PanFunctVal * 2)),2))
SlantScores := ..."
2b53d98f,micro,39,,"TiltScore := (PanScore + SlantScore) * 0.5
return ()",695,716,"* --- Automatically Added Context ---
TiltScore := 0
Slant := []
Pan := []
SlantFunctVal := min2(abs(Slant),75)
PanFunctVal := min2(abs(Pan),75)
PanScores := 1 - abs(pow(cos(rad(PanFunctVal * 2)),2))
..."
2b53d98f,micro,40,,"PlateDescriptionVersion := 0
if (CalTabDescrFilePath == '')
EnvHalconRoot := environment('HALCONROOT')
CalTabDescrFilePath := EnvHalconRoot + '/calib'
else
CalTabDescrFilePath := regexp_replace(CalTabDescrFilePath,'/*[ ]*$','')
endif
try
open_file (CalTabDescrFilePath + '/' + CalTabDescrFile, 'input...",720,777,"* --- Automatically Added Context ---
CalTabDescrFilePath := ''
read_caltab_descr_version (CalibObjDescr, CalTabDescrFilePath, PlateDescriptionVersion)
* --- End of Automatically Added Context ---"
2b53d98f,micro,41,,"tuple_is_number (Tuple + '0', IsNumber)
if ((IsNumber == 0) or (strlen(Tuple + '0') == 1))
if (strlen(Tuple) == 0)
IsEmpty := true
endif
endif
return ()",778,804,"* --- Automatically Added Context ---
is_empty (Matches, IsEmpty)
if (|Tuple| == 0)
* --- End of Automatically Added Context ---"
2b53d98f,micro,42,,"NumImagesScore := 0.0
if (PlateDescriptionVersion &gt; 2)
MinRecommendedImages := 6
NumImagesScore := min2(real(NumImages) / real(MinRecommendedImages),1)
else
if (NumImages &lt; 6)
NumImagesScore := 0.0
else
NumImagesScore := min2(0.1 * (NumImages - 5.0),1)
endif
endif",808,819,"* --- Automatically Added Context ---
read_caltab_descr_version (CalibObjDescr, CalTabDescrFilePath, PlateDescriptionVersion)
NumImagesScore := 0
NumImages := 0
* --- End of Automatically Added Contex..."
2b53d98f,micro,43,Increase the number of used images.,return (),820,844,
2b53d98f,micro,44,"a calibration plate of model CalibDAtaID
can be found on the Image
and returns a corresponding score...","PatternCoverageScore := 1.0
try
find_calib_object (Image, CalibDataID, 0, 0, 0, [], [])
catch (Exception)
PatternCoverageScore := 0
endtry
return ()",845,867,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[0])
create_calib_data ('calibration_object', 1, 1, CalibDataID)
evaluate_caltab_image_pattern_coverage (Image, CalibDataID, PatternC..."
cd31b205,full,0,"This example shows the calibration results using the camera models
'division' and 'polynomial'. A se...","dev_close_window ()
dev_close_window ()
dev_update_off ()
read_image (Image, 'calib/calib_distorted_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
set_display_font (WindowHandleL, 14, 'mono', 'true', 'false')
dev_set_line_width (1)
dev_set...",13,209,
cd31b205,micro,1,"'division' and 'polynomial'. A sequence of calibration images
acquired with a camera system using a ...","dev_close_window ()
dev_close_window ()
dev_update_off ()
read_image (Image, 'calib/calib_distorted_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
set_display_font (WindowHandleL, 14, 'mono', 'true', 'false')
dev_set_line_width (1)
dev_set...",6,46,
cd31b205,micro,2,,"for i := 1 to 69 by 1
read_image (Image, 'calib/calib_distorted_' + i$'.02')
find_calib_object (Image, DivCalibDataID, 0, 0, i, [], [])
disp_observ (Image, 'Camera Model Division', CalTabDescrFile, DivCalibDataID, i, WindowHandleL)
find_calib_object (Image, PolyCalibDataID, 0, 0, i, [], [])
disp_obs...",47,56,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
dev_open_window_fit_image (Image, 0, 400 + 5, 400,..."
cd31b205,micro,3,,"calibrate_cameras (DivCalibDataID, ErrorsDiv)
calibrate_cameras (PolyCalibDataID, ErrorsPoly)
dev_set_window (WindowHandleL)
dev_display (Image)
dev_set_window (WindowHandleR)
dev_display (Image)
disp_message (WindowHandleL, 'Compare Calibration Results', 'window', 12, 12, 'black', 'true')
disp_cont...",57,68,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
dev_open_window_fit_image (Image, 0, 400 + 5, 400,..."
cd31b205,micro,4,,"get_calib_data (DivCalibDataID, 'camera', 0, 'params', CamParamDiv)
get_calib_data (PolyCalibDataID, 'camera', 0, 'params', CamParamPoly)
caltab_points (CalTabDescrFile, X, Y, Z)
for i := 0 to 68 by 2
read_image (Image, 'calib/calib_distorted_' + (i + 1)$'.02')
get_calib_data_observ_points (DivCalib...",69,100,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
dev_open_window_fit_image (Image, 0, 400 + 5, 400,..."
cd31b205,micro,5,,"i := 7
gen_rectangle1 (Rectangle, 25, 570, 80, Width - 7)
read_image (Image, 'calib/calib_distorted_' + (i + 1)$'.02')
dev_set_window (WindowHandleL)
dev_set_line_width (1)
dev_display (Image)
dev_set_color ('coral')
get_calib_data_observ_points (DivCalibDataID, 0, 0, i + 1, RowDiv, ColumnDiv, Index...",101,160,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 400, 400, WindowHandleL)
dev_open_win..."
cd31b205,micro,6,calibrated camera params and pose,"pose_to_hom_mat3d (FinalPose, H)
affine_trans_point_3d (H, X, Y, Z, Qx, Qy, Qz)
project_3d_point (Qx, Qy, Qz, CamParam, Row, Column)",161,165,"* --- Automatically Added Context ---
caltab_points (CalTabDescrFile, X, Y, Z)
* --- End of Automatically Added Context ---"
cd31b205,micro,7,coordinates,"DRow := ExtractedRow - Row
DColumn := ExtractedColumn - Column",166,169,"* --- Automatically Added Context ---
project_3d_point (Qx, Qy, Qz, CamParam, Row, Column)
* --- End of Automatically Added Context ---"
cd31b205,micro,8,,"Error := sqrt(sum(DRow * DRow + DColumn * DColumn) / |DRow|)
return ()
dev_set_window (WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'init_params', StartCamPar)
get_calib_data_observ_points (CalibDataID, 0, 0, PoseIdx, Row, Column, Index, Pose)
set_system ('flush_graphic', 'false')
dev_dis...",170,222,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01')
disp_message (WindowHandleL, 'Determine Marks and Pose of\nCalibration Plate for the Camera\nModels Division and Po..."
17344dd7,full,0,"This example program shows how to use the camera calibration
for images taken with linescan cameras....","NumCalibImages := 17
dev_close_window ()
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
OWFMaxExtent := 800
dev_open_window_fit_size (0, 0, Width, Height, Width * (real(OWFMaxExtent) / Height), OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, 'mon...",10,72,
17344dd7,micro,1,,"NumCalibImages := 17
dev_close_window ()
read_image (Image, 'calib/calib_line_scan_01')
get_image_size (Image, Width, Height)
OWFMaxExtent := 800
dev_open_window_fit_size (0, 0, Width, Height, Width * (real(OWFMaxExtent) / Height), OWFMaxExtent, WindowHandle)
set_display_font (WindowHandle, 14, 'mon...",9,17,
17344dd7,micro,2,parameters,"gen_cam_par_line_scan_division (0.06, 0, 10e-6, 10e-6, Width / 2.0, 0, Width, Height, 0, 5e-5, 0, StartCamParam)",18,20,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
17344dd7,micro,3,,CalTabDescrFile := 'caltab_30mm.descr',21,23,
17344dd7,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamParam)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescrFile)",24,28,"* --- Automatically Added Context ---
gen_cam_par_line_scan_division (0.06, 0, 10e-6, 10e-6, Width / 2.0, 0, Width, Height, 0, 5e-5, 0, StartCamParam)
CalTabDescrFile := 'caltab_30mm.descr'
* --- End ..."
17344dd7,micro,5,"calibration plates for all the calibration images and
collect them in the calibration data model.","dev_set_color ('white')
for i := 1 to NumCalibImages by 1
read_image (Image, 'calib/calib_line_scan_' + i$'02d')
find_calib_object (Image, CalibDataID, 0, 0, i, 'alpha', 0.5)
get_calib_data_observ_points (CalibDataID, 0, 0, i, Row, Column, Index, StartPose)
dev_display (Image)
disp_caltab (WindowHan...",29,42,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
dev_open_window_fit_size (0, 0, Width, Height, Width * (real(OWFMaxExtent) / Height), OWFMaxEx..."
17344dd7,micro,6,,"dev_clear_window ()
disp_message (WindowHandle, 'Please wait...', 'window', 0, 0, 'black', 'true')
calibrate_cameras (CalibDataID, Error)
dev_clear_window ()
disp_message (WindowHandle, 'Error = ' + Error$'.2f', 'window', 0, 0, 'black', 'true')",43,49,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, Width * (real(OWFMaxExtent) / Height), OWFMaxExtent, WindowHandle)
create_calib_data ('calibration_object', 1, 1, C..."
17344dd7,micro,7,,"get_calib_data (CalibDataID, 'calib_obj', 0, 'x', X)
get_calib_data (CalibDataID, 'calib_obj', 0, 'y', Y)
get_calib_data (CalibDataID, 'calib_obj', 0, 'z', Z)
gen_object_model_3d_from_points (X, Y, Z, OM3DCaltab)
OM3DsCaltab := []
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
for i :...",50,78,"* --- Automatically Added Context ---
NumCalibImages := 17
read_image (Image, 'calib/calib_line_scan_01')
dev_open_window_fit_size (0, 0, Width, Height, Width * (real(OWFMaxExtent) / Height), OWFMaxEx..."
1e8205de,full,0,"This example shows how to calibrate a line scan camera with
a telecentric lens.
In contrast to line ...","DistortionModel := 'division'
* DistortionModel := 'polynomial'
if (DistortionModel == 'division')
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 2560, 0, 30e-6, 0, CameraParamStart)
elseif (DistortionModel == 'polynomial')
gen_cam_par_line_scan_telecentric_poly...",23,518,
1e8205de,micro,1,,"DistortionModel := 'division'
* DistortionModel := 'polynomial'",22,25,
1e8205de,micro,2,,"if (DistortionModel == 'division')
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 2560, 0, 30e-6, 0, CameraParamStart)
elseif (DistortionModel == 'polynomial')
gen_cam_par_line_scan_telecentric_polynomial (0.228, 0, 0, 0, 0, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 256...",26,32,"* --- Automatically Added Context ---
DistortionModel := 'division'
* --- End of Automatically Added Context ---"
1e8205de,micro,3,,"dev_close_window ()
get_cam_par_data (CameraParamStart, 'image_width', Width)
get_cam_par_data (CameraParamStart, 'image_height', Height)
dev_open_window_fit_size (0, 0, Width, Height, 512, 768, WindowHandleOrig)
set_display_font (WindowHandleOrig, 14, 'mono', 'false', 'false')
dev_update_off ()",33,40,"* --- Automatically Added Context ---
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 2560, 0, 30e-6, 0, CameraParamStart)
* --- End of Automatically Added Context..."
1e8205de,micro,4,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, 'calplate_80mm.cpd')
set_calib_data_cam_param (CalibDataID, 0, [], CameraParamStart)
if (DistortionModel == 'polynomial')
set_calib_data (CalibDataID, 'camera', 'general', 'excluded_settings', 'p...",43,52,"* --- Automatically Added Context ---
DistortionModel := 'division'
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 2560, 0, 30e-6, 0, CameraParamStart)
* --- End ..."
1e8205de,micro,5,,"dev_set_color ('green')
for Index := 1 to 16 by 1
read_image (Image, 'calib/calib_line_scan_telecentric_' + Index$'02')
find_calib_object (Image, CalibDataID, 0, 0, Index, [], [])
dev_display (Image)
get_calib_data_observ_contours (Contours, CalibDataID, 'marks', 0, 0, Index)
dev_display (Contours)
...",53,65,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, 512, 768, WindowHandleOrig)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically ..."
1e8205de,micro,6,,"calibrate_cameras (CalibDataID, Error)",66,67,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
1e8205de,micro,7,,"get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
disp_camera_parameters (CameraParamStart, CameraParam, Error, WindowHandleOrig)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",68,73,"* --- Automatically Added Context ---
gen_cam_par_line_scan_telecentric_division (0.228, 0, 7e-6, 7e-6, 2048 / 2, 0, 2048, 2560, 0, 30e-6, 0, CameraParamStart)
dev_open_window_fit_size (0, 0, Width, H..."
1e8205de,micro,8,,"get_calib_data (CalibDataID, 'calib_obj', 0, 'x', X)
get_calib_data (CalibDataID, 'calib_obj', 0, 'y', Y)
get_calib_data (CalibDataID, 'calib_obj', 0, 'z', Z)
gen_object_model_3d_from_points (X, Y, Z, OM3DCaltab)
OM3DsCaltab := []
for i := 1 to 16 by 1
get_calib_data (CalibDataID, 'calib_obj_pose', ...",74,89,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
1e8205de,micro,9,,"read_image (Image, 'graph_paper')
dev_display (Image)
dev_disp_text ('Line scan image of a graph paper', 'window', 12, 12, 'black', [], [])",90,95,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_telecentric_' + Index$'02')
* --- End of Automatically Added Context ---"
1e8205de,micro,10,by setting all distortion parameters and vx to 0.,"if (DistortionModel == 'division')
DistortionCoeffs := [0, 0]
else
DistortionCoeffs := [0, 0, 0, 0, 0, 0]
endif
change_radial_distortion_cam_par ('preserve_resolution', CameraParam, DistortionCoeffs, CameraParamRect0)",96,103,"* --- Automatically Added Context ---
DistortionModel := 'division'
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
* --- End of Automatically Added Context ---"
1e8205de,micro,11,"Non-square pixels are obtained in the original image
if the speed of the motion is not perfectly adj...","enforce_square_pixels_cam_par (CameraParamRect0, CameraParamRect)",104,107,"* --- Automatically Added Context ---
change_radial_distortion_cam_par ('preserve_resolution', CameraParam, DistortionCoeffs, CameraParamRect0)
* --- End of Automatically Added Context ---"
1e8205de,micro,12,,"gen_empty_obj (EmptyObject)
change_radial_distortion_image (Image, EmptyObject, ImageRect, CameraParam, CameraParamRect)",108,110,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_telecentric_' + Index$'02')
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
enforce_square_pixels_cam_p..."
1e8205de,micro,13,,"get_window_extents (WindowHandleOrig, Row, Column, WindowWidthOrig, WindowHeightOrig)
dev_open_window_fit_image (ImageRect, 0, WindowWidthOrig + 8, 512, 768, WindowHandleRect)
set_display_font (WindowHandleRect, 14, 'mono', 'false', 'false')
dev_update_off ()
dev_display (ImageRect)
dev_disp_text ('...",111,120,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, 512, 768, WindowHandleOrig)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], ..."
1e8205de,micro,14,,"dev_set_window (WindowHandleOrig)
dev_clear_window ()
measure_squares (Image, CameraParam, 232, 187, 281, 1818, 2393, 201, 14, 11, OrigWidthMean, OrigHeightMean, OrigAreaMean, OrigAngleMean)
dev_clear_window ()
dev_display (Image)
disp_message (WindowHandleOrig, 'Measure all squares in the original ...",124,132,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, 512, 768, WindowHandleOrig)
read_image (Image, 'calib/calib_line_scan_telecentric_' + Index$'02')
get_calib_data (C..."
1e8205de,micro,15,,"dev_set_window (WindowHandleRect)
dev_clear_window ()
measure_squares (ImageRect, CameraParamRect, 227, 275, 274, 1937, 2345, 206, 14, 11, RectWidthMean, RectHeightMean, RectAreaMean, RectAngleMean)
dev_clear_window ()
dev_display (ImageRect)
disp_message (WindowHandleRect, 'Measure all squares in t...",133,157,"* --- Automatically Added Context ---
enforce_square_pixels_cam_par (CameraParamRect0, CameraParamRect)
change_radial_distortion_image (Image, EmptyObject, ImageRect, CameraParam, CameraParamRect)
dev..."
1e8205de,micro,16,,"lines_gauss (ImageReduced, Lines, 2.3, 1.5, 2.5, 'dark', 'false', 'bar-shaped', 'true')
segment_contours_xld (Lines, ContoursSplit, 'lines', 5, 4, 2)
union_collinear_contours_xld (ContoursSplit, UnionContours, 10, 1, 2, 0.1, 'attr_keep')
select_contours_xld (UnionContours, SelectedContours, 'contour...",162,170,
1e8205de,micro,17,,"fit_line_contour_xld (SelectedContours, 'tukey', -1, 5, 5, 2, R1, C1, R2, C2, Nr, Nc, Dist)
tuple_sort_index (Nr, Indices)
R1 := R1[Indices]
C1 := C1[Indices]
R2 := R2[Indices]
C2 := C2[Indices]
Inter1 := [0, 0, 1, 1]
Inter2 := [2, 3, 2, 3]
InterRows := []
InterColumns := []
InterAngles := []
for In...",171,219,"* --- Automatically Added Context ---
for Index := 1 to 16 by 1
select_contours_xld (UnionContours, SelectedContours, 'contour_length', 150, 1000, -0.5, 0.5)
* --- End of Automatically Added Context -..."
1e8205de,micro,18,"calibrated (CamParam) camera parameters of a telecentric
line scan camera as well as the calibration...","get_cam_par_data (StartCamParam, 'camera_type', CameraType)
get_cam_par_names (StartCamParam, CameraType1, Labels)",220,226,
1e8205de,micro,19,the camera parameters.,"if (CameraType == 'line_scan_telecentric_division')
Format := ['', '10.5f', '7.2f', '7.2f', '7.2f', '7.2f', '7.2f', 'd', 'd', '7.2f', '7.2f']
Scale := [1.0, 1.0, 1.0, 1e6, 1e6, 1.0, 1.0, 1.0, 1.0, 1e6, 1e6]
Unit := ['', '', ' 1/m²', ' μm/px', ' μm/px', ' px', ' px', ' px', ' px', ' μm/px', ' μm/px']...",227,237,"* --- Automatically Added Context ---
get_cam_par_data (StartCamParam, 'camera_type', CameraType)
* --- End of Automatically Added Context ---"
1e8205de,micro,20,,"dev_clear_window ()
Text := 'Compare initial and calibrated camera parameters'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Residual calibration error = ' + Error$'.3f' + ' px', 'window', 72, 22, 'white', 'box', 'false')
Text := ['Initial parameters:', ' ']",238,243,"* --- Automatically Added Context ---
calibrate_cameras (CalibDataID, Error)
* --- End of Automatically Added Context ---"
1e8205de,micro,21,,"for Index := 1 to |StartCamParam| - 2 by 1
if (Labels[Index] == 'image_width' or Labels[Index] == 'image_height' or Labels[Index] == 'p1' or Labels[Index] == 'p2')
continue
endif
Text := [Text,Labels[Index]$'-13' + ' = ' + (StartCamParam[Index] * Scale[Index])$Format[Index] + Unit[Index]]
endfor
dev...",244,251,"* --- Automatically Added Context ---
for Index := 1 to 16 by 1
get_cam_par_data (StartCamParam, 'camera_type', CameraType)
get_cam_par_names (StartCamParam, CameraType1, Labels)
Format := ['', '10.5f..."
1e8205de,micro,22,,"Text := ['Calibrated parameters:', ' ']
for Index := 1 to |CamParam| - 2 by 1
if (Labels[Index] == 'image_width' or Labels[Index] == 'image_height' or Labels[Index] == 'p1' or Labels[Index] == 'p2')
continue
endif
Text := [Text,Labels[Index]$'-13' + ' = ' + (CamParam[Index] * Scale[Index])$Format[In...",252,337,"* --- Automatically Added Context ---
get_cam_par_data (CameraParamStart, 'image_width', Width)
get_cam_par_data (CameraParamStart, 'image_height', Height)
for Index := 1 to 16 by 1
get_window_extents..."
1e8205de,micro,23,"input Image. To be able to perform the measurements in
metric units, the camera parameters must be p...","dev_display (Image)
get_cam_par_data (CameraParam, 'sx', Sx)
get_cam_par_data (CameraParam, 'sy', Sy)
get_cam_par_data (CameraParam, 'magnification', Magnification)
Px2M := Sx / Magnification
Py2M := Sy / Magnification
vector_to_hom_mat2d ([0, 0,NumRows - 1], [0,NumColumns - 1,0], [ULRow,URRow,LLRow...",338,389,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_line_scan_telecentric_' + Index$'02')
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
lines_gauss (ImageReduced, ..."
1e8205de,micro,24,,"MeanSquareWidth := mean(SquareWidths)
MeanSquareHeight := mean(SquareHeights)
MeanSquareArea := mean(SquareAreas)
MeanSquareAngle := mean(SquareAngles)
return ()",390,428,"* --- Automatically Added Context ---
SquareWidths := []
SquareHeights := []
SquareAreas := []
SquareAngles := []
* --- End of Automatically Added Context ---"
1e8205de,micro,25,"CameraParam of a telecentric line scan camera to enforce
square pixels. This is done by adjusting th...","CameraParamSquare := CameraParam
get_cam_par_data (CameraParamSquare, 'sx', Sx)
get_cam_par_data (CameraParamSquare, 'magnification', Magnification)
get_cam_par_data (CameraParamSquare, 'vy', Vy)",429,444,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
get_cam_par_data (CameraParam, 'sx', Sx)
get_cam_par_data (CameraParam, 'magnification', Magnific..."
1e8205de,micro,26,,"SxSquare := min([Sx,Magnification * Vy])",445,446,"* --- Automatically Added Context ---
get_cam_par_data (CameraParam, 'sx', Sx)
get_cam_par_data (CameraParam, 'magnification', Magnification)
get_cam_par_data (CameraParamSquare, 'vy', Vy)
* --- End o..."
1e8205de,micro,27,,"set_cam_par_data (CameraParamSquare, 'sx', SxSquare, CameraParamSquare)
set_cam_par_data (CameraParamSquare, 'sy', SxSquare, CameraParamSquare)",447,449,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CameraParam)
get_cam_par_data (CameraParam, 'sx', Sx)
get_cam_par_data (CameraParam, 'magnification', Magnific..."
1e8205de,micro,28,,"VySquare := SxSquare / Magnification
set_cam_par_data (CameraParamSquare, 'vy', VySquare, CameraParamSquare)",450,452,"* --- Automatically Added Context ---
get_cam_par_data (CameraParam, 'magnification', Magnification)
get_cam_par_data (CameraParam, 'sx', Sx)
CameraParamSquare := CameraParam
get_cam_par_data (CameraP..."
1e8205de,micro,29,and resetting the image size.,"get_cam_par_data (CameraParamSquare, 'image_width', Width)
get_cam_par_data (CameraParamSquare, 'image_height', Height)
change_radial_distortion_points ([0, 0,Height - 1,Height - 1], [0,Width - 1,Width - 1,0], CameraParam, CameraParamSquare, RowRect, ColumnRect)
RowMin := min(RowRect)
ColumnMin := m...",453,489,"* --- Automatically Added Context ---
get_cam_par_data (CameraParamStart, 'image_width', Width)
get_cam_par_data (CameraParamStart, 'image_height', Height)
get_calib_data (CalibDataID, 'camera', 0, 'p..."
1e8205de,micro,30,,"WidthTrue := 5.0e-3
HeightTrue := 5.0e-3
AreaTrue := 25.0e-6
AngleTrue := 90.0",496,501,
1e8205de,micro,31,,"WidthError := Width - WidthTrue
HeightError := Height - HeightTrue
AreaError := Area - AreaTrue
AngleError := Angle - AngleTrue",502,507,"* --- Automatically Added Context ---
get_cam_par_data (CameraParamStart, 'image_width', Width)
get_cam_par_data (CameraParamStart, 'image_height', Height)
area_center_xld (ContourM, Area, RowC, Colum..."
1e8205de,micro,32,,"Text := []
Text := [Text,'Measurement results (mean over all squares):']
Text := [Text,' ']
Text := [Text,'          Result     Deviation from true value']
Text := [Text,'Width:  ' + (Width * 1000.0)$'6.3f' + ' mm' + '         ' + (WidthError * 1000.0)$'6.3f' + ' mm']
Text := [Text,'Height: ' + (Hei...",508,532,"* --- Automatically Added Context ---
get_cam_par_data (CameraParamStart, 'image_width', Width)
get_cam_par_data (CameraParamStart, 'image_height', Height)
Text := 'Compare initial and calibrated came..."
3a76db49,full,0,,"read_image (Image, 'pioneer')
rgb1_to_gray (Image, GrayImage)
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', CamParIn, 0, CamParOut)
edges_sub_pix (GrayImage, Edges, 'mderiche2', 0.5, 20,...",6,17,
3a76db49,micro,1,,"edges_sub_pix (GrayImage, Edges, 'mderiche2', 0.5, 20, 40)",11,14,"* --- Automatically Added Context ---
rgb1_to_gray (Image, GrayImage)
* --- End of Automatically Added Context ---"
3a76db49,micro,2,,"change_radial_distortion_contours_xld (Edges, EdgesRectified, CamParIn, CamParOut)",15,23,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', Ca..."
146b2e79,full,0,Rectification by elimination of radial distortion,"read_image (Image, 'pioneer')
rgb1_to_gray (Image, GrayImage)
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', CamParIn, 0, CamParOut)
change_radial_distortion_image (GrayImage, GrayImage, ...",9,13,
146b2e79,micro,1,,"read_image (Image, 'pioneer')
rgb1_to_gray (Image, GrayImage)
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', CamParIn, 0, CamParOut)
change_radial_distortion_image (GrayImage, GrayImage, ...",7,19,
759468e6,full,0,"This program demonstrates how point coordinates extracted from a radially
distorted image can be cor...","dev_close_window ()
dev_update_off ()
read_image (Image, 'calib/calib_distorted_01.png')
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
gen_cam_par_area_scan_polynomial (0.00506526, 514...",9,55,
759468e6,micro,1,"distorted image can be corrected. This is done by change_radial_distortion_points
using the radial d...","dev_close_window ()
dev_update_off ()
read_image (Image, 'calib/calib_distorted_01.png')
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)",6,14,
759468e6,micro,2,,"gen_cam_par_area_scan_polynomial (0.00506526, 5142.64, -1.98485e+08, -4.26734e+12, 0.0462524, 0.114147, 9.30055e-06, 9.3e-06, 276.713, 266.078, 640, 512, CamParam)
change_radial_distortion_cam_par ('fixed', CamParam, [0.0, 0.0, 0.0, 0.0, 0.0], CamParamOut)
for I := 18 to 34 by 1
Filename := 'calib/c...",15,61,"* --- Automatically Added Context ---
read_image (Image, 'calib/calib_distorted_01.png')
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
* --- End of Automatically Added ..."
aba0d705,full,0,,"dev_close_window ()
dev_open_window (0, 0, 768 / 2, 576 / 2, 'black', WindowHandle1)
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
CalTabDescrFile := 'caltab_big.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.000008...",6,79,
aba0d705,micro,1,,CalTabDescrFile := 'caltab_big.descr',13,15,
aba0d705,micro,2,"the HALCONROOT/calib directory, or use an absolute path","gen_cam_par_area_scan_division (0.008, 0, 0.0000086, 0.0000086, 384, 288, 768, 576, StartCamPar)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescrFile)
NumImages := 10
for I ...",16,85,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768 / 2, 576 / 2, 'black', WindowHandle1)
CalTabDescrFile := 'caltab_big.descr'
* --- End of Automatically Added Context ---"
9506c649,full,0,"This example demonstrates the effect of lens distortion on the
location of edges in an image.
The re...","read_image (Image, 'pioneer')
rgb1_to_gray (Image, GrayImage)
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', CamParIn, 0, CamParOut)
dev_set_color ('red')
edges_sub_pix (GrayImage, Edges,...",12,25,
9506c649,micro,1,"location of edges in an image.
The red edges are found in the original image that is subject
to lens...","read_image (Image, 'pioneer')
rgb1_to_gray (Image, GrayImage)
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', CamParIn, 0, CamParOut)",7,16,
9506c649,micro,2,,"dev_set_color ('red')
edges_sub_pix (GrayImage, Edges, 'canny', 1, 20, 40)",17,21,"* --- Automatically Added Context ---
rgb1_to_gray (Image, GrayImage)
* --- End of Automatically Added Context ---"
9506c649,micro,3,,"dev_set_color ('green')
change_radial_distortion_contours_xld (Edges, EdgesRectified, CamParIn, CamParOut)",22,31,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParIn)
change_radial_distortion_cam_par ('adaptive', Ca..."
9cf021cc,full,0,"This example program compares the accuracies of the camera parameters
that are computed with the reg...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
CaltabName := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000073, 0.0...",22,182,
9cf021cc,micro,1,"that are computed with the regular camera calibration and the radial
distortion self-calibration.  I...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",6,28,
9cf021cc,micro,2,Perform the camera calibration.,"CaltabName := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.0000073, 0.0000073, 323, 241, 646, 482, StartCamPar)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, Calta...",29,52,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
9cf021cc,micro,3,"force the camera calibration to use square pixels as well to enable a
meaningful comparison of the r...","set_calib_data (CalibDataID, 'camera', 'general', 'excluded_settings', ['sx', 'sy'])
calibrate_cameras (CalibDataID, Error)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParCalib)",53,58,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 1, 1, CalibDataID)
* --- End of Automatically Added Context ---"
9cf021cc,micro,4,compared to the results of the radial distortion self-calibration.,"get_cam_par_data (CamParCalib, 'kappa', Kappa)
get_cam_par_data (CamParCalib, 'sx', Sx)
set_cam_par_data (CamParCalib, 'kappa', Kappa * Sx * Sx, CamParCalib)
set_cam_par_data (CamParCalib, ['sx', 'sy'], [1.0, 1.0], CamParCalib)
dev_clear_window ()
get_cam_par_data (CamParCalib, ['kappa', 'cx', 'cy']...",59,76,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParCalib)
* --- End of Automatically Added ..."
9cf021cc,micro,5,,"read_image (Image, 'radius-gauges/radius-gauges-06')",77,78,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
* --- End of Automatically Added Context ---"
9cf021cc,micro,6,,"edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)",79,80,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
* --- End of Automatically Added Context ---"
9cf021cc,micro,7,run around the squares in the image.,"segment_contours_xld (Edges, EdgesSplit, 'lines_circles', 5, 4, 2)
dev_set_colored (12)
dev_set_line_width (2)
dev_display (Image)
dev_display (EdgesSplit)
disp_message (WindowHandle, 'Extracted and segmented edges', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 't...",81,90,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
read_image (Image, 'radius-gauges/calib-' + I$'02d')
edges_sub_pix (Image, Edges, 'canny', 1, 10, ..."
9cf021cc,micro,8,,"union_collinear_contours_ext_xld (EdgesSplit, EdgesUnion, 30, 2, 3, rad(10), 2, -1, 1, 1, 1, 1, 1, 0, 'attr_keep')",91,92,"* --- Automatically Added Context ---
segment_contours_xld (Edges, EdgesSplit, 'lines_circles', 5, 4, 2)
* --- End of Automatically Added Context ---"
9cf021cc,micro,9,,"segment_contours_xld (EdgesUnion, EdgesUnionSplit, 'lines_circles', 5, 4, 2)",93,94,"* --- Automatically Added Context ---
union_collinear_contours_ext_xld (EdgesSplit, EdgesUnion, 30, 2, 3, rad(10), 2, -1, 1, 1, 1, 1, 1, 0, 'attr_keep')
* --- End of Automatically Added Context ---"
9cf021cc,micro,10,,"select_shape_xld (EdgesUnionSplit, EdgesSelected, 'contlength', 'and', 30, 100000)
dev_display (Image)
dev_display (EdgesSelected)
disp_message (WindowHandle, 'Merged and selected edges', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_windo...",95,103,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
read_image (Image, 'radius-gauges/calib-' + I$'02d')
disp_message (WindowHandle, 'Performing camer..."
9cf021cc,micro,11,,"radial_distortion_self_calibration (EdgesSelected, EdgesCalibration, 646, 482, 0.1, 42, 'division', 'variable', 0, CamPar)
get_cam_par_data (CamPar, ['kappa', 'cx', 'cy'], CamParSelfCalibValue)
dev_clear_window ()
disp_message (WindowHandle, 'Compare camera parameters:', 'window', 12, 12, 'black', '...",104,116,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
get_cam_par_data (CamParCalib, 'kappa', Kappa)
disp_message (WindowHandle, 'Camera parameters (pix..."
9cf021cc,micro,12,,"get_domain (Image, Domain)",117,118,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
* --- End of Automatically Added Context ---"
9cf021cc,micro,13,calibration results.,"change_radial_distortion_cam_par ('fixed', CamParCalib, 0, CamParCalibRect)
change_radial_distortion_cam_par ('fixed', CamPar, 0, CamParRect)",119,122,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParCalib)
radial_distortion_self_calibration (EdgesSelected, EdgesCalibration, 646, 482, 0.1, 42, 'division..."
9cf021cc,micro,14,,"change_radial_distortion_image (Image, Domain, ImageCalibRectified, CamParCalib, CamParCalibRect)
change_radial_distortion_image (Image, Domain, ImageRectified, CamPar, CamParRect)",123,125,"* --- Automatically Added Context ---
read_image (Image, 'radius-gauges/calib-' + I$'02d')
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParCalib)
radial_distortion_self_calibration (EdgesSel..."
9cf021cc,micro,15,"differences between the images.  The differences are most notable in
the upper left and lower right ...","for J := 1 to 5 by 1
dev_display (ImageCalibRectified)
disp_message (WindowHandle, 'Rectified image (camera calibration)', 'window', 12, 12, 'black', 'true')
wait_seconds (0.5)
dev_display (ImageRectified)
disp_message (WindowHandle, 'Rectified image (self-calibration)', 'window', 12, 12, 'black', '...",126,138,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
change_radial_distortion_image (Image, Domain, ImageCalibRectified, CamParCalib, CamParCalibRect)
..."
9cf021cc,micro,16,calibration results.,"sub_image (ImageRectified, ImageCalibRectified, ImageSub, 1, 128)
dev_display (ImageSub)
disp_message (WindowHandle, 'Difference between the rectified images', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",139,145,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
change_radial_distortion_image (Image, Domain, ImageCalibRectified, CamParCalib, CamParCalibRect)
..."
9cf021cc,micro,17,for visualizing the differences of the calibration results.,"edges_sub_pix (ImageRectified, EdgesRectified, 'canny', 1, 20, 40)
edges_sub_pix (ImageCalibRectified, EdgesCalibRectified, 'canny', 1, 20, 40)
select_shape_xld (EdgesRectified, EdgesRectified, 'contlength', 'and', 2, 10000)
select_shape_xld (EdgesCalibRectified, EdgesCalibRectified, 'contlength', '...",146,151,"* --- Automatically Added Context ---
change_radial_distortion_image (Image, Domain, ImageCalibRectified, CamParCalib, CamParCalibRect)
change_radial_distortion_image (Image, Domain, ImageRectified, C..."
9cf021cc,micro,18,"subpixel-precise edges extracted from both rectified images in a zoom
window to show the positional ...","get_window_extents (WindowHandle, Row1, Column1, Width, Height)
dev_open_window (0, Width + 8, 256, 256, 'black', WindowHandleZoom)
Rows := [16, 45, 465, 408, 233]
Cols := [45, 620, 37, 610, 307]
for J := 0 to |Rows| - 1 by 1
dev_set_window (WindowHandle)
dev_display (ImageRectified)
dev_set_color (...",152,188,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 646, 482, -1, -1, WindowHandle)
disp_message (WindowHandle, 'Compare camera parameters:', 'window', 12, 12, 'black', 'true')
chang..."
fe14f22e,full,0,"This program shows how radial_distortion_self_calibration can be used to
calibrate the radial distor...","dev_update_off ()
read_image (Image, 'board/board-01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Image with radial distortions', 'window', 0, 0, 'blac...",16,105,
fe14f22e,micro,1,"calibrate the radial distortion coefficient and the center of
distortions.  In the first part of the...","dev_update_off ()
read_image (Image, 'board/board-01')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Image with radial distortions', 'window', 0, 0, 'blac...",6,24,
fe14f22e,micro,2,,"edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)",25,26,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
* --- End of Automatically Added Context ---"
fe14f22e,micro,3,,"segment_contours_xld (Edges, SplitEdges, 'lines_circles', 5, 4, 2)",27,28,"* --- Automatically Added Context ---
edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)
* --- End of Automatically Added Context ---"
fe14f22e,micro,4,,"select_shape_xld (SplitEdges, SelectedEdges, 'contlength', 'and', 30, 100000)
dev_display (Image)
dev_set_colored (12)
dev_display (SelectedEdges)
disp_message (WindowHandle, 'Extracted edges', 'window', 0, 0, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_w...",29,38,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
segment_contours_xld (Edges, SplitEdges, 'lines_circles', 5, 4,..."
fe14f22e,micro,5,,"radial_distortion_self_calibration (SelectedEdges, CalibrationEdges, 646, 492, 0.08, 42, 'division', 'variable', 0, CamParSingleImage)",39,40,"* --- Automatically Added Context ---
select_shape_xld (SplitEdges, SelectedEdges, 'contlength', 'and', 30, 100000)
* --- End of Automatically Added Context ---"
fe14f22e,micro,6,,"get_domain (Image, Domain)
change_radial_distortion_cam_par ('fixed', CamParSingleImage, 0, CamParSingleImageRect)
change_radial_distortion_image (Image, Domain, ImageRectified, CamParSingleImage, CamParSingleImageRect)",41,44,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
radial_distortion_self_calibration (SelectedEdges, CalibrationEdges, 646, 492, 0.08, 42, 'division', 'variable', 0, CamParSin..."
fe14f22e,micro,7,differences between the images.,"dev_display (Image)
dev_display (CalibrationEdges)
disp_message (WindowHandle, 'Edges used for calibration', 'window', 0, 0, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (ImageRectified)
disp_message (WindowHandle, 'Image without radial distortions', 'wi...",45,55,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)
radial_distort..."
fe14f22e,micro,8,The variable Edges will accumulate the edges extracted from the images.,"gen_empty_obj (Edges)
for J := 1 to 20 by 1
read_image (Image, 'board/board-' + J$'02d')
edges_sub_pix (Image, ImageEdges, 'canny', 1, 10, 40)
segment_contours_xld (ImageEdges, SplitEdges, 'lines_circles', 5, 4, 2)
select_shape_xld (SplitEdges, SelectedEdges, 'contlength', 'and', 30, 100000)
concat_...",56,81,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)
segment_contou..."
fe14f22e,micro,9,,"radial_distortion_self_calibration (Edges, CalibrationEdges, 646, 492, 0.08, 42, 'division', 'variable', 0, CamParMultiImage)
dev_clear_window ()
dev_set_colored (12)
dev_display (CalibrationEdges)
disp_message (WindowHandle, 'Edges used for calibration', 'window', 0, 0, 'black', 'true')
disp_contin...",82,89,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 1, 10, 40)
radial_distortion_self_calibration (SelectedEdges, ..."
fe14f22e,micro,10,,"change_radial_distortion_cam_par ('fixed', CamParMultiImage, 0, CamParMultiImageRect)
for J := 1 to 20 by 1
read_image (Image, 'board/board-' + J$'02d')
get_domain (Image, Domain)
change_radial_distortion_image (Image, Domain, ImageRectified, CamParMultiImage, CamParMultiImageRect)
dev_display (Imag...",90,111,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_domain (Image, Domain)
change_radial_distortion_image (Imag..."
c4201074,full,0,"This example program shows you how to calibrate a camera radiometrically.
The calibration is perform...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
dev_set_part (0, 0, 493, 651)
dev_set_lut ('default')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_...",14,140,
c4201074,micro,1,"The calibration is performed for two different cameras.  The first camera
exhibits an almost perfect...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
dev_set_part (0, 0, 493, 651)
dev_set_lut ('default')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')",6,20,
c4201074,micro,2,,"Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']",21,22,
c4201074,micro,3,"ratio of the exposures, arbitrary units can be used.  Here, we specify the
exposure in milliseconds....","Exposures := [32, 16, 8, 4, 2]",23,29,
c4201074,micro,4,,"ExposureRatios := real(Exposures[1:4]) / real(Exposures[0:3])
Num := |Files|",30,32,"* --- Automatically Added Context ---
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Exposures := [32, 16, 8, 4, 2]
* --- End of Automatically Added Con..."
c4201074,micro,5,,"gen_empty_obj (Images)
for J := 0 to Num - 1 by 1
read_image (Image, 'radiometry/' + Files[J])
dev_display (Image)
disp_message (WindowHandle, 'Exposure: ' + Exposures[J]$'2d' + ' ms', 'window', 12, 12, 'black', 'true')
concat_obj (Images, Image, Images)
wait_seconds (1)
endfor",33,41,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Exposures :..."
c4201074,micro,6,"of consecutive images, we compute these histograms and display them.
The interesting information tha...","dev_set_window_extents (-1, -1, 512, 512)
dev_set_part (0, 0, 255, 255)
dev_set_lut ('change3')
for J := 0 to Num - 2 by 1
select_obj (Images, Image1, J + 1)
select_obj (Images, Image2, J + 2)
histo_2dim (Image1, Image1, Image2, Histo2Dim)
dev_display (Histo2Dim)
disp_message (WindowHandle, '2D hist...",42,61,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Num := |Fil..."
c4201074,micro,7,,"radiometric_self_calibration (Images, ExposureRatios, '2d_histogram', 'discrete', 1, 5, InverseResponse)
dev_set_color ('yellow')
dev_set_line_width (3)
dev_clear_window ()
plot_response (WindowHandle, InverseResponse)
disp_message (WindowHandle, 'Inverse response', 'window', 12, 12, 'black', 'true'...",62,72,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Exposures := [32, 16, 8, 4, 2]
ExposureRatios := real(Exposures[1:4]) / real(Exposures[0:3])
gen_empty_obj..."
c4201074,micro,8,,"Files := ['camera_2_3000', 'camera_2_2000', 'camera_2_1000', 'camera_2_0500', 'camera_2_0250', 'camera_2_0125']",73,74,"* --- Automatically Added Context ---
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
* --- End of Automatically Added Context ---"
c4201074,micro,9,,"Exposures := [30.0, 20.0, 10.0, 5.0, 2.5, 1.25]",75,76,"* --- Automatically Added Context ---
Exposures := [32, 16, 8, 4, 2]
* --- End of Automatically Added Context ---"
c4201074,micro,10,,"ExposureRatios := Exposures[1:5] / Exposures[0:4]
Num := |Files|",77,79,"* --- Automatically Added Context ---
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Exposures := [32, 16, 8, 4, 2]
ExposureRatios := real(Exposures[1:4..."
c4201074,micro,11,,"gen_empty_obj (Images)
for J := 0 to Num - 1 by 1
read_image (Image, 'radiometry/' + Files[J])
dev_display (Image)
disp_message (WindowHandle, 'Exposure: ' + Exposures[J]$'5.2f' + ' ms', 'window', 12, 12, 'black', 'true')
concat_obj (Images, Image, Images)
wait_seconds (1)
endfor",80,88,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Exposures :..."
c4201074,micro,12,"saturation behavior.  The camera does not saturate at a gray level of 255.
Instead, it saturates at ...","dev_set_window_extents (-1, -1, 512, 512)
dev_set_part (0, 0, 255, 255)
dev_set_lut ('change3')
for J := 0 to Num - 2 by 1
select_obj (Images, Image1, J + 1)
select_obj (Images, Image2, J + 2)
histo_2dim (Image1, Image1, Image2, Histo2Dim)
dev_display (Histo2Dim)
disp_message (WindowHandle, '2D hist...",89,113,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
select_obj ..."
c4201074,micro,13,,"radiometric_self_calibration (Images, ExposureRatios, '2d_histogram', 'discrete', 1, 5, InverseResponse)
dev_clear_window ()
plot_response (WindowHandle, InverseResponse)
disp_message (WindowHandle, 'Inverse response', 'window', 12, 12, 'black', 'true')
Num := |Response|
get_window_extents (WindowHa...",114,149,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'black', WindowHandle)
Files := ['camera_1_0032', 'camera_1_0016', 'camera_1_0008', 'camera_1_0004', 'camera_1_0002']
Exposures :..."
e5717432,full,0,"This example program shows how the internal camera parameters can be
determined with stationary_came...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
create_calib_data ('calibration_object', 1, 1, CalibDataID)
gen_cam_par_area_scan_division (0.0125...",22,244,
e5717432,micro,1,"determined with stationary_camera_self_calibration.  Furthermore, the
program compares the camera pa...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",6,27,
e5717432,micro,2,,"create_calib_data ('calibration_object', 1, 1, CalibDataID)
gen_cam_par_area_scan_division (0.0125, 0, 0.0000075, 0.0000075, 325.5, 246.5, 652, 494, StartCamPar)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, 'caltab_800mm.descr')
for I := 1 t...",28,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
e5717432,micro,3,"transformations for all image pairs that have a sufficient degree of overlap.
We start by reading al...","gen_empty_obj (Images)
for J := 1 to 25 by 1
read_image (Image, 'self_calib/self_calib_' + J$'02d')
concat_obj (Images, Image, Images)
endfor",52,59,"* --- Automatically Added Context ---
read_image (Image, 'self_calib/calib_' + I$'02d')
* --- End of Automatically Added Context ---"
e5717432,micro,4,large image that contains all the 25 images that are used for the calibration.,"tile_images_offset (Images, TiledImage, [0, 500, 1000, 1500, 2000, 0, 500, 1000, 1500, 2000, 0, 500, 1000, 1500, 2000, 0, 500, 1000, 1500, 2000, 0, 500, 1000, 1500, 2000], [2640, 2640, 2640, 2640, 2640, 1980, 1980, 1980, 1980, 1980, 1320, 1320, 1320, 1320, 1320, 660, 660, 660, 660, 660, 0, 0, 0, 0, ...",60,70,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
gen_empty_obj (Images)
* --- End of Automatically Added Context ---"
e5717432,micro,5,"matched.  Basically, each image is matched to the images directly below
to the left (if there is suc...","From := [1, 1, 2, 2, 3, 3, 4, 4, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 21, 22, 23, 24]
To := [2, 6, 3, 7, 4, 8, 5, 9, 10, 7, 11, 8, 12, 9, 13, 10, 14, 15, 12, 16, 13, 17, 14, 18, 15, 19, 20, 17, 21, 18, 22, 19, 23, 20, 24, 25, 22, 23, ...",71,75,
e5717432,micro,6,,"HomMatrices2D := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
for J := 0 to |From| - 1 by 1
F := From[J]
T := To[J]
select_obj (Images, ImageF, F)
select_obj (Images, ImageT, T)
points_foerstner (ImageF, 1, 2, 3, 50, 0.1, 'gauss', 'true', RowsF, ColsF, CoRRJunctions, CoRCJunct...",76,130,"* --- Automatically Added Context ---
gen_empty_obj (Images)
for J := 1 to 25 by 1
From := [1, 1, 2, 2, 3, 3, 4, 4, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 16, 16, 17, 17, 1..."
e5717432,micro,7,"is used for the self-calibration, the camera is only rotated around the
x and y axes of the camera c...","stationary_camera_self_calibration (25, 652, 494, 13, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['focus', 'principal_point', 'kappa'], 'true', CameraMatrix, Kappa, RotationMatrices, DX, DY, DZ, Error)",131,142,"* --- Automatically Added Context ---
From := [1, 1, 2, 2, 3, 3, 4, 4, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 21, 22, 23, 24]
To := [2, ..."
e5717432,micro,8,"unit of the focal length.  To make the results of both calibration methods
comparable, we first conv...","cam_mat_to_cam_par (CameraMatrix, Kappa, 652, 494, CamParamPix)",143,147,"* --- Automatically Added Context ---
stationary_camera_self_calibration (25, 652, 494, 13, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['focus', 'principal_point..."
e5717432,micro,9,"This is done by multiplying the focal length returned by the self-calibration
by the pixel size ('sy...","get_cam_par_data (CamParam, 'sy', S)
CamParamSelf := CamParamPix
get_cam_par_data (CamParamPix, 'focus', Focus)
get_cam_par_data (CamParamPix, 'kappa', Kappa)
set_cam_par_data (CamParamSelf, ['focus', 'kappa', 'sx', 'sy'], [Focus * S,Kappa / (S * S),S,S], CamParamSelf)",148,158,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam)
stationary_camera_self_calibration (25, 652, 494, 13, From, To, HomMatrices2D, Rows1, Cols1, Rows2, ..."
e5717432,micro,10,,"get_cam_par_data (CamParam, ['focus', 'kappa', 'sx', 'sy', 'cx', 'cy'], CamParamValue)
get_cam_par_data (CamParamSelf, ['focus', 'kappa', 'sx', 'sy', 'cx', 'cy'], CamParamSelfValue)
dev_clear_window ()
dev_set_window_extents (-1, -1, 640, 480)
dev_set_part (0, 0, 479, 639)
Message := 'Comparison of ...",159,184,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
Message := 'Find calibration plate in all calibration images (' + I + '/10)'
get_calib_data (CalibDataID, ..."
e5717432,micro,11,"of the images that were used for the calibration.  To do so, we first have
to remove the radial dist...","change_radial_distortion_cam_par ('fixed', CamParamPix, 0, CamParamPixRect)
gen_radial_distortion_map (Map, CamParamPix, CamParamPixRect, 'bilinear')
map_image (Images, Map, ImagesRect)",185,190,"* --- Automatically Added Context ---
gen_empty_obj (Images)
cam_mat_to_cam_par (CameraMatrix, Kappa, 652, 494, CamParamPix)
* --- End of Automatically Added Context ---"
e5717432,micro,12,,"gen_spherical_mosaic (ImagesRect, MosaicImage, CameraMatrix, RotationMatrices, -100, 100, -200, 200, 0.0, 'default', 'bilinear')",191,192,"* --- Automatically Added Context ---
stationary_camera_self_calibration (25, 652, 494, 13, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['focus', 'principal_point..."
e5717432,micro,13,fit together perfectly.,"get_image_size (MosaicImage, Width, Height)
dev_set_window_extents (-1, -1, Width / 3, Height / 3)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (MosaicImage)
dev_set_color ('green')
disp_message (WindowHandle, 'Spherical mosaic', 'image', 60, 100, 'black', 'true')
disp_...",193,203,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
get_image_size (TiledImage, Width, Height)
gen_spherical_mosaic (ImagesRect, MosaicImage, CameraMatrix, Ro..."
e5717432,micro,14,"if the spherical mosaic covers less than 180 degrees (i.e., less than half
of the sphere) we can con...","HomMatrices2DPlanar := []
C := CameraMatrix
hom_mat2d_invert (C, CInv)
P := [0, 1, 0.5, 1, 0, 0.5, 0, 0, 1]
PInv := [0, 1, -0.5, 1, 0, -0.5, 0, 0, 1]
for J := 0 to 24 by 1
F := 12
T := J
RF := RotationMatrices[9 * F:9 * F + 8]
RT := RotationMatrices[9 * T:9 * T + 8]
hom_mat2d_invert (RT, RTInv)
hom_...",204,233,"* --- Automatically Added Context ---
for J := 1 to 25 by 1
F := From[J]
T := To[J]
stationary_camera_self_calibration (25, 652, 494, 13, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatche..."
e5717432,micro,15,were determined above ...,"gen_bundle_adjusted_mosaic (ImagesRect, MosaicImagePlanar, HomMatrices2DPlanar, 'default', 'false', TransMat2D)",234,236,"* --- Automatically Added Context ---
map_image (Images, Map, ImagesRect)
HomMatrices2DPlanar := []
* --- End of Automatically Added Context ---"
e5717432,micro,16,,"get_image_size (MosaicImagePlanar, Width, Height)
dev_set_window_extents (-1, -1, Width / 3, Height / 3)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (MosaicImagePlanar)
dev_set_color ('green')
disp_message (WindowHandle, 'Planar mosaic', 'image', 80, 140, 'black', 'tru...",237,250,"* --- Automatically Added Context ---
dev_open_window (0, 0, 652, 494, 'white', WindowHandle)
get_image_size (TiledImage, Width, Height)
gen_bundle_adjusted_mosaic (ImagesRect, MosaicImagePlanar, HomM..."
61e34216,full,0,"This example shows how to create a classifier with
an automatically selected set of features.
Additi...","query_feature_group_names (AllGroupNames)
query_feature_names_by_group (AllGroupNames, FeatureNames, Groups)
get_feature_names ('all', Names)
get_feature_lengths (Names, Lengths)
* calculate_features (Region, Image, Names, Features)
* test_features (Names)
list_image_files ('rings', 'default', [], I...",53,305,
61e34216,micro,1,,query_feature_group_names (AllGroupNames),52,54,
61e34216,micro,2,they belong to.,"query_feature_names_by_group (AllGroupNames, FeatureNames, Groups)",57,60,"* --- Automatically Added Context ---
query_feature_group_names (AllGroupNames)
* --- End of Automatically Added Context ---"
61e34216,micro,3,one or more given groups.,"get_feature_names ('all', Names)",63,66,
61e34216,micro,4,given features.,"get_feature_lengths (Names, Lengths)",69,72,"* --- Automatically Added Context ---
get_feature_names ('all', Names)
* --- End of Automatically Added Context ---"
61e34216,micro,5,"input regions in one call.
(At this point, we do not have a region yet,
so the next line is just for...","* calculate_features (Region, Image, Names, Features)",75,83,"* --- Automatically Added Context ---
get_feature_names ('all', Names)
* --- End of Automatically Added Context ---"
61e34216,micro,6,"to test if features are implemented according to
the library specifications.
If a problem is detecte...",* test_features (Names),91,97,"* --- Automatically Added Context ---
get_feature_names ('all', Names)
* --- End of Automatically Added Context ---"
61e34216,micro,7,,"list_image_files ('rings', 'default', [], ImageFiles)
TrainImageFilesNuts := regexp_select(ImageFiles,'nuts')
TrainImageFilesRetainers := regexp_select(ImageFiles,'retainers')
TrainImageFilesWashers := regexp_select(ImageFiles,'washers')
TestImageFiles := regexp_select(ImageFiles,'mixed')
TrainImage...",106,112,
61e34216,micro,8,,"NextClassIndex := [|TrainImageFilesNuts|,|TrainImageFilesNuts| + |TrainImageFilesRetainers|,|TrainImageFilesNuts| + |TrainImageFilesRetainers| + |TrainImageFilesWashers|]",113,115,"* --- Automatically Added Context ---
TrainImageFilesNuts := regexp_select(ImageFiles,'nuts')
TrainImageFilesRetainers := regexp_select(ImageFiles,'retainers')
TrainImageFilesWashers := regexp_select(..."
61e34216,micro,9,,"read_image (Image, TrainImageFiles[0])
dev_close_window ()
dev_update_off ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",116,122,"* --- Automatically Added Context ---
* calculate_features (Region, Image, Names, Features)
TrainImageFiles := [TrainImageFilesNuts,TrainImageFilesRetainers,TrainImageFilesWashers]
TrainImageFilesNuts..."
61e34216,micro,10,,"get_feature_names ('region', FeatureNamesRegion)
get_feature_names ('rot_invar', FeatureNamesRotInvar)
get_feature_names ('scale_invar', FeatureNamesScaleInvar)
FeatureNamesIntersection := intersection(FeatureNamesRegion,intersection(FeatureNamesScaleInvar,FeatureNamesRotInvar))
for Part := 1 to 2 b...",134,311,"* --- Automatically Added Context ---
query_feature_names_by_group (AllGroupNames, FeatureNames, Groups)
* calculate_features (Region, Image, Names, Features)
TestImageFiles := regexp_select(ImageFile..."
2743a066,full,0,"This example shows the usage of the operator
select_feature_set_knn and the functionality
of *_class...","read_image (Image, 'bottles/bottle_mouth_01')
dev_update_off ()
dev_close_window ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHandleFeature)
dev_open_window (220, 650, 448, 512 - 220, 'black', WindowHandlePol...",15,523,
2743a066,micro,1,,"read_image (Image, 'bottles/bottle_mouth_01')
dev_update_off ()
dev_close_window ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHandleFeature)
dev_open_window (220, 650, 448, 512 - 220, 'black', WindowHandlePol...",14,31,
2743a066,micro,2,,"find_bottle_mouth (Image, Row, Column, Radius)
gen_circle_contour_xld (OuterCircle, Row, Column, Radius, 0, 6.28318, 'positive', 1)
dev_set_color ('green')
dev_display (OuterCircle)",34,39,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
* --- End of Automatically Added Context ---"
2743a066,micro,3,,"gen_image_const (FeatureImage, 'float', 14, 80)",40,41,
2743a066,micro,4,,"FeatureNames := []
FeatureLength := []
DataSample := []
MinParamValue := 20
MaxParamValue := 80
ParameterIncrement := 10
Change := true",42,49,
2743a066,micro,5,,"for TestParameter := MinParamValue to MaxParamValue by ParameterIncrement
compute_gray_value_profile (Image, Row, Column, RingSize, Radius, TestParameter, GrayValueProfile, GrayValueProfileChange)
FeatureNames := [FeatureNames,'profile_' + TestParameter + '(' + TestParameter + ')','profile_change_' ...",50,68,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHa..."
2743a066,micro,6,,"create_class_train_data (|DataSample|, ClassTrainDataHandle)
set_feature_lengths_class_train_data (ClassTrainDataHandle, FeatureLength, FeatureNames)",73,75,"* --- Automatically Added Context ---
FeatureNames := []
FeatureLength := []
DataSample := []
* --- End of Automatically Added Context ---"
2743a066,micro,7,,"ClassNames := ['perfect', 'small defect', 'large defect', 'completely missing']",76,78,
2743a066,micro,8,,"ClassNumber := [0, 2, 1, 1, 2, 1, 3, 0, 2, 1, 1, 2, 2, 2, 2, 1]",81,82,
2743a066,micro,9,,"for Index := 1 to 16 by 1
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
gen_circle_contour_xld (OuterCircle, Row, Column, Radius, 0, 6.28318, 'positive', 1)
find_bottle_mouth (Image, Row, Column, Radius)
DataSample := []
ShortDescription := []
for TestParameter := MinParamValue to MaxPar...",83,107,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHa..."
2743a066,micro,10,"The operator returns not only the best features,
but also a classifier trained with these.","select_feature_set_knn (ClassTrainDataHandle, 'greedy', [], [], KNNHandle, SelectedFeatureNames, Score)
dev_display (Image)
Message := 'Selected features:'
Message := [Message,' - ' + SelectedFeatureNames]
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_set_window (Window...",110,132,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHa..."
2743a066,micro,11,,"for Index := 1 to 16 by 1
dev_set_window (WindowHandle)
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
find_bottle_mouth (Image, Row, Column, Radius)
Feature := []
for IndexInner := 0 to |SelectedFeatureNames| - 1 by 1
compute_gray_value_profile (Image, Row, Column, RingSize, Radius, Size...",133,188,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
RingSize := 70
ClassNames := ['perfect', 'small defe..."
2743a066,micro,12,,"polar_trans_image_ext (Image, PolarTransImage, Row, Column, 0, rad(360), RingSize - 5, Radius + 5, ImageSize, ImageSize, 'bilinear')",192,193,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
RingSize := 70
disp_gray_profile (FeatureImage, Image, PolarTransImage, GrayValueProfile, TestParameter, MinParamVal..."
2743a066,micro,13,,"gray_projections (PolarTransImage, PolarTransImage, 'simple', GrayValueProfile, VertProjection2)",194,195,"* --- Automatically Added Context ---
disp_gray_profile (FeatureImage, Image, PolarTransImage, GrayValueProfile, TestParameter, MinParamValue, ParameterIncrement, Row, Column, RingSize, Radius, Window..."
2743a066,micro,14,,"sobel_amp (PolarTransImage, EdgeAmplitude, 'x_binomial', 3)
abs_image (EdgeAmplitude, ImageAbs)",196,198,"* --- Automatically Added Context ---
disp_gray_profile (FeatureImage, Image, PolarTransImage, GrayValueProfile, TestParameter, MinParamValue, ParameterIncrement, Row, Column, RingSize, Radius, Window..."
2743a066,micro,15,,"gray_projections (ImageAbs, ImageAbs, 'simple', GrayValueProfileChange, VertProjection1)",199,200,"* --- Automatically Added Context ---
compute_gray_value_profile (Image, Row, Column, RingSize, Radius, TestParameter, GrayValueProfile, GrayValueProfileChange)
abs_image (EdgeAmplitude, ImageAbs)
* -..."
2743a066,micro,16,,"GrayValueProfileChange := GrayValueProfileChange * 5
return ()",201,243,"* --- Automatically Added Context ---
compute_gray_value_profile (Image, Row, Column, RingSize, Radius, TestParameter, GrayValueProfile, GrayValueProfileChange)
* --- End of Automatically Added Contex..."
2743a066,micro,17,,"auto_threshold (Image, Regions, 2)
select_obj (Regions, DarkRegion, 1)
opening_circle (DarkRegion, RegionOpening, 3.5)
closing_circle (RegionOpening, RegionClosing, 25.5)
fill_up (RegionClosing, RegionFillUp)
boundary (RegionFillUp, RegionBorder, 'outer')
dilation_circle (RegionBorder, RegionDilatio...",244,253,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
* --- End of Automatically Added Context ---"
2743a066,micro,18,,"edges_sub_pix (ImageReduced, Edges, 'canny', 0.5, 20, 40)
segment_contours_xld (Edges, ContoursSplit, 'lines_circles', 5, 4, 2)
union_cocircular_contours_xld (ContoursSplit, UnionContours, 0.9, 0.5, 0.5, 200, 50, 50, 'true', 1)
length_xld (UnionContours, Length)
select_obj (UnionContours, LongestCon...",254,337,"* --- Automatically Added Context ---
find_bottle_mouth (Image, Row, Column, Radius)
reduce_domain (Image, RegionDilation, ImageReduced)
* --- End of Automatically Added Context ---"
2743a066,micro,19,,"Columns := gen_tuple_const(|GrayValueProfileChange|,((TestParameter - MinParamValue) / ParameterIncrement) * 2 + 1)
Rows := [0:|GrayValueProfileChange| - 1]
set_grayval (FeatureImage, Rows, Columns, GrayValueProfileChange)
sobel_amp (PolarTransImage, EdgeAmplitude, 'x_binomial', 3)
dev_set_window (W...",338,406,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHandleFeature)
dev_open_window (220, 650, 448, 5..."
2743a066,micro,20,,"Columns := gen_tuple_const(|GrayValueProfile|,((TestParameter - MinParamValue) / ParameterIncrement) * 2)
Rows := [0:|GrayValueProfile| - 1]
set_grayval (FeatureImage, Rows, Columns, GrayValueProfile)
polar_trans_image_ext (Image, PolarTransImage, Row, Column, 0, rad(360), RingSize - 5, Radius + 5, ...",407,469,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window (0, 650, 448, 160, 'black', WindowHandleFeature)
dev_open_window (220, 650, 448, 512 - 220, 'black',..."
2743a066,micro,21,,"Columns := gen_tuple_const(|GrayValueProfile|,((TestParameter - MinParamValue) / ParameterIncrement) * 2)
Rows := [0:|GrayValueProfile| - 1]
set_grayval (FeatureImage, Rows, Columns, GrayValueProfile)
Columns := gen_tuple_const(|GrayValueProfileChange|,((TestParameter - MinParamValue) / ParameterInc...",470,512,"* --- Automatically Added Context ---
gen_image_const (FeatureImage, 'float', 14, 80)
MinParamValue := 20
ParameterIncrement := 10
disp_gray_profile (FeatureImage, Image, PolarTransImage, GrayValuePro..."
2743a066,micro,22,,"dev_set_window (WindowHandle)
dev_display (Image)
disp_message (WindowHandle, 'Training sample: ' + ClassNames[number(ClassNumber[Index - 1])], 'window', 12, 12, 'black', 'true')
dev_set_window (WindowHandleFeature)
dev_display (FeatureImage)
for TestParameter := MinParamValue to MaxParamValue by Pa...",513,541,"* --- Automatically Added Context ---
read_image (Image, 'bottles/bottle_mouth_01')
dev_open_window_fit_image (Image, 0, 0, 640, 512, WindowHandle)
dev_open_window (0, 650, 448, 160, 'black', WindowHa..."
4917a7f8,full,0,"This example shows the usage of hyperspectral image data.
The example demonstrates how to read hyper...","get_image_dir (Directory)
Directory := Directory[0]
dev_update_off ()
dev_close_window ()
dev_open_window (0, 520, 512, 512, 'black', WindowHandleSpectrum)
set_display_font (WindowHandleSpectrum, 14, 'mono', 'true', 'false')
dev_open_window (0, 0, 512, 512, 'black', WindowHandleImage)
set_display_fo...",15,347,
4917a7f8,micro,1,,"get_image_dir (Directory)
Directory := Directory[0]",14,17,
4917a7f8,micro,2,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 520, 512, 512, 'black', WindowHandleSpectrum)
set_display_font (WindowHandleSpectrum, 14, 'mono', 'true', 'false')
dev_open_window (0, 0, 512, 512, 'black', WindowHandleImage)
set_display_font (WindowHandleImage, 14, 'mono', 'true', 'false')",18,25,
4917a7f8,micro,3,"The procedure contains the reflectance transformation.
Read the comments inside the procedure for mo...","read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)",26,30,"* --- Automatically Added Context ---
get_image_dir (Directory)
* --- End of Automatically Added Context ---"
4917a7f8,micro,4,,"create_class_gmm (Info.bands, 4, 3, 'spherical', 'canonical_variates', 3, 42, GMMHandle)
ClassColors := ['red', 'magenta', 'blue', 'cadet blue']
ClassNames := ['Aspirin', 'Ibuprofen', 'Melatonin', 'WellMind']
for Index := 0 to |ClassNames| - 1 by 1
read_and_transform_envi (Image, Directory + '/pills...",31,69,"* --- Automatically Added Context ---
get_image_dir (Directory)
dev_open_window (0, 520, 512, 512, 'black', WindowHandleSpectrum)
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspect..."
4917a7f8,micro,5,"For esthetic reasons, skip the first two channels
which are worse quality because of the sensor limi...","access_channel (ImageClassify, ImageDisplay, 3)
dev_display (ImageDisplay)
String := 'Apply the trained GMM classifier to an image with pills\nthat are impossible to distinguish with human vision.'
dev_disp_text (String, 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandleIm...",70,79,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleImage)
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Inf..."
4917a7f8,micro,6,,"train_class_gmm (GMMHandle, 100, 0.001, 'training', 0.000001, Centers, Iter)",80,82,"* --- Automatically Added Context ---
create_class_gmm (Info.bands, 4, 3, 'spherical', 'canonical_variates', 3, 42, GMMHandle)
* --- End of Automatically Added Context ---"
4917a7f8,micro,7,Too high values erode the actually desired areas.,"RejectionThreshold := 0.000001
classify_image_class_gmm (ImageClassify, ClassRegions, GMMHandle, RejectionThreshold)
dev_display (ImageDisplay)
dev_set_color (ClassColors)
dev_display (ClassRegions)
String := 'Classification result'
dev_disp_text (String, 'window', 'top', 'left', 'black', [], [])
de...",83,114,"* --- Automatically Added Context ---
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
create_class_gmm (Info.bands, 4, 3, 'spherical', 'canonica..."
4917a7f8,micro,8,,"read_envi (Image, Directory + '/' + BaseName, Info)",115,117,"* --- Automatically Added Context ---
get_image_dir (Directory)
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
read_and_transform_envi (Image, ..."
4917a7f8,micro,9,,"read_envi (ImageDark, Directory + '/' + 'DARKREF_' + BaseName, InfoDark)
read_envi (ImageWhite, Directory + '/' + 'WHITEREF_' + BaseName, InfoWhite)",118,121,"* --- Automatically Added Context ---
get_image_dir (Directory)
read_envi (Image, Directory + '/' + BaseName, Info)
* --- End of Automatically Added Context ---"
4917a7f8,micro,10,"In the latter case, all available lines need to be averaged.
This can be done elegantly by zooming t...","zoom_image_size (ImageDark, MeanLineDark, InfoDark.samples, 1, 'constant')
zoom_image_size (ImageWhite, MeanLineWhite, InfoWhite.samples, 1, 'constant')",122,127,"* --- Automatically Added Context ---
read_envi (ImageDark, Directory + '/' + 'DARKREF_' + BaseName, InfoDark)
read_envi (ImageWhite, Directory + '/' + 'WHITEREF_' + BaseName, InfoWhite)
* --- End of ..."
4917a7f8,micro,11,"of the actual image. Again, this can be done elegantly
by zooming the line to the height of the actu...","zoom_image_size (MeanLineDark, RefDark, InfoDark.samples, Info.lines, 'constant')
zoom_image_size (MeanLineWhite, RefWhite, InfoWhite.samples, Info.lines, 'constant')",128,133,"* --- Automatically Added Context ---
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
read_envi (ImageDark, Directory + '/' + 'DARKREF_' + BaseN..."
4917a7f8,micro,12,Reflectance = (Image - RefDark)/(RefWhite - RefDark),"sub_image (RefWhite, RefDark, RefWhiteRectDark, 1, 0)
convert_image_type (RefWhiteRectDark, RefWhiteRectDarkReal, 'real')
convert_image_type (Image, ImageReal, 'real')
sub_image (ImageReal, RefDark, ImageRectDarkReal, 1, 0)
div_image (ImageRectDarkReal, RefWhiteRectDarkReal, Reflectance, 1, 0)
retur...",140,230,"* --- Automatically Added Context ---
for Index := 0 to |ClassNames| - 1 by 1
read_and_transform_envi (Image, Directory + '/pills_hyperspectral/train/', ClassNames[Index], Info)
plot_spectrum (Image, ..."
4917a7f8,micro,13,"The header is a plain text file which describes
the content of the raw file. Store it in a dictionar...","read_envi_header (BaseName, Info)",231,235,"* --- Automatically Added Context ---
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
read_envi (Image, Directory + '/' + BaseName, Info)
* --- ..."
4917a7f8,micro,14,,"if (Info.['interleave'] != 'BIL')
throw ('ENVI ""interleave"" ' + Info.['interleave'] + ' not supported!')
endif
if (Info.['byte order'] != 0)
throw ('ENVI ""byte order"" ' + Info.['byte order'] + ' not supported!')
endif
if (Info.['header offset'] != 0)
throw ('ENVI ""header offset"" ' + Info.['header of...",236,258,"* --- Automatically Added Context ---
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
* --- End of Automatically Added Context ---"
4917a7f8,micro,15,,"read_memory_block (BaseName + '.raw', MemoryBlockHandle)
get_handle_tuple (MemoryBlockHandle, 'Pointer', Pointer)",259,262,"* --- Automatically Added Context ---
read_envi (Image, Directory + '/' + BaseName, Info)
* --- End of Automatically Added Context ---"
4917a7f8,micro,16,each representing one line of the resulting HALCON image.,"gen_empty_obj (Lines)
for Row := 0 to Info.lines - 1 by 1
gen_image1 (Image, Type, Info.samples, Info.bands, Pointer + Row * BytesPerPixel * Info.bands * Info.samples)
concat_obj (Lines, Image, Lines)
endfor",271,278,"* --- Automatically Added Context ---
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
read_and_transform_envi (Image, Directory + '/pills_hypers..."
4917a7f8,micro,17,,"gen_empty_obj (Channels)
for Channel := 0 to Info.bands - 1 by 1
crop_rectangle1 (Lines, LinesChannel, Channel, 0, Channel, Info.samples - 1)
tile_images (LinesChannel, ImageChannel, 1, 'vertical')
concat_obj (Channels, ImageChannel, Channels)
endfor
channels_to_image (Channels, Image)
return ()
cre...",279,366,"* --- Automatically Added Context ---
get_image_dir (Directory)
read_and_transform_envi (ImageClassify, Directory + '/pills_hyperspectral/classify/', 'classify', Info)
read_and_transform_envi (Image, ..."
4466b390,full,0,"This example program shows how to use a GMM for classifying
two-dimensional data.  2D data is used b...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ell...",15,138,
4466b390,micro,1,"two-dimensional data.  2D data is used because it can easily be visualized
as regions and images.  T...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()",6,19,
4466b390,micro,2,samples are drawn.,"gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)",20,24,
4466b390,micro,3,for each region and intersecting the segmented region with the class region.,"gen_image_const (Image, 'byte', 200, 200)
add_noise_white (Image, ImageNoise1, 60)
add_noise_white (Image, ImageNoise2, 60)
add_noise_white (Image, ImageNoise3, 60)
threshold (ImageNoise1, RegionNoise1, 40, 255)
threshold (ImageNoise2, RegionNoise2, 40, 255)
threshold (ImageNoise3, RegionNoise3, 40,...",25,36,"* --- Automatically Added Context ---
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)..."
4466b390,micro,4,,"dev_clear_window ()
dev_set_color ('red')
dev_display (SamplesClass1)
dev_set_color ('green')
dev_display (SamplesClass2)
dev_set_color ('blue')
dev_display (SamplesClass3)
Message := 'Training samples of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",37,47,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, Samples..."
4466b390,micro,5,,"concat_obj (SamplesClass1, SamplesClass2, Samples)
concat_obj (Samples, SamplesClass3, Samples)
create_class_gmm (2, 3, 1, 'full', 'none', 2, 42, GMMHandle)
for Class := 0 to 2 by 1
select_obj (Samples, SamplesClass, Class + 1)
get_region_points (SamplesClass, Rows, Cols)
for J := 0 to |Rows| - 1 by...",48,59,"* --- Automatically Added Context ---
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, SamplesClass2)
intersection (RegionClass3, RegionNoise3, Sample..."
4466b390,micro,6,,"train_class_gmm (GMMHandle, 100, 0.001, 'training', 1e-4, Centers, Iter)",60,61,"* --- Automatically Added Context ---
create_class_gmm (2, 3, 1, 'full', 'none', 2, 42, GMMHandle)
* --- End of Automatically Added Context ---"
4466b390,micro,7,"the 2D feature space and accumulate them in three real images.  Furthermore,
store the most likely c...","gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_const (ProbClass2, 'real', 200, 200)
gen_image_const (ProbClass3, 'real', 200, 200)
gen_image_const (ProbKSigma, 'real', 200, 200)
gen_image_const (LabelClass, 'byte', 200, 200)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
Features := real([R...",62,84,"* --- Automatically Added Context ---
create_class_gmm (2, 3, 1, 'full', 'none', 2, 42, GMMHandle)
for Class := 0 to 2 by 1
* --- End of Automatically Added Context ---"
4466b390,micro,8,belong to any of the three classes.,"threshold (ProbKSigma, AcceptanceRegion, 0.01, 1.0)",85,87,"* --- Automatically Added Context ---
gen_image_const (ProbKSigma, 'real', 200, 200)
* --- End of Automatically Added Context ---"
4466b390,micro,9,,"intersection (Classes, AcceptanceRegion, Classes)
compose3 (ProbClass1, ProbClass2, ProbClass3, Probs)",88,90,"* --- Automatically Added Context ---
gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_const (ProbClass2, 'real', 200, 200)
gen_image_const (ProbClass3, 'real', 200, 200)
label_to_region (Labe..."
4466b390,micro,10,,"dev_display (ProbClass1)
Message := 'Probability of class 1'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass2)
Message := 'Probability of class 2'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass...",91,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
Message := 'Training samples of the 3 classes'
gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_co..."
4466b390,micro,11,,"dev_display (Probs)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Probabilities of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",104,114,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
4466b390,micro,12,,"dev_display (ProbKSigma)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'k-sigma prob. of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",115,125,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
4466b390,micro,13,,"dev_clear_window ()
dev_set_colored (3)
dev_display (Classes)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Most probable classes'
Message[1] := '(k-sigma probability &gt;= 0.01)'
dis...",126,144,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
1c8786b8,full,0,"This is an example for the operator create_class_knn and
classify_class_knn. The example demonstrate...","read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
dev_update_off ()
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 320, 240, 640, 480...",11,138,
1c8786b8,micro,1,,"read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)",10,11,
1c8786b8,micro,2,,"dev_update_off ()
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e-6, 320, 240, 640, 480, CamParam)
GenParamName := ['color_0', 'color_1', 'color_2', 'color...",12,20,
1c8786b8,micro,3,,"dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_object_model_3d_params (ObjectModel3D, 'center', Center)",21,26,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
* --- End of Automatically Added Context ---"
1c8786b8,micro,4,,"create_class_knn (3, KNNHandle)",27,28,
1c8786b8,micro,5,,"add_sample_class_knn (KNNHandle, XYZ, 0)",29,30,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
create_class_knn (3, KNNHandle)
* --- End of Automatically Added Context ---"
1c8786b8,micro,6,,"train_class_knn (KNNHandle, [], [])",31,32,"* --- Automatically Added Context ---
create_class_knn (3, KNNHandle)
* --- End of Automatically Added Context ---"
1c8786b8,micro,7,"This means, we are not really classifying but only looking up the closest point
(We did not specify ...","set_params_class_knn (KNNHandle, ['method', 'k'], ['neighbors_distance', 20])
moments_object_model_3d (ObjectModel3D, 'mean_points', CenterObj)",33,38,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
create_class_knn (3, KNNHandle)
* --- End of Automatically Added Context ---"
1c8786b8,micro,8,,"XTest := rand(5) * Length1 + CenterObj[0]
YTest := rand(5) * Length3 + CenterObj[1]
ZTest := rand(5) * Length2 + CenterObj[2]",39,42,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
moments_object_model_3d (ObjectModel3D, 'mean_points', CenterObj)
* --- End of Automatically A..."
1c8786b8,micro,9,and the model  (no guarantee),"calculate_view_pose (Center, [XTest[0],YTest[0],ZTest[0]], Dir, VX, VY, HomMat3D, Pose)
for Index := 0 to |XTest| - 1 by 1
TestPoint := [XTest[Index],YTest[Index],ZTest[Index]]
classify_class_knn (KNNHandle, TestPoint, NeighborIndices, Distance)
X := []
Y := []
Z := []
for I := 0 to |NeighborIndices...",43,90,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
Instructions[0] := 'Rotate: Left button'
gen_cam_par_area_scan_division (0.06, 0, 8.5e-6, 8.5e..."
1c8786b8,micro,10,,"SequenceSel := Sequence / 3
XTriple := X[SequenceSel]
YTriple := Y[SequenceSel]
ZTriple := Z[SequenceSel]
XMult := (Sequence % 3) [==] 0
YMult := (Sequence % 3) [==] 1
ZMult := (Sequence % 3) [==] 2
XYZ := XTriple * XMult + YTriple * YMult + ZTriple * ZMult",91,99,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
X := []
Y := []
Z := []
Sequence := [0:(3 * |X|) - 1]
* --- End of Automatically Added Context..."
1c8786b8,micro,11,,"smallest_bounding_box_object_model_3d (ObjectModel3D, 'axis_aligned', Pose, Length1, Length2, Length3)
return ()
Dir := (Center - RandomPoint) / sqrt(sum((Center - RandomPoint) * (Center - RandomPoint)))
if (abs(Dir[1]) &lt; 0.9)
tuple_vector_cross_product (Dir, [0, 1, 0], VX)
else
tuple_vector_cros...",100,152,"* --- Automatically Added Context ---
read_3d_sample_data (XYZ, Length1, Length2, Length3, ObjectModel3D)
create_pose (-8.8e-005, 7.48e-005, 0.035, 100, 0.03, 7, 'Rp+T', 'gba', 'point', Pose)
get_obje..."
304e1e6f,full,0,"This example visualizes the parameters of the k-NN classification
The points displayed symbolize sam...","Width := 180
Height := 200
dev_update_off ()
dev_close_window ()
dev_set_preferences ('graphics_window_context_menu', 'false')
dev_open_window (0, Width * 3 + 12, 300, Height * 3, 'black', WindowHandleResultBuffer)
dev_set_part (0, 0, Height * 3, 300)
dev_open_window (0, 0, Width * 3, Height * 3, 'b...",32,436,
304e1e6f,micro,1,,"Width := 180
Height := 200
dev_update_off ()
dev_close_window ()
dev_set_preferences ('graphics_window_context_menu', 'false')
dev_open_window (0, Width * 3 + 12, 300, Height * 3, 'black', WindowHandleResultBuffer)
dev_set_part (0, 0, Height * 3, 300)
dev_open_window (0, 0, Width * 3, Height * 3, 'b...",31,65,
304e1e6f,micro,2,,"create_test_region_with_index_knn (TrainingDataDots, KNNHandle)",68,69,
304e1e6f,micro,3,These values can be changed interactively in the example,"Method := 2
K := 3
Row := 139
Column := 57
P := [Row,Column]",70,76,
304e1e6f,micro,4,,"First := 1
Button := 1",77,79,
304e1e6f,micro,5,"point has to be explicitly set by clicking
the left mouse button. You might want to try
this to see ...","ContinuousMode := true
dev_error_var (ErrorVar, 1)",80,90,
304e1e6f,micro,6,Wait for mouse button (exit on right click),"while (Button != 4)
dev_set_check ('~give_error')
get_mposition (WindowHandle, Row, Column, Button)
if (ErrorVar != 2)
if (First)
Row := 300
Column := 300
Button := 0
else
continue
endif
endif
Row := Row / 3
Column := Column / 3
dev_set_check ('give_error')
if (Row &lt; LabelHeight and Button % 2 ==...",91,148,"* --- Automatically Added Context ---
Width := 180
Height := 200
dev_open_window (0, Width * 3 + 12, 300, Height * 3, 'black', WindowHandleResultBuffer)
dev_open_window (0, 0, Width * 3, Height * 3, '..."
304e1e6f,micro,7,,"disp_end_of_program_message (WindowHandleResult, 'black', 'true')
wait_seconds (0.3)
dev_set_preferences ('graphics_window_context_menu', 'true')",149,168,"* --- Automatically Added Context ---
dev_open_window (0, Width * 3 + 12, 300, Height * 3, 'black', WindowHandleResult)
* --- End of Automatically Added Context ---"
304e1e6f,micro,8,,"RowsClass1 := [53, 70, 78, 111]
ColumnsClass1 := [135, 48, 71, 138]
RowsClass2 := [59, 67, 132, 124, 140]
ColumnsClass2 := [37, 40, 114, 45, 29]
RowsClass3 := [48, 140, 127, 163]
ColumnsClass3 := [48, 84, 76, 31]
RowsClass4 := [118, 127, 139, 137, 170]
ColumnsClass4 := [120, 97, 163, 45, 115]",169,178,
304e1e6f,micro,9,,"Radius := 3
gen_circle (DotsClass1, RowsClass1, ColumnsClass1, gen_tuple_const(|RowsClass1|,Radius))
gen_circle (DotsClass2, RowsClass2, ColumnsClass2, gen_tuple_const(|RowsClass2|,Radius))
gen_circle (DotsClass3, RowsClass3, ColumnsClass3, gen_tuple_const(|RowsClass3|,Radius))
gen_circle (DotsClass...",179,192,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
RowsClass1 := [53, 70, 78, 111]
ColumnsClass1 := [135, 48, 71, 138]
RowsClass2 := [59, 67, 132, 12..."
304e1e6f,micro,10,,"create_class_knn (2, KNNHandle)",193,194,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
* --- End of Automatically Added Context ---"
304e1e6f,micro,11,,"Sequence := [0:2:|RowsClass1| * 2 - 1]
FeatureVector1[Sequence] := RowsClass1
FeatureVector1[Sequence + 1] := ColumnsClass1
add_sample_class_knn (KNNHandle, FeatureVector1, 1)",195,199,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
RowsClass1 := [53, 70, 78, 111]
ColumnsClass1 := [135, 48, 71, 138]
* --- End of Automatically Add..."
304e1e6f,micro,12,,"Sequence := [0:2:|RowsClass2| * 2 - 1]
FeatureVector2[Sequence] := RowsClass2
FeatureVector2[Sequence + 1] := ColumnsClass2
add_sample_class_knn (KNNHandle, FeatureVector2, 2)",200,204,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
RowsClass2 := [59, 67, 132, 124, 140]
ColumnsClass2 := [37, 40, 114, 45, 29]
RowsClass1 := [53, 70..."
304e1e6f,micro,13,,"Sequence := [0:2:|RowsClass3| * 2 - 1]
FeatureVector3[Sequence] := RowsClass3
FeatureVector3[Sequence + 1] := ColumnsClass3
add_sample_class_knn (KNNHandle, FeatureVector3, 3)",205,209,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
RowsClass3 := [48, 140, 127, 163]
ColumnsClass3 := [48, 84, 76, 31]
RowsClass1 := [53, 70, 78, 111..."
304e1e6f,micro,14,,"Sequence := [0:2:|RowsClass4| * 2 - 1]
FeatureVector4[Sequence] := RowsClass4
FeatureVector4[Sequence + 1] := ColumnsClass4
add_sample_class_knn (KNNHandle, FeatureVector4, 4)",210,214,"* --- Automatically Added Context ---
create_test_region_with_index_knn (TrainingDataDots, KNNHandle)
RowsClass4 := [118, 127, 139, 137, 170]
ColumnsClass4 := [120, 97, 163, 45, 115]
RowsClass1 := [53..."
304e1e6f,micro,15,,"train_class_knn (KNNHandle, [], [])
return ()
set_params_class_knn (KNNHandle, ['method', 'k'], ['neighbors_distance',k])
classify_class_knn (KNNHandle, P, Result, Rating)
Classes := []
gen_empty_obj (Lines)
for I := 0 to |Result| - 1 by 1
get_sample_class_knn (KNNHandle, Result[I], Features, ClassI...",215,451,"* --- Automatically Added Context ---
dev_open_window (0, Width * 3 + 12, 300, Height * 3, 'black', WindowHandleResult)
dev_open_window (0, 0, Width * 3, Height * 3, 'black', WindowHandle)
HighlightCo..."
10f3611b,full,0,"This example program shows how to use an MLP for classifying
two-dimensional data.  2D data is used ...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellip...",21,129,
10f3611b,micro,1,"two-dimensional data.  2D data is used because it can easily be visualized
as regions and images.  T...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')",6,27,
10f3611b,micro,2,samples are drawn.,"gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)",28,32,
10f3611b,micro,3,for each region and intersecting the segmented region with the class region.,"gen_image_const (Image, 'byte', 200, 200)
add_noise_white (Image, ImageNoise1, 60)
add_noise_white (Image, ImageNoise2, 60)
add_noise_white (Image, ImageNoise3, 60)
threshold (ImageNoise1, RegionNoise1, 40, 255)
threshold (ImageNoise2, RegionNoise2, 40, 255)
threshold (ImageNoise3, RegionNoise3, 40,...",33,44,"* --- Automatically Added Context ---
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)..."
10f3611b,micro,4,,"dev_clear_window ()
dev_set_color ('red')
dev_display (SamplesClass1)
dev_set_color ('green')
dev_display (SamplesClass2)
dev_set_color ('blue')
dev_display (SamplesClass3)
Message := 'Training samples of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",45,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, Samples..."
10f3611b,micro,5,,"concat_obj (SamplesClass1, SamplesClass2, Samples)
concat_obj (Samples, SamplesClass3, Samples)",56,58,"* --- Automatically Added Context ---
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, SamplesClass2)
intersection (RegionClass3, RegionNoise3, Sample..."
10f3611b,micro,6,"(here: 1), the MLP cannot discern the classes correctly.  For moderate
values (here: from 2 to about...","create_class_mlp (2, 5, 3, 'softmax', 'normalization', 1, 42, MLPHandle)
for Class := 0 to 2 by 1
select_obj (Samples, SamplesClass, Class + 1)
get_region_points (SamplesClass, Rows, Cols)
for J := 0 to |Rows| - 1 by 1
add_sample_class_mlp (MLPHandle, real([Rows[J],Cols[J]]), Class)
endfor
endfor
ge...",59,72,"* --- Automatically Added Context ---
concat_obj (SamplesClass1, SamplesClass2, Samples)
* --- End of Automatically Added Context ---"
10f3611b,micro,7,,"train_class_mlp (MLPHandle, 300, 0.01, 0.01, Error, ErrorLog)",73,74,"* --- Automatically Added Context ---
create_class_mlp (2, 5, 3, 'softmax', 'normalization', 1, 42, MLPHandle)
* --- End of Automatically Added Context ---"
10f3611b,micro,8,"the 2D feature space and accumulate them in three real images.  Furthermore,
store the most likely c...","gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_const (ProbClass2, 'real', 200, 200)
gen_image_const (ProbClass3, 'real', 200, 200)
gen_image_const (LabelClass, 'byte', 200, 200)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
Features := real([R,C])
evaluate_class_mlp (MLPHandle, Features, P...",75,94,"* --- Automatically Added Context ---
create_class_mlp (2, 5, 3, 'softmax', 'normalization', 1, 42, MLPHandle)
for Class := 0 to 2 by 1
* --- End of Automatically Added Context ---"
10f3611b,micro,9,,"dev_display (ProbClass1)
Message := 'Probability of class 1'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass2)
Message := 'Probability of class 2'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass...",95,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
Message := 'Training samples of the 3 classes'
gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_co..."
10f3611b,micro,10,,"dev_display (Probs)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Probabilities of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",108,118,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
10f3611b,micro,11,,"dev_set_colored (3)
dev_display (Classes)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Most probable classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",119,135,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
8c3cd0a7,full,0,"This example program shows the effect of regularizing an MLP using
two-dimensional data.  2D data is...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellip...",19,149,
8c3cd0a7,micro,1,"two-dimensional data.  2D data is used because it can easily be visualized
as regions and images.  T...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')",6,25,
8c3cd0a7,micro,2,samples are drawn.,"gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)",26,30,
8c3cd0a7,micro,3,for each region and intersecting the segmented region with the class region.,"gen_image_const (Image, 'byte', 200, 200)
add_noise_white (Image, ImageNoise1, 60)
add_noise_white (Image, ImageNoise2, 60)
add_noise_white (Image, ImageNoise3, 60)
threshold (ImageNoise1, RegionNoise1, 40, 255)
threshold (ImageNoise2, RegionNoise2, 40, 255)
threshold (ImageNoise3, RegionNoise3, 40,...",31,42,"* --- Automatically Added Context ---
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)..."
8c3cd0a7,micro,4,,"dev_clear_window ()
dev_set_color ('red')
dev_display (SamplesClass1)
dev_set_color ('green')
dev_display (SamplesClass2)
dev_set_color ('blue')
dev_display (SamplesClass3)
Message := 'Training samples of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_con...",43,54,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, Samples..."
8c3cd0a7,micro,5,,"concat_obj (SamplesClass1, SamplesClass2, Samples)
concat_obj (Samples, SamplesClass3, Samples)
WeightPriors := [0.1, 1.0, 10.0]
for I := 0 to |WeightPriors| - 1 by 1
WeightPrior := WeightPriors[I]
for UseRejectionClass := 0 to 1 by 1
if (UseRejectionClass)
create_class_mlp (2, 10, 4, 'softmax', 'no...",55,155,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
6ff99c13,full,0,"This example shows how an MLP can be used for regression (function
approximation).  First, 21 sample...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_part (0, 0, 499, 499)
D := rand(1)
create_class_mlp (1, 3, 1, 'linear', 'none', 1, 9, MLPHandle)
D := []
T := []
Noise := 0.2
NData := 21
for J :...",10,60,
6ff99c13,micro,1,"approximation).  First, 21 samples of a noisy sine wave are created.  Then, an
MLP with linear outpu...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_part (0, 0, 499, 499)",6,15,
6ff99c13,micro,2,"the seed.  Therefore, we will only get identical results if we call rand once
before calling create_...",D := rand(1),16,19,
6ff99c13,micro,3,,"create_class_mlp (1, 3, 1, 'linear', 'none', 1, 9, MLPHandle)",20,21,
6ff99c13,micro,4,,"D := []
T := []
Noise := 0.2
NData := 21
for J := 0 to NData - 1 by 1
D := [D,real(J) / (NData - 1)]
T := [T,sin(rad(360) * D[J]) + Noise * (rand(1) - 0.5)]
endfor",22,30,"* --- Automatically Added Context ---
D := rand(1)
* --- End of Automatically Added Context ---"
6ff99c13,micro,5,,"dev_clear_window ()
dev_set_color ('red')
disp_cross (WindowHandle, 250 - T * 200, D * 500, 20, 0)",31,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
D := rand(1)
T := []
* --- End of Automatically Added Context ---"
6ff99c13,micro,6,,"for J := 0 to NData - 1 by 1
add_sample_class_mlp (MLPHandle, D[J], T[J])
endfor
train_class_mlp (MLPHandle, 200, 0.00001, 0.00001, Error, ErrorLog)",35,39,"* --- Automatically Added Context ---
D := rand(1)
create_class_mlp (1, 3, 1, 'linear', 'none', 1, 9, MLPHandle)
T := []
NData := 21
for J := 0 to NData - 1 by 1
* --- End of Automatically Added Conte..."
6ff99c13,micro,7,"contain the output of the MLP, while G will contain the ground truth (i.e., the
true sine wave).","NPlot := 101
X := []
Y := []
G := []
for J := 0 to NPlot - 1 by 1
X := [X,real(J) / (NPlot - 1)]
evaluate_class_mlp (MLPHandle, X[J], R)
Y := [Y,R]
G := [G,sin(rad(360) * X[J])]
endfor
dev_set_color ('blue')
for J := 0 to NPlot - 2 by 1
disp_line (WindowHandle, 250 - G[J] * 200, X[J] * 500, 250 - G[...",40,66,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
create_class_mlp (1, 3, 1, 'linear', 'none', 1, 9, MLPHandle)
for J := 0 to NData - 1 by 1
* --- End of Au..."
978bc146,full,0,"This example program shows how to use a rejection class for
a MLP for classifying two-dimensional da...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
gen_ellipse (RegionClass1, 60, 60, rad(-45), 40, 20)
gen_ellip...",17,128,
978bc146,micro,1,"a MLP for classifying two-dimensional data.  2D data is used because
it can easily be visualized as ...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')",6,23,
978bc146,micro,2,,"gen_ellipse (RegionClass1, 60, 60, rad(-45), 40, 20)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 40, 20)
gen_ellipse (RegionClass3, 140, 100, rad(100), 35, 20)",24,27,
978bc146,micro,3,for each region and intersecting the segmented region with the class region.,"gen_image_const (Image, 'byte', 200, 200)
add_noise_white (Image, ImageNoise1, 60)
add_noise_white (Image, ImageNoise2, 60)
add_noise_white (Image, ImageNoise3, 60)
threshold (ImageNoise1, RegionNoise1, 40, 255)
threshold (ImageNoise2, RegionNoise2, 40, 255)
threshold (ImageNoise3, RegionNoise3, 40,...",28,39,"* --- Automatically Added Context ---
gen_ellipse (RegionClass1, 60, 60, rad(-45), 40, 20)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 40, 20)
gen_ellipse (RegionClass3, 140, 100, rad(100), 35, 20)..."
978bc146,micro,4,,"dev_clear_window ()
dev_set_color ('red')
dev_display (SamplesClass1)
dev_set_color ('green')
dev_display (SamplesClass2)
dev_set_color ('blue')
dev_display (SamplesClass3)
Message := 'Training samples of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",40,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, Samples..."
978bc146,micro,5,,"concat_obj (SamplesClass1, SamplesClass2, Samples)
concat_obj (Samples, SamplesClass3, Samples)",51,53,"* --- Automatically Added Context ---
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, SamplesClass2)
intersection (RegionClass3, RegionNoise3, Sample..."
978bc146,micro,6,"the rejection class. Thus, the NumOutput is set to 4 and not 3.","create_class_mlp (2, 5, 4, 'softmax', 'normalization', 1, 42, MLPHandle)
for Class := 0 to 2 by 1
select_obj (Samples, SamplesClass, Class + 1)
get_region_points (SamplesClass, Rows, Cols)
for J := 0 to |Rows| - 1 by 1
add_sample_class_mlp (MLPHandle, real([Rows[J],Cols[J]]), Class)
endfor
endfor
ge...",54,64,"* --- Automatically Added Context ---
concat_obj (SamplesClass1, SamplesClass2, Samples)
* --- End of Automatically Added Context ---"
978bc146,micro,7,It is instructive to try out different parameters of the rejection class.,"set_rejection_params_class_mlp (MLPHandle, 'sampling_strategy', 'hyperbox_around_all_classes')
* set_rejection_params_class_mlp (MLPHandle, 'rejection_class_index', 3)
* set_rejection_params_class_mlp (MLPHandle, 'hyperbox_tolerance', 0.1)
* set_rejection_params_class_mlp (MLPHandle, 'rejection_samp...",65,70,"* --- Automatically Added Context ---
create_class_mlp (2, 5, 4, 'softmax', 'normalization', 1, 42, MLPHandle)
* --- End of Automatically Added Context ---"
978bc146,micro,8,,"train_class_mlp (MLPHandle, 300, 0.01, 0.01, Error, ErrorLog)
stop ()",71,73,"* --- Automatically Added Context ---
create_class_mlp (2, 5, 4, 'softmax', 'normalization', 1, 42, MLPHandle)
* --- End of Automatically Added Context ---"
978bc146,micro,9,"the 2D feature space and accumulate them in three real images.  Furthermore,
store the most likely c...","gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_const (ProbClass2, 'real', 200, 200)
gen_image_const (ProbClass3, 'real', 200, 200)
gen_image_const (LabelClass, 'byte', 200, 200)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
Features := real([R,C])
evaluate_class_mlp (MLPHandle, Features, P...",74,93,"* --- Automatically Added Context ---
create_class_mlp (2, 5, 4, 'softmax', 'normalization', 1, 42, MLPHandle)
for Class := 0 to 2 by 1
* --- End of Automatically Added Context ---"
978bc146,micro,10,,"dev_display (ProbClass1)
Message := 'Probability of class 1'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass2)
Message := 'Probability of class 2'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
stop ()
dev_display (ProbClass...",94,106,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
Message := 'Training samples of the 3 classes'
gen_image_const (ProbClass1, 'real', 200, 200)
gen_image_co..."
978bc146,micro,11,,"dev_display (Probs)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Probabilities of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",107,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 40, 20)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 40, 20..."
978bc146,micro,12,,"dev_set_colored (6)
dev_display (Classes)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
Message := 'Most probable classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",118,134,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 40, 20)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 40, 20..."
d4cad612,full,0,"This example program shows how to use an SVM for classifying
two-dimensional data.  2D data is used ...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ell...",19,133,
d4cad612,micro,1,"two-dimensional data.  2D data is used because it can easily be visualized
as regions and images.  T...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()",6,23,
d4cad612,micro,2,samples are drawn.,"gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)",24,28,
d4cad612,micro,3,for each region and intersecting the segmented region with the class region.,"gen_image_const (Image, 'byte', 200, 200)
add_noise_white (Image, ImageNoise1, 60)
add_noise_white (Image, ImageNoise2, 60)
add_noise_white (Image, ImageNoise3, 60)
threshold (ImageNoise1, RegionNoise1, 40, 255)
threshold (ImageNoise2, RegionNoise2, 40, 255)
threshold (ImageNoise3, RegionNoise3, 40,...",29,40,"* --- Automatically Added Context ---
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30)
gen_ellipse (RegionClass3, 140, 100, rad(100), 55, 40)..."
d4cad612,micro,4,,"dev_clear_window ()
dev_set_color ('red')
dev_display (SamplesClass1)
dev_set_color ('green')
dev_display (SamplesClass2)
dev_set_color ('blue')
dev_display (SamplesClass3)
Message := 'Training samples of the 3 classes'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_con...",41,88,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
d4cad612,micro,5,,"concat_obj (SamplesClass1, SamplesClass2, Samples)
concat_obj (Samples, SamplesClass3, Samples)",89,91,"* --- Automatically Added Context ---
intersection (RegionClass1, RegionNoise1, SamplesClass1)
intersection (RegionClass2, RegionNoise2, SamplesClass2)
intersection (RegionClass3, RegionNoise3, Sample..."
d4cad612,micro,6,"depending on how the random samples are distributed) the boundaries of the
class regions will become...","create_class_svm (2, KernelType, KernelParam, Nu, 3, 'one-versus-one', 'normalization', 0, SVMHandle)
for Class := 0 to 2 by 1
select_obj (Samples, SamplesClass, Class + 1)
get_region_points (SamplesClass, Rows, Cols)
for J := 0 to |Rows| - 1 by 1
add_sample_class_svm (SVMHandle, real([Rows[J],Cols[...",92,108,"* --- Automatically Added Context ---
concat_obj (SamplesClass1, SamplesClass2, Samples)
* --- End of Automatically Added Context ---"
d4cad612,micro,7,,"train_class_svm (SVMHandle, 0.001, 'default')",109,110,"* --- Automatically Added Context ---
create_class_svm (2, KernelType, KernelParam, Nu, 3, 'one-versus-one', 'normalization', 0, SVMHandle)
* --- End of Automatically Added Context ---"
d4cad612,micro,8,in a class label image.,"gen_image_const (LabelClass, 'byte', 200, 200)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
Features := real([R,C])
classify_class_svm (SVMHandle, Features, 1, Class)
set_grayval (LabelClass, R, C, Class)
endfor
endfor
label_to_region (LabelClass, Classes)",111,121,"* --- Automatically Added Context ---
create_class_svm (2, KernelType, KernelParam, Nu, 3, 'one-versus-one', 'normalization', 0, SVMHandle)
for Class := 0 to 2 by 1
* --- End of Automatically Added Co..."
d4cad612,micro,9,,"dev_set_colored (3)
dev_display (Classes)
dev_set_color ('white')
dev_set_draw ('margin')
dev_display (RegionClass1)
dev_display (RegionClass2)
dev_display (RegionClass3)
dev_set_draw ('fill')
set_tposition (WindowHandle, 5, 5)
write_string (WindowHandle, 'Class regions')
return ()",122,150,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_ellipse (RegionClass1, 60, 60, rad(-45), 60, 40)
gen_ellipse (RegionClass2, 70, 130, rad(-145), 70, 30..."
45dad1f0,full,0,"This example program shows how to use get_support_vector_class_svm
to visualize the support vectors ...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
dev_update_off ()
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('clip_region', 'false')
gen_region_points (Region1, rand(1000) * 200, rand(1000) * 200)
gen_region_poin...",13,107,
45dad1f0,micro,1,"to visualize the support vectors of an SVM.  In this example, two-dimensional
data is used for the f...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
dev_update_off ()
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('clip_region', 'false')
gen_region_points (Region1, rand(1000) * 200, rand(1000) * 200)
gen_region_poin...",6,39,
45dad1f0,micro,2,"for the number of support vectors, increasing Nu will lead to a larger number
of support vectors and...","create_class_svm (2, 'rbf', 0.02, 0.01, 2, 'one-versus-one', 'normalization', 0, SVMHandle)",40,46,
45dad1f0,micro,3,,"for J := 0 to |Rows1| - 1 by 1
add_sample_class_svm (SVMHandle, [real(Rows1[J]),real(Cols1[J])], 0)
endfor
for J := 0 to |Rows2| - 1 by 1
add_sample_class_svm (SVMHandle, [real(Rows2[J]),real(Cols2[J])], 1)
endfor",47,53,"* --- Automatically Added Context ---
get_region_points (Region1, Rows1, Cols1)
get_region_points (Region2, Rows2, Cols2)
create_class_svm (2, 'rbf', 0.02, 0.01, 2, 'one-versus-one', 'normalization', ..."
45dad1f0,micro,4,,"train_class_svm (SVMHandle, 0.001, 'default')",54,55,"* --- Automatically Added Context ---
create_class_svm (2, 'rbf', 0.02, 0.01, 2, 'one-versus-one', 'normalization', 0, SVMHandle)
* --- End of Automatically Added Context ---"
45dad1f0,micro,5,,"get_support_vector_num_class_svm (SVMHandle, NumSupportVectors, NumSVPerSVM)
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
for J := 0 to NumSupportVectors - 1 by 1
get_support_vector_class_svm (SVMHandle, J, Index)
get_sample_class_svm (SVMHandle, Index, Features, Target)
if (Target == 0)
Rows1 :=...",56,74,"* --- Automatically Added Context ---
get_region_points (Region1, Rows1, Cols1)
get_region_points (Region2, Rows2, Cols2)
create_class_svm (2, 'rbf', 0.02, 0.01, 2, 'one-versus-one', 'normalization', ..."
45dad1f0,micro,6,result in a class label image.,"gen_image_const (Image, 'byte', 200, 200)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
classify_class_svm (SVMHandle, [real(R),real(C)], 1, Class)
set_grayval (Image, R, C, Class)
endfor
endfor
label_to_region (Image, Classes)
dev_clear_window ()
dev_set_colored (3)
dev_set_draw ('margin')
dev_disp...",75,113,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_region_points (Region1, rand(1000) * 200, rand(1000) * 200)
gen_region_points (Region2, rand(1000) * 2..."
ebd4bb09,full,0,"This example program shows how an SVM classifier behaves in the mode
'novelty-detection'.  The first...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
dev_update_off ()
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('clip_region', 'false')
gen_region_points (Region, rand(1000) * 200, rand(1000) * 200)
set_system ('cli...",16,141,
ebd4bb09,micro,1,"'novelty-detection'.  The first part of the program shows how the kernel
parameter gamma can be used...","dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
dev_set_part (0, 0, 199, 199)
dev_update_off ()
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('clip_region', 'false')
gen_region_points (Region, rand(1000) * 200, rand(1000) * 200)
set_system ('cli...",6,98,
ebd4bb09,micro,2,,"for J := 0 to |Rows| - 1 by 1
add_sample_class_svm (SVMHandle, [real(Rows[J]),real(Cols[J])], 0)
endfor",99,102,"* --- Automatically Added Context ---
get_region_points (Region, Rows, Cols)
create_class_svm (2, 'rbf', KernelParam, Nu, 1, 'novelty-detection', 'normalization', 0, SVMHandle)
* --- End of Automatica..."
ebd4bb09,micro,3,,"train_class_svm (SVMHandle, 0.001, 'default')",103,104,"* --- Automatically Added Context ---
create_class_svm (2, 'rbf', KernelParam, Nu, 1, 'novelty-detection', 'normalization', 0, SVMHandle)
* --- End of Automatically Added Context ---"
ebd4bb09,micro,4,result in a class label image.,"gen_image_const (Image, 'byte', 200, 200)
if (RejectionThreshold == 1.0)
for R := 0 to 199 by 1
for C := 0 to 199 by 1
classify_class_svm (SVMHandle, [real(R),real(C)], 1, Class)
set_grayval (Image, R, C, Class)
endfor
endfor
else
for R := 0 to 199 by 1
for C := 0 to 199 by 1
evaluate_class_svm (SVM...",105,153,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
gen_region_points (Region, rand(1000) * 200, rand(1000) * 200)
write_string (WindowHandle, 'Class with out..."
00c31011,full,0,simple assignment of the result of an expression to a variable,"Val := sin(1.2) + cos(1.2)
Tuple1 := [1, 0, 3, 4, 5, 6, 7, 8, 9]
Tuple1[1] := 2
Tuple1[1, 3, 5] := 'abc'
Tuple1[0, 4, 8] := ['000', '444', '888']
Tuple2[5] := 5
dev_update_off ()
count_seconds (Tb)
Tuple3 := []
for i := 0 to 10000 by 1
Tuple3[i] := i * i
endfor
count_seconds (Te)
T1 := Te - Tb
stop ...",7,57,
00c31011,micro,1,,Val := sin(1.2) + cos(1.2),6,8,
00c31011,micro,2,,"Tuple1 := [1, 0, 3, 4, 5, 6, 7, 8, 9]",9,11,
00c31011,micro,3,,Tuple1[1] := 2,12,14,"* --- Automatically Added Context ---
Tuple1 := [1, 0, 3, 4, 5, 6, 7, 8, 9]
* --- End of Automatically Added Context ---"
00c31011,micro,4,,"Tuple1[1, 3, 5] := 'abc'",15,17,"* --- Automatically Added Context ---
Tuple1 := [1, 0, 3, 4, 5, 6, 7, 8, 9]
* --- End of Automatically Added Context ---"
00c31011,micro,5,,"Tuple1[0, 4, 8] := ['000', '444', '888']",18,20,"* --- Automatically Added Context ---
Tuple1 := [1, 0, 3, 4, 5, 6, 7, 8, 9]
* --- End of Automatically Added Context ---"
00c31011,micro,6,intermediate values,Tuple2[5] := 5,21,24,
00c31011,micro,7,,"dev_update_off ()
count_seconds (Tb)
Tuple3 := []
for i := 0 to 10000 by 1
Tuple3[i] := i * i
endfor
count_seconds (Te)
T1 := Te - Tb
stop ()",25,35,
00c31011,micro,8,which avoids the reallocation of the tuple,"count_seconds (Tb)
Tuple3 := gen_tuple_const(10001,0)
for i := 0 to 10000 by 1
Tuple3[i] := i * i
endfor
count_seconds (Te)
T2 := Te - Tb
stop ()",36,46,"* --- Automatically Added Context ---
count_seconds (Tb)
Tuple3 := []
count_seconds (Te)
* --- End of Automatically Added Context ---"
00c31011,micro,9,a tuple sequence,"count_seconds (Tb)
Tuple3 := [0:10000]
Tuple3 := Tuple3 * Tuple3
count_seconds (Te)
T3 := Te - Tb",47,54,"* --- Automatically Added Context ---
Tuple3 := []
count_seconds (Tb)
count_seconds (Te)
* --- End of Automatically Added Context ---"
00c31011,micro,10,,"Tuple4 := [3:0.1:5]
Tuple5 := [100:-10:-100]",55,63,
404b3757,full,0,"This is a program with comments
'this is a string as comment'
here are numbers: 4711, 0.815","stop ()
# int i = 0;
stop ()
# Call MsgBox(""Continue"",wbYes,""Press button"","""",1000)",9,16,
404b3757,micro,1,"'this is a string as comment'
here are numbers: 4711, 0.815",stop (),6,9,
404b3757,micro,2,Please export to C++ to check this feature,"# int i = 0;
stop ()",10,13,
404b3757,micro,3,Please export to Visual Basic to check this feature,"# Call MsgBox(""Continue"",wbYes,""Press button"","""",1000)",14,22,
93bae4bc,full,0,,"read_image (Image, 'fabrik')
intensity (Image, Image, Mean, Deviation)
open_file ('intensity.txt', 'output', FileHandle)
fwrite_string (FileHandle, Mean + ' ' + Deviation)
close_file (FileHandle)
exit ()",6,11,
904e36aa,full,0,Inspection of Ball Bonding,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowID)
read_image (Bond, 'die/die_03')
dev_display (Bond)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
stop ()
threshold (Bond, Bright, 100, 255)
s...",8,60,
904e36aa,micro,1,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowID)
read_image (Bond, 'die/die_03')
dev_display (Bond)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
disp_continue_message (WindowID, 'black', 'true')
stop ()
threshold (Bond, Bright, 100, 255)
s...",6,66,
431f6f2a,full,0,"***************************************************************
Example program for demonstrating th...","RunInvalidLines := false
dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Text := 'This program demonstrates the use of the import statement.'
Text := [Text,'Please refer to the source code for details.', ' ']
Te...",22,100,
431f6f2a,micro,1,"invalid to demonstrate which procedure calls
can be resolved and which not.
By default, these lines ...","RunInvalidLines := false
dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Text := 'This program demonstrates the use of the import statement.'
Text := [Text,'Please refer to the source code for details.', ' ']
Te...",14,31,
431f6f2a,micro,2,,"if (RunInvalidLines)
Text := [Text,'Part 1: import relative path', ' ']
init (Text, Text)
calculate_results (Text, Text)
endif",37,44,"* --- Automatically Added Context ---
RunInvalidLines := false
Text := 'This program demonstrates the use of the import statement.'
* --- End of Automatically Added Context ---"
431f6f2a,micro,3,"calls can be resolved to the procedures in the according
directory. The path given in the import sta...","Text := [Text,'Part 1: import relative path', ' ']
import ./import_relative
init (Text, Text)
calculate_results (Text, Text)",45,54,"* --- Automatically Added Context ---
Text := 'This program demonstrates the use of the import statement.'
* --- End of Automatically Added Context ---"
431f6f2a,micro,4,"in subdir one directory level below, can't be resolved. Import
statements do not include the subdire...","if (0)
helper_function (Text, Text)
endif",55,64,"* --- Automatically Added Context ---
Text := 'This program demonstrates the use of the import statement.'
* --- End of Automatically Added Context ---"
431f6f2a,micro,5,"variable, and imports a single procedure library instead of a
directory. Calls to init and calculate...","get_system ('example_dir', HALCONEXAMPLES)
if (HALCONEXAMPLES == '')
Text := [Text,' ', 'Part 2 is skipped, because the']
Text := [Text,'environment variable HALCONEXAMPLES']
Text := [Text,'is not set.']
else
Text := [Text,' ', 'Part 2: use environment variable', ' ']
import %HALCONEXAMPLES%/hdevelo...",65,91,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
Text := 'This program demonstrates the use of the import statement.'
* --- End of Automatically Added Cont..."
431f6f2a,micro,6,quotes. Otherwise the program line becomes invalid!,"if (0)
import ./path contains spaces
endif",92,98,
431f6f2a,micro,7,,import './path contains spaces',99,106,
2938c704,full,0,"This is a simple example program that demonstrates the
option to call several HALCON operators or pr...","Loops := 3
dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Read codes sequ...",14,234,
2938c704,micro,1,,Loops := 3,13,15,
2938c704,micro,2,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Read codes sequentially an...",16,24,
2938c704,micro,3,"Therefore, it is not advisable to create threads for fast tasks.","count_seconds (T1)
for L := 1 to Loops * 10 by 1
par_start&lt;Thread1&gt; : do_nothing ()
par_start&lt;Thread2&gt; : do_nothing ()
par_start&lt;Thread3&gt; : do_nothing ()
par_join ([Thread1,Thread2,Thread3])
endfor
count_seconds (T2)",29,41,"* --- Automatically Added Context ---
Loops := 3
* --- End of Automatically Added Context ---"
2938c704,micro,4,,TimeOverhead := 1000.0 * (T2 - T1) / (Loops * 10),42,44,"* --- Automatically Added Context ---
Loops := 3
count_seconds (T1)
count_seconds (T2)
* --- End of Automatically Added Context ---"
2938c704,micro,5,that are not parallelized internally.,"count_seconds (T1)
for L := 1 to Loops by 1
par_start&lt;Thread1&gt; : wait_seconds (1)
par_start&lt;Thread2&gt; : wait_seconds (1)
par_start&lt;Thread3&gt; : wait_seconds (1)
par_join ([Thread1,Thread2,Thread3])
endfor
count_seconds (T2)",49,61,"* --- Automatically Added Context ---
Loops := 3
count_seconds (T1)
for L := 1 to Loops * 10 by 1
par_start&lt;Thread1&gt; : do_nothing ()
par_start&lt;Thread2&gt; : do_nothing ()
par_start&lt;Thread3..."
2938c704,micro,6,,TimeWaitSeconds := 1000.0 * (T2 - T1) / Loops,62,64,"* --- Automatically Added Context ---
Loops := 3
count_seconds (T1)
count_seconds (T2)
* --- End of Automatically Added Context ---"
2938c704,micro,7,,"create_data_code_2d_model ('QR Code', [], [], QrCodeModel)
create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'maximum_recognition', Ecc200Model)
create_bar_code_model ([], [], BarCodeModel)",70,74,
2938c704,micro,8,,"find_data_code_2d (Image, QrCodeXldsSeq, QrCodeModel, ['stop_after_result_num', 'train'], [2, 'all'], QrCodeHandlesSeq, QrCodeStringsSeq)
find_data_code_2d (Image, Ecc200XldsSeq, Ecc200Model, ['stop_after_result_num', 'train'], [2, 'all'], Ecc200HandlesSeq, Ecc200StringsSeq)
find_bar_code (Image, Ba...",75,79,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
create_data_code_2d_model ('QR Code', [], [], QrCodeModel)
create_data_code_2d_model ('Data Matrix..."
2938c704,micro,9,,"find_qr_codes (Image, QrCodeXldsSeq, QrCodeModel, QrCodeHandlesSeq, QrCodeStringsSeq)
find_ecc200_codes (Image, Ecc200Xlds, Ecc200Model, Ecc200Handles, Ecc200Strings)
find_bar_codes (Image, BarCodeRegions, BarCodeModel, BarCodeStrings)",80,84,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
create_data_code_2d_model ('QR Code', [], [], QrCodeModel)
create_data_code_2d_model ('Data Matrix..."
2938c704,micro,10,,"count_seconds (T1)
for L := 1 to Loops by 1
find_qr_codes (Image, QrCodeXldsSeq, QrCodeModel, QrCodeHandlesSeq, QrCodeStringsSeq)
find_ecc200_codes (Image, Ecc200Xlds, Ecc200Model, Ecc200Handles, Ecc200Strings)
find_bar_codes (Image, BarCodeRegions, BarCodeModel, BarCodeStrings)
endfor
count_seconds...",85,95,"* --- Automatically Added Context ---
Loops := 3
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
for L := 1 to Loops * 10 by 1
count_seconds (T1)
count_seconds (T2)
create_data_code_2d..."
2938c704,micro,11,,"count_seconds (T1)
for L := 1 to Loops by 1
par_start&lt;ThreadQRCode&gt; : find_qr_codes (Image, QrCodeXlds, QrCodeModel, QrCodeHandlesSeq, QrCodeStringsSeq)
par_start&lt;ThreadECC200&gt; : find_ecc200_codes (Image, Ecc200Xlds, Ecc200Model, Ecc200Handles, Ecc200Strings)
par_start&lt;ThreadBarcode&g...",96,107,"* --- Automatically Added Context ---
Loops := 3
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
for L := 1 to Loops * 10 by 1
create_data_code_2d_model ('QR Code', [], [], QrCodeModel..."
2938c704,micro,12,,Speedup := 100 * ((TimeSeq / TimePar) - 1),108,110,"* --- Automatically Added Context ---
Loops := 3
TimeSeq := 1000.0 * (T2 - T1) / Loops
TimePar := 1000.0 * (T2 - T1) / Loops
count_seconds (T1)
count_seconds (T2)
* --- End of Automatically Added Cont..."
2938c704,micro,13,,"dev_set_draw ('margin')
dev_set_line_width (4)
dev_set_color ('yellow')
dev_display (QrCodeXlds)
dev_set_color ('green')
dev_display (Ecc200Xlds)
dev_set_color ('cyan')
dev_display (BarCodeRegions)
Color := ['forest green', 'red']
disp_message (WindowHandle, 'Multithreading speedup: ' + Speedup$'.2f...",111,143,"* --- Automatically Added Context ---
Loops := 3
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_ecc200_codes (Image, Ecc200Xlds, Ecc200Model, Ecc200Handles, Ecc200Strings)
find_bar..."
2938c704,micro,14,,"Loops := 10
for L := 1 to Loops by 1
find_data_code_2d (Image, QrCodeXldsSeq, QrCodeModel, 'stop_after_result_num', 2, QrCodeHandlesSeq, QrCodeStringsSeq)
endfor
return ()",144,177,"* --- Automatically Added Context ---
Loops := 3
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
for L := 1 to Loops * 10 by 1
create_data_code_2d_model ('QR Code', [], [], QrCodeModel..."
2938c704,micro,15,,"Loops := 2
for L := 1 to Loops by 1
find_data_code_2d (Image, Ecc200Xlds, Ecc200Model, 'stop_after_result_num', 2, Ecc200Handles, Ecc200Strings)
endfor
return ()",178,210,"* --- Automatically Added Context ---
Loops := 3
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
for L := 1 to Loops * 10 by 1
create_data_code_2d_model ('Data Matrix ECC 200', 'defaul..."
2938c704,micro,16,,"Loops := 10
for L := 1 to Loops by 1
find_bar_code (Image, BarCodeRegions, BarCodeModel, ['EAN-13', 'Code 128'], BarCodeStrings)
endfor
return ()",211,229,"* --- Automatically Added Context ---
Loops := 3
read_image (Image, 'barcode/mixed/barcodes_datacodes_mixed_01')
for L := 1 to Loops * 10 by 1
create_data_code_2d_model ('QR Code', [], [], QrCodeModel..."
2938c704,micro,17,of thread creation.,return (),232,240,
580ef9e6,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
count_obj (Regions, Number)
dev_update_window ('off')
for i := 1 to Number by 1
select_obj (Regions, RegionSelected, i)
dev_clear_window ()
dev_display (RegionSelected)
stop ()
endfor",6,15,
15011100,full,0,"This is a simple HDevelop script demonstrating how a
multiway branch is implemented using switch/cas...","Results := []
for Index := 1 to 6 by 1
TestStr := 'Executed case blocks for Index = ' + Index + ': '
switch (Index)
case 1:
TestStr := TestStr + ' case 1'
break
case 2:
TestStr := TestStr + ' case 2'
case 20:
TestStr := TestStr + ' case 20'
case 200:
TestStr := TestStr + ' case 200'
break
case 3:
ca...",9,39,
15011100,micro,1,multiway branch is implemented using switch/case statements,"Results := []
for Index := 1 to 6 by 1
TestStr := 'Executed case blocks for Index = ' + Index + ': '
switch (Index)
case 1:
TestStr := TestStr + ' case 1'
break
case 2:
TestStr := TestStr + ' case 2'
case 20:
TestStr := TestStr + ' case 20'
case 200:
TestStr := TestStr + ' case 200'
break
case 3:
ca...",6,45,
1046871b,full,0,"This example program demonstrates the usage of the exception handling
in HDevelop.
Whether an error ...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']
for Index := 0 to |ImageNames| - 1 by 1
try
read_image (Image, ImageNames[Index])
threshold (Image, Re...",15,142,
1046871b,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",13,18,
1046871b,micro,2,,"ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']",19,21,
1046871b,micro,3,,"for Index := 0 to |ImageNames| - 1 by 1
try
read_image (Image, ImageNames[Index])
threshold (Image, Region, 128, 255)
disp_message (WindowHandle, 'Image name: ' + ImageNames[Index], 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
catch (Exception)
dev...",22,42,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']
* --- End of Automatically Added Context ---"
1046871b,micro,4,,"for Index := 0 to |ImageNames| - 1 by 1
try
read_image (Image, ImageNames[Index])
threshold (Image, Region, 128, 255)
disp_message (WindowHandle, 'Image name: ' + ImageNames[Index], 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
catch (Exception)
con...",43,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']
for Index := 0 to |ImageNames| - 1 by 1
read_..."
1046871b,micro,5,,"try
throw_exception_add_user_data (ImageNames)
stop ()
catch (Exception)
dev_clear_window ()
dev_get_exception_data (Exception, 'error_msg', ErrorMsg)
dev_get_exception_data (Exception, 'user_data', UserData)
disp_message (WindowHandle, ['Error message: ' + ErrorMsg,'Image name:    ' + UserData], 'w...",58,72,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']
dev_get_exception_data (Exception, 'error_msg..."
1046871b,micro,6,,"try
throw_user_defined_exception (ImageNames)
stop ()
catch (Exception)
dev_clear_window ()
disp_message (WindowHandle, Exception, 'window', 12, 12, 'red', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
endtry
dev_clear_window ()
for Index := 0 to |ImageNames| - 1 by 1
try
rea...",73,162,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ImageNames := ['mreut', 'the_mreut_image', 'rings_and_nuts']
for Index := 0 to |ImageNames| - 1 by 1
read_..."
f7b25b45,full,0,"This example explains how variable types are defined in HDevelop.
In addition to the correct usage, ...","Message := 'This program shows the usage of the different variable types in HDevelop:'
Message[2] := ' '
Message[3] := ' - Control variables'
Message[4] := ' - Iconic variables'
Message[5] := ' - Control vector variables'
Message[6] := ' - Iconic vector variables'
Warning := '  This program is NOT e...",18,176,
f7b25b45,micro,1,,"Message := 'This program shows the usage of the different variable types in HDevelop:'
Message[2] := ' '
Message[3] := ' - Control variables'
Message[4] := ' - Iconic variables'
Message[5] := ' - Control vector variables'
Message[6] := ' - Iconic vector variables'
Warning := '  This program is NOT e...",17,34,
f7b25b45,micro,2,"variable type implicitly.
E.g., the following lines define an iconic variable IconicObject
and a con...","gen_image_const (IconicObject, 'byte', 512, 512)
ControlTuple := 0",39,45,
f7b25b45,micro,3,,"procedure_with_parameters (IconicObject, ControlOutputVector2Dim)",49,51,"* --- Automatically Added Context ---
gen_image_const (IconicObject, 'byte', 512, 512)
* --- End of Automatically Added Context ---"
f7b25b45,micro,4,,"global tuple GlobalControlTuple1
global object GlobalIconicObject2",52,55,
f7b25b45,micro,5,,"read_image (IconicObject, VariableOfUndefinedType)",57,59,"* --- Automatically Added Context ---
gen_image_const (IconicObject, 'byte', 512, 512)
* --- End of Automatically Added Context ---"
f7b25b45,micro,6,,"gen_image_const (ConflictingVariable, 'byte', 512, 512)
ConflictingVariable := 1 * 1",63,66,
f7b25b45,micro,7,"Vector vs. Control tuple
1-dimensional vector vs. 2-dimensional vector","VectorOrTuple := {1}
VectorOrTuple := [1]
ControlVector1or2Dim := {1}
ControlVector1or2Dim := {{1}}",67,75,
f7b25b45,micro,8,"different type is expected, the line becomes invalid.","NotIconic := 1
invert_image (NotIconic, ImageInvert)
gen_image_const (NotATuple, 'byte', 512, 512)
X := NotATuple + 1",76,82,
f7b25b45,micro,9,"Therefore, the variable declarations of
GlobalTuple2 and GlobalObject2 below are valid.
Only the two...","global tuple GlobalTuple
gen_image_const (GlobalTuple, 'byte', 512, 512)
global object GlobalObject
GlobalObject := 2",83,91,
f7b25b45,micro,10,"type definitions in HDevelop, and overrule even global variable
declarations.
Please check the sourc...","conflicting_parameters_and_global_variables (IconicObject, ControlOutputVector2Dim)",92,98,"* --- Automatically Added Context ---
gen_image_const (IconicObject, 'byte', 512, 512)
procedure_with_parameters (IconicObject, ControlOutputVector2Dim)
* --- End of Automatically Added Context ---"
f7b25b45,micro,11,are highlighted in a different color than syntax errors.,"read_image (IconicObject, VariableOfUndefinedType)
read_imaXe (IconicObject, VariableOfUndefinedType)",99,103,"* --- Automatically Added Context ---
gen_image_const (IconicObject, 'byte', 512, 512)
read_image (IconicObject, VariableOfUndefinedType)
* --- End of Automatically Added Context ---"
f7b25b45,micro,12,,"ControlVector2Dim := {{}, {3}, {4, 5}}
ControlVector2Dim := {}",106,109,
f7b25b45,micro,13,,"ControlVector1Dim := {}
for I := 0 to 4 by 1
ControlVector1Dim.at(I) := I
endfor",111,116,
f7b25b45,micro,14,a single assignment of an empty vector stays invalid.,VectorOfUndefinedType := {},117,120,
f7b25b45,micro,15,,* VectorOfUndefinedType := {1},121,137,"* --- Automatically Added Context ---
VectorOfUndefinedType := {}
* --- End of Automatically Added Context ---"
f7b25b45,micro,16,"In this case, the parameter IconicInputObject is an iconic object,
and ControlOutputVector2Dim is a ...","threshold (IconicInputObject, Region, 128, 255)
connection (Region, ConnectedRegions)
count_obj (IconicInputObject, ControlOutputVector2Dim.at(0).at(0))
return ()",138,162,"* --- Automatically Added Context ---
procedure_with_parameters (IconicObject, ControlOutputVector2Dim)
* --- End of Automatically Added Context ---"
f7b25b45,micro,17,"type definitions in HDevelop and overrule even global
variable declarations.
In this case, the param...","global tuple vector(3) IconicInputObject
global object ControlOutputVector2Dim
threshold (IconicInputObject, Region, 128, 255)
connection (Region, ConnectedRegions)
count_obj (IconicInputObject, ControlOutputVector2Dim.at(0).at(0))
stop ()
return ()",163,185,"* --- Automatically Added Context ---
procedure_with_parameters (IconicObject, ControlOutputVector2Dim)
threshold (IconicInputObject, Region, 128, 255)
connection (Region, ConnectedRegions)
* --- End ..."
daad6abd,full,0,"In addition to the two well established variable types in HDevelop,
tuples and iconic objects, there...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program gives an overview of'
Message[1] := 'vector variables and how to use them.'
Message[2] := 'Please'
Message[3] := ' - ste...",17,106,
daad6abd,micro,1,"tuples and iconic objects, there is a third variable type: the vector.
A vector is a container that ...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program gives an overview of'
Message[1] := 'vector variables and how to use them.'
Message[2] := 'Please'
Message[3] := ' - ste...",6,29,
daad6abd,micro,2,list of its elements between curly brackets.,"Vector1 := {1, 2}",32,34,
daad6abd,micro,3,,"Vector2 := {[1, 2]}",35,36,
daad6abd,micro,4,,"Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector3 := {Tuple1, Tuple2}",37,40,
daad6abd,micro,5,,"read_image (ImageFabrik, 'fabrik')
read_image (ImagePatras, 'patras')
ImageVector := {ImageFabrik, ImagePatras}",41,44,
daad6abd,micro,6,,"Vector2dim := {{1, 2}, Vector3}
Vector3dim := {Vector2dim, {Vector1, Vector2}}",45,47,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
* --- End of Automatically Added Context ---"
daad6abd,micro,7,,"* InvalidExpression := {Vector1, Vector2dim}",49,51,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector2dim := {{1, 2}, Vector3}
* --- End of Automatically Added Context ---"
daad6abd,micro,8,Vector elements are accessed via the .at() expression,"Tuple := Vector3.at(0)
Image := ImageVector.at(1)",52,55,"* --- Automatically Added Context ---
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
ImageVector := {ImageFabrik, ImagePatras}
read_image (ImageFabrik, 'fabrik')
read_image (ImagePatra..."
daad6abd,micro,9,"E.g., they can be used as output parameters.",Vector4.at(0) := Tuple,56,58,"* --- Automatically Added Context ---
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Tuple := Vector3.at(0)
* --- End of Automatically Added Context ---"
daad6abd,micro,10,the vector is automatically filled with empty elements.,Vector5.at(4) := Tuple,59,61,"* --- Automatically Added Context ---
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Tuple := Vector3.at(0)
* --- End of Automatically Added Context ---"
daad6abd,micro,11,(as long as they have the required type).,"for I := 0 to ImageVector.length() - 1 by 1
sobel_amp (ImageVector.at(I), ImageVectorSobel.at(I), 'sum_abs', 3)
endfor",62,67,"* --- Automatically Added Context ---
ImageVector := {ImageFabrik, ImagePatras}
read_image (ImageFabrik, 'fabrik')
read_image (ImagePatras, 'patras')
* --- End of Automatically Added Context ---"
daad6abd,micro,12,subelements of multidimensional vectors.,"Vector3dim.at(1).at(0) := {5, 6}",68,70,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector3dim := {Vector2dim, {Vector1, Vector2}}
Vector2dim := ..."
daad6abd,micro,13,,Vector3dim.at(0).at(1).at(1)[0] := 8,71,73,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector3dim := {Vector2dim, {Vector1, Vector2}}
Vector2dim := ..."
daad6abd,micro,14,The number of elements of a vector can be accessed with .length(),Length := Vector1.length(),74,77,"* --- Automatically Added Context ---
Vector1 := {1, 2}
* --- End of Automatically Added Context ---"
daad6abd,micro,15,,"Vector3dimCopy := Vector3dim
Vector3dimCopy.clear()",79,81,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector3dim := {Vector2dim, {Vector1, Vector2}}
Vector2dim := ..."
daad6abd,micro,16,"following assignments cause a type conflict and, therefore, are invalid!","* Vector3dimCopy.at(0) := 1
* Vector3dimCopy.at(0) := {1}",82,85,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector3dim := {Vector2dim, {Vector1, Vector2}}
Vector2dim := ..."
daad6abd,micro,17,,Vector5.remove(0),86,88,"* --- Automatically Added Context ---
Vector5.at(4) := Tuple
* --- End of Automatically Added Context ---"
daad6abd,micro,18,,"Vector5.insert(1, 2)",89,90,"* --- Automatically Added Context ---
Vector5.at(4) := Tuple
* --- End of Automatically Added Context ---"
daad6abd,micro,19,,"Vector5.insert(8, 10)",91,93,"* --- Automatically Added Context ---
Vector5.at(4) := Tuple
* --- End of Automatically Added Context ---"
daad6abd,micro,20,Convert a tuple into a one-dimensional vector,"Tuple3 := [1, 2, 3, 4, 5, 6, 7, 8]
convert_tuple_to_vector_1d (Tuple3, 1, Vector1FromTuple3)
convert_tuple_to_vector_1d (Tuple3, 2, Vector2FromTuple3)",94,98,
daad6abd,micro,21,"input vector of arbitrary dimension and stores them in the single
output tuple.","convert_vector_to_tuple (Vector5, TupleFromVector5)
convert_vector_to_tuple (Vector2dim, TupleFromVector2dim)",99,104,"* --- Automatically Added Context ---
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector2dim := {{1, 2}, Vector3}
Vector5.at(4) := Tuple
* --- End of Automatically Added Context ---"
daad6abd,micro,22,,"dev_inspect_ctrl ([Tuple3,Vector1FromTuple3,Vector2FromTuple3,Vector5,TupleFromVector5,Vector2dim,TupleFromVector2dim,Vector3dim])",105,112,"* --- Automatically Added Context ---
Vector1 := {1, 2}
Vector2 := {[1, 2]}
Vector3 := {Tuple1, Tuple2}
Tuple1 := [5, 6]
Tuple2 := 'eight'
Vector2dim := {{1, 2}, Vector3}
Vector3dim := {Vector2dim, {V..."
64065ecd,full,0,,"dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
read_image (Image, 'particle')
dev_display (Image)
stop ()
threshold (Image, Large, 110, 255)
dilation_circle (Large, LargeDilation, 7.5)
dev_display (Image)
dev_set_draw ('margin')
dev_set_line_width (...",6,53,
a8ced680,full,0,"This example demonstrates the inference workflow
for Global Context Anomaly Detection (GC-AD).
The n...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)
ImageDir := 'pcb_anomaly'
ImageSubDirs := ['good', 'anomaly']
OutputDir := './anomaly_pcb_board_data'
GenParamDataset := dict{image_sub_dirs: ImageSubDirs}
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
sp...",21,456,
a8ced680,micro,1,"1. Dataset preprocessing.
2. Inference on pcb board images.
3. (optional) Inspect results using loca...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)",16,25,
a8ced680,micro,2,"Images in subfolders named differently will be treated as
containing anomalies. They can be used for...","ImageDir := 'pcb_anomaly'
ImageSubDirs := ['good', 'anomaly']",28,34,
a8ced680,micro,3,,OutputDir := './anomaly_pcb_board_data',35,38,
a8ced680,micro,4,,"GenParamDataset := dict{image_sub_dirs: ImageSubDirs}
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)",41,44,"* --- Automatically Added Context ---
ImageDir := 'pcb_anomaly'
ImageSubDirs := ['good', 'anomaly']
* --- End of Automatically Added Context ---"
a8ced680,micro,5,performing inference.,"split_dl_dataset (DLDataset, 0, 0, [])",45,48,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Context ---"
a8ced680,micro,6,set key parameters.,"read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)",49,52,
a8ced680,micro,7,,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: 'true'}
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",53,57,"* --- Automatically Added Context ---
OutputDir := './anomaly_pcb_board_data'
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
read_dl_model ('detect_pcb_gc_anomalies.hdl', D..."
a8ced680,micro,8,,"WindowDict := dict{}
DatasetSamples := DLDataset.samples
for Index := 0 to 9 by 1
SampleIndex := int(rand(1) * |DatasetSamples|)
read_dl_samples (DLDataset, SampleIndex, DLSample)
GenParam := dict{}
GenParam.display_ground_truth_anomaly_regions := false
GenParam.display_bottom_desc := false
dev_disp...",58,75,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Context ---"
a8ced680,micro,9,,"query_available_dl_devices (['runtime', 'runtime', 'id'], ['gpu', 'cpu', 0], DLDeviceHandles)
if (DLDeviceHandles == [])
throw ('No suitable CPU or GPU was found.')
endif
DLDeviceHandle := DLDeviceHandles[0]",76,82,
a8ced680,micro,10,use a more powerful GPU or a more powerful CPU instead.,"set_dl_model_param (DLModelHandle, 'device', DLDeviceHandle)",83,86,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
DLDeviceHandle := DLDeviceHandles[0]
query_available_dl_devices (['runtime', 'runtime', 'id'], ['gpu'..."
a8ced680,micro,11,,"get_dl_device_param (DLDeviceHandle, 'type', DeviceType)
query_available_dl_devices ('ai_accelerator_interface', 'tensorrt', DLDeviceHandlesTensorRT)
if (DLDeviceHandlesTensorRT == [] or DeviceType == 'cpu')
else
try
get_dl_device_param (DLDeviceHandlesTensorRT, 'optimize_for_inference_params', Opti...",87,107,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
DLDeviceHandle := DLDeviceHandles[0]
query_available_dl_devices (['runtime', 'runtime', 'id'], ['gpu'..."
a8ced680,micro,12,"to some randomly chosen images that have not been used during
training.","MaxNumInferenceImages := 15
get_random_test_image_paths (DLDataset, MaxNumInferenceImages, InferenceImagePaths)",110,115,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Context ---"
a8ced680,micro,13,with the model in the meta data above.,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
InferenceClassificationThreshold := number(MetaData.anomaly_classification_threshold)
InferenceSegmentationThreshold := number(MetaData.anomaly_segmentation_threshold)",116,121,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
a8ced680,micro,14,,"DLDatasetInfo := dict{class_names: ['ok', 'nok'], class_ids: [0, 1]}",122,124,
a8ced680,micro,15,"postprocessing to inspect only the relevant parts of the
computed anomaly image. For more details, p...","InferenceDomainHandling := ['full_domain', 'keep_domain']
DLPreprocessParam.domain_handling := InferenceDomainHandling[0]",127,134,"* --- Automatically Added Context ---
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
* --- End of Automatically Added Context ---"
a8ced680,micro,16,"during the evaluation step, the domain information can be
loaded from the model meta data. Alternati...","UseDomainFromModel := false
if (DLPreprocessParam.domain_handling == 'keep_domain')
if (UseDomainFromModel)
read_domain_from_model (RestrictedDomain, DLModelHandle)
zoom_domain_to_image_size (RestrictedDomain, RestrictedDomain, InferenceImagePaths[0], DLModelHandle)
else
gen_rectangle1 (RestrictedDo...",135,154,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocess..."
a8ced680,micro,17,,"WindowDict := dict{}
for IndexInference := 0 to |InferenceImagePaths| - 1 by 1
read_image (Image, InferenceImagePaths[IndexInference])
if (DLPreprocessParam.domain_handling == 'keep_domain')
reduce_domain (Image, RestrictedDomain, Image)
endif
gen_dl_samples_from_images (Image, DLSample)
preprocess_...",155,180,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocess..."
a8ced680,micro,18,,"stop ()
MaxNumInferenceImages := 12
get_random_test_anomaly_image_paths (ImageDir + '/anomaly', MaxNumInferenceImages, AnomalyInferenceImagePaths)",191,196,"* --- Automatically Added Context ---
ImageDir := 'pcb_anomaly'
MaxNumInferenceImages := 15
* --- End of Automatically Added Context ---"
a8ced680,micro,19,,"WindowDict := dict{}
for IndexInference := 0 to |AnomalyInferenceImagePaths| - 1 by 1
read_image (Image, AnomalyInferenceImagePaths[IndexInference])
if (DLPreprocessParam.domain_handling == 'keep_domain')
reduce_domain (Image, RestrictedDomain, Image)
endif
gen_dl_samples_from_images (Image, DLSampl...",197,222,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocess..."
a8ced680,micro,20,,clean_up_output (OutputDir),223,237,"* --- Automatically Added Context ---
OutputDir := './anomaly_pcb_board_data'
* --- End of Automatically Added Context ---"
a8ced680,micro,21,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",240,248,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
a8ced680,micro,22,,"remove_dir_recursively (OutputDir)
FilesToBeRemoved := ['final_dl_anomaly_global_context.hdl', 'intermediate_dl_anomaly_global_context.hdl', 'intermediate_dl_anomaly_global_context_info.hdict']
for FileIndex := 0 to |FilesToBeRemoved| - 1 by 1
file_exists (FilesToBeRemoved[FileIndex], FileExists)
if...",249,277,"* --- Automatically Added Context ---
OutputDir := './anomaly_pcb_board_data'
* --- End of Automatically Added Context ---"
a8ced680,micro,23,,"DLSamples := DLDataset.samples
find_dl_samples (DLSamples, 'split', 'test', 'match', TestSampleIndices)
NumTestImages := min2(|TestSampleIndices|,MaxNumTestImages)
tuple_shuffle (TestSampleIndices, TestSampleIndicesShuffled)
ImagePaths := gen_tuple_const(NumTestImages,-1)
for Index := 0 to NumTestIm...",280,336,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
for Index := 0 to 9 by 1
SampleIndex := int(rand(1) * |DatasetSamples|)
read_dl_samples..."
a8ced680,micro,24,,"list_image_files (ImageDir, 'default', [], ImageFiles)
tuple_shuffle (ImageFiles, ImageFiles)
ImagePaths := ImageFiles[0:MaxNumTestImages - 1]
return ()",337,387,"* --- Automatically Added Context ---
ImageDir := 'pcb_anomaly'
ImagePaths := gen_tuple_const(NumTestImages,-1)
NumTestImages := min2(|TestSampleIndices|,MaxNumTestImages)
find_dl_samples (DLSamples, ..."
a8ced680,micro,25,,"read_image (Image, ImagePath)
get_image_size (Image, ImageWidth, ImageHeight)
get_dl_model_param (DLModelHandle, 'input_dimensions', InputDimensions)
ScaleWidth := ImageWidth / real(InputDimensions.image[0])
ScaleHeight := ImageHeight / real(InputDimensions.image[1])
zoom_region (Domain, DomainZoome...",388,443,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
read_dl_samples (DLDataset..."
a8ced680,micro,26,and converts it to a region.,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
get_dict_param (MetaData, 'key_exists', 'domain', HasDomain)
if (not HasDomain)
throw ('Current model provides no domain information.')
endif
json_to_dict (MetaData.domain, 'convert_json_arrays_to', 'tuple_if_possible', DomainDict)
gen_region...",444,480,"* --- Automatically Added Context ---
read_dl_model ('detect_pcb_gc_anomalies.hdl', DLModelHandle)
get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
zoom_region (Domain, DomainZoomed, ScaleWid..."
81168550,full,0,"This example demonstrates the general workflow
for Global Context Anomaly Detection (GC-AD).
With GC...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)
TrainedModel := 'detect_juice_bottle_gc_anomalies.hdl'
ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
ImageWidth := 'default'
ImageHeight := 'default'
PatchSize := 'default'
display_info_...",20,773,
81168550,micro,1,,"dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)",18,23,
81168550,micro,2,"To train the model yourself, set TrainedModel to false.
To evaluate a previously trained model, set ...",TrainedModel := 'detect_juice_bottle_gc_anomalies.hdl',26,31,
81168550,micro,3,"your own data as long as your anomaly-free images
are located in a subfolder called 'good' or 'ok'.","ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']",38,43,
81168550,micro,4,"of the pretrained model (256 x 256 px) or the trained
model, if TrainedModel is set to a model path....","ImageWidth := 'default'
ImageHeight := 'default'",44,51,
81168550,micro,5,"set with the parameter PatchSize. For further information,
see the documentation of get_dl_model_par...",PatchSize := 'default',52,59,
81168550,micro,6,,"display_info_text ('start')
stop ()
dev_close_window ()",60,65,
81168550,micro,7,,"load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
if (TrainedModel == false)
train (DLDataset, DLModelHandle)
endif
evaluate (DLDataset, DLModelHandle)
if (TrainedModel == false)
write_dl_mode...",66,81,"* --- Automatically Added Context ---
TrainedModel := 'detect_juice_bottle_gc_anomalies.hdl'
ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
ImageWidth := ..."
81168550,micro,8,,"compare_gc_anomaly_networks (ImageDir, ImageSubDirs, DLPreprocessParam, DLModelHandle)
clean_up_output (PreprocessDir)",82,97,"* --- Automatically Added Context ---
ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWi..."
81168550,micro,9,,"display_info_text ('clean_up')
stop ()
dev_close_window ()
remove_dir_recursively (PreprocessDir)
return ()",101,127,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,10,,"DLSamples := DLDataset.samples
find_dl_samples (DLSamples, 'split', 'test', 'match', TestSampleIndices)
NumTestImages := min2(|TestSampleIndices|,MaxNumTestImages)
tuple_shuffle (TestSampleIndices, TestSampleIndicesShuffled)
ImagePaths := gen_tuple_const(NumTestImages,-1)
for Index := 0 to NumTestIm...",130,193,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,11,Detection model and preprocesses the dataset.,"display_info_text ('load_dataset_and_model')
stop ()
dev_close_window ()",194,200,
81168550,micro,12,,PreprocessDir := './anomaly_juice_bottle_data',201,203,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,13,,"if (TrainedModel == 'false')
throw ('To train your own model, set TrainedModel to false (boolean) instead of \'false\' (string).')
elseif (TrainedModel == true or TrainedModel == 'true')
throw ('To evaluate a trained model, set TrainedModel to the path to the model.')
elseif (TrainedModel != false)
...",204,249,"* --- Automatically Added Context ---
TrainedModel := 'detect_juice_bottle_gc_anomalies.hdl'
ImageWidth := 'default'
ImageHeight := 'default'
PatchSize := 'default'
load_dataset_and_model (TrainedMode..."
81168550,micro,14,,"if (ImageWidth == 'default')
get_dl_model_param (DLModelHandle, 'image_width', ImageWidth)
endif
if (ImageHeight == 'default')
get_dl_model_param (DLModelHandle, 'image_height', ImageHeight)
endif
if (PatchSize == 'default')
get_dl_model_param (DLModelHandle, 'patch_size', PatchSize)
endif",250,260,"* --- Automatically Added Context ---
ImageWidth := 'default'
ImageHeight := 'default'
PatchSize := 'default'
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, Pat..."
81168550,micro,15,,"GenParamDataset := dict{image_sub_dirs: ImageSubDirs}
read_dl_dataset_anomaly (ImageDir, [], [], [], GenParamDataset, DLDataset)",261,264,"* --- Automatically Added Context ---
ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWi..."
81168550,micro,16,"For a dataset that contains only a small number of images,
the fraction of validation images might h...","split_dl_dataset (DLDataset, 70, 10, [])",265,269,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,17,,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, PreprocessDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",270,274,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,18,,"NumDisplaySamples := 10
WindowDict := dict{}
DatasetSamples := DLDataset.samples
for Index := 0 to NumDisplaySamples - 1 by 1
SampleIndex := int(rand(1) * |DatasetSamples|)
read_dl_samples (DLDataset, SampleIndex, DLSample)
GenParam := dict{}
GenParam.display_ground_truth_anomaly_regions := false
Ge...",275,324,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
for ..."
81168550,micro,19,,"display_info_text ('train')
stop ()
dev_close_window ()",325,330,
81168550,micro,20,GC-AD models can be expected.,"set_dl_model_param (DLModelHandle, 'batch_size', 1)",331,334,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,21,,"query_available_dl_devices (['runtime', 'id'], ['gpu', 0], DLDeviceHandle)
if (DLDeviceHandle == [])
throw ('It is recommended to use a GPU for training, due to a long training time on the CPU.')
endif",335,340,"* --- Automatically Added Context ---
throw ('No suitable CPU or GPU was found.')
* --- End of Automatically Added Context ---"
81168550,micro,22,the model parameters 'image_dimensions' or 'patch_size'.,"set_dl_model_param (DLModelHandle, 'device', DLDeviceHandle)",341,344,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
quer..."
81168550,micro,23,"If just the local network should be trained we recommend
a number of 35,000 training steps.",NumTrainSteps := 70000,345,349,
81168550,micro,24,,"find_dl_samples (DLDataset.samples, 'split', 'train', 'match', TrainSampleIndices)
NumEpochs := ceil(real(NumTrainSteps) / |TrainSampleIndices|)",350,353,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
NumT..."
81168550,micro,25,"In this example, we rotate the images slightly and apply
color jitter.","AugmentationDict := dict{}
AugmentationDict.augmentation_percentage := 100
AugmentationDict.rotate_range := 3
AugmentationDict.brightness_variation := 20
AugmentationDict.contrast_variation := 0.2
AugmentationDict.saturation_variation := 0.2",354,363,
81168550,micro,26,,"get_dl_model_param (DLModelHandle, 'learning_rate', InitialLR)
LRDecayDict := dict{}
LRDecayDict.model_param := 'learning_rate'
LRDecayDict.initial_value := InitialLR
LRDecayDict.epochs := 0.95 * NumEpochs
LRDecayDict.values := 0.1 * InitialLR
SerializationDict := dict{}
SerializationDict.type := 'c...",364,377,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
NumT..."
81168550,micro,27,done using the following procedure. This may take a long time.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",378,381,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
crea..."
81168550,micro,28,the global network.,"normalize_dl_gc_anomaly_scores (DLDataset, DLModelHandle, [])
dev_disp_text ('Press Run (F5) to continue with the evaluation of the model', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_window ()
return ()",382,406,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,29,"segmentation thresholds and evaluates the performance of
the trained model.","display_info_text ('evaluate')
stop ()
dev_close_window ()",407,414,
81168550,micro,30,"a pixel or image is regarded as anomalous. The procedure
compute_dl_anomaly_thresholds returns possi...","GenParamThreshold := dict{}
GenParamThreshold.enable_display := 'true'
GenParamThreshold.segmentation_criterion := 'tolerance'
GenParamThreshold.segmentation_tolerance := 0.0
compute_dl_anomaly_thresholds (DLModelHandle, DLDataset, GenParamThreshold, SegmentationThreshold, ClassificationThresholds)
...",415,429,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
dev_..."
81168550,micro,31,test split.,"GenParamEvaluation := dict{}
GenParamEvaluation.measures := 'all'
GenParamEvaluation.anomaly_classification_thresholds := ClassificationThresholds
GenParamEvaluation.gc_anomaly_networks := ['local', 'global']
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEvaluation, Evaluatio...",430,437,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
comp..."
81168550,micro,32,"the test images and the classification thresholds used for the
evaluation.","GenParamDisplay := dict{}
GenParamDisplay.display_mode := ['score_histogram', 'score_legend']
WindowDict := dict{}
dev_display_anomaly_detection_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', '...",438,448,"* --- Automatically Added Context ---
WindowDict := dict{}
dev_disp_text ('Press Run (F5) to continue with the evaluation of the model', 'window', 'bottom', 'right', 'black', [], [])
evaluate_dl_model..."
81168550,micro,33,confusion matrix for a given classification threshold.,"GenParamDisplay.display_mode := ['pie_charts_precision', 'pie_charts_recall', 'absolute_confusion_matrix']",449,451,"* --- Automatically Added Context ---
GenParamDisplay := dict{}
* --- End of Automatically Added Context ---"
81168550,micro,34,"ClassificationThresholds for display. We use the last
one of the computed ClassificationThresholds.
...","ClassificationThresholdIndex := |ClassificationThresholds| - 1
GenParamDisplay.classification_threshold_index := ClassificationThresholdIndex
WindowDict := dict{}
dev_display_anomaly_detection_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press Run (F5) to co...",452,464,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue with the evaluation of the model', 'window', 'bottom', 'right', 'black', [], [])
compute_dl_anomaly_thresholds (DLModel..."
81168550,micro,35,,ClassificationThreshold := ClassificationThresholds[ClassificationThresholdIndex],465,466,"* --- Automatically Added Context ---
compute_dl_anomaly_thresholds (DLModelHandle, DLDataset, GenParamThreshold, SegmentationThreshold, ClassificationThresholds)
ClassificationThresholdIndex := |Clas..."
81168550,micro,36,,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
MetaData.anomaly_segmentation_threshold := SegmentationThreshold$'1.16e'
MetaData.anomaly_classification_threshold := ClassificationThreshold$'1.16e'
set_dl_model_param (DLModelHandle, 'meta_data', MetaData)
set_dl_model_param (DLModelHandle,...",467,492,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
comp..."
81168550,micro,37,"to some randomly chosen images that have not been used during
training.","display_info_text ('inference')
stop ()
dev_close_window ()
MaxNumInferenceImages := 10
get_random_test_image_paths (DLDataset, MaxNumInferenceImages, InferenceImagePaths)",493,503,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,38,the model in the meta data.,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
ClassificationThreshold := number(MetaData.anomaly_classification_threshold)
SegmentationThreshold := number(MetaData.anomaly_segmentation_threshold)",504,509,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
comp..."
81168550,micro,39,,"DLDatasetInfo := dict{class_names: ['ok', 'nok'], class_ids: [0, 1]}",510,512,
81168550,micro,40,"inspected. For more details, please see the chapter reference of
Deep Learning / GC-AD.","InferenceDomainHandling := ['full_domain', 'keep_domain']
DLPreprocessParam.domain_handling := InferenceDomainHandling[0]",515,519,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
* --..."
81168550,micro,41,,"WindowDict := dict{}
for IndexInference := 0 to |InferenceImagePaths| - 1 by 1
read_image (Image, InferenceImagePaths[IndexInference])
if (DLPreprocessParam.domain_handling == 'keep_domain')
reduce_juice_bottle_domain (Image, Image)
endif
gen_dl_samples_from_images (Image, DLSample)
preprocess_dl_sa...",520,562,"* --- Automatically Added Context ---
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWidth, ImageHeight, PatchSize, DLDataset, DLPreprocessParam, PreprocessDir, DLModelHandle)
DLSa..."
81168550,micro,42,"detecting structural anomalies, while the global network
successfully finds logical anomalies. Some ...","display_info_text ('compare_gc_anomaly_networks')
stop ()
dev_close_window ()
MaxNumImagesPerSubdir := 10",575,585,
81168550,micro,43,,"for SubDirIndex := 0 to |ImageSubDirs| - 1 by 1
SubDir := ImageSubDirs[SubDirIndex]
if (regexp_match(SubDir,['^ok$', 'ignore_case']) != '' or regexp_match(SubDir,['^good$', 'ignore_case']) != '')
continue
endif
list_image_files (ImageDir + '/' + SubDir, 'default', [], ImageFiles)
tuple_shuffle (Imag...",595,648,"* --- Automatically Added Context ---
ImageDir := 'juice_bottle'
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
load_dataset_and_model (TrainedModel, ImageDir, ImageSubDirs, ImageWi..."
81168550,micro,44,start of each part of the workflow.,"dev_open_window (0, 0, 500, 300, 'light gray', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",649,653,
81168550,micro,45,Colors contains the color for each text in Texts.,"Texts := []
Colors := []
StandardColor := 'black'
FocusColor := '#f28d26'
if (Part == 'start')
Colors := []
Text := 'The workflow is split up into different'
Text := Text + '\nparts which are encapsulated in '
Text := Text + '\nseparate local procedures:'
Text := Text + '\n\n1. load_dataset_and_mode...",654,718,"* --- Automatically Added Context ---
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
throw ('The model given by TrainedModel has been trained with an image width of ' + TrainedImage..."
81168550,micro,46,color of each line in the sum of strings in Texts.,"LineColors := []
for TextIndex := 0 to |Texts| - 1 by 1
Text := Texts[TextIndex]
TextColor := Colors[TextIndex]
NumLines := 1
Position := strchr(Text,'\n')
while (Position != -1)
NumLines := NumLines + 1
if (Position + 1 == strlen(Text))
break
endif
Text := Text{Position + 1:strlen(Text) - 1}
Positi...",719,762,"* --- Automatically Added Context ---
ImageSubDirs := ['good', 'logical_anomaly', 'structural_anomaly']
dev_disp_text ('Press Run (F5) to continue with the evaluation of the model', 'window', 'bottom'..."
81168550,micro,47,domain is used to illustrate the keep_domain feature.,"threshold (Image, Region, 0 + 20, 'max')",763,765,"* --- Automatically Added Context ---
read_image (Image, InferenceImagePaths[IndexInference])
* --- End of Automatically Added Context ---"
81168550,micro,48,,"opening_circle (Region, RegionOpening, 3.5)
dilation_circle (RegionOpening, RegionDilation, 10)
get_image_size (Image, Width, Height)
gen_rectangle1 (Top, 0, 0, Height, Width)
intersection (Top, RegionDilation, Domain)
reduce_domain (Image, Domain, ImageReduced)
return ()",766,789,"* --- Automatically Added Context ---
read_image (Image, InferenceImagePaths[IndexInference])
threshold (Image, Region, 0 + 20, 'max')
* --- End of Automatically Added Context ---"
d41c2a68,full,0,"Deep learning anomaly detection example.
This example demonstrates the general workflow for anomaly ...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)
ImageDir := 'bottles'
ImageSubDirs := ['good', 'broken_large', 'broken_small', 'contamination']
AnomalyLabelsDir := 'labels/bottles'
OutputDir := './anomaly_bottle_data'
ExampleSpecificPreprocessing := true
ImageWidth := 320
ImageHei...",18,295,
d41c2a68,micro,1,"1. Dataset preprocessing.
2. Training of the model on anomaly-free ('ok') images.
3. Threshold estim...","dev_update_off ()
dev_close_window ()
set_system ('seed_rand', 73)",12,22,
d41c2a68,micro,2,"data as long as your anomaly-free images are located in a subdirectory
called 'good' or 'ok'.","ImageDir := 'bottles'
ImageSubDirs := ['good', 'broken_large', 'broken_small', 'contamination']",32,37,
d41c2a68,micro,3,"them is specified by AnomalyLabelsDir.
Note that no ground truth annotations are required for traini...",AnomalyLabelsDir := 'labels/bottles',38,43,
d41c2a68,micro,4,,OutputDir := './anomaly_bottle_data',44,46,
d41c2a68,micro,5,preprocessed by a procedure specifically designed for the present dataset.,ExampleSpecificPreprocessing := true,47,50,
d41c2a68,micro,6,"that small defects are still visible.
Please refer to the documentation of read_dl_model for possibl...","ImageWidth := 320
ImageHeight := 320",51,57,
d41c2a68,micro,7,"complex applications. A higher value can improve the performance but
increases the time needed to tr...",Complexity := 15,58,63,
d41c2a68,micro,8,,"GenParamDataset := dict{image_sub_dirs: ImageSubDirs}
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)",72,75,"* --- Automatically Added Context ---
ImageDir := 'bottles'
ImageSubDirs := ['good', 'broken_large', 'broken_small', 'contamination']
AnomalyLabelsDir := 'labels/bottles'
* --- End of Automatically Ad..."
d41c2a68,micro,9,"For a dataset that contains only a small number of images
the fraction of validation images might ha...","split_dl_dataset (DLDataset, 50, 10, [])",76,80,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Context ---"
d41c2a68,micro,10,For documentation see set_dl_model_param () and get_dl_model_param ().,"read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
set_dl_model_param (DLModelHandle, 'image_width', ImageWidth)
set_dl_model_param (DLModelHandle, 'image_height', ImageHeight)
set_dl_model_param (DLModelHandle, 'complexity', Complexity)",81,86,"* --- Automatically Added Context ---
ImageWidth := 320
ImageHeight := 320
Complexity := 15
* --- End of Automatically Added Context ---"
d41c2a68,micro,11,,"query_available_dl_devices (['runtime', 'id'], ['cpu', 0], DLDevice)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",87,90,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
d41c2a68,micro,12,,"create_dl_preprocess_param_from_model (DLModelHandle, 'constant_values', 'full_domain', [], [], [], DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: 'true'}
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",91,95,"* --- Automatically Added Context ---
OutputDir := './anomaly_bottle_data'
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
read_dl_model ('initial_dl_anomaly_m..."
d41c2a68,micro,13,"Please note: If it is possible to restrict the area (ROI) in the images where defects
can occur, we ...","if (ExampleSpecificPreprocessing)
read_dl_samples (DLDataset, [0:|DLDataset.samples| - 1], DLSampleBatch)
preprocess_dl_samples_bottle (DLSampleBatch)
write_dl_samples (DLDataset, [0:|DLDataset.samples| - 1], DLSampleBatch, [], [])
endif",96,106,"* --- Automatically Added Context ---
ExampleSpecificPreprocessing := true
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Con..."
d41c2a68,micro,14,,"WindowDict := dict{}
for Index := 0 to 9 by 1
SampleIndex := int(rand(1) * |DLDataset.samples|)
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'anomaly_ground_truth', [], WindowDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'r...",107,124,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
* --- End of Automatically Added Context ---"
d41c2a68,micro,15,,EnableDisplay := true,129,131,
d41c2a68,micro,16,"If the training error drops below this threshold, the training is finished.
Otherwise, the training ...","TrainParamAnomaly := dict{error_threshold: 0.001}
MaxNumEpochs := 30",132,137,
d41c2a68,micro,17,"The performance of the trained model might be improved by setting a larger value.
This, however, wil...",TrainParamAnomaly.domain_ratio := 0.25,138,142,"* --- Automatically Added Context ---
TrainParamAnomaly := dict{error_threshold: 0.001}
* --- End of Automatically Added Context ---"
d41c2a68,micro,18,"In case the training fails, try to set a higher value.","TrainParamAnomaly.regularization_noise := 0.01
create_dl_train_param (DLModelHandle, MaxNumEpochs, [], EnableDisplay, 73, 'anomaly', TrainParamAnomaly, TrainParam)",143,148,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
EnableDisplay := true
TrainParamAnomaly := dict{error_threshold: 0.001}
MaxNumEpochs := 30
* --- En..."
d41c2a68,micro,19,encapsulated in the following procedure. The training may take some time.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_window ()",149,157,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
dev_disp_t..."
d41c2a68,micro,20,"get_dl_model_param () for details.
This parameter can improve the classification between 'ok' and 'n...","StandardDeviationFactor := 1.0
set_dl_model_param (DLModelHandle, 'standard_deviation_factor', StandardDeviationFactor)",163,169,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
d41c2a68,micro,21,"is regarded as anomalous. The procedure compute_dl_anomaly_thresholds returns
possible suggestions b...","GenParamThresholds := dict{enable_display: true}
compute_dl_anomaly_thresholds (DLModelHandle, DLDataset, GenParamThresholds, AnomalySegmentationThreshold, AnomalyClassificationThresholds)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_wi...",170,182,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
dev_disp_t..."
d41c2a68,micro,22,,"GenParamEvaluation := dict{measures: 'all'}
GenParamEvaluation.anomaly_classification_thresholds := AnomalyClassificationThresholds
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEvaluation, EvaluationResult, EvalParams)",183,187,"* --- Automatically Added Context ---
read_dl_dataset_anomaly (ImageDir, AnomalyLabelsDir, [], [], GenParamDataset, DLDataset)
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
compute_dl..."
d41c2a68,micro,23,and the classification thresholds used for the evaluation.,"GenParamDisplay := dict{display_mode: ['score_histogram', 'score_legend']}
WindowDict := dict{}
dev_display_anomaly_detection_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', 'box', 'true')
stop ...",188,197,"* --- Automatically Added Context ---
WindowDict := dict{}
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
evaluate_dl_model (DLDataset, DLModelHandle, 'spli..."
d41c2a68,micro,24,for a given classification threshold.,"GenParamDisplay.display_mode := ['pie_charts_precision', 'pie_charts_recall', 'absolute_confusion_matrix']",198,200,"* --- Automatically Added Context ---
GenParamDisplay := dict{display_mode: ['score_histogram', 'score_legend']}
* --- End of Automatically Added Context ---"
d41c2a68,micro,25,"AnomalyClassificationThresholds for display. We use the last
one of the computed AnomalyClassificati...","ClassificationThresholdIndex := |AnomalyClassificationThresholds| - 1
GenParamDisplay.classification_threshold_index := ClassificationThresholdIndex
WindowDict := dict{}
dev_display_anomaly_detection_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press Run (F5...",201,214,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
compute_dl_anomaly_thresholds (DLModelHandle, DLDataset, GenParamThresh..."
d41c2a68,micro,26,,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
MetaData.anomaly_segmentation_threshold := AnomalySegmentationThreshold$'1.16e'
MetaData.anomaly_classification_threshold := AnomalyClassificationThresholds[ClassificationThresholdIndex]$'1.16e'
set_dl_model_param (DLModelHandle, 'meta_data',...",215,220,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
compute_dl_anomaly_thresholds (DLModelHandle, DLDataset, GenParamThresholds, AnomalySegmentationThr..."
d41c2a68,micro,27,,"write_dl_model (DLModelHandle, 'model_final.hdl')",221,224,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
d41c2a68,micro,28,trained model to some randomly chosen example images.,"list_image_files (ImageDir + '/' + ImageSubDirs, 'default', 'recursive', ImageFiles)
tuple_shuffle (ImageFiles, ImageFilesShuffled)",227,231,"* --- Automatically Added Context ---
ImageDir := 'bottles'
ImageSubDirs := ['good', 'broken_large', 'broken_small', 'contamination']
* --- End of Automatically Added Context ---"
d41c2a68,micro,29,the model in the meta data above.,"get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
InferenceClassificationThreshold := number(MetaData.anomaly_classification_threshold)
InferenceSegmentationThreshold := number(MetaData.anomaly_segmentation_threshold)",232,237,"* --- Automatically Added Context ---
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
get_dl_model_param (DLModelHandle, 'meta_data', MetaData)
* --- End of Automatically Added Context ..."
d41c2a68,micro,30,,"DLDatasetInfo := dict{class_names: ['ok', 'nok'], class_ids: [0, 1]}
WindowDict := dict{}
for IndexInference := 0 to min2(|ImageFilesShuffled|,10) - 1 by 1
read_image (Image, ImageFilesShuffled[IndexInference])
gen_dl_samples_from_images (Image, DLSample)
preprocess_dl_samples (DLSample, DLPreproces...",238,276,"* --- Automatically Added Context ---
ExampleSpecificPreprocessing := true
read_dl_model ('initial_dl_anomaly_medium.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'constan..."
d41c2a68,micro,31,,"for SampleIndex := 0 to |DLSamples| - 1 by 1
DLSample := DLSamples[SampleIndex]
rgb1_to_gray (DLSample.image, GrayImage)
threshold (GrayImage, CenterRegion, 'min', 1.5)
fill_up (CenterRegion, CenterRegionFillUp)
reduce_domain (DLSample.image, CenterRegionFillUp, DLSample.image)
endfor
return ()",281,303,"* --- Automatically Added Context ---
SampleIndex := int(rand(1) * |DLDataset.samples|)
read_dl_samples (DLDataset, SampleIndex, DLSample)
* --- End of Automatically Added Context ---"
70ee7634,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL classification. I...","dev_update_off ()
ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_read_dataset (ExampleInt...",21,792,
70ee7634,micro,1,,dev_update_off (),19,22,
70ee7634,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.","ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_read_dataset (ExampleInternals)
stop ()
de...",23,50,
70ee7634,micro,3,,RawImageBaseFolder := 'pill/',55,57,
70ee7634,micro,4,,ExampleDataDir := 'classify_pill_defects_data',58,59,
70ee7634,micro,5,,DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill',60,62,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
70ee7634,micro,6,,LabelSource := 'last_folder',67,69,
70ee7634,micro,7,,"TrainingPercent := 70
ValidationPercent := 15",70,73,
70ee7634,micro,8,"see read_dl_model () for the model of your choice.
Image dimensions the images are rescaled to durin...","ImageWidth := 300
ImageHeight := 300
ImageNumChannels := 3",74,80,
70ee7634,micro,9,,"NormalizationType := 'none'
DomainHandling := 'full_domain'",81,84,
70ee7634,micro,10,This means that re-running the script results in the same split of DLDataset.,SeedRand := 42,85,88,
70ee7634,micro,11,,"set_system ('seed_rand', SeedRand)",93,95,"* --- Automatically Added Context ---
SeedRand := 42
* --- End of Automatically Added Context ---"
70ee7634,micro,12,"Alternatively, you can read a DLDataset dictionary
as created by e.g., the MVTec Deep Learning Tool ...","read_dl_dataset_classification (RawImageBaseFolder, LabelSource, DLDataset)",96,99,"* --- Automatically Added Context ---
RawImageBaseFolder := 'pill/'
LabelSource := 'last_folder'
* --- End of Automatically Added Context ---"
70ee7634,micro,13,,"split_dl_dataset (DLDataset, TrainingPercent, ValidationPercent, [])",100,103,"* --- Automatically Added Context ---
TrainingPercent := 70
ValidationPercent := 15
read_dl_dataset_classification (RawImageBaseFolder, LabelSource, DLDataset)
* --- End of Automatically Added Context..."
70ee7634,micro,14,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
make_dir (ExampleDataDir)
endif",108,113,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
70ee7634,micro,15,,"create_dl_preprocess_param ('classification', ImageWidth, ImageHeight, ImageNumChannels, -127, 128, NormalizationType, DomainHandling, [], [], [], [], DLPreprocessParam)",114,116,"* --- Automatically Added Context ---
ImageWidth := 300
ImageHeight := 300
ImageNumChannels := 3
NormalizationType := 'none'
DomainHandling := 'full_domain'
* --- End of Automatically Added Context --..."
70ee7634,micro,16,,DataDirectory := DataDirectoryBaseName + '_' + ImageWidth + 'x' + ImageHeight,117,119,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill'
ImageWidth := 300
ImageHeight := 300
* --- End of Autom..."
70ee7634,micro,17,,"GenParam := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, DataDirectory, DLPreprocessParam, GenParam, DLDatasetFileName)",120,123,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill'
read_dl_dataset_classification (RawImageBaseFolder, Lab..."
70ee7634,micro,18,,"PreprocessParamFileBaseName := DataDirectory + '/dl_preprocess_param.hdict'
write_dict (DLPreprocessParam, PreprocessParamFileBaseName, [], [])",124,127,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill'
create_dl_preprocess_param ('classification', ImageWidt..."
70ee7634,micro,19,,"find_dl_samples (DLDataset.samples, 'split', 'train', 'match', SampleIndices)
tuple_shuffle (SampleIndices, ShuffledIndices)
read_dl_samples (DLDataset, ShuffledIndices[0:9], DLSampleBatchDisplay)
WindowHandleDict := dict{}
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
dev_display_dl_data (DLSam...",134,147,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageBaseFolder, LabelSource, DLDataset)
* --- End of Automatically Added Context ---"
70ee7634,micro,20,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_next_example (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",148,169,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
70ee7634,micro,21,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",170,176,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,22,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",177,181,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,23,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL classification. It uses the MVTec pill dataset.'
Text[|Text|] := ''
Text[|Text|] := 'The ...",182,214,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
* --- End of Automatically Added Context ---"
70ee7634,micro,24,,"try
GinsengPath := 'pill/ginseng/' + ['good/pill_ginseng_good_001', 'contamination/pill_ginseng_contamination_004', 'crack/pill_ginseng_crack_001']
MagnesiumPath := 'pill/magnesium/' + ['good/pill_magnesium_good_001', 'contamination/pill_magnesium_contamination_001', 'crack/pill_magnesium_crack_001'...",215,268,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text[|Text|] := 'The four parts are: '
* --- End of Automatically Added Context ---"
70ee7634,micro,25,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",269,275,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,26,,"TrainRatio := 0.7
ValRatio := 0.15
TestRatio := 1.0 - TrainRatio - ValRatio",276,280,
70ee7634,micro,27,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",281,285,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,28,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
set_window_param (WindowHandleText, 'flush', 'false')
Text := 'The procedure \'split_dl_dataset\' splits the dataset'
Text[|Text|] := 'randomly into three subsets.'
Text[|Text|] := ''
Text[|Text|] :=...",286,302,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
Te..."
70ee7634,micro,29,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_images_width', Width)
get_dict_tuple (ExampleInternals, 'window_images_height', Height)
dev_set_part (0, 0, Height, Width)",303,310,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_image_size (TiledImage, Width, Height)
* --- End of Automatically Added Context ---"
70ee7634,micro,30,,"PieChartCenterRow := Height / 2.0
PieChartCenterCol := Width / 2.0
PieChartRadius := min([Width,Height]) * 0.425
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
pi := 4.0 * atan(1.0)
Ratios := [TrainRatio,ValRatio,TestRatio]
Text := ['Train', 'Validation', 'Test']
alpha := 0
dev_display_pie_chart...",311,365,"* --- Automatically Added Context ---
Text := 'Press Run (F5) to continue'
get_image_size (TiledImage, Width, Height)
TrainRatio := 0.7
ValRatio := 0.15
TestRatio := 1.0 - TrainRatio - ValRatio
get_di..."
70ee7634,micro,31,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",366,372,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,32,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)",373,376,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,33,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now the first part \'Dataset preprocessing\' of the workflow'
Text[|Text|] := 'for DL classification is finished.'
Text[|Text|] := ''
Text[|Text|] := 'The dataset is ready for training. '
Te...",377,406,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'the workflow for DL classification. It uses the MVTe..."
70ee7634,micro,34,and shows some image examples.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",407,414,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,35,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'In this example we will explain how labeled data is'
Text[|Text|] := 'read to the expected format and preprocessed'
Text[|Text|] := 'to make it suitable for training.'
Text[|Text|] := ''
Tex...",419,431,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'the workflow for DL classification. It uses the MVTe..."
70ee7634,micro,36,,"dev_display_pills_example_dataset_preview (ExampleInternals)
return ()",432,452,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,37,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_displ...",455,503,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of..."
70ee7634,micro,38,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",506,517,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
70ee7634,micro,39,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",518,533,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
get_dict_tuple (ExampleInternals, 'window_images', Windo..."
70ee7634,micro,40,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",534,557,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
get_dict_param (ExampleInternals, 'keys', [], WindowHand..."
70ee7634,micro,41,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
ClearImageWindow := find(ClearWindows,WindowHandleImages)
if (ClearAllWindows or (|ClearImageWindow| and ClearImageWindow &gt; -1))
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
cat...",558,569,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (E..."
70ee7634,micro,42,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
ClearLegendWindow := find(ClearWindows,WindowHandleLegend)
if (ClearAllWindows or (|ClearLegendWindow| and ClearLegendWindow &gt; -1))
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
...",570,612,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
get_dict_tuple (ExampleInternals, 'wind..."
70ee7634,micro,43,,"WindowWidthText := 800
WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
s...",613,645,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
get_dict_tuple (ExampleInternals, '..."
70ee7634,micro,44,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",646,670,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Automatically Added Co..."
70ee7634,micro,45,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",671,709,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
catch (Exception)
* --- End o..."
70ee7634,micro,46,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",710,716,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,47,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'After reading and splitting the dataset it is ready to be preprocessed.'
Text[|Text|] := 'This can be done by using \'preprocess_dl_dataset\'.'
Text[|Text|] := ''
Text[|Text|] := 'In this co...",722,761,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'This example covers part 1: \'Dataset preprocessing\..."
70ee7634,micro,48,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",762,768,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
70ee7634,micro,49,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'There are two possibilities to read in the dataset.'
Text[|Text|] := 'Either there is an existing dictionary or the raw images are present'
Text[|Text|] := 'and labeled in separate folders.'...",774,800,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_dl_dataset_classification (RawImageBaseFolder, LabelSource, DLDataset)
Text := 'Press Run (F5) to con..."
c53ddad9,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL classification. I...","dev_update_off ()
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDe...",21,1215,
c53ddad9,micro,1,classify_pill_defects_deep_learning_1_preprocess.hdev,"dev_update_off ()
ShowExampleScreens := true",18,24,
c53ddad9,micro,2,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",25,33,
c53ddad9,micro,3,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",34,43,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
c53ddad9,micro,4,,"if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_train (ExampleInternals)
stop ()
dev_display_screen_error (ExampleInternals, Error)
if (Error)
stop ()
endif
dev_display_screen_training_goals_1 (ExampleInternals)
stop ()
dev_display_scre...",44,101,"* --- Automatically Added Context ---
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
* --- End of Automa..."
c53ddad9,micro,5,,ExampleDataDir := 'classify_pill_defects_data',106,107,
c53ddad9,micro,6,,ModelFileName := 'pretrained_dl_classifier_compact.hdl',108,109,
c53ddad9,micro,7,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DLPreprocessParamFileName := DataDirectory + '/dl_preprocess_param.hdict'",110,114,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
c53ddad9,micro,8,,BestModelBaseName := ExampleDataDir + '/best_dl_model_classification',115,116,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
c53ddad9,micro,9,,FinalModelBaseName := ExampleDataDir + '/final_dl_model_classification',117,119,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
c53ddad9,micro,10,Lower batch sizes decrease the amount of memory consumed.,BatchSize := 32,125,127,
c53ddad9,micro,11,,InitialLearningRate := 0.001,128,129,
c53ddad9,micro,12,,Momentum := 0.9,130,132,
c53ddad9,micro,13,Number of epochs to train the model.,NumEpochs := 16,133,135,
c53ddad9,micro,14,,EvaluationIntervalEpochs := 1,136,137,
c53ddad9,micro,15,Set it to [] if the learning rate should not be changed.,"ChangeLearningRateEpochs := [4, 8, 12]",138,140,
c53ddad9,micro,16,The tuple has to be of the same length as ChangeLearningRateEpochs.,"ChangeLearningRateValues := InitialLearningRate * [0.1, 0.01, 0.001]",141,144,"* --- Automatically Added Context ---
InitialLearningRate := 0.001
* --- End of Automatically Added Context ---"
c53ddad9,micro,17,Set the weight prior.,WeightPrior := 0.0005,150,153,
c53ddad9,micro,18,Control whether training progress is displayed (true/false).,EnableDisplay := true,154,156,
c53ddad9,micro,19,,"RandomSeed := 42
set_system ('seed_rand', RandomSeed)",157,160,
c53ddad9,micro,20,"(system, driver, cuda-version) you could specify ""cudnn_deterministic"" as
""true"". Note, that this co...","* set_system ('cudnn_deterministic', 'true')",161,165,
c53ddad9,micro,21,Please see the documentation of create_dl_train_param for an overview on all available parameters.,"GenParamName := []
GenParamValue := []",166,170,
c53ddad9,micro,22,"If samples should be augmented during training, create the dict required by augment_dl_samples.
Here...",AugmentationParam := dict{},171,174,
c53ddad9,micro,23,,AugmentationParam.augmentation_percentage := 50,175,176,"* --- Automatically Added Context ---
AugmentationParam := dict{}
* --- End of Automatically Added Context ---"
c53ddad9,micro,24,,"AugmentationParam.mirror := 'rc'
GenParamName := [GenParamName,'augment']
GenParamValue := [GenParamValue,AugmentationParam]",177,181,"* --- Automatically Added Context ---
GenParamName := []
GenParamValue := []
AugmentationParam := dict{}
* --- End of Automatically Added Context ---"
c53ddad9,micro,25,"It is possible to change model parameters during training.
Here, we change the learning rate if spec...","if (|ChangeLearningRateEpochs| &gt; 0)
ChangeStrategy := dict{}
ChangeStrategy.model_param := 'learning_rate'
ChangeStrategy.initial_value := InitialLearningRate
ChangeStrategy.epochs := ChangeLearningRateEpochs
ChangeStrategy.values := ChangeLearningRateValues
GenParamName := [GenParamName,'change'...",182,199,"* --- Automatically Added Context ---
InitialLearningRate := 0.001
ChangeLearningRateEpochs := [4, 8, 12]
ChangeLearningRateValues := InitialLearningRate * [0.1, 0.01, 0.001]
GenParamName := []
GenPar..."
c53ddad9,micro,26,"There are several options for saving intermediate models to disk (see create_dl_train_param).
Here, ...","SerializationStrategy := dict{['type']: 'best', basename: BestModelBaseName}
GenParamName := [GenParamName,'serialize']
GenParamValue := [GenParamValue,SerializationStrategy]
SerializationStrategy := dict{['type']: 'final', basename: FinalModelBaseName}
GenParamName := [GenParamName,'serialize']
Gen...",200,209,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
BestModelBaseName := ExampleDataDir + '/best_dl_model_classification'
FinalModelBaseName := ExampleDataDir + '/fina..."
c53ddad9,micro,27,"In this example, 20% of the training split are selected to display the
evaluation measure for the re...",SelectedPercentageTrainSamples := 20,210,215,
c53ddad9,micro,28,,"XAxisLabel := 'epochs'
DisplayParam := dict{}
DisplayParam.selected_percentage_train_samples := SelectedPercentageTrainSamples
DisplayParam.x_axis_label := XAxisLabel
GenParamName := [GenParamName,'display']
GenParamValue := [GenParamValue,DisplayParam]",216,223,"* --- Automatically Added Context ---
GenParamName := []
GenParamValue := []
SelectedPercentageTrainSamples := 20
* --- End of Automatically Added Context ---"
c53ddad9,micro,29,,"check_data_availability (ExampleDataDir, DLDatasetFileName, DLPreprocessParamFileName)",228,230,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DLPreprocessParamFileName := DataDirectory + '/dl_preproce..."
c53ddad9,micro,30,,"read_dl_model (ModelFileName, DLModelHandle)",231,233,"* --- Automatically Added Context ---
ModelFileName := 'pretrained_dl_classifier_compact.hdl'
* --- End of Automatically Added Context ---"
c53ddad9,micro,31,,"read_dict (DLDatasetFileName, [], [], DLDataset)",234,236,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300..."
c53ddad9,micro,32,,"set_dl_model_param (DLModelHandle, 'learning_rate', InitialLearningRate)
set_dl_model_param (DLModelHandle, 'momentum', Momentum)",241,243,"* --- Automatically Added Context ---
InitialLearningRate := 0.001
Momentum := 0.9
read_dl_model (ModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
c53ddad9,micro,33,,"ClassNames := DLDataset.class_names
set_dl_model_param (DLModelHandle, 'class_names', ClassNames)",244,246,"* --- Automatically Added Context ---
read_dl_model (ModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
c53ddad9,micro,34,,"read_dict (DLPreprocessParamFileName, [], [], DLPreprocessParam)
set_dl_model_param (DLModelHandle, 'image_dimensions', [DLPreprocessParam.image_width,DLPreprocessParam.image_height,DLPreprocessParam.image_num_channels])",247,249,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DLPreprocessParamFileName := DataDirectory + '/dl_preprocess_param.hdict'
DataDirectory := ExampleDataDir + '/dldat..."
c53ddad9,micro,35,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'device', DLDevice)
if (|WeightPrior| &gt; 0)
set_dl_model_param (DLModelHandle, 'weight_prior', WeightPrior)
endif",250,255,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
BatchSize := 32
WeightPrior := 0.0005
read_dl_..."
c53ddad9,micro,36,"we choose the default values, since the classes are evenly distributed in the dataset.","tuple_gen_const (|ClassNames|, 1.0, ClassWeights)
set_dl_model_param (DLModelHandle, 'class_weights', ClassWeights)",256,260,"* --- Automatically Added Context ---
read_dl_model (ModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
ClassNames := DLDataset.class_names
* --- End of Automatically Added..."
c53ddad9,micro,37,,"create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIntervalEpochs, EnableDisplay, RandomSeed, GenParamName, GenParamValue, TrainParam)",265,267,"* --- Automatically Added Context ---
NumEpochs := 16
EvaluationIntervalEpochs := 1
EnableDisplay := true
RandomSeed := 42
GenParamName := []
GenParamValue := []
read_dl_model (ModelFileName, DLModelH..."
c53ddad9,micro,38,train_dl_model_batch () within the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",268,271,"* --- Automatically Added Context ---
read_dl_model (ModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIntervalE..."
c53ddad9,micro,39,,"dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",272,275,
c53ddad9,micro,40,,dev_close_window (),276,278,
c53ddad9,micro,41,,"if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",279,298,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,42,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",301,313,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,43,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",314,325,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,44,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",326,361,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
c53ddad9,micro,45,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",364,370,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,46,,"dev_close_window ()
WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
set...",371,383,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
c53ddad9,micro,47,,"WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (WindowHandleImages, 16, 'mono', 'true', 'false')
set_dict_tuple (ExampleInternals, 'window_images', Wind...",384,424,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
WindowHeightText := 330
WindowWidth..."
c53ddad9,micro,48,and shows some image examples.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",425,432,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,49,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)",433,436,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,50,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL classification. It uses the MVTec pill dataset.'
Text[|Text|] := ''
Text[|Text|] := 'The ...",437,470,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
get_dict_tuple ..."
c53ddad9,micro,51,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",471,477,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,52,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
dev_display_example_reset_windows (ExampleInternals)",478,481,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,53,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '--&gt; 1.) The \'loss\' is commonly used to optimize the model on the '
Text[|Text|] := '        ...",482,501,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
get_dict_tuple ..."
c53ddad9,micro,54,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_class_goals_loss')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_displa...",502,533,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
c53ddad9,micro,55,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",534,540,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,56,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'There are multiple model and training parameters.'
Text[|Text|] := ''
Text[|Text|] := 'To set the model parameters \'set_dl_model_param\' is used.'
Text[|Text|] := 'The training parameters a...",545,583,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,57,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",584,590,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,58,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := []
Text[|Text|] := 'Now, the training of the model will start.'
Text[|Tex...",591,633,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,59,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",634,640,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,60,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'batch_size\''
Text[|Text|] := ''
Text[|Text|] := 'The dataset is divided into smaller subsets of data which are called'
Text[|Text|] := 'batches. The \'batch_size\' determ...",645,678,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,61,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",679,685,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,62,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'learning_rate\''
Text[|Text|] := ''
Text[|Text|] := 'The \'learning_rate\' determines the size of the steps for optimizing'
Text[|Text|] := 'the loss function:'
Text[|Text...",690,708,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,63,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_learning_rate_curves')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_di...",709,739,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
read_image (ImageLoss, 'dl_explanat..."
c53ddad9,micro,64,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",740,746,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,65,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Training parameter: \'num_epochs\''
Text[|Text|] := ''
Text[|Text|] := 'During an epoch the entire training data is used once.'
Text[|Text|] := ''
Text[|Text|] := 'The number of epochs depen...",751,784,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,66,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",785,791,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,67,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Additionally, there are more advanced parameters that can be specified'
Text[|Text|] := 'to enhance the training process, for example parameters for:'
Text[|Text|] := ''
Text[|Text|] := '   ...",796,828,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '3. Evaluation of..."
c53ddad9,micro,68,Display an error if this is not the case.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",829,836,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,69,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",841,844,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
c53ddad9,micro,70,,"DataDirectory := 'classify_pill_defects_data/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DLPreprocessParamFileName := DataDirectory + '/dl_preprocess_param.hdict'",845,848,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict..."
c53ddad9,micro,71,,"file_exists (DLDatasetFileName, DLDDatasetExists)
file_exists (DLPreprocessParamFileName, DLPreprocessingParamExists)
DataExists := DLDDatasetExists and DLPreprocessingParamExists
Error := false
if (not DataExists)
Error := true
ErrorText := []
ErrorText[|ErrorText|] := 'To run this example you need...",849,883,"* --- Automatically Added Context ---
dev_display_screen_error (ExampleInternals, Error)
ExampleDataDir := 'classify_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
Text..."
c53ddad9,micro,72,"'classify_pill_defects_deep_learning_3_evaluate.hdev' and
'classify_pill_defects_deep_learning_4_inf...","get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",884,892,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,73,,"dev_open_text_window (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now, the second part \'Training of the model\' of the workflow'
Text[|Text|] := 'for DL classification is finished.'
Text[|Text|] := ''
Text[|Text|] :...",897,931,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for..."
c53ddad9,micro,74,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",932,938,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,75,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'After the parameters are set, the model can be trained'
Text[|Text|] := 'on the dataset with the procedure \'train_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'During the training the be...",943,971,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example cov..."
c53ddad9,micro,76,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '    1.) The \'loss\' is commonly used to optimize the model on the '
Text[|Text|] := '        tra...",983,1002,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
c53ddad9,micro,77,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_class_goals_top1_error')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_...",1003,1027,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_image (ImageLoss, 'dl_explanation/training_class_goals_loss')
get_dict_tuple (ExampleInternals, 'wind..."
c53ddad9,micro,78,,"WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
s...",1028,1058,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGC..."
c53ddad9,micro,79,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",1059,1084,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Auto..."
c53ddad9,micro,80,,"WindowWidthText := 800
WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
set_dict_tuple (Example...",1085,1112,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
WindowWidthText := 800
WindowHeightText..."
c53ddad9,micro,81,,"file_exists (ExampleDataDir, PathExists)
if (not PathExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of the example series.')
endif
file_exists (DLPreprocessParamFileName, FileExists)
if (not FileExists)
throw (DLPreprocessParamFileName + ' does not exist. Please run part 1 of th...",1113,1146,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict..."
c53ddad9,micro,82,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",1147,1186,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
tuple_find (WindowHandleKeys, 'window_images', Index)
catch (Exception)
* --- E..."
c53ddad9,micro,83,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",1189,1193,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
c53ddad9,micro,84,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",1194,1225,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
dc3414e4,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL classification. I...","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",23,1049,
dc3414e4,micro,1,"classify_pill_defects_deep_learning_1_preprocess.hdev.
If you set UsePretrainedModel := false, the o...",dev_update_off (),17,24,
dc3414e4,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,25,29,
dc3414e4,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,30,34,
dc3414e4,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",35,43,
dc3414e4,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
dev_display_screen_evaluation_measures (ExampleInternals)
stop ()
dev_display_screen_topK (ExampleInternals)
s...",44,85,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
dc3414e4,micro,6,,ExampleDataDir := 'classify_pill_defects_data',92,93,
dc3414e4,micro,7,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
if (UsePretrainedModel)
RetrainedModelFileName := 'classify_pill_defects.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model_classification.hdl'
endif",94,106,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
dc3414e4,micro,8,,"ClassificationMeasures := ['top1_error', 'precision', 'recall', 'f_score', 'absolute_confusion_matrix', 'relative_confusion_matrix']",109,110,
dc3414e4,micro,9,,BatchSize := 10,111,113,
dc3414e4,micro,10,,"check_data_availability (ExampleDataDir, DLDatasetFileName, RetrainedModelFileName, UsePretrainedModel)",118,120,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
RetrainedModelFileName := 'clas..."
dc3414e4,micro,11,,"read_dl_model (RetrainedModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",121,127,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
RetrainedModelFileName := 'classify_pill_defec..."
dc3414e4,micro,12,,"read_dict (DLDatasetFileName, [], [], DLDataset)",128,130,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300..."
dc3414e4,micro,13,,"GenParamEval := dict{measures: ClassificationMeasures, show_progress: 'true'}",131,133,"* --- Automatically Added Context ---
ClassificationMeasures := ['top1_error', 'precision', 'recall', 'f_score', 'absolute_confusion_matrix', 'relative_confusion_matrix']
* --- End of Automatically Ad..."
dc3414e4,micro,14,,"evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)",134,137,"* --- Automatically Added Context ---
ClassificationMeasures := ['top1_error', 'precision', 'recall', 'f_score', 'absolute_confusion_matrix', 'relative_confusion_matrix']
read_dl_model (RetrainedModel..."
dc3414e4,micro,15,,"WindowHandleDict := dict{}
GenParamEvalDisplay := dict{}
GenParamEvalDisplay.display_mode := ['measures', 'pie_charts_precision', 'pie_charts_recall', 'absolute_confusion_matrix']
dev_display_classification_evaluation (EvaluationResult, EvalParams, GenParamEvalDisplay, WindowHandleDict)
dev_disp_tex...",142,151,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
* --- End of Automatically Added Context ---"
dc3414e4,micro,16,,"dev_display_dl_interactive_confusion_matrix (DLDataset, EvaluationResult, [])",152,154,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
* --- E..."
dc3414e4,micro,17,,dev_close_window_dict (WindowHandleDict),155,158,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
dc3414e4,micro,18,"calculate and display a heatmap.
Here, we choose the samples
labeled and classified as 'contaminatio...","SelectedHeatmapGTClassName := 'contamination'
SelectedHeatmapInfClassName := 'contamination'",163,170,
dc3414e4,micro,19,,"EvaluatedSamples := EvaluationResult.evaluated_samples
ImageIDs := EvaluatedSamples.image_ids
ImageLabelIDs := EvaluatedSamples.image_label_ids
Predictions := EvaluatedSamples.top1_predictions
ClassNames := DLDataset.class_names
ClassIDs := DLDataset.class_ids",171,177,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
* --- E..."
dc3414e4,micro,20,,"PredictedClassID := ClassIDs[find(ClassNames,SelectedHeatmapInfClassName)]
GroundTruthClassID := ClassIDs[find(ClassNames,SelectedHeatmapGTClassName)]",178,180,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
SelectedHeatmapGTClassName := 'contamination'
SelectedHeatmapInfClassName := 'contamination'
ClassNames := DLData..."
dc3414e4,micro,21,,"GTIndices := find(ImageLabelIDs [==] GroundTruthClassID,1)
PredictionIndices := find(Predictions [==] PredictedClassID,1)",181,183,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
Selecte..."
dc3414e4,micro,22,,"ImageIDsSelected := []
if (PredictionIndices != -1 and PredictionIndices != [])
ImageIDsSelected := ImageIDs[intersection(GTIndices,PredictionIndices)]
endif",184,189,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
SelectedHeatmapGTClassName := 'contamination'
SelectedHe..."
dc3414e4,micro,23,"1) 'grad_cam'
2) 'guided_grad_cam'","HeatmapMethod := ['guided_grad_cam', 'grad_cam']
if (|HeatmapMethod| == 0)
throw ('No heatmap method selected - please select a method to continue.')
endif",190,198,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
* --- End of Automatically Added Context ---"
dc3414e4,micro,24,for the classified class.,"TargetClassID := []
HeatmapParam := dict{}",199,202,
dc3414e4,micro,25,,"HeatmapParam.use_conv_only := 'false'
HeatmapParam.scaling := 'scale_after_relu'",203,206,"* --- Automatically Added Context ---
HeatmapParam := dict{}
* --- End of Automatically Added Context ---"
dc3414e4,micro,26,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)",207,209,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
dc3414e4,micro,27,,"WindowHandleDict := dict{}
for Index := 0 to min([|ImageIDsSelected| - 1,10]) by 1
find_dl_samples (DLDataset.samples, 'image_id', ImageIDsSelected[Index], 'match', DLSampleIndex)
read_dl_samples (DLDataset, DLSampleIndex, DLSample)
DLResultCollected := dict{}
DisplayOptions := 'image'
for IndMet :=...",210,233,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
WindowHandleDict := dict{}
dev_disp_text ('Press F5 to cont..."
dc3414e4,micro,28,,"set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
write_dl_model (DLModelHandle, RetrainedModelFileName)",234,236,"* --- Automatically Added Context ---
RetrainedModelFileName := 'classify_pill_defects.hdl'
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
dc3414e4,micro,29,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",237,262,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added..."
dc3414e4,micro,30,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
Wi...",265,313,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added..."
dc3414e4,micro,31,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",314,320,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,32,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",321,328,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
dc3414e4,micro,33,,"Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] := ''
Text[|Text|] := 'The precision is the proportion of'
Text[|Text|] := 'all correctly predicted positives (TP) to'
Text[|Text|] := 'all predicted positives (TP and FP).'
Text[|Text|] := ''
Text[|Text|] := 'The recall, al...",329,360,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
dc3414e4,micro,34,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",361,372,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, W..."
dc3414e4,micro,35,,"Text := 'In this example we have seen:'
Text[|Text|] := ' - which evaluation measures can be computed for a classification model'
Text[|Text|] := ' - how the model is evaluated by means of measures and visual inspection'
Text[|Text|] := ''
Text[|Text|] := 'If the performance of the model satisfies t...",373,402,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
dc3414e4,micro,36,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",405,416,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,37,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",417,428,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to min([|ImageIDsSelected| - 1,10]) by 1
* --- End of Automatically Add..."
dc3414e4,micro,38,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",429,440,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to min([|ImageIDsSelected| - 1,10]) by 1
get_dict_param (ExampleInterna..."
dc3414e4,micro,39,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",441,451,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
dc3414e4,micro,40,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",452,484,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
dc3414e4,micro,41,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",485,491,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,42,,"Text := 'Evaluation measures: Confusion matrix'
Text[|Text|] := ''
Text[|Text|] := 'Knowing the ground truth class, we can compare the class affiliations:'
Text[|Text|] := 'the predicted one and the correct one.'
Text[|Text|] := ''
Text[|Text|] := 'A confusion matrix is a table with such comparisons...",500,531,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
dev_disp_text ..."
dc3414e4,micro,43,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",532,538,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,44,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",539,546,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
dc3414e4,micro,45,,"Text := 'The evaluation of a classification model is performed by '
Text[|Text|] := 'the procedure \'evaluate_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'In classification the whole image is assigned to a class.'
Text[|Text|] := ''
Text[|Text|] := 'In the following, the measures and possible vi...",547,572,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] :..."
dc3414e4,micro,46,,"WindowHeightText := 300
WindowWidthImage := 500
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",573,603,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHeightText := 300
WindowBGColor := 'gray'
get_dict_tuple (ExampleInternals, 'win..."
dc3414e4,micro,47,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",604,610,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,48,,"Text := 'Evaluation measures: top-k error'
Text[|Text|] := ''
Text[|Text|] := 'For a given image, the classifier infers class confidences of'
Text[|Text|] := 'how likely the image belongs to every distinguished class.'
Text[|Text|] := ''
Text[|Text|] := 'The top-k error tells the ratio of prediction...",619,650,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] :..."
dc3414e4,micro,49,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",651,677,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegen..."
dc3414e4,micro,50,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",678,702,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Au..."
dc3414e4,micro,51,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",703,709,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,52,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",710,716,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
dc3414e4,micro,53,,"Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL classification.'
Text[|Text|] := ''
Text[|Text|] := 'The four parts are: '
Text[|Text|] := '1. Dataset preprocessing.'
Text[|Text|] := '2. Training of the model.'
Text[|Text|] := '3. Evaluat...",717,746,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] :..."
dc3414e4,micro,54,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",747,753,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,55,,"get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
Text := 'We will now evaluate the pretrained model shipped with HALCON.'
else
Text := 'We will now evaluate the retrained model from example part 2'
Text[|Text|] := '\'classify_pill_defects_deep_lea...",762,802,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', ..."
dc3414e4,micro,56,evaluation example.,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of example series.')
endif
file_exists (DLDatasetFileName, FileExists)
if (not FileExists)
throw (DLDatasetFileName + ' does not exist. Please run part 1 of example series.')
endi...",803,842,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir..."
dc3414e4,micro,57,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",843,868,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
catch (Exceptio..."
dc3414e4,micro,58,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",869,930,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to min([|ImageIDsSelected| - 1,10]) by 1
Win..."
dc3414e4,micro,59,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",931,937,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,60,,"Text := 'Visual inspection:'
Text[|Text|] := ''
Text[|Text|] := 'Use the procedure \'dev_display_dl_interactive_confusion_matrix\''
Text[|Text|] := 'to show a confusion matrix and interactively display the images'
Text[|Text|] := 'by clicking on the matrix entries.'
Text[|Text|] := ''
Text[|Text|] :...",946,973,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] :..."
dc3414e4,micro,61,,"Text := 'Model optimization:'
Text[|Text|] := ''
Text[|Text|] := 'At the end of this example the models'
Text[|Text|] := 'memory consumption is optimized for inference'
Text[|Text|] := '(for inference see part 4 of the example series).'
Text[|Text|] := ''
Text[|Text|] := 'To do so, we will set'
Text...",986,1020,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Evaluation measures: Precision, Recall, and F1-score'
Text[|Text|] :..."
dc3414e4,micro,62,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",1023,1027,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
dc3414e4,micro,63,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",1028,1059,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
29a68e23,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL classification. I...","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",24,1153,
29a68e23,micro,1,"of part 1 and part 2 of this example series, set UsePretrainedModel
to false below.",dev_update_off (),20,25,
29a68e23,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,26,30,
29a68e23,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,31,35,
29a68e23,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",36,44,
29a68e23,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
dev_display_screen_example_images (ExampleInternals)
stop ()
dev_display_screen_inference_step_1 (ExampleInter...",45,80,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
29a68e23,micro,6,Directory name with the images of the pill dataset.,ImageDir := 'pill/',89,92,
29a68e23,micro,7,Example data folder containing the outputs of the previous example series.,"ExampleDataDir := 'classify_pill_defects_data'
if (UsePretrainedModel)
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'classify_pill_defects.hdl'
else
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
PreprocessParamFileName := DataDirec...",93,108,"* --- Automatically Added Context ---
UsePretrainedModel := true
* --- End of Automatically Added Context ---"
29a68e23,micro,8,,BatchSizeInference := 1,109,111,
29a68e23,micro,9,,"check_data_availability (ExampleDataDir, PreprocessParamFileName, RetrainedModelFileName, UsePretrainedModel)",116,118,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModel..."
29a68e23,micro,10,,"read_dl_model (RetrainedModelFileName, DLModelHandle)",119,121,"* --- Automatically Added Context ---
RetrainedModelFileName := 'classify_pill_defects.hdl'
* --- End of Automatically Added Context ---"
29a68e23,micro,11,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSizeInference)",122,124,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
29a68e23,micro,12,,"set_dl_model_param (DLModelHandle, 'device', DLDevice)",125,127,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model (RetrainedModelFileName, DLModel..."
29a68e23,micro,13,,"get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)",128,131,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
29a68e23,micro,14,,"read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)",132,134,"* --- Automatically Added Context ---
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
* --- End of Automatically Added Context ---"
29a68e23,micro,15,,WindowHandleDict := dict{},135,136,
29a68e23,micro,16,,"DLDataInfo := dict{class_names: ClassNames, class_ids: ClassIDs}",137,138,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)
* --- End of Automatically Added Context -..."
29a68e23,micro,17,,GenParam := dict{scale_windows: 1.1},139,141,
29a68e23,micro,18,"For this example, we select some images randomly.","get_example_inference_images (ImageDir, ImageFiles)",142,145,"* --- Automatically Added Context ---
ImageDir := 'pill/'
* --- End of Automatically Added Context ---"
29a68e23,micro,19,,"for BatchIndex := 0 to floor(|ImageFiles| / real(BatchSizeInference)) - 1 by 1
Batch := ImageFiles[BatchIndex * BatchSizeInference:(BatchIndex + 1) * BatchSizeInference - 1]
read_image (ImageBatch, Batch)
gen_dl_samples_from_images (ImageBatch, DLSampleBatch)
preprocess_dl_samples (DLSampleBatch, DL...",146,180,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DL..."
29a68e23,micro,20,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",181,203,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added..."
29a68e23,micro,21,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",206,217,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,22,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",218,229,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,23,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",230,241,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHand..."
29a68e23,micro,24,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 500, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",242,252,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
29a68e23,micro,25,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",253,286,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
29a68e23,micro,26,,"try
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_text')
catch (Exception)
endtry
return ()",287,314,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
catch (Exceptio..."
29a68e23,micro,27,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 and 2 of example series.')
endif
file_exists (PreprocessParamFileName, FileExists)
if (not FileExists)
throw (PreprocessParamFileName + ' does not exist. Please run part 1 of exam...",315,353,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
* --- End of A..."
29a68e23,micro,28,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",354,360,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,29,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",361,365,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,30,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'We will now apply the trained model from example part 2'
Text[|Text|] := '\'classify_pill_defects_deep_learning_2_train.hdev\''
Text[|Text|] := 'to some new images using \'apply_dl_model\'.'...",366,391,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [],..."
29a68e23,micro,31,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",392,398,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,32,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",399,403,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,33,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
dev_disp_text (Text, 'win...",404,415,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampl..."
29a68e23,micro,34,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_display_raw_image (WindowHandleImages)
return ()",416,437,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
29a68e23,micro,35,,"NumSamples := 10
list_image_files (ImageDir, 'default', 'recursive', ImageFilesAll)
tuple_shuffle (ImageFilesAll, ImageFilesAll)
ImageFiles := ImageFilesAll[0:NumSamples - 1]
return ()",438,460,"* --- Automatically Added Context ---
ImageDir := 'pill/'
get_example_inference_images (ImageDir, ImageFiles)
* --- End of Automatically Added Context ---"
29a68e23,micro,36,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",461,486,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImage..."
29a68e23,micro,37,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",487,493,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,38,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)",494,498,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,39,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|...",499,515,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampl..."
29a68e23,micro,40,,"dev_display_model_output_image (ExampleInternals)
return ()",516,533,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,41,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)",534,542,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,42,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",543,550,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automa..."
29a68e23,micro,43,,"Text := 'Congratulations!'
Text[|Text|] := 'You have finished the series of examples for DL classification.'
Text[|Text|] := ''
Text[|Text|] := 'You can now train a classification model on your own data.'
Text[|Text|] := ''
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
dev_di...",551,575,"* --- Automatically Added Context ---
Text := 'We will now apply the trained model from example part 2'
* --- End of Automatically Added Context ---"
29a68e23,micro,44,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_example_text_window (ExampleInternals)
dev_close_example_image_window (ExampleInternals)
dev_close_example_legend_window (ExampleInternals)
return ()",576,601,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,45,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",602,608,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
29a68e23,micro,46,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL classification. It uses the MVTec pill dataset.'
Text[|Text|] := ''
Text[|Text|] := 'The ...",614,650,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'We will now apply the trained model from example part 2'
dev_disp_text ('Pres..."
29a68e23,micro,47,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
dev_open_example_text_window (ExampleInternals)
s...",653,694,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added..."
29a68e23,micro,48,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|...",707,721,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampl..."
29a68e23,micro,49,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_display_preprocessed_image (ExampleInternals)
return ()",722,742,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
29a68e23,micro,50,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",743,767,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Au..."
29a68e23,micro,51,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",768,793,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
catch (Exceptio..."
29a68e23,micro,52,,ExampleDataDir := 'classify_pill_defects_data',801,803,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
29a68e23,micro,53,,"get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'classify_pill_defects.hdl'
else
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
Prepr...",804,820,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
PreprocessParamFileName := 'classify_pill_defects_preproces..."
29a68e23,micro,54,,"WindowImageNeeded := PreprocessParamExists and ModelExists
set_dict_tuple (ExampleInternals, 'window_images_needed', WindowImageNeeded)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",821,826,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
file_exists (PreprocessParamFileName, PreprocessParamExists)
file_exists (RetrainedMod..."
29a68e23,micro,55,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
if (not PreprocessParamExists or not ModelExists)
if (UsePretrainedModel)
Text := 'The pretrained model and corresponding preprocessing'
Text[|Text|] := 'parameters could not be found.'
Text[|Text|] ...",827,923,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
throw (ExampleDataDir + ' does not exist. Please run part 1..."
29a68e23,micro,56,,"WindowHeightText := 300
WindowWidthImage := 500
WindowHeightImages := 500
WindowBGColor := 'black'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Windo...",924,951,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
WindowHeightTex..."
29a68e23,micro,57,,"try
GinsengPath := 'pill/ginseng/' + ['good/pill_ginseng_good_001', 'contamination/pill_ginseng_contamination_004', 'crack/pill_ginseng_crack_001']
MagnesiumPath := 'pill/magnesium/' + ['good/pill_magnesium_good_001', 'contamination/pill_magnesium_contamination_001', 'crack/pill_magnesium_crack_001'...",952,997,"* --- Automatically Added Context ---
throw (ExampleDataDir + ' does not exist. Please run part 1 and 2 of example series.')
Text[|Text|] := 'The four parts are: '
catch (Exception)
Text[|Text|] := 'T..."
29a68e23,micro,58,,dev_set_window (WindowHandleImages),998,1000,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Context ---"
29a68e23,micro,59,,"read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
get_image_size (Image, Width, Height)
get_window_extents (WindowHandleImages, Row, Column, Width1, Height1)
if (Height &lt; Width)
ZoomFactor := Width1 / real(Width)
else
ZoomFactor := Height1 / real(Height)
endif
zo...",1001,1034,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
read_image (Image, [GinsengPath,MagnesiumPath,MintPath])
get_image_size (TiledImage, Width,..."
29a68e23,micro,60,,"read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')",1037,1039,"* --- Automatically Added Context ---
read_image (Image, [GinsengPath,MagnesiumPath,MintPath])
* --- End of Automatically Added Context ---"
29a68e23,micro,61,,"get_dict_tuple (ExampleInternals, 'preprocess_param_file_name', PreprocessParamFileName)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
preprocess_dl_model_images (Image, Image, DLPreprocessParam)
set_dict_object (Image, ExampleInternals, 'preprocessed_image')",1040,1046,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
PreprocessParamFileName..."
29a68e23,micro,62,,"set_dict_object (Image, ExampleInternals, 'example_image_preprocessed')",1047,1049,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_image (Image, [GinsengPath,MagnesiumPath,MintPath])
* --- End of Automatically Ad..."
29a68e23,micro,63,,"get_image_size (Image, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_display (Image)
dev_disp_text ('Preprocessed image', 'window', 'top', 'left', 'black', [], [])
return ()",1050,1070,"* --- Automatically Added Context ---
read_image (Image, [GinsengPath,MagnesiumPath,MintPath])
get_image_size (TiledImage, Width, Height)
* --- End of Automatically Added Context ---"
29a68e23,micro,64,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
get_window_extents (WindowHandleImages, Row, Column, Width, Height)
dev_set_window (WindowHandleImages)
dev_set_window_extents (-1, -1, Width, Height + 40.576...",1073,1082,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
get_dict_tuple ..."
29a68e23,micro,65,,"create_dict (DLResult)
set_dict_tuple (DLResult, 'classification_class_names', 'contamination')
set_dict_tuple (DLResult, 'classification_class_ids', 0)
set_dict_tuple (DLResult, 'classification_confidences', 0.98)",1083,1088,"* --- Automatically Added Context ---
DLResult := DLResultBatch[SampleIndex]
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
for SampleIndex := 0 to BatchSizeInference - 1 by 1
* --- ..."
29a68e23,micro,66,,"create_dict (DLSample)
get_dict_object (Image, ExampleInternals, 'example_image_preprocessed')
set_dict_object (Image, DLSample, 'image')",1089,1093,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampl..."
29a68e23,micro,67,,"create_dict (DLDatasetInfo)
set_dict_tuple (DLDatasetInfo, 'class_ids', [0, 1, 2])
set_dict_tuple (DLDatasetInfo, 'class_names', ['contamination', 'crack', 'good'])",1094,1098,
29a68e23,micro,68,,"create_dict (WindowHandleDict)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
set_dict_tuple (WindowHandleDict, 'classification_result', [WindowHandleImages,WindowHandleLegend])
dev_display_dl_data (DLSamp...",1099,1124,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
DLSample := DLSampleBatch[SampleIndex]
DLResult := DLResult..."
29a68e23,micro,69,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on any deep learning device.'
Text[|Text|] := ''
if (DLDevic...",1132,1163,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
f2009542,full,0,"Out-of-Distribution(OOD) Detection for
Deep Learning Classification
This example shows how a classif...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
endif
if (ShowExampleScreens)
dev_display_screen_visualize_dataset ...",27,721,
f2009542,micro,1,preprocessed dataset of part 1: dl_classification_workflow.hdev,"dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
endif",24,40,
f2009542,micro,2,"**            Load dataset and pretrained model              **
************************************...","if (ShowExampleScreens)
dev_display_screen_visualize_dataset (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",41,50,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,3,training.,"DatasetPath := 'classify_fruits_data/dl_dataset.hdict'
ModelPath := 'model_best.hdl'
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)",51,56,
f2009542,micro,4,,"WindowDict := dict{}
for Index := 0 to 5 by 1
SampleIndex := int(rand(1) * |DLDataset.samples|)
read_dl_samples (DLDataset, SampleIndex, DLSampleBatch)
dev_display_dl_data (DLSampleBatch, [], DLDataset, 'classification_ground_truth', [], WindowDict)
stop ()
endfor
dev_close_window_dict (WindowDict)",57,66,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
* --- End of Automatically Added Context ---"
f2009542,micro,5,"**        Fit model for out-of-distribution detection        **
************************************...","if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_fit_ood (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",67,77,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,6,OOD threshold.,"fit_dl_out_of_distribution (DLModelHandle, DLDataset, dict{})",78,81,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
* --- End of Automatically Added Context ---"
f2009542,micro,7,,"get_dl_model_param (DLModelHandle, 'ood_threshold', Threshold)",82,83,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
* --- End of Automatically Added Context ---"
f2009542,micro,8,"the sensitivity of the model to deviations from the training
data.","set_dl_model_param (DLModelHandle, 'ood_threshold', Threshold)",84,88,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
get_dl_model_param (DLModelHandle, 'ood_threshold', Threshold)
* --- End of Automatic..."
f2009542,micro,9,"**      Evaluation of the fitted model                       **
************************************...","if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_evaluation_intro (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",89,99,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,10,,"GenParamEval := dict{class_names_to_evaluate: 'global'}
GenParamEval.measures := ['top1_error', 'precision', 'recall', 'f_score', 'absolute_confusion_matrix']",100,102,
f2009542,micro,11,set as evaluation measures.,"OODMeasures := ['ood_confusion_matrix', 'ood_precision', 'ood_recall', 'ood_f_score', 'ood_false_positive_rate', 'ood_score_histogram', 'ood_thresholds']
GenParamEval.measures := [GenParamEval.measures,OODMeasures]",103,107,"* --- Automatically Added Context ---
GenParamEval := dict{class_names_to_evaluate: 'global'}
* --- End of Automatically Added Context ---"
f2009542,micro,12,the DLDataset. This data would then be used for the evaluation as well.,"ImageDirOOD := ['juice_bottle/good', 'food/vegetables']
add_dl_out_of_distribution_data (DLDataset, ImageDirOOD, dict{})",108,113,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
* --- End of Automatically Added Context ---"
f2009542,micro,13,and the added OOD data.,"evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)",114,117,"* --- Automatically Added Context ---
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
GenParamEval := dict{class_names_to_evaluate: 'global'}
* --- End of Automatically Ad..."
f2009542,micro,14,"test images (in-distribution) and optionally the
OOD data.","GenParamDisplay := dict{display_mode: 'ood_score_histogram'}
WindowDict := dict{}
dev_display_classification_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_window_dict (Wind...",118,127,"* --- Automatically Added Context ---
WindowDict := dict{}
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
* --- End of Automatically Added Co..."
f2009542,micro,15,OOD detection.,"GenParamDisplay := dict{display_mode: ['ood_confusion_matrix', 'ood_measures']}
WindowDict := dict{}
dev_display_classification_evaluation (EvaluationResult, EvalParams, GenParamDisplay, WindowDict)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_clos...",128,136,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
WindowDict := dict{}
GenParamDisplay := dict{display_mod..."
f2009542,micro,16,"OpenVino and rerun the evaluation. If there is no AI2 device
available the GPU is set as inference d...","if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_inference_optimization (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif
get_inference_device (Precision, DLInferenceDevice, AI2Interface)
if (AI2Interface != '')
set_dl_mod...",141,168,"* --- Automatically Added Context ---
ShowExampleScreens := true
prepare_dataset_and_model (DatasetPath, ModelPath, DLDataset, DLModelHandle)
dev_example_init (ShowExampleScreens, ExampleInternals)
Ge..."
f2009542,micro,17,is applied to sample images.,"if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_inference_visualization (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif
RawImageFolder := ['food/apple_braeburn', 'food/apple_topaz', 'food/apple_golden_delicious', 'food/...",173,302,"* --- Automatically Added Context ---
ShowExampleScreens := true
DatasetPath := 'classify_fruits_data/dl_dataset.hdict'
ModelPath := 'model_best.hdl'
prepare_dataset_and_model (DatasetPath, ModelPath,..."
f2009542,micro,18,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
dev_close_window ()
WindowWidthText := 900
WindowHeightText := 350
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_displ...",305,353,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,19,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",354,360,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,20,,dev_display_example_reset_windows (ExampleInternals),361,363,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,21,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example shows how a classification model can be extended to recognize'
Text[|Text|] := 'samples that deviate significantly from the training data, i.e.,'
Text[|Text|] := 'are out-of-dis...",364,400,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
throw ('The given dat..."
f2009542,micro,22,,"get_dict_tuple (ExampleInternals, 'clear_windows', ClearWindows)
ClearAllWindows := find(ClearWindows,'all')
if (|ClearAllWindows| and ClearAllWindows &gt; -1)
ClearAllWindows := true
else
ClearAllWindows := false
endif
try
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
ClearText...",401,434,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
* --- End of Au..."
f2009542,micro,23,"of the out-of-distribution detection and about the visualization
of dataset images.","get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",435,443,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,24,and the image visualization.,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'To fit a classification model for out-of-distribution detection'
Text[|Text|] := 'you need the following:'
Text[|Text|] := ''
Text[|Text|] := '1. A finetuned classification model.'
Text[|Tex...",447,477,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
throw ('The given dat..."
f2009542,micro,25,detection evaluation.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",478,485,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,26,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'To evaluate the out-of-distribution detection you need'
Text[|Text|] := 'data that does not belong to the classes the model was trained on.'
Text[|Text|] := ''
Text[|Text|] := 'You can add o...",489,519,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0..."
f2009542,micro,27,detection inference optimization.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",520,527,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,28,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'We will now optimize the fitted model for inference and run the evaluation again.'
Text[|Text|] := 'The model will be optimized for TensorRT - if available - and otherwise'
Text[|Text|] := '...",531,559,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
throw ('The given dat..."
f2009542,micro,29,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",560,612,"* --- Automatically Added Context ---
ShowExampleScreens := true
for Index := 0 to 5 by 1
get_inference_device (Precision, DLInferenceDevice, AI2Interface)
dev_example_init (ShowExampleScreens, Exampl..."
f2009542,micro,30,,"query_available_dl_devices (['ai_accelerator_interface', 'ai_accelerator_interface'], ['tensorrt', 'openvino'], DLAI2DeviceHandles)",613,614,
f2009542,micro,31,,"if (|DLAI2DeviceHandles| != 0)
DLDevice := DLAI2DeviceHandles[0]
get_dl_device_param (DLDevice, 'ai_accelerator_interface', AI2Interface)
if (AI2Interface == 'tensorrt')
Precision := 'float16'
endif
else
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDevi...",615,648,"* --- Automatically Added Context ---
get_inference_device (Precision, DLInferenceDevice, AI2Interface)
query_available_dl_devices (['ai_accelerator_interface', 'ai_accelerator_interface'], ['tensorrt..."
f2009542,micro,32,for out-of-distribution detection.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",649,656,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,33,out-of-distribution detection.,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Next, we will fit the model for out-of-distribution detection using'
Text[|Text|] := 'the training dataset.'
Text[|Text|] := 'Additionally, an out-of-distribution threshold is calculated. On...",660,691,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
throw ('The given dat..."
f2009542,micro,34,detection inference visualization.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",692,699,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
f2009542,micro,35,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Next, we will handle the inference of the classification model'
Text[|Text|] := 'combined with out-of-distribution detection.'
Text[|Text|] := ''
Text[|Text|] := 'This results in additional ...",703,729,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_example_init (ShowExampleScreens, ExampleInternals)
throw ('The given dat..."
f4248a5e,full,0,"Deep Learning classification workflow:
This example demonstrates the overall workflow for
classifica...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ImageBaseFolder := 'food/'
RawImageFolder := ImageBaseFolder + ['apple_braeburn', 'apple_golden_delicious', 'apple_topaz', 'peach', 'pear']
OutputDir := 'classify_fruits_data'
RemoveResults := false
read_dl_dataset_classification (Ra...",18,183,
f4248a5e,micro,1,"e.g., classify_pill_defects_deep_learning_1_preprocess.hdev etc.","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)",15,21,
f4248a5e,micro,2,,"ImageBaseFolder := 'food/'
RawImageFolder := ImageBaseFolder + ['apple_braeburn', 'apple_golden_delicious', 'apple_topaz', 'peach', 'pear']
OutputDir := 'classify_fruits_data'",24,27,
f4248a5e,micro,3,,RemoveResults := false,28,30,
f4248a5e,micro,4,"Alternatively, you can read in a DLDataset dictionary
as created by e.g., the MVTec Deep Learning To...","read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)",33,37,"* --- Automatically Added Context ---
RawImageFolder := ImageBaseFolder + ['apple_braeburn', 'apple_golden_delicious', 'apple_topaz', 'peach', 'pear']
ImageBaseFolder := 'food/'
* --- End of Automatic..."
f4248a5e,micro,5,,"read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)",38,39,
f4248a5e,micro,6,,"set_dl_model_param (DLModelHandle, 'class_names', DLDataset.class_names)",40,42,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
* --- End of Autom..."
f4248a5e,micro,7,,"split_dl_dataset (DLDataset, 70, 15, [])",43,44,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
* --- End of Automatically Added Context ---"
f4248a5e,micro,8,,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",45,50,"* --- Automatically Added Context ---
OutputDir := 'classify_fruits_data'
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
read_dl_model ('pretrained_dl_classifier_compact.hdl..."
f4248a5e,micro,9,,"WindowDict := dict{}
DatasetSamples := DLDataset.samples
for Index := 0 to 9 by 1
SampleIndex := round(rand(1) * (|DatasetSamples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'classification_ground_truth', [], WindowDict)
dev_disp_text ('Pre...",51,62,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
* --- End of Automatically Added Context ---"
f4248a5e,micro,10,"Training can be performed on a GPU or CPU.
See the respective system requirements in the Installatio...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",65,74,
f4248a5e,micro,11,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",75,84,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
f4248a5e,micro,12,Lower batch sizes decrease the amount of memory consumed.,"set_dl_model_param (DLModelHandle, 'batch_size', 32)
set_dl_model_param (DLModelHandle, 'learning_rate', 0.001)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",85,90,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevic..."
f4248a5e,micro,13,"For better model performance increase the number of epochs,
from 40 to e.g., 60.","create_dl_train_param (DLModelHandle, 40, 1, 'true', 42, [], [], TrainParam)",91,94,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
f4248a5e,micro,14,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",95,98,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
create_dl_train_pa..."
f4248a5e,micro,15,,"read_dl_model ('model_best.hdl', DLModelHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",99,106,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
*..."
f4248a5e,micro,16,,"GenParamEval := dict{class_names_to_evaluate: 'global'}
GenParamEval.measures := ['top1_error', 'precision', 'recall', 'f_score', 'absolute_confusion_matrix']",109,112,
f4248a5e,micro,17,,"set_dl_model_param (DLModelHandle, 'device', DLDevice)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
EvalDisplayMode := dict{display_mode: ['measures', 'pie_charts_precision', 'pie_charts_recall', 'absolute_confusion_matrix']}
WindowDict :=...",113,123,"* --- Automatically Added Context ---
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
WindowDict := dict..."
f4248a5e,micro,18,"meaning, reduce its memory consumption.","set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",124,127,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
f4248a5e,micro,19,,"write_dl_model (DLModelHandle, 'model_best.hdl')",128,130,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
f4248a5e,micro,20,chosen example images.,"list_image_files (RawImageFolder, 'default', 'recursive', ImageFiles)
WindowDict := dict{}
for IndexInference := 0 to 9 by 1
SampleIndex := round(rand(1) * (|DatasetSamples| - 1))
read_image (Image, ImageFiles[SampleIndex])
gen_dl_samples_from_images (Image, DLSample)
preprocess_dl_samples (DLSample...",133,148,"* --- Automatically Added Context ---
RawImageFolder := ImageBaseFolder + ['apple_braeburn', 'apple_golden_delicious', 'apple_topaz', 'peach', 'pear']
ImageBaseFolder := 'food/'
read_dl_dataset_classi..."
f4248a5e,micro,21,,"clean_up_output (OutputDir, RemoveResults)",149,164,"* --- Automatically Added Context ---
OutputDir := 'classify_fruits_data'
RemoveResults := false
* --- End of Automatically Added Context ---"
f4248a5e,micro,22,,"if (not RemoveResults)
return ()
endif",165,169,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
f4248a5e,micro,23,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",170,178,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
f4248a5e,micro,24,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",179,192,"* --- Automatically Added Context ---
OutputDir := 'classify_fruits_data'
* --- End of Automatically Added Context ---"
cf83321d,full,0,"This example shows how to optimize a trained classification model for
inference using the AI²-interf...","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
query_available_dl_devices ('runtime', 'cpu', DLDeviceHandlesCpu)
if ...",16,1021,
cf83321d,micro,1,"- The preprocessed images of part 1 classify_pill_defects_deep_learning_1_preprocess.hdev.
- (option...",dev_update_off (),11,17,
cf83321d,micro,2,"before it is executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,18,22,
cf83321d,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,23,27,
cf83321d,micro,4,"Nvidia TensorRT plugin for the AI²-interface.
A GPU device is used in this example as baseline devic...","query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",28,34,
cf83321d,micro,5,,"query_available_dl_devices ('runtime', 'cpu', DLDeviceHandlesCpu)
if (|DLDeviceHandlesCpu| == 0)
throw ('No supported device found to continue this example.')
endif
DeviceHandleCpu := DLDeviceHandlesCpu[0]",35,40,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
* --- End of Automatically Added Context ---"
cf83321d,micro,6,"a GPU, if available.",DLDeviceBaseLine := DLDeviceHandles[0],41,44,"* --- Automatically Added Context ---
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
* --- End of Automatically Added Context ---"
cf83321d,micro,7,,"query_available_dl_devices ('ai_accelerator_interface', 'tensorrt', DLDeviceHandles)
if (|DLDeviceHandles| &gt; 0)
DLDeviceTensorRT := DLDeviceHandles[0]
else
throw ('No supported device found to continue this example. Ensure that the TensorRT Plugin is installed!')
endif
if (ShowExampleScreens)
dev...",45,68,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
throw ('No supported device found to continue..."
cf83321d,micro,8,,ExampleDataDir := 'classify_pill_defects_data',75,76,
cf83321d,micro,9,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_300x300'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
if (UsePretrainedModel)
RetrainedModelFileName := 'classify_pill_defects.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model_classification.hdl'
endif",77,89,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
* --- End of Automatically Added Context ---"
cf83321d,micro,10,,ClassificationMeasures := 'top1_error',92,93,
cf83321d,micro,11,Use BatchSize = 1 as most realistic value for inference.,BatchSize := 1,94,97,
cf83321d,micro,12,,"check_data_availability (ExampleDataDir, DLDatasetFileName, RetrainedModelFileName, UsePretrainedModel)",102,104,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
RetrainedModelFileName := 'clas..."
cf83321d,micro,13,,"read_dl_model (RetrainedModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'device', DLDeviceBaseLine)",105,111,"* --- Automatically Added Context ---
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
DLDeviceBaseLine := DLDeviceHandles[0]
RetrainedModelFileName := 'classify_pill_defects.hdl'
BatchS..."
cf83321d,micro,14,,"read_dict (DLDatasetFileName, [], [], DLDataset)",112,114,"* --- Automatically Added Context ---
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_300x300..."
cf83321d,micro,15,,ResultCollector := dict{},115,117,
cf83321d,micro,16,,GenParamEval := dict{measures: ClassificationMeasures},118,120,"* --- Automatically Added Context ---
ClassificationMeasures := 'top1_error'
* --- End of Automatically Added Context ---"
cf83321d,micro,17,,"Precision := 'float32'
if (ShowExampleScreens)
dev_display_example_show_current_stage (ExampleInternals, 'float32')
stop ()
endif
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResultBaseLine, EvalParams)",121,130,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ClassificationMeasures := 'top1_error'
read_dl_model (Retra..."
cf83321d,micro,18,,"bench_dl_model (DLModelHandle, DLDataset, TimePerBatchBaseLine)",131,133,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
cf83321d,micro,19,,"collect_results (ResultCollector, DLModelHandle, TimePerBatchBaseLine, EvaluationResultBaseLine)
if (ShowExampleScreens)
dev_display_example_continue_message (ExampleInternals)
stop ()
endif",134,141,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dl_model (RetrainedModelFileName, DLModelHandle)
Resul..."
cf83321d,micro,20,"optimize_dl_model_for_inference does not support 'float16' precision. Use 'float32'
instead, which m...","get_dl_device_param (DLDeviceTensorRT, 'info', TensorRTDeviceInfo)
HasFastFp16 := TensorRTDeviceInfo.has_fast_fp16
if (HasFastFp16 == 'false')
DisplayPrecision := 'float32_fallback'
Precision := 'float32'
else
DisplayPrecision := 'float16'
Precision := 'float16'
endif
if (ShowExampleScreens)
dev_dis...",144,159,"* --- Automatically Added Context ---
ShowExampleScreens := true
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
DLDeviceTensorRT := DLDeviceHandles[0]
dev_example_init (ShowExampleScre..."
cf83321d,micro,21,"resources, by setting a CPU device.","set_dl_model_param (DLModelHandle, 'device', DeviceHandleCpu)",160,162,"* --- Automatically Added Context ---
DeviceHandleCpu := DLDeviceHandlesCpu[0]
query_available_dl_devices ('runtime', 'cpu', DLDeviceHandlesCpu)
read_dl_model (RetrainedModelFileName, DLModelHandle)
*..."
cf83321d,micro,22,"No additional conversion parameters are required, so use the default parameters.","get_dl_device_param (DLDeviceTensorRT, 'optimize_for_inference_params', OptimizeForInferenceParams)
optimize_dl_model_for_inference (DLModelHandle, DLDeviceTensorRT, Precision, [], OptimizeForInferenceParams, DLModelHandleTensorRT, ConversionReport)",163,167,"* --- Automatically Added Context ---
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
DLDeviceTensorRT := DLDeviceHandles[0]
read_dl_model (RetrainedModelFileName, DLModelHandle)
Precis..."
cf83321d,micro,23,,"evaluate_dl_model (DLDataset, DLModelHandleTensorRT, 'split', 'test', GenParamEval, EvaluationResultTensorRT, EvalParams)",168,170,"* --- Automatically Added Context ---
ClassificationMeasures := 'top1_error'
read_dict (DLDatasetFileName, [], [], DLDataset)
GenParamEval := dict{measures: ClassificationMeasures}
evaluate_dl_model (..."
cf83321d,micro,24,,"bench_dl_model (DLModelHandleTensorRT, DLDataset, TimePerBatchTensorRT)",171,173,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
optimize_dl_model_for_inference (DLModelHandle, DLDeviceTensorRT, Precision, [], OptimizeForInferenceParams, DLMo..."
cf83321d,micro,25,,"collect_results (ResultCollector, DLModelHandleTensorRT, TimePerBatchTensorRT, EvaluationResultTensorRT)
if (ShowExampleScreens)
dev_display_example_continue_message (ExampleInternals)
stop ()
endif",174,180,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ResultCollector := dict{}
optimize_dl_model_for_inference (..."
cf83321d,micro,26,(If the device supports 'int8'),"HasFastInt8 := TensorRTDeviceInfo.has_fast_int8
if (HasFastInt8 == 'true')
if (ShowExampleScreens)
dev_display_example_show_current_stage (ExampleInternals, 'int8')
stop ()
endif
DLModelHandleTensorRT := []
get_calibration_sample_indices (DLDataset, 10, 'train', CalibrationSampleIndices)
read_dl_sam...",181,214,"* --- Automatically Added Context ---
ShowExampleScreens := true
query_available_dl_devices ('runtime', 'gpu', DLDeviceHandles)
DLDeviceTensorRT := DLDeviceHandles[0]
dev_example_init (ShowExampleScre..."
cf83321d,micro,27,"**   Display the results   ***
******************************","if (not ShowExampleScreens)
dev_example_init (true, UsePretrainedModel, ExampleInternals)
endif
dev_display_example_show_results (ExampleInternals, ResultCollector)
stop ()",215,225,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ResultCollector := dict{}
* --- ..."
cf83321d,micro,28,,dev_close_example_windows (ExampleInternals),226,243,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,29,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
Wi...",246,294,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added..."
cf83321d,micro,30,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",297,308,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,31,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",309,320,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,32,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",321,332,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHand..."
cf83321d,micro,33,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",333,343,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
cf83321d,micro,34,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",344,376,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
cf83321d,micro,35,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",377,383,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,36,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",384,391,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
cf83321d,micro,37,,"Text := 'This example uses the model trained in the previous parts of this series to'
Text[|Text|] := 'show how to use \'optimize_dl_model_for_inference\' to use a model'
Text[|Text|] := 'with TensorRT devices.'
Text[|Text|] := 'The model is converted to \'float16\' and \'int8\' precision and shows'...",392,420,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example. Ensure that the TensorRT Plugin is installed!')
* --- End of Automatically Added Context ---"
cf83321d,micro,38,,"WindowHeightText := 300
WindowWidthImage := 500
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",421,451,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHeightText := 300
WindowBGColor := 'gray'
get_dict_tuple (ExampleInternals, 'win..."
cf83321d,micro,39,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",452,478,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegen..."
cf83321d,micro,40,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",479,503,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Au..."
cf83321d,micro,41,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",504,510,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,42,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",511,517,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
cf83321d,micro,43,,"Text := 'This example shows how to optimize a trained classification model with'
Text[|Text|] := 'the operator \'optimize_dl_model_for_inference\' for different'
Text[|Text|] := 'precision.'
Text[|Text|] := ''
Text[|Text|] := 'For this it uses the AI² plugin for TensorRT.'
dev_disp_text (Text, 'wind...",518,545,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example. Ensure that the TensorRT Plugin is installed!')
Text := 'This example uses the model trained in the pr..."
cf83321d,micro,44,evaluation example.,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of the Deep Learning Classification example series.')
endif
file_exists (DLDatasetFileName, FileExists)
if (not FileExists)
throw (DLDatasetFileName + ' does not exist. Please run...",546,585,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'classify_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir..."
cf83321d,micro,45,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",586,611,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
catch (Exceptio..."
cf83321d,micro,46,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",612,651,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
tuple_find (WindowHandleKeys, 'window_images', Index)
catch..."
cf83321d,micro,47,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",654,658,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,48,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
if (DLDevice != [])
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
get_dl_device_param (DLDevice, 'info', DLDeviceInfo)
get_dict_tuple (DLDe...",659,710,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
throw ('No supported device found to continue this example. Ensure that the TensorRT Plugin is insta..."
cf83321d,micro,49,DLModelHandle.,"get_dl_model_param (DLModelHandle, 'batch_size', BatchSize)",711,715,"* --- Automatically Added Context ---
BatchSize := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
cf83321d,micro,50,,"TotalTime := 5
read_dl_samples (DLDataset, [0:BatchSize - 1], DLSampleBatch)
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
Iterations := 0
count_seconds (Start)
repeat
apply_dl_model (DLModelHandle, DLSampleBatch, []...",716,749,"* --- Automatically Added Context ---
BatchSize := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
cf83321d,micro,51,the ResultCollector dictionary.,"try
get_dict_tuple (ResultCollector, 'name', ResultNames)
catch (Exception)
ResultNames := []
endtry
get_dl_model_param (DLModelHandle, 'device', Device)
get_dl_device_param (Device, 'name', DeviceName)
get_dl_device_param (Device, 'ai_accelerator_interface', InterfaceName)
if (InterfaceName != 'non...",750,807,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
ResultCollector := dict{}
Precision := 'float32'
catch (Exception)
Text[|Text|] := 'Device type:      ' + DL..."
cf83321d,micro,52,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",808,814,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,53,,"MaxNameLength := 40
MaxTimeLength := 15
MaxErrorLength := 11
get_dict_tuple (ResultCollector, 'name', Names)
get_dict_tuple (ResultCollector, 'precision', Precisions)
get_dict_tuple (ResultCollector, 'time_per_batch', TimesPerBatch)
get_dict_tuple (ResultCollector, 'top1_error', Top1Errors)
FullWidt...",822,941,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
ResultCollector := dict{}
Precision := 'float32'
get_calibration_sample_indices (DLDataset, 10, 'train', Calibrat..."
cf83321d,micro,54,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",942,948,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
cf83321d,micro,55,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
PrecisionString := Precision
if (PrecisionString == 'float32_fallback')
Precision...",949,1029,"* --- Automatically Added Context ---
ShowExampleScreens := true
throw ('No supported device found to continue this example. Ensure that the TensorRT Plugin is installed!')
dev_example_init (ShowExamp..."
73ba89aa,full,0,"Deep learning pruning workflow.
This example demonstrates how to prune
a trained deep learning class...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
get_dl_device_param (...",12,244,
73ba89aa,micro,1,a trained deep learning classification model.,"dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)",9,15,
73ba89aa,micro,2,,"query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
set_syst...",16,27,
73ba89aa,micro,3,,ModelFileName := 'classify_pill_defects.hdl',30,31,
73ba89aa,micro,4,,RawImageFolder := 'pill/',32,33,
73ba89aa,micro,5,,ExampleDataDir := 'pruning_pill_data',34,35,
73ba89aa,micro,6,,RemoveExampleDataDir := 'false',36,37,
73ba89aa,micro,7,,ShowProgress := 'true',38,40,
73ba89aa,micro,8,,"read_dl_model (ModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', 4)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",43,47,"* --- Automatically Added Context ---
DLDevice := DLDeviceHandles[0]
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
ModelFileName := 'classify_pill_defects.hdl'
*..."
73ba89aa,micro,9,,"read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)",48,50,"* --- Automatically Added Context ---
RawImageFolder := 'pill/'
* --- End of Automatically Added Context ---"
73ba89aa,micro,10,,"split_dl_dataset (DLDataset, 70, 15, [])
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
PreprocessSettings := dict{overwrite_files: true, show_progress: ShowProgress}
preprocess_dl_dataset (DLDataset, ExampleDataDir, DLPreprocessParam, Pre...",51,56,"* --- Automatically Added Context ---
ExampleDataDir := 'pruning_pill_data'
ShowProgress := 'true'
read_dl_model (ModelFileName, DLModelHandle)
read_dl_dataset_classification (RawImageFolder, 'last_fo..."
73ba89aa,micro,11,,"GenParamEval := dict{show_progress: ShowProgress}
GenParamEval.measures := ['top1_error', 'precision', 'recall', 'f_score']
GenParamEvalDisplay := dict{display_mode: 'measures'}
EvalWindowHandleDict := dict{}",59,64,"* --- Automatically Added Context ---
ShowProgress := 'true'
* --- End of Automatically Added Context ---"
73ba89aa,micro,12,,"evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResultInput, EvalParams)
dev_display_classification_evaluation (EvaluationResultInput, EvalParams, GenParamEvalDisplay, EvalWindowHandleDict)
WindowHandleMeasures := EvalWindowHandleDict.window_measures
set_display...",65,74,"* --- Automatically Added Context ---
ShowProgress := 'true'
read_dl_model (ModelFileName, DLModelHandle)
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
GenParamEval := dict..."
73ba89aa,micro,13,"Note, the used pruning percentage serves for illustration purpose.
For your own application it is in...","PrunePercentage := 40
GenParamPrune := dict{show_progress: ShowProgress}",77,81,"* --- Automatically Added Context ---
ShowProgress := 'true'
* --- End of Automatically Added Context ---"
73ba89aa,micro,14,"Here, we set the augmentation percentage and method.","AugmentationParam := dict{augmentation_percentage: 50, mirror: 'rc'}
GenParamPrune.augmentation_param := AugmentationParam",82,86,"* --- Automatically Added Context ---
ShowProgress := 'true'
GenParamPrune := dict{show_progress: ShowProgress}
* --- End of Automatically Added Context ---"
73ba89aa,micro,15,"creating the information handle (create_dl_pruning ()),
determining the scores (add_dl_pruning_batch...","prune_dl_model (DLModelHandle, DLDataset, PrunePercentage, GenParamPrune, DLModelHandlePruned, DLPruningHandle)
set_dl_model_param (DLModelHandlePruned, 'device', DLDevice)",87,93,"* --- Automatically Added Context ---
DLDevice := DLDeviceHandles[0]
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
ShowProgress := 'true'
read_dl_model (ModelFil..."
73ba89aa,micro,16,,"evaluate_dl_model (DLDataset, DLModelHandlePruned, 'split', 'test', GenParamEval, EvaluationResultPruned, EvalParams)
dev_display_classification_evaluation (EvaluationResultPruned, EvalParams, GenParamEvalDisplay, EvalWindowHandleDict)
WindowHandleMeasures := EvalWindowHandleDict.window_measures
set...",94,103,"* --- Automatically Added Context ---
ShowProgress := 'true'
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
GenParamEval := dict{show_progress: ShowProgress}
GenParamEvalDis..."
73ba89aa,micro,17,usually suffices already to significantly improve the classification measures.,"set_dl_model_param (DLModelHandlePruned, 'learning_rate', 1e-5)
create_dl_train_param (DLModelHandlePruned, 1, 1, ShowProgress, 0, [], [], TrainParam)
train_dl_model (DLDataset, DLModelHandlePruned, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)
dev_close_window ()
dev_close_window ()",106,113,"* --- Automatically Added Context ---
ShowProgress := 'true'
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
prune_dl_model (DLModelHandle, DLDataset, PrunePercentage, GenPar..."
73ba89aa,micro,18,,"evaluate_dl_model (DLDataset, DLModelHandlePruned, 'split', 'test', GenParamEval, EvaluationResultRetrained, EvalParams)
dev_display_classification_evaluation (EvaluationResultRetrained, EvalParams, GenParamEvalDisplay, EvalWindowHandleDict)
WindowHandleMeasures := EvalWindowHandleDict.window_measur...",114,123,"* --- Automatically Added Context ---
ShowProgress := 'true'
read_dl_dataset_classification (RawImageFolder, 'last_folder', DLDataset)
GenParamEval := dict{show_progress: ShowProgress}
GenParamEvalDis..."
73ba89aa,micro,19,,"set_dl_model_param (DLModelHandlePruned, 'optimize_for_inference', 'true')",124,126,"* --- Automatically Added Context ---
prune_dl_model (DLModelHandle, DLDataset, PrunePercentage, GenParamPrune, DLModelHandlePruned, DLPruningHandle)
* --- End of Automatically Added Context ---"
73ba89aa,micro,20,,"clean_up_output (ExampleDataDir, RemoveExampleDataDir)",127,129,"* --- Automatically Added Context ---
ExampleDataDir := 'pruning_pill_data'
RemoveExampleDataDir := 'false'
* --- End of Automatically Added Context ---"
73ba89aa,micro,21,,"EvaluationResults := [EvaluationResultInput,EvaluationResultPruned,EvaluationResultRetrained]
dev_open_window (0, 0, 512, 256, 'black', WindowHandle)
display_results_overview (WindowHandle, PrunePercentage, GenParamEval, EvaluationResults)
disp_end_of_program_message (WindowHandle, 'black', 'true')",130,148,"* --- Automatically Added Context ---
ShowProgress := 'true'
GenParamEval := dict{show_progress: ShowProgress}
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationRes..."
73ba89aa,micro,22,,"if (not (RemoveResults == true or RemoveResults == 'true'))
return ()
endif",149,153,
73ba89aa,micro,23,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['You selected to delete all example output data.', '', 'To confirm this and delete the data, press F5.']
dev_disp_text (WarningCleanup, 'window', 'center', 'center'...",154,161,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 256, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
73ba89aa,micro,24,,"remove_dir_recursively (OutputDir)
return ()",162,182,
73ba89aa,micro,25,,"FloatFormat := '10.3f'
StringFormat := '10s'
StringFormatModel := '16s'",183,186,
73ba89aa,micro,26,,"get_dict_tuple (GenParamEval, 'measures', Measures)
Message := []
Message[|Message|] := 'Overview after pruning ' + PrunePercentage + '%'
Message[|Message|] := ''
Message[|Message|] := ''$StringFormatModel
Message[|Message|] := '-----------------'
for Measure := 0 to |Measures| - 1 by 1
Message[|Mes...",187,214,"* --- Automatically Added Context ---
ShowProgress := 'true'
GenParamEval := dict{show_progress: ShowProgress}
PrunePercentage := 40
StringFormat := '10s'
StringFormatModel := '16s'
* --- End of Autom..."
73ba89aa,micro,27,,"NumModels := |EvaluationResults|
LineIdx := 3
for ModelIdx := 0 to NumModels - 1 by 1
LineIdx := LineIdx + 1
get_dict_tuple (EvaluationResults[ModelIdx], 'global', GlobalDict)
for MeasureIdx := 0 to |Measures| - 1 by 1
MeasureKey := Measures[MeasureIdx]
if (MeasureKey != 'top1_error')
MeasureKey := ...",215,255,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResultInput, EvalParams)
evaluate_dl_model (DLDataset, DLModelHandlePruned, ..."
ad527d16,full,0,"This example demonstrates how to get feature maps of a specified model layer for an
inferred image.
...","dev_close_window ()
dev_update_off ()
ImageDir := 'pill/'
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'classify_pill_defects.hdl'
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
t...",24,277,
ad527d16,micro,1,"not be reversed. As a consequence, do not overwrite your unmodified network.","dev_close_window ()
dev_update_off ()",21,26,
ad527d16,micro,2,,ImageDir := 'pill/',27,29,
ad527d16,micro,3,Adapt these lines if another model should be used.,"PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'classify_pill_defects.hdl'",30,34,
ad527d16,micro,4,"See the respective system requirements in the Installation Guide.
If available, try to run the examp...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]",35,44,
ad527d16,micro,5,,"read_dl_model (RetrainedModelFileName, DLModelHandle)",45,47,"* --- Automatically Added Context ---
RetrainedModelFileName := 'classify_pill_defects.hdl'
* --- End of Automatically Added Context ---"
ad527d16,micro,6,"ID, NAME, TYPE, OUTPUT_SHAPE, CONNECTED_NODES.","get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)",50,53,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
ad527d16,micro,7,"In this example we create a tuple of selected layers, over which we will iterate later.","ChosenLayers := ['conv1', 'conv10']",54,57,
ad527d16,micro,8,Hint: This is done only for visualization purpose.,"get_layer_types_from_summary (ChosenLayers, NetworkSummary, LayerTypes)",58,61,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)
ChosenLayers := ['conv1', 'conv10']
* --- End of Automatically Added Context ---"
ad527d16,micro,9,"In the network ""summary"" you find the individual depths of every layer and
therewith selectable dept...","SelectedFeatureMapDepths := dict{[ChosenLayers[0]]: [10, 15, 64], [ChosenLayers[1]]: [1, 2, 3]}",62,68,"* --- Automatically Added Context ---
ChosenLayers := ['conv1', 'conv10']
* --- End of Automatically Added Context ---"
ad527d16,micro,10,,"ImageFiles := ImageDir + 'ginseng/' + ['good/pill_ginseng_good_001', 'contamination/pill_ginseng_contamination_004', 'crack/pill_ginseng_crack_001']",69,70,"* --- Automatically Added Context ---
ImageDir := 'pill/'
* --- End of Automatically Added Context ---"
ad527d16,micro,11,,"read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
WindowDict := dict{}
for LayerIndex := 0 to |ChosenLayers| - 1 by 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'device', DLDevice)
set_dl_m...",71,125,"* --- Automatically Added Context ---
ImageDir := 'pill/'
PreprocessParamFileName := 'classify_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'classify_pill_defects.hdl'
DLDevice := DL..."
ad527d16,micro,12,,"LayerTypes := []
for LayerIndex := 0 to |ChosenLayers| - 1 by 1
tuple_regexp_select (NetworkSummary, ChosenLayers[LayerIndex] + ';', SelectedLayerInfo)
RegExpression := ChosenLayers[LayerIndex] + ';[ ]+([a-zA-Z0-9-]+)'
tuple_regexp_match (SelectedLayerInfo, RegExpression, LayerType)
LayerTypes := [L...",126,161,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)
ChosenLayers := ['conv1', 'conv10']
get_layer_types_from_summary (ChosenLayers, NetworkSummary, Laye..."
ad527d16,micro,13,,"ClassNames := ['good', 'crack', 'contamination']",165,167,
ad527d16,micro,14,,"dev_open_window (0, 0, 500, 500, 'black', WindowHandle1)
set_dict_tuple (WindowDict, 'original_image', WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, Width, Height)
dev_display (Image)
Text := 'Original image'
Text[|Text|] := ' '
Text[|Text|] := 'Class: ' + ClassNames[ImageIndex]
dev...",168,177,"* --- Automatically Added Context ---
WindowDict := dict{}
for ImageIndex := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[ImageIndex])
ClassNames := ['good', 'crack', 'contamination']
* --..."
ad527d16,micro,15,,"get_dict_param (SelectedFeatureMapDepths, 'keys', [], SelectedChannels)
get_dict_tuple (SelectedFeatureMapDepths, SelectedChannels[LayerIndex], SelectedDepthsOfLayer)",178,181,"* --- Automatically Added Context ---
SelectedFeatureMapDepths := dict{[ChosenLayers[0]]: [10, 15, 64], [ChosenLayers[1]]: [1, 2, 3]}
for LayerIndex := 0 to |ChosenLayers| - 1 by 1
* --- End of Automa..."
ad527d16,micro,16,,"dev_open_window (0, Width + 5, Width, Height, 'black', WindowHandle2)
set_dict_tuple (WindowDict, 'feature_map_1', WindowHandle2)",182,184,"* --- Automatically Added Context ---
WindowDict := dict{}
get_window_extents (WindowHandle1, Row, Column, Width, Height)
* --- End of Automatically Added Context ---"
ad527d16,micro,17,,"get_dict_object (SelectedFeatureMapsObj, SelectedFeatureMaps, ChosenLayers[LayerIndex])",185,186,"* --- Automatically Added Context ---
ChosenLayers := ['conv1', 'conv10']
get_feature_maps (SampleFeatureMaps, SelectedFeatureMapDepths, LayerIndex, SelectedFeatureMaps)
for LayerIndex := 0 to |Chosen..."
ad527d16,micro,18,,"select_obj (SelectedFeatureMapsObj, FeatureMap1, 1)
dev_display (FeatureMap1)
Text := 'Feature Map '
Text[|Text|] := ' '
Text[|Text|] := 'Selected layer: \'' + ChosenLayers[LayerIndex] + '\' '
Text[|Text|] := 'Type of layer: \'' + LayerTypes[LayerIndex] + '\' '
Text[|Text|] := 'Selected depth: ' + S...",187,202,"* --- Automatically Added Context ---
ChosenLayers := ['conv1', 'conv10']
get_layer_types_from_summary (ChosenLayers, NetworkSummary, LayerTypes)
WindowDict := dict{}
for LayerIndex := 0 to |ChosenLay..."
ad527d16,micro,19,,"select_obj (SelectedFeatureMapsObj, FeatureMap2, 2)
dev_display (FeatureMap2)
Text := 'Feature Map '
Text[|Text|] := ' '
Text[|Text|] := 'Selected layer: \'' + ChosenLayers[LayerIndex] + '\' '
Text[|Text|] := 'Type of layer: \'' + LayerTypes[LayerIndex] + '\' '
Text[|Text|] := 'Selected depth: ' + S...",203,214,"* --- Automatically Added Context ---
ChosenLayers := ['conv1', 'conv10']
get_layer_types_from_summary (ChosenLayers, NetworkSummary, LayerTypes)
WindowDict := dict{}
for LayerIndex := 0 to |ChosenLay..."
ad527d16,micro,20,,"select_obj (SelectedFeatureMapsObj, FeatureMap3, 3)
dev_display (FeatureMap3)
Text := 'Feature Map '
Text[|Text|] := ' '
Text[|Text|] := 'Selected layer: \'' + ChosenLayers[LayerIndex] + '\' '
Text[|Text|] := 'Type of layer: \'' + LayerTypes[LayerIndex] + '\' '
Text[|Text|] := 'Selected depth: ' + S...",215,258,"* --- Automatically Added Context ---
ChosenLayers := ['conv1', 'conv10']
get_layer_types_from_summary (ChosenLayers, NetworkSummary, LayerTypes)
for ImageIndex := 0 to |ImageFiles| - 1 by 1
for Layer..."
ad527d16,micro,21,saves them in a dictionary.,"count_channels (SampleFeatureMaps, NumChannels)
get_dict_param (SelectedFeatureMapDepths, 'keys', [], SelectedChannels)
create_dict (SelectedFeatureMaps)
get_dict_tuple (SelectedFeatureMapDepths, SelectedChannels[LayerIndex], SelectedDepthsOfLayer)
gen_empty_obj (SingleFeatureMaps)
for Idx := 0 to |...",259,289,"* --- Automatically Added Context ---
SelectedFeatureMapDepths := dict{[ChosenLayers[0]]: [10, 15, 64], [ChosenLayers[1]]: [1, 2, 3]}
SampleFeatureMaps := DLResult.[ChosenLayers[LayerIndex]]
get_featu..."
2d02ddc8,full,0,"This example shall demonstrate how to import a model trained
with the Deep Learning Tool (DLT) into ...","dev_update_off ()
PreprocessParamFile := 'classify_pill_defects_preprocess_param.hdict'
TrainedModel := 'classify_pill_defects.hdl'
get_system ('example_dir', ExampleDir)
PathToPreprocessParamFile := ExampleDir + '/hdevelop/Deep-Learning/Classification/' + PreprocessParamFile
PathToTrainedModel := E...",13,133,
2d02ddc8,micro,1,"with the Deep Learning Tool (DLT) into HALCON.
It is shown how to prepare the script for an inferenc...",dev_update_off (),7,14,
2d02ddc8,micro,2,,"PreprocessParamFile := 'classify_pill_defects_preprocess_param.hdict'
TrainedModel := 'classify_pill_defects.hdl'
get_system ('example_dir', ExampleDir)
PathToPreprocessParamFile := ExampleDir + '/hdevelop/Deep-Learning/Classification/' + PreprocessParamFile
PathToTrainedModel := ExampleDir + '/hdev...",28,34,
2d02ddc8,micro,3,the DLT.,"read_dict (PathToPreprocessParamFile, [], [], DLPreprocessParam)
read_dl_model (PathToTrainedModel, DLModelHandle)",35,39,"* --- Automatically Added Context ---
PathToPreprocessParamFile := ExampleDir + '/hdevelop/Deep-Learning/Classification/' + PreprocessParamFile
PathToTrainedModel := ExampleDir + '/hdevelop/Deep-Learn..."
2d02ddc8,micro,4,,stop (),40,42,
2d02ddc8,micro,5,,ImagesForInference := 'pill/',43,46,
2d02ddc8,micro,6,"on different devices. See the respective system requirements
in the Installation Guide.
If possible ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",52,61,
2d02ddc8,micro,7,"device is a GPU, if available.",DLDevice := DLDeviceHandles[0],62,65,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
2d02ddc8,micro,8,,"BatchSizeInference := 1
set_dl_model_param (DLModelHandle, 'batch_size', BatchSizeInference)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",66,71,"* --- Automatically Added Context ---
read_dl_model (PathToTrainedModel, DLModelHandle)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles..."
2d02ddc8,micro,9,and set them into a dictionary.,"DLDataInfo := dict{}
get_dl_model_param (DLModelHandle, 'class_names', DLDataInfo.class_names)
get_dl_model_param (DLModelHandle, 'class_ids', DLDataInfo.class_ids)",74,79,"* --- Automatically Added Context ---
read_dl_model (PathToTrainedModel, DLModelHandle)
* --- End of Automatically Added Context ---"
2d02ddc8,micro,10,"(e.g., using list_image_files).
For this example, we select some images randomly.","NumSamples := 10
get_example_inference_images (ImagesForInference, NumSamples, ImageFiles)",80,85,"* --- Automatically Added Context ---
ImagesForInference := 'pill/'
* --- End of Automatically Added Context ---"
2d02ddc8,micro,11,chosen example images.,"WindowHandleDict := dict{}
for IndexInference := 0 to NumSamples - 1 by 1
Batch := ImageFiles[IndexInference * BatchSizeInference:(IndexInference + 1) * BatchSizeInference - 1]
read_image (Image, Batch)
gen_dl_samples_from_images (Image, DLSample)
preprocess_dl_samples (DLSample, DLPreprocessParam)
...",86,126,"* --- Automatically Added Context ---
read_dict (PathToPreprocessParamFile, [], [], DLPreprocessParam)
read_dl_model (PathToTrainedModel, DLModelHandle)
BatchSizeInference := 1
DLDataInfo := dict{}
Nu..."
2d02ddc8,micro,12,,"list_image_files (ImageDir, 'default', 'recursive', ImageFilesAll)
tuple_shuffle (ImageFilesAll, ImageFilesAll)
ImageFiles := ImageFilesAll[0:NumSamples - 1]
return ()",127,143,"* --- Automatically Added Context ---
NumSamples := 10
get_example_inference_images (ImagesForInference, NumSamples, ImageFiles)
* --- End of Automatically Added Context ---"
8b026720,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL object detection....","dev_update_off ()
ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_detection_data_part_1 (E...",21,1798,
8b026720,micro,1,adapting the data for this model (preprocessing).,dev_update_off (),18,22,
8b026720,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.","ShowExampleScreens := true
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_detection_data_part_1 (ExampleInternals)
s...",23,85,
8b026720,micro,3,,"Backbone := 'pretrained_dl_classifier_compact.hdl'
NumClasses := 10",90,93,
8b026720,micro,4,used to rescale the images during preprocessing.,"ImageWidth := 512
ImageHeight := 320
ImageNumChannels := 3",94,99,
8b026720,micro,5,"and delivers better inference and training speed. Compared to
'high', the model with 'medium' is mor...",Capacity := 'medium',100,105,
8b026720,micro,6,,"TrainingPercent := 70
ValidationPercent := 15",106,109,
8b026720,micro,7,This means that rerunning the script results in the same split of DLDataset.,SeedRand := 42,110,113,
8b026720,micro,8,,"ExampleDataDir := 'detect_pills_data'
get_system ('example_dir', HalconExampleDir)",118,121,
8b026720,micro,9,,"get_image_dir (ImageDirs)
HalconImageDir := ImageDirs[0]",122,124,
8b026720,micro,10,,PillBagJsonFile := HalconExampleDir + '/hdevelop/Deep-Learning/Detection/pill_bag.json',125,127,"* --- Automatically Added Context ---
get_system ('example_dir', HalconExampleDir)
* --- End of Automatically Added Context ---"
8b026720,micro,11,,DLModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl',128,129,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
8b026720,micro,12,,DataDirectory := ExampleDataDir + '/dldataset_pill_bag_' + ImageWidth + 'x' + ImageHeight,130,131,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
8b026720,micro,13,,PreprocessParamFileName := DataDirectory + '/dl_preprocess_param.hdict',132,134,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
ExampleDataDir := 'detect_pills_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_' + ImageWidth + 'x' + ImageHeig..."
8b026720,micro,14,,"set_system ('seed_rand', SeedRand)",139,141,"* --- Automatically Added Context ---
SeedRand := 42
* --- End of Automatically Added Context ---"
8b026720,micro,15,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
make_dir (ExampleDataDir)
endif",142,147,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
8b026720,micro,16,"Here, we read the data from a COCO file.
Alternatively, you can read a DLDataset dictionary
as creat...","read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)",148,153,"* --- Automatically Added Context ---
get_system ('example_dir', HalconExampleDir)
HalconImageDir := ImageDirs[0]
get_image_dir (ImageDirs)
PillBagJsonFile := HalconExampleDir + '/hdevelop/Deep-Learni..."
8b026720,micro,17,,"split_dl_dataset (DLDataset, TrainingPercent, ValidationPercent, [])",154,156,"* --- Automatically Added Context ---
TrainingPercent := 70
ValidationPercent := 15
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- E..."
8b026720,micro,18,"and anchor_aspect_ratios from the dataset in order to improve the
training result. Please note that ...","GenParam := dict{['split']: 'train'}
determine_dl_model_detection_param (DLDataset, ImageWidth, ImageHeight, GenParam, DLDetectionModelParam)",161,170,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Aut..."
8b026720,micro,19,,"MinLevel := DLDetectionModelParam.min_level
MaxLevel := DLDetectionModelParam.max_level
AnchorNumSubscales := DLDetectionModelParam.anchor_num_subscales
AnchorAspectRatios := DLDetectionModelParam.anchor_aspect_ratios",171,176,"* --- Automatically Added Context ---
determine_dl_model_detection_param (DLDataset, ImageWidth, ImageHeight, GenParam, DLDetectionModelParam)
* --- End of Automatically Added Context ---"
8b026720,micro,20,,"DLModelDetectionParam := dict{}
DLModelDetectionParam.image_width := ImageWidth
DLModelDetectionParam.image_height := ImageHeight
DLModelDetectionParam.image_num_channels := ImageNumChannels
DLModelDetectionParam.min_level := MinLevel
DLModelDetectionParam.max_level := MaxLevel
DLModelDetectionParam...",181,191,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
ImageNumChannels := 3
Capacity := 'medium'
determine_dl_model_detection_param (DLDataset, ImageWidth, ImageHeight, GenParam, ..."
8b026720,micro,21,,"ClassIDs := DLDataset.class_ids
DLModelDetectionParam.class_ids := ClassIDs",192,194,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
DLModelDetectionParam := dict{}
* --- End of Automati..."
8b026720,micro,22,,"ClassNames := DLDataset.class_names
DLModelDetectionParam.class_names := ClassNames",195,198,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
DLModelDetectionParam := dict{}
* --- End of Automati..."
8b026720,micro,23,,"create_dl_model_detection (Backbone, NumClasses, DLModelDetectionParam, DLModelHandle)",199,201,"* --- Automatically Added Context ---
Backbone := 'pretrained_dl_classifier_compact.hdl'
NumClasses := 10
DLModelDetectionParam := dict{}
* --- End of Automatically Added Context ---"
8b026720,micro,24,to train it later in part 2.,"write_dl_model (DLModelHandle, DLModelFileName)",202,206,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
DLModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl'
create_dl_model_detection (Backbone, NumClasses, DL..."
8b026720,micro,25,,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)",211,213,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, NumClasses, DLModelDetectionParam, DLModelHandle)
* --- End of Automatically Added Context ---"
8b026720,micro,26,,"GenParam := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, DataDirectory, DLPreprocessParam, GenParam, DLDatasetFilename)",214,217,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
ExampleDataDir := 'detect_pills_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_' + ImageWidth + 'x' + ImageHeig..."
8b026720,micro,27,,"write_dict (DLPreprocessParam, PreprocessParamFileName, [], [])",218,220,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
ExampleDataDir := 'detect_pills_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_' + ImageWidth + 'x' + ImageHeig..."
8b026720,micro,28,,"find_dl_samples (DLDataset.samples, 'split', 'train', 'match', SampleIndices)
tuple_shuffle (SampleIndices, ShuffledIndices)
read_dl_samples (DLDataset, ShuffledIndices[0:9], DLSampleBatchDisplay)",227,231,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Automatically Added Context ---"
8b026720,micro,29,,"WindowHandleDict := dict{}
GenParam := dict{scale_windows: 1.2}",232,235,"* --- Automatically Added Context ---
GenParam := dict{['split']: 'train'}
* --- End of Automatically Added Context ---"
8b026720,micro,30,,"for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
dev_display_dl_data (DLSampleBatchDisplay[Index], [], DLDataset, 'bbox_ground_truth', GenParam, WindowHandleDict)
WindowHandles := WindowHandleDict.bbox_ground_truth
dev_set_window (WindowHandles[0])
get_dict_object (Image, DLSampleBatchDisplay[Index...",236,253,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
GenParam := dict..."
8b026720,micro,31,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_disp_end_of_program (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",254,278,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
8b026720,micro,32,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText...",281,327,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,33,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",328,334,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,34,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",335,339,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,35,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize the'
Text[|Text|] := 'workflow for DL object detection. It uses the MVTec pill bag dataset.'
Text[|Text|] := ''
Text[|Text|] := ...",340,373,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_open_window..."
8b026720,micro,36,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",376,387,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,37,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",388,399,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
* --- End of Automatically Added Context ---"
8b026720,micro,38,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 290)
elseif (n...",400,411,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
get_dict_param (ExampleInternals, 'keys', [], WindowHand..."
8b026720,micro,39,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",412,422,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
8b026720,micro,40,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_window_extents (360, 800 + 5, 290, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
d...",423,457,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
catch (Exceptio..."
8b026720,micro,41,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",458,464,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,42,,"TrainRatio := 0.7
ValRatio := 0.15
TestRatio := 1.0 - TrainRatio - ValRatio",465,469,
8b026720,micro,43,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",470,474,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,44,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 1.2: Split the dataset'
Text[|Text|] := ''
Text[|Text|] := 'The procedure \'split_dl_dataset\' splits the dataset randomly into'
Text[|Text|] := 'three subsets, such that samples of the...",475,492,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
dev_disp_text (..."
8b026720,micro,45,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_images_width', Width)
get_dict_tuple (ExampleInternals, 'window_images_height', Height)
dev_set_part (0, 0, Height, Width)",493,499,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
8b026720,micro,46,,"PieChartCenterRow := Height / 2.0
PieChartCenterCol := Width / 2.0
PieChartRadius := min([Width,Height]) * 0.425
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
pi := 4.0 * atan(1.0)
Ratios := [TrainRatio,ValRatio,TestRatio]
Text := ['Train', 'Validation', 'Test']
alpha := 0
dev_display_pie_chart...",500,555,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This example is part of a series of examples, which summarize ..."
8b026720,micro,47,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",556,562,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,48,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",563,567,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,49,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Generic model parameters for setting the image size'
Text[|Text|] := ''
Text[|Text|] := 'With regard to the training/inference speed and GPU memory requirements,'
Text[|Text|] := 'a ...",568,585,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,50,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')",586,590,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
8b026720,micro,51,,"read_image (Image, 'pill_bag/pill_bag_001.png')
get_image_size (Image, ImageWidth, ImageHeight)
ImageZoomWidth := 512
ZoomedImageToImage := ImageZoomWidth / (1.0 * ImageWidth)
ImageZoomHeight := round(ImageHeight * ZoomedImageToImage)
zoom_image_size (Image, ImageZoomed, ImageZoomWidth, ImageZoomHei...",591,613,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
get_dict_object (Image, DLSampleBatchDisplay[Index], 'image')
get_dict_tuple (ExampleInternals, 'window_images_width', Width)..."
8b026720,micro,52,,"dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (TiledImage)",614,617,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images_width', Width)
get_dict_tuple (ExampleInternals, 'window_images_height', Height)
tile_images (ObjectsConcat, Tile..."
8b026720,micro,53,,"get_window_extents (WindowHandleImages, Row, Column, WindowWidth, WindowHeight)
Text := 'Original resolution'
get_string_extents (WindowHandleImages, Text, _, _, TextWidth, TextHeight)
TextCol := WindowWidth * 0.25 - TextWidth * 0.5
dev_disp_text (Text, 'window', WindowHeight - 2 * TextHeight, TextC...",618,628,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize the'
Text[|Text|] := 'This example covers part 1:'
get_dict_tuple (ExampleInternals, 'windo..."
8b026720,micro,54,,"dev_set_part (0, 0, Height, Width)
flush_buffer (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'true')
return ()",629,648,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images_width', Width)
get_dict_tuple (ExampleInternals, 'window_images_height', Height)
get_dict_tuple (ExampleInternals..."
8b026720,micro,55,,"WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",649,679,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHeightText := 300
WindowBGColor := 'gray'
get_dict_tuple (ExampleInternals, 'window_images', WindowH..."
8b026720,micro,56,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",680,686,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,57,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)",687,691,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,58,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Generic model parameters \'min_level\', \'max_level\''
Text[|Text|] := ''
Text[|Text|] := 'A good choice of the levels is essential for finding objects'
Text[|Text|] := 'of different...",692,708,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,59,,"read_image (Image, 'pill_bag/pill_bag_001.png')
get_image_size (Image, ImageWidth, ImageHeight)
ImageZoomWidth := 512
ImageZoomHeight := 320
ImageToZoomRatio := real(ImageZoomHeight) / real(ImageHeight)
zoom_image_size (Image, Image, ImageZoomWidth, ImageZoomHeight, 'constant')
dev_set_part (0, 0, I...",713,721,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 320
get_dict_object (Image, DLSampleBatchDisplay[Index], 'image')
ImageZoomWidth := 512
ImageZoomHeight := round(ImageHeight * Zo..."
8b026720,micro,60,,"dev_set_draw ('margin')
dev_set_line_width (3)
get_distinct_colors (5, false, 0, 128, Colors)
tuple_gen_sequence (|Colors| - 1, 0, -1, Sequence)
Colors := Colors[Sequence]
set_window_param (WindowHandleImages, 'flush', 'false')
for Level := 2 to 6 by 1
gen_rectangle2 (ReferenceBoxLevel, ImageToZoomR...",722,733,"* --- Automatically Added Context ---
ImageHeight := 320
ImageWidth := 512
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
ImageZoomHeight := round(ImageHeight * ZoomedImageToImage)
ZoomedImageToIm..."
8b026720,micro,61,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
Text := 'Anchors (reference bounding boxes) for'
Text := [Text,'an image of size 512 x 320:']
Text := [Text,'- Level 2: 16 x 16', '- Level 3: 32 x 32', '- Level 4: 64 x 64', '- Level 5: 128 x 1...",734,758,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize the'
Text[|Text|] := 'This example ..."
8b026720,micro,62,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",759,765,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,63,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Generic model parameter \'anchor_num_subscales\''
Text[|Text|] := ''
Text[|Text|] := 'To achieve a finer spread of box sizes to be detected, use'
Text[|Text|] := '\'anchor_num_subsca...",771,782,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,64,,"dev_set_draw ('margin')
get_distinct_colors (5, false, 0, 128, Colors)
tuple_gen_sequence (|Colors| - 1, 0, -1, Sequence)
Colors := Colors[Sequence]
get_line_style (WindowHandleImages, LineStyle)
set_window_param (WindowHandleImages, 'flush', 'false')
for Level := 2 to 6 by 1
gen_rectangle2 (Referen...",796,817,"* --- Automatically Added Context ---
ImageHeight := 320
ImageWidth := 512
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
ImageZoomHeight := round(ImageHeight * ZoomedImageToImage)
ZoomedImageToIm..."
8b026720,micro,65,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
Text := 'Anchors (reference bounding boxes)'
Text := [Text,'with anchor_num_subscales = 3:']
Text := [Text,'- Level 2: 16 x 16 + subscales', '- Level 3: 32 x 32 + subscales', '- Level 4: 64 x 6...",818,842,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize the'
Text[|Text|] := 'This example ..."
8b026720,micro,66,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",843,849,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,67,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Generic model parameter \'anchor_aspect_ratios\''
Text[|Text|] := ''
Text[|Text|] := 'In general, a dataset contains objects with different shapes.'
Text[|Text|] := ''
Text[|Text|] :...",855,872,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,68,,"dev_set_draw ('margin')
get_distinct_colors (3, false, 0, 128, Colors)
tuple_gen_sequence (|Colors| - 1, 0, -1, Sequence)
Colors := Colors[Sequence]
set_window_param (WindowHandleImages, 'flush', 'false')
dev_set_line_width (3)
gen_rectangle2 (ReferenceBox1, ImageToZoomRatio * 206, ImageToZoomRatio ...",886,901,"* --- Automatically Added Context ---
ImageHeight := 320
ImageWidth := 512
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
ImageZoomHeight := round(ImageHeight * ZoomedImageToImage)
ZoomedImageToIm..."
8b026720,micro,69,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
Text := 'Anchors (reference bounding boxes) with'
Text := [Text,'different aspect ratios:']
Text := [Text,'- Aspect ratio 1.0', '- Aspect ratio 0.33', '- Aspect ratio 2.0']
dev_disp_text (Text,...",902,926,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize the'
Text[|Text|] := 'This example ..."
8b026720,micro,70,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",927,933,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,71,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 1.1: Read the dataset'
Text[|Text|] := ''
Text[|Text|] := 'Data used for DL object detection need to be labeled with'
Text[|Text|] := 'bounding boxes. '
Text[|Text|] := ''
Text[|Text|] ...",939,973,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDatase..."
8b026720,micro,72,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",974,980,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,73,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 1.1: Read the dataset'
Text[|Text|] := ''
Text[|Text|] := 'Data used for DL object detection need to be labeled with'
Text[|Text|] := 'bounding boxes. '
Text[|Text|] := ''
Text[|Text|] ...",986,1005,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDatase..."
8b026720,micro,74,,"create_dict (DLPreprocessParam)
set_dict_tuple (DLPreprocessParam, 'model_type', 'detection')
set_dict_tuple (DLPreprocessParam, 'image_height', 320)
set_dict_tuple (DLPreprocessParam, 'image_width', 512)
set_dict_tuple (DLPreprocessParam, 'image_num_channels', 3)
set_dict_tuple (DLPreprocessParam, ...",1006,1016,"* --- Automatically Added Context ---
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
* --- End of Automatically Added Context ---"
8b026720,micro,75,,create_tiny_example_dataset (DLDataset),1017,1019,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Automatically Added Context ---"
8b026720,micro,76,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
create_dict (WindowHandleDict)
get_dict_param (ExampleInternals, 'keys', [], GenParamValue)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleIm...",1020,1027,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict..."
8b026720,micro,77,change size of windows.,"get_dict_tuple (ExampleInternals, 'window_images_x', WindowImageColumn1)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImageRow1)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImageWidth)
get_dict_tuple (ExampleInternals, 'window_images_height', WindowImageHeight)
Windo...",1028,1035,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,78,,"get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
dev_set_window (WindowHandleLegend)
dev_set_window_extents (WindowImageRow1, WindowImageColumn1 + WindowImageWidth + 5, 290, WindowImageHeight)
dev_set_window (WindowHandleImages)
set_dict_tuple (WindowHandleDict, 'bbox_ground_truth...",1036,1048,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInt..."
8b026720,micro,79,,"get_dict_tuple (DLDataset, 'samples', DLSamples)
for Idx := 0 to |DLSamples| - 1 by 1
gen_dl_samples (DLDataset, Idx, 'detection', [], DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'bbox_ground_truth', [], WindowHandleDict)
dev_set_window (WindowHandleLegend)
dev_disp_text ('Please wait .....",1049,1080,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
WindowHandleDict := dict{}
dev_open_window (0, 0, Win..."
8b026720,micro,80,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1081,1087,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,81,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 3: Preprocess the dataset'
Text[|Text|] := ''
Text[|Text|] := 'After creation of the DL object detection model, its underlying'
Text[|Text|] := 'network architecture is fixed to the spe...",1093,1123,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,82,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1124,1130,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,83,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Creation of an object detection model'
Text[|Text|] := ''
Text[|Text|] := 'Create a DL object detection model using \'create_dl_model_detection\'.'
Text[|Text|] := ''
Text[|Text|] :=...",1136,1169,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Backbone := 'pretrained_dl_classifier_compact.hdl'
NumClasses := 10
dev_open_window (0, 0, WindowWidthText..."
8b026720,micro,84,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",1170,1194,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_window_extents (WindowHandleImages, Row, Column, WindowWidth, WindowHeight)
get_dict_tuple (ExampleInt..."
8b026720,micro,85,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1195,1201,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,86,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'The program will now start to create the model and to preprocess'
Text[|Text|] := 'the data.'
Text[|Text|] := ''
Text[|Text|] := 'Reading and splitting the dataset can take a few seconds.'
T...",1207,1246,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,87,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1247,1253,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,88,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now the first part \'Creation of the model and dataset preprocessing\''
Text[|Text|] := 'of the workflow for DL object detection is finished.'
Text[|Text|] := ''
Text[|Text|] := 'The model a...",1259,1295,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,89,and some example images.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1296,1303,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,90,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example covers the following three main steps:'
Text[|Text|] := ' - how labeled data is read and split for training'
Text[|Text|] := ' - how a DL Object Detection model is created and'
...",1309,1325,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,91,,"dev_display_pill_bags_example_dataset_preview (ExampleInternals)
return ()",1326,1343,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,92,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1344,1350,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,93,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 3: Preprocess the dataset'
Text[|Text|] := ''
Text[|Text|] := 'This can be done using \'preprocess_dl_dataset\'.'
Text[|Text|] := ''
Text[|Text|] := 'To get the necessary preprocessing ...",1356,1384,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
8b026720,micro,94,,ImageDir := 'pill_bag/',1387,1389,
8b026720,micro,95,,"create_dict (DLDataset)
set_dict_tuple (DLDataset, 'image_dir', ImageDir)
set_dict_tuple (DLDataset, 'class_ids', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
set_dict_tuple (DLDataset, 'class_names', ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamine', 'Cognivia', 'Capsularum I', 'Iron table...",1390,1394,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
for I := 0 to |WindowHandlesToClose| - 1 by 1
ImageDi..."
8b026720,micro,96,,"DLSamples := []
create_dict (DLSample)
set_dict_tuple (DLSample, 'image_id', 220)
set_dict_tuple (DLSample, 'image_file_name', 'pill_bag_220.png')
set_dict_tuple (DLSample, 'bbox_row1', [98, 105, 220, 307, 161, 435, 460, 514, 542])
set_dict_tuple (DLSample, 'bbox_col1', [422, 313, 338, 287, 424, 646...",1395,1463,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
get_dict_tuple (DLDataset, 'samples', DLSamples)
gen_..."
8b026720,micro,97,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",1464,1489,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Auto..."
8b026720,micro,98,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",1490,1522,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
catch (Exception)
* --- End of Auto..."
8b026720,micro,99,NumColors.,"if (NumColors &lt; 1)
throw ('NumColors should be at least 1')
endif
if (not is_int(NumColors))
throw ('NumColors should be of type int')
endif
if (|NumColors| != 1)
throw ('NumColors should have length 1')
endif",1526,1536,
8b026720,micro,100,,"if (Random != 0 and Random != 1)
tuple_is_string (Random, IsString)
if (IsString)
Random := Random == 'true' or 'false'
else
throw ('Random should be either true or false')
endif
endif",1537,1545,
8b026720,micro,101,,"if (|StartColor| != 1)
throw ('StartColor should have length 1')
endif
if (StartColor &lt; 0 or StartColor &gt; 255)
throw ('StartColor should be in the range [0, 255]')
endif
if (not is_int(StartColor))
throw ('StartColor should be of type int')
endif",1546,1555,
8b026720,micro,102,,"if (|EndColor| != 1)
throw ('EndColor should have length 1')
endif
if (EndColor &lt; 0 or EndColor &gt; 255)
throw ('EndColor should be in the range [0, 255]')
endif
if (not is_int(EndColor))
throw ('EndColor should be of type int')
endif",1556,1566,
8b026720,micro,103,,"if (StartColor &gt; EndColor)
EndColor := EndColor + 255
endif
if (NumColors != 1)
Hue := (StartColor + int((EndColor - StartColor) * real([0:NumColors - 1]) / real(NumColors - 1))) % 255
else
Hue := mean([StartColor,EndColor])
endif
if (Random)
Hue := Hue[sort_index(rand(NumColors))]
Lightness := i...",1567,1584,"* --- Automatically Added Context ---
if (NumColors &lt; 1)
if (Random != 0 and Random != 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
* --- End of Automatically Added Context ---"
8b026720,micro,104,,"gen_image_const (HLSImageH, 'byte', 1, NumColors)
gen_image_const (HLSImageL, 'byte', 1, NumColors)
gen_image_const (HLSImageS, 'byte', 1, NumColors)
get_region_points (HLSImageH, Rows, Columns)
set_grayval (HLSImageH, Rows, Columns, Hue)
set_grayval (HLSImageL, Rows, Columns, Lightness)
set_grayval...",1585,1593,"* --- Automatically Added Context ---
if (NumColors &lt; 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
Hue := (StartColor + int((EndColor - StartColor) * real([0:NumColors - 1]) / real(NumColors - 1)..."
8b026720,micro,105,,"trans_to_rgb (HLSImageH, HLSImageL, HLSImageS, ImageR, ImageG, ImageB, 'hls')",1594,1596,"* --- Automatically Added Context ---
gen_image_const (HLSImageH, 'byte', 1, NumColors)
gen_image_const (HLSImageL, 'byte', 1, NumColors)
gen_image_const (HLSImageS, 'byte', 1, NumColors)
* --- End of..."
8b026720,micro,106,,"get_grayval (ImageR, Rows, Columns, Red)
get_grayval (ImageG, Rows, Columns, Green)
get_grayval (ImageB, Rows, Columns, Blue)
Colors := '#' + Red$'02x' + Green$'02x' + Blue$'02x'
return ()",1597,1680,"* --- Automatically Added Context ---
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
get_region_points (HLSImageH, Rows, Columns)
trans_to_rgb (HLSImageH, HLSImageL, HLSImageS, ImageR, ImageG, Ima..."
8b026720,micro,107,,"try
PillBagPath1 := 'pill_bag/pill_bag_001'
PillBagPath2 := 'pill_bag/pill_bag_002'
read_image (Image, [PillBagPath1,PillBagPath2])
tile_images (Image, TiledImage, 2, 'horizontal')
get_image_size (TiledImage, Width, Height)
dev_open_example_image_window (ExampleInternals)
get_dict_tuple (ExampleInte...",1681,1727,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_object (Image, DLSampleBatchDisplay[Index], 'image')
Text[|Text|] := 'The four parts are: '
get_d..."
8b026720,micro,108,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",1728,1766,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
catch (Exception)
* --- End o..."
8b026720,micro,109,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1767,1773,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b026720,micro,110,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Step 2: Generate model parameters from dataset'
Text[|Text|] := ''
Text[|Text|] := 'Since the previously mentioned model parameters \'min_level\','
Text[|Text|] := '\'max_level\', \'anchor_n...",1779,1806,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL object detection....","dev_update_off ()
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDe...",22,1283,
42b63d29,micro,1,detect_pills_deep_learning_1_prepare.hdev.,dev_update_off (),19,23,
42b63d29,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,24,28,
42b63d29,micro,3,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",29,37,
42b63d29,micro,4,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",38,47,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
42b63d29,micro,5,,"if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_train (ExampleInternals)
stop ()
dev_display_screen_error (ExampleInternals, Error)
if (Error)
stop ()
endif
dev_display_screen_training_goals_1 (ExampleInternals)
stop ()
dev_display_scre...",48,105,"* --- Automatically Added Context ---
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
* --- End of Automa..."
42b63d29,micro,6,,ExampleDataDir := 'detect_pills_data',110,111,
42b63d29,micro,7,,InitialModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl',112,113,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
42b63d29,micro,8,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'",114,118,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
42b63d29,micro,9,,BestModelBaseName := ExampleDataDir + '/best_dl_model_detection',119,120,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
42b63d29,micro,10,,FinalModelBaseName := ExampleDataDir + '/final_dl_model_detection',121,123,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
42b63d29,micro,11,Batch size.,BatchSize := 2,129,131,
42b63d29,micro,12,,InitialLearningRate := 0.0005,132,133,
42b63d29,micro,13,,Momentum := 0.99,134,136,
42b63d29,micro,14,Number of epochs to train the model.,NumEpochs := 60,137,139,
42b63d29,micro,15,,EvaluationIntervalEpochs := 1,140,141,
42b63d29,micro,16,Set it to [] if the learning rate should not be changed.,ChangeLearningRateEpochs := 30,142,144,
42b63d29,micro,17,The tuple has to be of the same length as ChangeLearningRateEpochs.,ChangeLearningRateValues := InitialLearningRate * 0.1,145,148,"* --- Automatically Added Context ---
InitialLearningRate := 0.0005
* --- End of Automatically Added Context ---"
42b63d29,micro,18,Set the weight prior.,WeightPrior := 0.00001,154,157,
42b63d29,micro,19,Control whether training progress is displayed (true/false).,EnableDisplay := true,158,160,
42b63d29,micro,20,,"RandomSeed := 42
set_system ('seed_rand', RandomSeed)",161,164,
42b63d29,micro,21,"(system, driver, cuda-version) you could specify ""cudnn_deterministic"" as
""true"". Note, that this co...","* set_system ('cudnn_deterministic', 'true')",165,169,
42b63d29,micro,22,Please see the documentation of create_dl_train_param for an overview on all available parameters.,"GenParamName := []
GenParamValue := []",170,174,
42b63d29,micro,23,"If samples should be augmented during training, create the dict required by augment_dl_samples.
Here...",AugmentationParam := dict{},175,178,
42b63d29,micro,24,,AugmentationParam.augmentation_percentage := 50,179,180,"* --- Automatically Added Context ---
AugmentationParam := dict{}
* --- End of Automatically Added Context ---"
42b63d29,micro,25,,"AugmentationParam.mirror := 'rc'
GenParamName := [GenParamName,'augment']
GenParamValue := [GenParamValue,AugmentationParam]",181,185,"* --- Automatically Added Context ---
GenParamName := []
GenParamValue := []
AugmentationParam := dict{}
* --- End of Automatically Added Context ---"
42b63d29,micro,26,"It is possible to change model parameters during training.
Here, we change the learning rate if spec...","if (|ChangeLearningRateEpochs| &gt; 0)
ChangeStrategy := dict{}
ChangeStrategy.model_param := 'learning_rate'
ChangeStrategy.initial_value := InitialLearningRate
ChangeStrategy.epochs := ChangeLearningRateEpochs
ChangeStrategy.values := ChangeLearningRateValues
GenParamName := [GenParamName,'change'...",186,203,"* --- Automatically Added Context ---
InitialLearningRate := 0.0005
ChangeLearningRateEpochs := 30
ChangeLearningRateValues := InitialLearningRate * 0.1
GenParamName := []
GenParamValue := []
* --- En..."
42b63d29,micro,27,"There are several options for saving intermediate models to disk (see create_dl_train_param).
Here, ...","SerializationStrategy := dict{['type']: 'best', basename: BestModelBaseName}
GenParamName := [GenParamName,'serialize']
GenParamValue := [GenParamValue,SerializationStrategy]
SerializationStrategy := dict{['type']: 'final', basename: FinalModelBaseName}
GenParamName := [GenParamName,'serialize']
Gen...",204,213,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
BestModelBaseName := ExampleDataDir + '/best_dl_model_detection'
FinalModelBaseName := ExampleDataDir + '/final_dl_model_det..."
42b63d29,micro,28,"In this example, the evaluation measure for the training spit is not displayed during
training (defa...",SelectedPercentageTrainSamples := 0,214,220,
42b63d29,micro,29,,"XAxisLabel := 'epochs'
DisplayParam := dict{}
DisplayParam.selected_percentage_train_samples := SelectedPercentageTrainSamples
DisplayParam.x_axis_label := XAxisLabel
GenParamName := [GenParamName,'display']
GenParamValue := [GenParamValue,DisplayParam]",221,228,"* --- Automatically Added Context ---
GenParamName := []
GenParamValue := []
SelectedPercentageTrainSamples := 0
* --- End of Automatically Added Context ---"
42b63d29,micro,30,,"check_data_availability (ExampleDataDir, InitialModelFileName, DLDatasetFileName)",233,235,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
InitialModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl'
DLDatasetFileName := DataDirectory + '/dl_data..."
42b63d29,micro,31,,"read_dl_model (InitialModelFileName, DLModelHandle)",236,238,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
InitialModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl'
* --- End of Automatically Added Context ---"
42b63d29,micro,32,,"read_dict (DLDatasetFileName, [], [], DLDataset)",239,241,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
* -..."
42b63d29,micro,33,,"set_dl_model_param (DLModelHandle, 'learning_rate', InitialLearningRate)
set_dl_model_param (DLModelHandle, 'momentum', Momentum)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
if (|WeightPrior| &gt; 0)
set_dl_model_param (DLModelHandle, 'weight_prior', WeightPrior)
endif",246,252,"* --- Automatically Added Context ---
BatchSize := 2
InitialLearningRate := 0.0005
Momentum := 0.99
WeightPrior := 0.00001
read_dl_model (InitialModelFileName, DLModelHandle)
* --- End of Automaticall..."
42b63d29,micro,34,,"set_dl_model_param (DLModelHandle, 'device', DLDevice)",253,256,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model (InitialModelFileName, DLModelHa..."
42b63d29,micro,35,,"create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIntervalEpochs, EnableDisplay, RandomSeed, GenParamName, GenParamValue, TrainParam)",261,263,"* --- Automatically Added Context ---
NumEpochs := 60
EvaluationIntervalEpochs := 1
EnableDisplay := true
RandomSeed := 42
GenParamName := []
GenParamValue := []
read_dl_model (InitialModelFileName, D..."
42b63d29,micro,36,train_dl_model_batch () within the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0.0, TrainResults, TrainInfos, EvaluationInfos)",264,267,"* --- Automatically Added Context ---
read_dl_model (InitialModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIn..."
42b63d29,micro,37,,"dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",268,271,
42b63d29,micro,38,,"dev_close_window ()
dev_close_window ()",272,275,
42b63d29,micro,39,,"if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",276,298,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,40,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText...",301,338,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,41,,"WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",339,370,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHeightText := 300
WindowBGColor := 'gray'
* --- End of Automatically Added Context ---"
42b63d29,micro,42,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",371,395,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,43,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",396,402,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,44,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",403,407,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,45,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL object detection. It uses the MVTec pill bag dataset.'
Text[|Text|] := ''
Text[|Text|] :=...",408,441,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_open_window..."
42b63d29,micro,46,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",444,455,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,47,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",456,467,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,48,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 290)
elseif (n...",468,479,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_imag..."
42b63d29,micro,49,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 400)
set_part_style (WindowHandleImages, 1)
catch (Exception)
endtry",480,490,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,50,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_window_extents (360, 800 + 5, 290, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
d...",491,525,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
dev_open_window..."
42b63d29,micro,51,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)",526,534,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,52,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now, the second part \'Training of the model\' of the workflow'
Text[|Text|] := 'for DL object detection is finished.'
Text[|Text|] := ''
Text[|Text|] := 'The trained model can now be evalua...",540,575,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,53,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_example_text_window (ExampleInternals)
dev_close_example_image_window (ExampleInternals)
dev_close_example_legend_window (ExampleInternals)
return ()",576,601,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,54,,"try
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_text')
catch (Exception)
endtry
return ()",602,626,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,55,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",627,652,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,56,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",653,681,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowImagesY, WindowImagesX + WindowImagesWidth + 5, WindowWidth, WindowImagesHeight, 'b..."
42b63d29,micro,57,Display an error message if this is not the case.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",682,689,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,58,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",695,698,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
* --- End of Au..."
42b63d29,micro,59,which means that both the initial model and preprocessed dataset are available.,"ExampleDataDir := 'detect_pills_data'
InitialModelFileName := ExampleDataDir + '/pretrained_dl_model_detection.hdl'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
Error := false
file_exists (InitialModelFileName, ModelExists)
...",699,738,"* --- Automatically Added Context ---
dev_display_screen_error (ExampleInternals, Error)
ExampleDataDir := 'detect_pills_data'
InitialModelFileName := ExampleDataDir + '/pretrained_dl_model_detection...."
42b63d29,micro,60,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",739,745,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,61,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",746,750,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,62,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '--&gt; 1.) The \'loss\' is commonly used to optimize the model on the'
Text[|Text|] := '        t...",751,770,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
dev_disp_text (..."
42b63d29,micro,63,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_det_goals_loss')
dev_display (ImageLoss)
dev_disp_text ('Loss', 'image', 15, 140, 'black', 'box', 'false')
dev_disp_text ('Epochs', 'image', 470,...",771,802,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,64,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",803,809,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,65,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '    1.) The \'loss\' is commonly used to optimize the model on the'
Text[|Text|] := '        trai...",815,835,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,66,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_det_goals_map')
dev_display (ImageLoss)
dev_disp_text ('mean_ap', 'image', 15, 140, 'black', 'box', 'false')
dev_disp_text ('Epochs', 'image', 47...",836,867,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,67,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",868,874,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,68,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'There are multiple model and training parameters.'
Text[|Text|] := ''
Text[|Text|] := 'To set the model parameters \'set_dl_model_param\' is used,'
Text[|Text|] := 'while the training parame...",880,911,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,69,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",912,918,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,70,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'batch_size\''
Text[|Text|] := ''
Text[|Text|] := 'The dataset is divided into smaller subsets of data'
Text[|Text|] := 'which are called batches.'
Text[|Text|] := 'The \'b...",924,953,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,71,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",954,960,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,72,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'learning_rate\''
Text[|Text|] := ''
Text[|Text|] := 'The \'learning_rate\' determines the size of the steps for optimizing'
Text[|Text|] := 'the loss function:'
Text[|Text...",966,985,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,73,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_learning_rate_curves')
dev_display (ImageLoss)
dev_disp_text ('Loss', 'image', 35, 110, 'black', 'box', 'false')
dev_disp_text ('Epochs', 'image'...",986,1014,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, Window..."
42b63d29,micro,74,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1015,1021,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,75,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Training parameter: \'num_epochs\''
Text[|Text|] := ''
Text[|Text|] := 'During an epoch the entire training data is used once.'
Text[|Text|] := ''
Text[|Text|] := 'The number of epochs depen...",1027,1061,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,76,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1062,1068,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,77,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Additionally, there are more advanced parameters that can be specified'
Text[|Text|] := 'to enhance the training process, for example parameters for:'
Text[|Text|] := ''
Text[|Text|] := '   ...",1074,1103,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,78,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1104,1110,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,79,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'After the parameters are set, the model can be trained'
Text[|Text|] := 'on the dataset with the procedure \'train_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'During the training the be...",1116,1144,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,80,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1145,1151,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
42b63d29,micro,81,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dict_tuple (ExampleInternals, 'gpu_available', GPUAvailable)
Text := []
Text[|Text|] := 'Now, the training of the model will start.'
Text[|Text|] := ''
Text[|Text|] := 'During training, the progr...",1157,1194,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
Text := 'This e..."
42b63d29,micro,82,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of the example series.')
endif
file_exists (InitialModelFileName, FileExists)
if (not FileExists)
throw (InitialModelFileName + ' does not exist. Please run part 1 of the example ...",1195,1228,"* --- Automatically Added Context ---
dev_disp_text ('Please open the next example.', 'window', 'bottom', 'right', 'black', [], [])
ExampleDataDir := 'detect_pills_data'
InitialModelFileName := Exampl..."
42b63d29,micro,83,,"WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
set_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
set_di...",1229,1254,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowWidthText := 800
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHand..."
42b63d29,micro,84,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",1262,1293,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
996c1483,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL object detection....","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",27,2301,
996c1483,micro,1,detect_pills_deep_learning_2_train.hdev,dev_update_off (),24,28,
996c1483,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,29,33,
996c1483,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,34,38,
996c1483,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",39,47,
996c1483,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_introduction_evalu...",48,131,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
996c1483,micro,6,,ExampleDataDir := 'detect_pills_data',136,138,
996c1483,micro,7,,"if (UsePretrainedModel)
RetrainedModelFileName := 'detect_pills.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model_detection.hdl'
endif",139,147,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
996c1483,micro,8,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'",148,152,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
996c1483,micro,9,,EvaluationMeasures := 'all',157,159,
996c1483,micro,10,,IoUThresholds := [],160,162,
996c1483,micro,11,,DisplayIoUThreshold := 0.7,163,165,
996c1483,micro,12,,BatchSize := 1,166,168,
996c1483,micro,13,,"AreaNames := []
AreaMin := []
AreaMax := []",169,173,
996c1483,micro,14,,MaxNumDetections := [],174,176,
996c1483,micro,15,,"check_data_availability (ExampleDataDir, DLDatasetFileName, RetrainedModelFileName, UsePretrainedModel)",181,183,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'detect_pills_data'
RetrainedModelFileName := 'detect_pills.hdl'
DLDatasetFileName := DataDirectory + '/dl_dataset.hd..."
996c1483,micro,16,,"read_dl_model (RetrainedModelFileName, DLModelHandle)",184,186,"* --- Automatically Added Context ---
RetrainedModelFileName := 'detect_pills.hdl'
* --- End of Automatically Added Context ---"
996c1483,micro,17,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",187,191,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model (RetrainedModelFileName, DLModel..."
996c1483,micro,18,,"read_dict (DLDatasetFileName, [], [], DLDataset)",192,194,"* --- Automatically Added Context ---
ExampleDataDir := 'detect_pills_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
* -..."
996c1483,micro,19,"'max_overlap' (default = 0.5) and 'max_overlap_class_agnostic'
(default = 1.0) and a higher confiden...","set_dl_model_param (DLModelHandle, 'max_overlap_class_agnostic', 0.7)
set_dl_model_param (DLModelHandle, 'max_overlap', 0.2)
set_dl_model_param (DLModelHandle, 'min_confidence', 0.6)",199,205,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
996c1483,micro,20,,"WindowHandleDict := dict{}
GenParam := dict{bbox_display_confidence: false}",210,213,
996c1483,micro,21,,"find_dl_samples (DLDataset.samples, 'split', 'test', 'or', DLSampleIndices)
tuple_shuffle (DLSampleIndices, DLSampleIndicesShuffled)",214,217,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
996c1483,micro,22,,"for Index := 0 to 5 by 1
read_dl_samples (DLDataset, DLSampleIndicesShuffled[Index], DLSampleBatch)
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
dev_display_dl_data (DLSampleBatch, DLResultBatch, DLDataset, 'bbox_both', GenParam, WindowHandleDict)
dev_disp_text ('Press Run (F5)\n...",218,229,"* --- Automatically Added Context ---
BatchSize := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
WindowHandleDict := dict{}
GenParam := dict{..."
996c1483,micro,23,,GenParamEval := dict{},234,235,
996c1483,micro,24,,GenParamEval.measures := EvaluationMeasures,236,237,"* --- Automatically Added Context ---
EvaluationMeasures := 'all'
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,25,,"if (|MaxNumDetections|)
GenParamEval.max_num_detections := MaxNumDetections
endif",238,241,"* --- Automatically Added Context ---
MaxNumDetections := []
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,26,,"if (|AreaNames|)
if ((|AreaNames| != |AreaMin|) or (|AreaNames| != |AreaMax|))
throw ('AreaNames, AreaMin, and AreaMax must have the same size.')
endif
AreaRanges := dict{}
AreaRanges.name := AreaNames
AreaRanges.min := AreaMin
AreaRanges.max := AreaMax
GenParamEval.area_ranges := AreaRanges
endif",242,252,"* --- Automatically Added Context ---
AreaNames := []
AreaMin := []
AreaMax := []
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,27,,"if (|IoUThresholds|)
GenParamEval.iou_threshold := IoUThresholds
endif",253,256,"* --- Automatically Added Context ---
IoUThresholds := []
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,28,,GenParamEval.detailed_evaluation := true,257,258,"* --- Automatically Added Context ---
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,29,,GenParamEval.show_progress := true,259,261,"* --- Automatically Added Context ---
GenParamEval := dict{}
* --- End of Automatically Added Context ---"
996c1483,micro,30,,"evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResultDetection, EvalParams)",262,264,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
GenParamEval := dict{}
* --- End of Automatically Added Con..."
996c1483,micro,31,,DisplayParam := dict{},265,266,
996c1483,micro,32,,"if (|DisplayIoUThreshold| == 1)
EvalIoUThresholds := EvalParams.iou_threshold
if (find(EvalIoUThresholds,DisplayIoUThreshold) != -1)
DisplayParam.iou_threshold := DisplayIoUThreshold
else
throw ('No evaluation result for specified IoU threshold.')
endif
endif",267,275,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
DisplayIoUThreshold := 0.7
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEva..."
996c1483,micro,33,,"DisplayParam.display_mode := ['pie_charts_precision', 'pie_charts_recall']
WindowHandleDict := dict{}
dev_display_detection_detailed_evaluation (EvaluationResultDetection, EvalParams, DisplayParam, WindowHandleDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'top', 'right', 'black', [], ...",276,282,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', [], [])
evaluate_dl_model (DLDataset, DLModelHandle..."
996c1483,micro,34,,"DisplayParam.display_mode := 'absolute_confusion_matrix'
dev_display_detection_detailed_evaluation (EvaluationResultDetection, EvalParams, DisplayParam, WindowHandleDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_window_dict (WindowH...",283,289,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', [], [])
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParam..."
996c1483,micro,35,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
write_dl_model (DLModelHandle, RetrainedModelFileName)",290,293,"* --- Automatically Added Context ---
RetrainedModelFileName := 'detect_pills.hdl'
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
996c1483,micro,36,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_end_of_program (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",294,319,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added..."
996c1483,micro,37,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
dev_close_window ()
if (not ShowExampleScreens)
return ()
endif
dev_display_example_init_text_window (ExampleInte...",322,338,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added..."
996c1483,micro,38,,"create_tiny_example_dataset_with_result (DLDataset, DLResult)
set_dict_tuple (ExampleInternals, 'example_dl_dataset', DLDataset)
set_dict_tuple (ExampleInternals, 'example_dl_result', DLResult)",339,343,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Cont..."
996c1483,micro,39,,"read_dict ('detect_pills_deep_learning_3_evaluate_result.hdict', [], [], ExampleEvaluationResults)
set_dict_tuple (ExampleInternals, 'example_evaluation_results', ExampleEvaluationResults)
ModelType := 'detection'
get_dict_tuple (DLDataset, 'class_ids', ModelClassIDs)
create_evaluation_default_param...",344,380,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Cont..."
996c1483,micro,40,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",381,387,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,41,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",388,392,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,42,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL object detection. It uses the MVTec pill bag dataset.'
Text[|Text|] := ''
Text[|Text|] :=...",393,426,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,43,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",429,440,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,44,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",441,456,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to 5 by 1
* --- End of Automatically Added Context ---"
996c1483,micro,45,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",457,480,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to 5 by 1
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKey..."
996c1483,micro,46,,"try
get_dict_tuple (ExampleInternals, 'window_image', WindowHandleImages)
ClearImageWindow := find(ClearWindows,WindowHandleImages)
if (ClearAllWindows or (|ClearImageWindow| and ClearImageWindow &gt; -1))
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
catc...",481,492,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImage..."
996c1483,micro,47,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
ClearLegendWindow := find(ClearWindows,WindowHandleLegend)
if (ClearAllWindows or (|ClearLegendWindow| and ClearLegendWindow &gt; -1))
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
...",493,535,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
get_dict_tuple (Exa..."
996c1483,micro,48,,"WindowWidthText := 800
WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
s...",536,567,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
996c1483,micro,49,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",568,574,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,50,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Evaluation of an Object Detection Model'
Text[|Text|] := ''
Text[|Text|] := 'For the evaluation of an object detection model on a dataset, we use'
Text[|Text|] := 'the procedure \'evaluate_d...",580,616,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,51,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",617,641,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Au..."
996c1483,micro,52,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",642,648,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,53,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
Text := 'We will now evaluate the retrained model shipped with HALCON.'
else
Text := 'We will now...",654,695,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bo..."
996c1483,micro,54,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",696,734,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to 5 by 1
catch (Exception)
* --- End of Aut..."
996c1483,micro,55,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",735,741,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,56,,"get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
ExampleDataDir := 'detect_pills_data'",742,745,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ExampleDataDir := 'detect_pills_data'
* --- End of Automati..."
996c1483,micro,57,,"if (UsePretrainedModel)
TrainedModelFileName := 'detect_pills.hdl'
else
TrainedModelFileName := ExampleDataDir + '/best_dl_model_detection.hdl'
endif",746,754,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
996c1483,micro,58,,"DLDatasetFileName := ExampleDataDir + '/dldataset_pill_bag_512x320/dl_dataset.hdict'
file_exists (ExampleDataDir, ExampleDataDirExists)
file_exists (DLDatasetFileName, DatasetExists)
file_exists (TrainedModelFileName, ModelExists)
if (not ExampleDataDirExists or not DatasetExists or not ModelExists)...",755,802,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
Da..."
996c1483,micro,59,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Evaluation of the Trained Model'
Text[|Text|] := ''
Text[|Text|] := 'We will explain how to evaluate an object detection model and the most'
Text[|Text|] := 'important aspects thereof.'
Text...",808,834,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,60,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",835,841,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,61,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Evaluation Measures'
Text[|Text|] := ''
Text[|Text|] := '\'evaluate_dl_model\' evaluates the performance of a model with respect to'
Text[|Text|] := 'one or more measures. In the case of obj...",847,879,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,62,,"Text := 'Detailed Evaluation'
Text[|Text|] := ''
Text[|Text|] := 'If \'evaluate_dl_model\' is called with \'detailed_evaluation\' enabled,'
Text[|Text|] := 'the detections for each class are analyzed in detail in addition to the'
Text[|Text|] := 'specified measures.'
Text[|Text|] := ''
Text[|Text|] ...",882,894,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '3. Evaluation of the trained model.'
Text[|Text|] := 'This example cover..."
996c1483,micro,63,,"DetectionValue := 'all'
DetectionKey := 'bbox_detection_type'
TitleImage := 'Output of \'apply_dl_model\''",895,899,
996c1483,micro,64,,"dev_display_screen_explain_detection_scenarios_common (ExampleInternals, Text, TitleImage, DetectionKey, DetectionValue)
return ()",900,917,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
996c1483,micro,65,,"get_system ('example_dir', ExampleDir)",918,920,
996c1483,micro,66,,"create_dict (DLDataset)
set_dict_tuple (DLDataset, 'image_dir', 'pill_bag/')
set_dict_tuple (DLDataset, 'class_ids', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
set_dict_tuple (DLDataset, 'class_names', ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tab...",921,925,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
for I := 0 to |WindowHandlesToClose| - 1 by 1
* --- End of Automatically Added Context ---"
996c1483,micro,67,,"DLSamples := []
create_dict (DLSample)
set_dict_tuple (DLSample, 'image_id', 36)
set_dict_tuple (DLSample, 'image_file_name', 'pill_bag_036.png')
set_dict_tuple (DLSample, 'bbox_row1', [177, 242, 247, 240, 453, 127, 465, 372])
set_dict_tuple (DLSample, 'bbox_col1', [692, 362, 455, 894, 436, 915, 826...",926,939,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
996c1483,micro,68,,"create_dict (DLResult)
set_dict_tuple (DLResult, 'bbox_row1', [183, 245, 240, 241, 445, 120, 372, 619, 116, 461, 253, 139])
set_dict_tuple (DLResult, 'bbox_col1', [692, 368, 461, 892, 434, 919, 534, 765, 648, 448, 368, 977])
set_dict_tuple (DLResult, 'bbox_row2', [287, 380, 451, 305, 554, 241, 452, ...",940,948,"* --- Automatically Added Context ---
create_tiny_example_dataset_with_result (DLDataset, DLResult)
* --- End of Automatically Added Context ---"
996c1483,micro,69,,"set_dict_tuple (DLResult, 'bbox_detection_type', ['tp', 'tp', 'tp', 'fp_class', 'tp', 'tp', 'tp', 'fp_bg', 'fp_loc', 'fp_class', 'fp_dup', 'fp_mult'])
return ()",949,966,"* --- Automatically Added Context ---
create_tiny_example_dataset_with_result (DLDataset, DLResult)
* --- End of Automatically Added Context ---"
996c1483,micro,70,,"Text := 'True Positive Detection (TP)'
Text[|Text|] := ''
Text[|Text|] := 'A true positive is a detection where the IoU of the predicted rectangle'
Text[|Text|] := 'and the ground truth rectangle is larger than the required minimum IoU'
Text[|Text|] := 'and the predicted class is correct.'
Text[|Tex...",969,977,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,71,,"DetectionValue := 'tp'
DetectionKey := 'bbox_detection_type'
TitleImage := 'True Positives (TP)'",978,982,"* --- Automatically Added Context ---
DetectionValue := 'all'
DetectionKey := 'bbox_detection_type'
TitleImage := 'Output of \'apply_dl_model\''
* --- End of Automatically Added Context ---"
996c1483,micro,72,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
set_dict_tuple (ExampleInternals, 'clear_windows', WindowHandleText)
dev_display_screen_explain_detection_scenarios_common (ExampleInternals, Text, TitleImage, DetectionKey, DetectionValue)
return ()",983,1006,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
996c1483,micro,73,,"get_dict_param (Dict, 'key_data_type', Keys, KeyType)
if (KeyType != gen_tuple_const(|Keys|,'tuple'))
throw ('Only \'tuple\' type keys are supported.')
endif",1010,1015,"* --- Automatically Added Context ---
get_dict_param (ExampleInternals, 'keys', [], Keys)
* --- End of Automatically Added Context ---"
996c1483,micro,74,,"get_dict_tuple (Dict, Keys[0], ValuesKey)
NumValues := |ValuesKey|
SelectedIndices := []
for Index := 0 to |Keys| - 1 by 1
get_dict_tuple (Dict, Keys[Index], ValuesKey)
if (|ValuesKey| == NumValues)
SelectedIndices := [SelectedIndices,find(ValuesKey,Values[Index])]
else
throw ('All keys should conta...",1019,1070,"* --- Automatically Added Context ---
for Index := 0 to 5 by 1
get_dict_param (ExampleInternals, 'keys', [], Keys)
get_dict_param (Dict, 'key_data_type', Keys, KeyType)
throw ('Only \'tuple\' type key..."
996c1483,micro,75,,"Text := 'False Positive on Background (FP bg)'
Text[|Text|] := ''
Text[|Text|] := 'A false positive is considered to be on the background if the IoU of'
Text[|Text|] := 'the predicted rectangle with all ground truth rectangles is zero,'
Text[|Text|] := 'i.e., it has no overlap with any of the ground...",1073,1081,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,76,,"DetectionValue := 'fp_bg'
DetectionKey := 'bbox_detection_type'
TitleImage := 'False Positives on Background (FP bg)'",1082,1086,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,77,,"dev_display_screen_explain_detection_scenarios_common (ExampleInternals, Text, TitleImage, DetectionKey, DetectionValue)
return ()
get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1087,1112,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, whic..."
996c1483,micro,78,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)",1113,1117,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,79,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])",1118,1123,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,80,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)",1124,1126,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
996c1483,micro,81,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
create_dict (WindowHandleDict)
get_dict_param (ExampleInternals, 'keys', [], GenParamValue)",1127,1131,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_legend', WindowHa..."
996c1483,micro,82,change size of windows.,"get_dict_tuple (ExampleInternals, 'window_images_x', WindowImageColumn1)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImageRow1)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImageWidth)
get_dict_tuple (ExampleInternals, 'window_images_height', WindowImageHeight)
Windo...",1132,1140,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
996c1483,micro,83,,"get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
dev_set_window (WindowHandleLegend)
dev_set_window_extents (WindowImageRow1, WindowImageColumn1 + WindowImageWidth + 5, 290, WindowImageHeight)
dev_set_window (WindowHandleImages)
set_dict_tuple (WindowHandleDict, 'bbox_both', [Wind...",1141,1148,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleL..."
996c1483,micro,84,,"get_dict_tuple (ExampleInternals, 'example_dl_dataset', DLDataset)
get_dict_tuple (ExampleInternals, 'example_dl_result', DLResult)
gen_dl_samples (DLDataset, 0, 'detection', [], DLSample)
if (DetectionKey == 'bbox_detection_type' and DetectionValue == 'all')
DLResultSelected := DLResult
else
select...",1149,1187,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dict (DLDatasetFileName, [], [], DLDataset)
GenParam := dict{bbox_display_confide..."
996c1483,micro,85,,"Text := 'False Positives due to Misclassification (FP class)'
Text[|Text|] := ''
Text[|Text|] := 'A detection is considered as misclassified if the IoU of the'
Text[|Text|] := 'predicted rectangle is larger than the required minimum IoU of'
Text[|Text|] := 'a ground truth box but the predicted class...",1190,1198,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,86,,"DetectionValue := 'fp_class'
DetectionKey := 'bbox_detection_type'
TitleImage := 'False Positives due to Misclassification (FP class)'",1199,1203,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,87,,"Text := 'False Positive due to Wrong Location (FP loc)'
Text[|Text|] := ''
Text[|Text|] := 'A location of a prediction is considered to be wrong if the IoU is'
Text[|Text|] := 'non-zero and below the minimum IoU, and the predicted class matches'
Text[|Text|] := 'the ground truth.'
Text[|Text|] := ''...",1223,1231,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,88,,"DetectionValue := 'fp_loc'
DetectionKey := 'bbox_detection_type'
TitleImage := 'False Positive due to Wrong Location (FP loc)'",1232,1236,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,89,,"Text := 'False Positive due to Duplicate Detections (FP dup)'
Text[|Text|] := ''
Text[|Text|] := 'A false positive is considered to be a duplicate if the IoU is higher than'
Text[|Text|] := 'the minimum IoU but there exists another detection of the same class'
Text[|Text|] := 'which has a higher sco...",1256,1264,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,90,,"DetectionValue := ['fp_dup', 3]
DetectionKey := ['bbox_detection_type', 'bbox_class_id']
TitleImage := 'False Positive due to Duplicate Detections (FP dup)'",1265,1269,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,91,,"Text := 'False Positive due to Location and Class (FP mult)'
Text[|Text|] := ''
Text[|Text|] := 'A false positive can also occur due to multiple reasons. In this case'
Text[|Text|] := 'the IoU is smaller than the required minimum IoU, i.e., the location'
Text[|Text|] := 'is wrong, and at the same ti...",1289,1297,"* --- Automatically Added Context ---
throw ('No evaluation result for specified IoU threshold.')
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example..."
996c1483,micro,92,,"DetectionValue := 'fp_mult'
DetectionKey := 'bbox_detection_type'
TitleImage := 'False Positive due to Location and Class (FP mult)'",1298,1302,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,93,,"Text := 'False Negative'
Text[|Text|] := ''
Text[|Text|] := 'A false negative occurs, if there is no true positive detection for'
Text[|Text|] := 'a given ground truth object.'
Text[|Text|] := ''
Text[|Text|] := 'Below, we have false negatives for the classes with \'class_id\' = 5'
Text[|Text|] := '...",1322,1331,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example covers part 3: \'Evaluation of the trained model\'.'
Text[|..."
996c1483,micro,94,,"DetectionValue := 'all'
DetectionKey := 'bbox_detection_type'
TitleImage := 'False Negative (FN)'",1332,1336,"* --- Automatically Added Context ---
DetectionValue := 'all'
TitleImage := 'Output of \'apply_dl_model\''
DetectionKey := 'bbox_detection_type'
* --- End of Automatically Added Context ---"
996c1483,micro,95,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1354,1360,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,96,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Parameter \'max_num_detections\''
Text[|Text|] := ''
Text[|Text|] := 'This parameter allows to restrict the number of results considered during'
Text[|Text|] := 'evaluation. Starting from th...",1366,1393,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,97,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1394,1400,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,98,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Parameter \'area_ranges\''
Text[|Text|] := ''
Text[|Text|] := 'This parameter allows to evaluate specific area ranges separately.'
Text[|Text|] := 'It is useful if you have objects of very d...",1406,1435,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,99,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1436,1442,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,100,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text_height', TextWindowHeight)
get_dict_tuple (ExampleInternals, 'window_tex...",1443,1451,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
* --- End of Autom..."
996c1483,micro,101,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_set_window_extents (TextWindowHeight + 55, 0, TextWindowWidth, Height)
dev_clear_window ()
gen_image_const (Background, 'byte', TextWindowWidth, Height)
paint_region (Background, Background...",1452,1499,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
throw ('No evaluation result for specified IoU threshold.')
get_dict_tuple (ExampleInt..."
996c1483,micro,102,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
get_dict_tuple (ExampleInternals, 'window_text_height', TextWindowHeight)
Height := TextWindowHeight + 20
read_image (IoUImage, 'dl_explanation/evaluation_det_iou')
get_image_size (IoUImage, Io...",1500,1520,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
throw ('No evaluation result for specified IoU threshold.')
get_dict_tuple (ExampleInt..."
996c1483,micro,103,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dict_tuple (ExampleInternals, 'example_evaluation_params', ExampleEvaluationParams)
get_dict_tuple (ExampleEvaluationParams, 'iou_threshold', IoUThreshold)
IoUThresholdString := '[' + IoUThreshol...",1521,1564,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,104,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1565,1571,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,105,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Detailed Evaluation: Precision'
Text[|Text|] := ''
Text[|Text|] := 'If \'evaluate_dl_model\' was called with \'detailed_evaluation\''
Text[|Text|] := 'enabled, the procedure'
Text[|Text|] :=...",1577,1619,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,106,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1620,1626,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,107,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Detailed Evaluation: Recall'
Text[|Text|] := ''
Text[|Text|] := 'Depending on the values of the parameter \'display_mode\','
Text[|Text|] := 'more results can be displayed.'
Text[|Text|] := ...",1632,1672,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,108,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1673,1679,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,109,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Detailed Evaluation: Confusion Matrix'
Text[|Text|] := ''
Text[|Text|] := 'The confusion matrix summarizes the pie chart diagrams seen on the'
Text[|Text|] := 'two previous screens in one ma...",1685,1728,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,110,dev_display_example_reset_window,"WindowHandlesToClose := []
try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
endtry
get_dict_param (WindowHandleDict, 'keys', [], Keys)
for IndexKeys := 0 to |Keys| - 1 by 1
get_dict_tuple (WindowHandleDict, Keys[IndexKeys], WindowHandle)
Window...",1729,1759,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_handles_to_close'..."
996c1483,micro,111,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1760,1765,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,112,,dev_display_example_init_text_window (ExampleInternals),1766,1768,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,113,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now, the third part \'Evaluation of the trained model\' of the workflow'
Text[|Text|] := 'for DL object detection is finished.'
Text[|Text|] := ''
Text[|Text|] := 'The model has been evaluat...",1769,1825,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
996c1483,micro,114,evaluation example.,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of example series.')
endif
file_exists (DLDatasetFileName, FileExists)
if (not FileExists)
throw (DLDatasetFileName + ' does not exist. Please run part 1 of example series.')
endi...",1826,1865,"* --- Automatically Added Context ---
UsePretrainedModel := true
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
ExampleDataDir..."
996c1483,micro,115,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1866,1872,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
996c1483,micro,116,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)",1873,1878,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
996c1483,micro,117,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Evaluation Results'
Text[|Text|] := ''
Text[|Text|] := 'The result of an evaluation is returned in the dict EvaluationResult.'
Text[|Text|] := ''
Text[|Text|] := 'Below you see the main resu...",1879,1900,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', []..."
996c1483,micro,118,,"get_dict_tuple (ExampleEvaluationResults, 'max_num_detections_all', EvaluationResultsArea)
get_dict_tuple (EvaluationResultsArea, 'area_all', EvaluationResultsIoU)
get_dict_param (EvaluationResultsIoU, 'keys', [], EvaluationResultsIoUKeys)
IoUKeys := []
ClassKeys := []
for KeyIndex := 0 to |Evaluati...",1901,1915,"* --- Automatically Added Context ---
read_dict ('detect_pills_deep_learning_3_evaluate_result.hdict', [], [], ExampleEvaluationResults)
* --- End of Automatically Added Context ---"
996c1483,micro,119,,"create_matrix (|ClassKeys|, |IoUKeys| + 1, 0.0, MatrixID)
for ColIndex := 0 to |IoUKeys| - 1 by 1
get_dict_tuple (EvaluationResultsIoU, IoUKeys[ColIndex], IoUClassAP)
for RowIndex := 0 to |ClassKeys| - 1 by 1
get_dict_tuple (IoUClassAP, ClassKeys[RowIndex], ClassAP)
set_value_matrix (MatrixID, RowIn...",1916,1925,"* --- Automatically Added Context ---
get_dict_tuple (EvaluationResultsArea, 'area_all', EvaluationResultsIoU)
IoUKeys := []
ClassKeys := []
* --- End of Automatically Added Context ---"
996c1483,micro,120,,"IoUKeys := [IoUKeys,'mean_iou_ap']
get_dict_tuple (EvaluationResultsIoU, IoUKeys[|IoUKeys| - 1], MeanIoUAP)
for RowIndex := 0 to |ClassKeys| - 2 by 1
get_dict_tuple (MeanIoUAP, ClassKeys[RowIndex], ClassAP)
set_value_matrix (MatrixID, RowIndex, ColIndex, ClassAP)
endfor",1926,1933,"* --- Automatically Added Context ---
get_dict_tuple (EvaluationResultsArea, 'area_all', EvaluationResultsIoU)
IoUKeys := []
ClassKeys := []
create_matrix (|ClassKeys|, |IoUKeys| + 1, 0.0, MatrixID)
f..."
996c1483,micro,121,,"get_dict_tuple (EvaluationResultsIoU, 'mean_ap', MeanAP)
set_value_matrix (MatrixID, RowIndex, ColIndex, MeanAP)",1934,1937,"* --- Automatically Added Context ---
get_dict_tuple (EvaluationResultsArea, 'area_all', EvaluationResultsIoU)
create_matrix (|ClassKeys|, |IoUKeys| + 1, 0.0, MatrixID)
for ColIndex := 0 to |IoUKeys| ..."
996c1483,micro,122,,"create_dict (GenParam)
set_dict_tuple (GenParam, 'number_format', '1.2f')
get_dict_tuple (ExampleInternals, 'window_text_height', TextWindowHeight)
set_dict_tuple (GenParam, 'window_row', TextWindowHeight + 55)
set_dict_tuple (GenParam, 'title', 'Evaluation Results: Class and Mean AP')
set_dict_tupl...",1938,1971,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
GenParam := dict{bbox_display_confidence: false}
throw ('No evaluation result for spec..."
996c1483,micro,123,,"get_size_matrix (Matrix, NumRows, NumColumns)",1996,1997,
996c1483,micro,124,,"DisplayColumnWidth := 'equal'
DisplayColor := false
IdxsNoDisplay := []
AxisTitles := []
ValueColors := gen_tuple_const(NumRows * NumColumns,'white')
NumberFormat := '2.0f'
Title := []
AxisColor := 'light gray'
WindowRow := 0
WindowColumn := 0",1998,2008,"* --- Automatically Added Context ---
get_size_matrix (Matrix, NumRows, NumColumns)
* --- End of Automatically Added Context ---"
996c1483,micro,125,,"GenParamKeys := ['display_column_width', 'display_color', 'idxs_no_display', 'axis_titles', 'value_colors', 'number_format', 'title', 'row_col_names_color', 'window_row', 'window_column']
if (|GenParam| &gt; 0)
get_dict_param (GenParam, 'key_exists', GenParamKeys, KeyExists)
if (KeyExists[0])
get_di...",2009,2110,"* --- Automatically Added Context ---
GenParam := dict{bbox_display_confidence: false}
get_size_matrix (Matrix, NumRows, NumColumns)
DisplayColumnWidth := 'equal'
DisplayColor := false
IdxsNoDisplay :..."
996c1483,micro,126,,"ColStringWidths := []
AllNames := [ColumnNames,RowNames]
MaxStringWidth := 0
for StringIndex := 0 to |AllNames| - 1 by 1
String := AllNames[StringIndex]
get_string_extents (WindowHandle, String, Ascent, Descent, StringWidth, StringHeight)
if (StringIndex &lt; |ColumnNames|)
ColStringWidths := [ColSt...",2111,2122,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
get_string_extents (WindowHandleImages, IoUString, Ascent, Descent, IoUStringWidth, IoUStringHeight)
..."
996c1483,micro,127,,"get_string_extents (WindowHandle, 'test', Ascent, Descent, StringWidth, StringHeight)",2123,2124,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
get_string_extents (WindowHandleImages, IoUString, Ascent, Descent, IoUStringWidth, IoUStringHeight)
..."
996c1483,micro,128,,"MaxStringWidth := max2(MaxStringWidth,StringWidth)",2125,2127,"* --- Automatically Added Context ---
MaxStringWidth := 0
get_string_extents (WindowHandle, String, Ascent, Descent, StringWidth, StringHeight)
* --- End of Automatically Added Context ---"
996c1483,micro,129,,"RowStart := 80
RowDistance := StringHeight + 10
RowEnd := StringHeight * 7
ColumnStart := 50 + MaxStringWidth
ColumnOffset := 30
ColumnEnd := ColumnOffset",2128,2135,"* --- Automatically Added Context ---
MaxStringWidth := 0
get_string_extents (WindowHandle, String, Ascent, Descent, StringWidth, StringHeight)
* --- End of Automatically Added Context ---"
996c1483,micro,130,,"if (DisplayColumnWidth == 'minimal')
Width := sum(ColStringWidths) + ColumnOffset * NumColumns + ColumnStart + ColumnEnd
elseif (DisplayColumnWidth == 'equal')
Width := (MaxStringWidth + ColumnOffset) * NumColumns + ColumnStart + ColumnEnd
endif
Height := RowDistance * NumRows + RowStart + RowEnd
de...",2136,2149,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
get_size_matrix (Matrix, NumRows,..."
996c1483,micro,131,,"WidthLimit := [450,Width]
HeightLimit := [250,Height]
dev_resize_window_fit_size (WindowRow, WindowColumn, Width, Height, WidthLimit, HeightLimit)",2150,2155,"* --- Automatically Added Context ---
get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
WindowRow := 0
WindowColumn := 0
* --- End of Automatically Added Context ---"
996c1483,micro,132,,"TextRow := []
TextColumn := []
RowStartTmp := 0
ColumnDistance := [0,cumul(ColStringWidths[0:NumColumns - 2] + ColumnOffset)]
if (DisplayColumnWidth == 'equal')
ColumnDistance := [0:NumColumns - 1] * (MaxStringWidth + ColumnOffset)
endif
for Index := 0 to NumRows - 1 by 1
TextRow := [TextRow,gen_tup...",2156,2168,"* --- Automatically Added Context ---
for Index := 0 to 5 by 1
get_size_matrix (Matrix, NumRows, NumColumns)
DisplayColumnWidth := 'equal'
ColStringWidths := []
MaxStringWidth := 0
get_string_extents ..."
996c1483,micro,133,,"TextColumn := TextColumn + ColumnStart
TextRow := TextRow + RowStart",2169,2172,"* --- Automatically Added Context ---
MaxStringWidth := 0
RowStart := 80
ColumnStart := 50 + MaxStringWidth
TextRow := []
TextColumn := []
* --- End of Automatically Added Context ---"
996c1483,micro,134,,"if (|AxisTitles| &gt; 0)
if (|Title| &gt; 0)
get_string_extents (WindowHandle, Title, TitleAscent, TitleDescent, TitleWidth, TitleHeight)
AxisTitleRowX := 2 * ceil(TitleHeight)
else
AxisTitleRowX := 'top'
endif
dev_disp_text (AxisTitles[0], 'window', AxisTitleRowX, 'right', 'black', 'box', 'false')
...",2173,2184,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
AxisTitles := []
Title := []
* --- End of Automatically Added Context ---"
996c1483,micro,135,,"if (|Title| &gt; 0)
dev_disp_text (Title, 'window', 'top', 'left', 'black', 'box', 'false')
endif",2185,2189,"* --- Automatically Added Context ---
Title := []
* --- End of Automatically Added Context ---"
996c1483,micro,136,,"dev_disp_text (RowNames, 'window', TextRow[[0:NumColumns:NumColumns * (NumRows - 1)]], gen_tuple_const(NumRows,TextColumn[0] - MaxStringWidth - ColumnOffset), AxisColor, 'box', 'false')",2190,2192,"* --- Automatically Added Context ---
get_size_matrix (Matrix, NumRows, NumColumns)
AxisColor := 'light gray'
MaxStringWidth := 0
ColumnOffset := 30
TextRow := []
TextColumn := []
* --- End of Automat..."
996c1483,micro,137,,"dev_disp_text (ColumnNames, 'window', gen_tuple_const(NumColumns,TextRow[0] - RowDistance), TextColumn[0:NumColumns - 1], AxisColor, 'box', 'false')",2193,2196,"* --- Automatically Added Context ---
get_size_matrix (Matrix, NumRows, NumColumns)
AxisColor := 'light gray'
if (StringIndex &lt; |ColumnNames|)
get_string_extents (WindowHandle, String, Ascent, Desc..."
996c1483,micro,138,,"get_full_matrix (Matrix, MatrixText)
MatrixText := MatrixText$NumberFormat",2197,2201,"* --- Automatically Added Context ---
get_size_matrix (Matrix, NumRows, NumColumns)
NumberFormat := '2.0f'
* --- End of Automatically Added Context ---"
996c1483,micro,139,,"IdxsDisplay := difference([0:|MatrixText| - 1],IdxsNoDisplay)",2202,2204,"* --- Automatically Added Context ---
IdxsNoDisplay := []
get_full_matrix (Matrix, MatrixText)
* --- End of Automatically Added Context ---"
996c1483,micro,140,,"dev_disp_text (MatrixText[IdxsDisplay], 'window', TextRow[IdxsDisplay], TextColumn[IdxsDisplay], ValueColors[IdxsDisplay], 'box', 'false')
return ()",2205,2225,"* --- Automatically Added Context ---
get_size_matrix (Matrix, NumRows, NumColumns)
ValueColors := gen_tuple_const(NumRows * NumColumns,'white')
IdxsNoDisplay := []
TextRow := []
TextColumn := []
get_..."
996c1483,micro,141,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",2230,2237,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automa..."
996c1483,micro,142,,"Text := 'Model optimization:'
Text[|Text|] := ''
Text[|Text|] := 'At the end of this example the models'
Text[|Text|] := 'memory consumption is optimized for inference'
Text[|Text|] := '(for inference see part 4 of the example series).'
Text[|Text|] := ''
Text[|Text|] := 'To do so, we will set'
Text...",2238,2272,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5)\nto continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'This example is part of a series of examples, which summarize..."
996c1483,micro,143,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",2280,2311,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
5a9064be,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL object detection....","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",25,1972,
5a9064be,micro,1,"of part 1 and part 2 of this example series, set UsePretrainedModel
to false below.",dev_update_off (),21,26,
5a9064be,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,27,31,
5a9064be,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,32,36,
5a9064be,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",37,45,
5a9064be,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
dev_display_screen_example_images (ExampleInternals)
stop ()
dev_display_screen_inference_step_1 (ExampleInter...",46,95,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
5a9064be,micro,6,Directory name with the images of the pill bag dataset.,ImageDir := 'pill_bag/',104,107,
5a9064be,micro,7,Example data folder containing the outputs of the previous example series.,"ExampleDataDir := 'detect_pills_data'
if (UsePretrainedModel)
PreprocessParamFileName := 'detect_pills_preprocess_param.hdict'
RetrainedModelFileName := 'detect_pills.hdl'
else
DataDirectory := ExampleDataDir + '/dldataset_pill_bag_512x320'
PreprocessParamFileName := DataDirectory + '/dl_preprocess_...",108,123,"* --- Automatically Added Context ---
UsePretrainedModel := true
* --- End of Automatically Added Context ---"
5a9064be,micro,8,,BatchSizeInference := 1,124,126,
5a9064be,micro,9,,"MinConfidence := 0.6
MaxOverlap := 0.2
MaxOverlapClassAgnostic := 0.7",127,131,
5a9064be,micro,10,,"check_data_availability (ExampleDataDir, PreprocessParamFileName, RetrainedModelFileName, UsePretrainedModel)",136,138,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'detect_pills_data'
PreprocessParamFileName := 'detect_pills_preprocess_param.hdict'
RetrainedModelFileName := 'detec..."
5a9064be,micro,11,,"read_dl_model (RetrainedModelFileName, DLModelHandle)",139,141,"* --- Automatically Added Context ---
RetrainedModelFileName := 'detect_pills.hdl'
* --- End of Automatically Added Context ---"
5a9064be,micro,12,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSizeInference)",142,144,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
5a9064be,micro,13,,"set_dl_model_param (DLModelHandle, 'device', DLDevice)",145,147,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model (RetrainedModelFileName, DLModel..."
5a9064be,micro,14,,"set_dl_model_param (DLModelHandle, 'min_confidence', MinConfidence)
set_dl_model_param (DLModelHandle, 'max_overlap', MaxOverlap)
set_dl_model_param (DLModelHandle, 'max_overlap_class_agnostic', MaxOverlapClassAgnostic)",148,152,"* --- Automatically Added Context ---
MinConfidence := 0.6
MaxOverlap := 0.2
MaxOverlapClassAgnostic := 0.7
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Conte..."
5a9064be,micro,15,,"read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)",153,155,"* --- Automatically Added Context ---
PreprocessParamFileName := 'detect_pills_preprocess_param.hdict'
* --- End of Automatically Added Context ---"
5a9064be,micro,16,,WindowHandleDict := dict{},156,157,
5a9064be,micro,17,,"DLDataInfo := dict{}
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
DLDataInfo.class_names := ClassNames
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)
DLDataInfo.class_ids := ClassIDs",158,163,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
5a9064be,micro,18,,GenParam := dict{scale_windows: 1.2},164,166,
5a9064be,micro,19,"For this example, we select some images manually.","get_example_inference_images (ImageDir, ImageFiles)",167,170,"* --- Automatically Added Context ---
ImageDir := 'pill_bag/'
* --- End of Automatically Added Context ---"
5a9064be,micro,20,,"for BatchIndex := 0 to floor(|ImageFiles| / real(BatchSizeInference)) - 1 by 1
Batch := ImageFiles[BatchIndex * BatchSizeInference:(BatchIndex + 1) * BatchSizeInference - 1]
read_image (ImageBatch, Batch)
gen_dl_samples_from_images (ImageBatch, DLSampleBatch)
preprocess_dl_samples (DLSampleBatch, DL...",171,216,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
WindowHandleDict := d..."
5a9064be,micro,21,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",217,243,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added..."
5a9064be,micro,22,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
dev_open_example_text_window (ExampleInternals)
s...",246,287,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added..."
5a9064be,micro,23,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",288,294,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,24,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",295,299,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,25,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL object detection. It uses the MVTec pill bag dataset.'
Text[|Text|] := ''
Text[|Text|] :=...",300,332,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, Te..."
5a9064be,micro,26,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",335,346,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,27,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",347,358,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to |ClassIDs| - 1 by 1
* --- End of Automatically Added Context ---"
5a9064be,micro,28,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",359,370,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
for Index := 0 to |ClassIDs| - 1 by 1
get_dict_param (ExampleInternals, 'keys', [], Wi..."
5a9064be,micro,29,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",371,381,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
5a9064be,micro,30,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",382,415,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
catch (Exception)
*..."
5a9064be,micro,31,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",416,440,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Au..."
5a9064be,micro,32,,"WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",441,471,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
5a9064be,micro,33,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
PreprocessParamFileName := 'detect_pills_preprocess_param.hdict'
file_exists...",472,503,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ExampleDataDir := 'detect_pills_..."
5a9064be,micro,34,,"WindowImageNeeded := PreprocessParamExists and ModelExists
set_dict_tuple (ExampleInternals, 'window_images_needed', WindowImageNeeded)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",504,509,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
file_exists (PreprocessParamFileName, PreprocessParamExists)
file_exists (RetrainedMod..."
5a9064be,micro,35,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
if (not PreprocessParamExists or not ModelExists)
if (UsePretrainedModel)
Text := 'The pretrained model and corresponding preprocessing'
Text[|Text|] := 'parameters could not be found.'
Text[|Text|] ...",510,586,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, Clas..."
5a9064be,micro,36,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",587,593,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,37,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",594,598,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,38,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
dev_disp_text (Text, 'win...",599,610,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
create_counting_result_text (NumberDetectionsPe..."
5a9064be,micro,39,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')
get_dict_tuple (ExampleInternals, 'example_image_file', ExampleImageFile)
read_image (ImageRaw, ExampleImageFile)
get_image_size (ImageRa...",611,640,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
ExampleImageFil..."
5a9064be,micro,40,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|...",653,667,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
create_counting_result_text (NumberDetectionsPe..."
5a9064be,micro,41,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')
get_dict_tuple (ExampleInternals, 'example_image_file', ExampleImageFile)
read_image (ImageRaw, ExampleImageFile)
get_image_size (ImageRa...",668,679,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ExampleImageFile := '/pill_bag/pill_bag_036.png'
get_image_size (Image, Width, Height)..."
5a9064be,micro,42,,"LoupeZoom := 7.0
LoupeMargin := 30 * ZoomFactor
LoupeWindowSize := 45 * ZoomFactor
LoupeRow1 := 368 * ZoomFactor
LoupeColumn1 := 577 * ZoomFactor
dev_set_draw ('margin')
dev_set_color ('light blue')
dev_set_line_width (2)",680,688,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRaw, RawWidth, RawHeight)
* --- End of Automatically Added Conte..."
5a9064be,micro,43,,"crop_rectangle1 (ImageZoomed, ImagePart, LoupeRow1, LoupeColumn1, LoupeRow1 + LoupeWindowSize - 1, LoupeColumn1 + LoupeWindowSize - 1)
zoom_image_factor (ImagePart, ImagePart2, LoupeZoom, LoupeZoom, 'nearest_neighbor')
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, Heig...",689,694,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
zoom_image_size (ImageRaw, ImageZoomed, 512, 320, 'constant')
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRa..."
5a9064be,micro,44,,"gen_rectangle1 (Loupe1, LoupeRow1, LoupeColumn1, LoupeRow1 + LoupeWindowSize, LoupeColumn1 + LoupeWindowSize)
gen_rectangle1 (Loupe2, Height - LoupeZoom * LoupeWindowSize - LoupeMargin, LoupeMargin, Height - LoupeMargin - 5, LoupeZoom * LoupeWindowSize + LoupeMargin - 5)",695,697,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRaw, RawWidth, RawHeight)
LoupeZoom := 7.0
LoupeMargin := 30 * Z..."
5a9064be,micro,45,,"set_window_param (WindowHandleImages, 'flush', 'false')
gen_region_line (LoupeLine1, Height - LoupeZoom * LoupeWindowSize - LoupeMargin, LoupeMargin, LoupeRow1, LoupeColumn1)
gen_region_line (LoupeLine2, Height - LoupeMargin - 5, LoupeZoom * LoupeWindowSize + LoupeMargin - 5, LoupeRow1 + LoupeWindow...",698,734,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
zoom_image_size (ImageRaw, ImageZoomed, 512, 320, 'co..."
5a9064be,micro,46,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",735,741,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,47,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)",742,746,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,48,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image using'
Text[|Text|] := '   \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|...",747,763,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
DLSample := DLSampleBatch[SampleIndex]
create_counting_result_text (NumberDetectionsPe..."
5a9064be,micro,49,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)",764,767,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
5a9064be,micro,50,,"create_tiny_example_dataset_with_result (DLDataset, DLResult)",768,770,"* --- Automatically Added Context ---
DLResult := DLResultBatch[SampleIndex]
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
for SampleIndex := 0 to BatchSizeInference - 1 by 1
Text[|..."
5a9064be,micro,51,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
create_dict (WindowHandleDict)
get_dict_param (ExampleInternals, 'keys', [], GenParamValue)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleIm...",771,778,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_legend', WindowHa..."
5a9064be,micro,52,change size of windows.,"get_dict_tuple (ExampleInternals, 'window_images_x', WindowImageColumn1)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImageRow1)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImageWidth)
get_dict_tuple (ExampleInternals, 'window_images_height', WindowImageHeight)
Windo...",779,786,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,53,,"get_window_extents (WindowHandleLegend, Row, Column, Width, Height)
dev_set_window (WindowHandleLegend)
dev_set_window_extents (WindowImageRow1, WindowImageColumn1 + WindowImageWidth + 5, 290, WindowImageHeight)
dev_set_window (WindowHandleImages)
set_dict_tuple (WindowHandleDict, 'bbox_result', [Wi...",787,794,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
get_image_size (Image, Width, Height)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (ExampleInt..."
5a9064be,micro,54,,"gen_dl_samples (DLDataset, 0, 'detection', [], DLSample)
dev_display_dl_data (DLSample, DLResult, DLDataset, 'bbox_result', [], WindowHandleDict)
dev_set_window (WindowHandleImages)
dev_disp_text ('Output of \'apply_dl_model\'', 'window', 'top', 'left', 'black', [], [])
dev_set_window (WindowHandleT...",795,820,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
DLSample := DLSampleBatch[SampleIndex]
DLResult := DLResultBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampleBatch)
ap..."
5a9064be,micro,55,,"create_dict (DLDataset)
set_dict_tuple (DLDataset, 'image_dir', 'pill_bag/')
set_dict_tuple (DLDataset, 'class_ids', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
set_dict_tuple (DLDataset, 'class_names', ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamine', 'Cognivia', 'Capsularum I', 'Iron ta...",823,827,"* --- Automatically Added Context ---
for I := 0 to |WindowHandlesToClose| - 1 by 1
Text[|Text|] := 'The images have to be preprocessed in the same way as the DLDataset,'
* --- End of Automatically Ad..."
5a9064be,micro,56,,"DLSamples := []
create_dict (DLSample)
set_dict_tuple (DLSample, 'image_id', 36)
set_dict_tuple (DLSample, 'image_file_name', 'pill_bag_036.png')
set_dict_tuple (DLSample, 'bbox_row1', [177, 242, 247, 240, 453, 127, 465, 372])
set_dict_tuple (DLSample, 'bbox_col1', [692, 362, 455, 894, 436, 915, 826...",828,841,"* --- Automatically Added Context ---
DLSample := DLSampleBatch[SampleIndex]
gen_dl_samples_from_images (ImageBatch, DLSampleBatch)
for SampleIndex := 0 to BatchSizeInference - 1 by 1
Text[|Text|] := ..."
5a9064be,micro,57,,"create_dict (DLResult)
set_dict_tuple (DLResult, 'bbox_row1', [177, 242, 247, 240, 453, 127, 465, 372])
set_dict_tuple (DLResult, 'bbox_col1', [692, 362, 455, 894, 436, 915, 826, 535])
set_dict_tuple (DLResult, 'bbox_row2', [287, 376, 458, 322, 554, 244, 561, 456])
set_dict_tuple (DLResult, 'bbox_co...",842,866,"* --- Automatically Added Context ---
DLResult := DLResultBatch[SampleIndex]
apply_dl_model (DLModelHandle, DLSampleBatch, [], DLResultBatch)
for SampleIndex := 0 to BatchSizeInference - 1 by 1
* --- ..."
5a9064be,micro,58,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",867,873,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,59,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'We will now apply the trained model from example part 2'
Text[|Text|] := '\'detect_pills_deep_learning_2_train.hdev\''
Text[|Text|] := 'to some new images using \'apply_dl_model\'.'
Text[|Te...",879,909,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, Te..."
5a9064be,micro,60,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)",910,918,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,61,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",919,926,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automa..."
5a9064be,micro,62,,"Text := 'Congratulations!'
Text[|Text|] := 'You have finished the series of examples for DL object detection.'
Text[|Text|] := ''
Text[|Text|] := 'You can now train a DL object detection model on your own data.'
Text[|Text|] := ''
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')...",927,954,"* --- Automatically Added Context ---
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, TextBoxColor)
Text[|Text|] := 'the workflow for DL object detection. It uses t..."
5a9064be,micro,63,,"NumSamples := 10
tuple_gen_const (NumSamples, '', ImageFiles)",955,959,"* --- Automatically Added Context ---
get_example_inference_images (ImageDir, ImageFiles)
* --- End of Automatically Added Context ---"
5a9064be,micro,64,,"ImageFilesIndices := [152, 41, 164, 49]",960,961,
5a9064be,micro,65,,"ImageFilesIndices := [ImageFilesIndices,121, 59]",962,963,"* --- Automatically Added Context ---
ImageFilesIndices := [152, 41, 164, 49]
* --- End of Automatically Added Context ---"
5a9064be,micro,66,,"ImageFilesIndices := [ImageFilesIndices,178, 18]",964,965,"* --- Automatically Added Context ---
ImageFilesIndices := [152, 41, 164, 49]
* --- End of Automatically Added Context ---"
5a9064be,micro,67,,"ImageFilesIndices := [ImageFilesIndices,146, 294]
for Index := 0 to NumSamples - 1 by 1
ImageFiles[Index] := ImageDir + 'pill_bag_' + ImageFilesIndices[Index]$'03' + '.png'
endfor
tuple_shuffle (ImageFiles, ImageFiles)
return ()
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
...",966,1013,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ImageDir := 'pill_bag/'
get_example_inference_images (ImageDir, ImageFiles)
for Index ..."
5a9064be,micro,68,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_example_text_window (ExampleInternals)
dev_close_example_image_window (ExampleInternals)
dev_close_example_legend_window (ExampleInternals)
return ()",1014,1039,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,69,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",1040,1065,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImage..."
5a9064be,micro,70,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",1066,1091,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
catch (Exceptio..."
5a9064be,micro,71,,"try
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_text')
catch (Exception)
endtry
return ()",1092,1119,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
catch (Exceptio..."
5a9064be,micro,72,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 and 2 of example series.')
endif
file_exists (PreprocessParamFileName, FileExists)
if (not FileExists)
throw (PreprocessParamFileName + ' does not exist. Please run part 1 of exam...",1120,1158,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'detect_pills_data'
PreprocessParamFileName := 'detect_pills_preprocess_param.hdict'
Text[|Text|] := 'These files are..."
5a9064be,micro,73,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1159,1165,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,74,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Output optimization:'
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
Text[|Text|] := ''
Text[|Text|] := 'The output of \'apply_dl_model\' can be optimized with'
Text[|...",1171,1186,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, Te..."
5a9064be,micro,75,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')",1187,1191,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Au..."
5a9064be,micro,76,,"read_image (Image, 'pill_bag/pill_bag_207.png')
get_image_size (Image, ImageWidth, ImageHeight)
ImageZoomWidth := 512
ZoomedImageToImage := ImageZoomWidth / (1.0 * ImageWidth)
ImageZoomHeight := round(ImageHeight * ZoomedImageToImage)
zoom_image_size (Image, ImageZoomed, ImageZoomWidth, ImageZoomHei...",1192,1215,"* --- Automatically Added Context ---
read_image (Image, ExampleImageFile)
get_image_size (Image, Width, Height)
zoom_image_size (ImageRaw, ImageZoomed, 512, 320, 'constant')
crop_rectangle1 (ImageZoo..."
5a9064be,micro,77,,"dev_set_color ('gray')
dev_set_draw ('fill')
gen_rectangle1 (Line, 0, Width / 2, Height, Width / 2 + 1)",1216,1220,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
5a9064be,micro,78,,"get_distinct_colors (10, false, 0, 200, ColorsRainbow)
tuple_inverse (ColorsRainbow, ColorsRainbow)
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
ColorGinko := Colors[3]
ColorCapsularumI := Colors[7]",1221,1226,
5a9064be,micro,79,,"gen_rectangle1 (BoxGinko, 30.1, 4.7, 66.2, 91.7)
gen_rectangle1 (BoxCapsularumI, 56.0, 37.0, 119.8, 110.9)
gen_rectangle1 (BoxGinko2, 30.1, 4.7 + Width / 2, 66.2, 91.7 + Width / 2)
gen_rectangle1 (BoxCapsularumI2, 56.0, 37.0 + Width / 2, 119.8, 110.9 + Width / 2)",1227,1232,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
5a9064be,micro,80,,"gen_rectangle1 (BadBox, 40, 49, 92, 105)",1233,1235,
5a9064be,micro,81,,"dev_display (TiledImage)
dev_display (Line)
LineWidth := 2.0
set_window_param (WindowHandleImages, 'flush', 'false')
display_result_box (BoxGinko, LineWidth, ColorGinko, '4 (1.00)')
display_result_box (BoxCapsularumI, LineWidth, ColorCapsularumI, '8 (0.97)')
display_result_box (BoxGinko2, LineWidth,...",1236,1246,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
tile_images (ObjectsConcat, TiledImage, 2, 'vertical')
gen_rectangle1 (Line, 0, Width / 2, ..."
5a9064be,micro,82,,"get_window_extents (WindowHandleImages, Row, Column, WindowWidth, WindowHeight)
Text := 'min_confidence = 0.5 (default)'
get_string_extents (WindowHandleImages, Text, _, _, TextWidth, TextHeight)
TextCol := WindowWidth * 0.25 - TextWidth * 0.5
dev_disp_text (Text, 'window', WindowHeight - 2 * TextHe...",1247,1257,"* --- Automatically Added Context ---
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, TextBoxColor)
dev_open_window (WindowImagesY, WindowImagesX + WindowImagesWidt..."
5a9064be,micro,83,,"dev_set_part (0, 0, Height - 1, Width - 1)
flush_buffer (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'true')
return ()",1258,1282,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Context ---"
5a9064be,micro,84,,"dev_set_draw ('margin')
dev_set_line_width (int(LineWidth + 2))
dev_set_color ('black')
dev_display (Box)
dev_set_line_width (int(LineWidth))
dev_set_color (Colors)
dev_display (Box)",1285,1292,"* --- Automatically Added Context ---
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
LineWidth := 2.0
* --- End of Automatically Added Context ---"
5a9064be,micro,85,,"smallest_rectangle1 (Box, Row1, Column1, Row2, Column2)
dev_disp_text (Text, 'image', Row1, Column1, 'white', ['box_color', 'shadow', 'border_radius'], ['black', 'false', 0])
return ()",1293,1313,"* --- Automatically Added Context ---
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, TextBoxColor)
Row1 := 17
Row2 := Row1 + CropHeight
CropHeight := 140
dev_displ..."
5a9064be,micro,86,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1314,1320,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,87,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Output optimization:'
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
Text[|Text|] := ''
Text[|Text|] := 'Sometimes, the network finds more overlapping bounding'
Text[|...",1326,1342,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, Te..."
5a9064be,micro,88,,"gen_rectangle1 (BadBox1, 68, 26, 101, 102)
gen_rectangle1 (BadBox2, 49, 63, 119, 95)",1389,1392,
5a9064be,micro,89,,"dev_display (TiledImage)
dev_display (Line)
LineWidth := 2.0
set_window_param (WindowHandleImages, 'flush', 'false')
display_result_box (BoxGinko, LineWidth, ColorGinko, '4 (1.00)')
display_result_box (BoxCapsularumI, LineWidth, ColorCapsularumI, '8 (0.97)')
display_result_box (BoxGinko2, LineWidth,...",1393,1404,"* --- Automatically Added Context ---
LineWidth := 2.0
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
tile_images (ObjectsConcat, TiledImage, 2, 'vertical')
gen_rectangle1 (Lin..."
5a9064be,micro,90,,"get_window_extents (WindowHandleImages, Row, Column, WindowWidth, WindowHeight)
Text := 'max_overlap = 0.5 (default)'
get_string_extents (WindowHandleImages, Text, _, _, TextWidth, TextHeight)
TextCol := WindowWidth * 0.25 - TextWidth * 0.5
dev_disp_text (Text, 'window', WindowHeight - 2 * TextHeigh...",1405,1415,"* --- Automatically Added Context ---
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, TextBoxColor)
dev_open_window (WindowImagesY, WindowImagesX + WindowImagesWidt..."
5a9064be,micro,91,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1436,1442,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
5a9064be,micro,92,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Output optimization:'
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
Text[|Text|] := ''
Text[|Text|] := 'For the same object, more than one class might be'
Text[|Text|...",1448,1466,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, Te..."
5a9064be,micro,93,,"get_distinct_colors (10, false, 0, 200, ColorsRainbow)
tuple_inverse (ColorsRainbow, ColorsRainbow)
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
ColorGinko := Colors[3]
ColorCapsularumI := Colors[7]
ColorVitaminB := Colors[9]",1501,1507,"* --- Automatically Added Context ---
get_distinct_colors (10, false, 0, 200, ColorsRainbow)
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
ColorGinko := Colors[3]
ColorCapsularumI :=..."
5a9064be,micro,94,,"gen_rectangle1 (BadBox1, 25, 3, 61, 88)
gen_rectangle1 (BadBox2, 63, 36, 124, 103)",1514,1517,"* --- Automatically Added Context ---
gen_rectangle1 (BadBox1, 68, 26, 101, 102)
gen_rectangle1 (BadBox2, 49, 63, 119, 95)
* --- End of Automatically Added Context ---"
5a9064be,micro,95,,"dev_display (TiledImage)
dev_display (Line)
LineWidth := 2.0
set_window_param (WindowHandleImages, 'flush', 'false')
display_result_box (BoxGinko, LineWidth, ColorGinko, '4 (1.00)')
display_result_box (BoxCapsularumI, LineWidth, ColorCapsularumI, '8 (0.97)')
display_result_box (BoxGinko2, LineWidth,...",1518,1529,"* --- Automatically Added Context ---
gen_rectangle1 (BadBox1, 68, 26, 101, 102)
gen_rectangle1 (BadBox2, 49, 63, 119, 95)
LineWidth := 2.0
get_dict_tuple (ExampleInternals, 'window_images', WindowHan..."
5a9064be,micro,96,,"get_window_extents (WindowHandleImages, Row, Column, WindowWidth, WindowHeight)
Text := 'max_overlap_class_agnostic = 1.0 (default)'
get_string_extents (WindowHandleImages, Text, _, _, TextWidth, TextHeight)
TextCol := WindowWidth * 0.25 - TextWidth * 0.5
dev_disp_text (Text, 'window', WindowHeight ...",1530,1540,"* --- Automatically Added Context ---
create_counting_result_text (NumberDetectionsPerClass, ClassNames, Text, TextColor, TextBoxColor)
dev_open_window (WindowImagesY, WindowImagesX + WindowImagesWidt..."
5a9064be,micro,97,,"Text := []
if (max(NumberDetectionsPerClass) &gt; 1)
Indices := find(NumberDetectionsPerClass [&gt;] 1,1)
PillsDuplicateTuple := ClassNames[Indices]
PillsDuplicateString := PillsDuplicateTuple[0]
for Index := 1 to |PillsDuplicateTuple| - 1 by 1
PillsDuplicateString := PillsDuplicateString + ', ' + P...",1567,1624,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
tuple_gen_const (|ClassIDs|, 0, NumberDetectionsPerClass)
for Index := 0 to |ClassIDs| - 1 by 1
crea..."
5a9064be,micro,98,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')
get_dict_tuple (ExampleInternals, 'example_image_file', ExampleImageFile)
read_image (ImageRaw, ExampleImageFile)
get_image_size (ImageRa...",1652,1660,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ExampleImageFile := '/pill_bag/pill_bag_036.png'
get_image_size (Image, Width, Height)..."
5a9064be,micro,99,,"LoupeZoom := 7.0
LoupeMargin := 30
LoupeWindowSize := 45
LoupeRow1 := 368
LoupeColumn1 := 577
dev_set_draw ('margin')
dev_set_color ('light blue')
dev_set_line_width (2)",1661,1669,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRaw, RawWidth, RawHeight)
LoupeZoom := 7.0
LoupeMargin := 30 * Z..."
5a9064be,micro,100,,"crop_rectangle1 (ImageRaw, ImagePart, LoupeRow1, LoupeColumn1, LoupeRow1 + LoupeWindowSize - 1, LoupeColumn1 + LoupeWindowSize - 1)
zoom_image_factor (ImagePart, ImagePart2, LoupeZoom, LoupeZoom, 'nearest_neighbor')
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, Height ...",1670,1675,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRaw, RawWidth, RawHeight)
LoupeMargin := 30 * ZoomFactor
LoupeWi..."
5a9064be,micro,101,,"gen_rectangle1 (Loupe1, LoupeRow1, LoupeColumn1, LoupeRow1 + LoupeWindowSize, LoupeColumn1 + LoupeWindowSize)
gen_rectangle1 (Loupe2, Height - LoupeZoom * LoupeWindowSize - LoupeMargin, LoupeMargin, Height - LoupeMargin - 1, LoupeZoom * LoupeWindowSize + LoupeMargin - 1)",1676,1678,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
ZoomFactor := Height / real(RawHeight)
get_image_size (ImageRaw, RawWidth, RawHeight)
LoupeMargin := 30 * ZoomFactor
LoupeWi..."
5a9064be,micro,102,,"set_window_param (WindowHandleImages, 'flush', 'false')
gen_region_line (LoupeLine1, Height - LoupeZoom * LoupeWindowSize - LoupeMargin, LoupeMargin, LoupeRow1, LoupeColumn1)
gen_region_line (LoupeLine2, Height - LoupeMargin - 1, LoupeZoom * LoupeWindowSize + LoupeMargin - 1, LoupeRow1 + LoupeWindow...",1679,1722,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_disp_text ('Raw image', 'window', 'top', 'left', 'black', [], [])
ZoomFactor := Height / real(RawHeight)
get_image_size ..."
5a9064be,micro,103,NumColors.,"if (NumColors &lt; 1)
throw ('NumColors should be at least 1')
endif
if (not is_int(NumColors))
throw ('NumColors should be of type int')
endif
if (|NumColors| != 1)
throw ('NumColors should have length 1')
endif",1726,1736,
5a9064be,micro,104,,"if (Random != 0 and Random != 1)
tuple_is_string (Random, IsString)
if (IsString)
Random := Random == 'true' or 'false'
else
throw ('Random should be either true or false')
endif
endif",1737,1745,
5a9064be,micro,105,,"if (|StartColor| != 1)
throw ('StartColor should have length 1')
endif
if (StartColor &lt; 0 or StartColor &gt; 255)
throw ('StartColor should be in the range [0, 255]')
endif
if (not is_int(StartColor))
throw ('StartColor should be of type int')
endif",1746,1755,
5a9064be,micro,106,,"if (|EndColor| != 1)
throw ('EndColor should have length 1')
endif
if (EndColor &lt; 0 or EndColor &gt; 255)
throw ('EndColor should be in the range [0, 255]')
endif
if (not is_int(EndColor))
throw ('EndColor should be of type int')
endif",1756,1766,
5a9064be,micro,107,,"if (StartColor &gt; EndColor)
EndColor := EndColor + 255
endif
if (NumColors != 1)
Hue := (StartColor + int((EndColor - StartColor) * real([0:NumColors - 1]) / real(NumColors - 1))) % 255
else
Hue := mean([StartColor,EndColor])
endif
if (Random)
Hue := Hue[sort_index(rand(NumColors))]
Lightness := i...",1767,1784,"* --- Automatically Added Context ---
if (NumColors &lt; 1)
if (Random != 0 and Random != 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
* --- End of Automatically Added Context ---"
5a9064be,micro,108,,"gen_image_const (HLSImageH, 'byte', 1, NumColors)
gen_image_const (HLSImageL, 'byte', 1, NumColors)
gen_image_const (HLSImageS, 'byte', 1, NumColors)
get_region_points (HLSImageH, Rows, Columns)
set_grayval (HLSImageH, Rows, Columns, Hue)
set_grayval (HLSImageL, Rows, Columns, Lightness)
set_grayval...",1785,1793,"* --- Automatically Added Context ---
if (NumColors &lt; 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
Hue := (StartColor + int((EndColor - StartColor) * real([0:NumColors - 1]) / real(NumColors - 1)..."
5a9064be,micro,109,,"trans_to_rgb (HLSImageH, HLSImageL, HLSImageS, ImageR, ImageG, ImageB, 'hls')",1794,1796,"* --- Automatically Added Context ---
gen_image_const (HLSImageH, 'byte', 1, NumColors)
gen_image_const (HLSImageL, 'byte', 1, NumColors)
gen_image_const (HLSImageS, 'byte', 1, NumColors)
* --- End of..."
5a9064be,micro,110,,"get_grayval (ImageR, Rows, Columns, Red)
get_grayval (ImageG, Rows, Columns, Green)
get_grayval (ImageB, Rows, Columns, Blue)
Colors := '#' + Red$'02x' + Green$'02x' + Blue$'02x'
return ()",1797,1883,"* --- Automatically Added Context ---
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
get_region_points (HLSImageH, Rows, Columns)
trans_to_rgb (HLSImageH, HLSImageL, HLSImageS, ImageR..."
5a9064be,micro,111,"to make adjacent colors more distinguishable.
Neighboring colors from the input are distributed to e...","NumColors := |ColorsRainbow|
if (NumColors &gt;= 8)
NumChunks := 3
if (NumColors &gt;= 40)
NumChunks := 6
elseif (NumColors &gt;= 20)
NumChunks := 4
endif
Colors := gen_tuple_const(NumColors,-1)
NumLeftOver := NumColors % NumChunks
ColorsPerChunk := int(NumColors / NumChunks)
StartIdx := 0
for S := ...",1884,1943,"* --- Automatically Added Context ---
get_distinct_colors (10, false, 0, 200, ColorsRainbow)
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)
if (NumColors &lt; 1)
* --- End of Automati..."
5a9064be,micro,112,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on any deep learning device.'
Text[|Text|] := ''
if (DLDevic...",1951,1982,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
dd0fcd21,full,0,"Deep learning object detection inference workflow using a
trained YOLOv9 model in ONNX format:
PLEAS...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 32)
YoloOnnxFile := 'YOLOv9t_detect_pills.onnx'
ImageDir := 'pill_bag'
ClassIds := []
ClassNames := ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tablet', 'Vitamin-B']
* AI2Devic...",25,326,
dd0fcd21,micro,1,"- This is an example for Deep-Learning Detection experts.
- Supported YOLO versions are v8 and v9.
-...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 32)",10,28,
dd0fcd21,micro,2,"This model is a YOLOv9t and it was trained on the 'pill_bag'
images.",YoloOnnxFile := 'YOLOv9t_detect_pills.onnx',31,35,
dd0fcd21,micro,3,,ImageDir := 'pill_bag',36,38,
dd0fcd21,micro,4,"have length = number of classes the model was trained on.
Note, that class ids may not contain 0, si...","ClassIds := []
ClassNames := ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tablet', 'Vitamin-B']",39,45,
dd0fcd21,micro,5,,"* AI2Device := 'tensorrt'
* AI2Device := 'openvino'
AI2Device := []",46,50,
dd0fcd21,micro,6,,"MinConfidence := 0.5
MaxOverlap := 0.7
MaxOverlapClassAgnostic := 0.7
MaxNumDetections := 20",51,57,
dd0fcd21,micro,7,,"read_dl_model (YoloOnnxFile, DLModelYolo)",61,63,"* --- Automatically Added Context ---
YoloOnnxFile := 'YOLOv9t_detect_pills.onnx'
* --- End of Automatically Added Context ---"
dd0fcd21,micro,8,,"get_dl_model_param (DLModelYolo, 'inference_outputs', InferenceOutputs)
if (|InferenceOutputs| != 1)
throw ('Please make sure that the ONNX model has only one output.')
endif",64,69,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,9,YOLO typically uses 'images' as the input layer name.,"set_dl_model_layer_param (DLModelYolo, 'images', 'name', 'image')",70,73,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,10,"to the model. The NMS is not compatible with AI2 devices.
When using AI2 for inference, a separate m...","if (|AI2Device|)
create_model_nms (DLModelYolo, YoloOutputName, DLModelNMS)
DLModelDetection := DLModelNMS
else
append_model_nms (DLModelYolo, YoloOutputName, DLModelYolo)
DLModelDetection := DLModelYolo
endif",74,86,"* --- Automatically Added Context ---
* AI2Device := 'tensorrt'
read_dl_model (YoloOnnxFile, DLModelYolo)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,11,,"set_class_information (DLModelDetection, ClassIds, ClassNames, ClassIds, ClassNames)",87,89,"* --- Automatically Added Context ---
ClassIds := []
ClassNames := ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tablet', 'Vitamin-B']
DLMode..."
dd0fcd21,micro,12,,"set_dl_model_param (DLModelDetection, 'min_confidence', MinConfidence)
set_dl_model_param (DLModelDetection, 'max_overlap', MaxOverlap)
set_dl_model_param (DLModelDetection, 'max_overlap_class_agnostic', MaxOverlapClassAgnostic)
set_dl_model_param (DLModelDetection, 'max_num_detections', MaxNumDetec...",90,96,"* --- Automatically Added Context ---
MinConfidence := 0.5
MaxOverlap := 0.7
MaxOverlapClassAgnostic := 0.7
MaxNumDetections := 20
DLModelDetection := DLModelNMS
create_model_nms (DLModelYolo, YoloOut..."
dd0fcd21,micro,13,"In case you explicitly wish to run this example on the CPU,
choose the CPU device instead.","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",100,106,
dd0fcd21,micro,14,"first device is a GPU, if available.",DLDevice := DLDeviceHandles[0],107,110,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,15,,"UseAI2 := false
if (|AI2Device|)
query_available_dl_devices ('ai_accelerator_interface', AI2Device, DLDeviceHandlesAI2)
if (|DLDeviceHandlesAI2| == 0)
throw ('No supported AI2 device found. Please set AI2Device to an empty tuple to continue.')
endif
DLDeviceAI2 := DLDeviceHandlesAI2[0]
UseAI2 := tru...",111,121,"* --- Automatically Added Context ---
* AI2Device := 'tensorrt'
throw ('Please make sure that the ONNX model has only one output.')
throw ('No supported device found to continue this example.')
* --- ..."
dd0fcd21,micro,16,,"set_dl_model_param (DLModelYolo, 'batch_size', 1)
if (UseAI2)
set_dl_model_param (DLModelNMS, 'batch_size', 1)
set_dl_model_param (DLModelNMS, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelNMS, 'device', DLDevice)
get_dl_device_param (DLDeviceAI2, 'cast_precisions', CastPrecisions)
Pr...",122,148,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
create_model_nms (DLModelYolo, YoloOutputName, DLModelNMS)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', '..."
dd0fcd21,micro,17,the trained model to some randomly chosen example images.,"list_image_files (ImageDir, 'default', [], ImageFiles)
tuple_shuffle (ImageFiles, ImageFilesShuffled)
NumSamplesDisplay := min2(|ImageFilesShuffled|,10)",152,157,"* --- Automatically Added Context ---
ImageDir := 'pill_bag'
* --- End of Automatically Added Context ---"
dd0fcd21,micro,18,,"WindowDict := dict{}
DLDatasetInfo := dict{}
DLDatasetInfo.class_ids := ClassIds
DLDatasetInfo.class_names := ClassNames",158,163,"* --- Automatically Added Context ---
ClassIds := []
ClassNames := ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tablet', 'Vitamin-B']
* --- ..."
dd0fcd21,micro,19,"YOLO simply scales the image from range [0,255]
to range [0,1]. This can be achieved by setting cons...","create_dl_preprocess_param_from_model (DLModelDetection, 'constant_values', 'full_domain', [], [], [], DLPreprocessParam)
DLPreprocessParam.mean_values_normalization := [0., 0., 0.]
DLPreprocessParam.deviation_values_normalization := [255., 255., 255.]
for IndexInference := 0 to NumSamplesDisplay - ...",164,210,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
create_model_nms (DLModelYolo, YoloOutputName, DLModelNMS)
DLModelDetection := DLModelNMS
UseAI2 := false
tuple_shuffle ..."
dd0fcd21,micro,20,"If no class ids and class names are given, retrieve the
default ones from the model.","ClassIdsOut := ClassIds
ClassNamesOut := ClassNames
if (|ClassIdsOut| &gt; 0)
if (find(ClassIdsOut,0) != [] and find(ClassIdsOut,0) != -1)
throw ('Please do not include 0 in ClassIds, since 0 is reserved for the background class.')
endif
set_dl_model_param (DLModelDetection, 'class_ids', ClassIdsOut...",211,252,"* --- Automatically Added Context ---
ClassIds := []
ClassNames := ['Omega-3', 'KMW', 'Stomach tablet', 'Ginko', 'Ginseng', 'Glucosamin', 'Cognivia', 'Capsularum I', 'Iron tablet', 'Vitamin-B']
throw ..."
dd0fcd21,micro,21,"The YOLO output contains the predictions for classes
and box parameters.","get_dl_model_param (DLModelYolo, 'inference_outputs', InferenceOutputs)
YoloOutputName := InferenceOutputs[0]
get_dl_model_layer_param (DLModelYolo, YoloOutputName, 'shape', OutputShape)
create_dl_layer_input ('yolo_output', OutputShape[0:2], [], [], DLLayerYoloOutput)",257,263,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
get_dl_model_param (DLModelYolo, 'inference_outputs', InferenceOutputs)
create_model_nms (DLModelYolo, YoloOutputName, D..."
dd0fcd21,micro,22,"The first 4 channels of the output should correspond
to the predicted box coordinates.
The remaining...","create_dl_layer_slice (DLLayerYoloOutput, 'box_params', 'depth', 0, 4, [], [], [], DLLayerBoxParams)
create_dl_layer_slice (DLLayerYoloOutput, 'class_scores', 'depth', 4, H_INT_MAX, [], [], [], DLLayerClassScores)",264,270,"* --- Automatically Added Context ---
create_dl_layer_input ('yolo_output', OutputShape[0:2], [], [], DLLayerYoloOutput)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,23,image input layer. This is needed for the BoxProposals layer.,"get_dl_model_layer_param (DLModelYolo, 'image', 'shape', InputShape)
create_dl_layer_input ('image', InputShape[0:2], 'input_type', 'constant', DLLayerInput)",271,274,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,24,,"create_dl_layer_box_proposals (DLLayerClassScores, [], DLLayerBoxParams, DLLayerInput, 'nms', [], [], DLLayerNMS)",275,276,"* --- Automatically Added Context ---
create_dl_layer_slice (DLLayerYoloOutput, 'box_params', 'depth', 0, 4, [], [], [], DLLayerBoxParams)
create_dl_layer_slice (DLLayerYoloOutput, 'class_scores', 'de..."
dd0fcd21,micro,25,,"create_dl_model (DLLayerNMS, DLModelNMS)
set_dl_model_param (DLModelNMS, 'type', 'detection')
return ()",277,302,"* --- Automatically Added Context ---
create_model_nms (DLModelYolo, YoloOutputName, DLModelNMS)
create_dl_layer_box_proposals (DLLayerClassScores, [], DLLayerBoxParams, DLLayerInput, 'nms', [], [], D..."
dd0fcd21,micro,26,perform Non-Maximum-Suppression on the predicted boxes.,DLModelYoloOut := DLModelYolo,303,306,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
* --- End of Automatically Added Context ---"
dd0fcd21,micro,27,Get the YOLO model's input and output layer.,"get_dl_model_param (DLModelYoloOut, 'inference_outputs', InferenceOutputs)
YoloOutputName := InferenceOutputs[0]
get_dl_model_layer (DLModelYoloOut, ['image',YoloOutputName], DLLayers)
DLLayerInput := DLLayers[0]
DLLayerOutput := DLLayers[1]",307,313,"* --- Automatically Added Context ---
create_model_nms (DLModelYolo, YoloOutputName, DLModelNMS)
get_dl_model_param (DLModelYolo, 'inference_outputs', InferenceOutputs)
create_dl_layer_input ('image',..."
dd0fcd21,micro,28,"The first 4 channels of the output should correspond
to the predicted box coordinates.
The remaining...","create_dl_layer_slice (DLLayerOutput, 'box_params', 'depth', 0, 4, [], [], [], DLLayerBoxParams)
create_dl_layer_slice (DLLayerOutput, 'class_scores', 'depth', 4, H_INT_MAX, [], [], [], DLLayerClassScores)",314,320,"* --- Automatically Added Context ---
create_dl_layer_slice (DLLayerYoloOutput, 'box_params', 'depth', 0, 4, [], [], [], DLLayerBoxParams)
create_dl_layer_slice (DLLayerYoloOutput, 'class_scores', 'de..."
dd0fcd21,micro,29,,"create_dl_model (DLLayerNMS, DLModelYoloOut)
set_dl_model_param (DLModelYoloOut, 'type', 'detection')
return ()",323,337,"* --- Automatically Added Context ---
read_dl_model (YoloOnnxFile, DLModelYolo)
DLModelYoloOut := DLModelYolo
create_dl_layer_box_proposals (DLLayerClassScores, [], DLLayerBoxParams, DLLayerInput, 'nm..."
218c42cc,full,0,"Workflow for deep learning detection with oriented bounding boxes:
This example demonstrates the ove...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
InputImageDir := 'screws/'
PreprocessingOutputDir := 'detect_screws_data'
RemoveResults := false
read_dict ('screws.hdict', [], [], DLDataset)
DLDataset.image_dir := InputImageDir
DLModelDetectionParam := dict{}
DLModelDetectionParam...",22,227,
218c42cc,micro,1,"- This is a bare-bones example.
Therefore, default parameters are used as much as possible.
- For mo...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)",14,25,
218c42cc,micro,2,,"InputImageDir := 'screws/'
PreprocessingOutputDir := 'detect_screws_data'",26,30,
218c42cc,micro,3,,RemoveResults := false,31,33,
218c42cc,micro,4,and set the image directory.,"read_dict ('screws.hdict', [], [], DLDataset)
DLDataset.image_dir := InputImageDir",36,40,"* --- Automatically Added Context ---
InputImageDir := 'screws/'
* --- End of Automatically Added Context ---"
218c42cc,micro,5,the dataset.,"DLModelDetectionParam := dict{}
DLModelDetectionParam.image_dimensions := [512, 384, 3]
DLModelDetectionParam.min_level := 3
DLModelDetectionParam.max_level := 4
DLModelDetectionParam.anchor_num_subscales := 2
DLModelDetectionParam.anchor_aspect_ratios := [0.1, 0.16, 0.35, 1.0]
DLModelDetectionParam...",41,54,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
* --- End of Automatically Added Context ---"
218c42cc,micro,6,we set them explicitly in the following lines.,"DLModelDetectionParam.instance_type := 'rectangle2'
DLModelDetectionParam.anchor_angles := rad([-120, -60, 0, 60, 120, 180])
DLModelDetectionParam.ignore_direction := 'false'
DLModelDetectionParam.class_ids_no_orientation := [6, 8, 9, 10]
create_dl_model_detection ('pretrained_dl_classifier_compact....",55,63,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
DLModelDetectionParam := dict{}
ClassIDs := DLDataset.class_ids
* --- End of Automatically Added Context ---"
218c42cc,micro,7,,"split_dl_dataset (DLDataset, 70, 15, [])",64,65,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
* --- End of Automatically Added Context ---"
218c42cc,micro,8,,"PreprocessSettings := dict{overwrite_files: 'auto'}
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
preprocess_dl_dataset (DLDataset, PreprocessingOutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",66,70,"* --- Automatically Added Context ---
PreprocessingOutputDir := 'detect_screws_data'
read_dict ('screws.hdict', [], [], DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |C..."
218c42cc,micro,9,,"WindowDict := dict{}
DatasetSamples := DLDataset.samples
for Index := 0 to 9 by 1
SampleIndex := round(rand(1) * (|DatasetSamples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'bbox_ground_truth', [], WindowDict)
dev_disp_text ('Press F5 to c...",71,82,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
* --- End of Automatically Added Context ---"
218c42cc,micro,10,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",85,93,
218c42cc,micro,11,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",94,103,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
218c42cc,micro,12,,"InitialLearningRate := 0.0005
set_dl_model_param (DLModelHandle, 'batch_size', 2)
set_dl_model_param (DLModelHandle, 'learning_rate', InitialLearningRate)
set_dl_model_param (DLModelHandle, 'momentum', 0.99)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",104,110,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
query_available_dl_devices (['runtime', 'runt..."
218c42cc,micro,13,,"GenParamName := []
GenParamValue := []
ChangeStrategy := dict{}
ChangeStrategy.model_param := 'learning_rate'
ChangeStrategy.initial_value := InitialLearningRate
ChangeStrategy.epochs := 50
ChangeStrategy.values := InitialLearningRate * 0.5
GenParamName := [GenParamName,'change']
GenParamValue := [G...",111,121,"* --- Automatically Added Context ---
InitialLearningRate := 0.0005
* --- End of Automatically Added Context ---"
218c42cc,micro,14,"The resulting detection performance could be optimized further at the cost of longer
training time. ...","create_dl_train_param (DLModelHandle, 70, 2, 'true', 42, GenParamName, GenParamValue, TrainParam)",122,127,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
GenParamName := []
GenParamValue := []
* --- ..."
218c42cc,micro,15,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",128,131,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)..."
218c42cc,micro,16,,"read_dl_model ('model_best.hdl', DLModelHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",132,139,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
dev_disp_text ('Press F5 to continue', 'windo..."
218c42cc,micro,17,,"GenParamEval := dict{}
GenParamEval.detailed_evaluation := true
GenParamEval.show_progress := true
GenParamEval.measures := 'all'
GenParamEval.iou_threshold := [0.5, 0.7]
set_dl_model_param (DLModelHandle, 'min_confidence', 0.5)
set_dl_model_param (DLModelHandle, 'max_overlap', 0.2)
set_dl_model_par...",142,161,"* --- Automatically Added Context ---
read_dict ('screws.hdict', [], [], DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)..."
218c42cc,micro,18,"meaning, reduce its memory consumption.","set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",162,165,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
* --- End of Automatically Added Context ---"
218c42cc,micro,19,,"write_dl_model (DLModelHandle, 'model_best.hdl')",166,168,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
* --- End of Automatically Added Context ---"
218c42cc,micro,20,the trained model to some randomly chosen example images.,"list_image_files (InputImageDir, 'default', [], ImageFiles)
tuple_shuffle (ImageFiles, ImageFilesShuffled)",171,175,"* --- Automatically Added Context ---
InputImageDir := 'screws/'
* --- End of Automatically Added Context ---"
218c42cc,micro,21,,"WindowDict := dict{}
DLDatasetInfo := dict{}
get_dl_model_param (DLModelHandle, 'class_ids', DLDatasetInfo.class_ids)
get_dl_model_param (DLModelHandle, 'class_names', DLDatasetInfo.class_names)
for IndexInference := 0 to 9 by 1
read_image (Image, ImageFilesShuffled[IndexInference])
gen_dl_samples_f...",176,192,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |ClassIDs|, DLModelDetectionParam, DLModelHandle)
create_dl_preprocess_param_from_model (DLMode..."
218c42cc,micro,22,,"clean_up_output (PreprocessingOutputDir, RemoveResults)",193,208,"* --- Automatically Added Context ---
PreprocessingOutputDir := 'detect_screws_data'
RemoveResults := false
* --- End of Automatically Added Context ---"
218c42cc,micro,23,,"if (not RemoveResults)
return ()
endif",209,213,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
218c42cc,micro,24,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",214,222,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
218c42cc,micro,25,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",223,246,
2049c22c,full,0,"Deep learning object detection workflow:
This example demonstrates the overall workflow for
object d...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
get_system ('example_dir', HalconExampleDir)
PillBagJsonFile := HalconExampleDir + '/hdevelop/Deep-Learning/Detection/pill_bag.json'
get_image_dir (ImageDirs)
HalconImageDir := ImageDirs[0]
OutputDir := 'detect_pills_data'
RemoveResu...",20,189,
2049c22c,micro,1,"- This is a bare-bones example.
- For this, default parameters are used as much as possible.
Hence, ...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)",13,23,
2049c22c,micro,2,,"get_system ('example_dir', HalconExampleDir)
PillBagJsonFile := HalconExampleDir + '/hdevelop/Deep-Learning/Detection/pill_bag.json'
get_image_dir (ImageDirs)
HalconImageDir := ImageDirs[0]
OutputDir := 'detect_pills_data'",24,32,
2049c22c,micro,3,,RemoveResults := false,33,35,
2049c22c,micro,4,"Here, we read the data from a COCO file.
Alternatively, you can read a DLDataset dictionary
as creat...","read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)",38,43,"* --- Automatically Added Context ---
PillBagJsonFile := HalconExampleDir + '/hdevelop/Deep-Learning/Detection/pill_bag.json'
HalconImageDir := ImageDirs[0]
get_system ('example_dir', HalconExampleDir..."
2049c22c,micro,5,the dataset.,"DLModelDetectionParam := dict{image_dimensions: [512, 320, 3], max_level: 4}
DLModelDetectionParam.class_ids := DLDataset.class_ids
DLModelDetectionParam.class_names := DLDataset.class_names
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModel...",44,50,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Automatically Added Context ---"
2049c22c,micro,6,,"split_dl_dataset (DLDataset, 60, 20, [])",51,52,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Automatically Added Context ---"
2049c22c,micro,7,,"PreprocessSettings := dict{overwrite_files: 'auto'}
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",53,57,"* --- Automatically Added Context ---
OutputDir := 'detect_pills_data'
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
create_dl_model_dete..."
2049c22c,micro,8,,"WindowDict := dict{}
for Index := 0 to 9 by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'bbox_ground_truth', [], WindowDict)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'ri...",58,68,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
* --- End of Automatically Added Context ---"
2049c22c,micro,9,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",71,79,
2049c22c,micro,10,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",80,89,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
2049c22c,micro,11,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'learning_rate', 0.001)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",90,94,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModelDetectionParam, DLModelHandle)
query_available_dl_dev..."
2049c22c,micro,12,"For better model performance increase the number of epochs,
from 10 to, e.g., 60.","create_dl_train_param (DLModelHandle, 10, 1, 'true', 42, [], [], TrainParam)",95,98,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModelDetectionParam, DLModelHandle)
* --- End of Automatic..."
2049c22c,micro,13,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",99,102,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_..."
2049c22c,micro,14,,"read_dl_model ('model_best.hdl', DLModelHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",103,110,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModelDetectionParam, DLModelHandle)
dev_disp_text ('Press ..."
2049c22c,micro,15,,"GenParamEval := dict{detailed_evaluation: true, show_progress: true}
set_dl_model_param (DLModelHandle, 'device', DLDevice)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
DisplayMode := dict{display_mode: ['pie_charts_precision', 'pie_charts...",111,123,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_..."
2049c22c,micro,16,"meaning, reduce its memory consumption.","set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",124,127,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModelDetectionParam, DLModelHandle)
* --- End of Automatic..."
2049c22c,micro,17,,"write_dl_model (DLModelHandle, 'model_best.hdl')",128,130,"* --- Automatically Added Context ---
create_dl_model_detection ('pretrained_dl_classifier_compact.hdl', |DLModelDetectionParam.class_ids|, DLModelDetectionParam, DLModelHandle)
* --- End of Automatic..."
2049c22c,micro,18,the trained model to some randomly chosen example images.,"list_image_files ('pill_bag/', 'default', 'recursive', ImageFiles)
tuple_shuffle (ImageFiles, ImageFilesShuffled)",133,137,
2049c22c,micro,19,,"WindowDict := dict{}
DLDatasetInfo := dict{}
get_dl_model_param (DLModelHandle, 'class_ids', DLDatasetInfo.class_ids)
get_dl_model_param (DLModelHandle, 'class_names', DLDatasetInfo.class_names)
for IndexInference := 0 to 9 by 1
read_image (Image, ImageFilesShuffled[IndexInference])
gen_dl_samples_f...",138,154,"* --- Automatically Added Context ---
read_dl_dataset_from_coco (PillBagJsonFile, HalconImageDir, dict{read_segmentation_masks: false}, DLDataset)
create_dl_model_detection ('pretrained_dl_classifier_..."
2049c22c,micro,20,,"clean_up_output (OutputDir, RemoveResults)",155,170,"* --- Automatically Added Context ---
OutputDir := 'detect_pills_data'
RemoveResults := false
* --- End of Automatically Added Context ---"
2049c22c,micro,21,,"if (not RemoveResults)
return ()
endif",171,175,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
2049c22c,micro,22,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",176,184,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
2049c22c,micro,23,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",185,208,"* --- Automatically Added Context ---
OutputDir := 'detect_pills_data'
* --- End of Automatically Added Context ---"
2f0f003c,full,0,,"dev_update_off ()
dev_close_window ()
stop ()
InputWidth := 64
InputHeight := 64
InputDepth := 3
create_dl_layer_input ('input', [InputWidth,InputHeight,InputDepth], [], [], DLLayerInput)
create_dl_layer_convolution (DLLayerInput, 'convolution1', 5, 1, 1, 20, 1, 'none', 'relu', 'bias_filler_variance...",7,112,
2f0f003c,micro,1,Part 1: Create a network.,stop (),34,37,
2f0f003c,micro,2,dimensions.,"InputWidth := 64
InputHeight := 64
InputDepth := 3",38,43,
2f0f003c,micro,3,,"create_dl_layer_input ('input', [InputWidth,InputHeight,InputDepth], [], [], DLLayerInput)",44,46,"* --- Automatically Added Context ---
InputWidth := 64
InputHeight := 64
InputDepth := 3
* --- End of Automatically Added Context ---"
2f0f003c,micro,4,,"create_dl_layer_convolution (DLLayerInput, 'convolution1', 5, 1, 1, 20, 1, 'none', 'relu', 'bias_filler_variance_norm', 'norm_out', DLLayerConvolution1)
create_dl_layer_batch_normalization (DLLayerConvolution1, 'batchnorm1', 0.9, 0.0001, 'none', [], [], DLLayerBatchNorm)
create_dl_layer_pooling (DLL...",47,56,"* --- Automatically Added Context ---
create_dl_layer_input ('input', [InputWidth,InputHeight,InputDepth], [], [], DLLayerInput)
* --- End of Automatically Added Context ---"
2f0f003c,micro,5,,"create_dl_layer_softmax (DLLayerDense2, 'softmax', [], [], DLLayerSoftMax)
create_dl_layer_input ('image_label_id', [1, 1, 1], [], [], DLLayerTarget)
create_dl_layer_input ('weights', [1, 1, 1], [], [], DLLayerWeights)
create_dl_layer_loss_cross_entropy (DLLayerSoftMax, DLLayerTarget, DLLayerWeights...",57,62,"* --- Automatically Added Context ---
create_dl_layer_dense (DLLayerDense1, 'dense2', 10, 'bias_filler_variance_norm', 'norm_out', DLLayerDense2)
* --- End of Automatically Added Context ---"
2f0f003c,micro,6,"The created model then contains all layers that directly
or indirectly feed into these output layers...","create_dl_model (DLLayerLossCrossEntropy, DLModelHandle)",63,66,"* --- Automatically Added Context ---
create_dl_layer_loss_cross_entropy (DLLayerSoftMax, DLLayerTarget, DLLayerWeights, 'loss_cross_entropy', 1, [], [], DLLayerLossCrossEntropy)
* --- End of Automati..."
2f0f003c,micro,7,"the HALCON specific type 'generic', meaning that it is not
marked for which type of application it i...","set_dl_model_param (DLModelHandle, 'type', 'classification')",67,76,"* --- Automatically Added Context ---
create_dl_model (DLLayerLossCrossEntropy, DLModelHandle)
* --- End of Automatically Added Context ---"
2f0f003c,micro,8,,stop (),77,79,
2f0f003c,micro,9,,"set_dl_model_param (DLModelHandle, 'image_width', InputWidth)
set_dl_model_param (DLModelHandle, 'image_height', InputHeight)
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)
dev_inspect_ctrl (NetworkSummary)",80,85,"* --- Automatically Added Context ---
InputWidth := 64
InputHeight := 64
create_dl_model (DLLayerLossCrossEntropy, DLModelHandle)
* --- End of Automatically Added Context ---"
2f0f003c,micro,10,Press Run (F5) to continue.,"stop ()
dev_close_inspect_ctrl (NetworkSummary)",86,90,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)
* --- End of Automatically Added Context ---"
2f0f003c,micro,11,or directly from the layer handle.,"get_dl_model_layer_param (DLModelHandle, 'convolution2', 'activation_mode', ActivationModeConvolution2)
get_dl_layer_param (DLLayerConvolution2, 'input_layer', InputLayerConvolution2)
set_dl_model_layer_param (DLModelHandle, 'convolution1', 'name', 'convolution1_with_relu')
set_dl_model_layer_param ...",91,98,"* --- Automatically Added Context ---
create_dl_layer_convolution (DLLayerPooling1, 'convolution2', 5, 1, 1, 50, 1, 'none', 'relu', 'bias_filler_variance_norm', 'norm_out', DLLayerConvolution2)
create..."
2f0f003c,micro,12,Press Run F5 (Run) to continue.,"stop ()
MetaData := dict{}
MetaData.model_creator := 'MVTec Software GmbH'
MetaData.model_info := 'Classification model with two BatchNorm layer'
set_dl_model_param (DLModelHandle, 'meta_data', MetaData)",99,106,"* --- Automatically Added Context ---
create_dl_model (DLLayerLossCrossEntropy, DLModelHandle)
* --- End of Automatically Added Context ---"
2f0f003c,micro,13,"step. See our further examples in order how to do so,
e.g., dl_classification_workflow.hdev.
Press R...","stop ()
write_dl_model (DLModelHandle, 'dl_model_classification_small.hdl')",107,118,"* --- Automatically Added Context ---
create_dl_model (DLLayerLossCrossEntropy, DLModelHandle)
* --- End of Automatically Added Context ---"
bd8ec989,full,0,,"dev_update_off ()
dev_close_window ()
stop ()
InputImageWidth := 400
InputImageHeight := 400
InputImageDepth := 3
BatchSize := 16
create_dl_layer_input ('segmentation_image_target', [InputImageWidth,InputImageHeight,1], [], [], DLLayerImageTarget)
create_dl_layer_class_id_conversion (DLLayerImageTar...",7,130,
bd8ec989,micro,1,Part 1: Create a network.,stop (),44,47,
bd8ec989,micro,2,dimensions and batch size.,"InputImageWidth := 400
InputImageHeight := 400
InputImageDepth := 3
BatchSize := 16",48,54,
bd8ec989,micro,3,,"create_dl_layer_input ('segmentation_image_target', [InputImageWidth,InputImageHeight,1], [], [], DLLayerImageTarget)
create_dl_layer_class_id_conversion (DLLayerImageTarget, 'target', 'from_class_id', [], [], DLLayerTarget)
create_dl_layer_input ('image', [InputImageWidth,InputImageHeight,InputImag...",55,60,"* --- Automatically Added Context ---
InputImageWidth := 400
InputImageHeight := 400
InputImageDepth := 3
* --- End of Automatically Added Context ---"
bd8ec989,micro,4,"Note, that this exemplary network is very small and might not produce
satisfying results, depending ...","create_dl_layer_convolution (DLLayerInput, 'convolution1', 5, 1, 1, 3, 1, 'none', 'relu', [], [], DLLayerConvolution1)
create_dl_layer_batch_normalization (DLLayerConvolution1, 'batchnorm1', 0.9, 0.0001, 'none', [], [], DLLayerBatchNorm1)
create_dl_layer_pooling (DLLayerBatchNorm1, 'pooling1', [2, 2...",61,72,"* --- Automatically Added Context ---
create_dl_layer_input ('image', [InputImageWidth,InputImageHeight,InputImageDepth], [], [], DLLayerInput)
* --- End of Automatically Added Context ---"
bd8ec989,micro,5,,"create_dl_layer_softmax (DLLayerZoom, 'softmax', [], [], DLLayerSoftMax)
create_dl_layer_loss_cross_entropy (DLLayerSoftMax, DLLayerTarget, DLLayerWeights, 'loss_cross_entropy', 1, [], [], DLLayerLossCrossEntropy)",73,76,"* --- Automatically Added Context ---
create_dl_layer_class_id_conversion (DLLayerImageTarget, 'target', 'from_class_id', [], [], DLLayerTarget)
create_dl_layer_input ('weight_image', [InputImageWidth..."
bd8ec989,micro,6,,"create_dl_layer_depth_max (DLLayerSoftMax, 'segmentation_image_softmax', 'argmax', [], [], DLLayerSegmentationSoftMax, _)
create_dl_layer_class_id_conversion (DLLayerSegmentationSoftMax, 'segmentation_image', 'to_class_id', [], [], DLLayerSegmentationImage)",77,80,"* --- Automatically Added Context ---
create_dl_layer_softmax (DLLayerZoom, 'softmax', [], [], DLLayerSoftMax)
* --- End of Automatically Added Context ---"
bd8ec989,micro,7,,"create_dl_layer_depth_max (DLLayerSoftMax, 'segmentation_confidence', 'value', [], [], _, DLLayerSegmentationConfidence)",81,83,"* --- Automatically Added Context ---
create_dl_layer_softmax (DLLayerZoom, 'softmax', [], [], DLLayerSoftMax)
* --- End of Automatically Added Context ---"
bd8ec989,micro,8,"The created model then contains all layers that directly
or indirectly feed into these output layers...","create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)",84,87,"* --- Automatically Added Context ---
create_dl_layer_loss_cross_entropy (DLLayerSoftMax, DLLayerTarget, DLLayerWeights, 'loss_cross_entropy', 1, [], [], DLLayerLossCrossEntropy)
create_dl_layer_class..."
bd8ec989,micro,9,"the HALCON specific type 'generic', meaning that it is not
marked for which type of application it i...","set_dl_model_param (DLModelHandle, 'type', 'segmentation')",88,97,"* --- Automatically Added Context ---
create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)
* --- End of Automatically Added Context ---"
bd8ec989,micro,10,,stop (),98,100,
bd8ec989,micro,11,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)",101,104,"* --- Automatically Added Context ---
BatchSize := 16
create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)
* --- End of Automatically Added..."
bd8ec989,micro,12,,"dev_inspect_ctrl (NetworkSummary)
stop ()",105,108,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'summary', NetworkSummary)
* --- End of Automatically Added Context ---"
bd8ec989,micro,13,,"dev_close_inspect_ctrl (NetworkSummary)
dev_inspect_ctrl (DLModelHandle)
stop ()",109,115,"* --- Automatically Added Context ---
create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)
get_dl_model_param (DLModelHandle, 'summary', Ne..."
bd8ec989,micro,14,Press Run F5 (Run) to continue.,"dev_close_inspect_ctrl (DLModelHandle)
MetaData := dict{}
MetaData.model_creator := 'MVTec Software GmbH'
MetaData.model_info := 'Segmentation model with BatchNorm layer'
set_dl_model_param (DLModelHandle, 'meta_data', MetaData)",116,124,"* --- Automatically Added Context ---
create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)
* --- End of Automatically Added Context ---"
bd8ec989,micro,15,"step. See our further examples in order how to do so,
e.g., dl_segmentation_workflow.hdev.
Press Run...","stop ()
write_dl_model (DLModelHandle, 'dl_model_segmentation_small.hdl')",125,136,"* --- Automatically Added Context ---
create_dl_model ([DLLayerLossCrossEntropy,DLLayerSegmentationImage,DLLayerSegmentationConfidence], DLModelHandle)
* --- End of Automatically Added Context ---"
60894594,full,0,"Deep learning instance segmentation workflow:
This example demonstrates the overall workflow for ins...","dev_close_window ()
dev_update_off ()
DatasetFilename := 'pill_bag_instance_segmentation.hdict'
OutputDir := './detect_pills_data'
RemoveResults := false
ImageWidth := 512
ImageHeight := 384
Backbone := 'pretrained_dl_classifier_compact.hdl'
TrainingBatchSize := 2
DeviceRuntime := ['gpu', 'cpu']
Max...",12,260,
60894594,micro,1,segmentation based on deep learning.,"dev_close_window ()
dev_update_off ()",9,14,
60894594,micro,2,"MVTec Deep Learning Tool.
It is also possible to use datasets given in COCO format
labeled for the C...",DatasetFilename := 'pill_bag_instance_segmentation.hdict',17,23,
60894594,micro,3,"(e.g., preprocessed dataset and the trained model file).",OutputDir := './detect_pills_data',24,27,
60894594,micro,4,this program.,RemoveResults := false,28,31,
60894594,micro,5,,"ImageWidth := 512
ImageHeight := 384",32,35,
60894594,micro,6,,Backbone := 'pretrained_dl_classifier_compact.hdl',36,38,
60894594,micro,7,,TrainingBatchSize := 2,39,41,
60894594,micro,8,(prefer GPU over CPU).,"DeviceRuntime := ['gpu', 'cpu']",42,45,
60894594,micro,9,"and training. Note, this parameter has an impact on the
memory usage and runtime of the model.
This ...",MaxNumDetections := 20,46,53,
60894594,micro,10,,MinConfidence := 0.75,54,56,
60894594,micro,11,These parameters determine the split percentages.,"SplitPercentageTrain := 60
SplitPercentageValidation := 20",57,61,
60894594,micro,12,,"set_system ('seed_rand', 42)",62,65,
60894594,micro,13,masks would be clipped to the currently used image size.,"set_system ('clip_region', 'false')",66,69,
60894594,micro,14,,"OutputDirPreprocessing := OutputDir + '/dataset'
BestModelFilename := OutputDir + '/model_best.hdl'
file_exists (OutputDir, FileExists)
if (not FileExists)
make_dir (OutputDir)
endif",70,78,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
* --- End of Automatically Added Context ---"
60894594,micro,15,,"read_dict (DatasetFilename, [], [], DLDataset)",79,81,"* --- Automatically Added Context ---
DatasetFilename := 'pill_bag_instance_segmentation.hdict'
* --- End of Automatically Added Context ---"
60894594,micro,16,,"split_dl_dataset (DLDataset, SplitPercentageTrain, SplitPercentageValidation, [])",82,84,"* --- Automatically Added Context ---
SplitPercentageTrain := 60
SplitPercentageValidation := 20
read_dict (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
60894594,micro,17,for the dataset.,"determine_dl_model_detection_param (DLDataset, ImageWidth, ImageHeight, dict{}, DLDetectionModelParam)",85,89,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 384
read_dict (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
60894594,micro,18,,DLDetectionModelParam.instance_segmentation := 'true',90,91,"* --- Automatically Added Context ---
determine_dl_model_detection_param (DLDataset, ImageWidth, ImageHeight, dict{}, DLDetectionModelParam)
* --- End of Automatically Added Context ---"
60894594,micro,19,,"DLDetectionModelParam.max_num_detections := MaxNumDetections
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)",92,96,"* --- Automatically Added Context ---
Backbone := 'pretrained_dl_classifier_compact.hdl'
MaxNumDetections := 20
read_dict (DatasetFilename, [], [], DLDataset)
determine_dl_model_detection_param (DLDat..."
60894594,micro,20,instance segmentation model.,"create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)",99,102,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
* --- End of Automatically Added Context ---"
60894594,micro,21,preprocessing parameters or the dataset have changed.,"preprocess_dl_dataset (DLDataset, OutputDirPreprocessing, DLPreprocessParam, dict{overwrite_files: 'auto'}, DLDatasetFileName)",103,106,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
OutputDirPreprocessing := OutputDir + '/dataset'
read_dict (DatasetFilename, [], [], DLDataset)
create_dl_preprocess_param_from..."
60894594,micro,22,,"query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",107,111,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
* --- End of Automatically Added Context ---"
60894594,micro,23,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
set_system ('thread_num', 4)
endif
set_dl_model_param (DLModelHandle, 'device', DLDevice)",112,119,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'run..."
60894594,micro,24,,"set_dl_model_param (DLModelHandle, 'batch_size', TrainingBatchSize)",120,122,"* --- Automatically Added Context ---
TrainingBatchSize := 2
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
* --- End of Automatically Added Context ..."
60894594,micro,25,,"WindowDict := dict{}
for Index := 0 to 4 by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'bbox_ground_truth', [], WindowDict)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'ri...",123,133,"* --- Automatically Added Context ---
read_dict (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
60894594,micro,26,of set_dl_model_param () and get_dl_model_param ().,"set_dl_model_param (DLModelHandle, 'learning_rate', 0.001)",136,138,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
* --- End of Automatically Added Context ---"
60894594,micro,27,,"SerializationStrategy := dict{}
SerializationStrategy.type := 'best'
parse_filename (BestModelFilename, BaseName, Extension, Directory)
SerializationStrategy.basename := Directory + BaseName",139,144,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
BestModelFilename := OutputDir + '/model_best.hdl'
* --- End of Automatically Added Context ---"
60894594,micro,28,"For better model performance increase the number of epochs
from 20 to, e.g., 60.","create_dl_train_param (DLModelHandle, 20, 1, 'true', 42, 'serialize', SerializationStrategy, TrainParam)",145,148,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
SerializationStrategy := dict{}
* --- End of Automatically Added..."
60894594,micro,29,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",149,152,"* --- Automatically Added Context ---
read_dict (DatasetFilename, [], [], DLDataset)
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
create_dl_train_p..."
60894594,micro,30,,"read_dl_model (BestModelFilename, DLModelHandle)
set_dl_model_param (DLModelHandle, 'min_confidence', MinConfidence)",153,156,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
MinConfidence := 0.75
BestModelFilename := OutputDir + '/model_best.hdl'
create_dl_model_detection (Backbone, |DLDataset.class_..."
60894594,micro,31,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'device', DLDevice)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",157,166,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'run..."
60894594,micro,32,,"GenParamEval := dict{detailed_evaluation: true, show_progress: true}
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)",167,170,"* --- Automatically Added Context ---
read_dict (DatasetFilename, [], [], DLDataset)
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
* --- End of Auto..."
60894594,micro,33,,"MeanAP := EvaluationResult.max_num_detections_all.area_all.mean_ap
GenParams := dict{}
GenParams.display_mode := ['pie_charts_precision', 'pie_charts_recall']
GenParams.iou_threshold := 0.7
dev_display_detection_detailed_evaluation (EvaluationResult, EvalParams, GenParams, WindowDict)
dev_disp_text ...",171,181,"* --- Automatically Added Context ---
WindowDict := dict{}
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 't..."
60894594,micro,34,,"GenParams.display_mode := 'absolute_confusion_matrix'
dev_display_detection_detailed_evaluation (EvaluationResult, EvalParams, GenParams, WindowDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
dev_close_window_dict (WindowDict)",182,188,"* --- Automatically Added Context ---
WindowDict := dict{}
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
dev_disp_text ('Press F5 to continu..."
60894594,micro,35,"meaning, reduce its memory consumption.","set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",189,192,"* --- Automatically Added Context ---
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
* --- End of Automatically Added Context ---"
60894594,micro,36,,"write_dl_model (DLModelHandle, BestModelFilename)",193,195,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
BestModelFilename := OutputDir + '/model_best.hdl'
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModel..."
60894594,micro,37,the trained model to some randomly chosen test images.,"find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
TestSamples := DLDataset.samples[SampleIndices]
tuple_gen_const (|TestSamples|, '', ImageFiles)
for I := 0 to |TestSamples| - 1 by 1
TestSample := TestSamples[I]
ImageFiles[I] := TestSample.image_file_name
endfor
tuple_shuf...",198,208,"* --- Automatically Added Context ---
read_dict (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
60894594,micro,38,,"WindowDict := dict{}
get_dl_model_param (DLModelHandle, 'class_ids', ClassIds)
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
DLDatasetInfo := dict{class_ids: ClassIds, class_names: ClassNames}
for IndexInference := 0 to 9 by 1
read_image (Image, DLDataset.image_dir + '/' + ImageFiles...",209,225,"* --- Automatically Added Context ---
read_dict (DatasetFilename, [], [], DLDataset)
create_dl_model_detection (Backbone, |DLDataset.class_ids|, DLDetectionModelParam, DLModelHandle)
create_dl_preproc..."
60894594,micro,39,,"clean_up_output (OutputDir, RemoveResults)",226,241,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
RemoveResults := false
* --- End of Automatically Added Context ---"
60894594,micro,40,,"if (not RemoveResults)
return ()
endif",242,246,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
60894594,micro,41,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",247,255,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
60894594,micro,42,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",256,279,"* --- Automatically Added Context ---
OutputDir := './detect_pills_data'
* --- End of Automatically Added Context ---"
bb162745,full,0,"Multi-label classification workflow:
This example demonstrates how to train and evaluate
a multi-lab...","dev_close_window ()
dev_update_off ()
FileName := 'pill_defects.hdict'
load_dataset (FileName, DLDataset)
parse_filename (FileName, BaseName, _, _)
prepare_output_dir (BaseName, OutputDir)
ImageWidth := 224
ImageHeight := 224
BackboneModelFilename := 'pretrained_dl_classifier_resnet18.hdl'
load_and_...",15,868,
bb162745,micro,1,HALCON Operator Reference -&gt; DeepLearning -&gt; Multi-Label Classification.,"dev_close_window ()
dev_update_off ()",12,17,
bb162745,micro,2,"***               LOAD DATASET                    ***
**********************************************...","FileName := 'pill_defects.hdict'
load_dataset (FileName, DLDataset)",18,23,
bb162745,micro,3,"***              PREPARE OUTPUTDIR                ***
**********************************************...","parse_filename (FileName, BaseName, _, _)
prepare_output_dir (BaseName, OutputDir)",24,29,"* --- Automatically Added Context ---
FileName := 'pill_defects.hdict'
* --- End of Automatically Added Context ---"
bb162745,micro,4,"***             LOAD PRETRAINED MODEL             ***
**********************************************...","ImageWidth := 224
ImageHeight := 224",30,37,
bb162745,micro,5,"'pretrained_dl_classifier_resnet18.hdl', 'pretrained_dl_classifier_compact.hdl',
'pretrained_dl_clas...","BackboneModelFilename := 'pretrained_dl_classifier_resnet18.hdl'
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)",38,44,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
ImageWidth := 224
ImageHeight := 224
* --- End of Automatically Added Context ---"
bb162745,micro,6,"***                 INSPECT DATASET               ***
**********************************************...","create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)",45,49,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
bb162745,micro,7,,"InspectionSkip := false
NumInspectionSamples := 5
inspect_dataset (DLDataset, DLPreprocessParam, NumInspectionSamples, InspectionSkip)",50,54,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
* --- End of Automa..."
bb162745,micro,8,"***    PREPARE MODEL and DATASET FOR TRAINING     ***
**********************************************...",UseAugmentation := true,55,59,
bb162745,micro,9,"Please observe the training error and increase this value for
real world applications.","NumEpochs := 10
prepare_dl_model_dataset_for_training (DLModelHandle, DLDataset, DLPreprocessParam, OutputDir, UseAugmentation, NumEpochs, TrainParam, BestModelFileName)",60,65,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
prepare_output_dir (BaseName, OutputDir)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename..."
bb162745,micro,10,"***                     TRAINING                  ***
**********************************************...","train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
clear_dl_model (DLModelHandle)
dev_close_window ()
dev_close_window ()",66,76,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
prepare_dl_model_dataset..."
bb162745,micro,11,"['mean_ap', 'accuracy', 'precision', 'recall', 'f_score', 'all']","EvaluationMetrics := ['mean_ap', 'f_score']
load_and_evaluate_dl_model (BestModelFileName, DLDataset, EvaluationMetrics, DLModelHandle)",80,84,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
prepare_dl_model_dataset..."
bb162745,micro,12,"***            INSPECT EVALUATION RESULT          ***
**********************************************...","InspectionSkip := false
NumInspectionSamples := 5
inspect_evaluation (DLModelHandle, DLDataset, NumInspectionSamples, InspectionSkip)",85,93,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
InspectionSkip := false
..."
bb162745,micro,13,"***                    INFERENCE                  ***
**********************************************...","NumTestSamples := 10
inference_on_test_samples (DLModelHandle, DLDataset, DLPreprocessParam, NumTestSamples)",94,101,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
create_dl_preprocess_par..."
bb162745,micro,14,"***                   REMOVE FILES                ***
**********************************************...","RemoveOutputs := true
clean_up_output (OutputDir, RemoveOutputs)",102,121,"* --- Automatically Added Context ---
prepare_output_dir (BaseName, OutputDir)
* --- End of Automatically Added Context ---"
bb162745,micro,15,,"if (not RemoveResults)
return ()
endif",122,126,
bb162745,micro,16,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",127,135,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
* --- End of Automatically Added Context ---"
bb162745,micro,17,,"remove_dir_recursively (OutputDir)
return ()",136,180,"* --- Automatically Added Context ---
prepare_output_dir (BaseName, OutputDir)
* --- End of Automatically Added Context ---"
bb162745,micro,18,"The compatible dataset format is described in the
HALCON Operator Reference (DeepLearning -&gt; Mult...","read_dl_dataset_multi_label_classification (FileName, [], [], DLDataset)
return ()
if (OptionalBaseName != '')
OptionalBaseName := '_' + OptionalBaseName
endif
OutputDir := 'mlc_data' + OptionalBaseName
file_exists (OutputDir, FolderExists)
if (not FolderExists)
make_dir (OutputDir)
endif
return ()",181,272,"* --- Automatically Added Context ---
FileName := 'pill_defects.hdict'
load_dataset (FileName, DLDataset)
prepare_output_dir (BaseName, OutputDir)
* --- End of Automatically Added Context ---"
bb162745,micro,19,,"create_dl_model_multi_label_classification (BackboneModelFilename, [], DLModelHandle)",273,275,"* --- Automatically Added Context ---
BackboneModelFilename := 'pretrained_dl_classifier_resnet18.hdl'
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHa..."
bb162745,micro,20,,"set_dl_model_param (DLModelHandle, 'class_ids', DLDataset.class_ids)
set_dl_model_param (DLModelHandle, 'class_names', DLDataset.class_names)",276,279,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatical..."
bb162745,micro,21,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)",280,282,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
bb162745,micro,22,,"set_dl_model_param (DLModelHandle, 'image_size', [ImageWidth,ImageHeight])",283,285,"* --- Automatically Added Context ---
ImageWidth := 224
ImageHeight := 224
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatic..."
bb162745,micro,23,"Specify the deep learning device runtime to work with.
Training supports GPU and CPU.","DeviceRuntime := ['gpu', 'cpu']
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",286,293,
bb162745,micro,24,,"DLDevice := DLDeviceHandles[0]
set_dl_model_param (DLModelHandle, 'device', DLDevice)
return ()",294,374,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|..."
bb162745,micro,25,"Note that if the batch size is increased, it is recommended to also
increase the number of epochs an...",BatchSize := 32,375,380,
bb162745,micro,26,undergo augmentation.,AugmentationRate := 75,381,384,
bb162745,micro,27,,"BrightnessVariation := 20
BrightnessVariationSpot := 20
ContrastVariation := 0.2
SaturationVariation := 0.2
RotateRange := 15",385,390,
bb162745,micro,28,These parameters determine the split percentages.,"SplitPercentageTrain := 80
SplitPercentageValidation := 10",391,395,
bb162745,micro,29,"'auto':  It will be determined if the data has to be recomputed.
'true':  Always preprocess the data...",OverwritePreprocessing := 'auto',396,402,
bb162745,micro,30,,"set_system ('seed_rand', 42)",403,405,
bb162745,micro,31,,"OutputDirPreprocessing := OutputDir + '/dlsample_files'
BestModelFileName := OutputDir + '/model_best.hdl'",406,408,"* --- Automatically Added Context ---
prepare_output_dir (BaseName, OutputDir)
prepare_dl_model_dataset_for_training (DLModelHandle, DLDataset, DLPreprocessParam, OutputDir, UseAugmentation, NumEpochs..."
bb162745,micro,32,"By default, an existing split is not overwritten.",OverwriteExistSplit := false,409,411,
bb162745,micro,33,,"DLSamples := DLDataset.samples
NotYetSplit := true",412,414,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
* --- End of Automatically Added Context ---"
bb162745,micro,34,,"if (OverwriteExistSplit != true)
for IndexSample := 0 to |DLSamples| - 1 by 1
get_dict_param (DLSamples[IndexSample], 'key_exists', 'split', SplitExists)
if (SplitExists)
NotYetSplit := false
break
endif
endfor
endif
if (NotYetSplit or OverwriteExistSplit)
split_dl_dataset (DLDataset, SplitPercentag...",415,430,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
SplitPercentageTrain := 80
SplitPercentageValidation := 10
OverwriteExistSplit := false
DLSamples := DLDataset.samples
NotYetSp..."
bb162745,micro,35,preprocessing parameters or the dataset have changed.,"preprocess_dl_dataset (DLDataset, OutputDirPreprocessing, DLPreprocessParam, dict{overwrite_files: OverwritePreprocessing}, DLDatasetFileName)",431,434,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
prepare_output_dir (BaseName, OutputDir)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [..."
bb162745,micro,36,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)",435,436,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
BatchSize := 32
* --- End of Automatically Added Context --..."
bb162745,micro,37,,"set_dl_model_param (DLModelHandle, 'learning_rate', 0.01)",437,439,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
bb162745,micro,38,,"SerializationStrategy := dict{['type']: 'best'}
parse_filename (BestModelFileName, BaseName, Extension, Directory)
SerializationStrategy.basename := Directory + BaseName",440,444,"* --- Automatically Added Context ---
parse_filename (FileName, BaseName, _, _)
prepare_dl_model_dataset_for_training (DLModelHandle, DLDataset, DLPreprocessParam, OutputDir, UseAugmentation, NumEpoch..."
bb162745,micro,39,,"if (UseAugmentation == true)
DLPreprocessParam.augmentation := 'true'
AugmentationParam := dict{augmentation_percentage: AugmentationRate, brightness_variation: BrightnessVariation, brightness_variation_spot: BrightnessVariationSpot, contrast_variation: ContrastVariation, saturation_variation: Satur...",445,453,"* --- Automatically Added Context ---
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
UseAugmentation := true
AugmentationRate := 75
Brightn..."
bb162745,micro,40,during visualization.,DisplayParam := dict{selected_percentage_train_samples: 10},454,457,
bb162745,micro,41,,"create_dl_train_param (DLModelHandle, NumEpochs, 1, 'true', 42, ['serialize', 'augment', 'display', 'evaluate_before_train'], [SerializationStrategy,AugmentationParam,DisplayParam,'true'], TrainParam)
return ()",458,556,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
NumEpochs := 10
prepare_dl_model_dataset_for_training (DLMo..."
bb162745,micro,42,"You could add the 'validation' split also for
additional insights.","EvaluationSplits := ['test', 'train']",568,572,
bb162745,micro,43,"samples to be evaluated. If -1 is specified the full split
is evaluated.","EvaluationSplitsMaxNumSamples := [-1, 1000]",573,577,
bb162745,micro,44,,"read_dl_model (ModelFilename, DLModelHandle)",578,580,"* --- Automatically Added Context ---
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
bb162745,micro,45,,"for I := 0 to |EvaluationSplits| - 1 by 1
EvaluationSplit := EvaluationSplits[I]
if (|EvaluationSplitsMaxNumSamples| &gt; 1)
MaxNumSamples := EvaluationSplitsMaxNumSamples[I]
else
MaxNumSamples := EvaluationSplitsMaxNumSamples
endif
EvalGenParams := dict{measures: 'all', interpolate_pr_curves: true,...",581,689,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
dev_disp_text ('Press F5..."
bb162745,micro,46,,"find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
tuple_shuffle (SampleIndices, SampleIndices)
NumSamples := min2(|SampleIndices|,NumSamples)",692,695,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
find_dl_samples (DLDataset.samples, 'split', EvaluationSplit, 'match', SampleIndices)
* --- End of Automatically Added Context ..."
bb162745,micro,47,,"ImagePaths := []
for Index := 0 to NumSamples - 1 by 1
Sample := DLDataset.samples[SampleIndices[Index]]
ImagePaths[Index] := DLDataset.image_dir + '/' + Sample.image_file_name
endfor
WindowHandleDict := dict{}",696,703,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
find_dl_samples (DLDataset.samples, 'split', EvaluationSplit, 'match', SampleIndices)
WindowHandleDict := dict{}
NumSamples := ..."
bb162745,micro,48,,"for IndexInference := 0 to NumSamples - 1 by 1
read_image (Image, ImagePaths[IndexInference])
gen_dl_samples_from_images (Image, DLSampleInference)
preprocess_dl_samples (DLSampleInference, DLPreprocessParam)
apply_dl_model (DLModelHandle, DLSampleInference, [], DLResult)
dev_display_dl_data (DLSamp...",704,773,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
create_dl_preprocess_par..."
bb162745,micro,49,,"if (InspectionSkip)
return ()
endif",774,778,"* --- Automatically Added Context ---
InspectionSkip := false
* --- End of Automatically Added Context ---"
bb162745,micro,50,,"WindowDict := dict{}
for Index := 1 to InspectionCount by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
gen_dl_samples (DLDataset, SampleIndex, 'multi_label_classification', [], DLSample)
preprocess_dl_samples (DLSample, DLPreprocessParam)
dev_display_dl_data (DLSample, [], DLDataset, ...",779,850,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
dev_disp_text ('Pre..."
bb162745,micro,51,,"find_dl_samples (DLDataset.samples, 'split', 'validation', 'match', SampleIndices)
tuple_shuffle (SampleIndices, SampleIndices)
WindowHandleDict := dict{}
for IndexInference := 0 to min2(|SampleIndices| - 1,NumInspectionSamples - 1) by 1
Sample := DLDataset.samples[SampleIndices[IndexInference]]
rea...",856,919,"* --- Automatically Added Context ---
load_dataset (FileName, DLDataset)
load_and_intialize_dl_model (DLDataset, ImageWidth, ImageHeight, BackboneModelFilename, DLModelHandle)
NumInspectionSamples := ..."
40421a65,full,0,"Deep learning segmentation workflow:
This example shows the overall workflow for
deep learning segme...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ImageDir := 'pill'
SegmentationDir := 'labels/pill'
OutputDir := 'segment_pill_defects_data'
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]
RemoveResults := false
read_dl_dataset_segmentation (ImageDir, Segmen...",19,186,
40421a65,micro,1,"- This is a bare-bones example.
- For this, default parameters are used as much as possible.
Hence, ...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)",12,22,
40421a65,micro,2,,"ImageDir := 'pill'
SegmentationDir := 'labels/pill'
OutputDir := 'segment_pill_defects_data'
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]",23,31,
40421a65,micro,3,,RemoveResults := false,32,34,
40421a65,micro,4,,"read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
split_dl_dataset (DLDataset, 60, 20, [])",37,39,"* --- Automatically Added Context ---
ImageDir := 'pill'
SegmentationDir := 'labels/pill'
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]
* --- End of Automatically Added Contex..."
40421a65,micro,5,,"PreprocessSettings := dict{overwrite_files: 'auto'}
create_dl_preprocess_param ('segmentation', 400, 400, 3, -127, 128, 'none', 'full_domain', [], [], [], [], DLPreprocessParam)
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, PreprocessSettings, DLDatasetFileName)",40,44,"* --- Automatically Added Context ---
OutputDir := 'segment_pill_defects_data'
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
* --- End of Automa..."
40421a65,micro,6,,"WindowDict := dict{}
find_dl_samples (DLDataset.samples, 'split', 'train', 'match', TrainSampleIndices)
for Index := 0 to 9 by 1
SampleIndex := TrainSampleIndices[round(rand(1) * (|TrainSampleIndices| - 1))]
read_dl_samples (DLDataset, SampleIndex, DLSample)
dev_display_dl_data (DLSample, [], DLData...",45,56,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
* --- End of Automatically Added Context ---"
40421a65,micro,7,according to the dataset.,"read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
set_dl_model_param_based_on_preprocessing (DLModelHandle, DLPreprocessParam, ClassIDs)
set_dl_model_param (DLModelHandle, 'class_names', ClassNames)",59,63,"* --- Automatically Added Context ---
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]
create_dl_preprocess_param ('segmentation', 400, 400, 3, -127, 128, 'none', 'full_domain', ..."
40421a65,micro,8,"Training can be performed on a GPU or CPU.
See the respective system requirements in the Installatio...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",64,73,
40421a65,micro,9,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",74,83,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
40421a65,micro,10,Lower batch sizes decrease the amount of memory consumed.,"set_dl_model_param (DLModelHandle, 'batch_size', 4)
set_dl_model_param (DLModelHandle, 'learning_rate', 0.0001)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",84,89,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDev..."
40421a65,micro,11,"For better model performance increase the number of epochs
and train as long as your compute budget ...","create_dl_train_param (DLModelHandle, 10, 1, 'true', 42, [], [], TrainParam)",90,94,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
40421a65,micro,12,is done using the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)",95,98,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLM..."
40421a65,micro,13,,"read_dl_model ('model_best.hdl', DLModelHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_close_window ()
dev_close_window ()",99,106,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
* ---..."
40421a65,micro,14,,"GenParamEval := dict{show_progress: true}
GenParamEval.measures := ['mean_iou', 'pixel_accuracy', 'class_pixel_accuracy', 'pixel_confusion_matrix']
set_dl_model_param (DLModelHandle, 'device', DLDevice)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, Eva...",107,120,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
WindowDict := dict{}
dev_disp_text ('Press F5 to continue', ..."
40421a65,micro,15,"meaning, reduce its memory consumption.","set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'batch_size', 1)",121,124,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
40421a65,micro,16,,"write_dl_model (DLModelHandle, 'model_best.hdl')",125,127,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_segmentation_compact.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
40421a65,micro,17,trained model to some randomly chosen example images.,"list_image_files (ImageDir, 'default', 'recursive', ImageFiles)
tuple_shuffle (ImageFiles, ImageFilesShuffled)",130,134,"* --- Automatically Added Context ---
ImageDir := 'pill'
* --- End of Automatically Added Context ---"
40421a65,micro,18,,"WindowDict := dict{}
DLDatasetInfo := dict{}
get_dl_model_param (DLModelHandle, 'class_ids', DLDatasetInfo.class_ids)
get_dl_model_param (DLModelHandle, 'class_names', DLDatasetInfo.class_names)
for IndexInference := 0 to 9 by 1
read_image (Image, ImageFilesShuffled[IndexInference])
gen_dl_samples_f...",135,151,"* --- Automatically Added Context ---
create_dl_preprocess_param ('segmentation', 400, 400, 3, -127, 128, 'none', 'full_domain', [], [], [], [], DLPreprocessParam)
WindowDict := dict{}
read_dl_samples..."
40421a65,micro,19,,"clean_up_output (OutputDir, RemoveResults)",152,167,"* --- Automatically Added Context ---
OutputDir := 'segment_pill_defects_data'
RemoveResults := false
* --- End of Automatically Added Context ---"
40421a65,micro,20,,"if (not RemoveResults)
return ()
endif",168,172,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
40421a65,micro,21,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",173,181,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
40421a65,micro,22,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",182,205,"* --- Automatically Added Context ---
OutputDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
e2b46853,full,0,"This example demonstrates the inference of the deep learning
edge extractor on low contrast and high...","dev_update_off ()
dev_close_window ()
ImageWidth := 384
ImageHeight := 384
dev_disp_description_intro ()
stop ()
dev_close_window ()
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this exa...",9,255,
e2b46853,micro,1,edge extractor on low contrast and high noise images.,"dev_update_off ()
dev_close_window ()",6,11,
e2b46853,micro,2,,"ImageWidth := 384
ImageHeight := 384
dev_disp_description_intro ()
stop ()
dev_close_window ()",12,19,
e2b46853,micro,3,"Inference can be done on a GPU or CPU. See the respective system requirements in the
Installation Gu...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",20,28,
e2b46853,micro,4,,DLDevice := DLDeviceHandles[0],29,31,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
e2b46853,micro,5,,"read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'image_dimensions', [ImageWidth,ImageHeight,1])
set_dl_model_param (DLModelHandle, 'device', DLDevice)
create_dl_preprocess_param_from_model (DLMod...",32,38,"* --- Automatically Added Context ---
ImageWidth := 384
ImageHeight := 384
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
* --- End..."
e2b46853,micro,6,,"read_image (Image, 'brake_disk/brake_disk_bike_01')
crop_rectangle1 (Image, Image, 25, 55, 470, 500)
zoom_image_size (Image, Image, ImageWidth, ImageHeight, 'constant')
dev_open_window (0, 0, ImageWidth, ImageHeight, 'black', WindowHandle)
set_display_font (WindowHandle, 15, 'mono', 'true', 'false')...",39,48,"* --- Automatically Added Context ---
ImageWidth := 384
ImageHeight := 384
* --- End of Automatically Added Context ---"
e2b46853,micro,7,,MinConfidence := 0.8,49,51,
e2b46853,micro,8,,"ScaleMult := [0.865, 0.43, 0.216, 0.085, 0.025]
ScaleAdd := [0, 60, 90, 120, 120]
for Index := 0 to |ScaleMult| - 1 by 1
scale_image (Image, ImageScaled, ScaleMult[Index], ScaleAdd[Index])
apply_dl_edge_extractor (ImageScaled, ConfidentEdgeRegion, DLModelHandle, DLPreprocessParam, MinConfidence)
ske...",52,78,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPrepr..."
e2b46853,micro,9,,"BlurSizes := [2:2:10]
for Index := 0 to |BlurSizes| - 1 by 1
mean_image (Image, ImageBlur, BlurSizes[Index], BlurSizes[Index])
apply_dl_edge_extractor (ImageBlur, ConfidentEdgeRegion, DLModelHandle, DLPreprocessParam, MinConfidence)
skeleton (ConfidentEdgeRegion, DLEdges)
DisplayText := 'Blur size: ...",79,103,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPrepr..."
e2b46853,micro,10,,"NoiseTypes := ['white', 'gradient', 'scanline']
NoiseLevels := [30:30:150]
for TypeIndex := 0 to |NoiseTypes| - 1 by 1
for LevelIndex := 0 to |NoiseLevels| - 1 by 1
add_noise (Image, ImageNoise, NoiseTypes[TypeIndex], NoiseLevels[LevelIndex])
apply_dl_edge_extractor (ImageNoise, ConfidentEdgeRegion,...",104,150,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPrepr..."
e2b46853,micro,11,on NoiseType and NoiseLevel.,"get_image_size (ImageInput, ImageWidth, ImageHeight)
if (NoiseType == 'white')
add_noise_white (ImageInput, ImageOutput, NoiseLevel)
elseif (NoiseType == 'gradient')
gen_image_const (ImageNoise1, 'real', ImageWidth, ImageHeight)
gen_image_const (ImageNoise2, 'real', ImageWidth, ImageHeight)
add_nois...",151,239,"* --- Automatically Added Context ---
ImageWidth := 384
ImageHeight := 384
add_noise (Image, ImageNoise, NoiseTypes[TypeIndex], NoiseLevels[LevelIndex])
* --- End of Automatically Added Context ---"
e2b46853,micro,12,,"gen_dl_samples_from_images (Image, DLSample)
preprocess_dl_samples (DLSample, DLPreprocessParam)",243,246,"* --- Automatically Added Context ---
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
read_image (Image, 'brake_disk/brake_disk_bike_01')
Te..."
e2b46853,micro,13,,"apply_dl_model (DLModelHandle, DLSample, [], DLResult)
get_dict_object (SegmentationImage, DLResult, 'segmentation_image')
get_dict_object (SegmentationConfidence, DLResult, 'segmentation_confidence')
threshold (SegmentationImage, DLEdgeRegion, 1, 255)
threshold (SegmentationConfidence, ConfidentReg...",247,267,"* --- Automatically Added Context ---
read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
MinConfidence := 0.8
apply_dl_edge_extractor (ImageScaled, ConfidentEdgeRegion, DLModelHandle, D..."
44521100,full,0,"This example demonstrates how the deep learning edge extraction model
can be retrained to extract ap...","dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ImageDir := 'fabrics'
LabelDir := 'labels/fabrics'
OutputDir := 'segment_edges_data'
ImageWidth := 208
ImageHeight := 208
ClassNames := ['background', 'edge']
ClassIDs := [0, 255]
RemoveResults := false
dev_disp_description_intro ()
...",9,240,
44521100,micro,1,can be retrained to extract application specific edges.,"dev_close_window ()
dev_update_off ()
set_system ('seed_rand', 42)
ImageDir := 'fabrics'
LabelDir := 'labels/fabrics'
OutputDir := 'segment_edges_data'",6,17,
44521100,micro,2,,"ImageWidth := 208
ImageHeight := 208",18,20,
44521100,micro,3,,"ClassNames := ['background', 'edge']
ClassIDs := [0, 255]",21,24,
44521100,micro,4,,"RemoveResults := false
dev_disp_description_intro ()
stop ()
dev_close_window ()",25,31,
44521100,micro,5,"Training can be performed on a GPU or CPU. See the respective system requirements
in the Installatio...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",32,40,
44521100,micro,6,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",41,49,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
44521100,micro,7,,"ImageList := 'fabrics_' + [1:10]$'.2d' + '.png'
read_dl_dataset_segmentation (ImageDir, LabelDir, ClassNames, ClassIDs, ImageList, [], [], DLDataset)",50,52,"* --- Automatically Added Context ---
ImageDir := 'fabrics'
LabelDir := 'labels/fabrics'
ClassNames := ['background', 'edge']
ClassIDs := [0, 255]
* --- End of Automatically Added Context ---"
44521100,micro,8,,"split_dl_dataset (DLDataset, 80, 20, [])
PreprocessSettings := dict{overwrite_files: 'auto'}
create_dl_preprocess_param ('segmentation', ImageWidth, ImageHeight, 1, -127, 128, 'none', 'full_domain', [], [], [], [], DLPreprocessParam)
preprocess_dl_dataset (DLDataset, OutputDir, DLPreprocessParam, Pr...",53,58,"* --- Automatically Added Context ---
OutputDir := 'segment_edges_data'
ImageWidth := 208
ImageHeight := 208
read_dl_dataset_segmentation (ImageDir, LabelDir, ClassNames, ClassIDs, ImageList, [], [], ..."
44521100,micro,9,,"WindowDict := dict{}
GenParam := dict{segmentation_exclude_class_ids: 0}
for Index := 0 to 9 by 1
read_dl_samples (DLDataset, Index, DLSample)
dev_display_dl_data (DLSample, [], DLDataset, 'segmentation_image_ground_truth', GenParam, WindowDict)
PreprocessingWindows := WindowDict.segmentation_image_...",59,73,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, LabelDir, ClassNames, ClassIDs, ImageList, [], [], DLDataset)
* --- End of Automatically Added Context ---"
44521100,micro,10,,"BatchSize := 2
LearningRate := 0.002
Momentum := 0.95
WeightPrior := 0.00001
NumEpoch := 200",74,80,
44521100,micro,11,,"read_dl_model ('pretrained_dl_edge_extractor.hdl', DLModelHandle)
set_dl_model_param_based_on_preprocessing (DLModelHandle, DLPreprocessParam, ClassIDs)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'learning_rate', LearningRate)
set_dl_model_param (D...",81,89,"* --- Automatically Added Context ---
ClassIDs := [0, 255]
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
create_dl_preprocess_para..."
44521100,micro,12,,"AugmentationParam := dict{augmentation_percentage: 70, mirror: 'rc'}
GenParamName := 'augment'
GenParamValue := AugmentationParam",90,94,
44521100,micro,13,The training is done by calling train_dl_model_batch () within the following procedure.,"create_dl_train_param (DLModelHandle, NumEpoch, 1, 'true', 73, GenParamName, GenParamValue, TrainParam)
train_dl_model (DLDataset, DLModelHandle, TrainParam, 0, TrainResults, TrainInfos, EvaluationInfos)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'left', 'black', [], [])
stop ()
dev_...",95,103,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, LabelDir, ClassNames, ClassIDs, ImageList, [], [], DLDataset)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', '..."
44521100,micro,14,,"read_dl_model ('model_best.hdl', DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl_model_param (DLModelHandle, 'device', DLDevice)",104,109,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model ('pretrained_dl_edge_extractor.h..."
44521100,micro,15,,"dev_open_window (0, 0, 460, 460, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('cyan')
NumImages := 10
for Index := 0 to NumImages - 1 by 1
read_image (Image, ImageDir + '/fabrics_' + (Index + 11)$'02')
zoom_image_size (Image, Image, ImageWidth, I...",110,221,"* --- Automatically Added Context ---
ImageDir := 'fabrics'
OutputDir := 'segment_edges_data'
ImageWidth := 208
ImageHeight := 208
RemoveResults := false
create_dl_preprocess_param ('segmentation', Im..."
44521100,micro,16,,"if (not RemoveResults)
return ()
endif",222,226,"* --- Automatically Added Context ---
RemoveResults := false
* --- End of Automatically Added Context ---"
44521100,micro,17,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",227,235,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_open_window (0, 0, 460, 460, 'black', WindowHandle)
* --- End of Automati..."
44521100,micro,18,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",236,249,"* --- Automatically Added Context ---
OutputDir := 'segment_edges_data'
* --- End of Automatically Added Context ---"
00665a96,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL segmentation. It ...","dev_update_off ()
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
if (ShowExampleScreens)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_segmentation_data (Examp...",18,1438,
00665a96,micro,1,,dev_update_off (),16,19,
00665a96,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,20,24,
00665a96,micro,3,,"dev_example_init (ShowExampleScreens, ExampleInternals)
if (ShowExampleScreens)
dev_display_screen_introduction_part_1 (ExampleInternals)
stop ()
dev_display_screen_introduction_part_2 (ExampleInternals)
stop ()
dev_display_screen_segmentation_data (ExampleInternals)
stop ()
dev_display_screen_split...",25,54,"* --- Automatically Added Context ---
ShowExampleScreens := true
* --- End of Automatically Added Context ---"
00665a96,micro,4,,ImageDir := 'pill',59,60,
00665a96,micro,5,,SegmentationDir := 'labels/pill',61,63,
00665a96,micro,6,,ExampleDataDir := 'segment_pill_defects_data',64,65,
00665a96,micro,7,This name will be extended by the image dimensions the dataset will have after preprocessing.,DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill_',66,68,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
00665a96,micro,8,,PreprocessParamFileBaseName := '/dl_preprocess_param.hdict',69,71,
00665a96,micro,9,,"ClassNames := ['good', 'contamination', 'crack']",76,77,
00665a96,micro,10,,"ClassIDs := [0, 1, 2]",78,80,
00665a96,micro,11,,"TrainingPercent := 70
ValidationPercent := 15",81,84,
00665a96,micro,12,"see read_dl_model () for the model of your choice.
Image dimensions the images are rescaled to durin...","ImageWidth := 400
ImageHeight := 400
ImageNumChannels := 3",85,91,
00665a96,micro,13,,"ImageRangeMin := -127
ImageRangeMax := 128",92,95,
00665a96,micro,14,,"NormalizationType := 'none'
DomainHandling := 'full_domain'
IgnoreClassIDs := []
SetBackgroundID := []
ClassIDsBackground := []",96,102,
00665a96,micro,15,This means that re-running the script results in the same split of DLDataset.,SeedRand := 42,103,106,
00665a96,micro,16,,"set_system ('seed_rand', SeedRand)",111,113,"* --- Automatically Added Context ---
SeedRand := 42
* --- End of Automatically Added Context ---"
00665a96,micro,17,,"read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)",114,116,"* --- Automatically Added Context ---
ImageDir := 'pill'
SegmentationDir := 'labels/pill'
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]
* --- End of Automatically Added Contex..."
00665a96,micro,18,,"split_dl_dataset (DLDataset, TrainingPercent, ValidationPercent, [])",117,119,"* --- Automatically Added Context ---
TrainingPercent := 70
ValidationPercent := 15
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
* --- End of A..."
00665a96,micro,19,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
make_dir (ExampleDataDir)
endif",124,129,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
00665a96,micro,20,,"create_dl_preprocess_param ('segmentation', ImageWidth, ImageHeight, ImageNumChannels, ImageRangeMin, ImageRangeMax, NormalizationType, DomainHandling, IgnoreClassIDs, SetBackgroundID, ClassIDsBackground, [], DLPreprocessParam)",130,132,"* --- Automatically Added Context ---
ImageWidth := 400
ImageHeight := 400
ImageNumChannels := 3
ImageRangeMin := -127
ImageRangeMax := 128
NormalizationType := 'none'
DomainHandling := 'full_domain'
..."
00665a96,micro,21,,DataDirectory := DataDirectoryBaseName + ImageWidth + 'x' + ImageHeight,133,135,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill_'
ImageWidth := 400
ImageHeight := 400
* --- End of Autom..."
00665a96,micro,22,,"GenParam := dict{overwrite_files: 'auto'}
preprocess_dl_dataset (DLDataset, DataDirectory, DLPreprocessParam, GenParam, DLDatasetFilename)",136,139,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill_'
read_dl_dataset_segmentation (ImageDir, SegmentationDir..."
00665a96,micro,23,,"PreprocessParamFile := DataDirectory + PreprocessParamFileBaseName
write_dict (DLPreprocessParam, PreprocessParamFile, [], [])",140,143,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DataDirectoryBaseName := ExampleDataDir + '/dldataset_pill_'
PreprocessParamFileBaseName := '/dl_preprocess_param.hd..."
00665a96,micro,24,,"find_dl_samples (DLDataset.samples, 'split', 'train', 'match', SampleIndices)
tuple_shuffle (SampleIndices, ShuffledIndices)
read_dl_samples (DLDataset, ShuffledIndices[0:9], DLSampleBatchDisplay)
WindowHandleDict := dict{}
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
dev_display_dl_data (DLSam...",150,164,"* --- Automatically Added Context ---
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
* --- End of Automatically Added Context ---"
00665a96,micro,25,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_next_example (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",165,186,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
00665a96,micro,26,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",187,193,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,27,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",194,198,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,28,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL segmentation. It uses the MVTec pill dataset.'
Text[|Text|] := ''
Text[|Text|] := 'The fo...",199,231,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
* --- End of Automatically Added Context ---"
00665a96,micro,29,,"try
GinsengPath := 'pill/ginseng/' + ['good/pill_ginseng_good_001', 'contamination/pill_ginseng_contamination_004', 'crack/pill_ginseng_crack_001']
MagnesiumPath := 'pill/magnesium/' + ['good/pill_magnesium_good_001', 'contamination/pill_magnesium_contamination_001', 'crack/pill_magnesium_crack_001'...",232,285,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text[|Text|] := 'The four parts are: '
* --- End of Automatically Added Context ---"
00665a96,micro,30,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",286,292,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,31,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)",293,297,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,32,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Images used in semantic segmentation need to be labeled pixel-wise.'
Text[|Text|] := ''
Text[|Text|] := 'Below, you see a few examples.'
Text[|Text|] := ''
Text[|Text|] := 'Here, we use a da...",298,312,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_dl_dataset_segmentation (ImageDir, SegmentationDir, ClassNames, ClassIDs, [], [], [], DLDataset)
Text..."
00665a96,micro,33,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')",313,317,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,34,,"read_image (MintGoodImage, 'pill/mint/good/pill_mint_good_001')
read_image (MintGoodSeg, 'labels/pill/mint/good/pill_mint_good_001_gt')
read_image (MintCrack1Image, 'pill/mint/crack/pill_mint_crack_001')
read_image (MintCrack1Seg, 'labels/pill/mint/crack/pill_mint_crack_001_gt')
read_image (MintCrac...",318,327,
00665a96,micro,35,,"create_dict (Sample1)
set_dict_object (MintGoodImage, Sample1, 'image')
set_dict_object (MintGoodSeg, Sample1, 'segmentation_image')
create_dict (Sample2)
set_dict_object (MintCrack1Image, Sample2, 'image')
set_dict_object (MintCrack1Seg, Sample2, 'segmentation_image')
create_dict (Sample3)
set_dict...",328,356,"* --- Automatically Added Context ---
ClassNames := ['good', 'contamination', 'crack']
ClassIDs := [0, 1, 2]
tile_images (Image, TiledImage, 3, 'horizontal')
get_image_size (TiledImage, Width, Height)..."
00665a96,micro,36,,"get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
set_display_font (WindowHandleLegend, 14, 'mono', 'true', 'false')
Text := 'Ground truth segmentation'
Text := [Text,'0 : good', '1 : contamination', '2 : crack']
get_dict_tuple (Output, 'color...",357,386,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'rig..."
00665a96,micro,37,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",387,393,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,38,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
dev_display_example_reset_windows (ExampleInternals)",394,397,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,39,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now, the dataset is ready to be preprocessed.'
Text[|Text|] := 'This can be done using \'preprocess_dl_dataset\'.'
Text[|Text|] := ''
Text[|Text|] := 'The most important preprocessing parame...",398,417,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'The four parts are: '
Text[|Text|] := 'This example ..."
00665a96,micro,40,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
set_window_param (WindowHandleImages, 'flush', 'false')",418,422,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
00665a96,micro,41,,"read_image (MintContImage, 'pill/mint/contamination/pill_mint_contamination_001')
read_image (MintContSeg, 'labels/pill/mint/contamination/pill_mint_contamination_001_gt')
read_image (MintCrackImage, 'pill/mint/crack/pill_mint_crack_001')
read_image (MintCrackSeg, 'labels/pill/mint/crack/pill_mint_c...",423,430,"* --- Automatically Added Context ---
read_image (MintContImage, 'pill/magnesium/contamination/pill_magnesium_contamination_001')
read_image (MintContSeg, 'labels/pill/magnesium/contamination/pill_mag..."
00665a96,micro,42,because the model expects 'real' images.,"convert_image_type (MintContImage, MintContImage, 'real')
convert_image_type (MintCrackImage, MintCrackImage, 'real')",431,435,"* --- Automatically Added Context ---
read_image (MintContImage, 'pill/magnesium/contamination/pill_magnesium_contamination_001')
read_image (MintCrackImage, 'pill/mint/crack/pill_mint_crack_001')
* -..."
00665a96,micro,43,,"RescaleRange := (128 + 127) / 255.0
scale_image (MintContImage, ImagesPreprocessedMintCont, RescaleRange, -127)
scale_image (MintCrackImage, ImagesPreprocessedMintCrack, RescaleRange, -127)
convert_image_type (MintContImage, MintContImage, 'byte')
convert_image_type (MintCrackImage, MintCrackImage, ...",436,443,"* --- Automatically Added Context ---
read_image (MintContImage, 'pill/magnesium/contamination/pill_magnesium_contamination_001')
read_image (MintCrackImage, 'pill/mint/crack/pill_mint_crack_001')
* -..."
00665a96,micro,44,Original images.,"create_dict (SampleOriginal1)
set_dict_object (MintContImage, SampleOriginal1, 'image')
set_dict_object (MintContSeg, SampleOriginal1, 'segmentation_image')
create_dict (SampleOriginal2)
set_dict_object (MintCrackImage, SampleOriginal2, 'image')
set_dict_object (MintCrackSeg, SampleOriginal2, 'segme...",444,455,"* --- Automatically Added Context ---
ClassIDs := [0, 1, 2]
read_image (MintContImage, 'pill/magnesium/contamination/pill_magnesium_contamination_001')
read_image (MintContSeg, 'labels/pill/magnesium/..."
00665a96,micro,45,,"create_dict (SamplePreprocessed1)
set_dict_object (ImagesPreprocessedMintCont, SamplePreprocessed1, 'image')
set_dict_object (MintContSeg, SamplePreprocessed1, 'segmentation_image')
create_dict (SamplePreprocessed2)
set_dict_object (ImagesPreprocessedMintCrack, SamplePreprocessed2, 'image')
set_dict...",456,466,"* --- Automatically Added Context ---
ClassIDs := [0, 1, 2]
read_image (MintContSeg, 'labels/pill/magnesium/contamination/pill_magnesium_contamination_001_gt')
read_image (MintCrackSeg, 'labels/pill/m..."
00665a96,micro,46,,"gen_tiled_segmentation_results_image (DLSamplesOriginal, ClassIDs, ClassNames, OutputOriginal)
get_dict_object (TiledImageOriginal, OutputOriginal, 'tiled')
gen_tiled_segmentation_results_image (DLSamplesPreprocessed, ClassIDs, ClassNames, OutputPreprocessed)
get_dict_object (TiledImagePreprocessed,...",467,471,"* --- Automatically Added Context ---
ClassIDs := [0, 1, 2]
DLSamplesOriginal := [SampleOriginal1,SampleOriginal2]
create_dict (SampleOriginal1)
create_dict (SampleOriginal2)
ClassNames := ['good', 'c..."
00665a96,micro,47,,"dev_clear_window ()
get_dict_tuple (ExampleInternals, 'window_images_width', WindowWidth)
get_dict_tuple (ExampleInternals, 'window_images_height', WindowHeight)
dev_set_part (0, 0, WindowHeight - 1, WindowWidth - 1)",472,476,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,48,"we take the original image size and adapt it to the scaled, and translated preprocessed images.","get_image_size (MintContImage, OriginalWidth, OriginalHeight)
ScaleWidth := OriginalWidth / real(UsedImageWidth)
ScaleHeight := OriginalHeight / real(UsedImageHeight)
hom_mat2d_identity (HomMat2DOriginal)
hom_mat2d_scale (HomMat2DOriginal, 0.4, 0.4, 0, 0, HomMat2DOriginal)
hom_mat2d_translate (HomMa...",477,488,"* --- Automatically Added Context ---
read_image (MintContImage, 'pill/magnesium/contamination/pill_magnesium_contamination_001')
UsedImageWidth := 400
UsedImageHeight := 400
get_dict_object (TiledIma..."
00665a96,micro,49,,"hom_mat2d_identity (HomMat2DProcessed)
hom_mat2d_scale (HomMat2DProcessed, ScaleWidth * 0.40, ScaleHeight * 0.40, 0, 0, HomMat2DProcessed)
hom_mat2d_translate (HomMat2DProcessed, 92, 460, HomMat2DProcessed)
affine_trans_image (TiledImagePreprocessed, ImageAffineProcessed, HomMat2DProcessed, 'constan...",489,524,"* --- Automatically Added Context ---
Text := 'Press Run (F5) to continue'
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
get_dict_tuple (ExampleInternals, ..."
00665a96,micro,50,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",525,531,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,51,,"TrainRatio := 0.7
ValRatio := 0.15
TestRatio := 1.0 - TrainRatio - ValRatio",532,536,
00665a96,micro,52,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",537,541,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,53,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
set_window_param (WindowHandleText, 'flush', 'false')
Text := 'The procedure \'split_dl_dataset\' splits the dataset'
Text[|Text|] := 'randomly into three subsets.'
Text[|Text|] := ''
Text[|Text|] :=...",542,558,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'The four parts are: '
Text[|Text|] := 'This example ..."
00665a96,micro,54,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_images_width', Width)
get_dict_tuple (ExampleInternals, 'window_images_height', Height)
dev_set_part (0, 0, Height, Width)",559,566,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_image_size (TiledImage, Width, Height)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandle..."
00665a96,micro,55,,"PieChartCenterRow := Height / 2.0
PieChartCenterCol := Width / 2.0
PieChartRadius := min([Width,Height]) * 0.425
Colors := ['#000088', '#0000aa', '#0000cc'] + 'ff'
pi := 4.0 * atan(1.0)
Ratios := [TrainRatio,ValRatio,TestRatio]
Text := ['Train', 'Validation', 'Test']
alpha := 0
dev_display_pie_chart...",567,621,"* --- Automatically Added Context ---
Text := 'Press Run (F5) to continue'
get_image_size (TiledImage, Width, Height)
get_dict_tuple (Output, 'colors', Colors)
TrainRatio := 0.7
ValRatio := 0.15
TestR..."
00665a96,micro,56,Some preprocessed data will be displayed at the end.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",622,628,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,57,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'The preprocessing steps will now be executed.'
Text[|Text|] := ''
Text[|Text|] := 'Reading and splitting the dataset can take a few seconds.'
Text[|Text|] := ''
Text[|Text|] := 'A variable i...",634,663,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'The four parts are: '
get_dict_tuple (ExampleInterna..."
00665a96,micro,58,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",664,670,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,59,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)",671,674,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,60,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now the first part \'Dataset preprocessing\' of the workflow'
Text[|Text|] := 'for DL segmentation is finished.'
Text[|Text|] := ''
Text[|Text|] := 'The dataset is ready for training. '
Text...",675,709,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'the workflow for DL segmentation. It uses the MVTec ..."
00665a96,micro,61,,"SegTransparency := 'aa'
get_dl_class_colors (ClassNames, Colors)
Colors := Colors + SegTransparency",710,714,"* --- Automatically Added Context ---
get_dict_tuple (Output, 'colors', Colors)
ClassNames := ['good', 'contamination', 'crack']
* --- End of Automatically Added Context ---"
00665a96,micro,62,,"gen_empty_obj (Visualizations)
gen_empty_obj (ImagesOriginal)
gen_empty_obj (ImagesGroundTruth)
gen_empty_obj (ImagesApply)
for I := 0 to |DLSamples| - 1 by 1
Sample := DLSamples[I]
get_dict_param (Sample, 'key_exists', 'segmentation_image', GTExists)
if (GTExists)
get_dict_object (SegmentationImage...",715,831,"* --- Automatically Added Context ---
ClassIDs := [0, 1, 2]
tile_images (Image, TiledImage, 3, 'horizontal')
get_image_size (TiledImage, Width, Height)
DLSamples := [Sample1,Sample2,Sample3,Sample4]
g..."
00665a96,micro,63,NumColors.,"if (NumColors &lt; 1)
throw ('NumColors should be at least 1')
endif
if (not is_int(NumColors))
throw ('NumColors should be of type int')
endif
if (|NumColors| != 1)
throw ('NumColors should have length 1')
endif",835,845,
00665a96,micro,64,,"if (Random != 0 and Random != 1)
tuple_is_string (Random, IsString)
if (IsString)
Random := Random == 'true' or 'false'
else
throw ('Random should be either true or false')
endif
endif",846,854,
00665a96,micro,65,,"if (|StartColor| != 1)
throw ('StartColor should have length 1')
endif
if (StartColor &lt; 0 or StartColor &gt; 255)
throw ('StartColor should be in the range [0, 255]')
endif
if (not is_int(StartColor))
throw ('StartColor should be of type int')
endif",855,864,
00665a96,micro,66,,"if (|EndColor| != 1)
throw ('EndColor should have length 1')
endif
if (EndColor &lt; 0 or EndColor &gt; 255)
throw ('EndColor should be in the range [0, 255]')
endif
if (not is_int(EndColor))
throw ('EndColor should be of type int')
endif",865,875,
00665a96,micro,67,,"if (StartColor &gt; EndColor)
EndColor := EndColor + 255
endif
if (NumColors != 1)
Hue := (StartColor + int((EndColor - StartColor) * real([0:NumColors - 1]) / real(NumColors - 1))) % 255
else
Hue := mean([StartColor,EndColor])
endif
if (Random)
Hue := Hue[sort_index(rand(NumColors))]
Lightness := i...",876,893,"* --- Automatically Added Context ---
if (NumColors &lt; 1)
if (Random != 0 and Random != 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
* --- End of Automatically Added Context ---"
00665a96,micro,68,,"gen_image_const (HLSImageH, 'byte', 1, NumColors)
gen_image_const (HLSImageL, 'byte', 1, NumColors)
gen_image_const (HLSImageS, 'byte', 1, NumColors)
get_region_points (HLSImageH, Rows, Columns)
set_grayval (HLSImageH, Rows, Columns, Hue)
set_grayval (HLSImageL, Rows, Columns, Lightness)
set_grayval...",894,902,"* --- Automatically Added Context ---
get_region_points (RegionsSelected, Rows, Columns)
if (NumColors &lt; 1)
if (|StartColor| != 1)
if (|EndColor| != 1)
Hue := (StartColor + int((EndColor - StartCol..."
00665a96,micro,69,,"trans_to_rgb (HLSImageH, HLSImageL, HLSImageS, ImageR, ImageG, ImageB, 'hls')",903,905,"* --- Automatically Added Context ---
gen_image_proto (TiledImage, ImageR, 18)
gen_image_proto (TiledImage, ImageG, 22)
gen_image_proto (TiledImage, ImageB, 28)
gen_image_const (HLSImageH, 'byte', 1, ..."
00665a96,micro,70,,"get_grayval (ImageR, Rows, Columns, Red)
get_grayval (ImageG, Rows, Columns, Green)
get_grayval (ImageB, Rows, Columns, Blue)
Colors := '#' + Red$'02x' + Green$'02x' + Blue$'02x'
return ()",906,992,"* --- Automatically Added Context ---
gen_image_proto (TiledImage, ImageR, 18)
gen_image_proto (TiledImage, ImageG, 22)
gen_image_proto (TiledImage, ImageB, 28)
get_dict_tuple (Output, 'colors', Color..."
00665a96,micro,71,,NumColors := |ClassNames|,997,998,"* --- Automatically Added Context ---
ClassNames := ['good', 'contamination', 'crack']
if (NumColors &lt; 1)
* --- End of Automatically Added Context ---"
00665a96,micro,72,We use a workaround to get deterministic colors where subsequent colors are distinguishable.,"get_distinct_colors (NumColors, false, 0, 200, ColorsRainbow)
tuple_inverse (ColorsRainbow, ColorsRainbow)
make_neighboring_colors_distinguishable (ColorsRainbow, Colors)",999,1003,"* --- Automatically Added Context ---
get_dict_tuple (Output, 'colors', Colors)
if (NumColors &lt; 1)
* --- End of Automatically Added Context ---"
00665a96,micro,73,Only the first occurrence found is set to a green shade.,"ClassNamesGood := ['good', 'GOOD', 'ok', 'OK']
for IndexFind := 0 to |ClassNamesGood| - 1 by 1
GoodIdx := find_first(ClassNames,ClassNamesGood[IndexFind])
if (GoodIdx != -1 and |ClassNames| &lt;= 8)
CurrentColor := Colors[GoodIdx]
GreenIdx := floor(|ClassNames| / 2.0)
Colors[GoodIdx] := '#00ff00'
Co...",1004,1047,"* --- Automatically Added Context ---
get_dict_tuple (Output, 'colors', Colors)
ClassNames := ['good', 'contamination', 'crack']
* --- End of Automatically Added Context ---"
00665a96,micro,74,"to make adjacent colors more distinguishable.
Neighboring colors from the input are distributed to e...","NumColors := |ColorsRainbow|
if (NumColors &gt;= 8)
NumChunks := 3
if (NumColors &gt;= 40)
NumChunks := 6
elseif (NumColors &gt;= 20)
NumChunks := 4
endif
Colors := gen_tuple_const(NumColors,-1)
NumLeftOver := NumColors % NumChunks
ColorsPerChunk := int(NumColors / NumChunks)
StartIdx := 0
for S := ...",1048,1106,"* --- Automatically Added Context ---
get_dict_tuple (Output, 'colors', Colors)
if (NumColors &lt; 1)
get_distinct_colors (NumColors, false, 0, 200, ColorsRainbow)
* --- End of Automatically Added Con..."
00665a96,micro,75,and shows some image examples.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1107,1114,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,76,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'In this example we will explain how labeled data is'
Text[|Text|] := 'read to the expected format and preprocessed'
Text[|Text|] := 'to make it suitable for training.'
Text[|Text|] := ''
Tex...",1119,1131,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
Text[|Text|] := 'the workflow for DL segmentation. It uses the MVTec ..."
00665a96,micro,77,,"dev_display_pills_example_dataset_preview (ExampleInternals)
return ()",1132,1152,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,78,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_displ...",1155,1203,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of..."
00665a96,micro,79,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",1206,1217,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
for I := 0 to |DLSamples| - 1 by 1
* --- End of Automatically Added Context ---"
00665a96,micro,80,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",1218,1233,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
get_dict_tuple (ExampleInternals, 'window_images', Windo..."
00665a96,micro,81,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",1234,1257,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
get_dict_tuple (ExampleInternals, 'window_legend', Windo..."
00665a96,micro,82,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
ClearImageWindow := find(ClearWindows,WindowHandleImages)
if (ClearAllWindows or (|ClearImageWindow| and ClearImageWindow &gt; -1))
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
cat...",1258,1269,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (E..."
00665a96,micro,83,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
ClearLegendWindow := find(ClearWindows,WindowHandleLegend)
if (ClearAllWindows or (|ClearLegendWindow| and ClearLegendWindow &gt; -1))
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
endif
...",1270,1312,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
get_dict_tuple (ExampleInternals, 'wind..."
00665a96,micro,84,,"WindowWidthText := 800
WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
s...",1313,1345,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowWidthText := 800
WindowHeightText := 300
WindowBGColor := 'gray'
get_dict_tuple (ExampleInternals, '..."
00665a96,micro,85,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",1346,1370,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowWidth)
get_dict_tuple (ExampleInternals, 'w..."
00665a96,micro,86,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1371,1377,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
00665a96,micro,87,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'For semantic segmentation it is required to have for each'
Text[|Text|] := 'image a corresponding \'weight_image\', which'
Text[|Text|] := 'assigns each pixel in the image a specific weight....",1382,1420,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'Press Run (F5) to continue'
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'rig..."
00665a96,micro,88,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",1421,1453,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
for Index := 0 to |DLSampleBatchDisplay| - 1 by 1
catch (Exception)
* --- End o..."
8b4594fa,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL segmentation. It ...","dev_update_off ()
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDe...",21,1292,
8b4594fa,micro,1,segment_pill_defects_deep_learning_1_preprocess.hdev,"dev_update_off ()
ShowExampleScreens := true",18,24,
8b4594fa,micro,2,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",25,33,
8b4594fa,micro,3,,"DLDevice := DLDeviceHandles[0]
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceType == 'cpu')
NumThreadsTraining := 4
set_system ('thread_num', NumThreadsTraining)
endif",34,43,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatically Added Context ---"
8b4594fa,micro,4,,"if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction_train (ExampleInternals)
stop ()
dev_display_screen_error (ExampleInternals, Error)
if (Error)
stop ()
endif
dev_display_screen_model_selection (ExampleInternals)
stop ()
dev_display_scree...",44,106,"* --- Automatically Added Context ---
ShowExampleScreens := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
* --- End of Automa..."
8b4594fa,micro,5,"***   Set Input/Output paths.   ***
***********************************
All example data is written ...",ExampleDataDir := 'segment_pill_defects_data',107,111,
8b4594fa,micro,6,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'",112,115,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
8b4594fa,micro,7,,FinalModelBaseName := ExampleDataDir + '/final_dl_model_segmentation',116,117,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
8b4594fa,micro,8,,BestModelBaseName := ExampleDataDir + '/best_dl_model_segmentation',118,120,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
8b4594fa,micro,9,The segmentation model to be retrained.,ModelFileName := 'pretrained_dl_segmentation_enhanced.hdl',127,129,
8b4594fa,micro,10,Lower batch sizes decrease the amount of memory consumed.,BatchSize := 4,130,132,
8b4594fa,micro,11,,InitialLearningRate := 0.0001,133,134,
8b4594fa,micro,12,,Momentum := 0.99,135,137,
8b4594fa,micro,13,Number of epochs to train the model.,NumEpochs := 10,138,140,
8b4594fa,micro,14,,EvaluationIntervalEpochs := 1,141,142,
8b4594fa,micro,15,Set it to [] if the learning rate should not be changed.,ChangeLearningRateEpochs := [],143,145,
8b4594fa,micro,16,The tuple has to be of the same length as ChangeLearningRateEpochs.,ChangeLearningRateValues := [],146,149,
8b4594fa,micro,17,Use [] for default weight prior.,WeightPrior := [],156,159,
8b4594fa,micro,18,Control whether training progress is displayed (true/false).,EnableDisplay := true,160,162,
8b4594fa,micro,19,,"RandomSeed := 42
set_system ('seed_rand', RandomSeed)",163,166,
8b4594fa,micro,20,"(system, driver, cuda-version) you could specify ""cudnn_deterministic"" as
""true"". Note, that this co...","* set_system ('cudnn_deterministic', 'true')",167,171,
8b4594fa,micro,21,Please see the documentation of create_dl_train_param for an overview on all available parameters.,"GenParamName := []
GenParamValue := []",172,176,
8b4594fa,micro,22,"It is possible to change model parameters during training.
Here, we change the learning rate if spec...","if (|ChangeLearningRateEpochs| &gt; 0)
ChangeStrategy := dict{}
ChangeStrategy.model_param := 'learning_rate'
ChangeStrategy.initial_value := InitialLearningRate
ChangeStrategy.epochs := ChangeLearningRateEpochs
ChangeStrategy.values := ChangeLearningRateValues
GenParamName := [GenParamName,'change'...",177,194,"* --- Automatically Added Context ---
InitialLearningRate := 0.0001
ChangeLearningRateEpochs := []
ChangeLearningRateValues := []
GenParamName := []
GenParamValue := []
* --- End of Automatically Adde..."
8b4594fa,micro,23,"There are several options for saving intermediate models to disk (see create_dl_train_param).
Here, ...","SerializationStrategy := dict{['type']: 'best', basename: BestModelBaseName}
GenParamName := [GenParamName,'serialize']
GenParamValue := [GenParamValue,SerializationStrategy]
SerializationStrategy := dict{['type']: 'final', basename: FinalModelBaseName}
GenParamName := [GenParamName,'serialize']
Gen...",195,204,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
FinalModelBaseName := ExampleDataDir + '/final_dl_model_segmentation'
BestModelBaseName := ExampleDataDir + '/best_d..."
8b4594fa,micro,24,"In this example, the evaluation measure for the training spit is not displayed during
training (defa...",SelectedPercentageTrainSamples := 0,205,210,
8b4594fa,micro,25,,"XAxisLabel := 'epochs'
DisplayParam := dict{}
DisplayParam.selected_percentage_train_samples := SelectedPercentageTrainSamples
DisplayParam.x_axis_label := XAxisLabel
GenParamName := [GenParamName,'display']
GenParamValue := [GenParamValue,DisplayParam]",211,219,"* --- Automatically Added Context ---
GenParamName := []
GenParamValue := []
SelectedPercentageTrainSamples := 0
* --- End of Automatically Added Context ---"
8b4594fa,micro,26,,"check_data_availability (ExampleDataDir, DLDatasetFileName)",224,226,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'..."
8b4594fa,micro,27,,"read_dict (DLDatasetFileName, [], [], DLDataset)",227,228,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'..."
8b4594fa,micro,28,,"read_dl_model (ModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",229,233,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
ModelFileName := 'pretrained_dl_segmentation_e..."
8b4594fa,micro,29,,"DLPreprocessParam := DLDataset.preprocess_param
set_dl_model_param_based_on_preprocessing (DLModelHandle, DLPreprocessParam, DLDataset.class_ids)",238,241,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
read_dl_model (ModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
8b4594fa,micro,30,,"set_dl_model_param (DLModelHandle, 'learning_rate', InitialLearningRate)
set_dl_model_param (DLModelHandle, 'momentum', Momentum)",242,244,"* --- Automatically Added Context ---
InitialLearningRate := 0.0001
Momentum := 0.99
read_dl_model (ModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
8b4594fa,micro,31,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
if (|WeightPrior| &gt; 0)
set_dl_model_param (DLModelHandle, 'weight_prior', WeightPrior)
endif
set_dl_model_param (DLModelHandle, 'runtime_init', 'immediately')",245,251,"* --- Automatically Added Context ---
BatchSize := 4
WeightPrior := []
read_dl_model (ModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
8b4594fa,micro,32,,"create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIntervalEpochs, EnableDisplay, RandomSeed, GenParamName, GenParamValue, TrainParam)",256,258,"* --- Automatically Added Context ---
NumEpochs := 10
EvaluationIntervalEpochs := 1
EnableDisplay := true
RandomSeed := 42
GenParamName := []
GenParamValue := []
read_dl_model (ModelFileName, DLModelH..."
8b4594fa,micro,33,train_dl_model_batch () within the following procedure.,"train_dl_model (DLDataset, DLModelHandle, TrainParam, 0.0, TrainResults, TrainInfos, EvaluationInfos)",259,262,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
read_dl_model (ModelFileName, DLModelHandle)
create_dl_train_param (DLModelHandle, NumEpochs, EvaluationIntervalE..."
8b4594fa,micro,34,,"dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",263,266,
8b4594fa,micro,35,,"dev_close_window ()
dev_close_window ()",267,270,
8b4594fa,micro,36,,"if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",271,290,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,37,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",293,305,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,38,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",306,317,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,39,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",318,353,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
8b4594fa,micro,40,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()",356,363,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,41,,"WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
set_dict_tuple (Example...",364,375,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
8b4594fa,micro,42,,"WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (WindowHandleImages, 16, 'mono', 'true', 'false')
set_dict_tuple (ExampleInternals, 'window_images', Wind...",376,418,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
WindowHeightText := 330
WindowWidth..."
8b4594fa,micro,43,and shows some image examples.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",419,426,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,44,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)",427,430,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,45,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL segmentation. It uses the MVTec pill dataset.'
Text[|Text|] := ''
Text[|Text|] := 'The fo...",431,464,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
get_dict_tuple ..."
8b4594fa,micro,46,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",465,471,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,47,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'HALCON provides two pretrained segmentation models '
Text[|Text|] := 'ready to be retrained for a specific application:'
Text[|Text|] := ' - pretrained_dl_segmentation_compact.hdl'
Text[|Tex...",476,517,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
get_dict_tuple ..."
8b4594fa,micro,48,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",518,524,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,49,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
dev_display_example_reset_windows (ExampleInternals)",525,528,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,50,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '--&gt; 1.) The \'loss\' is commonly used to optimize the model on the '
Text[|Text|] := '        ...",529,548,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,51,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_seg_goals_loss')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_display ...",549,589,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
8b4594fa,micro,52,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",590,596,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,53,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'There are multiple model and training parameters.'
Text[|Text|] := ''
Text[|Text|] := 'To set the model parameters \'set_dl_model_param\' is used.'
Text[|Text|] := 'The training parameters a...",601,639,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,54,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandle)
if (|WindowHandle| &gt; 0)
dev_set_window (WindowHandle)
dev_close_window ()
endif
return ()",640,661,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,55,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",662,668,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,56,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := []
Text[|Text|] := 'Now, the training of the model will start.'
Text[|Tex...",669,711,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,57,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",712,718,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,58,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'batch_size\''
Text[|Text|] := ''
Text[|Text|] := 'The dataset is divided into smaller subsets of data which are called'
Text[|Text|] := 'batches. The \'batch_size\' determ...",723,755,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,59,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",756,762,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,60,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Model parameter: \'learning_rate\''
Text[|Text|] := ''
Text[|Text|] := 'The \'learning_rate\' determines the size of the steps for optimizing'
Text[|Text|] := 'the loss function:'
Text[|Text...",767,785,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,61,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_learning_rate_curves')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_di...",786,816,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
read_image (ImageLoss, 'dl_explanat..."
8b4594fa,micro,62,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",817,823,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,63,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Training parameter: \'num_epochs\''
Text[|Text|] := ''
Text[|Text|] := 'During an epoch the entire training data is used once.'
Text[|Text|] := ''
Text[|Text|] := 'The number of epochs depen...",828,861,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,64,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",862,868,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,65,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Additionally, there are more advanced parameters that can be specified'
Text[|Text|] := 'to enhance the training process, for example parameters for:'
Text[|Text|] := ''
Text[|Text|] := '   ...",873,905,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '3. Evaluation of..."
8b4594fa,micro,66,Display an error if this is not the case.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",906,913,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,67,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",918,921,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
8b4594fa,micro,68,,"DataDirectory := 'segment_pill_defects_data/dldataset_pill_400x400'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'",922,924,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'..."
8b4594fa,micro,69,,"file_exists (DLDatasetFileName, DataExists)
Error := false
if (not DataExists)
Error := true
ErrorText := []
ErrorText[|ErrorText|] := 'To run this example you need the output of:'
ErrorText[|ErrorText|] := ' - \'segment_pill_defects_deep_learning_1_preprocess.hdev\''
ErrorText[|ErrorText|] := 'Plea...",925,957,"* --- Automatically Added Context ---
dev_display_screen_error (ExampleInternals, Error)
ExampleDataDir := 'segment_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
Text[..."
8b4594fa,micro,70,"'segment_pill_defects_deep_learning_3_evaluate.hdev' and
'segment_pill_defects_deep_learning_4_infer...","get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",958,966,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,71,,"dev_open_text_window (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'Now, the second part \'Training of the model\' of the workflow'
Text[|Text|] := 'for DL segmentation is finished.'
Text[|Text|] := ''
Text[|Text|] := ...",971,1006,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for..."
8b4594fa,micro,72,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",1007,1013,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,73,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'After the parameters are set, the model can be trained'
Text[|Text|] := 'on the dataset with the procedure \'train_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'During the training the be...",1018,1046,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example cov..."
8b4594fa,micro,74,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'While training there are two main goals to be achieved:'
Text[|Text|] := ''
Text[|Text|] := '    1.) The \'loss\' is commonly used as to optimize the model on the'
Text[|Text|] := '        t...",1058,1077,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
8b4594fa,micro,75,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
set_part_style (WindowHandleImages, 1)
dev_set_window (WindowHandleImages)
read_image (ImageLoss, 'dl_explanation/training_seg_goals_mean_iou')
get_image_size (ImageLoss, Width, Height)
dev_set_part (0, 0, Height, Width)
dev_disp...",1078,1111,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_image (ImageLoss, 'dl_explanation/training_seg_goals_loss')
dev_disp_text ('Epochs', 'image', 470, 12..."
8b4594fa,micro,76,,"WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
s...",1112,1142,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowWidthText := 800
WindowHeightText := 330
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGC..."
8b4594fa,micro,77,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",1143,1168,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Auto..."
8b4594fa,micro,78,,"WindowWidthText := 800
WindowHeightText := 300
WindowWidthImage := 800
WindowHeightImages := 400
WindowBGColor := 'gray'
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
set_dict_tuple (Example...",1169,1195,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
WindowWidthText := 800
WindowHeightText..."
8b4594fa,micro,79,,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of the example series.')
endif
file_exists (DLDatasetFileName, FileExists)
if (not FileExists)
throw (DLDatasetFileName + ' does not exist. Please run part 1 of the example series...",1196,1223,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'..."
8b4594fa,micro,80,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",1224,1263,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleIn..."
8b4594fa,micro,81,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",1266,1270,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
8b4594fa,micro,82,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",1271,1302,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
6c5289c5,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL segmentation. It ...","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",22,1202,
6c5289c5,micro,1,segment_pill_defects_deep_learning_2_train.hdev,dev_update_off (),19,23,
6c5289c5,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,24,28,
6c5289c5,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,29,33,
6c5289c5,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",34,42,
6c5289c5,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
dev_display_screen_evaluation_measures (ExampleInternals)
stop ()
dev_display_screen_mean_iou (ExampleInternal...",43,79,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
6c5289c5,micro,6,,ExampleDataDir := 'segment_pill_defects_data',86,87,
6c5289c5,micro,7,Note: Adapt DataDirectory after preprocessing with another image size.,"DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
if (UsePretrainedModel)
RetrainedModelFileName := 'segment_pill_defects.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model_segmentation.hdl'
endif",88,100,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
6c5289c5,micro,8,,"SegmentationMeasures := ['mean_iou', 'pixel_accuracy', 'class_pixel_accuracy', 'pixel_confusion_matrix']",103,104,
6c5289c5,micro,9,,BatchSize := 1,105,107,
6c5289c5,micro,10,,NumDisplay := 10,108,110,
6c5289c5,micro,11,,"check_data_availability (ExampleDataDir, DLDatasetFileName, RetrainedModelFileName, UsePretrainedModel)",115,117,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'segment_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
RetrainedModelFileName := 'segme..."
6c5289c5,micro,12,,"read_dl_model (RetrainedModelFileName, DLModelHandle)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
set_dl_model_param (DLModelHandle, 'device', DLDevice)",118,124,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
RetrainedModelFileName := 'segment_pill_defect..."
6c5289c5,micro,13,,"read_dict (DLDatasetFileName, [], [], DLDataset)",125,127,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'..."
6c5289c5,micro,14,,"GenParamEval := dict{measures: SegmentationMeasures, show_progress: 'true'}",128,130,"* --- Automatically Added Context ---
SegmentationMeasures := ['mean_iou', 'pixel_accuracy', 'class_pixel_accuracy', 'pixel_confusion_matrix']
* --- End of Automatically Added Context ---"
6c5289c5,micro,15,,"evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)",131,134,"* --- Automatically Added Context ---
SegmentationMeasures := ['mean_iou', 'pixel_accuracy', 'class_pixel_accuracy', 'pixel_confusion_matrix']
read_dl_model (RetrainedModelFileName, DLModelHandle)
rea..."
6c5289c5,micro,16,,"WindowHandleDict := dict{}
GenParamEvalDisplay := dict{display_mode: ['measures', 'absolute_confusion_matrix']}
dev_display_segmentation_evaluation (EvaluationResult, EvalParams, GenParamEvalDisplay, WindowHandleDict)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black',...",139,146,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
* --- End of Automatically Added Context ---"
6c5289c5,micro,17,,dev_close_window_dict (WindowHandleDict),147,150,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
6c5289c5,micro,18,"by visual inspection of images.
Select test images randomly.","find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
tuple_shuffle (SampleIndices, ShuffledIndices)",155,159,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
* --- End of Automatically Added Context ---"
6c5289c5,micro,19,,"read_dl_samples (DLDataset, ShuffledIndices[0:NumDisplay - 1], DLSampleBatch)",160,162,"* --- Automatically Added Context ---
NumDisplay := 10
read_dict (DLDatasetFileName, [], [], DLDataset)
tuple_shuffle (SampleIndices, ShuffledIndices)
* --- End of Automatically Added Context ---"
6c5289c5,micro,20,,"WindowHandleDict := dict{}
GenParamDisplay := dict{}
GenParamDisplay.segmentation_exclude_class_ids := 0
GenParamDisplay.segmentation_transparency := '80'",163,168,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
6c5289c5,micro,21,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)",169,171,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
6c5289c5,micro,22,,"for SampleIndex := 0 to NumDisplay - 1 by 1
apply_dl_model (DLModelHandle, DLSampleBatch[SampleIndex], [], DLResult)
dev_display_dl_data (DLSampleBatch[SampleIndex], DLResult, DLDataset, ['segmentation_image_ground_truth', 'segmentation_image_result'], GenParamDisplay, WindowHandleDict)
dev_display_...",172,184,"* --- Automatically Added Context ---
NumDisplay := 10
read_dl_model (RetrainedModelFileName, DLModelHandle)
read_dict (DLDatasetFileName, [], [], DLDataset)
read_dl_samples (DLDataset, ShuffledIndice..."
6c5289c5,micro,23,,dev_close_window_dict (WindowHandleDict),185,187,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
6c5289c5,micro,24,,"set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
write_dl_model (DLModelHandle, RetrainedModelFileName)",188,190,"* --- Automatically Added Context ---
RetrainedModelFileName := 'segment_pill_defects.hdl'
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
6c5289c5,micro,25,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",191,213,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added..."
6c5289c5,micro,26,,"WindowHeightText := 300
WindowWidthImage := 500
WindowHeightImages := 500
WindowBGColor := 'gray'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Window...",214,248,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,27,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
set_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
WindowWidthText := 800
WindowHeightText := 300
Wi...",251,299,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHeightText := 300
WindowBG..."
6c5289c5,micro,28,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",300,306,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,29,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",307,313,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
6c5289c5,micro,30,,"Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL segmentation.'
Text[|Text|] := ''
Text[|Text|] := 'The four parts are: '
Text[|Text|] := '1. Dataset preprocessing.'
Text[|Text|] := '2. Training of the model.'
Text[|Text|] := '3. Evaluatio...",314,343,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', 'box', 'true')
* --- End of Automatically Added Context ---"
6c5289c5,micro,31,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",344,350,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,32,,ExampleDataDir := 'segment_pill_defects_data',351,353,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
6c5289c5,micro,33,,"DLDatasetCacheFile := ExampleDataDir + '/dldataset_pill_400x400/dl_dataset.hdict'
get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
RetrainedModelFileName := 'segment_pill_defects.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model...",354,411,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
RetrainedModelFileName := 'segment_pill_defects.hdl'
dev_op..."
6c5289c5,micro,34,,"set_dict_tuple (ExampleInternals, 'dl_dataset', DLDatasetCacheFile)
set_dict_tuple (ExampleInternals, 'retrained_model_file_names', RetrainedModelFileName)",412,415,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
ExampleDataDir := 'segment_pill_defects_data'
RetrainedModelFileName := 'segment_pill_..."
6c5289c5,micro,35,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",416,423,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
6c5289c5,micro,36,,"Text := 'The evaluation of a segmentation model is performed by '
Text[|Text|] := 'the procedure \'evaluate_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'In semantic segmentation each pixel is assigned a class ID.'
Text[|Text|] := 'Therefore, the evaluation is based on pixel-level measures.'
Text...",424,452,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', 'box', 'true')
Text := 'This example is part of a series of examples, which sum..."
6c5289c5,micro,37,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",453,477,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,38,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",478,503,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (WindowImagesY, WindowImagesX + WindowImagesWidth + 5, WindowWidth, Wi..."
6c5289c5,micro,39,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",504,529,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, W..."
6c5289c5,micro,40,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",532,543,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
catch (Exception)
* --- End of Automatically Added Context ---"
6c5289c5,micro,41,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",544,555,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,42,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",556,567,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHand..."
6c5289c5,micro,43,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 800, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",568,578,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, W..."
6c5289c5,micro,44,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",579,614,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
6c5289c5,micro,45,evaluation example.,"file_exists (ExampleDataDir, FileExists)
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run part 1 of example series.')
endif
file_exists (DLDatasetFileName, FileExists)
if (not FileExists)
throw (DLDatasetFileName + ' does not exist. Please run part 1 of example series.')
endi...",615,654,"* --- Automatically Added Context ---
UsePretrainedModel := true
DLDatasetFileName := DataDirectory + '/dl_dataset.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
ExampleDataDir := ..."
6c5289c5,micro,46,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",655,662,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,47,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",663,670,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, WindowBGColor, WindowHandleT..."
6c5289c5,micro,48,,"Text := 'Evaluation measures: Mean IoU'
Text[|Text|] := ''
Text[|Text|] := 'The measure mean IoU is computed as the average over all class IoUs.'
Text[|Text|] := 'IoU stands for Intersection over Union. The class IoU is thus'
Text[|Text|] := 'computed as area of intersection divided by area of union...",671,693,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
6c5289c5,micro,49,,"read_image (Image, 'dl_explanation/evaluation_seg_class_iou')",694,695,
6c5289c5,micro,50,,"get_window_extents (WindowHandleImage, Row, Column, Width, Height)
get_image_size (Image, ImageWidth, ImageHeight)
ResizeFactor := 550 / real(ImageWidth)
zoom_image_factor (Image, Image, ResizeFactor, ResizeFactor, 'bilinear')
get_image_size (Image, ImageWidth, ImageHeight)
gen_image_const (ImageBot...",696,710,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImage)
read_image (Image, 'dl_explanation/evaluation_seg_class_iou')
* --- End of Automatically Add..."
6c5289c5,micro,51,,"TextGT := ['ground truth', 'segmentation']
TextResult := ['result', 'segmentation']
TextIoU := ['IoU', 'of class \'apple\'']
dev_disp_text (TextGT, 'window', 'bottom', 'left', 'black', 'box', 'true')
dev_disp_text (TextResult, 'window', 'bottom', 'center', 'black', 'box', 'true')
dev_disp_text (Text...",711,733,"* --- Automatically Added Context ---
Text[|Text|] := 'The measure mean IoU is computed as the average over all class IoUs.'
* --- End of Automatically Added Context ---"
6c5289c5,micro,52,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",734,740,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,53,,"get_dict_tuple (ExampleInternals, 'use_pretrained_model', UsePretrainedModel)
if (UsePretrainedModel)
Text := 'We will now evaluate the retrained model shipped with HALCON.'
else
Text := 'We will now evaluate the retrained model from example part 2'
Text[|Text|] := '\'detect_pills_deep_learning_2_tr...",749,784,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, W..."
6c5289c5,micro,54,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",785,792,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,55,,"Text := 'Evaluation measures: Pixel accuracy'
Text[|Text|] := ''
Text[|Text|] := 'The pixel accuracy is the ratio of correctly'
Text[|Text|] := 'classified pixels to the total number of pixels.'
Text[|Text|] := ''
Text[|Text|] := 'It can also be computed per class.'
Text[|Text|] := ''
Text[|Text|] :...",801,818,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
6c5289c5,micro,56,,"read_image (Image, 'dl_explanation/evaluation_seg_pixel_accuracy')",819,820,"* --- Automatically Added Context ---
read_image (Image, 'dl_explanation/evaluation_seg_class_iou')
* --- End of Automatically Added Context ---"
6c5289c5,micro,57,,"get_window_extents (WindowHandleImage, Row, Column, Width, Height)
get_image_size (Image, ImageWidth, ImageHeight)
ResizeFactor := 550 / real(ImageWidth)
zoom_image_factor (Image, Image, ResizeFactor, ResizeFactor, 'bilinear')
get_image_size (Image, ImageWidth, ImageHeight)
gen_image_const (ImageBot...",821,834,"* --- Automatically Added Context ---
read_image (Image, 'dl_explanation/evaluation_seg_class_iou')
get_window_extents (WindowHandleImage, Row, Column, Width, Height)
get_image_size (Image, ImageWidth..."
6c5289c5,micro,58,,"TextGT := ['ground truth', 'segmentation']
TextResult := ['result', 'segmentation']
TextIoU := 'pixel accuracy'
dev_disp_text (TextGT, 'window', 'bottom', 'left', 'black', 'box', 'true')
dev_disp_text (TextResult, 'window', 'bottom', 'center', 'black', 'box', 'true')
dev_disp_text (TextIoU, 'window'...",835,857,"* --- Automatically Added Context ---
Text[|Text|] := 'The measure mean IoU is computed as the average over all class IoUs.'
TextGT := ['ground truth', 'segmentation']
TextResult := ['result', 'segmen..."
6c5289c5,micro,59,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",858,865,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,60,,"Text := 'Evaluation measures: Pixel confusion matrix'
Text[|Text|] := ''
Text[|Text|] := 'The pixel confusion matrix tells how many pixels of a class'
Text[|Text|] := 'have been assigned to which class.'
Text[|Text|] := 'It helps to understand, which classes are easy or hard for the model'
Text[|Tex...",874,896,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] ..."
6c5289c5,micro,61,,"dev_display_pixel_confusion_matrix (ExampleInternals, WindowHandleImage)
get_window_extents (WindowHandleImage, Row, Column, Width, Height)
dev_set_window (WindowHandleImage)
dev_set_window_extents (360, 0, Width, Height)
return ()",897,918,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
get_window_extents (WindowHandleImage, Row, Column, Width, Height)
get_dict_tuple (Exa..."
6c5289c5,micro,62,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",919,930,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
dev_open_window (0, 0, WindowWidthText, WindowHeightText, W..."
6c5289c5,micro,63,,"Text := 'In this example we have seen:'
Text[|Text|] := ' - which evaluation measures can be computed for a segmentation model'
Text[|Text|] := ' - how the model is evaluated by means of measures and visual inspection'
Text[|Text|] := ''
Text[|Text|] := 'If the performance of the model satisfies the...",931,985,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
WindowHeightText := 300
WindowBGColor := 'gray'
WindowWidthText := 800
dev_open_window..."
6c5289c5,micro,64,,"ClassIDs := [0, 1, 2]
ClassNames := ['good', 'contamination', 'crack']
NumPixels := [100000, 6000, 2000]
NumPixelsClass0PredictedAs := NumPixels[0] * [0.9, 0.05, 0.05]
NumPixelsClass1PredictedAs := NumPixels[1] * [0.07, 0.8, 0.13]
NumPixelsClass2PredictedAs := NumPixels[2] * [0.14, 0.2, 0.66]
create...",988,999,
6c5289c5,micro,65,,"create_dict (EvaluationResult)
set_dict_tuple (EvaluationResult, 'pixel_confusion_matrix', PixelConfMatrix)",1000,1003,"* --- Automatically Added Context ---
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
create_matrix (|ClassIDs|, |ClassIDs|, 0, PixelConfMatri..."
6c5289c5,micro,66,,"create_dict (GenParam)
set_dict_tuple (GenParam, 'display_mode', 'absolute_confusion_matrix')
get_dict_tuple (ExampleInternals, 'dl_dataset', DatasetFile)
read_dict (DatasetFile, [], [], DLDataset)
create_dict (WindowHandleDict)
set_dict_tuple (WindowHandleDict, 'window_confusion_absolute', WindowHa...",1004,1010,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
read_dict (DLDatasetFileName, [], [], DLDataset)
WindowHandleDict := dict{}
get_dict_t..."
6c5289c5,micro,67,,"dev_display_segmentation_evaluation (EvaluationResult, DLDataset, GenParam, WindowHandleDict)
get_window_extents (WindowHandleImage, Row, Column, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
gen_rectangle1 (Box, Height - 65, 340, Height - 40, 400)
dev_set_color ('blue')
dev_set_line_wid...",1011,1043,"* --- Automatically Added Context ---
read_dict (DLDatasetFileName, [], [], DLDataset)
evaluate_dl_model (DLDataset, DLModelHandle, 'split', 'test', GenParamEval, EvaluationResult, EvalParams)
WindowH..."
6c5289c5,micro,68,,"try
remove_dict_key (WindowHandleDict, 'meta_information')
catch (Exception)
endtry
get_dict_param (WindowHandleDict, 'keys', [], WindowKeys)
WindowHandles := []
for KIdx := 0 to |WindowKeys| - 1 by 1
get_dict_tuple (WindowHandleDict, WindowKeys[KIdx], WindowHandlesTmp)
WindowHandles := [WindowHandl...",1046,1056,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
catch (Exception)
* --- End of Automatically Added Context ---"
6c5289c5,micro,69,,"TotalWidth := 0
for WIdx := 0 to |WindowHandles| - 2 by 1
get_window_extents (WindowHandles[WIdx], Row, Column, Width, Height)
TotalWidth := TotalWidth + Width
endfor
WindowHandle := WindowHandles[|WindowHandles| - 1]
ContinueText := 'Press Run (F5) to continue'
get_string_extents (WindowHandle, Con...",1057,1087,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', 'box', 'true')
get_window_extents (WindowHandleImage, Row, Column, Width, Heigh..."
6c5289c5,micro,70,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
get_dict_param (ExampleInternals, 'keys', [], Keys)
for Index := 0 to |Keys| by 1
try
get_dict_tuple (ExampleInternals, Keys[Index], WindowHandle)
dev_set_window (WindowHandle)
d...",1088,1126,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
tuple_find (WindowHandleKeys, 'window_images', Index)
catch..."
6c5289c5,micro,71,,"Text := 'Model optimization:'
Text[|Text|] := ''
Text[|Text|] := 'At the end of this example the models'
Text[|Text|] := 'memory consumption is optimized for inference'
Text[|Text|] := '(for inference see part 4 of the example series).'
Text[|Text|] := ''
Text[|Text|] := 'To do so, we will set'
Text...",1139,1173,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'This example covers part 3: \'Evaluation of the trained model\'.'
dev_di..."
6c5289c5,micro,72,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",1176,1180,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, UsePretrainedModel, ExampleInternals)
* --- End of Automatically Added Context ---"
6c5289c5,micro,73,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on a GPU or CPU.'
Text[|Text|] := ''
if (DLDeviceType != 'gp...",1181,1212,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
b294fbf3,full,0,"This example is part of a series of examples, which summarizes
the workflow for DL segmentation. It ...","dev_update_off ()
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif
DLDevice := DLDeviceHandles[0]
if (ShowExampleS...",22,1343,
b294fbf3,micro,1,"of part 1 and part 2 of this example series, set UsePretrainedModel
to false below.",dev_update_off (),18,23,
b294fbf3,micro,2,"before they are executed. Set the following parameter to false in order to
skip this visualization.",ShowExampleScreens := true,24,28,
b294fbf3,micro,3,"which was trained in part 2 of this example series, set the following
variable to false.",UsePretrainedModel := true,29,33,
b294fbf3,micro,4,"See the respective system requirements in the Installation Guide.
If possible a GPU is used in this ...","query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",34,42,
b294fbf3,micro,5,,"DLDevice := DLDeviceHandles[0]
if (ShowExampleScreens)
dev_example_init (ShowExampleScreens, ExampleInternals)
dev_display_screen_introduction (ExampleInternals)
stop ()
dev_display_screen_example_images (ExampleInternals, UsePretrainedModel)
stop ()
dev_display_screen_inference_step_1 (ExampleInter...",43,80,"* --- Automatically Added Context ---
ShowExampleScreens := true
UsePretrainedModel := true
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
* --- End of Automatica..."
b294fbf3,micro,6,Directory name with the images to be segmented.,ImageDir := 'pill',89,92,
b294fbf3,micro,7,,"ExampleDataDir := 'segment_pill_defects_data'
if (UsePretrainedModel)
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
RetrainedModelFileName := 'segment_pill_defects.hdl'
else
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
PreprocessParamFileName := DataDirector...",93,112,"* --- Automatically Added Context ---
UsePretrainedModel := true
* --- End of Automatically Added Context ---"
b294fbf3,micro,8,,BatchSizeInference := 1,113,115,
b294fbf3,micro,9,,"check_data_availability (ExampleDataDir, PreprocessParamFileName, RetrainedModelFileName, UsePretrainedModel)",120,122,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'segment_pill_defects_data'
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
RetrainedModelFi..."
b294fbf3,micro,10,,"read_dl_model (RetrainedModelFileName, DLModelHandle)",123,124,"* --- Automatically Added Context ---
RetrainedModelFileName := 'segment_pill_defects.hdl'
* --- End of Automatically Added Context ---"
b294fbf3,micro,11,,"get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)",125,128,"* --- Automatically Added Context ---
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
b294fbf3,micro,12,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSizeInference)",129,131,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
* --- End of Automatically Added Context ---"
b294fbf3,micro,13,,"set_dl_model_param (DLModelHandle, 'device', DLDevice)",132,134,"* --- Automatically Added Context ---
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
read_dl_model (RetrainedModelFileName, DLModel..."
b294fbf3,micro,14,,"read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)",135,137,"* --- Automatically Added Context ---
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
* --- End of Automatically Added Context ---"
b294fbf3,micro,15,,"WindowHandleDict := dict{}
DatasetInfo := dict{class_ids: ClassIDs, class_names: ClassNames}
GenParamDisplay := dict{}
GenParamDisplay.segmentation_exclude_class_ids := 0
GenParamDisplay.segmentation_transparency := '80'
GenParamDisplay.font_size := 16",138,145,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)
* --- End of Automatically Added Context -..."
b294fbf3,micro,16,"For this example, we select some images manually.","get_inference_images (ImageDir, ImageFiles)",146,149,"* --- Automatically Added Context ---
ImageDir := 'pill'
* --- End of Automatically Added Context ---"
b294fbf3,micro,17,,"for BatchIndex := 0 to floor(|ImageFiles| / real(BatchSizeInference)) - 1 by 1
Batch := ImageFiles[BatchIndex * BatchSizeInference:(BatchIndex + 1) * BatchSizeInference - 1]
read_image (ImageBatch, Batch)
gen_dl_samples_from_images (ImageBatch, DLSampleBatch)
preprocess_dl_samples (DLSampleBatch, DL...",150,209,"* --- Automatically Added Context ---
BatchSizeInference := 1
read_dl_model (RetrainedModelFileName, DLModelHandle)
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DL..."
b294fbf3,micro,18,,"dev_close_window_dict (WindowHandleDict)
if (ShowExampleScreens)
dev_display_screen_final (ExampleInternals)
stop ()
dev_close_example_windows (ExampleInternals)
endif",210,234,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
* --- End of Automatically Added Context ---"
b294fbf3,micro,19,,"create_dict (ExampleInternals)
set_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_window ()
dev_open_example_text_window (ExampleInternals)
set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple...",237,276,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,20,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",277,283,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,21,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",284,290,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,22,,"Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL segmentation.'
Text[|Text|] := ''
Text[|Text|] := 'The four parts are: '
Text[|Text|] := '1. Dataset preprocessing.'
Text[|Text|] := '2. Training of the model.'
Text[|Text|] := '3. Evaluatio...",291,321,
b294fbf3,micro,23,,"try
get_dict_tuple (ExampleInternals, 'window_handles_to_close', WindowHandlesToClose)
catch (Exception)
WindowHandlesToClose := []
endtry
for I := 0 to |WindowHandlesToClose| - 1 by 1
dev_set_window (WindowHandlesToClose[I])
dev_close_window ()
endfor
set_dict_tuple (ExampleInternals, 'window_handl...",324,335,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,24,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_images', Index)
get_dict_tuple (ExampleInternals, 'window_images_needed', WindowImagesNeeded)
if (WindowImagesNeeded and Index == -1)
dev_open_example_image_window (ExampleInternals)
elseif (not Win...",336,351,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,25,,"get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_legend', Index)
get_dict_tuple (ExampleInternals, 'window_legend_needed', WindowLegendNeeded)
if (WindowLegendNeeded and Index == -1)
dev_open_example_legend_window (ExampleInternals, 280)
elseif (n...",352,364,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_param (ExampleInternals, 'keys', [], WindowHandleKeys)
tuple_find (WindowHandleKeys, 'window_imag..."
b294fbf3,micro,26,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_clear_window ()
dev_set_window_extents (360, 0, 500, 500)
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry",365,374,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Auto..."
b294fbf3,micro,27,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_clear_window ()
dev_set_part (1, 1, -1, -1)
catch (Exception)
endtry
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
dev_clear_windo...",375,410,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
catch (Exception)
* --- End of Automati..."
b294fbf3,micro,28,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",411,417,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,29,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
dev_display_example_reset_windows (ExampleInternals)",418,421,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,30,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",422,425,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
b294fbf3,micro,31,,"ExampleDataDir := 'segment_pill_defects_data'
file_exists (ExampleDataDir, ExampleDataDirExists)",428,431,"* --- Automatically Added Context ---
ExampleDataDir := 'segment_pill_defects_data'
* --- End of Automatically Added Context ---"
b294fbf3,micro,32,,"if (UsePretrainedModel)
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
else
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
PreprocessParamFileName := DataDirectory + '/dl_preprocess_param.hdict'
endif
file_exists (PreprocessParamFileName, PreprocessParamsExist)",432,440,"* --- Automatically Added Context ---
UsePretrainedModel := true
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
DataDirectory := ExampleDataDir + '/dldataset_pill_400x400'
Ex..."
b294fbf3,micro,33,,"if (UsePretrainedModel)
RetrainedModelFileName := 'segment_pill_defects.hdl'
else
RetrainedModelFileName := ExampleDataDir + '/best_dl_model_segmentation.hdl'
endif
file_exists (RetrainedModelFileName, ModelExists)
if (UsePretrainedModel)
if (not ModelExists or not PreprocessParamsExist)
get_dict_tu...",441,488,"* --- Automatically Added Context ---
UsePretrainedModel := true
dev_example_init (ShowExampleScreens, ExampleInternals)
RetrainedModelFileName := 'segment_pill_defects.hdl'
get_dict_tuple (ExampleInt..."
b294fbf3,micro,34,,"set_dict_tuple (ExampleInternals, 'preprocess_param_file_name', PreprocessParamFileName)",489,491,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
* --- End of Automatically Added ..."
b294fbf3,micro,35,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
dev_display_example_reset_windows (ExampleInternals)",492,495,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,36,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
Text := 'We now have a trained segmentation model,'
Text[|Text|] := 'which is ready to be applied to new images.'
Text[|Text|] := ''
Text[|Text|] := 'Below, you see a few example images.'
Text[|Text|...",496,513,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
b294fbf3,micro,37,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_display_pills_example_dataset_preview ()
return ()",514,541,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,38,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",542,548,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,39,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",549,555,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
b294fbf3,micro,40,,"Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image'
Text[|Text|] := '   using the procedure \'gen_dl_samples_from_images\'.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
dev_disp_text ('Press Run (F5) to continue...",556,564,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '4. Inference on new images.'
Text[|Text|] := 'This example covers part 4..."
b294fbf3,micro,41,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_display_raw_image (WindowHandleImages)
return ()",565,583,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,42,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",584,590,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,43,,"Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image'
Text[|Text|] := '   using the procedure \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|Text|] := '2. Preprocess the image to fulfill the requirements of the trained model'
Te...",598,609,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '4. Inference on new images.'
Text[|Text|] := 'This example covers part 4..."
b294fbf3,micro,44,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_display_preprocessed_image (ExampleInternals)
return ()",610,629,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,45,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",630,636,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,46,,"Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image'
Text[|Text|] := '   using the procedure \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|Text|] := '2. Preprocess the image to fulfill the requirements of the trained model'
Te...",644,657,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '4. Inference on new images.'
Text[|Text|] := 'This example covers part 4..."
b294fbf3,micro,47,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_display_model_output_image (ExampleInternals)
return ()",658,677,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,48,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",678,684,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,49,,"set_dict_tuple (ExampleInternals, 'window_images_needed', true)
set_dict_tuple (ExampleInternals, 'window_legend_needed', true)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",685,692,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
b294fbf3,micro,50,,"Text := 'Inference steps for one image:'
Text[|Text|] := ''
Text[|Text|] := '1. Generate a DLSample for the image'
Text[|Text|] := '   using the procedure \'gen_dl_samples_from_images\'.'
Text[|Text|] := ''
Text[|Text|] := '2. Preprocess the image to fulfill the requirements of the trained model'
Te...",693,709,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := '4. Inference on new images.'
Text[|Text|] := 'This example covers part 4..."
b294fbf3,micro,51,,"get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_display_segmented_regions (ExampleInternals)
return ()",710,729,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,52,and what will be done.,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif",730,736,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,53,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",737,744,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of Automatically Added Contex..."
b294fbf3,micro,54,,"Text := 'We will now apply the trained model from example part 2 '
Text[|Text|] := '(segment_pill_defects_deep_learning_2_train.hdev)'
Text[|Text|] := 'to some new images using \'apply_dl_model\'.'
Text[|Text|] := ''
Text[|Text|] := 'Additionally, we apply postprocessing steps to the'
Text[|Text|] :...",745,785,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'The four parts a..."
b294fbf3,micro,55,,"WindowHeightText := 300
WindowWidthImage := 500
WindowHeightImages := 500
WindowBGColor := 'black'
WindowYImages := WindowHeightText + 60
WindowXImages := 0
dev_open_window (WindowYImages, WindowXImages, WindowWidthImage, WindowHeightImages, WindowBGColor, WindowHandleImages)
set_display_font (Windo...",786,816,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Co..."
b294fbf3,micro,56,,"read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')",819,821,
b294fbf3,micro,57,,"get_dict_tuple (ExampleInternals, 'preprocess_param_file_name', PreprocessParamFileName)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
preprocess_dl_model_images (Image, Image, DLPreprocessParam)
set_dict_object (Image, ExampleInternals, 'preprocessed_image')",822,828,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
PreprocessParamFileName := 'segment_pill_de..."
b294fbf3,micro,58,,"dev_set_part (0, 0, 400, 400)
dev_display (Image)
dev_disp_text ('Preprocessed image', 'window', 'top', 'left', 'black', [], [])
return ()",829,847,"* --- Automatically Added Context ---
read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
* --- End of Automatically Added Context ---"
b294fbf3,micro,59,,dev_set_window (WindowHandleImages),848,850,"* --- Automatically Added Context ---
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Automatically Added Context ---"
b294fbf3,micro,60,,"read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
get_image_size (Image, Width, Height)
get_window_extents (WindowHandleImages, Row, Column, Width1, Height1)
if (Height &lt; Width)
ZoomFactor := Width1 / real(Width)
else
ZoomFactor := Height1 / real(Height)
endif
zo...",851,884,"* --- Automatically Added Context ---
area_center (ConnectedRegions, Area, Row, Column)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
read_image (Image, 'pill/ginseng/contamin..."
b294fbf3,micro,61,,"read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
read_image (SegImage, 'labels/pill/ginseng/contamination/pill_ginseng_contamination_007_gt.png')",888,890,"* --- Automatically Added Context ---
read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
* --- End of Automatically Added Context ---"
b294fbf3,micro,62,,"get_dict_tuple (ExampleInternals, 'preprocess_param_file_name', PreprocessParamFileName)
read_dict (PreprocessParamFileName, [], [], DLPreprocessParam)
preprocess_dl_model_segmentations (Image, SegImage, SegImage, DLPreprocessParam)",891,895,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
read_dict (PreprocessParamFileNam..."
b294fbf3,micro,63,,"dev_display (SegImage)
dev_disp_text ('Segmentation image \n(output of \'apply_dl_model\')', 'window', 'top', 'left', 'black', [], [])",896,899,"* --- Automatically Added Context ---
read_image (SegImage, 'labels/pill/ginseng/contamination/pill_ginseng_contamination_007_gt.png')
* --- End of Automatically Added Context ---"
b294fbf3,micro,64,,"set_dict_object (SegImage, ExampleInternals, 'segmentation_image')
return ()",900,917,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_image (SegImage, 'labels/pill/ginseng/contamination/pill_ginseng_contamination_007_gt.png')
* --- End..."
b294fbf3,micro,65,,"get_dict_object (Image, ExampleInternals, 'preprocessed_image')
get_dict_object (SegImage, ExampleInternals, 'segmentation_image')",920,923,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
read_image (SegImage, ..."
b294fbf3,micro,66,,"threshold (SegImage, Defect, 1, 1)
area_center (Defect, Area, Row, Column)",924,927,"* --- Automatically Added Context ---
area_center (ConnectedRegions, Area, Row, Column)
read_image (SegImage, 'labels/pill/ginseng/contamination/pill_ginseng_contamination_007_gt.png')
* --- End of Au..."
b294fbf3,micro,67,Dataset info.,"create_dict (Info)
ClassIDs := [0, 1, 2]
ClassNames := ['good', 'contamination', 'crack']
set_dict_tuple (Info, 'class_ids', ClassIDs)
set_dict_tuple (Info, 'class_names', ClassNames)",928,934,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
get_dl_model_param (DLModelHandle, 'class_ids', ClassIDs)
* --- End of Automatically Added Context -..."
b294fbf3,micro,68,,"create_dict (Sample)
set_dict_object (Image, Sample, 'image')",935,937,"* --- Automatically Added Context ---
read_image (Image, 'pill/ginseng/contamination/pill_ginseng_contamination_007.png')
* --- End of Automatically Added Context ---"
b294fbf3,micro,69,,"create_dict (Result)
set_dict_object (SegImage, Result, 'segmentation_image')",938,940,"* --- Automatically Added Context ---
read_image (SegImage, 'labels/pill/ginseng/contamination/pill_ginseng_contamination_007_gt.png')
* --- End of Automatically Added Context ---"
b294fbf3,micro,70,,"create_dict (GenParam)
set_dict_tuple (GenParam, 'segmentation_exclude_class_ids', 0)
set_dict_tuple (GenParam, 'segmentation_transparency', '80')
set_dict_tuple (GenParam, 'font_size', 16)",941,945,
b294fbf3,micro,71,,"create_dict (WindowHandleDict)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
set_dict_tuple (WindowHandleDict, 'segmentation_image_result', [WindowHandleImages,WindowHandleLegend])",946,950,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
WindowHandleDict := dict{}
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
get_dict..."
b294fbf3,micro,72,,"dev_display_dl_data (Sample, Result, Info, 'segmentation_image_result', GenParam, WindowHandleDict)",951,953,"* --- Automatically Added Context ---
WindowHandleDict := dict{}
create_dict (Info)
create_dict (Sample)
create_dict (Result)
create_dict (GenParam)
* --- End of Automatically Added Context ---"
b294fbf3,micro,73,,"get_dict_tuple (WindowHandleDict, 'segmentation_image_result', WindowHandles)
dev_set_window (WindowHandles[0])
dev_disp_text (ClassNames[1] + '\narea: ' + Area + 'px', 'image', Row - 10, Column + 10, 'black', [], [])
dev_disp_text ('Segmented defect regions', 'window', 'top', 'left', 'black', [], [...",954,978,"* --- Automatically Added Context ---
get_dl_model_param (DLModelHandle, 'class_names', ClassNames)
WindowHandleDict := dict{}
WindowHandles := WindowHandleDict.segmentation_image_result
area_center (..."
b294fbf3,micro,74,,"ImageFiles := ImageDir + '/ginseng/contamination/pill_ginseng_contamination_154'
ImageFiles[|ImageFiles|] := ImageDir + '/magnesium/crack/pill_magnesium_crack_036'
ImageFiles[|ImageFiles|] := ImageDir + '/mint/good/pill_mint_good_165'
ImageFiles[|ImageFiles|] := ImageDir + '/ginseng/crack/pill_ginse...",979,1006,"* --- Automatically Added Context ---
ImageDir := 'pill'
get_inference_images (ImageDir, ImageFiles)
* --- End of Automatically Added Context ---"
b294fbf3,micro,75,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_open_example_text_window (ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)",1007,1018,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
* --- End of..."
b294fbf3,micro,76,,"Text := 'Congratulations!'
Text[|Text|] := 'You have finished the series of examples for DL segmentation.'
Text[|Text|] := ''
Text[|Text|] := 'You can now train a segmentation model on your own data.'
Text[|Text|] := ''
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
dev_disp_t...",1019,1045,"* --- Automatically Added Context ---
Text := 'This example is part of a series of examples, which summarize '
Text[|Text|] := 'the workflow for DL segmentation.'
Text[|Text|] := 'This example covers ..."
b294fbf3,micro,77,,"if (sum(Areas) - Areas[0] &gt; 0)
Text := 'NOK'
BoxColor := 'red'
else
Text := 'OK'
BoxColor := 'green'
endif
set_display_font (WindowHandleImage, 24, 'mono', 'true', 'false')
dev_disp_text (Text, 'window', 'top', 'left', 'black', ['box_color', 'shadow'], [BoxColor,'false'])
set_display_font (Window...",1048,1099,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
region_features (ClassRegions, 'area', Areas)
Text := 'This example is part of a series of examples, which..."
b294fbf3,micro,78,,"try
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_images')
catch (Exception)
endtry
return ()",1100,1125,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
catch (Exception)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
* --- End of Auto..."
b294fbf3,micro,79,,"get_dict_tuple (ExampleInternals, 'show_example_screens', ShowExampleScreens)
if (not ShowExampleScreens)
return ()
endif
dev_close_example_text_window (ExampleInternals)
dev_close_example_image_window (ShowExampleScreens)
dev_close_example_legend_window (ShowExampleScreens)
return ()",1126,1151,"* --- Automatically Added Context ---
ShowExampleScreens := true
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,80,,"try
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
dev_set_window (WindowHandleLegend)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_legend')
catch (Exception)
endtry
return ()",1152,1177,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
catch (Exception)
* --- End of Auto..."
b294fbf3,micro,81,,"try
get_dict_tuple (ExampleInternals, 'window_text', WindowHandleImages)
dev_set_window (WindowHandleImages)
dev_close_window ()
remove_dict_key (ExampleInternals, 'window_text')
catch (Exception)
endtry
return ()",1178,1203,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_images', WindowHandleImages)
catch (Exception)
* --- End of Auto..."
b294fbf3,micro,82,,"get_dict_tuple (ExampleInternals, 'window_images_height', WindowImagesHeight)
get_dict_tuple (ExampleInternals, 'window_images_width', WindowImagesWidth)
get_dict_tuple (ExampleInternals, 'window_images_x', WindowImagesX)
get_dict_tuple (ExampleInternals, 'window_images_y', WindowImagesY)
dev_open_w...",1204,1224,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
get_dict_tuple (ExampleInternals, 'window_legend', WindowHandleLegend)
* --- End of Automatically Added Co..."
b294fbf3,micro,83,,"try
GinsengPath := 'pill/ginseng/' + ['good/pill_ginseng_good_001', 'contamination/pill_ginseng_contamination_004', 'crack/pill_ginseng_crack_001']
MagnesiumPath := 'pill/magnesium/' + ['good/pill_magnesium_good_001', 'contamination/pill_magnesium_contamination_001', 'crack/pill_magnesium_crack_001'...",1225,1272,"* --- Automatically Added Context ---
Text[|Text|] := 'The four parts are: '
ExceptionText[|ExceptionText|] := ' - Deep learning installer, see Installation Guide.'
ExceptionText[|ExceptionText|] := '..."
b294fbf3,micro,84,,"file_exists (ExampleDataDir, FileExists)
Example1 := 'segment_pill_defects_deep_learning_1_preprocess.hdev'
Example2 := 'segment_pill_defects_deep_learning_2_train.hdev'
if (not FileExists)
throw (ExampleDataDir + ' does not exist. Please run ' + Example1 + ' and ' + Example2 + ' of example series.'...",1273,1314,"* --- Automatically Added Context ---
UsePretrainedModel := true
ExampleDataDir := 'segment_pill_defects_data'
PreprocessParamFileName := 'segment_pill_defects_preprocess_param.hdict'
ExceptionText[|E..."
b294fbf3,micro,85,,"set_dict_tuple (ExampleInternals, 'window_images_needed', false)
set_dict_tuple (ExampleInternals, 'window_legend_needed', false)
dev_display_example_reset_windows (ExampleInternals)",1317,1321,"* --- Automatically Added Context ---
dev_example_init (ShowExampleScreens, ExampleInternals)
* --- End of Automatically Added Context ---"
b294fbf3,micro,86,,"get_dict_tuple (ExampleInternals, 'window_text', WindowHandleText)
dev_set_window (WindowHandleText)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
get_dl_device_param (DLDevice, 'name', DLDeviceName)
Text := 'This example can be run on any deep learning device.'
Text[|Text|] := ''
if (DLDevic...",1322,1353,"* --- Automatically Added Context ---
throw ('No supported device found to continue this example.')
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
DLDevice := DLD..."
9a058c7d,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
count_obj (Regions, Number)
dev_update_window ('off')
for i := 1 to Number by 1
select_obj (Regions, RegionSelected, i)
dev_clear_window ()
dev_display (RegionSelected)
*     stop ()
endfor",6,15,
549cad94,full,0,,"Var := 1
dev_inspect_ctrl (Var)
Var := [1, 2, 3, 9, 5, 6, 7, 8]
Var[3] := 4
stop ()
dev_close_inspect_ctrl (Var)",6,11,
bce143c0,full,0,close all active graphics windows,"for i := 1 to 10 by 1
dev_close_window ()
endfor
read_image (For5, 'for5')
get_image_size (For5, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (For5)",8,16,
bce143c0,micro,1,,"for i := 1 to 10 by 1
dev_close_window ()
endfor
read_image (For5, 'for5')",6,11,
bce143c0,micro,2,,"get_image_size (For5, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",12,14,"* --- Automatically Added Context ---
read_image (For5, 'for5')
* --- End of Automatically Added Context ---"
bce143c0,micro,3,,dev_display (For5),15,22,"* --- Automatically Added Context ---
read_image (For5, 'for5')
* --- End of Automatically Added Context ---"
9b1f42f2,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
dev_clear_window ()
dev_display (Image)
dev_set_colored (12)
dev_set_draw ('margin')
dev_display (Regions)",6,12,
187208f2,full,0,"This example shows how to use dev_disp_text and demonstrates what
effect the individual parameters h...","gen_image_squared_paper (ImageSquaredPaper)
dev_close_window ()
dev_open_window_fit_image (ImageSquaredPaper, 0, 0, 800, 600, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImageSquaredPaper)
Text := '1. When using the default parameters, dev_disp_text displa...",10,147,
187208f2,micro,1,,"gen_image_squared_paper (ImageSquaredPaper)
dev_close_window ()
dev_open_window_fit_image (ImageSquaredPaper, 0, 0, 800, 600, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",9,15,
187208f2,micro,2,,"dev_display (ImageSquaredPaper)
Text := '1. When using the default parameters, dev_disp_text displays'
Text[1] := '   text at the window position (12,12) in black color within'
Text[2] := '   an orange box with a slightly darker shadow beneath the box.'
dev_disp_text (Text, 'window', 12, 12, 'black'...",16,25,"* --- Automatically Added Context ---
gen_image_squared_paper (ImageSquaredPaper)
* --- End of Automatically Added Context ---"
187208f2,micro,3,,"dev_display (ImageSquaredPaper)
Text := '2. The position and the color of the text can be changed with'
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
Text[2] := '   different values for the three parameters are shown below.'
dev_disp_text (Text, 'window', 12, 12, 'black',...",26,31,"* --- Automatically Added Context ---
gen_image_squared_paper (ImageSquaredPaper)
Text := '1. When using the default parameters, dev_disp_text displays'
* --- End of Automatically Added Context ---"
187208f2,micro,4,,"dev_disp_text ('Row = 100\nColumn = 60\nColor = \'black\'', 'window', 100, 60, 'black', [], [])",32,33,"* --- Automatically Added Context ---
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
* --- End of Automatically Added Context ---"
187208f2,micro,5,,"dev_disp_text ('Row = \'center\',\nColumn = \'right\'\nColor = \'red\'', 'window', 'center', 'right', 'red', [], [])",34,35,"* --- Automatically Added Context ---
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
* --- End of Automatically Added Context ---"
187208f2,micro,6,,"dev_disp_text ('Row = 372.7\nColumn = \'center\'\nColor = \'blue\'', 'window', 372.7, 'center', 'blue', [], [])",36,37,"* --- Automatically Added Context ---
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
* --- End of Automatically Added Context ---"
187208f2,micro,7,,"dev_disp_text ('Row = \'bottom\'\nColumn = \'left\'\nColor = [\'forest green\', \'orange\', \'black\']', 'window', 'bottom', 'left', ['forest green', 'orange', 'black'], [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",38,43,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
Text[1] := '   the parameters Row, Column, and Color. Some examples wit..."
187208f2,micro,8,,"dev_display (ImageSquaredPaper)
Text := '3. The appearance of the box can be set with generic parameters:'
Text[1] := '   - \'box\': switches the box on/off'
Text[2] := '   - \'box_color\': sets the color and transparency of the box'
Text[3] := '   - \'border_radius\': sets the roundness of the box'...",44,52,"* --- Automatically Added Context ---
gen_image_squared_paper (ImageSquaredPaper)
Text := '1. When using the default parameters, dev_disp_text displays'
Text[1] := '   the parameters Row, Column, and ..."
187208f2,micro,9,,"dev_disp_text ('\'box\' = \'false\'', 'window', 200, 40, 'black', 'box', 'false')",53,54,
187208f2,micro,10,,"dev_disp_text ('\'box_color\' = \'sky blue\'', 'window', 300, 40, 'black', 'box_color', 'sky blue')",55,56,
187208f2,micro,11,display transparent boxes.,"dev_disp_text ('\'box_color\' = \'#ff8d2644\'', 'window', 340, 40, 'black', 'box_color', '#f28d2644')",57,59,
187208f2,micro,12,,"dev_disp_text ('\'border_radius\' = 0', 'window', 200, 400, 'black', 'border_radius', 0)
dev_disp_text ('\'border_radius\' = 10', 'window', 240, 400, 'black', 'border_radius', 10)",60,62,
187208f2,micro,13,,"dev_disp_text ('\'box_padding\' = 0', 'window', 300, 400, 'black', 'box_padding', 0)
dev_disp_text ('\'box_padding\' = 10', 'window', 340, 400, 'black', 'box_padding', 10)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",63,69,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
187208f2,micro,14,,"dev_display (ImageSquaredPaper)
Text := '4. The appearance of the box\'s shadow can be set with generic parameters:'
Text[1] := '   - \'shadow\': switches the shadow on/off'
Text[2] := '   - \'shadow_color\': sets the color and transparency of the shadow'
Text[3] := '   - \'shadow_sigma\': sets the ...",70,78,"* --- Automatically Added Context ---
gen_image_squared_paper (ImageSquaredPaper)
Text := '1. When using the default parameters, dev_disp_text displays'
Text[1] := '   the parameters Row, Column, and ..."
187208f2,micro,15,,"dev_disp_text ('\'shadow\' = \'false\'', 'window', 200, 40, 'black', 'shadow', 'false')",79,80,
187208f2,micro,16,,"dev_disp_text ('\'shadow_color\' = \'green\'', 'window', 300, 40, 'black', 'shadow_color', 'green')",81,82,
187208f2,micro,17,to display transparent shadows.,"dev_disp_text ('\'shadow_color\' = \'#f28d2688\'', 'window', 340, 40, 'black', 'shadow_color', '#f28d2688')",83,85,
187208f2,micro,18,,"dev_disp_text ('\'shadow_sigma\' = 0', 'window', 200, 400, 'black', 'shadow_sigma', 0)
dev_disp_text ('\'shadow_sigma\' = 2.5', 'window', 240, 400, 'black', 'shadow_sigma', 2.5)",86,88,
187208f2,micro,19,,"dev_disp_text ('\'shadow_dx\' = -5, \'shadow_dy\' = -3', 'window', 300, 400, 'black', ['shadow_dx', 'shadow_dy'], [-5, -3])
dev_disp_text ('\'shadow_dx\' =  3, \'shadow_dy\' =  -3', 'window', 340, 400, 'black', ['shadow_dx', 'shadow_dy'], [3, -3])
dev_disp_text ('Press Run (F5) to continue', 'window...",89,95,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automatically Added Context ---"
187208f2,micro,20,,"read_image (Image, 'clip')
dev_resize_window_fit_image (Image, 0, 0, 1024, 768)
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 99999)
dev_display (Image)
dev_set_c...",96,105,"* --- Automatically Added Context ---
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
* --- End of Automatically Added Context ---"
187208f2,micro,21,"automatically adapted if the displayed iconic objects are moved or
scaled.","dev_disp_text ('Area: ' + Area, 'image', Row, Column, 'black', 'box_color', '#ffffff77')
Text := '5. The coordinate system can be set with the parameter CoordSystem:'
Text[1] := '   - \'window\': Row and Column must be specified in window coordinates'
Text[2] := '               -&gt; the displayed t...",106,115,"* --- Automatically Added Context ---
Text := '1. When using the default parameters, dev_disp_text displays'
Text[1] := '   the parameters Row, Column, and Color. Some examples with'
area_center (Sele..."
187208f2,micro,22,"specified position even if the content of the graphic window is moved
or zoomed.","dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
Text := ['Feel free to interactively move or scale the content of the', 'graphic window to experience the difference.']
dev_disp_text (Text, 'window', 'bottom', 'center', 'white', 'box_color', 'forest green')",116,133,"* --- Automatically Added Context ---
Text := '1. When using the default parameters, dev_disp_text displays'
* --- End of Automatically Added Context ---"
187208f2,micro,23,,"Width := 800
Height := 600
Step := 20
GrayBackground := 230
GrayGrid := 120
Smoothing := 3",134,140,
187208f2,micro,24,,"gen_image_const (Image, 'byte', Width, Height)
scale_image (Image, ImageScaled, 1, GrayBackground)
gen_grid_region (RegionGrid, Step, Step, 'lines', Width, Height)
paint_region (RegionGrid, ImageScaled, ImageResult, GrayGrid, 'fill')
gauss_filter (ImageResult, ImageSquaredPaper, Smoothing)
return ()",141,163,"* --- Automatically Added Context ---
gen_image_squared_paper (ImageSquaredPaper)
read_image (Image, 'clip')
Width := 800
Height := 600
Step := 20
GrayBackground := 230
GrayGrid := 120
Smoothing := 3
..."
0e0c4377,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_error_var (Error, 1)
dev_set_check ('~give_error')
FileName := 'wrong_name'
read_image (Image, FileName)
ReadError := Error
if (ReadError != H_MSG_TRUE)
write_string (WindowHandle, 'wrong file name: ' + FileName)
endif",6,15,
9757f90b,full,0,Inspect tuples,"X := [0:.1:6.28]
Y := sin(X)
dev_inspect_ctrl ([X,Y])
stop ()
dev_close_inspect_ctrl ([X,Y])
create_funct_1d_pairs (X, Y, Function)
dev_inspect_ctrl (Function)
stop ()
dev_close_inspect_ctrl (Function)
dev_inspect_ctrl (['plot',X,Y])
stop ()
dev_close_inspect_ctrl ([X,Y])
dev_inspect_ctrl (['plot_xy...",7,45,
9757f90b,micro,1,,"X := [0:.1:6.28]
Y := sin(X)
dev_inspect_ctrl ([X,Y])
stop ()
dev_close_inspect_ctrl ([X,Y])",6,11,
9757f90b,micro,2,,"create_funct_1d_pairs (X, Y, Function)
dev_inspect_ctrl (Function)
stop ()
dev_close_inspect_ctrl (Function)",12,16,"* --- Automatically Added Context ---
X := [0:.1:6.28]
Y := sin(X)
* --- End of Automatically Added Context ---"
9757f90b,micro,3,,"dev_inspect_ctrl (['plot',X,Y])
stop ()
dev_close_inspect_ctrl ([X,Y])",17,20,"* --- Automatically Added Context ---
X := [0:.1:6.28]
Y := sin(X)
* --- End of Automatically Added Context ---"
9757f90b,micro,4,,"dev_inspect_ctrl (['plot_xy',X,Y])
stop ()
dev_close_inspect_ctrl ([X,Y])",21,24,"* --- Automatically Added Context ---
X := [0:.1:6.28]
Y := sin(X)
* --- End of Automatically Added Context ---"
9757f90b,micro,5,,"create_matrix (3, 3, [1:9], MatrixID)
dev_inspect_ctrl (MatrixID)
stop ()
dev_close_inspect_ctrl (MatrixID)",25,29,
9757f90b,micro,6,,"create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
dev_inspect_ctrl (Pose)
stop ()
dev_close_inspect_ctrl (Pose)",30,34,
9757f90b,micro,7,,"gen_object_model_3d_from_points (X, Y, X * Y, ObjectModel3D)
dev_inspect_ctrl (ObjectModel3D)
stop ()
dev_close_inspect_ctrl (ObjectModel3D)",35,39,"* --- Automatically Added Context ---
X := [0:.1:6.28]
Y := sin(X)
* --- End of Automatically Added Context ---"
9757f90b,micro,8,,"dev_inspect_ctrl (AcqHandle)
stop ()
close_framegrabber (AcqHandle)
dev_close_inspect_ctrl (AcqHandle)",40,51,
2da3f82d,full,0,"********************************************************
This examples shows how to use the HDevelop...","dev_open_dialog ('about_dialog')
dev_open_dialog ('duplicate_procedure_dialog')
dev_open_dialog ('export_dialog')
dev_open_dialog ('open_graphics_windows_dialog')
dev_open_dialog ('insert_visualization_code_dialog')
dev_open_dialog ('read_image_dialog')
dev_open_dialog ('print_dialog')
dev_open_dial...",11,19,
2da3f82d,micro,1,"This examples shows how to use the HDevelop operator
dev_open_dialog, which opens modal dialogs.
***...","dev_open_dialog ('about_dialog')
dev_open_dialog ('duplicate_procedure_dialog')
dev_open_dialog ('export_dialog')
dev_open_dialog ('open_graphics_windows_dialog')
dev_open_dialog ('insert_visualization_code_dialog')
dev_open_dialog ('read_image_dialog')
dev_open_dialog ('print_dialog')
dev_open_dial...",6,25,
c3507dd7,full,0,"*********************************************************
This examples shows how to use the HDevelo...","dev_open_file_dialog ('read_image', 'read_multi', 'default', Selection1)
read_image (Image, Selection1)
stop ()
dev_open_file_dialog ('Image (*.jpg *.tif *.tiff *.png);;JPG (*.jpg);;PNG (*.png);;TIF (*.tif *.tiff)', 'read_multi', 'default', Selection2)
stop ()
dev_open_file_dialog ('read_image', 'wr...",13,24,
c3507dd7,micro,1,,"dev_open_file_dialog ('read_image', 'read_multi', 'default', Selection1)
read_image (Image, Selection1)
stop ()",12,16,
c3507dd7,micro,2,,"dev_open_file_dialog ('Image (*.jpg *.tif *.tiff *.png);;JPG (*.jpg);;PNG (*.png);;TIF (*.tif *.tiff)', 'read_multi', 'default', Selection2)
stop ()",17,19,"* --- Automatically Added Context ---
read_image (Image, Selection1)
* --- End of Automatically Added Context ---"
c3507dd7,micro,3,,"dev_open_file_dialog ('read_image', 'write', 'default', Selection3)
stop ()",20,22,
c3507dd7,micro,4,,"dev_open_file_dialog ('read_image', 'dir', 'default', Selection4)",23,30,
1914d6c7,full,0,"*********************************************************
This examples shows how to use the HDevelo...","dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_set_tool_geometry (ToolId, 0, 0, 'default', 'default')
stop ()
dev_show_tool (ToolId, 'hide')
stop ()
dev_show_tool (ToolId, 'normal')
stop ()
dev_close_tool (ToolId)
dev_open_tool (...",15,215,
1914d6c7,micro,1,,"dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()",14,16,
1914d6c7,micro,2,,"dev_set_tool_geometry (ToolId, 0, 0, 'default', 'default')
stop ()",17,19,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,3,,"dev_show_tool (ToolId, 'hide')
stop ()",20,22,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,4,,"dev_show_tool (ToolId, 'normal')
stop ()",23,25,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,5,,dev_close_tool (ToolId),26,28,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,6,"Open other assistants
*********************************************************","dev_open_tool ('calibration_assistant', 10, 10, 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)
dev_open_tool ('matching_assistant', 50, 50, 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)
dev_open_tool ('measure1d_assistant', 100, 100, 'default', 'default...",29,47,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,7,"Open tools
********************************************************
feature_histogram","dev_open_tool ('feature_histogram', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",48,54,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,8,,"dev_open_tool ('feature_inspection', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",55,58,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,9,,"dev_open_tool ('gray_histogram', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",59,62,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,10,,"dev_open_tool ('line_profile', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",63,66,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,11,,"dev_open_tool ('zoom_window', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_set_tool_geometry (ToolId, 'default', 'default', 500, 500)
stop ()
dev_close_tool (ToolId)",67,73,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,12,"Open main windows
********************************************************
graphics_window","dev_open_tool ('graphics_window', 'default', 'default', 'default', 'default', [], [], ToolId)
read_image (Image, 'fabrik')
stop ()
dev_close_tool (ToolId)",74,81,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,13,,"dev_open_tool ('program_window', 0, 0, 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",82,85,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,14,,"dev_open_tool ('variable_window', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)
dev_show_tool (ToolId, 'normal')",86,90,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,15,,"dev_open_tool ('operator_window', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",91,95,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,16,"Open dialogs
*******************************************************
output_console","dev_open_tool ('output_console', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",96,102,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,17,,"dev_open_tool ('create_procedure_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",103,106,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,18,,"dev_open_tool ('browse_examples_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",107,110,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,19,,"dev_open_tool ('edit_procedure_interface_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",111,114,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,20,,"dev_open_tool ('find_replace_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",115,118,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,21,,"dev_open_tool ('visualization_parameters_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",119,122,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,22,-------------------------------------------------------,"dev_open_tool ('help', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",128,134,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,23,-------------------------------------------------------,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",135,140,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,24,,"dev_open_tool ('halcon_news', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",144,148,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,25,,"dev_open_tool ('manage_procedures', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",149,152,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,26,,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'user_interface/program_window', ToolId)
stop ()
dev_close_tool (ToolId)
dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'user_interface/fonts', ToolId)
stop ()
dev_open_tool ('prefere...",155,164,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,27,,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'procedures', ToolId)
stop ()
dev_close_tool (ToolId)
dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'procedures/directories', ToolId)
stop ()
dev_open_tool ('preferences', 'default',...",165,180,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,28,,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'general_options/general_options', ToolId)
stop ()
dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'general_options/experienced_user', ToolId)
stop ()",181,185,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,29,,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'visualization_settings/pen', ToolId)
stop ()
dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'visualization_settings/lut', ToolId)
stop ()
dev_open_tool ('preferences', 'default', 'de...",186,192,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,30,,"dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'runtime_settings/runtime_settings', ToolId)
stop ()
dev_open_tool ('preferences', 'default', 'default', 'default', 'default', 'page', 'runtime_settings/override_operator_behavior', ToolId)
stop ()",193,198,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,31,--------------------------------------------------------,"dev_open_tool ('quick_navigation', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",199,203,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,32,,"dev_open_tool ('breakpoints_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",204,207,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,33,,"dev_open_tool ('bookmarks_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",208,211,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
1914d6c7,micro,34,,"dev_open_tool ('invalid_lines_dialog', 'default', 'default', 'default', 'default', [], [], ToolId)
stop ()
dev_close_tool (ToolId)",212,221,"* --- Automatically Added Context ---
dev_open_tool ('image_acquisition_assistant', 'default', 'default', 'default', 'default', [], [], ToolId)
* --- End of Automatically Added Context ---"
43f9882b,full,0,,"dev_close_window ()
read_image (For5, 'for5')
get_image_size (For5, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (For5)
dev_set_lut ('rainbow')
dev_display (For5)
stop ()
dev_set_lut ('default')
dev_display (For5)
stop ()
dev_set_part (100, 100, 300, 300)
d...",6,18,
5d702095,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_error_var (Error, 1)
dev_set_check ('~give_error')
FileName := 'wrong_name'
read_image (Image, FileName)
ReadError := Error
dev_set_check ('give_error')
if (ReadError != H_MSG_TRUE)
write_string (WindowHandle, 'wrong fil...",6,18,
5d702095,micro,1,,"read_image (Image, FileName)",17,24,"* --- Automatically Added Context ---
FileName := 'wrong_name'
read_image (Image, FileName)
* --- End of Automatically Added Context ---"
10301e83,full,0,,"read_image (Image, 'fabrik')
for i := 1 to 240 by 10
dev_set_part (i, i, 511 - i, 511 - i)
dev_display (Image)
endfor
stop ()
dev_set_window_extents (0, 0, 640, 480)
dev_set_part (0, 0, 479, 639)
dev_display (Image)
stop ()
get_image_size (Image, Width, Height)
dev_set_part (0, 0, Height - 1, Width ...",6,18,
a1522ba4,full,0,,"read_image (For5, 'for5')
get_image_size (For5, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_display (For5)
dev_set_window_extents (200, 200, -1, -1)",6,10,
30c5d094,full,0,"***********************************************************
Test speedups using the HDevelop integra...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program compares the JIT compiler speedup'
Message[1] := 'for different procedures.'
disp_message (WindowHandle, Message, 'windo...",25,392,
30c5d094,micro,1,"1) Recursive calls of some HDevelop procedures.
2) Implementation of a filter that uses lots of loop...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program compares the JIT compiler speedup'
Message[1] := 'for different procedures.'
disp_message (WindowHandle, Message, 'windo...",20,125,
30c5d094,micro,2,,"disp_message (WindowHandle, 'Please wait while test is running...finished.', 'window', 405, 12, 'white', 'false')
SpeedUpFib := TimeFib[0] / TimeFib[1]
SpeedUpLoop := TimeLoop[0] / TimeLoop[1]
SpeedUpOperators := TimeOperators[0] / TimeOperators[1]
Result := 'Speedup factors'
Result[1] := 'Recursive...",126,187,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
disp_message (WindowHandle, 'Please wait while test is running...', 'window', 225, 12, 'orange', 'false')
..."
30c5d094,micro,3,,"MW := (MaskWidth - 1) / 2
MH := (MaskHeight - 1) / 2
get_image_size (Image, Width, Height)
get_image_type (Image, Type)",188,196,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
30c5d094,micro,4,,"gen_rectangle1 (RectangleInner, MH, MW, Height - 1 - MH, Width - 1 - MW)
difference (Image, RectangleInner, RegionBorder)
intersection (Image, RectangleInner, RegionInner)
get_region_points (RegionBorder, RowsBorder, ColumnsBorder)
get_region_points (RegionInner, RowsInner, ColumnsInner)
gen_rectang...",197,208,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
MW := (MaskWidth - 1) / 2
MH := (MaskHeight - 1) / 2
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context -..."
30c5d094,micro,5,,COut := C,209,211,"* --- Automatically Added Context ---
get_grayval (Image, RowsRect, ColumnsRect, C)
* --- End of Automatically Added Context ---"
30c5d094,micro,6,,"for I := 0 to |RowsBorder| - 1 by 1
X0 := max2(0,ColumnsBorder[I] - MW)
Y0 := max2(0,RowsBorder[I] - MH)
X1 := min2(Width - 1,ColumnsBorder[I] + MW)
Y1 := min2(Height - 1,RowsBorder[I] + MH)
NN := (X1 - X0 + 1) * (Y1 - Y0 + 1)
if (NN &gt; 0)
NeighX := [X0:X1][[0:NN - 1] % (X1 - X0 + 1)]
NeighY := [Y...",212,234,"* --- Automatically Added Context ---
MW := (MaskWidth - 1) / 2
MH := (MaskHeight - 1) / 2
get_image_size (Image, Width, Height)
get_region_points (RegionBorder, RowsBorder, ColumnsBorder)
get_grayval..."
30c5d094,micro,7,,"NN := (2 * MW + 1) * (2 * MH + 1)
NeighXBase := [-MW:MW][[0:NN - 1] % (2 * MW + 1)]
NeighYBase := [-MH:MH][[0:NN - 1] / (2 * MW + 1)]
NeighOffsBase := NeighYBase * Width + NeighXBase
for I := 0 to |RowsInner| - 1 by 1
X := ColumnsInner[I]
Y := RowsInner[I]
NeighVal := C[NeighOffsBase + Y * Width + X...",235,386,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
mean_sp_real (Image, ImageSPMean, 3, 3, 10, 250)
MW := (MaskWidth - 1) / 2
MH := (MaskHeight - 1) / 2
get_image_size (Image, Width, H..."
30c5d094,micro,8,,"mean_image (Image, ImageOut, 13, 13)
threshold (ImageOut, Region, 128, 255)
overpaint_region (ImageOut, Region, 128, 'fill')
median_image (ImageOut, ImageOut, 'circle', 30, 'mirrored')
return ()",387,401,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
process (Image, ImageOut)
* --- End of Automatically Added Context ---"
a10c3f32,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
count_obj (Regions, Number)
open_file ('area.dat', 'output', FileHandle)
for i := 1 to Number by 1
select_obj (Regions, Selected, i)
area_center (Selected, Area, Row, Column)
fwrite_string (FileHandle, i + ' ' + Area)
fnew_lin...",6,16,
3dd84475,full,0,"------------------------------
Before starting this example, please
execute the example program
'ope...","open_file ('area.dat', 'input_binary', FileHandleIn)
open_file ('bytecopy.dat', 'output_binary', FileHandleOut)
repeat
fread_bytes (FileHandleIn, 100, Byte, IsEOF)
fwrite_bytes (FileHandleOut, Byte, ByteWritten)
until (IsEOF)
close_file (FileHandleIn)
close_file (FileHandleOut)",13,22,
3dd84475,micro,1,"execute the example program
'open_file.hdev' in order to create
the file 'area.dat', which will be
c...","open_file ('area.dat', 'input_binary', FileHandleIn)
open_file ('bytecopy.dat', 'output_binary', FileHandleOut)
repeat
fread_bytes (FileHandleIn, 100, Byte, IsEOF)
fwrite_bytes (FileHandleOut, Byte, ByteWritten)
until (IsEOF)
close_file (FileHandleIn)
close_file (FileHandleOut)",7,28,
b7f82283,full,0,"------------------------------
Note: Before starting this example
execute the example program
'open_...","open_file ('area.dat', 'input', FileHandleIn)
open_file ('copy.dat', 'output', FileHandleOut)
fread_string (FileHandleIn, Number, IsEOF)
Char := ''
Index := 0
while (Char != 'eof')
fread_char (FileHandleIn, Char)
if ((Char != 'eof') and (Char != 'nl'))
fwrite_string (FileHandleOut, Char)
endif
if (C...",12,28,
b7f82283,micro,1,"execute the example program
'open_file.hdev' in order to create
the file 'area.dat' to read.
-------...","open_file ('area.dat', 'input', FileHandleIn)
open_file ('copy.dat', 'output', FileHandleOut)
fread_string (FileHandleIn, Number, IsEOF)
Char := ''
Index := 0
while (Char != 'eof')
fread_char (FileHandleIn, Char)
if ((Char != 'eof') and (Char != 'nl'))
fwrite_string (FileHandleOut, Char)
endif
if (C...",7,34,
8fcadc86,full,0,"------------------------------
Note: Before starting this example
execute the example program
'open_...","open_file ('area.dat', 'input', FileHandleIn)
open_file ('copy.dat', 'output', FileHandleOut)
fread_line (FileHandleIn, OutLine, IsEOF1)
while (IsEOF1 != 1)
fwrite_string (FileHandleOut, OutLine)
fread_line (FileHandleIn, OutLine, IsEOF1)
endwhile
close_file (FileHandleIn)
close_file (FileHandleOut)",12,20,
8fcadc86,micro,1,"execute the example program
'open_file.hdev' in order to create
the file 'area.dat' to read.
-------...","open_file ('area.dat', 'input', FileHandleIn)
open_file ('copy.dat', 'output', FileHandleOut)
fread_line (FileHandleIn, OutLine, IsEOF1)
while (IsEOF1 != 1)
fwrite_string (FileHandleOut, OutLine)
fread_line (FileHandleIn, OutLine, IsEOF1)
endwhile
close_file (FileHandleIn)
close_file (FileHandleOut)",7,26,
5532b897,full,0,"Note: Before starting this example
execute the example program
'open_file.hdev' in order to create
t...","open_file ('area.dat', 'input', FileHandle)
fread_string (FileHandle, Number, IsEOF)
Number := number(Number)
IsEOF := 0
while (IsEOF == 0)
fread_string (FileHandle, Index, IsEOF)
fread_string (FileHandle, Area, IsEOF)
endwhile
close_file (FileHandle)",12,20,
5532b897,micro,1,"execute the example program
'open_file.hdev' in order to create
the file 'area.dat' to read.","open_file ('area.dat', 'input', FileHandle)
fread_string (FileHandle, Number, IsEOF)
Number := number(Number)
IsEOF := 0
while (IsEOF == 0)
fread_string (FileHandle, Index, IsEOF)
fread_string (FileHandle, Area, IsEOF)
endwhile
close_file (FileHandle)",7,26,
c6793898,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
count_obj (Regions, Number)
open_file ('area.dat', 'output', FileHandle)
fwrite_string (FileHandle, Number + '\n')
for i := 1 to Number by 1
select_obj (Regions, Selected, i)
area_center (Selected, Area, Row, Column)
fwrite_st...",6,16,
4ad0871e,full,0,"This program measures the execution times of the operators
read_image and read_object for images of ...","ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['read_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
NumLoops := 3
get_tmp_dir (LocalTemp)
get_current_dir (DirName)
se...",11,185,
4ad0871e,micro,1,,"ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['read_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']",10,14,
4ad0871e,micro,2,,NumLoops := 3,15,17,
4ad0871e,micro,3,,"get_tmp_dir (LocalTemp)
get_current_dir (DirName)
set_current_dir (LocalTemp)",18,22,
4ad0871e,micro,4,,"dev_update_off ()
dev_close_window ()
WinWidth := 800
WinHeight := 420
dev_open_window (0, 0, WinWidth, WinHeight, 'white', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",23,30,
4ad0871e,micro,5,,"ColumnWidth := 140
ColumnStart := 230
RowHeight := 35
RowStart := 100
display_table (ImageNames, Extensions, ColumnStart, ColumnWidth, RowStart, RowHeight, WindowHandle, ColumnGrid, RowGrid)
dev_disp_text ('Comparison of reading times for different image formats (mean of ' + NumLoops + ' reads)', 'w...",31,38,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
NumLoops := 3..."
4ad0871e,micro,6,,"for I := 0 to |ImageNames| - 1 by 1
read_image (ImageOrig, ImageNames[I])
get_image_size (ImageOrig, ImWidth, ImHeight)
count_channels (ImageOrig, NumChannels)
dev_disp_text ([' ' + ImWidth$'4' + 'x' + ImHeight,NumChannels + ' channel(s)'], 'image', RowStart - 40, ColumnGrid[I] + 10, 'black', 'box',...",39,104,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['read_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
Ex..."
4ad0871e,micro,7,,"set_current_dir (DirName)
NumColumns := |ImageNames|
NumRows := |Extensions|
ColumnEnd := ColumnStart + NumColumns * ColumnWidth
ColumnGrid := [ColumnStart:ColumnWidth:ColumnEnd]
RowEnd := RowStart + NumRows * RowHeight
RowGrid := [RowStart:RowHeight:RowEnd]",105,134,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
get_current_d..."
4ad0871e,micro,8,,"gen_empty_obj (TableGrid)
OpDescription := ['read_image (' + Extensions + ')',' ']
OpDescription[0] := 'read_object (hobj)'
for J := 0 to NumRows by 1
dev_disp_text (OpDescription[J], 'image', RowGrid[J] + 10, 15, 'black', 'box', 'false')
gen_contour_polygon_xld (Lines, [RowGrid[J],RowGrid[J]], [15,...",135,193,"* --- Automatically Added Context ---
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
get_tmp_dir (LocalTemp)
RowStart := 100
display_table (ImageNames, Extensions, ColumnSta..."
de6e2c5e,full,0,"This example demonstrates how to read and write
metadata from/to image files.
At the end of the exam...","RemoveTiffImage := true
read_image (Image, 'patras')
get_system ('example_dir', ExampleDir)
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
write_image (Image, 'tiff', 0, TiffImage)
Format := 'tiff'
read_image_metadata (Format, 'tiff_tags_supported_for_reading', TiffImage, TiffTagsName...",10,41,
de6e2c5e,micro,1,,RemoveTiffImage := true,9,11,
de6e2c5e,micro,2,,"read_image (Image, 'patras')
get_system ('example_dir', ExampleDir)
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
write_image (Image, 'tiff', 0, TiffImage)",12,17,
de6e2c5e,micro,3,,Format := 'tiff',18,19,
de6e2c5e,micro,4,,"read_image_metadata (Format, 'tiff_tags_supported_for_reading', TiffImage, TiffTagsNamesReading)
read_image_metadata (Format, 'tiff_tags_supported_for_writing', TiffImage, TiffTagsNamesWriting)",20,23,"* --- Automatically Added Context ---
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
get_system ('example_dir', ExampleDir)
Format := 'tiff'
* --- End of Automatically Added Context ---"
de6e2c5e,micro,5,,"ImageDescription := 'This is an image description.'
write_image_metadata ('tiff', 'tiff_image_description', ImageDescription, TiffImage)",24,27,"* --- Automatically Added Context ---
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
get_system ('example_dir', ExampleDir)
* --- End of Automatically Added Context ---"
de6e2c5e,micro,6,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
DateTime := Year + '/' + Month + '/' + Day
Software := 'HALCON'
write_image_metadata (Format, ['tiff_software', 'tiff_date_time'], [Software,DateTime], TiffImage)",28,33,"* --- Automatically Added Context ---
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
get_system ('example_dir', ExampleDir)
Format := 'tiff'
* --- End of Automatically Added Context ---"
de6e2c5e,micro,7,,"read_image_metadata (Format, 'tiff_date_time', TiffImage, TagValueDateTime)",34,35,"* --- Automatically Added Context ---
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
get_system ('example_dir', ExampleDir)
Format := 'tiff'
* --- End of Automatically Added Context ---"
de6e2c5e,micro,8,,"read_image_metadata (Format, ['tiff_image_description', 'tiff_date_time', 'tiff_software'], TiffImage, TagValuesTotal)
if (RemoveTiffImage)
delete_file (TiffImage)
endif",36,47,"* --- Automatically Added Context ---
RemoveTiffImage := true
TiffImage := ExampleDir + '/hdevelop/File/Images/patras.tiff'
get_system ('example_dir', ExampleDir)
Format := 'tiff'
* --- End of Automat..."
cba82672,full,0,,"read_image (Image, 'fabrik')
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 3)
write_image (EdgeAmplitude, 'tiff', 0, 'sobel.tif')",6,8,
6d691b94,full,0,"This program measures the execution times of the operators
write_image and write_object for images o...","ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['write_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
NumLoops := 3
get_tmp_dir (LocalTemp)
get_current_dir (DirName)
s...",11,181,
6d691b94,micro,1,,"ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['write_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']",10,14,
6d691b94,micro,2,,NumLoops := 3,15,17,
6d691b94,micro,3,,"get_tmp_dir (LocalTemp)
get_current_dir (DirName)
set_current_dir (LocalTemp)",18,22,
6d691b94,micro,4,,"dev_update_off ()
dev_close_window ()
WinWidth := 800
WinHeight := 420
dev_open_window (0, 0, WinWidth, WinHeight, 'white', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",23,30,
6d691b94,micro,5,,"ColumnWidth := 140
ColumnStart := 230
RowHeight := 35
RowStart := 100
display_table (ImageNames, Extensions, ColumnStart, ColumnWidth, RowStart, RowHeight, WindowHandle, ColumnGrid, RowGrid)
disp_message (WindowHandle, 'Comparison of writing times for different image formats (mean of ' + NumLoops + ...",31,38,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
NumLoops := 3..."
6d691b94,micro,6,,"for I := 0 to |ImageNames| - 1 by 1
read_image (ImageOrg, ImageNames[I])
get_image_size (ImageOrg, ImWidth, ImHeight)
count_channels (ImageOrg, NumChannels)
disp_message (WindowHandle, [' ' + ImWidth$'4' + 'x' + ImHeight,NumChannels + ' channel(s)'], 'image', RowStart - 40, ColumnGrid[I] + 10, 'blac...",39,100,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
FileFormats := ['write_object', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jpegxr', 'tiff']
E..."
6d691b94,micro,7,,"set_current_dir (DirName)
NumColumns := |ImageNames|
NumRows := |Extensions|
ColumnEnd := ColumnStart + NumColumns * ColumnWidth
ColumnGrid := [ColumnStart:ColumnWidth:ColumnEnd]
RowEnd := RowStart + NumRows * RowHeight
RowGrid := [RowStart:RowHeight:RowEnd]",101,130,"* --- Automatically Added Context ---
ImageNames := ['fabrik', 'clip', 'pcb_color', 'caliper/caliper_line_scan']
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
get_current_d..."
6d691b94,micro,8,,"gen_empty_obj (TableGrid)
OpDescription := ['write_image (' + Extensions + ')',' ']
OpDescription[0] := 'write_object (hobj)'
for J := 0 to NumRows by 1
disp_message (WindowHandle, OpDescription[J], 'image', RowGrid[J] + 10, 15, 'black', 'false')
gen_contour_polygon_xld (Lines, [RowGrid[J],RowGrid[J...",131,189,"* --- Automatically Added Context ---
Extensions := ['hobj', 'hobj', 'jpg', 'png', 'bmp', 'jp2', 'jxr', 'tiff']
get_tmp_dir (LocalTemp)
dev_open_window (0, 0, WinWidth, WinHeight, 'white', WindowHandl..."
4fa0e840,full,0,Check the existence of a file.,"get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
Separator := ';'
else
Separator := ':'
endif
get_system ('image_dir', HalconImages)
tuple_split (HalconImages, Separator, Substrings)
HalconImages := Substrings[0]
get_file_path_in_tmp_dir ('files.txt', FileName)
file_exists (FileName, FileEx...",8,74,
4fa0e840,micro,1,,"get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
Separator := ';'
else
Separator := ':'
endif
get_system ('image_dir', HalconImages)
tuple_split (HalconImages, Separator, Substrings)
HalconImages := Substrings[0]
get_file_path_in_tmp_dir ('files.txt', FileName)",6,17,
4fa0e840,micro,2,,"file_exists (FileName, FileExists)
if (FileExists)
open_file (FileName, 'input', FileHandle)
close_file (FileHandle)
endif
if (OS{0:2} == 'Win')
system_call ('dir /b /On ""' + HalconImages + '\\*.*"" &gt; ' + FileName)
else
system_call ('ls ' + HalconImages + '/*.* &gt; ' + FileName)
endif",18,28,"* --- Automatically Added Context ---
get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
get_system ('image_dir', HalconImages)
get_file_path_in_tmp_dir ('files.txt', FileName)
* --- End of Aut..."
4fa0e840,micro,3,,"file_exists (FileName, FileExists)
if (FileExists)
open_file (FileName, 'input', FileHandle)
Files := []
IsEOF := 0
while (not IsEOF)
fread_string (FileHandle, File, IsEOF)
if (not IsEOF)
Files := [Files,File]
endif
endwhile
close_file (FileHandle)
endif
delete_file (FileName)
tuple_environment ('TE...",29,70,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('files.txt', FileName)
file_exists (FileName, FileExists)
open_file (FileName, 'input', FileHandle)
* --- End of Automatically Added Con..."
4fa0e840,micro,4,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",71,83,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('files.txt', FileName)
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
dc98453f,full,0,Find all files in the HDevelop example directory.,"get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
SEP := '\\'
else
SEP := '/'
endif
get_system ('example_dir', HalconExamples)
ExampleDir := HalconExamples + SEP + 'hdevelop'
list_files (ExampleDir, ['files', 'recursive'], ExampleFiles)",7,15,
dc98453f,micro,1,,"get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
SEP := '\\'
else
SEP := '/'
endif
get_system ('example_dir', HalconExamples)
ExampleDir := HalconExamples + SEP + 'hdevelop'
list_files (ExampleDir, ['files', 'recursive'], ExampleFiles)",6,21,
60ab8379,full,0,"This example shows how to use make_dir and remove_dir
in combination with other file operators
First...","ExampleDir := 'testdir1'
try
make_dir (ExampleDir)
for Index := 1 to 5 by 1
open_file (ExampleDir + '/file_' + Index + '.txt', 'output', FileHandle)
close_file (FileHandle)
endfor
make_dir (ExampleDir + '/subtestdir1')
for Index := 1 to 2 by 1
open_file (ExampleDir + '/subtestdir1/file_' + Index + '...",13,70,
60ab8379,micro,1,,"ExampleDir := 'testdir1'
try
make_dir (ExampleDir)
for Index := 1 to 5 by 1
open_file (ExampleDir + '/file_' + Index + '.txt', 'output', FileHandle)
close_file (FileHandle)
endfor
make_dir (ExampleDir + '/subtestdir1')
for Index := 1 to 2 by 1
open_file (ExampleDir + '/subtestdir1/file_' + Index + '...",12,38,
60ab8379,micro,2,,"list_files (ExampleDir, ['files', 'recursive'], ExampleFiles)
dev_inspect_ctrl (ExampleFiles)",39,42,"* --- Automatically Added Context ---
ExampleDir := 'testdir1'
* --- End of Automatically Added Context ---"
60ab8379,micro,3,,stop (),43,45,
60ab8379,micro,4,,"for Index := |ExampleFiles| to 1 by -1
delete_file (ExampleFiles[Index - 1])
endfor",46,51,"* --- Automatically Added Context ---
for Index := 1 to 5 by 1
list_files (ExampleDir, ['files', 'recursive'], ExampleFiles)
* --- End of Automatically Added Context ---"
60ab8379,micro,5,,"list_files (ExampleDir, ['directories', 'recursive'], ExampleDirs)
dev_inspect_ctrl (ExampleDirs)
stop ()",52,57,"* --- Automatically Added Context ---
ExampleDir := 'testdir1'
* --- End of Automatically Added Context ---"
60ab8379,micro,6,,"for Index := |ExampleDirs| to 1 by -1
remove_dir (ExampleDirs[Index - 1])
endfor
remove_dir (ExampleDir)",58,64,"* --- Automatically Added Context ---
ExampleDir := 'testdir1'
for Index := 1 to 5 by 1
list_files (ExampleDir, ['directories', 'recursive'], ExampleDirs)
* --- End of Automatically Added Context ---"
60ab8379,micro,7,,"file_exists (ExampleDir, FileExists)",65,67,"* --- Automatically Added Context ---
ExampleDir := 'testdir1'
* --- End of Automatically Added Context ---"
60ab8379,micro,8,,"dev_close_inspect_ctrl (ExampleDirs)
dev_close_inspect_ctrl (ExampleFiles)",68,76,"* --- Automatically Added Context ---
list_files (ExampleDir, ['files', 'recursive'], ExampleFiles)
list_files (ExampleDir, ['directories', 'recursive'], ExampleDirs)
* --- End of Automatically Added ..."
cc74ce82,full,0,"This example shows how to use write_object to
write mixed HALCON object tuples to disk.
Create mixed...","read_image (MultiChannelImage, 'patras')
read_image (Image, 'fabrik')
threshold (Image, Region, 160, 255)
gen_contour_region_xld (Region, Contours, 'border')
concat_obj (Region, Image, MixedObject)
concat_obj (MixedObject, Contours, MixedObject)
concat_obj (MixedObject, MultiChannelImage, MixedObjec...",10,38,
cc74ce82,micro,1,,"read_image (MultiChannelImage, 'patras')
read_image (Image, 'fabrik')
threshold (Image, Region, 160, 255)
gen_contour_region_xld (Region, Contours, 'border')
concat_obj (Region, Image, MixedObject)
concat_obj (MixedObject, Contours, MixedObject)
concat_obj (MixedObject, MultiChannelImage, MixedObjec...",9,17,
cc74ce82,micro,2,,"write_object (MixedObject, 'mixed_object')",18,19,"* --- Automatically Added Context ---
concat_obj (Region, Image, MixedObject)
* --- End of Automatically Added Context ---"
cc74ce82,micro,3,,"read_object (MixedObjectRead, 'mixed_object')
count_obj (MixedObjectRead, NumberMixedObjectRead)
get_obj_class (MixedObjectRead, ClassMixedObject)",20,24,
cc74ce82,micro,4,"write_image and write_region can also be used
to write HOBJ format.","write_image (Image, 'hobj', 0, 'image')
write_region (Region, 'region')
read_image (ImageRead, 'image')
read_region (RegionRead, 'region')
get_obj_class (ImageRead, ClassImage)
get_obj_class (RegionRead, ClassRegion)
stop ()
delete_file ('mixed_object.hobj')
delete_file ('image.hobj')
delete_file ('...",25,44,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
threshold (Image, Region, 160, 255)
* --- End of Automatically Added Context ---"
e272255f,full,0,"------------------------------
Note: Before you start this example,
execute the example for 'write_r...","read_image (Image, 'fabrik')
read_region (Region, 'region')
dev_display (Image)
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (Region)
get_system ('clip_region', Information)
set_system ('clip_region', 'false')
dev_clear_window ()
read_region (ImageRegion, 'bitrot')
dev_clear_window ()
rea...",11,27,
e272255f,micro,1,"execute the example for 'write_region'
to create the region ('region') to read.
--------------------...","read_image (Image, 'fabrik')
read_region (Region, 'region')
dev_display (Image)
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (Region)",7,16,
e272255f,micro,2,,"get_system ('clip_region', Information)
set_system ('clip_region', 'false')
dev_clear_window ()
read_region (ImageRegion, 'bitrot')
dev_clear_window ()
read_region (ImageRegion, 'largebw1')
smallest_rectangle1 (ImageRegion, Row1, Column1, Row2, Column2)
dev_set_part (Row1, Column1, Row2, Column2)
de...",17,33,
eb0a36f4,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 3, 3, 6, 100)
write_region (Regions, 'region')",6,8,
4d47121d,full,0,"This example shows how to use the operators
- serialize_handle, deserialize_handle,
- serialize_tupl...","create_matrix (3, 3, 0, MatrixID)
gen_object_model_3d_from_points (1, 2, 3, ObjectModel3D)
dev_get_window (WindowHandle)
TupleToSerialize := [MatrixID,WindowHandle,ObjectModel3D,HNULL,1, 2, 'foobar']
try
serialize_tuple (TupleToSerialize, SerializedItem)
catch (Exception)
endtry
tuple_is_serializabl...",12,59,
4d47121d,micro,1,"- serialize_handle, deserialize_handle,
- serialize_tuple, deserialize_tuple,
- tuple_is_serializabl...","create_matrix (3, 3, 0, MatrixID)
gen_object_model_3d_from_points (1, 2, 3, ObjectModel3D)
dev_get_window (WindowHandle)
TupleToSerialize := [MatrixID,WindowHandle,ObjectModel3D,HNULL,1, 2, 'foobar']",6,17,
4d47121d,micro,2,"When attempting to serialize non-serializable handles, an error message is raised.","try
serialize_tuple (TupleToSerialize, SerializedItem)
catch (Exception)
endtry",18,24,"* --- Automatically Added Context ---
TupleToSerialize := [MatrixID,WindowHandle,ObjectModel3D,HNULL,1, 2, 'foobar']
create_matrix (3, 3, 0, MatrixID)
gen_object_model_3d_from_points (1, 2, 3, ObjectM..."
4d47121d,micro,3,,"tuple_is_serializable (TupleToSerialize, IsSerializable)
tuple_is_serializable_elem (TupleToSerialize, IsSerializableElem)",25,28,"* --- Automatically Added Context ---
TupleToSerialize := [MatrixID,WindowHandle,ObjectModel3D,HNULL,1, 2, 'foobar']
create_matrix (3, 3, 0, MatrixID)
gen_object_model_3d_from_points (1, 2, 3, ObjectM..."
4d47121d,micro,4,,"if (sum(IsSerializableElem [==] 0) &gt; 0)
tuple_replace (TupleToSerialize, find(IsSerializableElem,0), HNULL, SerializableTupleToSerialize)
else
SerializableTupleToSerialize := TupleToSerialize
endif",29,35,"* --- Automatically Added Context ---
TupleToSerialize := [MatrixID,WindowHandle,ObjectModel3D,HNULL,1, 2, 'foobar']
create_matrix (3, 3, 0, MatrixID)
gen_object_model_3d_from_points (1, 2, 3, ObjectM..."
4d47121d,micro,5,,"serialize_tuple (SerializableTupleToSerialize, SerializedTuple)",36,38,"* --- Automatically Added Context ---
tuple_replace (TupleToSerialize, find(IsSerializableElem,0), HNULL, SerializableTupleToSerialize)
* --- End of Automatically Added Context ---"
4d47121d,micro,6,"Note that handles will be duplicated, i.e., a copy of the original matrix and
3D object model have b...","deserialize_tuple (SerializedTuple, Tuple)",39,43,"* --- Automatically Added Context ---
serialize_tuple (SerializableTupleToSerialize, SerializedTuple)
* --- End of Automatically Added Context ---"
4d47121d,micro,7,the serialization operators for the various sem_types,"serialize_matrix (MatrixID, SerializedMatrix)
deserialize_handle (SerializedMatrix, MatrixID1)",44,47,"* --- Automatically Added Context ---
create_matrix (3, 3, 0, MatrixID)
* --- End of Automatically Added Context ---"
4d47121d,micro,8,,"tuple_sem_type (MatrixID1, SemType)
serialize_handle (MatrixID, SerializedItem)
deserialize_matrix (SerializedItem, MatrixID2)
tuple_sem_type (MatrixID2, SemType)",48,53,"* --- Automatically Added Context ---
create_matrix (3, 3, 0, MatrixID)
serialize_tuple (TupleToSerialize, SerializedItem)
deserialize_handle (SerializedMatrix, MatrixID1)
* --- End of Automatically A..."
4d47121d,micro,9,"once all references to them are overwritten.
To manually clear a handle, use the operator clear_hand...","clear_handle (MatrixID2)
tuple_sem_type (MatrixID2, SemType1)",54,66,"* --- Automatically Added Context ---
deserialize_matrix (SerializedItem, MatrixID2)
* --- End of Automatically Added Context ---"
34fa87d8,full,0,"This example program shows how to use the operators
write_contour_xld_dxf and read_contour_xld_dxf a...","read_image (Image, 'mreut')
edges_sub_pix (Image, Edges, 'canny', 2, 20, 40)
regress_contours_xld (Edges, RegressContours, 'no', 1)
select_obj (RegressContours, ObjectSelected, 1)
query_contour_attribs_xld (ObjectSelected, Attribs)
query_contour_global_attribs_xld (ObjectSelected, GlobalAttribs)
wri...",11,41,
34fa87d8,micro,1,,"read_image (Image, 'mreut')
edges_sub_pix (Image, Edges, 'canny', 2, 20, 40)",10,13,
34fa87d8,micro,2,,"regress_contours_xld (Edges, RegressContours, 'no', 1)",14,16,"* --- Automatically Added Context ---
edges_sub_pix (Image, Edges, 'canny', 2, 20, 40)
* --- End of Automatically Added Context ---"
34fa87d8,micro,3,are available for the contours.,"select_obj (RegressContours, ObjectSelected, 1)
query_contour_attribs_xld (ObjectSelected, Attribs)
query_contour_global_attribs_xld (ObjectSelected, GlobalAttribs)",17,22,"* --- Automatically Added Context ---
regress_contours_xld (Edges, RegressContours, 'no', 1)
* --- End of Automatically Added Context ---"
34fa87d8,micro,4,contains also the attributes and global attributes.,"write_contour_xld_dxf (RegressContours, 'contours')",23,26,"* --- Automatically Added Context ---
regress_contours_xld (Edges, RegressContours, 'no', 1)
* --- End of Automatically Added Context ---"
34fa87d8,micro,5,"read_contours_xld_dxf, the (global) attributes are read, too.","read_contour_xld_dxf (ContoursRead, 'contours', [], [], DxfStatusCont)",27,30,
34fa87d8,micro,6,"original contours (RegressContours) are available also for the
contours (ContoursRead) that have bee...","select_obj (ContoursRead, ObjectSelected, 1)
query_contour_attribs_xld (ObjectSelected, AttribsTest)
query_contour_global_attribs_xld (ObjectSelected, GlobalAttribsTest)",31,37,"* --- Automatically Added Context ---
select_obj (RegressContours, ObjectSelected, 1)
read_contour_xld_dxf (ContoursRead, 'contours', [], [], DxfStatusCont)
* --- End of Automatically Added Context --..."
34fa87d8,micro,7,,"gen_polygons_xld (ContoursRead, Polygons, 'ramer', 2)
write_polygon_xld_dxf (Polygons, 'polygons')
read_polygon_xld_dxf (PolygonsRead, 'polygons', [], [], DxfStatusPoly)",38,47,"* --- Automatically Added Context ---
read_contour_xld_dxf (ContoursRead, 'contours', [], [], DxfStatusCont)
* --- End of Automatically Added Context ---"
5be31419,full,0,"This example demonstrates how to calculate the absolute gray
values of an image using the operator '...","dev_close_window ()
dev_update_off ()
read_image (Scene00, 'autobahn/scene_00')
read_image (Scene01, 'autobahn/scene_01')
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')
sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dev_open_...",12,36,
5be31419,micro,1,"values of an image using the operator 'abs_image'.
The absolute gray values are calculated of an ima...","dev_close_window ()
dev_update_off ()",6,14,
5be31419,micro,2,,"read_image (Scene00, 'autobahn/scene_00')
read_image (Scene01, 'autobahn/scene_01')
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')",15,20,
5be31419,micro,3,"the calculation of the absolute gray values and display
the result","sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dev_open_window_fit_image (ImageSub, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImageSub)
disp_message (WindowHandle, 'Calculate the absolute gray values', 'window', 12, 12, 'black...",21,31,"* --- Automatically Added Context ---
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')
* --- End of Automatically Added Context ---"
5be31419,micro,4,from the subtraction,"abs_image (ImageSub, ImageAbs)
dev_display (ImageAbs)
disp_message (WindowHandle, 'Resulting image of absolute gray values', 'window', 12, 12, 'black', 'true')",32,42,"* --- Automatically Added Context ---
sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dev_open_window_fit_image (ImageSub, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Con..."
4c465750,full,0,"This example demonstrates how to add two images with
the operator 'add_image'.","dev_close_window ()
dev_update_off ()
read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16,...",10,36,
4c465750,micro,1,the operator 'add_image'.,"dev_close_window ()
dev_update_off ()",6,12,
4c465750,micro,2,in each image,"read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)",13,19,
4c465750,micro,3,,"dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImagePart1)
disp_message (WindowHandle, 'Image 1', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display...",20,31,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
* --- End of Automatically Added Context ---"
4c465750,micro,4,adaption. The resulting image is stored in ImageResult.,"add_image (ImagePart1, ImagePart2, ImageResult, 0.5, 0)
dev_display (ImageResult)
disp_message (WindowHandle, 'Resulting image of the addition', 'window', 12, 12, 'black', 'true')",32,42,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
*..."
70b1e8d5,full,0,"This example demonstrates how to divide two images
using the operator 'div_image'.","dev_close_window ()
dev_update_off ()
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.2, 0.2, 128, 256, 256, 512, 512)
dev_open_window_fit_image (Scene00, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Scene00)
di...",10,33,
70b1e8d5,micro,1,using the operator 'div_image'.,"dev_close_window ()
dev_update_off ()",6,12,
70b1e8d5,micro,2,by creating a gray value ramp,"read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.2, 0.2, 128, 256, 256, 512, 512)",13,17,
70b1e8d5,micro,3,,"dev_open_window_fit_image (Scene00, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Scene00)
disp_message (WindowHandle, 'Divide the image by a gray value ramp', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'tr...",18,29,"* --- Automatically Added Context ---
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.2, 0.2, 128, 256, 256, 512, 512)
* --- End of Automatically Added Context ---"
70b1e8d5,micro,4,,"div_image (Scene00, ImageGrayRamp, ImageResult, 255, 0)
dev_display (ImageResult)
disp_message (WindowHandle, 'Resulting image of the division', 'window', 12, 12, 'black', 'true')",30,39,"* --- Automatically Added Context ---
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.2, 0.2, 128, 256, 256, 512, 512)
dev_open_window_fit_image (Scene00, 0, 0, -1, -1,..."
f0b106bf,full,0,"This example demonstrates how to calculate the maximum of
two images, pixel by pixel, using the oper...","dev_close_window ()
dev_update_off ()
read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16,...",10,36,
f0b106bf,micro,1,"two images, pixel by pixel, using the operator 'max_image'.","dev_close_window ()
dev_update_off ()",6,12,
f0b106bf,micro,2,area in each image,"read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)",13,19,
f0b106bf,micro,3,,"dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImagePart1)
disp_message (WindowHandle, 'Image 1', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display...",20,31,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
* --- End of Automatically Added Context ---"
f0b106bf,micro,4,and display the resulting image,"max_image (ImagePart1, ImagePart2, ImageMax)
dev_display (ImageMax)
disp_message (WindowHandle, 'Resulting image of the maximization', 'window', 12, 12, 'black', 'true')",32,42,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
*..."
5ae72ac8,full,0,"This example demonstrates how to calculate the minimum of
two images, pixel by pixel, using the oper...","dev_close_window ()
dev_update_off ()
read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16,...",10,36,
5ae72ac8,micro,1,"two images, pixel by pixel, using the operator 'min_image'.","dev_close_window ()
dev_update_off ()",6,12,
5ae72ac8,micro,2,area in each image,"read_image (Image1, 'patras')
read_image (Image2, 'brycecanyon1')
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)",13,19,
5ae72ac8,micro,3,,"dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImagePart1)
disp_message (WindowHandle, 'Image 1', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display...",20,31,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
* --- End of Automatically Added Context ---"
5ae72ac8,micro,4,and display the resulting image,"min_image (ImagePart1, ImagePart2, ImageMin)
dev_display (ImageMin)
disp_message (WindowHandle, 'Resulting image of the minimization', 'window', 12, 12, 'black', 'true')",32,42,"* --- Automatically Added Context ---
crop_part (Image1, ImagePart1, 0, 0, 512, 480)
crop_part (Image2, ImagePart2, 0, 0, 512, 480)
dev_open_window_fit_image (ImagePart1, 0, 0, -1, -1, WindowHandle)
*..."
7a528d67,full,0,"This example demonstrates how to multiply two images using
the operator 'mult_image'.","dev_close_window ()
dev_update_off ()
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.5, 0.5, 128, 256, 256, 512, 512)
dev_open_window_fit_image (Scene00, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Scene00)
di...",10,34,
7a528d67,micro,1,the operator 'mult_image'.,"dev_close_window ()
dev_update_off ()",6,12,
7a528d67,micro,2,by creating a gray value ramp,"read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.5, 0.5, 128, 256, 256, 512, 512)",13,17,
7a528d67,micro,3,,"dev_open_window_fit_image (Scene00, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Scene00)
disp_message (WindowHandle, 'Multiply the image with a gray value ramp', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black',...",18,29,"* --- Automatically Added Context ---
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.5, 0.5, 128, 256, 256, 512, 512)
* --- End of Automatically Added Context ---"
7a528d67,micro,4,adaption and display the resulting image,"mult_image (Scene00, ImageGrayRamp, ImageResult, 0.005, 0)
dev_display (ImageResult)
disp_message (WindowHandle, 'Resulting image of the product', 'window', 12, 12, 'black', 'true')",30,40,"* --- Automatically Added Context ---
read_image (Scene00, 'autobahn/scene_00')
gen_image_gray_ramp (ImageGrayRamp, 0.5, 0.5, 128, 256, 256, 512, 512)
dev_open_window_fit_image (Scene00, 0, 0, -1, -1,..."
3643e5a7,full,0,"This example demonstrates how to subtract two images
using the operator 'sub_image'.","dev_close_window ()
dev_update_off ()
read_image (Scene00, 'autobahn/scene_00')
read_image (Scene01, 'autobahn/scene_01')
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')
dev_open_window_fit_image (ImageConverted1, 0, 0, -1, -1, WindowHandle...",10,34,
3643e5a7,micro,1,using the operator 'sub_image'.,"dev_close_window ()
dev_update_off ()",6,12,
3643e5a7,micro,2,,"read_image (Scene00, 'autobahn/scene_00')
read_image (Scene01, 'autobahn/scene_01')
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')",13,18,
3643e5a7,micro,3,,"dev_open_window_fit_image (ImageConverted1, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (ImageConverted1)
disp_message (WindowHandle, 'Image 1', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
d...",19,30,"* --- Automatically Added Context ---
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')
* --- End of Automatically Added Context ---"
3643e5a7,micro,4,,"sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dev_display (ImageSub)
disp_message (WindowHandle, 'Resulting image of the subtraction', 'window', 12, 12, 'black', 'true')",31,40,"* --- Automatically Added Context ---
convert_image_type (Scene00, ImageConverted1, 'int2')
convert_image_type (Scene01, ImageConverted2, 'int2')
dev_open_window_fit_image (ImageConverted1, 0, 0, -1, ..."
b908e56c,full,0,,"dev_update_off ()
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Original image', 'window...",6,107,
b908e56c,micro,1,,"simulate_bayer_image (Image, ImageCFA)
dev_display (ImageCFA)
disp_message (WindowHandle, 'Bayer image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",16,21,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
b908e56c,micro,2,,"Interpolations := ['bilinear', 'bilinear_dir', 'bilinear_enhanced']
NumIntModes := |Interpolations|
gen_empty_obj (RGBImages)
gen_empty_obj (SubImages)
for I := 0 to NumIntModes - 1 by 1
Interpolation := Interpolations[I]
cfa_to_rgb (ImageCFA, RGBImage, 'bayer_gb', Interpolation)
sub_image (Image, R...",22,46,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
simulate_bayer_image (Image, ImageCFA)
* --- End of Automatically Added ..."
b908e56c,micro,3,,"PartWidth := 140
PartHeight := 93
PartsRow := [122, 62]
PartsColumn := [79, 471]
dev_close_window ()
dev_open_window (0, 0, PartWidth * 3 * 2, PartHeight * 3 * 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
concat_obj (Image, RGBImages, OrigRGBImages)
concat_o...",47,117,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'Origi..."
443af0c9,full,0,"Compare the processing time difference between the color space
transformation using trans_from/to_rg...","dev_update_off ()
duration_without_lut := []
duration_with_lut := []
duration_without_lut2 := []
duration_with_lut2 := []
Spaces := ['', ' ', '  ', '   ', '    ', '     ']
NumLoops := 10
read_image (Image, 'montery')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600],...",11,100,
443af0c9,micro,1,,"dev_update_off ()
duration_without_lut := []
duration_with_lut := []
duration_without_lut2 := []
duration_with_lut2 := []
Spaces := ['', ' ', '  ', '   ', '    ', '     ']
NumLoops := 10
read_image (Image, 'montery')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600],...",10,23,
443af0c9,micro,2,,"dev_display (Image)
disp_message (WindowHandle, ['Performing color space transformation   ', 'from RGB to ...'], 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Runtime         with LUT     without LUT', 'window', 60, 12, 'black', 'true')
get_param_info ('trans_from_rgb', 'ColorSpace...",24,63,"* --- Automatically Added Context ---
Spaces := ['', ' ', '  ', '   ', '    ', '     ']
NumLoops := 10
read_image (Image, 'montery')
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], Win..."
443af0c9,micro,3,,"dev_display (Image)
disp_message (WindowHandle, ['Performing color space transformation   ', 'from ... to RGB'], 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Runtime         with LUT     without LUT', 'window', 60, 12, 'black', 'true')
get_param_info ('trans_to_rgb', 'ColorSpace',...",64,106,"* --- Automatically Added Context ---
Spaces := ['', ' ', '  ', '   ', '    ', '     ']
NumLoops := 10
read_image (Image, 'montery')
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], Win..."
7cd1b45b,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
sobel_amp (Image, EdgeAmplitude, 'thin_sum_abs', 3)
threshold (EdgeAmplitude, Edges, 30, 255)
close_edges (Edges, EdgeAmplitude, EdgesExtended, 15)
dev_set_...",6,16,
c97168ec,full,0,,"read_image (Image, 'fabrik')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
sobel_amp (Image, EdgeAmplitude, 'thin_sum_abs', 3)
threshold (EdgeAmplitude, Edges, 30, 255)
close_edges_length (Edges, EdgeAmplitude, ClosedEdges, 8, 100)...",6,16,
14481c29,full,0,usage as smoothing filter,"read_image (Meningg5, 'meningg5')
derivate_gauss (Meningg5, Smoothed, 2, 'none')
convert_image_type (Smoothed, SmoothedByte, 'byte')
watersheds (SmoothedByte, Basins, Watersheds)
dev_display (Meningg5)
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (Basins)
stop ()
read_image (Image, 'mreut...",7,41,
14481c29,micro,1,,"read_image (Meningg5, 'meningg5')
derivate_gauss (Meningg5, Smoothed, 2, 'none')
convert_image_type (Smoothed, SmoothedByte, 'byte')
watersheds (SmoothedByte, Basins, Watersheds)
dev_display (Meningg5)
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (Basins)
stop ()",6,15,
14481c29,micro,2,,"read_image (Image, 'mreut')
derivate_gauss (Image, GradientAmpl, 1.5, 'gradient')
threshold (GradientAmpl, Gradient, 10, 255)
dev_display (Image)
dev_set_draw ('fill')
dev_set_color ('red')
dev_display (Gradient)
stop ()",16,24,
14481c29,micro,3,,"read_image (Image, 'fabrik')
derivate_gauss (Image, Det, 1.5, 'det')
threshold (Det, Corners, 20, 1000000)
dev_display (Image)
dev_set_draw ('fill')
dev_set_color ('red')
dev_display (Corners)
stop ()",25,33,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
14481c29,micro,4,,"read_image (Image, 'mreut')
derivate_gauss (Image, EdgesAreZero, 3, '2nd_ddg')
zero_crossing (EdgesAreZero, Edges)
dev_display (Image)
dev_set_draw ('fill')
dev_set_color ('red')
dev_display (Edges)",34,47,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
2ef3b586,full,0,,"read_image (Image, 'mreut')
diff_of_gauss (Image, DiffOfGauss, 5, 1.6)
zero_crossing (DiffOfGauss, RegionCrossing1)
stop ()
laplace_of_gauss (Image, ImageLaplace, 5)
zero_crossing (ImageLaplace, RegionCrossing2)
stop ()
derivate_gauss (Image, DerivGauss, 5, 'laplace')
zero_crossing (DerivGauss, Regi...",6,14,
f3c1a3e1,full,0,"This example program shows how to use edges_color and the differences
between the output of edges_co...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
M...",9,89,
f3c1a3e1,micro,1,"between the output of edges_color and edges_image using an image in which
some edges can only be ext...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
M...",6,19,
f3c1a3e1,micro,2,between the soccer field and the track in the gray value image.,"rgb1_to_gray (Image, GrayImage)
dev_display (GrayImage)
Message := 'Gray value image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",20,26,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
* --- End of Automatically Added Conte..."
f3c1a3e1,micro,3,"thresholding, i.e., the raw edge amplitude image.  Note that there is a clearly
visible edge between...","edges_color (Image, ImaAmp, ImaDir, 'canny', 1, 'none', -1, -1)
dev_display (ImaAmp)
Message := 'Color edge image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",27,34,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
* --- End of Automatically Added Conte..."
f3c1a3e1,micro,4,"hysteresis thresholding, i.e., the raw edge amplitude image.  Note that there is
no visible edge bet...","edges_image (GrayImage, ImaAmpGray, ImaDirGray, 'canny', 1, 'none', -1, -1)
dev_display (ImaAmpGray)
Message := 'Gray value edge image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",35,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
rgb1_to_gray (Image, GrayImage)
* --- End of Automatically Added Context ---"
f3c1a3e1,micro,5,"and hysteresis thresholding.  Note the segmented edge between the soccer
field and the track.","edges_color (Image, ImaAmpHyst, ImaDirHyst, 'canny', 1, 'nms', 20, 40)
threshold (ImaAmpHyst, RegionColor, 1, 255)
skeleton (RegionColor, EdgesColor)
dev_display (Image)
dev_set_color ('blue')
dev_display (EdgesColor)
Message := 'Segmented color edges'
disp_message (WindowHandle, Message, 'window', ...",44,55,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
* --- End of Automatically Added Conte..."
f3c1a3e1,micro,6,"suppression and hysteresis thresholding.  Note the absence of an edge
between the soccer field and t...","edges_image (GrayImage, ImaAmpGrayHyst, ImaDirGrayHyst, 'canny', 1, 'nms', 20, 40)
threshold (ImaAmpGrayHyst, RegionGray, 1, 255)
skeleton (RegionGray, EdgesGray)
dev_display (GrayImage)
dev_set_color ('blue')
dev_display (EdgesGray)
Message := 'Segmented gray value edges'
disp_message (WindowHandle...",56,67,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
rgb1_to_gray (Image, GrayImage)
* --- End of Automatically Added Context ---"
f3c1a3e1,micro,7,containing the soccer field and the track.,"Row1 := 220
Col1 := 215
Row2 := 399
Col2 := 489
dev_set_part (Row1, Col1, Row2, Col2)
dev_display (Image)
stop ()
dev_display (GrayImage)
stop ()
dev_display (ImaAmp)
stop ()
dev_display (ImaAmpGray)
stop ()
dev_display (Image)
dev_set_color ('blue')
dev_display (EdgesColor)
stop ()
dev_display (Gra...",68,95,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
rgb1_to_gray (Image, GrayImage)
edges_color (Image, ImaAmp, ImaDir, 'canny', 1, 'none', -1, -1)
edges_image (GrayImage, ImaA..."
0c7e3517,full,0,"This example program shows how to use edges_color_sub_pix and the
differences between the output of ...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
M...",9,62,
0c7e3517,micro,1,"differences between the output of edges_color_sub_pix and edges_sub_pix
using an image in which some...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
M...",6,19,
0c7e3517,micro,2,between the soccer field and the track in the gray value image.,"rgb1_to_gray (Image, GrayImage)
dev_display (GrayImage)
Message := 'Gray value image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",20,26,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
* --- End of Automatically Added Conte..."
0c7e3517,micro,3,edge between the soccer field and the track.,"edges_color_sub_pix (Image, EdgesColor, 'canny', 1, 20, 40)
dev_display (Image)
dev_set_color ('blue')
dev_display (EdgesColor)
Message := 'Segmented color edges'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",27,35,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
* --- End of Automatically Added Conte..."
0c7e3517,micro,4,of an edge between the soccer field and the track.,"edges_sub_pix (GrayImage, EdgesGray, 'canny', 1, 20, 40)
dev_display (GrayImage)
dev_set_color ('blue')
dev_display (EdgesGray)
Message := 'Segmented gray value edges'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",36,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Color image'
rgb1_to_gray (Image, GrayImage)
* --- End of Automatically Added Context ---"
0c7e3517,micro,5,containing the soccer field and the track.,"Row1 := 220
Col1 := 215
Row2 := 399
Col2 := 489
dev_set_part (Row1, Col1, Row2, Col2)
dev_display (Image)
stop ()
dev_display (GrayImage)
stop ()
dev_display (Image)
dev_set_color ('blue')
dev_display (EdgesColor)
stop ()
dev_display (GrayImage)
dev_set_color ('blue')
dev_display (EdgesGray)",45,68,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
rgb1_to_gray (Image, GrayImage)
edges_color_sub_pix (Image, EdgesColor, 'canny', 1, 20, 40)
edges_sub_pix (GrayImage, EdgesG..."
a96fe13e,full,0,,"read_image (Image, 'fabrik')
edges_image (Image, ImaAmp, ImaDir, 'lanser2', 0.5, 'nms', 12, 22)
threshold (ImaAmp, Edges, 1, 255)
skeleton (Edges, Skeleton)
gen_contours_skeleton_xld (Skeleton, Contours, 1, 'filter')
dev_display (Image)
dev_set_colored (6)
dev_display (Contours)",6,13,
e54ac92d,full,0,"This example shows how subpixel precise edges can be
extracted from an image.","dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 2, 12, 22)
dev_set_part (0, 0, 511, 511)
dev_display (Image)
dev_set_colored (6)
dev_display (Edges)
disp_continue_message (WindowHandle, 'black', 'tru...",9,24,
e54ac92d,micro,1,extracted from an image.,"dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)",7,11,
e54ac92d,micro,2,connected edges in the image.,"edges_sub_pix (Image, Edges, 'canny', 2, 12, 22)
dev_set_part (0, 0, 511, 511)
dev_display (Image)
dev_set_colored (6)
dev_display (Edges)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",12,20,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
e54ac92d,micro,3,,"dev_set_part (160, 250, 210, 300)
dev_display (Image)
dev_display (Edges)",21,30,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
edges_sub_pix (Image, Edges, 'canny', 2, 12, 22)
* --- End of Automatically Added Context ---"
eeed01ad,full,0,,"read_image (Image, 'fabrik')
frei_amp (Image, ImageEdgeAmp)
threshold (ImageEdgeAmp, Region, 20, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
26a2dd3a,full,0,,"read_image (Image, 'fabrik')
frei_dir (Image, ImageEdgeAmp, ImageEdgeDir)
nonmax_suppression_dir (ImageEdgeAmp, ImageEdgeDir, ImageResult, 'nms')
threshold (ImageResult, Region, 20, 255)
dev_display (Image)
dev_set_color ('red')
dev_display (Region)",6,12,
5480cefb,full,0,,"read_image (Image, 'particle')
highpass_image (Image, Highpass, 21, 21)
threshold (Highpass, Region, 132, 255)
opening_circle (Region, RegionOpening, 1.5)
dev_display (Image)
dev_display (RegionOpening)",6,11,
0c5cafa4,full,0,,"read_image (Image, 'fabrik')
Alpha := 0.3
Filter := 'lanser2'
info_edges (Filter, 'edge', Alpha, Size, Coeffs)
edges_image (Image, ImaAmp, ImaDir, Filter, Alpha, 'nms', 12, 22)
threshold (ImaAmp, Edges, 1, 255)
skeleton (Edges, Skeleton)
gen_contours_skeleton_xld (Skeleton, Contours, 1, 'filter')
de...",6,16,
88d79c5e,full,0,,"read_image (Image, 'fabrik')
kirsch_amp (Image, ImageEdgeAmp)
threshold (ImageEdgeAmp, Region, 70, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
37f1fa9c,full,0,,"read_image (Image, 'fabrik')
kirsch_dir (Image, ImageEdgeAmp, ImageEdgeDir)
nonmax_suppression_dir (ImageEdgeAmp, ImageEdgeDir, ImageResult, 'nms')
threshold (ImageResult, Region, 60, 255)
dev_display (Image)
dev_set_color ('red')
dev_display (Region)",6,12,
084d4de4,full,0,,"read_image (Image, 'mreut')
laplace (Image, ImageLaplace_3, 'signed', 3, 'n_8_isotropic')
zero_crossing (ImageLaplace_3, RegionCrossing_3)
laplace (Image, ImageLaplace_11, 'signed', 11, 'n_8_isotropic')
zero_crossing (ImageLaplace_11, RegionCrossing_11)
laplace_of_gauss (Image, ImageLaplaceG, 5)
zer...",6,12,
639857a5,full,0,,"dev_close_window ()
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
diff_of_gauss (Image, DiffOfGauss, 5, 1.6)
zero_crossing (DiffOfGauss, RegionCrossing1)
disp_continu...",6,21,
be3865fe,full,0,,"read_image (Image, 'fabrik')
prewitt_amp (Image, ImageEdgeAmp)
threshold (ImageEdgeAmp, Region, 20, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
835b61c7,full,0,,"read_image (Image, 'fabrik')
prewitt_dir (Image, ImageEdgeAmp, ImageEdgeDir)
nonmax_suppression_dir (ImageEdgeAmp, ImageEdgeDir, ImageResult, 'nms')
threshold (ImageResult, Region, 20, 255)
dev_display (Image)
dev_set_color ('red')
dev_display (Region)",6,12,
6a52cc9d,full,0,,"read_image (Image, 'fabrik')
roberts (Image, ImageRoberts, 'roberts_max')
threshold (ImageRoberts, Region, 9, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
ca5af0fd,full,0,,"read_image (Image, 'fabrik')
robinson_amp (Image, ImageEdgeAmp)
threshold (ImageEdgeAmp, Region, 20, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
e08834eb,full,0,,"read_image (Image, 'fabrik')
robinson_dir (Image, ImageEdgeAmp, ImageEdgeDir)
nonmax_suppression_dir (ImageEdgeAmp, ImageEdgeDir, ImageResult, 'nms')
threshold (ImageResult, Region, 20, 255)
dev_display (Image)
dev_set_color ('red')
dev_display (Region)",6,12,
a8ff4518,full,0,,"read_image (Image, 'fabrik')
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 3)
threshold (EdgeAmplitude, Region, 10, 255)
skeleton (Region, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
c033443a,full,0,,"read_image (Image, 'fabrik')
sobel_dir (Image, EdgeAmplitude, EdgeDirection, 'sum_abs', 3)
nonmax_suppression_dir (EdgeAmplitude, EdgeDirection, ImageResult, 'nms')
threshold (ImageResult, Region, 10, 255)
dev_display (Image)
dev_set_color ('red')
dev_display (Region)",6,12,
8c712919,full,0,"This example program shows how coherence_enhancing_diff can be used
to enhance a fingerprint image b...","read_image (Image, 'fingerprint')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (Image)
stop ()
coherence_enhancing_diff (Image, ImageCED, 0.5, 4, 0.5, 50)
dev_display (ImageCED)",9,16,
8c712919,micro,1,"to enhance a fingerprint image by joining disconnected parts of the
fingerprint lines.","read_image (Image, 'fingerprint')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (Image)
stop ()
coherence_enhancing_diff (Image, ImageCED, 0.5, 4, 0.5, 50)
dev_display (ImageCED)",6,22,
a84972c9,full,0,,"read_image (Meningr4, 'mreut')
emphasize (Meningr4, ImageEmphasize, 7, 7, 1.5)
dev_set_part (134, 90, 257, 226)
dev_display (Meningr4)
stop ()
dev_display (ImageEmphasize)",6,11,
830ec5dd,full,0,"This example shows how to enhance the details of an image with
the help of a guided image filter.","read_image (Image, 'angio-part')
guided_filter (Image, Image, ImageSmooth, 5, 10)
sub_image (Image, ImageSmooth, ImageDetail, 5, 0)
add_image (ImageDetail, Image, ImageDetailEnhanced, 1, 0)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
get_window_extents (WindowH...",9,31,
830ec5dd,micro,1,the help of a guided image filter.,"read_image (Image, 'angio-part')",6,9,
830ec5dd,micro,2,,"guided_filter (Image, Image, ImageSmooth, 5, 10)",10,11,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
* --- End of Automatically Added Context ---"
830ec5dd,micro,3,"we get the details.
After that, the details are added to the original,
enhancing it.","sub_image (Image, ImageSmooth, ImageDetail, 5, 0)
add_image (ImageDetail, Image, ImageDetailEnhanced, 1, 0)",12,18,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
guided_filter (Image, Image, ImageSmooth, 5, 10)
* --- End of Automatically Added Context ---"
830ec5dd,micro,4,,"dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, Width, Height)
dev_open_window_fit_image (Image, 0, Width + 8, -1, -1, WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (Win...",19,37,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
add_image (ImageDetail, Image, ImageDetailEnhanced, 1, 0)
* --- End of Automatically Added Context ---"
288a6b99,full,0,,"read_image (Vessel, 'vessel')
equ_histo_image (Vessel, ImageEquHisto)",6,7,
45a0d543,full,0,"This example shows how to use the operator equ_histo_image_rect
to enhance the local contrast in an ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'angio-part')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
equ_histo_image (Image, ImageEquHisto)
dev_display (ImageEquHisto)
disp_continue_mess...",9,48,
45a0d543,micro,1,to enhance the local contrast in an image.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'angio-part')",6,13,
45a0d543,micro,2,Note that the low-contrast structures are hardly visible.,"dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",14,20,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
* --- End of Automatically Added Context ---"
45a0d543,micro,3,"Note that some details are still hard to see, especially
in the very bright and very dark regions.","equ_histo_image (Image, ImageEquHisto)
dev_display (ImageEquHisto)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",21,28,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
45a0d543,micro,4,"Note that the contrast of fine structures has been increased,
but also the noise level in the image.","equ_histo_image_rect (Image, ImageEquHistoRect, 'accurate', 51, 51, 1)
dev_display (ImageEquHistoRect)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",29,36,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
45a0d543,micro,5,Fine structures are clearly visible while noise is suppressed.,"equ_histo_image_rect (Image, ImageEquHistoRectLimited, 'accurate', 51, 51, 0.02)
dev_display (ImageEquHistoRectLimited)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",37,43,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
45a0d543,micro,6,"Note that the result has a similar visual appearance to the 'accurate' mode,
but it is not exactly t...","equ_histo_image_rect (Image, ImageEquHistoRectFast, 'fast', 51, 51, 0.02)
dev_display (ImageEquHistoRectFast)",44,54,"* --- Automatically Added Context ---
read_image (Image, 'angio-part')
* --- End of Automatically Added Context ---"
4a3e1281,full,0,,"read_image (Image, 'fabrik')
illuminate (Image, ImageIlluminate, 101, 101, 0.7)",6,7,
70a1498c,full,0,"This example programs shows how mean_curvature_flow can be used
to enhance an angiographic image by ...","dev_close_window ()
dev_open_window (0, 0, 400, 400, 'black', WindowHandle)
read_image (Image, 'angio-part')
dev_display (Image)
stop ()
mean_curvature_flow (Image, ImageMCF, 0.5, 0.5, 10)
dev_display (ImageMCF)",9,15,
70a1498c,micro,1,"to enhance an angiographic image by preserving the edge information
while smoothing the background n...","dev_close_window ()
dev_open_window (0, 0, 400, 400, 'black', WindowHandle)
read_image (Image, 'angio-part')
dev_display (Image)
stop ()
mean_curvature_flow (Image, ImageMCF, 0.5, 0.5, 10)
dev_display (ImageMCF)",6,21,
3799acd1,full,0,,"read_image (Vessel, 'vessel')
scale_image_max (Vessel, ImageScaleMax)",6,7,
6ec4bb5b,full,0,"This example program shows how a defocused image can be sharpened
with shock_filter.","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
dev_set_part (0, 0, 479, 639)
read_image (Image, 'datacode/ecc200/ecc200_cpu_015')
fill_interlace (Image, ImageFilled, 'odd')
dev_display (ImageFilled)
stop ()
shock_filter (ImageFilled, SharpenedImage, 0.5, 10, 'laplace', 1...",8,26,
6ec4bb5b,micro,1,with shock_filter.,"dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
dev_set_part (0, 0, 479, 639)
read_image (Image, 'datacode/ecc200/ecc200_cpu_015')",6,11,
6ec4bb5b,micro,2,,"fill_interlace (Image, ImageFilled, 'odd')
dev_display (ImageFilled)
stop ()",12,15,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_cpu_015')
* --- End of Automatically Added Context ---"
6ec4bb5b,micro,3,"tends to straighten edges.  However, in this case we want to preserve the
corners of the data code m...","shock_filter (ImageFilled, SharpenedImage, 0.5, 10, 'laplace', 1.5)
dev_display (SharpenedImage)
stop ()
dev_set_part (160, 330, 369, 609)
dev_display (ImageFilled)
stop ()
dev_display (SharpenedImage)",16,32,"* --- Automatically Added Context ---
fill_interlace (Image, ImageFilled, 'odd')
* --- End of Automatically Added Context ---"
c297bc59,full,0,"This program shows how to detect defects (scratches) in
an inhomogeneously illuminated surface by fi...","dev_update_off ()
dev_close_window ()
read_image (Image, 'surface_scratch')
invert_image (Image, ImageInverted)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
* Messag...",16,58,
c297bc59,micro,1,"an inhomogeneously illuminated surface by filtering in
the frequency domain.
First, a suitable bandp...","dev_update_off ()
dev_close_window ()
read_image (Image, 'surface_scratch')
invert_image (Image, ImageInverted)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)",6,24,
c297bc59,micro,2,,"* Message := 'Optimize the speed of the fast Fourier transform.'
* Message[1] := 'Please wait...'
* disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
* optimize_rft_speed (Width, Height, 'standard')
* disp_continue_message (WindowHandle, 'black', 'true')
* stop ()",25,32,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
c297bc59,micro,3,,"gen_sin_bandpass (ImageBandpass, 0.4, 'none', 'rft', Width, Height)
rft_generic (ImageInverted, ImageFFT, 'to_freq', 'none', 'complex', Width)
convol_fft (ImageFFT, ImageBandpass, ImageConvol)
rft_generic (ImageConvol, Lines, 'from_freq', 'n', 'byte', Width)",33,38,"* --- Automatically Added Context ---
invert_image (Image, ImageInverted)
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
c297bc59,micro,4,,"threshold (Lines, Region, 5, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5, 5000)
dilation_circle (SelectedRegions, RegionDilation, 5.5)
union1 (RegionDilation, RegionUnion)
reduce_domain (Image, RegionUnion, ImageReduced)
lines_gauss (I...",39,52,"* --- Automatically Added Context ---
read_image (Image, 'surface_scratch')
rft_generic (ImageConvol, Lines, 'from_freq', 'n', 'byte', Width)
* --- End of Automatically Added Context ---"
c297bc59,micro,5,,"dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colored (12)
dev_display (Image)
dev_display (RegionScratches)",53,64,"* --- Automatically Added Context ---
read_image (Image, 'surface_scratch')
dilation_circle (RegionUnion, RegionScratches, 10.5)
* --- End of Automatically Added Context ---"
fc60d076,full,0,,"gen_filter_mask (ImageFilterEE, 'laws_ee', 1.0, 512, 512)
fft_image (ImageFilterEE, EE)
gen_filter_mask (ImageFilterSS, 'laws_ss', 1.5, 512, 512)
fft_image (ImageFilterSS, SS)
gen_filter_mask (ImageFilterRR, 'laws_rr', 0.1, 512, 512)
fft_image (ImageFilterRR, RR)",6,11,
915cf21c,full,0,"This example program shows how to use gen_mean_filter to filter an
image using a circular mean filte...","dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
read_image (Image, 'circle_plate')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_di...",10,39,
915cf21c,micro,1,"image using a circular mean filter.  It also shows that using a circular
mean filter sometimes can b...","dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
read_image (Image, 'circle_plate')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_di...",6,21,
915cf21c,micro,2,of the third hole in the lower row of holes.,"mean_image (Image, ImageMeanRect, 31, 31)
dev_display (ImageMeanRect)
disp_message (WindowHandle, 'Mean image (square mean of diameter 31)', 'window', 10, 10, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",22,28,"* --- Automatically Added Context ---
read_image (Image, 'circle_plate')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
915cf21c,micro,3,"31x31 filter.  To do so, we have to set the diameter of the circle to
31*sqrt(4/pi) = 34.97975.  Not...","gen_mean_filter (MeanFilter, 'ellipse', 34.97975, 34.97975, 0, 'n', 'rft', Width, Height)
rft_generic (Image, ImageFFT, 'to_freq', 'none', 'complex', Width)
convol_fft (ImageFFT, MeanFilter, ImageConvol)
rft_generic (ImageConvol, ImageMeanCirc, 'from_freq', 'none', 'byte', Width)
dev_display (ImageM...",29,45,"* --- Automatically Added Context ---
read_image (Image, 'circle_plate')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
disp_message (Window..."
6fee2e34,full,0,"This example program shows how to use optimize_fft_speed to improve the
runtime of the FFT operators...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'fabrik')
* read_image (Image, 'mosaic/pcb_03')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
convert_image_type (Ima...",13,61,
6fee2e34,micro,1,"runtime of the FFT operators.  The same speed test is executed after
different optimizations have be...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')",6,15,
6fee2e34,micro,2,"with FFT algorithms.  Here, you typically may see significant differences
in the three optimization ...","read_image (Image, 'fabrik')",16,19,
6fee2e34,micro,3,"following line.  Here, typically the speed increase between the modes
standard and patient will be s...","* read_image (Image, 'mosaic/pcb_03')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)",20,27,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
6fee2e34,micro,4,"complex image.  This saves the overhead of doing the conversion in
fft_generic below.  Furthermore, ...","convert_image_type (Image, ImageComplex, 'complex')
Iter := 20",28,34,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
6fee2e34,micro,5,,"count_seconds (S1)
for J := 1 to Iter by 1
fft_generic (ImageComplex, ImageFFT, 'to_freq', -1, 'none', 'dc_edge', 'complex')
endfor
count_seconds (S2)
TimeNoOpt := (S2 - S1) / Iter
stop ()",35,42,"* --- Automatically Added Context ---
convert_image_type (Image, ImageComplex, 'complex')
Iter := 20
* --- End of Automatically Added Context ---"
6fee2e34,micro,6,take only a few seconds.,"optimize_fft_speed (Width, Height, 'standard')
count_seconds (S1)
for J := 1 to Iter by 1
fft_generic (ImageComplex, ImageFFT, 'to_freq', -1, 'none', 'dc_edge', 'complex')
endfor
count_seconds (S2)
TimeStandard := (S2 - S1) / Iter
stop ()",43,52,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
convert_image_type (Image, ImageComplex, 'complex')
Iter := 20
count_seconds (S1)
for J := 1 to Iter by 1
fft_generic (Image..."
6fee2e34,micro,7,than one minute.,"optimize_fft_speed (Width, Height, 'patient')
count_seconds (S1)
for J := 1 to Iter by 1
fft_generic (ImageComplex, ImageFFT, 'to_freq', -1, 'none', 'dc_edge', 'complex')
endfor
count_seconds (S2)
TimePatient := (S2 - S1) / Iter",53,67,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
convert_image_type (Image, ImageComplex, 'complex')
Iter := 20
count_seconds (S1)
for J := 1 to Iter by 1
fft_generic (Image..."
4f1bf650,full,0,"This example shows how phase_correlation_fft can be used to compute the
translation between two imag...","dev_update_off ()
read_image (Image, 'wafer/wafer_dies.png')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Original i...",8,92,
4f1bf650,micro,1,translation between two images.,"dev_update_off ()
read_image (Image, 'wafer/wafer_dies.png')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Original i...",6,17,
4f1bf650,micro,2,,"RowTrans := 92.4
ColumnTrans := 58.2
optimize_rft_speed (Width, Height, 'standard')
hom_mat2d_identity (HomMat2D)
hom_mat2d_translate (HomMat2D, RowTrans, ColumnTrans, HomMat2D)",18,23,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
4f1bf650,micro,3,defined values of 0 in the part that lies outside the original image.,"get_system ('init_new_image', InitNewImage)
set_system ('init_new_image', 'true')
affine_trans_image (Image, ImageTrans, HomMat2D, 'constant', 'false')
full_domain (ImageTrans, ImageTranslated)
set_system ('init_new_image', InitNewImage)",24,30,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_dies.png')
hom_mat2d_identity (HomMat2D)
* --- End of Automatically Added Context ---"
4f1bf650,micro,4,,"gen_image_surface_second_order (ImageSurface, 'byte', 0.0005, -0.0008, 0, 0, 0, 128, Height / 2, Width / 2, Width, Height)
add_image (ImageTranslated, ImageSurface, ImageDegraded, 1, -128)
dev_display (ImageDegraded)
disp_message (WindowHandle, ['Image translated by (' + RowTrans$'4.1f' + ',' + Colu...",31,37,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_dies.png')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
RowTrans := 92.4
Col..."
4f1bf650,micro,5,,"rft_generic (Image, ImageFFT, 'to_freq', 'none', 'complex', Width)
rft_generic (ImageDegraded, ImageTransFFT, 'to_freq', 'none', 'complex', Width)
phase_correlation_fft (ImageFFT, ImageTransFFT, ImagePhaseCorrelationFFT)
rft_generic (ImagePhaseCorrelationFFT, ImagePhaseCorrelation, 'from_freq', 'n',...",38,49,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_dies.png')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
RowTrans := 92.4
Col..."
4f1bf650,micro,6,"peaks in lower or right part of the image.  If the translation is close
0 in one or two directions, ...","RowOffset := Height / 2
ColumnOffset := Width / 2
cyclic_shift_image (ImagePhaseCorrelation, ImageCyclicShift, RowOffset, ColumnOffset)
local_max_sub_pix (ImageCyclicShift, 'facet', 1, 0.02, RowShifted, ColumnShifted)
Row := RowShifted - RowOffset
Column := ColumnShifted - ColumnOffset
dev_set_part ...",50,174,"* --- Automatically Added Context ---
read_image (Image, 'wafer/wafer_dies.png')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
add_image (ImageTran..."
dd403905,full,0,"This example program shows how to filter images with the real-valued
FFT using rft_generic.  It also...","dev_update_off ()
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := ...",10,119,
dd403905,micro,1,"FFT using rft_generic.  It also shows how to create Gaussian smoothing
filters and derivative filter...","dev_update_off ()
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := ...",6,19,
dd403905,micro,2,,"optimize_rft_speed (Width, Height, 'standard')
stop ()",20,22,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
dd403905,micro,3,"Gaussian filter with Sigma=3 and convolving the image in the frequency
domain.","gen_gauss_filter (GaussFilter, 3, 3, 0, 'n', 'rft', Width, Height)",23,26,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
dd403905,micro,4,,"rft_generic (Image, ImageFFT, 'to_freq', 'none', 'complex', Width)",27,28,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
dd403905,micro,5,,"convol_fft (ImageFFT, GaussFilter, ImageConvol)",29,30,"* --- Automatically Added Context ---
gen_gauss_filter (GaussFilter, 3, 3, 0, 'n', 'rft', Width, Height)
rft_generic (Image, ImageFFT, 'to_freq', 'none', 'complex', Width)
* --- End of Automatically A..."
dd403905,micro,6,,"rft_generic (ImageConvol, ImageFiltered, 'from_freq', 'none', 'real', Width)
dev_display (ImageFiltered)
Message := 'Result of Gaussian filtering'
Message[1] := 'in the frequency domain'
disp_message (WindowHandle, Message, 'window', 450, 12, 'black', 'true')
stop ()",31,37,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
convol_fft (ImageFFT, GaussFilter, Ima..."
dd403905,micro,7,"The major difference is the border treatment: the FFT by definition
assumes that the signal is perio...","derivate_gauss (Image, ImageGauss, 3, 'none')
dev_display (ImageGauss)
Message := 'Result of Gaussian filtering'
Message[1] := 'in the spatial domain'
disp_message (WindowHandle, Message, 'window', 450, 12, 'black', 'true')
stop ()",38,52,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
* --- End of Automatically Added Context ---"
dd403905,micro,8,,"gen_rectangle1 (Rectangle, 20, 20, Height - 21, Width - 21)
sub_image (ImageFiltered, ImageGauss, ImageSub, 1, 0)
min_max_gray (Rectangle, ImageSub, 0, Min, Max, Range)
intensity (Rectangle, ImageSub, Mean, Deviation)
dev_display (ImageSub)
Message := 'Gray value differences:'
Message[1] := 'Min: ' ...",53,62,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
rft_generic (ImageConvol, ImageFiltere..."
dd403905,micro,9,"derivative filter does not use any smoothing.  The filter is based on
the fact that the FFT can be i...","gen_derivative_filter (DerivativeFilter, 'x', 1, 'n', 'rft', Width, Height)
convol_fft (ImageFFT, DerivativeFilter, ImageConvol)
rft_generic (ImageConvol, ImageFiltered, 'from_freq', 'none', 'real', Width)
dev_display (ImageFiltered)
Message := 'Result of pure derivative'
Message[1] := 'in the frequ...",63,77,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
rft_generic (Image, ImageFFT, 'to_freq..."
dd403905,micro,10,"smoothed derivative filter.  This can simply be done by multiplying
the two filters.  Since the smoo...","convert_image_type (GaussFilter, GaussFilterComplex, 'complex')
mult_image (GaussFilterComplex, DerivativeFilter, GaussDerivativeFilter, Width * Height, 0)
convol_fft (ImageFFT, GaussDerivativeFilter, ImageConvol)
rft_generic (ImageConvol, ImageFiltered, 'from_freq', 'none', 'real', Width)
dev_displ...",78,93,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
gen_gauss_filter (GaussFilter, 3, 3, 0..."
dd403905,micro,11,returned by derivate_gauss.,"derivate_gauss (Image, ImageGauss, 3, 'x')
dev_display (ImageGauss)
Message := 'Result of smoothed derivative'
Message[1] := 'in the spatial domain'
disp_message (WindowHandle, Message, 'window', 450, 12, 'black', 'true')
stop ()
sub_image (ImageFiltered, ImageGauss, ImageSub, 1, 0)
min_max_gray (Re...",94,109,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
derivate_gauss (Image, ImageGauss, 3, 'none')
ge..."
dd403905,micro,12,"the image.  Note that this is something that can currently only be done
by using the FFT.","gen_gauss_filter (GaussFilter, 2, 10, rad(10), 'n', 'rft', Width, Height)
convol_fft (ImageFFT, GaussFilter, ImageConvol)
rft_generic (ImageConvol, ImageFiltered, 'from_freq', 'none', 'real', Width)
dev_display (ImageFiltered)
Message := 'Anisotropic oriented smoothing'
Message[1] := 'in the frequen...",110,125,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'Input image'
gen_gauss_filter (GaussFilter, 3, 3, 0..."
ee4ed4b7,full,0,,"dev_update_window ('off')
dev_update_var ('off')
dev_update_time ('off')
dev_update_pc ('off')
dev_set_color ('red')
read_image (Image, 'forest_road')
threshold (Image, Region, 160, 255)
opening_circle (Region, RegionOpening, 9.5)
hom_mat2d_identity (HomMat2DIdentity)
Scale := 1
for Phi := 0 to 360 ...",6,28,
36d6f67c,full,0,"Align the building in the center of the image horizontally and crop it
out of the image.","read_image (Image, 'mreut')
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, -110, -190, HomMat2DTranslate)
hom_mat2d_rotate (HomMat2DTranslate, rad(-10), 0, 0, HomMat2DRotate)
affine_trans_image_size (Image, ImageAffineTrans, HomMat2DRotate, 'constant', 80, 80)",8,12,
36d6f67c,micro,1,out of the image.,"read_image (Image, 'mreut')
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, -110, -190, HomMat2DTranslate)
hom_mat2d_rotate (HomMat2DTranslate, rad(-10), 0, 0, HomMat2DRotate)
affine_trans_image_size (Image, ImageAffineTrans, HomMat2DRotate, 'constant', 80, 80)",6,18,
a6be7423,full,0,"This example program shows how 72 images of the interior of a church can be
combined into a mosaic t...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
dev_set_part (0, 0, 647, 1955)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Reading images...')
gen...",11,208,
a6be7423,micro,1,"combined into a mosaic that covers a 360x140 degree view.  The mosaic
image is created in two ways: ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
dev_set_part (0, 0, 647, 1955)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Reading images...')",6,18,
a6be7423,micro,2,,"gen_empty_obj (Images)
for J := 1 to 72 by 1
read_image (Image, 'panorama/sankt_martin_manual_' + J$'03d')
concat_obj (Images, Image, Images)
endfor
get_image_size (Image, Width, Height)",19,25,
a6be7423,micro,3,"mosaic images were acquired as 12 vertical strips of 6 images each.
For each image, we match the ima...","FF := [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6]
TT := [2, 7, 3, 8, 4, 9, 5, 10, 6, 11, 12]
From := []
To := []
for J := 0 to 11 by 1
From := [From,(FF - 1 + 6 * J) % 72 + 1]
To := [To,(TT - 1 + 6 * J) % 72 + 1]
endfor",26,37,"* --- Automatically Added Context ---
for J := 1 to 72 by 1
* --- End of Automatically Added Context ---"
a6be7423,micro,4,,"HomMatrices2D := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
for J := 0 to |From| - 1 by 1
select_obj (Images, ImageF, From[J])
select_obj (Images, ImageT, To[J])
points_foerstner (ImageF, 1, 2, 3, 50, 0.1, 'gauss', 'true', RowsF, ColsF, CoRRJunctions, CoRCJunctions, CoCCJunc...",38,93,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
for J := 1 to 72 by 1
get_image_size (Image, Width, Height)
From := []
To := []
* -..."
a6be7423,micro,5,,"stationary_camera_self_calibration (72, 968, 648, 5, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['focus', 'principal_point', 'kappa'], 'true', CameraMatrix, Kappa, RotationMatrices, X, Y, Z, Error)
dev_clear_window ()
dev_set_color ('yellow')
set_tposition (Win...",94,99,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
From := []
To := []
HomMatrices2D := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
*..."
a6be7423,micro,6,,"cam_mat_to_cam_par (CameraMatrix, Kappa, 968, 648, CamParam)
change_radial_distortion_cam_par ('fixed', CamParam, 0, CamParOut)
gen_radial_distortion_map (Map, CamParam, CamParOut, 'bilinear')
map_image (Images, Map, Images)",100,104,"* --- Automatically Added Context ---
gen_empty_obj (Images)
stationary_camera_self_calibration (72, 968, 648, 5, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['fo..."
a6be7423,micro,7,calibrated rotation matrices by rotating them by 6 degrees around the x axis.,"hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(6), 'x', 0, 0, 0, HomMat3D)
RotMat := [HomMat3D[0:2],HomMat3D[4:6],HomMat3D[8:10]]
RotMats := []
for J := 0 to 71 by 1
RotMatCalib := RotationMatrices[J * 9:J * 9 + 8]
hom_mat2d_compose (RotMatCalib, RotMat, RotMatRot)
RotMats := [RotMats...",105,119,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
for J := 1 to 72 by 1
stationary_camera_self_calibration (72, 968, 648, 5, From, To, HomMatrices2D, Rows1,..."
a6be7423,micro,8,,"gen_spherical_mosaic (Images, SphericalMosaic, CameraMatrix, RotMats, -90, 90, -180, 180, 0, 'blend', 'bilinear')
get_image_size (SphericalMosaic, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (SphericalMosaic)
dev_set_color ('yellow')
set_tposition (Windo...",120,137,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
get_image_size (Image, Width, Height)
stationary_camera_self_calibration (72, 968, ..."
a6be7423,micro,9,,"gen_cube_map_mosaic (Images, Front, Rear, Left, Right, Top, Bottom, CameraMatrix, RotMats, 0, 'blend', 'bilinear')
get_image_size (Front, Width, Height)
dev_clear_window ()
dev_display (Front)
dev_set_color ('yellow')
set_tposition (WindowHandle, Height - 200, 20)
write_string (WindowHandle, 'Front ...",138,194,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
get_image_size (Image, Width, Height)
stationary_camera_self_calibration (72, 968, ..."
a6be7423,micro,10,"images (front, left, rear, and right) are aligned in a strip and the top and bottom
images are align...","concat_obj (Top, Left, CubeMaps)
concat_obj (CubeMaps, Front, CubeMaps)
concat_obj (CubeMaps, Right, CubeMaps)
concat_obj (CubeMaps, Rear, CubeMaps)
concat_obj (CubeMaps, Bottom, CubeMaps)
tile_images_offset (CubeMaps, CubeMapTiled, [0,Height,Height,Height,Height,2 * Height], [Width,0,Width,2 * Widt...",195,214,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
get_image_size (Image, Width, Height)
gen_cube_map_mosaic (Images, Front, Rear, Left, Right, Top, Bottom, ..."
ac228b65,full,0,,"gen_cam_par_area_scan_division (0.00219846, -78129.2, 5.46495e-06, 5.5e-06, 318.206, 236.732, 640, 480, CamParOriginal)
CamParVirtualFixed := CamParOriginal
set_cam_par_data (CamParVirtualFixed, 'kappa', 0, CamParVirtualFixed)
gen_radial_distortion_map (MapFixed, CamParOriginal, CamParVirtualFixed, ...",6,22,
ac228b65,micro,1,,"dev_set_paint (['vector_field', 'absolute'])",11,13,
ac228b65,micro,2,,"convert_map_type (MapFixed, MapConverted, 'coord_map_sub_pix', 'map_width')
read_image (Image, 'pioneer')",14,17,"* --- Automatically Added Context ---
gen_radial_distortion_map (MapFixed, CamParOriginal, CamParVirtualFixed, 'bilinear')
* --- End of Automatically Added Context ---"
ac228b65,micro,3,"slower than calling map_image with the original map MapFixed.
Coordinate maps should only be used on...","map_image (Image, MapConverted, ImageMapped)",18,28,"* --- Automatically Added Context ---
convert_map_type (MapFixed, MapConverted, 'coord_map_sub_pix', 'map_width')
read_image (Image, 'pioneer')
* --- End of Automatically Added Context ---"
55c6558d,full,0,,"dev_close_window ()
dev_open_window (0, 0, 768 / 2, 576 / 2, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
CalTabDescrFile := 'caltab_big.descr'
gen_cam_par_area_scan_division (0.008, 0, 0.000008...",6,80,
55c6558d,micro,1,,CalTabDescrFile := 'caltab_big.descr',13,15,
55c6558d,micro,2,"the HALCONROOT/calib directory, or use an absolute path","gen_cam_par_area_scan_division (0.008, 0, 0.0000086, 0.0000086, 384, 288, 768, 576, StartCamPar)
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamPar)
set_calib_data_calib_object (CalibDataID, 0, CalTabDescrFile)
NumImages := 10
read_i...",16,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768 / 2, 576 / 2, 'black', WindowHandle1)
CalTabDescrFile := 'caltab_big.descr'
* --- End of Automatically Added Context ---"
55c6558d,micro,3,,"dev_open_window (0, 391, 900 / 2, 800 / 2, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Button := 0
NumImage := 1
for I := 1 to NumImages by 1
dev_set_window (WindowHandle1)
dev_set_part (0, 0, 575, 767)
dev_clear_window ()
select_obj (Images, Image, I)
dev_d...",54,86,"* --- Automatically Added Context ---
dev_open_window (0, 0, 768 / 2, 576 / 2, 'black', WindowHandle1)
NumImages := 10
read_image (Images, 'calib/calib-3d-coord-' + [1:NumImages]$'02d')
for I := 1 to ..."
2b9b66c9,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_image to rotate an image in 3D.","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_part (W...",8,77,
2b9b66c9,micro,1,projective_trans_image to rotate an image in 3D.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,14,
2b9b66c9,micro,2,"a smooth (i.e., flicker-free) display under both Windows and Unix.","open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
Iter := 1440",15,19,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
2b9b66c9,micro,3,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.1
DBeta := 1.3
DGamma := 1.7",20,25,
2b9b66c9,micro,4,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",26,29,
2b9b66c9,micro,5,of the image.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",30,34,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
2b9b66c9,micro,6,"moves in 3D.
This will generate the torus knot T(8,3).","M := 8
N := 3",35,39,
2b9b66c9,micro,7,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0
for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D...",40,83,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, Height, 0..."
3451c3cc,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_image to rotate an image with a...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
threshold (Image, Region, 180, 255)
reduce_domain (Image, Region, ImageReduced)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
se...",8,80,
3451c3cc,micro,1,projective_trans_image to rotate an image with a reduced domain in 3D.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')",6,11,
3451c3cc,micro,2,,"threshold (Image, Region, 180, 255)
reduce_domain (Image, Region, ImageReduced)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",12,17,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
3451c3cc,micro,3,"the window after every display operation is disabled.
flush_buffer is used in the loop below to trig...","set_window_param (WindowHandle, 'flush', 'false')
Iter := 1440",18,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
3451c3cc,micro,4,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.5
DBeta := 1.7
DGamma := 1.9",24,29,
3451c3cc,micro,5,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",30,33,
3451c3cc,micro,6,of the image.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",34,38,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
3451c3cc,micro,7,"moves in 3D.
This will generate the torus knot T(6,5).","M := 6
N := 5",39,43,
3451c3cc,micro,8,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0
for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D...",44,87,"* --- Automatically Added Context ---
reduce_domain (Image, Region, ImageReduced)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Iter := 1440
DAlpha..."
bb5c1feb,full,0,"This example program shows how harmonic_interpolation can be used to
fill up the areas that cannot b...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_c...",13,51,
bb5c1feb,micro,1,"fill up the areas that cannot be reconstructed with stereo reconstruction,
e.g., because of occlusio...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_c...",6,20,
bb5c1feb,micro,2,,"read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
emphasize (ImageL, ImageL, 7, 7, 1)
emphasize (ImageR, ImageR, 7, 7, 1)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",21,27,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
bb5c1feb,micro,3,,"binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'interpolation')",28,29,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
bb5c1feb,micro,4,domain returned by binocular_distance.,"get_domain (DistanceImage, Domain)
complement (Domain, RegionInpainting)",30,33,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
bb5c1feb,micro,5,"Since the inpainting region is the complement of the domain of the distance
image the intersection w...","full_domain (DistanceImage, DistanceImageFull)
harmonic_interpolation (DistanceImageFull, RegionInpainting, InpaintedDistanceImage, 0.00001)",34,39,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
bb5c1feb,micro,6,,"dev_clear_window ()
dev_display (DistanceImage)
dev_set_color ('green')
disp_message (WindowHandle, 'Distance image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_display (InpaintedDistanceImage)
dev_set_color ('green')
disp...",40,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, Rect..."
1aaf7f5e,full,0,"This example program shows how inpainting_aniso can be used to
fill up the areas that cannot be reco...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program shows how inpainting_aniso can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := ...",11,74,
1aaf7f5e,micro,1,"fill up the areas that cannot be reconstructed with stereo reconstruction,
e.g., because of occlusio...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,15,
1aaf7f5e,micro,2,,"Message := 'This program shows how inpainting_aniso can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := 'with stereo reconstruction.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')...",16,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
1aaf7f5e,micro,3,,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",24,27,
1aaf7f5e,micro,4,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",28,30,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
1aaf7f5e,micro,5,apply a general transformation to the image,"read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
emphasize (ImageL, ImageL, 7, 7, 1)
emphasize (ImageR, ImageR, 7, 7, 1)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",31,38,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
1aaf7f5e,micro,6,,"binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'interpolation')",39,41,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
1aaf7f5e,micro,7,"to create suitable staring values.  This is performed with
harmonic_interpolation.
Determine the inp...","get_domain (DistanceImage, Domain)
complement (Domain, RegionInpaintingFull)",42,49,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
1aaf7f5e,micro,8,"Since the inpainting region is the complement of the domain of the distance
image the intersection w...","full_domain (DistanceImage, DistanceImageFull)
harmonic_interpolation (DistanceImageFull, RegionInpaintingFull, HarmonicDistanceImage, 0.00001)",50,56,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
1aaf7f5e,micro,9,"harmonic_interpolation, the inpainting region must keep a slight distance
to the border of the image...","get_image_size (DistanceImage, Width, Height)
clip_region (RegionInpaintingFull, RegionInpainting, 3, 3, Height - 4, Width - 4)
inpainting_aniso (HarmonicDistanceImage, RegionInpainting, InpaintedDistanceImage, 'shock', 0.5, 0.5, 60, 3)",57,63,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
1aaf7f5e,micro,10,,"dev_clear_window ()
dev_display (DistanceImage)
Message := 'Distance image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_display (InpaintedDistanceImage)
Message := 'Dense distance image'...",64,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
Message := 'This program shows how inpainting_aniso can be used to'
binocular_distance (ImageRectifiedL, I..."
8ee4eaef,full,0,"This example program shows how inpainting_ced can be used to
fill up the areas that cannot be recons...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program shows how inpainting_ced can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := 'w...",11,74,
8ee4eaef,micro,1,"fill up the areas that cannot be reconstructed with stereo reconstruction,
e.g., because of occlusio...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,15,
8ee4eaef,micro,2,,"Message := 'This program shows how inpainting_ced can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := 'with stereo reconstruction.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
s...",16,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
8ee4eaef,micro,3,,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",24,27,
8ee4eaef,micro,4,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",28,30,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
8ee4eaef,micro,5,apply a general transformation to the image,"read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
emphasize (ImageL, ImageL, 7, 7, 1)
emphasize (ImageR, ImageR, 7, 7, 1)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",31,38,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
8ee4eaef,micro,6,,"binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'interpolation')",39,41,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
8ee4eaef,micro,7,"to create suitable staring values.  This is performed with
harmonic_interpolation.
Determine the inp...","get_domain (DistanceImage, Domain)
complement (Domain, RegionInpaintingFull)",42,49,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
8ee4eaef,micro,8,"Since the inpainting region is the complement of the domain of the distance
image the intersection w...","full_domain (DistanceImage, DistanceImageFull)
harmonic_interpolation (DistanceImageFull, RegionInpaintingFull, HarmonicDistanceImage, 0.00001)",50,56,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
8ee4eaef,micro,9,"harmonic_interpolation, the inpainting region must keep a certain distance
to the border of the imag...","get_image_size (DistanceImage, Width, Height)
clip_region (RegionInpaintingFull, RegionInpainting, 12, 12, Height - 13, Width - 13)
inpainting_ced (HarmonicDistanceImage, RegionInpainting, InpaintedDistanceImage, 0.5, 3, 0.5, 100)",57,63,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
8ee4eaef,micro,10,,"dev_clear_window ()
dev_display (DistanceImage)
Message := 'Distance image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_display (InpaintedDistanceImage)
Message := 'Dense distance image'...",64,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
Message := 'This program shows how inpainting_ced can be used to'
binocular_distance (ImageRectifiedL, Ima..."
c3fabbd3,full,0,"This example program shows how inpainting_ct can be used to remove the
fence from an image of a lynx...","read_image (Image, 'lynx')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := 'Image to be inpainted'
disp_message (WindowHandle, Message, '...",8,27,
c3fabbd3,micro,1,fence from an image of a lynx.,"read_image (Image, 'lynx')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := 'Image to be inpainted'
disp_message (WindowHandle, Message, '...",6,33,
a02e1f14,full,0,"This example program shows how inpainting_mcf can be used to
fill up the areas that cannot be recons...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program shows how inpainting_mcf can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := 'w...",11,74,
a02e1f14,micro,1,"fill up the areas that cannot be reconstructed with stereo reconstruction,
e.g., because of occlusio...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,15,
a02e1f14,micro,2,,"Message := 'This program shows how inpainting_mcf can be used to'
Message[1] := 'fill up the areas that cannot be reconstructed'
Message[2] := 'with stereo reconstruction.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
s...",16,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
a02e1f14,micro,3,,"gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_division (0.0131776504517, -731.860636733, 1.47997569293e-5, 1.48e-5, 162.98210144, 119.301040649, 320, 240, CamParamR)
create_pose (0.153...",24,27,
a02e1f14,micro,4,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRectR, RectLPosRectR)",28,30,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0130507774353, -665.817817207, 1.4803417027e-5, 1.48e-5, 155.89225769, 126.70664978, 320, 240, CamParamL)
gen_cam_par_area_scan_..."
a02e1f14,micro,5,apply a general transformation to the image,"read_image (ImageL, 'stereo/board/board_l_01')
read_image (ImageR, 'stereo/board/board_r_01')
emphasize (ImageL, ImageL, 7, 7, 1)
emphasize (ImageR, ImageR, 7, 7, 1)
map_image (ImageL, MapL, ImageRectifiedL)
map_image (ImageR, MapR, ImageRectifiedR)",31,38,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
a02e1f14,micro,6,,"binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1, 'left_right_check', 'interpolation')",39,41,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', RectCamParL, RectCamParR, CamPoseRectL, CamPoseRec..."
a02e1f14,micro,7,"to create suitable staring values.  This is performed with
harmonic_interpolation.
Determine the inp...","get_domain (DistanceImage, Domain)
complement (Domain, RegionInpaintingFull)",42,49,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
a02e1f14,micro,8,"Since the inpainting region is the complement of the domain of the distance
image the intersection w...","full_domain (DistanceImage, DistanceImageFull)
harmonic_interpolation (DistanceImageFull, RegionInpaintingFull, HarmonicDistanceImage, 0.00001)",50,56,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
a02e1f14,micro,9,"harmonic_interpolation, the inpainting region must keep a slight distance
to the border of the image...","get_image_size (DistanceImage, Width, Height)
clip_region (RegionInpaintingFull, RegionInpainting, 3, 3, Height - 4, Width - 4)
inpainting_mcf (HarmonicDistanceImage, RegionInpainting, InpaintedDistanceImage, 1, 0.5, 1000)",57,63,"* --- Automatically Added Context ---
binocular_distance (ImageRectifiedL, ImageRectifiedR, DistanceImage, ScoreImageDistance, RectCamParL, RectCamParR, RectLPosRectR, 'ncc', 17, 17, 5, 10, 40, 1, 0.1..."
a02e1f14,micro,10,,"dev_clear_window ()
dev_display (DistanceImage)
Message := 'Distance image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_display (InpaintedDistanceImage)
Message := 'Dense distance image'...",64,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, 672, 484, 'black', WindowHandle)
Message := 'This program shows how inpainting_mcf can be used to'
binocular_distance (ImageRectifiedL, Ima..."
872f4c36,full,0,"This example program shows how inpainting_texture can be used to remove
unwanted objects from an ima...","dev_update_off ()
read_image (Image, 'plit2')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
decompose3 (Image, ImageR, ImageG, ImageB)
trans_from_rgb (ImageR, ImageG,...",9,37,
872f4c36,micro,1,"unwanted objects from an image and replace them with natural looking
texture","dev_update_off ()
read_image (Image, 'plit2')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
decompose3 (Image, ImageR, ImageG, ImageB)
trans_from_rgb (ImageR, ImageG,...",6,43,
75d2c634,full,0,,"read_image (Bk45, 'bk45')
bandpass_image (Bk45, Lines, 'lines')
threshold (Lines, Region, 128, 255)
skeleton (Region, Skeleton)
dev_set_colored (12)
gen_contours_skeleton_xld (Skeleton, Contours, 5, 'filter')
dev_display (Bk45)
dev_display (Contours)",6,13,
59177edd,full,0,"This example program shows how to use lines_color and the differences
between the output of lines_co...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
dev_set_part (0, 0, 479, 639)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
NumImages := 2
for J := 1 to NumImages by 1
read_image (Image, 'cable' + J)
dev_display (Image)
disp_message (Windo...",9,124,
59177edd,micro,1,"between the output of lines_color and lines_gauss using an image in which
some lines can only be ext...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
dev_set_part (0, 0, 479, 639)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
NumImages := 2
for J := 1 to NumImages by 1
read_image (Image, 'cable' + J)
dev_display (Image)
disp_message (Windo...",6,130,
f3b5f37e,full,0,,"read_image (Bk45, 'bk45')
dev_set_colored (6)
lines_facet (Bk45, Lines, 5, 3, 5, 'light')",6,8,
e3d23cd5,full,0,,"dev_close_window ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
dev_display (Angio)
dev_set_color ('blue')
MaxLineWidth := 8
Contrast := 12
calculate_lines_gauss_parameters (MaxLineWidth, [Contrast,0]...",6,38,
c178cfdc,full,0,Matching of a template and an image,"read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 365, 300, 390, 330)
reduce_domain (Image, Rectangle, Pattern)
dev_set_color ('red')
stop ()
exhaustive_match (Image, Image, Pattern, ImageMatchDfd, 'dfd')
threshold (ImageMatchDfd, MatchesDfd, 0, 5)
stop ()
exhaustive_match (Image, Image, Patte...",8,19,
c178cfdc,micro,1,,"read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 365, 300, 390, 330)",6,9,
c178cfdc,micro,2,,"reduce_domain (Image, Rectangle, Pattern)
dev_set_color ('red')",10,12,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 365, 300, 390, 330)
* --- End of Automatically Added Context ---"
c178cfdc,micro,3,,"stop ()
exhaustive_match (Image, Image, Pattern, ImageMatchDfd, 'dfd')
threshold (ImageMatchDfd, MatchesDfd, 0, 5)
stop ()
exhaustive_match (Image, Image, Pattern, ImageMatchCorr, 'norm_correlation')
threshold (ImageMatchCorr, MatchesCorr, 253, 255)",13,25,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
reduce_domain (Image, Rectangle, Pattern)
* --- End of Automatically Added Context ---"
5ff9ecfb,full,0,Calculate a Gauss pyramid of scaled down images,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
gen_gauss_pyramid (Image, ImagePyramid, 'constant', 0.5)
count_obj (ImagePyramid, Number)
for Index ...",8,29,
5ff9ecfb,micro,1,,"read_image (Image, 'mreut')",6,9,
5ff9ecfb,micro,2,,"dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')",10,15,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
5ff9ecfb,micro,3,,"gen_gauss_pyramid (Image, ImagePyramid, 'constant', 0.5)",16,18,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
5ff9ecfb,micro,4,,"count_obj (ImagePyramid, Number)
for Index := 1 to Number by 1
select_obj (ImagePyramid, Level, Index)
dev_display (Level)
disp_message (WindowID, 'Pyramid level ' + Index, 'window', 12, 12, 'black', 'true')
if (Index &lt; Number)
disp_continue_message (WindowID, 'black', 'true')
stop ()
endif
endfo...",19,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowID)
gen_gauss_pyramid (Image, ImagePyramid, 'constant', 0.5)
* --- End of Automatically Added Context ---"
344ea3dc,full,0,Invert an image using the proper look-up table,"read_image (Image, 'monkey')
dev_update_var ('off')
dev_update_pc ('off')
lut := []
for i := 0 to 255 by 1
lut := [lut,255 - i]
endfor
dev_update_pc ('on')
lut_trans (Image, ImageInverse, lut)",7,15,
344ea3dc,micro,1,,"read_image (Image, 'monkey')
dev_update_var ('off')
dev_update_pc ('off')
lut := []
for i := 0 to 255 by 1
lut := [lut,255 - i]
endfor
dev_update_pc ('on')
lut_trans (Image, ImageInverse, lut)",6,21,
dec07a60,full,0,Find a closed region of an image,"read_image (Image, 'claudia')
gauss_filter (Image, Image, 5)
decompose3 (Image, Red, Green, Blue)
threshold (Red, RegionRed, 150, 255)
reduce_domain (Red, RegionRed, ImageRedSkin)
symmetry (ImageRedSkin, ImageSymmetry, 80, 0, 0.5)
threshold (ImageSymmetry, Region, 190, 255)
opening_rectangle1 (Regio...",8,32,
dec07a60,micro,1,,"read_image (Image, 'claudia')
gauss_filter (Image, Image, 5)
decompose3 (Image, Red, Green, Blue)
threshold (Red, RegionRed, 150, 255)
reduce_domain (Red, RegionRed, ImageRedSkin)",6,12,
dec07a60,micro,2,,"symmetry (ImageRedSkin, ImageSymmetry, 80, 0, 0.5)
threshold (ImageSymmetry, Region, 190, 255)",13,15,"* --- Automatically Added Context ---
reduce_domain (Red, RegionRed, ImageRedSkin)
* --- End of Automatically Added Context ---"
dec07a60,micro,3,,"opening_rectangle1 (Region, RegionOpening, 1, 10)
rank_region (RegionOpening, RegionCount, 25, 25, 150)
closing_circle (RegionCount, RegionClosing, 53.5)
area_center (RegionClosing, Area, Row, Column)
gen_empty_region (EmptyRegion)
expand_gray (RegionClosing, Red, EmptyRegion, RegionExpand, 'maximal...",16,23,"* --- Automatically Added Context ---
decompose3 (Image, Red, Green, Blue)
threshold (ImageSymmetry, Region, 190, 255)
* --- End of Automatically Added Context ---"
dec07a60,micro,4,,"clip_region (RegionExpand, RegionClipped, Row1, 0, Row2, 1000)",24,25,"* --- Automatically Added Context ---
expand_gray (RegionClosing, Red, EmptyRegion, RegionExpand, 'maximal', 'image', 1)
smallest_rectangle1 (RegionClosing, Row1, Column1, Row2, Column2)
* --- End of ..."
dec07a60,micro,5,,"closing_circle (RegionClipped, RegionClosing1, 13.5)",26,27,"* --- Automatically Added Context ---
clip_region (RegionExpand, RegionClipped, Row1, 0, Row2, 1000)
* --- End of Automatically Added Context ---"
dec07a60,micro,6,,"dev_display (Red)
dev_set_color ('red')
dev_set_draw ('margin')
dev_display (RegionClosing1)",28,38,"* --- Automatically Added Context ---
decompose3 (Image, Red, Green, Blue)
closing_circle (RegionClipped, RegionClosing1, 13.5)
* --- End of Automatically Added Context ---"
53e603de,full,0,,"read_image (Image, 'fabrik')
sobel_amp (Image, ImaAmp, 'sum_abs', 3)
corner_response (ImaAmp, ImageCorner, 3, 0.04)
threshold (ImageCorner, Corners, 50, 255)",6,10,
53e603de,micro,1,,"threshold (ImageCorner, Corners, 50, 255)",9,16,"* --- Automatically Added Context ---
corner_response (ImaAmp, ImageCorner, 3, 0.04)
* --- End of Automatically Added Context ---"
03af5d64,full,0,This example program shows how to use dots_image to segment a dot print.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'needle1')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (ImageNoise, 'angio-part')
crop_part (ImageNoise, ImagePart, 0, 0, Wi...",7,38,
03af5d64,micro,1,,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'needle1')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,13,
03af5d64,micro,2,little harder by adding a background texture to the image.,"read_image (ImageNoise, 'angio-part')
crop_part (ImageNoise, ImagePart, 0, 0, Width, Height)
mult_image (Image, ImagePart, ImageResult, 0.015, 0)",14,18,"* --- Automatically Added Context ---
read_image (Image, 'needle1')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
03af5d64,micro,3,,"dots_image (ImageResult, DotImage, 5, 'dark', 2)
threshold (DotImage, Region, 80, 255)",19,21,"* --- Automatically Added Context ---
mult_image (Image, ImagePart, ImageResult, 0.015, 0)
* --- End of Automatically Added Context ---"
03af5d64,micro,4,,"closing_rectangle1 (Region, RegionClosing1, 1, 5)
closing_rectangle1 (RegionClosing1, RegionClosing2, 5, 1)
gen_rectangle2 (Rectangle, 10, 10, rad(45), 3, 0)
closing (RegionClosing2, Rectangle, RegionClosing3)
gen_rectangle2 (Rectangle, 10, 10, rad(135), 3, 0)
closing (RegionClosing3, Rectangle, Reg...",22,30,"* --- Automatically Added Context ---
threshold (DotImage, Region, 80, 255)
* --- End of Automatically Added Context ---"
03af5d64,micro,5,separate them again.,"partition_dynamic (SelectedRegions, Partitioned, 25, 20)",31,33,"* --- Automatically Added Context ---
select_shape (ConnectedRegions, SelectedRegions, ['area', 'height'], 'and', [100, 20], [700, 40])
* --- End of Automatically Added Context ---"
03af5d64,micro,6,,"intersection (Partitioned, Region, Characters)
dev_display (ImageResult)
dev_set_colored (6)
dev_display (Characters)",34,44,"* --- Automatically Added Context ---
mult_image (Image, ImagePart, ImageResult, 0.015, 0)
threshold (DotImage, Region, 80, 255)
partition_dynamic (SelectedRegions, Partitioned, 25, 20)
* --- End of A..."
8cc75905,full,0,"This program compares the result of different operators
which detect points of interest","dev_update_off ()
Dark := 100
Background := 175
Light := 250
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'tr...",9,112,
8cc75905,micro,1,which detect points of interest,"dev_update_off ()
Dark := 100
Background := 175
Light := 250
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'tr...",6,22,
8cc75905,micro,2,,"points_foerstner (Image, 1, 2, 3, 200, 0.3, 'gauss', 'true', RowJunctions, ColJunctions, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColArea, CoRRArea, CoRCArea, CoCCArea)
gen_cross_contour_xld (CrossFoerstner, RowJunctions, ColJunctions, Size, Angle)
dev_display (Image)
dev_display (Cross...",23,31,"* --- Automatically Added Context ---
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically A..."
8cc75905,micro,3,,"points_harris (Image, 0.7, 2, 0.04, 0, RowHarris, ColHarris)
gen_cross_contour_xld (CrossHarris, RowHarris, ColHarris, Size, Angle)
dev_display (Image)
dev_display (CrossHarris)
disp_message (WindowHandle, 'Harris interest points detector', 'window', 12, 12, 'black', 'true')
disp_continue_message (W...",32,40,"* --- Automatically Added Context ---
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically A..."
8cc75905,micro,4,,"points_harris_binomial (Image, 5, 15, 0.04, 1000, 'on', RowHarrisBinomial, ColHarrisBinomial)
gen_cross_contour_xld (CrossHarrisBinom, RowHarrisBinomial, ColHarrisBinomial, Size, Angle)
dev_display (Image)
dev_display (CrossHarrisBinom)
disp_message (WindowHandle, 'Harris binomial interest points de...",41,49,"* --- Automatically Added Context ---
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
disp_message (WindowHandle, ..."
8cc75905,micro,5,,"points_sojka (Image, 9, 2.5, 0.75, 30, 90, 0.5, 'true', RowSojka, ColSojka)
gen_cross_contour_xld (CrossSojka, RowSojka, ColSojka, Size, Angle)
dev_display (Image)
dev_display (CrossSojka)
disp_message (WindowHandle, 'Sojka interest points detector', 'window', 12, 12, 'black', 'true')
disp_continue_...",50,58,"* --- Automatically Added Context ---
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically A..."
8cc75905,micro,6,,"points_lepetit (Image, 3, 1, 20, 35, 'interpolation', RowLepetit, ColLepetit)
gen_cross_contour_xld (CrossLepetit, RowLepetit, ColLepetit, Size, Angle)
dev_display (Image)
dev_display (CrossLepetit)
disp_message (WindowHandle, 'Lepetit interest points detector', 'window', 12, 12, 'black', 'true')
ge...",59,124,"* --- Automatically Added Context ---
Dark := 100
Background := 175
Light := 250
Angle := rad(45)
Size := 3
create_test_image (Image, Background, Light, Dark)
dev_open_window (0, 0, 512, 512, 'black',..."
0069168e,full,0,This program illustrates how to use the Foerstner point detector.,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
SigmaGrad := 1.0
SigmaInt := 2.0
SigmaPoints := 3.0
ThreshInhom := 400
points_foerstner (Image, SigmaGrad, Si...",8,27,
0069168e,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
SigmaGrad := 1.0
SigmaInt := 2.0
SigmaPoints := 3.0
ThreshInhom := 400
points_foerstner (Image, SigmaGrad, Si...",6,33,
f93fe812,full,0,"This example program illustrates the usage of the covariance
matrices in conjunction with intensity(...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', MainWindow)
SigmaGrad := 1.3
SigmaInt := 3.0
SigmaPoints := 4.0
ThreshInhom := 600
CrossSize := 0.2
gen_image_const (Image, 'byte', 512, 512)
gen_image_proto (Image, Image, 64)
gen_contour_polygon_xld (Contour, [200, 100, 300, 300, 200, 2...",9,76,
f93fe812,micro,1,matrices in conjunction with intensity().,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', MainWindow)
SigmaGrad := 1.3
SigmaInt := 3.0
SigmaPoints := 4.0
ThreshInhom := 600
CrossSize := 0.2",6,16,
f93fe812,micro,2,,"gen_image_const (Image, 'byte', 512, 512)
gen_image_proto (Image, Image, 64)
gen_contour_polygon_xld (Contour, [200, 100, 300, 300, 200, 200], [100, 400, 400, 300, 300, 100])
paint_xld (Contour, Image, Image, 191)
gen_ellipse_contour_xld (Ellipse, 100, 200, rad(45), 2, 4, 0, 6.28318, 'positive', 1.5...",17,82,"* --- Automatically Added Context ---
SigmaGrad := 1.3
SigmaInt := 3.0
SigmaPoints := 4.0
ThreshInhom := 600
CrossSize := 0.2
* --- End of Automatically Added Context ---"
3dd6e7e5,full,0,"This program illustrates the robustness of the Foerstner point detector.
We extract the prominent po...","read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
if (Width &lt; Height)
Radius := Width / 2
else
Radius := Height / 2
endif
gen_circle (Circle, Width / 2, Heig...",12,50,
3dd6e7e5,micro,1,"We extract the prominent points, once from the original image and
once from a rotated image. The poi...","read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
if (Width &lt; Height)
Radius := Width / 2
else
Radius := Height / 2
endif
gen_circle (Circle, Width / 2, Heig...",6,56,
178370ee,full,0,This program illustrates how to use the Harris point detector.,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
SigmaGrad := 1.0
SigmaSmooth := 2.0
Threshold := 100000
points_harris (Image, SigmaGrad, SigmaSmooth, 0.04, T...",8,24,
178370ee,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
SigmaGrad := 1.0
SigmaSmooth := 2.0
Threshold := 100000
points_harris (Image, SigmaGrad, SigmaSmooth, 0.04, T...",6,30,
28d8c41c,full,0,This program illustrates how to use the Harris Binomial point detector.,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [500, 800], [400, 800], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
MaskSizeGrd := 5
MaskSizeSmooth := 15
Alpha := 0.04
Threshold := 1000
Subpix := 'on'
count_seconds (S1)
points_h...",8,27,
28d8c41c,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [500, 800], [400, 800], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
MaskSizeGrd := 5
MaskSizeSmooth := 15
Alpha := 0.04
Threshold := 1000
Subpix := 'on'
count_seconds (S1)
points_h...",6,33,
7f54aa13,full,0,"This program illustrates the robustness of the Harris point detector.
We extract the prominent point...","read_image (Image, 'fabrik')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
if (Width &lt; Height)
Radius := Width / 2
else
Radius := Height / 2
endif
gen_circle (Circle, Width / 2, Hei...",12,49,
7f54aa13,micro,1,"We extract the prominent points, once from the original image and
once from a rotated image. The poi...","read_image (Image, 'fabrik')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
if (Width &lt; Height)
Radius := Width / 2
else
Radius := Height / 2
endif
gen_circle (Circle, Width / 2, Hei...",6,55,
e7d2550e,full,0,This program illustrates how to use the Lepetit point detector.,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [500, 800], [400, 800], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Radius := 3
CheckNeighbor := 0
MinCheckNeighborDiff := 20
MinScore := 25
Subpix := 'none'
count_seconds (S1)
poi...",8,27,
e7d2550e,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, [500, 800], [400, 800], WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Radius := 3
CheckNeighbor := 0
MinCheckNeighborDiff := 20
MinScore := 25
Subpix := 'none'
count_seconds (S1)
poi...",6,33,
923b6c99,full,0,This program illustrates how to use the Sojka corner detector.,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
MaskSize := 7
SigmaW := 2.5
SigmaD := 0.75
MinGrad := 30
MinApparentness := 120
MinAngle := 0.5
Subpix := 'tr...",8,28,
923b6c99,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
MaskSize := 7
SigmaW := 2.5
SigmaD := 0.75
MinGrad := 30
MinApparentness := 120
MinAngle := 0.5
Subpix := 'tr...",6,34,
4c0dba34,full,0,"This example shows the usage of the two operators
scene_flow_uncalib and scene_flow_calib to calcula...","dev_update_off ()
dev_close_window ()
gen_cam_par_area_scan_division (0.00600532, -2506.22, 4.96835e-006, 5.3e-006, 317.839, 228.795, 640, 480, CamParamL)
gen_cam_par_area_scan_division (0.00602268, -2314.94, 4.97045e-006, 5.3e-006, 326.022, 232.059, 640, 480, CamParamR)
create_pose (-0.0079576, 0.2...",24,519,
4c0dba34,micro,1,"scene_flow_uncalib and scene_flow_calib to calculate the
scene flow between two consecutive rectifie...","dev_update_off ()
dev_close_window ()",6,25,
4c0dba34,micro,2,,"gen_cam_par_area_scan_division (0.00600532, -2506.22, 4.96835e-006, 5.3e-006, 317.839, 228.795, 640, 480, CamParamL)
gen_cam_par_area_scan_division (0.00602268, -2314.94, 4.97045e-006, 5.3e-006, 326.022, 232.059, 640, 480, CamParamR)",26,28,
4c0dba34,micro,3,,"create_pose (-0.0079576, 0.202734, 0.0372651, 20.163, 0.795608, 184.056, 'Rp+T', 'gba', 'point', RelPose)",29,30,
4c0dba34,micro,4,,"gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', CamParamRectL, CamParamRectR, CamPoseRectL, CamPoseRectR, RelPoseRect)",31,32,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.00600532, -2506.22, 4.96835e-006, 5.3e-006, 317.839, 228.795, 640, 480, CamParamL)
gen_cam_par_area_scan_division (0.00602268, -..."
4c0dba34,micro,5,,"get_image_size (MapL, WidthL, Height)
get_image_size (MapR, WidthR, Height)",33,35,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', CamParamRectL, CamParamRectR, CamPoseRectL, CamPos..."
4c0dba34,micro,6,,"dev_open_window_fit_size (0, 0, WidthL, Height, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, WidthW1, HeightW1)
dev_open_window_fit_size (0, WidthW1 + 5, WidthR, Height, -1, -1, WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (W...",36,42,"* --- Automatically Added Context ---
get_image_size (MapL, WidthL, Height)
get_image_size (MapR, WidthR, Height)
* --- End of Automatically Added Context ---"
4c0dba34,micro,7,,"gen_empty_obj (ImagesL)
gen_empty_obj (ImagesR)
gen_empty_obj (ImagesRectL)
gen_empty_obj (ImagesRectR)
for Index := 1 to 5 by 1
read_image (ImageL, 'stereo/globe/globe_l_' + Index$'02')
read_image (ImageR, 'stereo/globe/globe_r_' + Index$'02')
concat_obj (ImagesL, ImageL, ImagesL)
concat_obj (Image...",43,58,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', CamParamRectL, CamParamRectR, CamPoseRectL, CamPos..."
4c0dba34,micro,8,that is used for the calculation of the scene flow,"for Index := 1 to 5 by 1
select_obj (ImagesRectL, ImageRectL, Index)
select_obj (ImagesRectR, ImageRectR, Index)
dev_set_window (WindowHandle1)
dev_display (ImageRectL)
dev_set_window (WindowHandle2)
dev_display (ImageRectR)
disp_message (WindowHandle1, 'Sequence of rectified stereo images\nof a rot...",59,74,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, WidthL, Height, -1, -1, WindowHandle1)
dev_open_window_fit_size (0, WidthW1 + 5, WidthR, Height, -1, -1, WindowHandle2)
gen_empty_..."
4c0dba34,micro,9,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_window (WindowHandle2)
dev_clear_window ()
Message := 'For the calculation of the scene flow, two corresponding stereo image pairs as well as the disparity image that belongs to the first stereo image pair are required. The disparity image c...",75,85,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, WidthL, Height, -1, -1, WindowHandle1)
dev_open_window_fit_size (0, WidthW1 + 5, WidthR, Height, -1, -1, WindowHandle2)
* --- End ..."
4c0dba34,micro,10,,"for Index := 1 to 4 by 1
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_window (WindowHandle2)
dev_clear_window ()
Message := 'Calculate the scene flow between the rectified stereo image pair ' + Index + ' and the rectified stereo image pair ' + (Index + 1) + '.'
MessageWrapped := regexp...",86,342,"* --- Automatically Added Context ---
gen_binocular_rectification_map (MapL, MapR, CamParamL, CamParamR, RelPose, 1, 'viewing_direction', 'bilinear', CamParamRectL, CamParamRectR, CamPoseRectL, CamPos..."
4c0dba34,micro,11,rotation angle and axis direction,"convert_pose_type (Pose, 'Rp+T', 'rodriguez', 'point', PoseOut)
RotationPart := PoseOut[3:5]
Angle := deg(2 * atan(sqrt(sum(RotationPart * RotationPart))))",343,347,"* --- Automatically Added Context ---
create_pose (-0.0079576, 0.202734, 0.0372651, 20.163, 0.795608, 184.056, 'Rp+T', 'gba', 'point', RelPose)
visualize_object_model_3d (WindowHandle1, [OM3DSampled,O..."
4c0dba34,micro,12,,Axis := RotationPart / sqrt(sum(RotationPart * RotationPart)),348,350,"* --- Automatically Added Context ---
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
visualize_object_model_3d (WindowHandle1, [OM3DSampled,OM3DFlowVectors], [], [], ['color_attrib_0', 'l..."
4c0dba34,micro,13,"Rx+T=x  &lt;=&gt; (R-I)x = -T  &lt;=&gt;  x = -(R-I)^(-1) T
since R-I might not have full rank, use ...","R := HomMat3D[[0, 1, 2, 4, 5, 6, 8, 9, 10]]
R_minus_I := R - [1, 0, 0, 0, 1, 0, 0, 0, 1]
create_matrix (3, 3, R_minus_I, MatrixLHS)
create_matrix (3, 1, -HomMat3D[[3, 7, 11]], MatrixRHS)
solve_matrix (MatrixLHS, 'general', 0.001, MatrixRHS, MatrixResultID)
get_full_matrix (MatrixResultID, FixedPoint...",351,433,"* --- Automatically Added Context ---
vector_to_hom_mat3d ('rigid', X, Y, Z, X + FlowX, Y + FlowY, Z + FlowZ, HomMat3D)
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
* --- End of Automat..."
4c0dba34,micro,14,,Length := 0.5 * SphereRadius,434,435,"* --- Automatically Added Context ---
SphereRadius := SphereParameters[3]
get_object_model_3d_params (OM3DSphereOnly, 'primitive_parameter', SphereParameters)
* --- End of Automatically Added Context ..."
4c0dba34,micro,15,,"RotPoint := [1, 1,-(Axis[0] + Axis[1]) * Axis[2]]",436,437,"* --- Automatically Added Context ---
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
* --- End of Automatically Added Context ---"
4c0dba34,micro,16,,"affine_trans_point_3d (HomMat3D, RotPoint[0], RotPoint[1], RotPoint[2], Qx, Qy, Qz)",438,439,"* --- Automatically Added Context ---
vector_to_hom_mat3d ('rigid', X, Y, Z, X + FlowX, Y + FlowY, Z + FlowZ, HomMat3D)
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
RotPoint := [1, 1,-(..."
4c0dba34,micro,17,,"RotDir1 := RotPoint - SphereAxis[0:2]
RotDir2 := [Qx,Qy,Qz] - SphereAxis[0:2]
RotDir1 := RotDir1 / sqrt(sum(RotDir1 * RotDir1))
RotDir2 := RotDir2 / sqrt(sum(RotDir2 * RotDir2))",440,444,"* --- Automatically Added Context ---
SphereAxis := PointOnAxis + Axis * SphereRadius
SphereRadius := SphereParameters[3]
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
compute_closest_po..."
4c0dba34,micro,18,,"n := 20
MaxAngle := 120.0
sequence := [0:MaxAngle / n:MaxAngle]
a := sin(rad(sequence)) * SphereRadius
b := cos(rad(sequence)) * SphereRadius
for i := 0 to |sequence| - 1 by 1
Q := SphereCenter[0:2] + b[i] * Axis[0:2] + a[i] * RotDir1[0:2]
Q1[i] := Q[0]
Q2[i] := Q[1]
Q3[i] := Q[2]
V := SphereCenter[...",445,528,"* --- Automatically Added Context ---
SphereCenter := SphereParameters[0:2]
SphereRadius := SphereParameters[3]
hom_mat3d_to_axis_angle (HomMat3D, Angle, Axis, FixedPoint)
gen_rotation_angle_visualiza..."
3ead5230,full,0,"This example compares the performance of equivalent binomial
and Gaussian filter. Therefore an image...","dev_close_window ()
dev_update_off ()
read_image (Image, 'fuse')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Loops := 5
FilterSize := [3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29]
Sigma := [0.7523, 1.0317, 1.2505, ...",13,98,
3ead5230,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'fuse')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Loops := 5",12,19,
3ead5230,micro,2,,"FilterSize := [3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29]
Sigma := [0.7523, 1.0317, 1.2505, 1.4365, 1.6010, 1.7502, 1.8876, 2.0157, 2.1361, 2.2501, 2.3586, 2.4623, 2.5618, 2.6576]",20,23,
3ead5230,micro,3,"In each iteration step use a different filter size for the
binomial filter and a different sigma val...","for J := 0 to |FilterSize| - 1 by 1
dev_display (Image)
count_seconds (Start)
for I := 1 to Loops by 1
binomial_filter (Image, ImageBinomial, FilterSize[J], FilterSize[J])
endfor
count_seconds (End)
TimeBinomial := (1000.0 * (End - Start) / (1.0 * Loops))$'3.1f'
dev_display (ImageBinomial)
disp_mess...",24,104,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Loops := 5
FilterSize := [3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27,..."
48167a12,full,0,"This example program shows how to use anisotropic_diffusion to smooth an
image while preserving or e...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 511, 511)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_clear_window ()
Methods := ['\'guided_filter\'', '\'bilateral_filter\'', '\'anisotropic_diffusion\'']
Message := 'Compare differe...",10,145,
48167a12,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 511, 511)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_clear_window ()
Methods := ['\'guided_filter\'', '\'bilateral_filter\'', '\'anisotropic_diffusion\'']
Message := 'Compare differe...",9,151,
191b41d1,full,0,"This example illustrates the differences between the diverse
implementations of Gaussian filters pro...","dev_update_off ()
dev_close_window ()
Width := 1000
Height := 400
gen_lines_image (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', MainWindow)
set_display_font (MainWindow, 14, 'mono', 'true', 'false')
MaskSizeBinomial := [5, 11, 17, 27]
MaskSizeGauss := [5, 7, 9, 11]
Sigma := [...",32,323,
191b41d1,micro,1,,"dev_update_off ()
dev_close_window ()
Width := 1000
Height := 400
gen_lines_image (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', MainWindow)
set_display_font (MainWindow, 14, 'mono', 'true', 'false')",31,39,
191b41d1,micro,2,,"MaskSizeBinomial := [5, 11, 17, 27]
MaskSizeGauss := [5, 7, 9, 11]
Sigma := [1.075, 1.55, 2.025, 2.55]
FilterNames := ['Operator', 'smooth_image', 'gauss_filter', 'derivate_gauss', 'binomial_filter']
Colors := ['blue', 'orange', 'lime green', 'magenta', 'cornflower blue']
ComputeDevice := 'GPU'
Inpu...",40,102,"* --- Automatically Added Context ---
gen_lines_image (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', MainWindow)
* --- End of Automatically Added Context ---"
191b41d1,micro,3,,"ColumnStart := 30
ColumnEnd := 470
gen_rectangle1 (GaussRectangle, 115, ColumnStart, 164, ColumnEnd)
gen_rectangle1 (BinomialRectangle, 165, ColumnStart, 214, ColumnEnd)
gen_rectangle1 (DerivateRectangle, 215, ColumnStart, 264, ColumnEnd)
gen_rectangle1 (SmoothRectangle, 265, ColumnStart, 314, Colum...",103,116,
191b41d1,micro,4,Compare results and execution times for different filter sizes,"for I := 0 to |Sigma| - 1 by 1
dev_clear_window ()
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (Image)
Suffix := ''
Suffix[1] := '(deriche2) (Alpha = ' + (0.885 / Sigma[I])$'.3f' + ')'
Suffix[2] := ' (' + MaskSizeGauss[I] + 'x' + MaskSizeGauss[I] + ')'
Suffix[3] := ' (Sigma = ' + Sigma[I]...",117,166,"* --- Automatically Added Context ---
Width := 1000
Height := 400
gen_lines_image (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', MainWindow)
MaskSizeBinomial := [5, 11, 17, 27]
..."
191b41d1,micro,5,,"Max := max(Runtime)
dev_clear_window ()
plot_tuple (MainWindow, Sigma$'.3f', Runtime[|Sigma|:|Runtime| - 1], 'Sigma', 'Average execution times on a ' + Width + ' x ' + Height + ' image in ms', Colors[1:|FilterNames| - 1], 'axes_color', 'black')
disp_message (MainWindow, FilterNames[1:4], 'window', 7...",167,334,"* --- Automatically Added Context ---
Width := 1000
Height := 400
gen_lines_image (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', MainWindow)
MaskSizeBinomial := [5, 11, 17, 27]
..."
8df20abc,full,0,Interpolate 2 video half images,"dev_close_window ()
dev_update_off ()
read_image (Marks, 'marks')
get_image_size (Marks, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
fill_interlace (Marks, ImageRemoved, 'rmodd')
fill_interlace (Marks, Image...",8,30,
8df20abc,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Marks, 'marks')
get_image_size (Marks, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
fill_interlace (Marks, ImageRemoved, 'rmodd')
fill_interlace (Marks, Image...",6,15,
8df20abc,micro,2,,"dev_set_part (114, 222, 215, 364)
dev_display (Marks)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",16,20,"* --- Automatically Added Context ---
read_image (Marks, 'marks')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
8df20abc,micro,3,,"dev_display (ImageFilled)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (ImageRemoved)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_set_part (57, 222, 107, 364)
dev_display (ImageRemoved)
stop ()",21,36,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
fill_interlace (Marks, ImageRemoved, 'rmodd')
fill_interlace (Marks, ImageFilled, 'odd')
* --- End of..."
685b31b2,full,0,"This example program shows how isotropic_diffusion can be used to smooth
an image with a reduced dom...","read_image (Image, 'board/board-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_rectangle1 (Rectangle, 180, 145, 310, 460)
reduce_domain (Image, Rectangle, Ima...",13,53,
685b31b2,micro,1,"an image with a reduced domain in order to avoid artifacts at the border of
the domain.  In standard...","read_image (Image, 'board/board-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,17,
685b31b2,micro,2,"borders.  The domain and filter parameters are chosen such that the
filter smooth_image accesses the...","gen_rectangle1 (Rectangle, 180, 145, 310, 460)
reduce_domain (Image, Rectangle, ImageReduced)",18,22,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
* --- End of Automatically Added Context ---"
685b31b2,micro,3,,"dev_set_line_width (2)
dev_set_draw ('margin')
dev_display (Image)
dev_set_color ('red')
dev_display (Rectangle)
set_tposition (WindowHandle, 10, 10)
Message := 'Image and ROI'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",23,32,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_rectangle1 (Rectangle, 180, 145, 310, 460)
* --- End of Auto..."
685b31b2,micro,4,,"dev_clear_window ()
dev_display (ImageReduced)
Message := 'Image with ROI applied'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",33,38,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
reduce_domain (Image, Rectangle, ImageReduced)
Message := 'Image..."
685b31b2,micro,5,artifacts at the borders of the domain.,"smooth_image (ImageReduced, ImageSmooth, 'gauss', 5)
dev_clear_window ()
dev_display (ImageSmooth)
Message := 'Gaussian smoothing with smooth_image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
stop ()",39,46,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
reduce_domain (Image, Rectangle, ImageReduced)
Message := 'Image and ROI'
* --- End of Automatically ..."
685b31b2,micro,6,are no artifacts at the border of the domain.,"isotropic_diffusion (ImageReduced, SmoothedImage, 5, 0)
dev_clear_window ()
dev_display (SmoothedImage)
Message := 'Gaussian smoothing with isotropic_diffusion'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",47,59,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
reduce_domain (Image, Rectangle, ImageReduced)
Message := 'Image and ROI'
* --- End of Automatically ..."
48da0987,full,0,Smooth an image using the median filter,"read_image (Image, 'mreut')
median_image (Image, ImageMedian, 'circle', 3, 'mirrored')
dev_set_part (111, 205, 111 + 70, 205 + 70)
dev_display (Image)
stop ()
dev_display (ImageMedian)",8,15,
48da0987,micro,1,,"read_image (Image, 'mreut')
median_image (Image, ImageMedian, 'circle', 3, 'mirrored')",6,9,
48da0987,micro,2,,"dev_set_part (111, 205, 111 + 70, 205 + 70)
dev_display (Image)
stop ()",10,13,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
48da0987,micro,3,,dev_display (ImageMedian),14,21,"* --- Automatically Added Context ---
median_image (Image, ImageMedian, 'circle', 3, 'mirrored')
* --- End of Automatically Added Context ---"
86ea9656,full,0,"This example shows how median_rect can be used to enhance
images by removing undesirable background ...","dev_update_off ()
read_image (ImageAngio, 'angio-part')
get_image_size (ImageAngio, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Ima...",8,74,
86ea9656,micro,1,images by removing undesirable background information.,dev_update_off (),6,8,
86ea9656,micro,2,"certain tissue structures from an angiographic image.  This
helps to enhance the visibility of the b...","read_image (ImageAngio, 'angio-part')
get_image_size (ImageAngio, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (ImageAngio)
disp_mess...",9,22,
86ea9656,micro,3,"of the tissue structures.  Note that the mask size must be
chosen large enough so that the blood ves...","median_rect (ImageAngio, ImageAngioMedian, 61, 61)
min_max_gray (ImageAngioMedian, ImageAngioMedian, 0, Min, Max, Range)
sub_image (ImageAngio, ImageAngioMedian, ImageAngioEnhanced, 3, 3 * Min)
dev_display (ImageAngioEnhanced)
disp_message (WindowHandle, 'Enhanced image', 'window', 12, 12, 'black', ...",23,35,"* --- Automatically Added Context ---
read_image (ImageAngio, 'angio-part')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
86ea9656,micro,4,perform a shading correction of an unevenly lit object.,"read_image (ImageBraille, 'photometric_stereo/embossed_01')
get_image_size (ImageBraille, Width, Height)
dev_set_window_extents (-1, -1, Width / 2, Height / 2)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (ImageBraille)
disp_message (WindowHandle, 'Original image', 'window', 12, 12, 'black...",36,45,"* --- Automatically Added Context ---
get_image_size (ImageAngio, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'Original image', 'window', 12..."
86ea9656,micro,5,"angiography example.  The only difference is the mask size and
the scale factor for the gray values,...","median_rect (ImageBraille, ImageBrailleMedian, 55, 55)
min_max_gray (ImageBrailleMedian, ImageBrailleMedian, 0, Min, Max, Range)
sub_image (ImageBraille, ImageBrailleMedian, ImageBrailleCorrected, 1, Min)
dev_display (ImageBrailleCorrected)
disp_message (WindowHandle, 'Shading-corrected image', 'win...",46,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
min_max_gray (ImageAngioMedian, ImageAngioMedian, 0, Min, Max, Range)
read_image (ImageBraille, 'phot..."
86ea9656,micro,6,"smoothed image for dyn_threshold.  This serves the same
purpose as the shading correction in the sec...","read_image (ImageNeedle, 'needle1')
get_image_size (ImageNeedle, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_display (ImageNeedle)
disp_message (WindowHandle, 'Original image', 'window', 12, 12, 'black', 'true')
disp_continue_message (...",56,80,"* --- Automatically Added Context ---
get_image_size (ImageAngio, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
disp_message (WindowHandle, 'Original image', 'window', 12..."
d4e123e5,full,0,Smooth an image with an arbitrary rank mask.,"read_image (Image, 'mreut')
gen_circle (StructEl, 200, 200, 10.5)
area_center (StructEl, Area, Row, Column)
rank_image (Image, StructEl, Dilation, Area, 'mirrored')
rank_image (Dilation, StructEl, Closing, 1, 'mirrored')",8,12,
d4e123e5,micro,1,,"read_image (Image, 'mreut')
gen_circle (StructEl, 200, 200, 10.5)
area_center (StructEl, Area, Row, Column)
rank_image (Image, StructEl, Dilation, Area, 'mirrored')
rank_image (Dilation, StructEl, Closing, 1, 'mirrored')",6,18,
6ad34615,full,0,"This example program illustrates how to use rank_n to compute a
background image of a scene with mov...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
NumImages := 27
for Index := 1 to NumImages by 1
read_image (Image, 'bicycle/bicycle_' + Index$'02d')
dev_display (Image)
disp_message (WindowHan...",11,41,
6ad34615,micro,1,"background image of a scene with moving objects and that mean_n
cannot be used to perform this task....","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
NumImages := 27",6,15,
6ad34615,micro,2,,"for Index := 1 to NumImages by 1
read_image (Image, 'bicycle/bicycle_' + Index$'02d')
dev_display (Image)
disp_message (WindowHandle, 'Image ' + Index, 'window', 12, 12, 'black', 'true')
if (Index == 1)
copy_obj (Image, MotionImages, 1, 1)
else
append_channel (MotionImages, Image, MotionImages)
endi...",16,27,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
NumImages := 27
* --- End of Automatically Added Context ---"
6ad34615,micro,3,moving objects.,"mean_n (MotionImages, ImageMean)
dev_display (ImageMean)
disp_message (WindowHandle, 'Mean image of the ' + NumImages + ' images', 'window', 10, 10, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",28,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
NumImages := 27
copy_obj (Image, MotionImages, 1, 1)
* --- End of Automatically Added Context ---"
6ad34615,micro,4,"the median of the 27 images.  This creates a clean background image
without the moving objects.","rank_n (MotionImages, ImageMedian, (NumImages + 1) / 2)
dev_display (ImageMedian)
disp_message (WindowHandle, 'Median image of the ' + NumImages + ' images', 'window', 10, 10, 'black', 'true')",36,47,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
NumImages := 27
copy_obj (Image, MotionImages, 1, 1)
* --- End of Automatically Added Context ---"
e1a1b7dc,full,0,"This example shows that rank filtering with a rank different from 1 and
the area of the mask can be ...","dev_update_off ()
read_image (Image, 'pcb_layout')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
MaskSize := 7
Rank...",19,54,
e1a1b7dc,micro,1,"the area of the mask can be used to implement a kind of gray value
morphology that is less rigorous ...","dev_update_off ()
read_image (Image, 'pcb_layout')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
MaskSize := 7
Rank...",6,60,
d57a71f1,full,0,Calculate the entropy of gray values within a rectangular window,"read_image (MreutY, 'mreut_y')
entropy_image (MreutY, ImageEntropy, 9, 9)
threshold (ImageEntropy, RegionEnt, 165, 255)
fill_up_shape (RegionEnt, RegionFillUpSh, 'area', 0, 100)
opening_circle (RegionFillUpSh, RegionOpening, 8.5)
connection (RegionOpening, ConnectedRegions)
select_shape (ConnectedRe...",8,20,
d57a71f1,micro,1,,"read_image (MreutY, 'mreut_y')
entropy_image (MreutY, ImageEntropy, 9, 9)
threshold (ImageEntropy, RegionEnt, 165, 255)
fill_up_shape (RegionEnt, RegionFillUpSh, 'area', 0, 100)",6,11,
d57a71f1,micro,2,,"opening_circle (RegionFillUpSh, RegionOpening, 8.5)
connection (RegionOpening, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 350, 10000000)
select_gray (SelectedRegions, MreutY, TexureRegions, 'entropy', 'and', 7, 8)
dev_display (MreutY)
dev_set_draw ('margin')
de...",12,26,"* --- Automatically Added Context ---
read_image (MreutY, 'mreut_y')
fill_up_shape (RegionEnt, RegionFillUpSh, 'area', 0, 100)
* --- End of Automatically Added Context ---"
8bad1cf2,full,0,"This example program shows the basic concept of how to use the
Laws texture filters for the texture-...","dev_update_off ()
read_image (Image, 'forest_road')
dev_get_window (WindowHandle)
if (WindowHandle != -1)
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
else
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
endif
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_li...",14,180,
8bad1cf2,micro,1,"Laws texture filters for the texture-based segmentation of an image.
For simplicity reasons, only tw...",dev_update_off (),6,15,
8bad1cf2,micro,2,,"read_image (Image, 'forest_road')
dev_get_window (WindowHandle)
if (WindowHandle != -1)
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
else
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
endif
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_d...",16,31,
8bad1cf2,micro,3,"The first one responds to 'spots' ('ss') while the second one
responds to 'edges' ('ee') in the inpu...","texture_laws (Image, SS, 'ss', 0, 5)
texture_laws (Image, EE, 'ee', 1, 5)",32,37,"* --- Automatically Added Context ---
read_image (Image, 'forest_road')
* --- End of Automatically Added Context ---"
8bad1cf2,micro,4,,"dev_display (SS)
Message := ['Result of the Laws filter \'ss\',', 'which responds to \'spots\'.']
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (EE)
Message := ['Result of the Laws filter \'ee\',', 'w...",38,49,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
Message := 'Input image to be segmented'
texture_laws (Image, SS, 'ss', 0, 5)
texture_laws (Image, EE, 'ee', 1, 5)
* --- End of Auto..."
8bad1cf2,micro,5,"derive texture information from the filtered images.
This means that some statistics of the filter r...","MedianSize := 15
median_separate (SS, SSMed, MedianSize, MedianSize, 'mirrored')
median_separate (EE, EEMed, MedianSize, MedianSize, 'mirrored')",50,60,"* --- Automatically Added Context ---
texture_laws (Image, SS, 'ss', 0, 5)
texture_laws (Image, EE, 'ee', 1, 5)
* --- End of Automatically Added Context ---"
8bad1cf2,micro,6,,"dev_display (SSMed)
Message := ['Median filtered result of the', 'Laws filter \'ss\'']
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (EEMed)
Message := ['Median filtered result of the', 'Laws filter \...",61,72,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
Message := 'Input image to be segmented'
median_separate (SS, SSMed, MedianSize, MedianSize, 'mirrored')
median_separate (EE, EEMed,..."
8bad1cf2,micro,7,which contain the texture information.,"histo_2dim (SSMed, SSMed, EEMed, Histo2DimFull)",73,76,"* --- Automatically Added Context ---
median_separate (SS, SSMed, MedianSize, MedianSize, 'mirrored')
median_separate (EE, EEMed, MedianSize, MedianSize, 'mirrored')
* --- End of Automatically Added C..."
8bad1cf2,micro,8,,"get_window_extents (WindowHandle, WRow, WColumn, WWidth, WHeight)
dev_open_window (0, WWidth + 20, WWidth, WHeight, 'black', WindowHandleHisto)
dev_set_part (0, 0, 255, 255)
set_display_font (WindowHandleHisto, 16, 'mono', 'true', 'false')
dev_set_lut ('cubic_root')
dev_display (Histo2DimFull)
Messa...",77,86,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
histo_2dim (SSMed, SSMed, EEMed, Histo2DimFull)
* --- End of Automatically Added Context ---"
8bad1cf2,micro,9,"(draw using left mouse button, confirm with right mouse button)","dev_set_window (WindowHandle)
dev_display (Image)
dev_set_color ('blue')
Message := ['Draw a training region, for a class to', 'be segmented with texture classification,', 'e.g., forest or grassland']
disp_message (WindowHandle, Message, 'window', 12, 12, 'blue', 'true')
draw_region (TrainingRegion,...",87,95,"* --- Automatically Added Context ---
read_image (Image, 'forest_road')
dev_get_window (WindowHandle)
Message := 'Input image to be segmented'
* --- End of Automatically Added Context ---"
8bad1cf2,micro,10,,"histo_2dim (TrainingRegion, SSMed, EEMed, Histo2Dim)
threshold (Histo2Dim, RegionFeat, 1, 1000000)
fill_up (RegionFeat, RegionFillUp)
dilation_circle (RegionFillUp, FeatureSpace, 1.5)",96,101,"* --- Automatically Added Context ---
median_separate (SS, SSMed, MedianSize, MedianSize, 'mirrored')
median_separate (EE, EEMed, MedianSize, MedianSize, 'mirrored')
draw_region (TrainingRegion, Windo..."
8bad1cf2,micro,11,,"dev_set_window (WindowHandleHisto)
dev_set_color ('blue')
dev_set_draw ('margin')
dev_display (Histo2DimFull)
dev_display (FeatureSpace)
disp_message (WindowHandleHisto, MessageH, 'window', 12, WWidth - 400, 'black', 'true')
Message := ['The feature space of the training', 'region is marked in blue'...",102,113,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
Message := 'Input image to be segmented'
histo_2dim (SSMed, SSMed, EEMed, Histo2DimFull)
get_window_extents (WindowHandle, WRow, WCo..."
8bad1cf2,micro,12,,"class_2dim_sup (SSMed, EEMed, FeatureSpace, RegionClass)",114,115,"* --- Automatically Added Context ---
median_separate (SS, SSMed, MedianSize, MedianSize, 'mirrored')
median_separate (EE, EEMed, MedianSize, MedianSize, 'mirrored')
dilation_circle (RegionFillUp, Fea..."
8bad1cf2,micro,13,,"opening_circle (RegionClass, RegionOpening, 1.5)
fill_up_small_holes (RegionOpening, RegionClassFilled, 150)",116,119,"* --- Automatically Added Context ---
class_2dim_sup (SSMed, EEMed, FeatureSpace, RegionClass)
* --- End of Automatically Added Context ---"
8bad1cf2,micro,14,,"dev_set_window (WindowHandle)
dev_set_draw ('margin')
dev_display (Image)
dev_display_region_overlay (Image, RegionClassFilled)
dev_set_color ('blue')
dev_display (TrainingRegion)
Message := ['Segmentation result based on the', 'texture information of the training region']
disp_message (WindowHandle...",120,190,"* --- Automatically Added Context ---
read_image (Image, 'forest_road')
dev_get_window (WindowHandle)
Message := 'Input image to be segmented'
draw_region (TrainingRegion, WindowHandle)
fill_up (Regio..."
4ea83a9d,full,0,"This example program shows how to segment an image based on
texture by using an MLP pixel classifier...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colored (12)
set_display_font (WindowHandleL, 14, 'mono', 'true', 'false')
read_image (Image, 'combine')
dev_display (Image)
texture_laws (Image, Imag...",12,111,
4ea83a9d,micro,1,"texture by using an MLP pixel classifier, which is used
directly and indirectly with a look-up table...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colored (12)
set_display_font (WindowHandleL, 14, 'mono', 'true', 'false')
read_image (Image, 'combine')
dev_display (Image)",6,21,
4ea83a9d,micro,2,,"texture_laws (Image, ImageTexture1, 'ee', 5, 7)
texture_laws (Image, ImageTexture2, 'ss', 2, 7)
texture_laws (Image, ImageTexture3, 'rr', 0, 7)
texture_laws (Image, ImageTexture4, 'ww', 0, 7)
texture_laws (Image, ImageTexture5, 'le', 7, 7)
texture_laws (Image, ImageTexture6, 'el', 7, 7)",22,29,"* --- Automatically Added Context ---
read_image (Image, 'combine')
* --- End of Automatically Added Context ---"
4ea83a9d,micro,3,,"MaskWidth := 41
mean_image (ImageTexture1, ImageMean1, MaskWidth, MaskWidth)
mean_image (ImageTexture2, ImageMean2, MaskWidth, MaskWidth)
mean_image (ImageTexture3, ImageMean3, MaskWidth, MaskWidth)
mean_image (ImageTexture4, ImageMean4, MaskWidth, MaskWidth)
mean_image (ImageTexture5, ImageMean5, M...",30,39,"* --- Automatically Added Context ---
texture_laws (Image, ImageTexture1, 'ee', 5, 7)
texture_laws (Image, ImageTexture2, 'ss', 2, 7)
texture_laws (Image, ImageTexture3, 'rr', 0, 7)
texture_laws (Imag..."
4ea83a9d,micro,4,,"gen_empty_obj (ClassSamples)
R1 := 10
dR := 255
C1 := 80
dC := 125
W := 10
H := 225
for Row := R1 to R1 + dR by dR
for Col := C1 to C1 + 3 * dC by dC
gen_rectangle1 (ClassSample, Row, Col, Row + H, Col + W)
concat_obj (ClassSamples, ClassSample, ClassSamples)
endfor
endfor
dev_display (ClassSamples)...",40,58,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
* --- End of Automatically Added Context ---"
4ea83a9d,micro,5,,"create_class_mlp (6, 6, 8, 'softmax', 'principal_components', 3, 42, MLPHandle)
add_samples_image_class_mlp (TextureImage, ClassSamples, MLPHandle)
dev_display (Image)
dev_display (ClassSamples)
Message := 'Training MLP classifier ...'
disp_message (WindowHandleL, Message, 'window', 12, 12, 'black',...",59,69,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
read_image (Image, 'combine')
compose6 (ImageMean1, ImageMean2, ImageMean3, ImageMean4, ImageMean5, Image..."
4ea83a9d,micro,6,,"Message[1] := 'Creating MLP-based LUT classifier ...'
disp_message (WindowHandleL, Message, 'window', 12, 12, 'black', 'true')
count_seconds (t1)
create_class_lut_mlp (MLPHandle, [], [], ClassLUTHandle)
count_seconds (t2)
TimeLUTCreate := t2 - t1
Message[1] := 'Creating MLP-based LUT classifier ... ...",70,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
create_class_mlp (6, 6, 8, 'softmax', 'principal_components', 3, 42, MLPHandle)
Message := 'Training MLP ..."
4ea83a9d,micro,7,,"count_seconds (t1)
for Index := 1 to 100 by 1
classify_image_class_lut (TextureImage, ClassRegionsLUT, ClassLUTHandle)
endfor
count_seconds (t2)
TimeLUT := (t2 - t1) / 100
dev_set_draw ('fill')
dev_display (ClassRegionsLUT)
disp_message (WindowHandleL, 'Result of the LUT classifier\nTime to classify...",83,93,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
compose6 (ImageMean1, ImageMean2, ImageMean3, ImageMean4, ImageMean5, ImageMean6, TextureImage)
Message[1..."
4ea83a9d,micro,8,"Note: The result of the MLP classifier used directly is more
accurate because the MLP-based LUT clas...","dev_open_window (0, 512 + 5, 512, 512, 'black', WindowHandleR)
dev_set_draw ('fill')
dev_set_line_width (3)
dev_set_colored (12)
dev_display (Image)
set_display_font (WindowHandleR, 14, 'mono', 'true', 'false')
count_seconds (t1)
classify_image_class_mlp (TextureImage, ClassRegions, MLPHandle, 0.5)
...",94,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandleL)
read_image (Image, 'combine')
compose6 (ImageMean1, ImageMean2, ImageMean3, ImageMean4, ImageMean5, Image..."
60ea8887,full,0,Query the mouse position,"dev_set_preferences ('graphics_window_context_menu', 'false')
read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_window_param (WindowID, 'flush', 'false')
dev_display (Image)
Button := 1
dev_update_pc ('...",8,36,
60ea8887,micro,1,,"dev_set_preferences ('graphics_window_context_menu', 'false')
read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_window_param (WindowID, 'flush', 'false')
dev_display (Image)
Button := 1
dev_update_pc ('...",6,42,
51a04b71,full,0,"This example demonstrates how to use a drawing object of type
'circle_arc' for an interactive edge d...","dev_update_off ()
dev_close_window ()
dev_set_preferences ('graphics_window_context_menu', 'false')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
get_system ('operating_system', OS)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_display ...",18,150,
51a04b71,micro,1,,"dev_update_off ()
dev_close_window ()
dev_set_preferences ('graphics_window_context_menu', 'false')",17,21,
51a04b71,micro,2,,"read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
get_system ('operating_system', OS)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_display (Image)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",22,29,
51a04b71,micro,3,,"Message := 'This example shows how to apply a Sobel filter'
Message[1] := 'within the area of a drawing object of type'
Message[2] := '\'circle_arc\' to detect edges while'
Message[3] := 'interactively moving, resizing, or changing'
Message[4] := 'the angle of the circle sector.'
disp_message (Windo...",30,40,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
51a04b71,micro,4,,"create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
set_drawing_object_params (DrawID, 'color', 'yellow')",41,44,
51a04b71,micro,5,,"attach_drawing_object_to_window (WindowHandle, DrawID)
attach_background_to_window (Image, WindowHandle)",45,48,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
..."
51a04b71,micro,6,,"Message := 'Move, resize or change the angles by dragging\nthe handles and border of the circle sector.\nExit the interaction by clicking the right\nmouse button.'
get_font (WindowHandle, Font)
create_drawing_object_text (12, 20, Message, DrawIDMessage)
set_drawing_object_params (DrawIDMessage, ['co...",49,55,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This example shows how to apply a Sobel filter'
* --- End of Automatically Added Context..."
51a04b71,micro,7,"***************************************************
Apply a sobel filter in the area of the drawing ...","set_window_param (WindowHandle, 'flush', 'false')
Button := 0
while (Button != 4)
try
image_processing (Image, EdgeAmplitude, DrawID)
display_results (EdgeAmplitude, WindowHandle)
get_mposition (WindowHandle, Row, Column, Button)
catch (Exception)
endtry
endwhile
set_window_param (WindowHandle, 'flu...",56,77,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
..."
51a04b71,micro,8,,"detach_drawing_object_from_window (WindowHandle, DrawID)
detach_drawing_object_from_window (WindowHandle, DrawIDMessage)
detach_background_from_window (WindowHandle)",78,82,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
create_drawing_object_text (..."
51a04b71,micro,9,,"clear_drawing_object (DrawID)
clear_drawing_object (DrawIDMessage)
dev_clear_window ()
dev_display (Image)
disp_message (WindowHandle, 'The drawing object has been cleared.', 'window', 12, 12, 'black', 'true')",83,108,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
..."
51a04b71,micro,10,drawing object for the edge detection,"get_drawing_object_iconic (Region, DrawID)
reduce_domain (Image, Region, ImageReduced)
sobel_amp (ImageReduced, EdgeAmplitude, 'sum_abs', 3)
return ()",109,144,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
create_drawing_object_circle_sector (250, 200, 100, 0, 3.14159, DrawID)
image_processing (Image, EdgeAmplitude, DrawID)
* --- End of A..."
51a04b71,micro,11,results do not show anymore,"dev_clear_window ()
dev_display (EdgeAmplitude)
flush_buffer (WindowHandle)
return ()",145,168,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
image_processing (Image, EdgeAmplitude, DrawID)
* --- End of Automatically Added Context ---"
de3e3140,full,0,"This example demonstrates how to use a drawing object of type
'rectangle2' for an interactive measur...","dev_close_window ()
dev_update_off ()
dev_set_preferences ('graphics_window_context_menu', 'false')
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_display (Image)
set_display_font (WindowHandl...",19,141,
de3e3140,micro,1,,"dev_close_window ()
dev_update_off ()
dev_set_preferences ('graphics_window_context_menu', 'false')",18,22,
de3e3140,micro,2,,"read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_display (Image)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",23,30,
de3e3140,micro,3,,"Message := 'This examples shows how to measure and extract straight edges within'
Message[1] := 'the area of a drawing object of type \'rectangle2\' while'
Message[2] := 'interactively moving, resizing, or rotating the rectangle. '
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'tru...",31,39,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
de3e3140,micro,4,color of the rectangle,"create_drawing_object_rectangle2 (300, 530, rad(90), 90, 20, DrawID)
set_drawing_object_params (DrawID, 'color', 'red')",40,44,
de3e3140,micro,5,,"attach_drawing_object_to_window (WindowHandle, DrawID)
attach_background_to_window (Image, WindowHandle)",45,48,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_rectangle2 (300, 530, rad(90), 90, 20, DrawID)
* --..."
de3e3140,micro,6,,"Message := 'Move, resize or rotate the rectangle by dragging the handles of the\nrectangle. The extracted edge points of the measuring are displayed\ninstantly. End the interaction by clicking the right mouse button.'
create_drawing_object_text (20, 40, Message, DrawIDMessage)
get_font (WindowHandle...",49,55,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This examples shows how to measure and extract straight edges within'
* --- End of Autom..."
de3e3140,micro,7,"*************************************************************
Measure straight edges that lie perpen...","set_window_param (WindowHandle, 'flush', 'false')
Button := 0
while (Button != 4)
try
perform_measurement (Image, DrawID, Width, Height, RowEdge, ColumnEdge)
display_results (RowEdge, ColumnEdge, WindowHandle)
get_mposition (WindowHandle, Row, Column, Button)
catch (Exception)
endtry
endwhile
set_wi...",56,78,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_rectangle2 (3..."
de3e3140,micro,8,,"dev_clear_window ()
detach_drawing_object_from_window (WindowHandle, DrawID)
detach_drawing_object_from_window (WindowHandle, DrawIDMessage)
detach_background_from_window (WindowHandle)
dev_clear_window ()
dev_display (Image)
disp_message (WindowHandle, 'The drawing object has been cleared', 'window...",79,109,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_rectangle2 (300, 530, rad(90), 90, 20, DrawID)
crea..."
de3e3140,micro,9,measure object,"get_drawing_object_params (DrawID, ['row', 'column', 'phi', 'length1', 'length2'], GenParamValue)
gen_measure_rectangle2 (GenParamValue[0], GenParamValue[1], GenParamValue[2], GenParamValue[3], GenParamValue[4], Width, Height, 'nearest_neighbor', MeasureHandle)
measure_pos (Image, MeasureHandle, 1, ...",110,158,"* --- Automatically Added Context ---
read_image (Image, 'fuse')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_drawing_object_rectangle2 (3..."
6aad139c,full,0,"This example shows how to use the operator disp_object_model_3d to
display 3d object models.
The exa...","dev_update_off ()
gen_cam_par_area_scan_division (0.025, 0, 1.1e-05, 1.1e-05, 384.0, 288.0, 768, 576, CameraParam)
create_pose (-0.037, 0.026, 0.42, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_pose (0.009, -0.011, 0.4, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
create_pose (0.042, 0.01, 0...",10,207,
6aad139c,micro,1,"display 3d object models.
The example shows the usage of different visualization parameters
and requ...","dev_update_off ()
gen_cam_par_area_scan_division (0.025, 0, 1.1e-05, 1.1e-05, 384.0, 288.0, 768, 576, CameraParam)
create_pose (-0.037, 0.026, 0.42, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_pose (0.009, -0.011, 0.4, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
create_pose (0.042, 0.01, 0...",6,214,
f1c80f0e,full,0,Display an XLD object.,"read_image (Image, 'mreut')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
edges_sub_pix (Image, Edges, 'mderiche2', 0.7, 10, 20)
edges_image (Image, ImaAmp, ImaDir, 'mderiche2', 0.7, 'nms', 10, 20)
threshold (ImaAmp, Region, 1, 255)
gen_contours_skeleton_xld (Region, Contou...",8,26,
f1c80f0e,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)",6,10,
f1c80f0e,micro,2,,"edges_sub_pix (Image, Edges, 'mderiche2', 0.7, 10, 20)
edges_image (Image, ImaAmp, ImaDir, 'mderiche2', 0.7, 'nms', 10, 20)
threshold (ImaAmp, Region, 1, 255)
gen_contours_skeleton_xld (Region, Contours, 1, 'filter')
dev_clear_window ()",11,16,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
f1c80f0e,micro,3,,"count_seconds (Seconds1)
disp_xld (Edges, WindowID)
count_seconds (Seconds2)
Time1 := Seconds2 - Seconds1
dev_clear_window ()
count_seconds (Seconds1)
disp_xld (Contours, WindowID)
count_seconds (Seconds2)
Time2 := Seconds2 - Seconds1",17,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
edges_sub_pix (Image, Edges, 'mderiche2', 0.7, 10, 20)
gen_contours_skeleton_xld (Region, Contours, 1, 'filter..."
a4464117,full,0,"This example shows how to use the procedure plot_tuple to
plot functions in a coordinate system.
Ini...","dev_close_window ()
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
X := [-rad(180):0.01:rad(180)]
Y1 := sin(X)
XLabel := 'x'
YLabel := 'sin(x)'
Color := []
GenParamName := []
GenParamValue := []
Title := 'Pl...",10,220,
a4464117,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)",9,14,
a4464117,micro,2,,"X := [-rad(180):0.01:rad(180)]
Y1 := sin(X)
XLabel := 'x'
YLabel := 'sin(x)'
Color := []
GenParamName := []
GenParamValue := []
Title := 'Plot function with default settings'",17,25,
a4464117,micro,3,,"dev_clear_window ()
dev_set_color ('medium slate blue')
plot_tuple (WindowHandle, X, Y1, XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_message (WindowHandle, Title, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",26,33,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
Y1 := sin(X)
XLabel := 'x'
YLabel := 'sin(x)'
Color := []
GenParamName := [..."
a4464117,micro,4,share the same X values.,"Y1 := sin(X)
Y2 := (X * X) * 0.2 - 1
XLabel := 'x'
YLabel := 'y'
Color := ['medium slate blue', 'yellow']
GenParamName := []
GenParamValue := []
Title := 'Plot two functions with identical x values in one coordinate system'
dev_clear_window ()
plot_tuple (WindowHandle, X, [Y1,Y2], XLabel, YLabel, Co...",36,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
Y1 := sin(X)
XLabel := 'x'
YLabel := 'sin(x)'
Color := []
GenParamName := [..."
a4464117,micro,5,,"GenParamName := ['ticks_x', 'ticks_y', 'grid_x', 'grid_y']
GenParamValue := [rad(90),0.5,rad(45),0.25]
Title := 'Add tick marks and grid'
dev_clear_window ()
plot_tuple (WindowHandle, X, [Y1,Y2], XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_message (WindowHandle, Title, 'window', 12, 12,...",54,65,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,6,"In this case, the intercept point of the axes is set to (0,0).","Y3 := sin(10 * X) * X
XLabel := 'x'
YLabel := 'sin(10x)*x'
Color := 'green'
GenParamName := ['origin_x', 'origin_y']
GenParamValue := [0, 0]
Title := 'Define origin of coordinate axes'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y3, XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_messa...",68,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,7,,"GenParamName := [GenParamName,'start_x', 'end_x', 'start_y', 'end_y']
GenParamValue := [GenParamValue,-5, 5, -10, 10]
Title := 'Zoom out'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y3, XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_message (WindowHandle, Title, 'window', 12, 12, 'bla...",85,96,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,8,,"GenParamName := [GenParamName,'start_x', 'end_x', 'start_y', 'end_y']
GenParamValue := [GenParamValue,-1, 1, -1, 1]
Title := 'Zoom in'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y3, XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_message (WindowHandle, Title, 'window', 12, 12, 'black'...",97,108,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,9,"By setting the 'clip' parameter, the plot can be clipped
to the area of the coordinate system.","GenParamName := [GenParamName,'clip']
GenParamValue := [GenParamValue,'yes']
Title := 'Clip function plot to coordinate system'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y3, XLabel, YLabel, Color, GenParamName, GenParamValue)
disp_message (WindowHandle, Title, 'window', 12, 12, 'black', 'true...",109,122,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,10,,"X := [0:10]
Y := X * X
XLabel := 'x'
YLabel := 'x^2'
GenParamName := ['margin_left', 'margin_right', 'margin_top', 'margin_bottom', 'style']
GenParamValue := [50, 550, 100, 200, 'line']
dev_clear_window ()
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, 'slate blue', GenParamName, GenParamValue)",130,139,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
GenParamName := []
GenParamValue := []
XLabel := 'x'
* -..."
a4464117,micro,11,,"Y := -X * X
XLabel := 'x'
YLabel := '-x^2'
GenParamName := GenParamName
GenParamValue := [300, 300, 100, 200, 'filled']
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, 'red', GenParamName, GenParamValue)",140,147,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
GenParamName := []
GenParamValue := []
XLabel := 'x'
Y :..."
a4464117,micro,12,,"X := [-5:5]
Y := X * X
XLabel := 'x'
YLabel := 'x^2'
GenParamName := GenParamName
GenParamValue := [550, 50, 100, 200, 'cross']
Title := 'Plot three functions in different styles and different coordinate systems'
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, 'green', GenParamName, GenParamValue)
d...",148,160,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Title := 'Plot function with default settings'
GenParamN..."
a4464117,micro,13,,"X := [0:10]
Y := X * X
XLabel := 'x'
YLabel := []
Legend1 := ' x^2'
Color1 := 'slate blue'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, Color1, [], [])",168,177,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
XLabel := 'x'
Y := X * X
* --- End of Automatically Adde..."
a4464117,micro,14,"Since the axes have already been drawn with the first function,
we can set 'axes_color' to 'none' to...","Y := -X * X
Legend2 := '-x^2'
Color2 := 'yellow'
Title := 'Two functions with different styles in one coordinate system'
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, Color2, ['axes_color', 'style'], ['none', 'cross'])
disp_message (WindowHandle, Title, 'window', 12, 12, 'black', 'true')
Legend :=...",178,192,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Title := 'Plot function with default settings'
XLabel :=..."
a4464117,micro,15,,"Angle := [0:.1:4 * rad(360)]
X := Angle * sin(Angle)
Y := Angle * cos(Angle)
Color := 'orange'
XLabel := 'x'
YLabel := 'y'
Title := 'X values are not restricted to increasing sequences'
dev_clear_window ()
plot_tuple (WindowHandle, X, Y, XLabel, YLabel, Color, [], [])
disp_message (WindowHandle, Tit...",193,207,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
a4464117,micro,16,,"X := ['\'original\'', '\'pre-processed\'', '\'noisy\'']
Y := [8, 5, 13]
Color := 'green'
XLabel := 'Image Sequence'
YLabel := 'Average execution time in ms'
GenParamName := ['start_y', 'grid_y', 'margin']
GenParamValue := [0, 5, 100]
Title := 'If X values are given as strings, they are used as categ...",208,226,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
X := [-rad(180):0.01:rad(180)]
YLabel := 'sin(x)'
Color := []
Title := 'Plot function with default setting..."
8a5f77ca,full,0,"This example program shows three advanced topics how you can improve
the visualization of your HDeve...","dev_update_off ()
dev_close_window ()
read_image (ImageWafer, 'food/hazelnut_wafer_07')
get_image_size (ImageWafer, Width1, Height1)
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
set_display_font (WindowHandleLeft, 14, 'mono', 'true', 'false')
Text := 'This example pr...",14,265,
8a5f77ca,micro,1,,"dev_update_off ()
dev_close_window ()",13,16,
8a5f77ca,micro,2,,"read_image (ImageWafer, 'food/hazelnut_wafer_07')
get_image_size (ImageWafer, Width1, Height1)
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
set_display_font (WindowHandleLeft, 14, 'mono', 'true', 'false')
Text := 'This example program shows three advanced topics how'...",17,31,
8a5f77ca,micro,3,,"threshold (ImageWafer, Regions1, 58, 255)
closing_circle (Regions1, RegionClosing, 9.5)
dev_display (ImageWafer)
Text := '1. Using transparent regions and text boxes prevents'
Text[1] := '   that relevant parts of an image are hidden.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
T...",34,44,"* --- Automatically Added Context ---
read_image (ImageWafer, 'food/hazelnut_wafer_07')
Text := 'This example program shows three advanced topics how'
dev_disp_text ('Press Run (F5) to continue', 'win..."
8a5f77ca,micro,4,,"dev_set_color ('#ffff0055')
dev_display (RegionClosing)",45,47,"* --- Automatically Added Context ---
closing_circle (Regions1, RegionClosing, 9.5)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,5,,"area_center (RegionClosing, Area, Row, Column)
Message := 'Area:   ' + Area
Message[1] := 'Row:    ' + Row
Message[2] := 'Column: ' + Column",48,52,"* --- Automatically Added Context ---
closing_circle (Regions1, RegionClosing, 9.5)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,6,,"BoxColor := '#0000ff77'
dev_disp_text (Message, 'image', Row, Column + 60, 'white', 'box_color', BoxColor)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",53,58,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
area_center (RegionClosing, Area, Row, Column)
Message := 'Area:   ' + ..."
8a5f77ca,micro,7,,"read_image (ImagesBoard, 'board/board-' + [1:20]$'02')
select_obj (ImagesBoard, ObjectSelected, 1)
dev_display (ObjectSelected)
Text := '2. By default, the graphics window is updated every time'
Text[1] := '   an operator visualizes something in it. This can lead to flickering.'
Text[2] := '   The d...",59,70,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
Text := 'This example program shows three advanced topics how'
dev_disp_text ('Press..."
8a5f77ca,micro,8,,"gen_rectangle1 (ROI_0, 200, 170, 290, 410)
area_center (ROI_0, Area, RowROI, ColumnROI)
get_image_size (ObjectSelected, Width, Height)
reduce_domain (ObjectSelected, ROI_0, ImageReduced)
create_shape_model (ImageReduced, 'auto', 0, rad(360), 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)",71,77,"* --- Automatically Added Context ---
area_center (RegionClosing, Area, Row, Column)
select_obj (ImagesBoard, ObjectSelected, 1)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,9,,"get_window_param (WindowHandleLeft, 'flush', Flush)
count_obj (ImagesBoard, Number)",78,80,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
read_image (ImagesBoard, 'board/board-' + [1:20]$'02')
* --- End of Automatically Ad..."
8a5f77ca,micro,10,,"count_seconds (TimeBegin)
for Index := 1 to Number by 1
dev_clear_window ()
select_obj (ImagesBoard, ObjectSelected, Index)
find_shape_model (ObjectSelected, ModelID, 0, rad(360), 0.6, 1, 0.5, 'least_squares', 2, 0.9, Row, Column, Angle, Score)
vector_angle_to_rigid (Row, Column, Angle, RowROI, Colu...",81,98,"* --- Automatically Added Context ---
area_center (RegionClosing, Area, Row, Column)
read_image (ImagesBoard, 'board/board-' + [1:20]$'02')
select_obj (ImagesBoard, ObjectSelected, 1)
area_center (ROI..."
8a5f77ca,micro,11,,"Text := 'Using the window parameter \'flush\''
Text[1] := 'and the operator flush_buffer, you can'
Text[2] := 'define exactly when the graphics window is updated.'
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black...",99,106,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
Text := 'This example program shows three advanced topics how'
dev_disp_text ('Press..."
8a5f77ca,micro,12,,"count_seconds (TimeBegin)
for Index := 1 to Number by 1
dev_clear_window ()
select_obj (ImagesBoard, ObjectSelected, Index)
find_shape_model (ObjectSelected, ModelID, 0, rad(360), 0.6, 1, 0.5, 'least_squares', 2, 0.9, Row, Column, Angle, Score)
vector_angle_to_rigid (Row, Column, Angle, RowROI, Colu...",107,124,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
area_center (RegionClosing, Area, Row, Column)
read_image (ImagesBoard, 'board/board..."
8a5f77ca,micro,13,,"set_window_param (WindowHandleLeft, 'flush', Flush)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",125,129,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
get_window_param (WindowHandleLeft, 'flush', Flush)
dev_disp_text ('Press Run (F5) t..."
8a5f77ca,micro,14,,"read_image (Image, 'circle_plate')
get_image_size (Image, Width, Height)
threshold (Image, Regions, 90, 255)",132,136,"* --- Automatically Added Context ---
get_image_size (ObjectSelected, Width, Height)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,15,,"set_window_param (WindowHandleLeft, 'region_quality', 'low')
set_part_style (WindowHandleLeft, 0)
dev_clear_window ()",139,142,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,16,,"dev_set_window (WindowHandleLeft)
dev_set_part (-Height - 400, -Width + 600, Height * 2 - 400, Width * 2 + 600)",143,145,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
get_image_size (ObjectSelected, Width, Height)
* --- End of Automatically Added Cont..."
8a5f77ca,micro,17,,"dev_set_color ('red')
count_seconds (Seconds)
for Index := 1 to 50 by 1
dev_display (Image)
dev_display (Regions)
endfor
count_seconds (Seconds1)
Time := (Seconds1 - Seconds) / 50",146,154,"* --- Automatically Added Context ---
for Index := 1 to Number by 1
read_image (Image, 'circle_plate')
threshold (Image, Regions, 90, 255)
* --- End of Automatically Added Context ---"
8a5f77ca,micro,18,,"dump_window_image (ImageLeft, WindowHandleLeft)
Text := '3. When zooming images with overlapping regions, you may see'
Text[1] := '   artifacts at the borders where the image and region do'
Text[2] := '   not overlap perfectly visually.'
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
Text :...",155,169,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
Text := 'This example program shows three advanced topics how'
Text[1] := '   an ope..."
8a5f77ca,micro,19,,"dev_open_window (0, Width / 2 + 8, Width / 2, Height / 2, 'black', WindowHandleRight)
set_display_font (WindowHandleRight, 14, 'mono', 'true', 'false')
dev_set_color ('red')
set_window_param (WindowHandleRight, 'region_quality', 'good')
set_part_style (WindowHandleRight, 2)
dev_set_window (WindowHan...",170,184,"* --- Automatically Added Context ---
get_image_size (ObjectSelected, Width, Height)
for Index := 1 to Number by 1
read_image (Image, 'circle_plate')
threshold (Image, Regions, 90, 255)
count_seconds ..."
8a5f77ca,micro,20,,"dump_window_image (ImageRight, WindowHandleRight)
Text := 'With the operators shown below,'
Text[1] := 'you can improve the visualization.'
Text[2] := 'However, this approach is more time-consuming.'
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
Text := ''
Text[1] := 'set_window_param (Win...",185,198,"* --- Automatically Added Context ---
Text := 'This example program shows three advanced topics how'
Text[1] := '   an operator visualizes something in it. This can lead to flickering.'
dev_disp_text ..."
8a5f77ca,micro,21,,"dev_open_window (Row - 50, Column + 30, 250, 200, 'black', WindowHandleLeftZoom)
set_display_font (WindowHandleLeftZoom, 10, 'mono', 'true', 'false')
dev_set_part (334, 218, 374, 268)
dev_display (ImageLeft)
dev_disp_text ('Zoomed view of the visualization', 'window', 8, 8, 'black', [], [])
dev_open...",199,210,"* --- Automatically Added Context ---
area_center (RegionClosing, Area, Row, Column)
get_image_size (ObjectSelected, Width, Height)
dump_window_image (ImageLeft, WindowHandleLeft)
dump_window_image (I..."
8a5f77ca,micro,22,,"dev_close_window ()
dev_close_window ()
dev_close_window ()
dev_close_window ()",213,218,
8a5f77ca,micro,23,,"dev_open_window (0, 0, Width * 0.4, Height * 0.4, 'black', WindowHandleLeft)
set_display_font (WindowHandleLeft, 14, 'mono', 'true', 'false')
set_window_param (WindowHandleLeft, 'anti_aliasing', 'false')
dev_set_part (250, 85, 520, 450)
dev_set_line_width (2)
edges_sub_pix (Image, Edges, 'canny', 1,...",219,226,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
get_image_size (ObjectSelected, Width, Height)
read_image (Image, 'circle_plate')
* ..."
8a5f77ca,micro,24,,"dump_window_image (ImageLeft1, WindowHandleLeft)
Text := 'With the window parameter \'anti_aliasing\','
Text[1] := 'you can smooth the visual representation '
Text[2] := 'of regions and XLDs.'
dev_disp_text (Text, 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('set_window_param (WindowHand...",227,236,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width1, Height1, 1024, 768, WindowHandleLeft)
Text := 'This example program shows three advanced topics how'
Text[1] := '   an ope..."
8a5f77ca,micro,25,,"dev_open_window (0, Width * 0.4 + 8, Width * 0.4, Height * 0.4, 'black', WindowHandleRight)
set_display_font (WindowHandleRight, 14, 'mono', 'true', 'false')
set_window_param (WindowHandleRight, 'anti_aliasing', 'true')
dev_set_window (WindowHandleRight)
dev_set_part (250, 85, 520, 450)
dev_set_line...",237,244,"* --- Automatically Added Context ---
get_image_size (ObjectSelected, Width, Height)
dev_open_window (0, Width / 2 + 8, Width / 2, Height / 2, 'black', WindowHandleRight)
edges_sub_pix (Image, Edges, ..."
8a5f77ca,micro,26,,"dump_window_image (ImageRight1, WindowHandleRight)
dev_disp_text ('set_window_param (WindowHandle, \'anti_aliasing\', \'true\')', 'window', 80, 'left', 'black', ['box_color', 'shadow_color'], ['#d4e7fc', '#a9b8c9'])
stop ()",245,250,"* --- Automatically Added Context ---
dev_disp_text ('set_window_param (WindowHandle, \'flush\', \'true\')', 'window', 12, 12, 'black', ['box_color', 'shadow_color'], ['#d4e7fc', '#a9b8c9'])
dev_open_..."
8a5f77ca,micro,27,,"dev_open_window (Row - 130, Column, 250, 200, 'black', WindowHandleLeftZoom)
set_display_font (WindowHandleLeftZoom, 10, 'mono', 'true', 'false')
dev_set_part (340, 133, 410, 213.75)
dev_display (ImageLeft1)
dev_disp_text ('Zoomed view of the visualization', 'window', 8, 8, 'black', [], [])
dev_open...",251,271,"* --- Automatically Added Context ---
area_center (RegionClosing, Area, Row, Column)
get_image_size (ObjectSelected, Width, Height)
dev_open_window (Row - 50, Column + 30, 250, 200, 'black', WindowHan..."
13623d05,full,0,"This example program demonstrates the usage of the system
setting 'cancel_draw_result' to enable use...","get_system ('cancel_draw_result', PrevCancelDrawResult)
dev_close_window ()
dev_update_off ()
read_image (Image, 'monkey')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_dis...",11,83,
13623d05,micro,1,,"get_system ('cancel_draw_result', PrevCancelDrawResult)",10,12,
13623d05,micro,2,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'monkey')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_display (Image)",13,22,
13623d05,micro,3,"HALCON can return the error code true ('true') or
throw an exception ('exception'). Its error code w...","set_system ('cancel_draw_result', 'exception')",25,30,
13623d05,micro,4,,"ErrorCode := 2
while (ErrorCode != 9023)
disp_message (WindowHandle, 'Draw a rectangle', 'window', 12, 12, 'black', 'true')
disp_abort_message (WindowHandle, 'black', 'true')
dev_set_color ('red')
try
draw_rectangle1 (WindowHandle, Row1, Column1, Row2, Column2)
catch (Exception)
dev_get_exception_da...",31,59,"* --- Automatically Added Context ---
read_image (Image, 'monkey')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
13623d05,micro,5,,"set_system ('cancel_draw_result', PrevCancelDrawResult)",60,75,"* --- Automatically Added Context ---
get_system ('cancel_draw_result', PrevCancelDrawResult)
* --- End of Automatically Added Context ---"
13623d05,micro,6,,"AbortMessage := ['Press right mouse button before clicking', 'the left mouse button to exit']
get_window_extents (WindowHandle, Row, Column, Width, Height)
get_string_extents (WindowHandle, ' ' + AbortMessage[0] + ' ', Ascent, Descent, TextWidth1, TextHeight1)
get_string_extents (WindowHandle, ' ' +...",76,138,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
88f00c45,full,0,"This example demonstrates the usage of the '3d_plot' mode
of the operator set_paint. The results of ...","Names := []
dev_close_window ()
for i := 1 to 10 by 1
Names := [Names,'dff/focus_' + (i$'.2')]
endfor
read_image (Image, Names)
channels_to_image (Image, Image)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_update_var ('off')
for j := ...",10,194,
88f00c45,micro,1,"of the operator set_paint. The results of depth_from_focus
are displayed in 3d and the user can mani...","Names := []
dev_close_window ()
for i := 1 to 10 by 1
Names := [Names,'dff/focus_' + (i$'.2')]
endfor
read_image (Image, Names)
channels_to_image (Image, Image)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_update_var ('off')
for j := ...",6,33,
88f00c45,micro,2,,"stop ()
dev_open_window (Height + 50, Width / 2 + 30, Width, 100, 'white', WindowHandle4)
dev_open_window (0, Width / 2 + 30, Width, Height, 'black', WindowHandle3)
dev_set_window (WindowHandle4)
disp_message (WindowHandle4, 'The mouse can be used to manipulate the 3D plot in the following ways:', '...",34,43,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
88f00c45,micro,3,,"* ShowCoordinates := false
ShowCoordinates := true",44,46,
88f00c45,micro,4,,"* Mode := 'shaded'
* Mode := 'contour_lines'
* Mode := 'hidden_lines'
Mode := 'texture'
interactive_3d_plot (DepthMean, WindowHandle3, Mode, ['plot_quality', 'show_coordinates', 'step', 'display_grid'], ['best',ShowCoordinates,1, 'false'])
dev_set_paint ('default')
* stop ()",47,54,"* --- Automatically Added Context ---
mean_image (ImageScaleMax, DepthMean, 51, 51)
dev_open_window (0, Width / 2 + 30, Width, Height, 'black', WindowHandle3)
* ShowCoordinates := false
* --- End of A..."
88f00c45,micro,5,,"dev_set_window (WindowHandle)
dev_close_window ()
dev_set_window (WindowHandle2)
dev_close_window ()
dev_set_window (WindowHandle4)
dev_close_window ()
dev_set_window (WindowHandle3)
dev_close_window ()",55,81,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_open_window (Height / 2 + 70, 0, Width / 2, Height / 2, 'black', WindowHandle2)
dev_open_..."
88f00c45,micro,6,"plot_quality       the quality of the 3d_plot (see set_window_param)
display_grid       display a gr...","dev_set_window (WindowHandle)
dev_get_preferences ('graphics_window_context_menu', PreviousGraphicContextMenuPreferenceValue)
dev_get_preferences ('graphics_window_mouse_wheel', PreviousGraphicMouseWheelPreferenceValue)
dev_set_preferences ('graphics_window_context_menu', 'false')
dev_set_preference...",94,210,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
* ShowCoordinates := false
* Mode := 'shaded'
* --- End..."
ef0500db,full,0,"This example shows how to use 3d scenes to display 3d object models
This example creates a simple sc...","read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (-0.037, 0.026, 0.02, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_pose (0.009, -0.011, 0.0, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
create_pose (0.042, 0.01, 0.0, 253, 313, 325, 'Rp+T', 'gba', 'point', ...",14,122,
ef0500db,micro,1,,"read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (-0.037, 0.026, 0.02, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_pose (0.009, -0.011, 0.0, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
create_pose (0.042, 0.01, 0.0, 253, 313, 325, 'Rp+T', 'gba', 'point', ...",13,26,
ef0500db,micro,2,,create_scene_3d (Scene3D),27,29,
ef0500db,micro,3,"of a camera is located at the origin. The pose can be
changed with set_scene_3d_camera_pose.","add_scene_3d_camera (Scene3D, CameraParam, CameraIndex)
set_scene_3d_camera_pose (Scene3D, CameraIndex, [0, 0, -0.4, 0, 0, 0, 0])",30,35,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.025, 0, 1.1e-05, 1.1e-05, 384.0, 288.0, 768, 576, CameraParam)
create_scene_3d (Scene3D)
* --- End of Automatically Added Contex..."
ef0500db,micro,4,,"add_scene_3d_light (Scene3D, [1.0, 1.0, 1.0], 'point_light', LightIndex)",36,38,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
* --- End of Automatically Added Context ---"
ef0500db,micro,5,,"set_scene_3d_light_param (Scene3D, LightIndex, 'diffuse', [0.8, 0.8, 0.8])
set_scene_3d_light_param (Scene3D, LightIndex, 'ambient', [0.2, 0.2, 0.2])",39,42,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
add_scene_3d_light (Scene3D, [1.0, 1.0, 1.0], 'point_light', LightIndex)
* --- End of Automatically Added Context ---"
ef0500db,micro,6,"3D object model and a pose. add_scene_3d_instance returns an
InstanceIndex, which must be used to re...","add_scene_3d_instance (Scene3D, ObjectModel3D, Pose1, Instance1Index)",43,48,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (-0.037, 0.026, 0.02, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_scen..."
ef0500db,micro,7,,"set_scene_3d_instance_param (Scene3D, Instance1Index, 'color', '#062d64')",49,51,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
add_scene_3d_instance (Scene3D, ObjectModel3D, Pose1, Instance1Index)
* --- End of Automatically Added Context ---"
ef0500db,micro,8,,"set_scene_3d_instance_param (Scene3D, Instance1Index, 'alpha', 0.7)",52,54,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
add_scene_3d_instance (Scene3D, ObjectModel3D, Pose1, Instance1Index)
* --- End of Automatically Added Context ---"
ef0500db,micro,9,,"add_scene_3d_instance (Scene3D, ObjectModel3D, Pose2, Instance2Index)
set_scene_3d_instance_param (Scene3D, Instance2Index, 'color', '#f28f26')
add_scene_3d_instance (Scene3D, ObjectModel3D, Pose3, Instance3Index)
set_scene_3d_instance_param (Scene3D, Instance3Index, 'color', '#fbba00')",55,60,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
create_pose (0.009, -0.011, 0.0, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
create_pose..."
ef0500db,micro,10,,"add_scene_3d_label (Scene3D, 'Display a scene with three instances of an object model', [], 'top_left', 'window', InfoLabel)",61,62,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
* --- End of Automatically Added Context ---"
ef0500db,micro,11,,"add_scene_3d_label (Scene3D, 'Press Run (F5) to continue', [], 'bottom_right', 'window', ContinueLabel)",63,65,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
* --- End of Automatically Added Context ---"
ef0500db,micro,12,,"set_scene_3d_label_param (Scene3D, [InfoLabel,ContinueLabel], 'color', '#fce9d4')
set_scene_3d_label_param (Scene3D, [InfoLabel,ContinueLabel], 'text_color', 'black')
set_scene_3d_label_param (Scene3D, [InfoLabel,ContinueLabel], 'disp_connecting_line', 'false')",66,69,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
add_scene_3d_label (Scene3D, 'Display a scene with three instances of an object model', [], 'top_left', 'window', InfoLabel)
add_scene_3..."
ef0500db,micro,13,,"display_scene_3d (WindowHandle, Scene3D, CameraIndex)
stop ()",70,73,"* --- Automatically Added Context ---
dev_open_window (0, 0, ImageWidth, ImageHeight, 'white', WindowHandle)
create_scene_3d (Scene3D)
add_scene_3d_camera (Scene3D, CameraParam, CameraIndex)
* --- End..."
ef0500db,micro,14,,"set_scene_3d_label_param (Scene3D, InfoLabel, 'text', 'Render an image of the scene')
render_scene_3d (Image, Scene3D, CameraIndex)
dev_display (Image)
stop ()",74,79,"* --- Automatically Added Context ---
create_scene_3d (Scene3D)
add_scene_3d_camera (Scene3D, CameraParam, CameraIndex)
add_scene_3d_label (Scene3D, 'Display a scene with three instances of an object ..."
ef0500db,micro,15,,"set_scene_3d_label_param (Scene3D, InfoLabel, 'text', 'Add labels to points in the scene')
add_scene_3d_label (Scene3D, 'Instance 1', Pose1[0:2], 'bottom_left', 'point', Instance1LabelID)
add_scene_3d_label (Scene3D, 'Instance 2', Pose2[0:2], 'top', 'point', Instance2LabelID)
add_scene_3d_label (Sce...",80,87,"* --- Automatically Added Context ---
create_pose (-0.037, 0.026, 0.02, 137, 52, 326, 'Rp+T', 'gba', 'point', Pose1)
create_pose (0.009, -0.011, 0.0, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
crea..."
ef0500db,micro,16,,"set_scene_3d_label_param (Scene3D, ContinueLabel, 'visible', 'false')
set_scene_3d_label_param (Scene3D, InfoLabel, 'text', 'Change the pose of one instance')
AngleZ := 0
DeltaZPerSecond := 360 / 3.0
count_seconds (StartTime)
count_seconds (LastFrame)
while (LastFrame - StartTime &lt; 3.0)
count_sec...",88,107,"* --- Automatically Added Context ---
create_pose (0.009, -0.011, 0.0, 354, 317, 252, 'Rp+T', 'gba', 'point', Pose2)
dev_open_window (0, 0, ImageWidth, ImageHeight, 'white', WindowHandle)
create_scene..."
ef0500db,micro,17,,"set_scene_3d_label_param (Scene3D, ContinueLabel, 'visible', 'false')
set_scene_3d_label_param (Scene3D, InfoLabel, 'text', 'Change the pose of the scene')
AngleX := 0
DeltaXPerSecond := 360 / 3.0
count_seconds (StartTime)
count_seconds (LastFrame)
while (LastFrame - StartTime &lt; 3.0)
count_second...",108,128,"* --- Automatically Added Context ---
dev_open_window (0, 0, ImageWidth, ImageHeight, 'white', WindowHandle)
create_scene_3d (Scene3D)
add_scene_3d_camera (Scene3D, CameraParam, CameraIndex)
add_scene..."
1d8cd709,full,0,Read a string with a predetermined maximum size in a text window,"open_window (0, 0, 256, 256, 0, 'visible', '', WindowHandle)
set_color (WindowHandle, 'red')
disp_arrow (WindowHandle, 255 - 20, 255 - 20, 255, 255, 1)
set_color (WindowHandle, 'green')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Type in some characters and quit with return')
s...",8,18,
1d8cd709,micro,1,,"open_window (0, 0, 256, 256, 0, 'visible', '', WindowHandle)
set_color (WindowHandle, 'red')
disp_arrow (WindowHandle, 255 - 20, 255 - 20, 255, 255, 1)
set_color (WindowHandle, 'green')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Type in some characters and quit with return')",6,13,
1d8cd709,micro,2,,"set_tposition (WindowHandle, 255, 255)
read_string (WindowHandle, 'Default', 32, OutString)",14,16,"* --- Automatically Added Context ---
open_window (0, 0, 256, 256, 0, 'visible', '', WindowHandle)
* --- End of Automatically Added Context ---"
1d8cd709,micro,3,,close_window (WindowHandle),17,24,"* --- Automatically Added Context ---
open_window (0, 0, 256, 256, 0, 'visible', '', WindowHandle)
* --- End of Automatically Added Context ---"
a391612f,full,0,Set the position of the text cursor in the output window,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_part (0, 0, 511, 511)
dev_clear_window ()
dev_set_color ('red')
write_string (WindowID, 'Initial pos')
set_tposition (WindowID, 255, 255)
write_string (WindowID, 'Center')
dev_set_color ('green')
disp_arrow (WindowID, 25...",8,24,
a391612f,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_part (0, 0, 511, 511)
dev_clear_window ()
dev_set_color ('red')
write_string (WindowID, 'Initial pos')",6,13,
a391612f,micro,2,,"set_tposition (WindowID, 255, 255)
write_string (WindowID, 'Center')
dev_set_color ('green')
disp_arrow (WindowID, 255 - 30, 255 - 30, 255, 255, 1)",14,18,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
* --- End of Automatically Added Context ---"
a391612f,micro,3,,"set_tposition (WindowID, 2, 255)
dev_set_color ('red')
write_string (WindowID, 'Upper center')
dev_set_color ('green')
disp_arrow (WindowID, 2 + 30, 255 - 30, 2, 255, 1)",19,30,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
* --- End of Automatically Added Context ---"
672b90f4,full,0,Print text in a window,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_clear_window ()
dev_set_color ('red')
set_tposition (WindowID, 100, 1)
write_string (WindowID, 'First Line')
new_line (WindowID)
write_string (WindowID, 'Next Line')
write_string (WindowID, '            ... next chars')
dev_...",8,19,
672b90f4,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_clear_window ()
dev_set_color ('red')",6,11,
672b90f4,micro,2,,"set_tposition (WindowID, 100, 1)
write_string (WindowID, 'First Line')
new_line (WindowID)
write_string (WindowID, 'Next Line')
write_string (WindowID, '            ... next chars')
dev_set_color ('green')
write_string (WindowID, '            ... last chars')",12,25,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
* --- End of Automatically Added Context ---"
6d50346b,full,0,dump_window_data.hdev: save all graphics in an image,"dev_update_window ('off')
read_image (Image, 'clip')
get_image_size (Image, Width, Height)
threshold (Image, Regions, 0, 110)
connection (Regions, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 4000, 99999)
gen_contour_region_xld (SelectedRegions, Contours, 'border...",8,32,
6d50346b,micro,1,,"dev_update_window ('off')
read_image (Image, 'clip')
get_image_size (Image, Width, Height)
threshold (Image, Regions, 0, 110)
connection (Regions, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 4000, 99999)
gen_contour_region_xld (SelectedRegions, Contours, 'border...",6,26,
6d50346b,micro,2,,"dump_window_image (DumpImage, WindowHandle)
stop ()
dev_close_window ()
dev_display (DumpImage)
dev_update_window ('on')",27,38,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
20a1103c,full,0,Read bar codes of type 2/5 Industrial,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)
set_bar_code_param_specific (BarCodeHandle, '2/5 Industrial', 'min_code_length', 1)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle,...",8,47,
20a1103c,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",6,8,
20a1103c,micro,2,,"set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)",9,11,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
20a1103c,micro,3,default setting for this application.,"set_bar_code_param_specific (BarCodeHandle, '2/5 Industrial', 'min_code_length', 1)",12,14,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
20a1103c,micro,4,of more false reads.,"dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 4 by 1
read_image (Image, 'barcode/25industrial/25industrial0' + I)
get_image_size (Image, Width, Heig...",15,53,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param_specific (BarCodeHandle, '2/5 Industrial', 'min_code_length', 1)
* --- End of Automatically Added..."
16f64cf2,full,0,Read bar codes of type 2/5 Interleaved,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
for I :...",8,40,
16f64cf2,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",6,8,
16f64cf2,micro,2,,"set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 8 by 1
read_image (Image, 'barcode/25in...",9,46,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
3b67b0f2,full,0,"Example program for the usage of the bar code
reader autodiscrimination feature of HALCON.
Create ba...","create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'quiet_zone', 'true')
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width...",10,171,
3b67b0f2,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'quiet_zone', 'true')",9,12,
3b67b0f2,micro,2,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('forest green')",13,21,
3b67b0f2,micro,3,for part I,"ExampleImagesAny := ['barcode/ean13/ean1301', 'barcode/code39/code3901', 'barcode/gs1databar_omnidir/gs1databar_omnidir_01']
ExpectedNumCodes := [1, 2, 1]
ExpectedData := ['4008535118906', '92274A', 'R74-2001-010', '(01)00098431358722']",22,26,
3b67b0f2,micro,4,,"ExampleImagesMixed := ['barcode/mixed/barcode_mixed_04', 'barcode/mixed/barcode_mixed_03', 'barcode/mixed/barcode_mixed_01']",27,29,
3b67b0f2,micro,5,"supported by HALCON (except PharmaCode) or determine the bar
code type of unknown bar codes","for IdxExample := 0 to 1 by 1
Message := 'Usage of autodiscrimination to decode'
Message[1] := 'unknown bar code types.'
Message[2] := ' '
if (IdxExample == 0)
CodeTypes := 'auto'
Message[3] := 'Part I:'
Message[4] := 'Compare performance between automatic'
Message[5] := 'bar code discrimination and...",32,111,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ExampleImagesAny := ['barcode/ean13/ean1301', 'barcode/code3..."
3b67b0f2,micro,6,,"Message := 'Part II'
Message[1] := ' '
Message[2] := 'Now we demonstrate the usage of autodiscrimination'
Message[3] := 'to decode multiple mixed bar code types within one image.'
dev_clear_window ()
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (Windo...",116,177,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
ExampleImagesMixed := ['barcode/mixed/barcode_mixed_04', 'ba..."
ecf2601b,full,0,Orientation with reading direction of a bar code,"read_image (Image, 'barcode/ean13/ean1305')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 't...",9,36,
ecf2601b,micro,1,,"read_image (Image, 'barcode/ean13/ean1305')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 't...",7,42,
363b7156,full,0,"Example program for the usage of the bar code parameter
'contrast_min'.
This parameter can be used t...","create_bar_code_model ([], [], BarCodeHandle)
dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_display (Image)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono',...",15,107,
363b7156,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",14,16,
363b7156,micro,2,,"dev_update_off ()
dev_close_window ()",17,20,
363b7156,micro,3,,"read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')",21,23,
363b7156,micro,4,,"dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_display (Image)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
get_window_extents (WindowHandle, Row, Column, Width, Height)
dev_open_window (0, Width + 5, 400, 300, 'white', WindowHandleText)
s...",24,32,"* --- Automatically Added Context ---
read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')
* --- End of Automatically Added Context ---"
363b7156,micro,5,,"Message[0] := 'This example demonstrates the use of the bar code parameter \'contrast_min\'.'
Message[1] := ' '
Message[2] := 'The parameter \'contrast_min\' can be used to reduce the runtime of find_bar_code in the presence of low contrast bar-like structures in an image. Moreover \'contrast_min\' ...",33,44,"* --- Automatically Added Context ---
read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_open_window (0, Width + 5, 40..."
363b7156,micro,6,,NumRepeat := 100,45,47,
363b7156,micro,7,to 0 (default),"ContrastMinValue := 0
set_bar_code_param (BarCodeHandle, 'contrast_min', ContrastMinValue)",48,52,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
363b7156,micro,8,a low absolute contrast,"Times := []
for I := 0 to NumRepeat by 1
count_seconds (Start)
find_bar_code (Image, SymbolRegions, BarCodeHandle, '2/5 Interleaved', DecodedDataStrings)
count_seconds (End)
Time := End - Start
Times := [Times,Time]
endfor
RunTimeContrastMinLow := 1000 * median(Times)",53,63,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')
NumRepeat := 100
* --- End of Automatically Added C..."
363b7156,micro,9,,"get_bar_code_object (BarCodeObjects, BarCodeHandle, 'all', 'candidate_regions')
count_obj (BarCodeObjects, Number)
dev_set_color ('red')
dev_set_line_width (5)
dev_display (BarCodeObjects)
dev_set_window (WindowHandleText)
dev_clear_window ()
Message := ['\'contrast_min\' = ' + ContrastMinValue + ':...",64,74,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, Width + 5, 400, 300, 'white', WindowHandleText)
Message[0] := 'This example demonstrates the use..."
363b7156,micro,10,"greater than 0.0 to consider only candidates having an absolute
contrast of at least that value.","ContrastMinValue := 120
set_bar_code_param (BarCodeHandle, 'contrast_min', ContrastMinValue)",75,80,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
ContrastMinValue := 0
* --- End of Automatically Added Context ---"
363b7156,micro,11,"candidates should be found, and the overall runtime should be reduced.","Times := []
for I := 0 to NumRepeat by 1
count_seconds (Start)
find_bar_code (Image, SymbolRegions, BarCodeHandle, '2/5 Interleaved', DecodedDataStrings)
count_seconds (End)
Time := End - Start
Times := [Times,Time]
endfor
RunTimeContrastMinHigh := 1000 * median(Times)",81,91,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved_zeiss1')
NumRepeat := 100
Times := []
for I := 0 to NumRepea..."
363b7156,micro,12,,"dev_set_window (WindowHandle)
get_bar_code_object (BarCodeObjects, BarCodeHandle, 'all', 'candidate_regions')
count_obj (BarCodeObjects, Number)
dev_set_color ('forest green')
dev_set_line_width (3)
dev_display (BarCodeObjects)
smallest_rectangle1 (SymbolRegions, Row1, Column1, Row2, Column2)
get_ba...",92,113,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_open_window (0, Width + 5, 400, 300, 'white', Wi..."
da6e630f,full,0,"This example demonstrates how to use the bar code parameter
'element_size_variable' if surface defor...","dev_update_off ()
dev_close_window ()
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'element_size_variable', 'false')
create_bar_code_model ([], [], BarCodeHandleVarSize)
set_bar_code_param (BarCodeHandleVarSize, 'element_size_variable', 'true')
CodeTypes := ['GS1 ...",16,119,
da6e630f,micro,1,,"dev_update_off ()
dev_close_window ()",15,18,
da6e630f,micro,2,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'element_size_variable', 'false')
create_bar_code_model ([], [], BarCodeHandleVarSize)
set_bar_code_param (BarCodeHandleVarSize, 'element_size_variable', 'true')
CodeTypes := ['GS1 DataBar Limited', 'GS1 DataBar Expande...",19,25,
da6e630f,micro,3,,"read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_no_deform')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",26,30,
da6e630f,micro,4,,"DecodeRectRow := 315
DecodeRectColumn := 490
DecodeRectPhi := 0
DecodeRectLength1 := 410
DecodeRectLength2 := 200",31,37,
da6e630f,micro,5,,"decode_bar_code_rectangle2 (Image, BarCodeHandle, CodeTypes, DecodeRectRow, DecodeRectColumn, DecodeRectPhi, DecodeRectLength1, DecodeRectLength2, DecodedDataStrings)
get_bar_code_object (SymbolRegions, BarCodeHandle, 'all', 'symbol_regions')",41,44,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['GS1 DataBar Limited', 'GS1 DataBar Expanded', 'GS1 DataBar Expanded Stacked']
read_image (Image, 'bar..."
da6e630f,micro,6,,"decode_bar_code_rectangle2 (Image, BarCodeHandleVarSize, CodeTypes, DecodeRectRow, DecodeRectColumn, DecodeRectPhi, DecodeRectLength1, DecodeRectLength2, DecodedDataStringsVarSize)
get_bar_code_object (SymbolRegionsVarSize, BarCodeHandleVarSize, 'all', 'symbol_regions')",45,48,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandleVarSize)
CodeTypes := ['GS1 DataBar Limited', 'GS1 DataBar Expanded', 'GS1 DataBar Expanded Stacked']
read_image (Imag..."
da6e630f,micro,7,,"Message := 'If the bar code is not deformed, it is found with default settings.'
Message[1] := 'Setting \'element_size_variable\' to \'true\' is not necessary.'
display_results (Image, SymbolRegions, SymbolRegionsVarSize, WindowHandle, DecodedDataStrings, DecodedDataStringsVarSize, Message)
disp_con...",49,55,"* --- Automatically Added Context ---
read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_no_deform')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
decode_bar_code_rectan..."
da6e630f,micro,8,Read distorted bar code,"read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_cylinder')",56,60,"* --- Automatically Added Context ---
read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_no_deform')
* --- End of Automatically Added Context ---"
da6e630f,micro,9,,"decode_bar_code_rectangle2 (Image, BarCodeHandle, CodeTypes, DecodeRectRow, DecodeRectColumn, DecodeRectPhi, DecodeRectLength1, DecodeRectLength2, DecodedDataStrings)
get_bar_code_object (SymbolRegions, BarCodeHandle, 'all', 'symbol_regions')",61,63,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['GS1 DataBar Limited', 'GS1 DataBar Expanded', 'GS1 DataBar Expanded Stacked']
read_image (Image, 'bar..."
da6e630f,micro,10,,"decode_bar_code_rectangle2 (Image, BarCodeHandleVarSize, CodeTypes, DecodeRectRow, DecodeRectColumn, DecodeRectPhi, DecodeRectLength1, DecodeRectLength2, DecodedDataStringsVarSize)
get_bar_code_object (SymbolRegionsVarSize, BarCodeHandleVarSize, 'all', 'symbol_regions')",64,67,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandleVarSize)
CodeTypes := ['GS1 DataBar Limited', 'GS1 DataBar Expanded', 'GS1 DataBar Expanded Stacked']
read_image (Imag..."
da6e630f,micro,11,,"Message := 'If the bar code is bended, the code will only be read with'
Message[1] := '\'element_size_variable\' set to \'true\'.'
display_results (Image, SymbolRegions, SymbolRegionsVarSize, WindowHandle, DecodedDataStrings, DecodedDataStringsVarSize, Message)",68,91,"* --- Automatically Added Context ---
read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_no_deform')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'If the bar..."
da6e630f,micro,12,,"Color := ['black', 'magenta', 'blue']
dev_display (Image)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color (Color[1])
dev_display (SymbolRegions)
dev_set_line_width (3)
set_line_style (WindowHandle, [5, 5])
dev_set_color (Color[2])
dev_display (SymbolRegionsVarSize)
set_line_style (Windo...",92,104,"* --- Automatically Added Context ---
read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_no_deform')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_bar_code_object (S..."
da6e630f,micro,13,,"if (DecodedDataStrings == [])
DecodedDataStrings := 'No bar code found'
Color[1] := 'red'
endif
if (DecodedDataStringsVarSize == [])
DecodedDataStringsVarSize := 'No bar code found'
Color[2] := 'red'
endif
Result := '          Setting                 Decoded string'
Result[1] := 'element_size_variab...",105,133,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'If the bar code is not deformed, it is found with default settings.'
Message[1] := 'Sett..."
36da688a,full,0,"This example program shows the effect of the bar code
parameter 'majority_voting'.
The bar code read...","dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/ean13/ean13_label')
get_image_size (Image, WidthI, HeightI)
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_display (Image)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
get_w...",21,143,
36da688a,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/ean13/ean13_label')
get_image_size (Image, WidthI, HeightI)
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_display (Image)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
get_w...",20,33,
36da688a,micro,2,,"create_bar_code_model ([], [], BarCodeHandle)",34,36,
36da688a,micro,3,,"MajorityVotingSetting := 'false'
set_bar_code_param (BarCodeHandle, 'majority_voting', MajorityVotingSetting)
set_bar_code_param (BarCodeHandle, 'persistence', 1)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.1)
set_bar_code_param (BarCodeHandle, 'meas_thresh_abs', 30)",37,43,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
36da688a,micro,4,,"dev_set_window (WindowHandle)
decode_bar_code_rectangle2 (Image, BarCodeHandle, 'EAN-13', 280, 223, 3.14125 / 2.0, 200, 50, DecodedDataStrings)
get_bar_code_object (SymbolRegion, BarCodeHandle, 'all', 'symbol_regions')
get_bar_code_result (BarCodeHandle, 'all', 'decoded_types', DecodedTypes)
get_bar...",44,53,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/ean13_label')
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
create_bar_code_model ([], [], BarCodeHandle)
* --..."
36da688a,micro,5,,"disp_message (WindowHandle, ['Looking for bar codes','\'majority_voting\' = \'' + MajorityVotingSetting + '\''], 'window', 12, 12, 'black', 'true')
ColorsText := ['forest green', 'red']
dev_set_line_width (2)
smallest_rectangle1 (SymbolRegion, Row1, Column1, Row2, Column2)
dev_set_color ('red')
dev_...",54,65,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
WindowZoomFactor := real(WidthI) / Width
get_image_size (Image, WidthI, HeightI)
get_window_extent..."
36da688a,micro,6,,"Message := 'By default \'majority_voting\' is set to \'false\'.'
Message[1] := ' '
Message[2] := 'If the parameter \'majority_voting\' is set to \'false\', the reading result is set to the decoding result of the first scanline that could be decoded.'
Message[3] := ' '
Message[4] := 'Here, an \'EAN-1...",66,76,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
dev_open_window (0, Width + 5, 400, 300, 'white', WindowHandleText)
decode_bar_code_rectangle2 (Im..."
36da688a,micro,7,,"MajorityVotingSetting := 'true'
set_bar_code_param (BarCodeHandle, 'majority_voting', MajorityVotingSetting)",77,81,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
MajorityVotingSetting := 'false'
* --- End of Automatically Added Context ---"
36da688a,micro,8,,"decode_bar_code_rectangle2 (Image, BarCodeHandle, 'EAN-13', 280, 223, 3.14125 / 2.0, 200, 50, DecodedDataStrings)
get_bar_code_object (SymbolRegion, BarCodeHandle, 'all', 'symbol_regions')
get_bar_code_result (BarCodeHandle, 'all', 'decoded_types', DecodedTypes)
get_bar_code_result (BarCodeHandle, '...",82,89,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/ean13_label')
create_bar_code_model ([], [], BarCodeHandle)
decode_bar_code_rectangle2 (Image, BarCodeHandle, 'EAN-13', 280, 223..."
36da688a,micro,9,,"dev_display (Image)
disp_message (WindowHandle, ['Looking for bar codes','\'majority_voting\' = \'' + MajorityVotingSetting + '\''], 'window', 12, 12, 'black', 'true')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (2)
smallest_rectangle1 (SymbolRegion, Row1, Column1, Row2, Colum...",90,101,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/ean13_label')
dev_open_window_fit_image (Image, 0, 0, 600, 500, WindowHandle)
WindowZoomFactor := real(WidthI) / Width
get_image..."
36da688a,micro,10,,"dev_set_window (WindowHandleText)
Message := 'If majority voting is enabled, the bar code reader uses a majority voting scheme to determine the reading results. It returns the result that has been decoded from the majority of all scanlines.'
Message[1] := ' '
Message[2] := 'Here, the correct \'EAN-1...",102,156,"* --- Automatically Added Context ---
dev_open_window (0, Width + 5, 400, 300, 'white', WindowHandleText)
create_bar_code_model ([], [], BarCodeHandle)
Message[2] := 'If the parameter \'majority_votin..."
bf40f410,full,0,"Example program for the usage of the bar code parameter
'meas_thresh_abs'.
This parameter can be use...","create_bar_code_model ([], [], BarCodeHandle)
dev_update_var ('off')
dev_update_pc ('off')
dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)...",21,72,
bf40f410,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",20,22,
bf40f410,micro,2,,"dev_update_var ('off')
dev_update_pc ('off')
dev_update_window ('off')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",23,32,
bf40f410,micro,3,,"ExampleImages := ['zeiss1', 'patras', 'fabrik']
for Index := 0 to |ExampleImages| - 1 by 1
FileName := ExampleImages[Index]
read_image (Image, FileName)
rgb1_to_gray (Image, Image)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_display (Image)
MeasThreshAbsV...",33,78,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
ea8bbafe,full,0,"This example presents the bar code parameter 'num_scanlines'.
With this parameter you can improve pe...","dev_close_window ()
dev_open_window (0, 0, 800, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
Message[0] := 'This example presents the bar code parameter \'num_scanlines\'.\n \n'
Message[1] :=...",14,178,
ea8bbafe,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 800, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
Message[0] := 'This example presents the bar code parameter \'num_scanlines\'.\n \n'
Message[1] :=...",12,33,
ea8bbafe,micro,2,,"set_bar_code_param (BarCodeHandle, 'contrast_min', 100)",34,37,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
ea8bbafe,micro,3,,"StatusHeight := 180
for I := 1 to 2 by 1
dev_clear_window ()
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_0' + I)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width, Height + StatusHeight)
dev_set_part (0, 0, Height + StatusHeight - 1, Width - 1)
dev...",38,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'white', WindowHandle)
Message[0] := 'This example presents the bar code parameter \'num_scanlines\'.\n \n'
create_bar_code_model..."
ea8bbafe,micro,4,,"StatusHeight := 220
for I := 1 to 2 by 1
dev_clear_window ()
read_image (Image, 'barcode/gs1databar_expanded_stacked/gs1databar_expanded_stacked_0' + I)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width / 2, Height / 2 + StatusHeight)
dev_set_part (0, 0, Height + 2 * Status...",85,161,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'white', WindowHandle)
Message[0] := 'This example presents the bar code parameter \'num_scanlines\'.\n \n'
create_bar_code_model..."
ea8bbafe,micro,5,for time measurements.,"find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)",165,169,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_0' + I)
find_bar_code_timing (Image, SymbolReg..."
ea8bbafe,micro,6,,"Repeat := 10
count_seconds (StartTime)
for Index := 1 to Repeat by 1
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
endfor
count_seconds (EndTime)
Time := 1000.0 * (EndTime - StartTime) / Repeat
return ()",170,191,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_0' + I)
find_bar_code_timing (Image, SymbolReg..."
047a1414,full,0,"This example shows the use of the
bar code parameters: orientation and orientation_tol
Create Barcod...","create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'element_size_min', 1.5)
dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
dev_set_draw (...",10,84,
047a1414,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'element_size_min', 1.5)",9,13,
047a1414,micro,2,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')
set_display_font (WindowHandle, 14, 'mono', 'true...",14,24,
047a1414,micro,3,,"get_bar_code_param (BarCodeHandle, 'orientation', InputOrient)
get_bar_code_param (BarCodeHandle, 'orientation_tol', InputOrientTol)
Mode := 'Default orientation'
find_oriented_bar_code (Image, BarCodeHandle, Mode, InputOrient, InputOrientTol, WindowHandle)
disp_continue_message (WindowHandle, 'blac...",25,32,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHa..."
047a1414,micro,4,Only 1 code will be found,"InputOrient := 10
InputOrientTol := 10
Mode := 'Restricted orientation'
find_oriented_bar_code (Image, BarCodeHandle, Mode, InputOrient, InputOrientTol, WindowHandle)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",33,41,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHa..."
047a1414,micro,5,Only the other code will be found,"InputOrient := 100
InputOrientTol := 10
Mode := 'Restricted orientation'
find_oriented_bar_code (Image, BarCodeHandle, Mode, InputOrient, InputOrientTol, WindowHandle)",42,66,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHa..."
047a1414,micro,6,"'orientation' and 'orientation_tol' to the values specified
in InputOrient and InputOrientTol. After...","set_bar_code_param (BarCodeHandle, ['orientation', 'orientation_tol'], [InputOrient,InputOrientTol])
count_seconds (Seconds1)
find_bar_code (Image, SymbolRegions, BarCodeHandle, '2/5 Interleaved', DecodedDataStrings)
count_seconds (Seconds2)
Time := (Seconds2 - Seconds1) * 1000
dev_display (Image)
d...",67,97,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/25interleaved/25interleaved16')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHa..."
547725d8,full,0,"This program demonstrates how to handle false bar code
decoding.
For this, the following two paramet...","dev_update_off ()
dev_set_draw ('margin')
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'num_scanlines', 10)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.1)
set_bar_code_param (BarCodeHandle, 'persistence', 1)
read_image (Image, 'barcode/code39/code3905')
ge...",15,168,
547725d8,micro,1,"- min_identical_scanlines
- start_stop_tolerance
In this particular example these parameters are use...","dev_update_off ()
dev_set_draw ('margin')
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'num_scanlines', 10)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.1)
set_bar_code_param (BarCodeHandle, 'persistence', 1)
read_image (Image, 'barcode/code39/code3905')
ge...",8,29,
547725d8,micro,2,,"find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', Data)
dev_display (Image)
dev_set_color ('green')
dev_set_line_width (3)
dev_display (SymbolRegions)
Message := ['Looking for:             Code 39','Found:                   ' + Data]
disp_message (WindowHandle, Message, 'window', 12, 12...",30,43,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/code39/code3905')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, He..."
547725d8,micro,3,,"dilation_circle (SymbolRegions, RegionDilation, 8.5)
reduce_domain (Image, RegionDilation, ImageReduced)",44,47,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3905')
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', Data)
* --- End of Automatically Added Context ---"
547725d8,micro,4,leads to the false detection of a Code 128 in a Code 39 symbol.,"find_bar_code (ImageReduced, SymbolRegions, BarCodeHandle, 'Code 128', Data)
get_bar_code_object (AllScanlines, BarCodeHandle, 0, 'scanlines_all')
get_bar_code_object (ValidScanlines, BarCodeHandle, 0, 'scanlines_valid')
fake_false_read (AllScanlines, SymbolRegions, ValidScanlines, SymbolRegions, Va...",48,73,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/code39/code3905')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, He..."
547725d8,micro,5,"effectively the false detection, because the false
detection results from a single false scanline.","MinIdenticalScanlines := NumValidScanlinesFalseRead + 1
set_bar_code_param (BarCodeHandle, 'min_identical_scanlines', MinIdenticalScanlines)
find_bar_code (ImageReduced, SymbolRegions, BarCodeHandle, 'Code 128', Data)
if (|Data| == 0)
Data := '[]'
endif
dev_clear_window ()
dev_display (Image)
dev_se...",74,97,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/code39/code3905')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, He..."
547725d8,micro,6,"the misdetection of the Code 128 start/stop pattern in the
Code 39 symbol.
NOTE: This is currently o...","set_bar_code_param (BarCodeHandle, 'start_stop_tolerance', 'low')
find_bar_code (ImageReduced, SymbolRegions, BarCodeHandle, 'Code 128', Data)
get_bar_code_object (AllScanlines, BarCodeHandle, 0, 'scanlines_all')
get_bar_code_object (ValidScanlines, BarCodeHandle, 0, 'scanlines_valid')
dev_clear_win...",98,143,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/code39/code3905')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, He..."
547725d8,micro,7,"technology, it is very likely that no false reads occur in this image.","count_obj (ValidScanlinesIn, NumValidScanlinesFalseRead)
if (NumValidScanlinesFalseRead == 0)
DataOut := '=)7+)""T?P'
select_obj (AllScanlines, ValidScanlinesOut, 3)
gen_rectangle2 (SymbolRegionsOut, 88.5, 304.5, rad(5.19443), 165.68, 44.7241)
else
DataOut := DataIn
copy_obj (ValidScanlinesIn, ValidS...",149,182,"* --- Automatically Added Context ---
count_obj (ValidScanlines, NumValidScanlinesFalseRead)
get_bar_code_object (AllScanlines, BarCodeHandle, 0, 'scanlines_all')
* --- End of Automatically Added Cont..."
574f6d1e,full,0,"This example presents the bar code parameter
'stop_after_result_num'.
With this parameter the decodi...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)
Message := 'This example presents the bar code parameter\n'
Message[1] := '\'stop_after_result_num...",11,184,
574f6d1e,micro,1,"'stop_after_result_num'.
With this parameter the decoding time can be decreased
if the number of exp...","dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_line_width (2)",6,17,
574f6d1e,micro,2,,"Message := 'This example presents the bar code parameter\n'
Message[1] := '\'stop_after_result_num\'.\n \n'
Message[2] := 'With this parameter the decoding time can be decreased'
Message[3] := 'if the number of expected bar codes is known.\n \n'
Message[4] := 'Please refer to the reference documenta...",18,29,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
574f6d1e,micro,3,codes of type 'GS1 DataBar Stacked' with many false candidates,"StatusHeight := 180
for I := 1 to 2 by 1
dev_clear_window ()
read_image (Image, 'barcode/gs1databar_stacked/gs1databar_stacked_0' + I)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width, Height + StatusHeight)
dev_set_part (0, 0, Height + StatusHeight - 1, Width - 1)
dev_dis...",30,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
Message := 'This example presents the bar code parameter\n'
create_bar_code_model ([], [], BarCodeHandle)
..."
574f6d1e,micro,4,their numbers are given,"CodeTypes := ['Code 39', 'EAN-13']
NumCode39 := [2, 1, 3, 2]
NumEAN13 := [1, 1, 1, 1]",84,89,
574f6d1e,micro,5,,"dev_set_window_extents (-1, -1, 640, 480)
dev_clear_window ()
Message := 'The number of expected bar codes can be set differently'
Message[1] := 'for each type (here: ' + CodeTypes[0] + ' and ' + CodeTypes[1] + ') with the\n'
Message[2] := 'operator set_bar_code_param_specific.\n \n'
Message[3] := '...",90,166,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
Message := 'This example presents the bar code parameter\n'
Message[4] := 'Please refer to the reference d..."
574f6d1e,micro,6,to prepare the reader for the time measurements.,"find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)",171,175,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/gs1databar_stacked/gs1databar_stacked_0' + I)
find_bar_code_timing (Image, SymbolRegions..."
574f6d1e,micro,7,,"Repeat := 10
count_seconds (StartTime)
for Index := 1 to Repeat by 1
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
endfor
count_seconds (EndTime)
Time := 1000.0 * (EndTime - StartTime) / Repeat
return ()",176,197,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, 'barcode/gs1databar_stacked/gs1databar_stacked_0' + I)
find_bar_code_timing (Image, SymbolRegions..."
e53c0a00,full,0,"This example demonstrates how to use the bar code parameters
'barcode_height_min' and 'barcode_width...","dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_draw ('margin')
dev_set_color ('green')
MinWidth := 280
MinHei...",24,116,
e53c0a00,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_draw ('margin')
dev_set_color ('green')
MinWidth := 280
MinHei...",23,35,
e53c0a00,micro,2,,"Message := 'This example demonstrates how to use the bar code'
Message[1] := 'parameters \'barcode_height_min\' and \'barcode_width_min\''
Message[2] := 'to narrow the number of detected candidate regions in'
Message[3] := 'which the bar codes are searched for.'
disp_message (WindowHandle, Message, ...",36,44,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
e53c0a00,micro,3,,"create_bar_code_model ([], [], BarCodeHandle)",45,47,
e53c0a00,micro,4,and find the bar code,"find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', DecodedDataStrings)",48,51,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
e53c0a00,micro,5,,"get_bar_code_object (BarCodeObjects, BarCodeHandle, 'all', 'candidate_regions')",52,54,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
e53c0a00,micro,6,,"dev_set_colored (12)
dev_display (Image)
dev_display (BarCodeObjects)
Message := 'Candidate regions with default settings'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
Message := 'Adjusting the parameters \'barc...",55,70,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This example demonstrates how to use the b..."
e53c0a00,micro,7,"-----------------------------
Set the minimal bar code width and search for bar codes again","set_bar_code_param (BarCodeHandle, 'barcode_width_min', MinWidth)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', DecodedDataStrings)",71,76,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
MinWidth := 280
create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'C..."
e53c0a00,micro,8,,"dev_display (Image)
dev_display (BarCodeObjects)
Message := 'Candidate regions with adjusted parameter:'
Message[1] := '  \'barcode_width_min\' = ' + MinWidth
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",80,88,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
MinWidth := 280
Message := 'This example demonstrates ..."
e53c0a00,micro,9,"-------------------------
Set the minimal bar code height and search for bar codes again","set_bar_code_param (BarCodeHandle, 'barcode_height_min', MinHeight)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', DecodedDataStrings)",89,94,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
MinHeight := 60
create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'C..."
e53c0a00,micro,10,,"dev_display (Image)
dev_display (BarCodeObjects)
Message := 'Candidate region with adjusted parameters:'
Message[1] := '  \'barcode_width_min\'  = ' + MinWidth
Message[2] := '  \'barcode_height_min\' =  ' + MinHeight
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_contin...",98,107,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
MinWidth := 280
MinHeight := 60
Message := 'This examp..."
e53c0a00,micro,11,,"dev_display (Image)
dev_set_color ('red')
dev_display (BarCodeObjects)
dev_set_color ('lime green')
dev_display (SymbolRegions)
disp_message (WindowHandle, 'Search with adjusted parameters', 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Decoded string: ' + DecodedDataStrings, 'wind...",108,122,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code39/code3906')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'C..."
fd2e115a,full,0,"Example program showing what is the impact of the bar code
parameter 'quiet_zone'. The program gives...","dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
get_image_size (Image, Width, Height)
DescrHeight := 200
WindowZoomFactor := 0.5
WindowWidth := WindowZoomFactor * Width
WindowHeight := WindowZoomFactor * Height + DescrHeight
DescrStartRow := WindowZ...",11,419,
fd2e115a,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
get_image_size (Image, Width, Height)
DescrHeight := 200
WindowZoomFactor := 0.5
WindowWidth := WindowZoomFactor * Width
WindowHeight := WindowZoomFactor * Height + DescrHeight
DescrStartRow := WindowZ...",10,33,
fd2e115a,micro,2,,"QuietZone := 'false'
set_bar_code_param (BarCodeHandle, 'quiet_zone', QuietZone)",36,39,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
fd2e115a,micro,3,,"CodeTypes := ['Code 39', '2/5 Interleaved', 'Codabar']",40,41,
fd2e115a,micro,4,,"find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedData)",42,44,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['Code 39', '2/5 Interleaved', 'Codabar']
..."
fd2e115a,micro,5,,"get_quiet_zone_example_symbols (Code39Region, CodabarRegion, SymbolRegions, BarCodeHandle, DecodedTypes, DecodedData)",45,47,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedData)
* --- End of Automatically Added Context..."
fd2e115a,micro,6,,"disp_message (WindowHandle, ['Looking for bar codes','\'quiet_zone\' = \'' + QuietZone + '\''], 'window', 12, 12, 'black', 'true')
Colors := ['green', 'red']
ColorsText := ['forest green', 'red']
dev_set_line_width (2)
for I := 0 to |DecodedData| - 1 by 1
select_obj (SymbolRegions, SymbolRegion, I +...",48,61,"* --- Automatically Added Context ---
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
QuietZone := 'false'
find_bar_code (Image, SymbolRegions, BarCode..."
fd2e115a,micro,7,,"Message := 'By default \'quiet_zone\' is set to \'false\'.'
Message[1] := ' '
Message[2] := 'In this case it is not verified whether the quiet zones'
Message[3] := 'around the bar code candidate are clear. As a result, a '
Message[4] := 'wrong bar code could be detected inside another symbol.'
Messa...",62,75,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
get_image_size (Image, Width, Height)
Win..."
fd2e115a,micro,8,,"gen_quiet_zone_region (CodabarRegion, CodabarRegion, CodabarQZones, DecodedTypes[1], 10)
smallest_rectangle1 (CodabarQZones, QZonesRow1, QZonesCol1, QZonesRow2, QZonesCol2)
dev_set_color ('magenta')
dev_display (CodabarQZones)
disp_message (WindowHandle, ['Left', 'quiet', 'zone'], 'image', 801 - 30 ...",76,83,"* --- Automatically Added Context ---
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
get_quiet_zone_example_symbols (Code39Region, CodabarRegion, Symb..."
fd2e115a,micro,9,,"Message := 'The bar code symbology standards prescribe quiet zones on'
Message[1] := 'both sides of each printed symbol. Here, the quiet zones'
Message[2] := 'of the detected \'Codabar\' sequence are not free. This '
Message[3] := 'indicates that the sequence might be invalid.'
Message[4] := ' '
Mes...",84,96,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,10,,"BarShowAt := 474
gen_contour_polygon_xld (Line1, [580, 740], [BarShowAt,BarShowAt])
gen_contour_polygon_xld (Line2, [580, 740], [BarShowAt + 7,BarShowAt + 7])
gen_contour_polygon_xld (Line3, [580, 740], [QZonesCol1 + 60,QZonesCol1 + 60])
gen_contour_polygon_xld (Line4, [580, 740], [QZonesCol1,QZones...",97,119,"* --- Automatically Added Context ---
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
smallest_rectangle1 (CodabarQZones, QZonesRow1, QZonesCol1, QZone..."
fd2e115a,micro,11,,"Message := 'The size of the quiet zones are specified in the standards'
Message[1] := 'describing the different bar code symbologies.'
Message[2] := ' '
Message[3] := 'For most bar code types, quiet zones of size 10*X are'
Message[4] := 'required and that is the case with \'Codabar\' too. X'
Message...",120,132,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,12,,"QuietZone := 'true'
set_bar_code_param (BarCodeHandle, 'quiet_zone', QuietZone)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.25)",135,138,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
QuietZone := 'false'
* --- End of Automatically Added Context ---"
fd2e115a,micro,13,,"find_bar_code (Image, SymbolRegions, BarCodeHandle, 'auto', DecodedData)
get_bar_code_result (BarCodeHandle, 'all', 'decoded_types', DecodedTypes)",139,141,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, Cod..."
fd2e115a,micro,14,,"dev_display (Image)
disp_message (WindowHandle, ['Looking for bar codes','\'quiet_zone\' = \'' + QuietZone + '\''], 'window', 12, 12, 'black', 'true')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (2)
for I := 0 to |DecodedData| - 1 by 1
select_obj (SymbolRegions, SymbolRegion, ...",142,155,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
Quie..."
fd2e115a,micro,15,,"Message := 'The quiet zone verification was enabled. This forces the'
Message[1] := 'bar code reader to reject the \'Codabar\' sequence, which'
Message[2] := 'it detects in the lower depicted symbol.'
Message[3] := ' '
Message[4] := 'The reader then tries with other bar code types, until'
Message[5]...",156,169,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,16,drawings,"gen_quiet_zone_region (Code39Region, Code39Region, Code39QZones, 'Code 39', 10)
gen_quiet_zone_region (SymbolRegions, Interl25Region, Interl25QZones, '2/5 Interleaved', 10)
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Code39Region)
dev_set_color ('magenta')
dev_display (Code39QZones)
d...",170,188,"* --- Automatically Added Context ---
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, De..."
fd2e115a,micro,17,,"Message := 'The \'2/5 Interleaved\' bar code is successfully decoded'
Message[1] := 'since there are no bars detected in any of its quiet'
Message[2] := 'zones (even though there is one single edge).'
Message[3] := ' '
Message[4] := 'Unfortunately, now the \'Code 39\' cannot be decoded anymore'
Mess...",189,203,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,18,but allow minor disturbances,"QuietZone := 'tolerant'
set_bar_code_param (BarCodeHandle, 'quiet_zone', QuietZone)",206,209,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
QuietZone := 'false'
* --- End of Automatically Added Context ---"
fd2e115a,micro,19,,"dev_display (Image)
disp_message (WindowHandle, ['Looking for bar codes','\'quiet_zone\' = \'' + QuietZone + '\''], 'window', 12, 12, 'black', 'true')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (2)
for I := 0 to |DecodedData| - 1 by 1
select_obj (SymbolRegions, SymbolRegion, ...",213,227,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
Quie..."
fd2e115a,micro,20,drawings,"dev_set_draw ('margin')
dev_set_color ('green')
dev_display (SymbolRegions)
dev_set_line_width (2)
dev_set_color ('forest green')
dev_display (QZones)
gen_arrow_contour_xld (Arrow, 480, 80, 300, 50, 15, 15)
dev_display (Arrow)
disp_message (WindowHandle, 'This bar now is also tolerated.', 'image', 5...",228,239,"* --- Automatically Added Context ---
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, De..."
fd2e115a,micro,21,,"Message := 'The quiet zone verification was set to \'tolerant\'.'
Message[1] := 'This way, both codes are detected, although small'
Message[2] := 'disturbances are present.'
dev_clear_description_field (DescrRegion)
disp_message (WindowHandle, Message, 'window', DescrStartRow, 12, 'black', 'false')
...",240,248,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,22,,"QuietZone := 4
set_bar_code_param (BarCodeHandle, 'quiet_zone', QuietZone)",251,253,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
QuietZone := 'false'
* --- End of Automatically Added Context ---"
fd2e115a,micro,23,,"dev_clear_window ()
dev_display (Image)
disp_message (WindowHandle, ['Looking for bar codes','\'quiet_zone\' = ' + QuietZone], 'window', 12, 12, 'black', 'true')
dev_set_draw ('margin')
dev_set_line_width (2)
for I := 0 to |DecodedData| - 1 by 1
select_obj (SymbolRegions, SymbolRegion, I + 1)
smalle...",257,274,"* --- Automatically Added Context ---
read_image (Image, 'barcode/mixed/barcode_mixed_quiet_zone')
WindowZoomFactor := 0.5
dev_open_window (0, 0, WindowWidth, WindowHeight, 'white', WindowHandle)
Quie..."
fd2e115a,micro,24,,"Message := 'Selecting a user defined quiet zone can adjust the'
Message[1] := 'quiet zone verification behavior between:'
Message[2] := ' '
Message[3] := ' - suppressing false detections'
Message[4] := ' - tolerating disturbances near the symbol'
Message[5] := ' '
Message[6] := 'Typically values bet...",275,322,"* --- Automatically Added Context ---
DescrStartRow := WindowZoomFactor * Height + 12
gen_rectangle1 (DescrRegion, Height, 0, Height + DescrHeight / WindowZoomFactor - 1, Width - 1)
dev_open_window (0..."
fd2e115a,micro,25,,"for I := 0 to |DecodedTypes| - 1 by 1
if (DecodedTypes[I] == 'Code 39')
QZoneWidth[I] := 2.9 * QZone
else
QZoneWidth[I] := 6.0 * QZone
endif
endfor
copy_obj (SymbolRegion, SymbolRegionRect2, 1, -1)
smallest_rectangle2 (SymbolRegionRect2, Row, Column, Phi, Length1, Length2)
gen_rectangle2 (SymbolRegi...",323,394,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedData)
get_quiet_zone_example_symbols (Code39Re..."
fd2e115a,micro,26,"we will simulate a false positive in order to show, that the parameter
'quiet_zone' could be used, i...","smallest_rectangle2 (CodabarRegion, Row, Column, Phi, Length1, Length2)
if (Length1 &gt; 140)
gen_rectangle2 (CodabarRegion, Row, Column, Phi, Length2 * 1.1, Length2)
DecodedTypes[CodabarIndex - 1] := 'Codabar'
DecodedData[CodabarIndex - 1] := 'B6B'
select_obj (SymbolRegions, S1, Code39Index)
if (Co...",395,432,"* --- Automatically Added Context ---
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedData)
get_quiet_zone_example_symbols (Code39Region, CodabarRegion, SymbolRegions, BarCodeHan..."
4532c008,full,0,"This example shows how to find and decode a bar code
with very small elements.
In order to read such...","dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/ean13/tea_box_07.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (6)
display_info (W...",15,206,
4532c008,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'barcode/ean13/tea_box_07.png')",14,19,
4532c008,micro,2,,"dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (6)",20,26,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/tea_box_07.png')
* --- End of Automatically Added Context ---"
4532c008,micro,3,,"display_info (WindowHandle1)
stop ()",27,30,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
4532c008,micro,4,,"get_window_extents (WindowHandle1, Row, Column, WidthOriginal, HeightOriginal)
dev_open_window_fit_image (Image, 0, WidthOriginal + 8, -1, -1, WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (6)",31,38,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/tea_box_07.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
4532c008,micro,5,"One for 'small_elements_robustness' = 'false' and
one for 'small_elements_robustness' = 'true'.","create_bar_code_model (['element_size_min', 'small_elements_robustness'], [1.0, 'false'], BarCodeHandleDefault)
create_bar_code_model ('element_size_min', 1.0, BarCodeHandleSmallElementSize)",39,44,
4532c008,micro,6,"to 'true' and 'false' by stepwise zooming down the image
and comparing the results of the
previous g...","for ZoomFactor := 0.5 to 0.2 by -0.1
dev_set_window (WindowHandle1)
zoom_image_factor (Image, ImageZoomed, ZoomFactor, ZoomFactor, 'constant')
dev_resize_window_fit_image (ImageZoomed, 0, 0, -1, -1)
dev_set_line_width (2)
dev_display (ImageZoomed)
find_bar_code (ImageZoomed, SymbolRegions, BarCodeHa...",45,78,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/tea_box_07.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, ..."
4532c008,micro,7,,"dev_set_window (WindowHandle2)
dev_close_window ()",79,82,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, WidthOriginal + 8, -1, -1, WindowHandle2)
* --- End of Automatically Added Context ---"
4532c008,micro,8,"small elements (smaller than 1.3 pixels in element size)
it is beneficial to slightly rotate
the cam...","dev_set_window (WindowHandle1)
dev_clear_window ()
dev_set_color ('green')
display_rotation_info (WindowHandle1)
stop ()
ZoomFactor := 0.25
get_bar_code_result (BarCodeHandleSmallElementSize, 0, 'orientation', Orientation)
for Rotation := 0.0 to 20 by 5.0
dev_clear_window ()
rotate_image (Image, Ima...",83,133,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/tea_box_07.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle1)
create_bar_code_model ('element_size_min', 1.0, ..."
4532c008,micro,9,,"Message := 'small_elements_robustness:\t'
MessageElementSize := 'Element size:  \t'
MessageDecodedString := 'Decoded string:\t'
MessageZoomFactor := 'ZoomFactor:    \t'
disp_message (WindowHandle, Message + SME, 'window', 4, 4, 'black', 'true')
DecodedString := DecodedDataStrings
if (|DecodedDataStr...",134,214,"* --- Automatically Added Context ---
for ZoomFactor := 0.5 to 0.2 by -0.1
* --- End of Automatically Added Context ---"
b2bb2fb7,full,0,"This example presents the bar code parameters 'status'
and 'status_id' that can be used within get_b...","dev_close_window ()
dev_update_off ()
dev_open_window_fit_size (0, 0, 1024, 768, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
Color := ['red', 'green', 'yellow']
create_bar_code_model ('persistence', 1, BarCodeHandle)
set_bar_code_param (B...",11,113,
b2bb2fb7,micro,1,"and 'status_id' that can be used within get_bar_code_result
to get additional information about poss...","dev_close_window ()
dev_update_off ()
dev_open_window_fit_size (0, 0, 1024, 768, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
Color := ['red', 'green', 'yellow']",6,17,
b2bb2fb7,micro,2,'persistence' must be set for the bar code model.,"create_bar_code_model ('persistence', 1, BarCodeHandle)",18,21,
b2bb2fb7,micro,3,(default is 10).,"set_bar_code_param (BarCodeHandle, 'num_scanlines', 8)
set_bar_code_param (BarCodeHandle, 'check_char', 'present')
CodeType := 'auto'
ImageFiles := ['barcode/25interleaved/25interleaved_exposure_' + [1:5]$'02','barcode/ean13/ean13_defect_' + [1:3:10]$'02']
for I := 0 to |ImageFiles| - 1 by 1
read_im...",22,123,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1024, 768, -1, -1, WindowHandle)
Color := ['red', 'green', 'yellow']
create_bar_code_model ('persistence', 1, BarCodeHandle)
* ---..."
e7b7338b,full,0,"This example program demonstrates how to use the training
mode of the bar code reader.
The program i...","CodeType := '2/5 Interleaved'
PredefGenParNames := 'check_char'
PredefGenParValues := 'present'
dev_update_off ()
dev_close_window ()
dev_open_window (0, 520, 400, 300, 'white', WindowHandleStatus)
dev_open_window (0, 0, 512, 384, 'black', WindowHandleImage)
set_display_font (WindowHandleStatus, 14,...",18,152,
e7b7338b,micro,1,,CodeType := '2/5 Interleaved',17,19,
e7b7338b,micro,2,"Here, we specify that the training images have check characters.","PredefGenParNames := 'check_char'
PredefGenParValues := 'present'",20,24,
e7b7338b,micro,3,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 520, 400, 300, 'white', WindowHandleStatus)
dev_open_window (0, 0, 512, 384, 'black', WindowHandleImage)
set_display_font (WindowHandleStatus, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('green')",25,34,
e7b7338b,micro,4,,"FileNames := 'barcode/25interleaved/25interleaved_exposure_' + [1:2:5]$'.02' + '.png'
NumImages := |FileNames|
read_image (TrainImages, FileNames)",35,40,
e7b7338b,micro,5,,"create_bar_code_model ('train', 'all', BarCodeHandle)
get_bar_code_param (BarCodeHandle, 'train', TrainParNames)",46,49,
e7b7338b,micro,6,,"set_bar_code_param (BarCodeHandle, PredefGenParNames, PredefGenParValues)
for I := 1 to NumImages by 1
select_obj (TrainImages, Image, I)
dev_display (Image)
disp_message (WindowHandleStatus, 'Train bar code ' + I + ' of ' + NumImages + '...', 'window', 12, 12, 'black', 'true')
count_seconds (S1)
fi...",50,90,"* --- Automatically Added Context ---
CodeType := '2/5 Interleaved'
PredefGenParNames := 'check_char'
PredefGenParValues := 'present'
dev_open_window (0, 520, 400, 300, 'white', WindowHandleStatus)
Nu..."
e7b7338b,micro,7,"must be disabled. The trained parameters are preserved
in the bar code model.","set_bar_code_param (BarCodeHandle, 'train', '~all')",91,95,"* --- Automatically Added Context ---
create_bar_code_model ('train', 'all', BarCodeHandle)
* --- End of Automatically Added Context ---"
e7b7338b,micro,8,"the whole range of orientations we increase the orientation
tolerance by a tolerance value of 5 perc...","get_bar_code_param_specific (BarCodeHandle, CodeType, 'orientation_tol', OrientationTol)
set_bar_code_param_specific (BarCodeHandle, CodeType, 'orientation_tol', min([1.05 * OrientationTol,90]))",96,102,"* --- Automatically Added Context ---
CodeType := '2/5 Interleaved'
create_bar_code_model ('train', 'all', BarCodeHandle)
* --- End of Automatically Added Context ---"
e7b7338b,micro,9,"in the ONLINE phase of a industrial bar code reading
application.","write_bar_code_model (BarCodeHandle, 'bar_code_model.bcm')",103,108,"* --- Automatically Added Context ---
create_bar_code_model ('train', 'all', BarCodeHandle)
* --- End of Automatically Added Context ---"
e7b7338b,micro,10,increased robustness of the bar code reader.,"dev_set_window (WindowHandleStatus)
dev_clear_window ()
dev_set_window (WindowHandleImage)",111,117,"* --- Automatically Added Context ---
dev_open_window (0, 520, 400, 300, 'white', WindowHandleStatus)
dev_open_window (0, 0, 512, 384, 'black', WindowHandleImage)
* --- End of Automatically Added Cont..."
e7b7338b,micro,11,,"read_bar_code_model ('bar_code_model.bcm', BarCodeHandle)",118,121,"* --- Automatically Added Context ---
create_bar_code_model ('train', 'all', BarCodeHandle)
* --- End of Automatically Added Context ---"
e7b7338b,micro,12,,"FileNames := 'barcode/25interleaved/25interleaved_exposure_' + [1:5]$'.02' + '.png'
NumImages := |FileNames|
read_image (TrainImages, FileNames)
for I := 1 to NumImages by 1
select_obj (TrainImages, Image, I)
dev_display (Image)
disp_message (WindowHandleStatus, 'Read bar code ' + I + ' of ' + NumIm...",122,158,"* --- Automatically Added Context ---
CodeType := '2/5 Interleaved'
dev_open_window (0, 520, 400, 300, 'white', WindowHandleStatus)
FileNames := 'barcode/25interleaved/25interleaved_exposure_' + [1:2:..."
e7d8aa7e,full,0,Read bar codes of type Codabar,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', ...",8,30,
e7d8aa7e,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",6,8,
e7d8aa7e,micro,2,,"set_bar_code_param (BarCodeHandle, 'stop_after_result_num', 1)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 6 by 1
read_ima...",9,36,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
* --- End of Automatically Added Context ---"
fb31567c,full,0,Read bar codes of type Code 128,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
for I := 1 to 3 by 1
read_image (Image, 'barco...",8,34,
fb31567c,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 600, 600, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
for I := 1 to 3 by 1
read_image (Image, 'barco...",6,40,
90ec4d67,full,0,"This example program demonstrates how to read bar codes of
type Code 32 using the HALCON bar code re...","dev_close_window ()
dev_update_off ()
read_image (Image, 'barcode/code32/code32_01.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
Message := 'Read a ba...",17,52,
90ec4d67,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'barcode/code32/code32_01.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)",16,24,
90ec4d67,micro,2,,"Message := 'Read a bar code of type \'Code 32\' with the bar code reader for'
Message[1] := '\'Code 39\' and convert the decoded string to the corresponding'
Message[2] := '\'Code 32\' decoding.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",25,30,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
90ec4d67,micro,3,'Code 39' reader,"create_bar_code_model ([], [], BarCodeHandle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', DecodedDataStrings)",31,35,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code32/code32_01.png')
Message[1] := '\'Code 39\' and convert the decoded string to the corresponding'
* --- End of Automatically Adde..."
90ec4d67,micro,4,,"disp_message (WindowHandle, 'Decoded string \'Code 39\': ' + DecodedDataStrings, 'window', 95, 12, 'black', 'true')
dev_set_color ('green')
dev_display (SymbolRegions)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",36,42,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[1] := '\'Code 39\' and convert the decoded string to the corresponding'
find_bar_code (Image..."
90ec4d67,micro,5,'Code 32' bar code,"convert_decoded_string_code39_to_code32 (DecodedDataStrings, Code32)",43,46,"* --- Automatically Added Context ---
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 39', DecodedDataStrings)
* --- End of Automatically Added Context ---"
90ec4d67,micro,6,,"dev_display (Image)
dev_display (SymbolRegions)
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Decoded string \'Code 39\': ' + DecodedDataStrings, 'window', 95, 12, 'black', 'true')
disp_message (WindowHandle, 'Converted string \'Code 32\': ' + C...",47,58,"* --- Automatically Added Context ---
read_image (Image, 'barcode/code32/code32_01.png')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'Read a bar code of type \'Code 32\' w..."
a5e3e7d4,full,0,Read bar codes of type Code 39,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
Colors := ['forest green', 'magenta']
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 6 by 1
read_image ...",8,34,
a5e3e7d4,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_line_width (3)
Colors := ['forest green', 'magenta']
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 6 by 1
read_image ...",6,40,
3ac8e192,full,0,"composite_print_quality_isoiec15416.hdev demonstrates how
to check the print quality of composite ba...","OVERALL_QUALITY := 0
OVERALL_QUALITY_LINEAR := 1
OVERALL_QUALITY_COMPOSITE := 2
LINEAR_DECODE := 3
LINEAR_SYMBOL_CONTRAST := 4
LINEAR_MINIMAL_REFLECTANCE := 5
LINEAR_MINIMAL_EDGE_CONTRAST := 6
LINEAR_MODULATION := 7
LINEAR_DEFECTS := 8
LINEAR_DECODABILITY := 9
LINEAR_ADDITIONAL_REQUIREMENTS := 10
CO...",12,414,
3ac8e192,micro,1,,"OVERALL_QUALITY := 0
OVERALL_QUALITY_LINEAR := 1
OVERALL_QUALITY_COMPOSITE := 2
LINEAR_DECODE := 3
LINEAR_SYMBOL_CONTRAST := 4
LINEAR_MINIMAL_REFLECTANCE := 5
LINEAR_MINIMAL_EDGE_CONTRAST := 6
LINEAR_MODULATION := 7
LINEAR_DEFECTS := 8
LINEAR_DECODABILITY := 9
LINEAR_ADDITIONAL_REQUIREMENTS := 10
CO...",11,39,
3ac8e192,micro,2,,"dev_set_draw ('margin')
dev_update_off ()
dev_update_var ('on')
dev_set_color ('green')
dev_set_line_width (2)
dev_close_window ()
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (Window...",40,52,
3ac8e192,micro,3,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'quiet_zone', 5)
set_bar_code_param (BarCodeHandle, 'persistence', 1)
set_bar_code_param (BarCodeHandle, 'element_size_min', 2)
set_bar_code_param (BarCodeHandle, 'element_size_max', 16)
set_bar_code_param (BarCodeHandl...",53,64,"* --- Automatically Added Context ---
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
* --- End of Automatically Added Context ---"
3ac8e192,micro,4,,"Params1 := [0.9250, 0.6250, 0.4750, 0.3250, 0.1750]
Params2 := [8, 40, 56, 72, 88]
for Index := 0 to 4 by 1
scale_image (Image, ImageDefect, Params1[Index], Params2[Index])
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
get_bar_code_result (BarCodeHandle, 0, ...",65,89,"* --- Automatically Added Context ---
COMPOSITE_RAP_CONTRAST := 13
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_..."
3ac8e192,micro,5,,"Params1 := [100, 125]
for Index := 0 to 1 by 1
scale_image (Image, ImageDefect, 1 - Params1[Index] / 255.0, Params1[Index])
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)
get_bar_code_result (BarCodeHandle, 0, 'quality_isoiec15416_float_grades', Quality)
get_...",90,114,"* --- Automatically Added Context ---
COMPOSITE_RAP_MINIMAL_REFLECTANCE := 14
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composit..."
3ac8e192,micro,6,,"gen_region_polygon_filled (Defect, [140, 140, 158, 158, 178, 178, 187, 187, 206, 206, 216, 216], [180, 203, 203, 208, 208, 203, 203, 198, 198, 203, 203, 180])
Params1 := [0.7, 0.625, 0.55, 0.4, 0.325]
Params2 := [40, 50, 60, 80, 90]
for Index := 0 to 4 by 1
scale_image (Image, ImageScaled, Params1[I...",115,139,"* --- Automatically Added Context ---
COMPOSITE_RAP_MODULATION := 16
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
de..."
3ac8e192,micro,7,,"scale_image (Image, ImageLowContrast, 0.25, 190)
gen_rectangle1 (Defect, 139, 419, 214, 423)
Params1 := [250, 245, 240, 235, 230]
for Index := 0 to 4 by 1
paint_region (Defect, ImageLowContrast, ImageDefect, Params1[Index], 'fill')
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, CodeType, ...",140,163,"* --- Automatically Added Context ---
COMPOSITE_RAP_MINIMAL_EDGE_CONTRAST := 15
COMPOSITE_RAP_MODULATION := 16
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_comp..."
3ac8e192,micro,8,,"gen_rectangle1 (Defects, 139, 50, 217, 50)
gen_rectangle1 (Defect, 139, 191, 217, 191)
union2 (Defects, Defect, Defects)
reduce_domain (Image, Defects, Slice)
invert_image (Slice, SliceInvert)
Params1 := [0.1, 0.3, 0.45, 0.65, 0.95]
for Index := 0 to 4 by 1
scale_image (SliceInvert, SliceInvertScale...",164,192,"* --- Automatically Added Context ---
COMPOSITE_RAP_DEFECTS := 17
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_o..."
3ac8e192,micro,9,,"gen_rectangle1 (Defects, 139, 53, 217, 77)
gen_rectangle1 (Defect, 139, 390, 217, 415)
union2 (Defects, Defect, Defects)
reduce_domain (Image, Defects, ImageReduced)
Params1 := 1 + [0, 2, 2.7, 2.9, 4]
for Index := 0 to 4 by 1
gray_dilation_shape (ImageReduced, ImageMax, 1, Params1[Index], 'rectangle...",193,218,"* --- Automatically Added Context ---
COMPOSITE_RAP_DECODABILITY := 18
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
..."
3ac8e192,micro,10,,"gen_rectangle1 (Defect, 135, 46, 217, 437)
reduce_domain (Image, Defect, ImageReduced)
Params1 := 5 + [0, 0.9, 2, 2.9, 3.5]
for Index := 0 to 4 by 1
gray_dilation_shape (ImageReduced, ImageMax, Params1[Index], 1, 'rectangle')
paint_gray (ImageMax, Image, ImageDefect)
find_bar_code (ImageDefect, Symb...",219,242,"* --- Automatically Added Context ---
COMPOSITE_CODEWORD_YIELD := 19
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
de..."
3ac8e192,micro,11,,"Rectangles := []
Rectangles := [Rectangles,168, 150, 178, 167]
Rectangles := [Rectangles,179, 247, 205, 260]
Rectangles := [Rectangles,168, 247, 178, 260]
Rectangles := [Rectangles,158, 247, 167, 260]
for Index := 0 to 3 by 1
gen_empty_obj (Defects)
for J := 0 to Index * 4 by 4
gen_rectangle1 (Defec...",243,273,"* --- Automatically Added Context ---
COMPOSITE_UNUSED_ERROR_CORRECTION := 20
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composit..."
3ac8e192,micro,12,,"gen_rectangle1 (Defect, 140, 223, 214, 384)
Params1 := [0.775, 0.7, 0.55, 0.475, 0.4]
Params2 := [30, 40, 60, 70, 80]
for Index := 0 to 4 by 1
scale_image (Image, ImageScaled, Params1[Index], Params2[Index])
reduce_domain (ImageScaled, Defect, ImageReduced)
paint_gray (ImageReduced, Image, ImageDefe...",274,298,"* --- Automatically Added Context ---
COMPOSITE_MODULATION := 21
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_op..."
3ac8e192,micro,13,,"gen_rectangle1 (Defects, 139, 102, 217, 126)
gen_rectangle1 (Defect, 139, 239, 217, 259)
union2 (Defects, Defect, Defects)
reduce_domain (Image, Defects, ImageReduced)
Dilation := 1 + [0, 2, 2.45, 2.9, 3]
for Index := 0 to 4 by 1
gray_dilation_shape (ImageReduced, ImageMax, 1, Dilation[Index], 'rect...",299,324,"* --- Automatically Added Context ---
COMPOSITE_DECODABILITY := 22
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_..."
3ac8e192,micro,14,,"gen_rectangle1 (Defect, 138, 345, 216, 345)
reduce_domain (Image, Defect, Slice)
invert_image (Slice, SliceInvert)
Params1 := [0.3, 0.45, 0.65, 0.7, 0.85]
for Index := 0 to 4 by 1
scale_image (SliceInvert, SliceInvertScaled, Params1[Index], 0)
scale_image (Slice, SliceScaled, 1.0 - Params1[Index], 0...",325,426,"* --- Automatically Added Context ---
COMPOSITE_DEFECTS := 23
Wait := 0.8
CodeType := 'GS1 DataBar Limited'
read_image (Image, 'barcode/gs1databar_composite/gs1databar_limited_composite_02')
dev_open_..."
3f05d83b,full,0,"This example demonstrates how to use the operator
decode_bar_code_rectangle2.
The bar code region is...","Directory := 'barcode/ean13/'
TeaBoxRegExp := '.*tea_box.*'
dev_update_window ('off')
dev_set_draw ('margin')
list_image_files (Directory, 'default', [], ImageFiles)
ImageFilesTea := regexp_select(ImageFiles,[TeaBoxRegExp,'ignore_case'])
read_image (Image, ImageFilesTea[0])
dev_close_window ()
dev_o...",13,58,
3f05d83b,micro,1,,"Directory := 'barcode/ean13/'
TeaBoxRegExp := '.*tea_box.*'",12,15,
3f05d83b,micro,2,,"dev_update_window ('off')
dev_set_draw ('margin')",16,19,
3f05d83b,micro,3,,"list_image_files (Directory, 'default', [], ImageFiles)
ImageFilesTea := regexp_select(ImageFiles,[TeaBoxRegExp,'ignore_case'])
read_image (Image, ImageFilesTea[0])",20,24,"* --- Automatically Added Context ---
Directory := 'barcode/ean13/'
TeaBoxRegExp := '.*tea_box.*'
* --- End of Automatically Added Context ---"
3f05d83b,micro,4,,"dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
create_bar_code_model ([], [], BarCodeHandle)",25,31,"* --- Automatically Added Context ---
read_image (Image, ImageFilesTea[0])
* --- End of Automatically Added Context ---"
3f05d83b,micro,5,,"for ImageIndex := 0 to |ImageFilesTea| - 1 by 1
read_image (Image, ImageFilesTea[ImageIndex])
dev_display (Image)
threshold (Image, RegionThresh, 56, 255)
connection (RegionThresh, RegThreshConn)
select_shape_std (RegThreshConn, RegionBC, 'max_area', 100)
smallest_rectangle2 (RegionBC, Row, Column, ...",32,64,"* --- Automatically Added Context ---
TeaBoxRegExp := '.*tea_box.*'
ImageFilesTea := regexp_select(ImageFiles,[TeaBoxRegExp,'ignore_case'])
read_image (Image, ImageFilesTea[0])
list_image_files (Direc..."
79c39c5b,full,0,"This example program shows the bar code reader's ability to read defect bar
codes. This is done by a...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'barcode/code39/code3904')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (Ima...",11,41,
79c39c5b,micro,1,"codes. This is done by artificially removing a space in the bar code to different
extents. The space...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'barcode/code39/code3904')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_display (Ima...",6,47,
cea9298a,full,0,"Read defect bar codes of type EAN-13.
Even though these bar codes seem challenging,
they can be read...","create_bar_code_model ([], [], BarCodeHandle)
CodeType := 'EAN-13'
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 10 by 1
rea...",10,32,
cea9298a,micro,1,"Even though these bar codes seem challenging,
they can be read without adjusting any parameters.","create_bar_code_model ([], [], BarCodeHandle)
CodeType := 'EAN-13'
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 10 by 1
rea...",6,38,
c5e11d2d,full,0,Read bar codes of type EAN-13.,"create_bar_code_model ([], [], BarCodeHandle)
CodeType := 'EAN-13'
dev_close_window ()
dev_open_window (0, 0, 544, 496, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 15 by 1
rea...",8,40,
c5e11d2d,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
CodeType := 'EAN-13'
dev_close_window ()
dev_open_window (0, 0, 544, 496, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
for I := 1 to 15 by 1
rea...",6,46,
8f757891,full,0,Read bar code of type EAN-13 Add-On 5,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_bar_code_param (BarCodeHandle, 'element_si...",8,23,
8f757891,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 120, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3)
set_bar_code_param (BarCodeHandle, 'element_si...",6,29,
a4612d6b,full,0,Read bar codes of type EAN-8,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
read_image (Image, 'barcode/ean8/ean801')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3...",8,18,
a4612d6b,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
read_image (Image, 'barcode/ean8/ean801')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
dev_set_line_width (3...",6,24,
c316071c,full,0,"This program demonstrates the decoding of GS1 DataBar bar
codes with Composite component","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ScaleWindow := 1.0
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCode...",10,50,
c316071c,micro,1,codes with Composite component,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ScaleWindow := 1.0
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCode...",7,56,
9613025f,full,0,"GS1 Expanded bar code symbology
Create a bar code reader","create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
NumImages := 2
dev_close_window ()
read_image (Image, 'barcode/gs1databar_expanded/gs1databar_expanded_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width ...",10,33,
9613025f,micro,1,,"create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)",9,11,
9613025f,micro,2,,"NumImages := 2
dev_close_window ()
read_image (Image, 'barcode/gs1databar_expanded/gs1databar_expanded_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false'...",12,21,
9613025f,micro,3,,"for I := 1 to NumImages by 1
read_image (Image, 'barcode/gs1databar_expanded/gs1databar_expanded_' + I$'.2d')
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar Expanded', DecodedDataStrings)
dev_display (SymbolRegions)
disp_message (WindowHandle, DecodedDataStrings...",22,39,"* --- Automatically Added Context ---
create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
NumImages := 2
read_image (Image, 'barcode/gs1databar_expanded/gs1databar_expanded_01')
dev_open_wi..."
691b9237,full,0,"GS1 DataBar Expanded Stacked bar code symbology
Create a bar code reader","create_bar_code_model (['element_size_max', 'element_size_min'], [16, 1.5], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
f...",10,33,
691b9237,micro,1,,"create_bar_code_model (['element_size_max', 'element_size_min'], [16, 1.5], BarCodeHandle)",9,11,
691b9237,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",12,19,
691b9237,micro,3,,"for Ind := 1 to 2 by 1
ImageName := 'barcode/gs1databar_expanded_stacked/gs1databar_expanded_stacked_' + (Ind$'.2')
read_image (Image, ImageName)
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar Expanded Stacked', ...",20,39,"* --- Automatically Added Context ---
create_bar_code_model (['element_size_max', 'element_size_min'], [16, 1.5], BarCodeHandle)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Au..."
b5f84a23,full,0,"GS1 DataBar bar code symbology
Create bar code reader","create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
NumImages := 2
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
for I := 1 to ...",10,32,
b5f84a23,micro,1,,"create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)",9,11,
b5f84a23,micro,2,,"NumImages := 2
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)",12,20,
b5f84a23,micro,3,,"for I := 1 to NumImages by 1
read_image (Image, 'barcode/gs1databar_limited/gs1databar_limited_' + I$'.2d')
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar Limited', DecodedDataStrings)
dev_display (SymbolRegions)
disp_message (WindowHandle, DecodedDataStrings, '...",21,38,"* --- Automatically Added Context ---
create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
NumImages := 2
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
* --- End of Automatically A..."
694ec89a,full,0,"GS1 DataBar Omnidirectional bar code symbology
Create bar code reader","create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 2 by 1
read_ima...",10,32,
694ec89a,micro,1,,"create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)",9,11,
694ec89a,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",12,19,
694ec89a,micro,3,,"for I := 1 to 2 by 1
read_image (Image, 'barcode/gs1databar_omnidir/gs1databar_omnidir_' + I$'.2d')
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar Omnidir', DecodedDataStrings)
get_region_runs (SymbolRegions, Row, ColumnBegin, ColumnEnd)
dev_display (SymbolRegio...",20,38,"* --- Automatically Added Context ---
create_bar_code_model ('element_size_min', 1.5, BarCodeHandle)
dev_open_window (0, 0, 360, 256, 'black', WindowHandle)
* --- End of Automatically Added Context --..."
782bc70f,full,0,"GS1 DataBar Stacked bar code symbology
Create bar code reader","create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for Ind := 1 to 2 by 1
ImageName := 'barcode/g...",10,34,
782bc70f,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",9,11,
782bc70f,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",12,19,
782bc70f,micro,3,,"for Ind := 1 to 2 by 1
ImageName := 'barcode/gs1databar_stacked/gs1databar_stacked_' + (Ind$'.2')
read_image (Image, ImageName)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar St...",20,40,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
93d573f6,full,0,"GS1 DataBar Stacked Omnidirectional bar code symbology
Create Barcode reader","create_bar_code_model ([], [], BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 2 by 1
ImageName := 'barcode/gs1...",10,34,
93d573f6,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",9,11,
93d573f6,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",12,19,
93d573f6,micro,3,,"for I := 1 to 2 by 1
ImageName := 'barcode/gs1databar_stacked_omnidir/gs1databar_stacked_omnidir_' + (I$'.2')
read_image (Image, ImageName)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Width / 2, Height / 2)
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHan...",20,40,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
dev_open_window (0, 0, 640, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
efb8b8e9,full,0,"GS1 DataBar Truncated bar code
Note: GS1 DataBar Truncated is the same symbology as GS1 DataBar
Omni...","create_bar_code_model ([], [], BarCodeHandle)
NumImages := 2
dev_close_window ()
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_update_off ()
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_wid...",12,34,
efb8b8e9,micro,1,,"create_bar_code_model ([], [], BarCodeHandle)",11,13,
efb8b8e9,micro,2,,"NumImages := 2
dev_close_window ()
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_update_off ()
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mo...",14,24,
efb8b8e9,micro,3,,"for I := 1 to NumImages by 1
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_' + I$'.2d')
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1 DataBar Truncated', DecodedDataStrings)
dev_display (SymbolRegions)
disp_message (WindowHandle, DecodedDataStri...",25,40,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
NumImages := 2
read_image (Image, 'barcode/gs1databar_truncated/gs1databar_truncated_01')
dev_open_window_fit_image ..."
d1ab5827,full,0,"GS1-128 bar code symbology
The symbol structure of GS1-128 bar codes is identical
to a Code 128 symb...","Scale := 1.0
ScaleInv := 1. / Scale
NumImages := 3
StatusHeight := 300
Colors := ['black', 'magenta', 'black', 'black', 'forest green',gen_tuple_const(10,'black')]
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono'...",26,76,
d1ab5827,micro,1,,"Scale := 1.0
ScaleInv := 1. / Scale
NumImages := 3
StatusHeight := 300
Colors := ['black', 'magenta', 'black', 'black', 'forest green',gen_tuple_const(10,'black')]",25,31,
d1ab5827,micro,2,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)",32,40,
d1ab5827,micro,3,,"create_bar_code_model ([], [], BarCodeHandle)",41,43,
d1ab5827,micro,4,,"for I := 1 to NumImages by 1
read_image (Image, 'barcode/gs1_128/gs1_128_generated_' + I$'.2d')
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'GS1-128', GS1128DecodedString)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'Code 128', Code128DecodedString)
Message := 'Code 128 Data:'
Messag...",44,82,"* --- Automatically Added Context ---
Scale := 1.0
ScaleInv := 1. / Scale
NumImages := 3
StatusHeight := 300
Colors := ['black', 'magenta', 'black', 'black', 'forest green',gen_tuple_const(10,'black')..."
6e80d12c,full,0,"This program demonstrates visualization of bar code scanlines.
This visualization can be used to ins...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
Files := ['ean1314', 'ean1313', 'ean13_defect_05']
Color := ['magenta', 'red', 'green', 'yellow']
create_bar_code_model (...",17,69,
6e80d12c,micro,1,"eventually use to decode a  candidate bar code (here, colored in red).
With 'scanlines_valid' are vi...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
Files := ['ean1314', 'ean1313', 'ean13_defect_05']
Color := ['magenta', 'red', 'green', 'yellow']
create_bar_code_model (...",12,75,
2e3d015e,full,0,"Example program for decoding bar codes of type MSI
Create Barcode reader with check character valida...","create_bar_code_model ('check_char', 'present', BarCodeHandle)
dev_close_window ()
dev_open_window (0, 0, 320, 240, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
for I := 1 to 3 by 1
read_ima...",9,33,
2e3d015e,micro,1,,"create_bar_code_model ('check_char', 'present', BarCodeHandle)",8,11,
2e3d015e,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 320, 240, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",12,19,
2e3d015e,micro,3,,"for I := 1 to 3 by 1
read_image (Image, 'barcode/msi/msi_' + I$'.2d')
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
dev_display (Image)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'MSI', DecodedDataStrings)
area_center (SymbolRegions, Area, Row, Column)
dev_display (SymbolRegions)
disp_m...",20,39,"* --- Automatically Added Context ---
create_bar_code_model ('check_char', 'present', BarCodeHandle)
dev_open_window (0, 0, 320, 240, 'black', WindowHandle)
* --- End of Automatically Added Context --..."
2e82e956,full,0,"print_quality_isoiec15416.hdev demonstrates how to check
the print quality of bar codes. Additionall...","GRADE_DECODE := 1
GRADE_CONTRAST := 2
GRADE_MINIMAL_REFLECTANCE := 3
GRADE_MINIMAL_EDGE_CONTRAST := 4
GRADE_MODULATION := 5
GRADE_DEFECTS := 6
GRADE_DECODABILITY := 7
GRADE_ADDITIONAL_REQS := 8
Wait := 0.8
dev_set_draw ('margin')
dev_update_off ()
dev_update_var ('on')
dev_set_color ('green')
dev_se...",12,329,
2e82e956,micro,1,,"GRADE_DECODE := 1
GRADE_CONTRAST := 2
GRADE_MINIMAL_REFLECTANCE := 3
GRADE_MINIMAL_EDGE_CONTRAST := 4
GRADE_MODULATION := 5
GRADE_DEFECTS := 6
GRADE_DECODABILITY := 7
GRADE_ADDITIONAL_REQS := 8
Wait := 0.8",11,22,
2e82e956,micro,2,,"dev_set_draw ('margin')
dev_update_off ()
dev_update_var ('on')
dev_set_color ('green')
dev_set_line_width (2)
dev_close_window ()
read_image (Image, 'barcode/ean13/ean1315')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height...",23,36,
2e82e956,micro,3,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'persistence', 1)
set_bar_code_param (BarCodeHandle, 'element_size_min', 2)
set_bar_code_param (BarCodeHandle, 'element_size_max', 16)
find_bar_code (Image, SymbolRegions, BarCodeHandle, 'EAN-13', DecodedDataStrings)
ge...",37,46,"* --- Automatically Added Context ---
read_image (Image, 'barcode/ean13/ean1315')
* --- End of Automatically Added Context ---"
2e82e956,micro,4,,"Params1 := [0.925, 0.775, 0.475, 0.325, 0.175]
Params2 := [10, 30, 70, 90, 110]
for Index := 0 to 4 by 1
scale_image (Image, ImageDefect, Params1[Index], Params2[Index])
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, 'EAN-13', DecodedDataStrings)
get_bar_code_result (BarCodeHandle, 0, 'qu...",47,73,"* --- Automatically Added Context ---
GRADE_CONTRAST := 2
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_code_model ([]..."
2e82e956,micro,5,,"Params1 := [100, 125]
for Index := 0 to 1 by 1
scale_image (Image, ImageDefect, 1 - Params1[Index] / 255.0, Params1[Index])
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, 'EAN-13', DecodedDataStrings)
get_bar_code_result (BarCodeHandle, 0, 'quality_isoiec15416_float_grades', Quality)
get_...",74,98,"* --- Automatically Added Context ---
GRADE_MINIMAL_REFLECTANCE := 3
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_cod..."
2e82e956,micro,6,,"gen_rectangle1 (Defect, 91, 353, 464, 406)
reduce_domain (Image, Defect, ImageReduced)
Params1 := [0.775, 0.7, 0.55, 0.475, 0.4]
Params2 := [30, 40, 60, 70, 80]
for Index := 0 to 4 by 1
scale_image (ImageReduced, ImageScaled, Params1[Index], Params2[Index])
paint_gray (ImageScaled, Image, ImageDefec...",99,123,"* --- Automatically Added Context ---
GRADE_MODULATION := 5
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_code_model (..."
2e82e956,micro,7,,"scale_image (Image, ImageLowContrast, 0.25, 190)
gen_rectangle1 (Defect, 91, 385, 464, 395)
Params1 := [250, 245, 240, 235, 230]
for Index := 0 to 4 by 1
paint_region (Defect, ImageLowContrast, ImageDefect, Params1[Index], 'fill')
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, 'EAN-13', D...",124,147,"* --- Automatically Added Context ---
GRADE_MINIMAL_EDGE_CONTRAST := 4
GRADE_MODULATION := 5
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', Wind..."
2e82e956,micro,8,"otherwise the artificial defect we add in the image will be detected as a
bar, and the bar code dete...","get_bar_code_param (BarCodeHandle, 'meas_thresh', MeasThresh)
set_bar_code_param (BarCodeHandle, 'meas_thresh', 0.5)
gen_rectangle1 (Defect, 91, 454, 464, 454)
dilation_rectangle1 (Defect, DefectSurround, 11, 11)
Params1 := [165, 135, 105, 75, 45]
for Index := 0 to 4 by 1
paint_region (Defect, Image...",150,179,"* --- Automatically Added Context ---
GRADE_DEFECTS := 6
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_code_model ([],..."
2e82e956,micro,9,,"gen_rectangle1 (Defect, 91, 443, 464, 443)
Params1 := [2.5, 2.85, 3.0, 3.5, 4.0]
for Index := 0 to 4 by 1
paint_dec_defect (Defect, Image, ImageDefect, WholeDefect, Params1[Index], 255 - 52, 1)
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, 'EAN-13', DecodedDataStrings)
get_bar_code_resul...",180,201,"* --- Automatically Added Context ---
GRADE_DECODABILITY := 7
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_code_model..."
2e82e956,micro,10,,"Params1 := [160, 230, 300, 370, 440]
for Index := 0 to 4 by 1
gen_rectangle1 (Defect, 91, 698, Params1[Index], 702)
paint_region (Defect, Image, ImageDefect, 52, 'fill')
find_bar_code (ImageDefect, SymbolRegions, BarCodeHandle, 'EAN-13', DecodedDataStrings)
get_bar_code_result (BarCodeHandle, 0, 'qu...",202,341,"* --- Automatically Added Context ---
GRADE_ADDITIONAL_REQS := 8
Wait := 0.8
read_image (Image, 'barcode/ean13/ean1315')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
create_bar_code_mo..."
b303b34a,full,0,"Example program for the usage of the operators
set_bar_code_param_specific and get_bar_code_param_sp...","dev_update_off ()
dev_close_window ()
create_bar_code_model ([], [], BarCodeHandle)
ExampleImage := 'barcode/mixed/barcode_mixed_02'
read_image (Image, ExampleImage)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_dra...",16,78,
b303b34a,micro,1,,"dev_update_off ()
dev_close_window ()",15,18,
b303b34a,micro,2,,"create_bar_code_model ([], [], BarCodeHandle)",19,21,
b303b34a,micro,3,,ExampleImage := 'barcode/mixed/barcode_mixed_02',22,24,
b303b34a,micro,4,,"read_image (Image, ExampleImage)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_color ('forest green')
dev_display (Image)",25,33,"* --- Automatically Added Context ---
ExampleImage := 'barcode/mixed/barcode_mixed_02'
* --- End of Automatically Added Context ---"
b303b34a,micro,5,,"CodeTypes := ['EAN-13', 'Code 39']
AllowedOrientations := [90.0, 0.0]
AllowedOrientationsWrong := [45.0, 0.0]",34,38,
b303b34a,micro,6,"orientations we set the allowed orientations for both bar
code types differently","set_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientation', AllowedOrientations)",39,43,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['EAN-13', 'Code 39']
AllowedOrientations := [90.0, 0.0]
* --- End of Automatically Added Context ---"
b303b34a,micro,7,"tolerance for the orientation to the same value for both
types","set_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientation_tol', 10.0)",44,48,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['EAN-13', 'Code 39']
* --- End of Automatically Added Context ---"
b303b34a,micro,8,,"find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedDataStrings)
dev_display (SymbolRegions)",49,52,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, ExampleImage)
CodeTypes := ['EAN-13', 'Code 39']
* --- End of Automatically Added Context ---"
b303b34a,micro,9,(the result should correspond to the orientations set before),"get_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientation', AllowedOrientationsGot)
get_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientation_tol', AllowedTolerancesGot)",53,57,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['EAN-13', 'Code 39']
* --- End of Automatically Added Context ---"
b303b34a,micro,10,,"disp_message (WindowHandle, 'Allowed orientations (correct orientation for both bar codes)', 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, CodeTypes[0] + ' ' + AllowedOrientationsGot[0] + '(+-' + AllowedTolerancesGot[0] + ') degrees', 'image', 70, 500, 'black', 'true')
disp_message ...",58,65,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
CodeTypes := ['EAN-13', 'Code 39']
get_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientati..."
b303b34a,micro,11,,"set_bar_code_param_specific (BarCodeHandle, CodeTypes, 'orientation', AllowedOrientationsWrong)",66,68,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
CodeTypes := ['EAN-13', 'Code 39']
AllowedOrientationsWrong := [45.0, 0.0]
* --- End of Automatically Added Context ..."
b303b34a,micro,12,does not have an orientation of 45 degrees and will not be decoded,"find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeTypes, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolRegions)",69,74,"* --- Automatically Added Context ---
create_bar_code_model ([], [], BarCodeHandle)
read_image (Image, ExampleImage)
CodeTypes := ['EAN-13', 'Code 39']
find_bar_code (Image, SymbolRegions, BarCodeHand..."
b303b34a,micro,13,,"disp_message (WindowHandle, 'Allowed orientations (wrong orientation of EAN-13 code)', 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, CodeTypes[0] + ' ' + AllowedOrientationsWrong[0] + '(+-' + AllowedTolerancesGot[0] + ') degrees', 'image', 70, 500, 'black', 'true')
disp_message (Win...",75,84,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
CodeTypes := ['EAN-13', 'Code 39']
AllowedOrientationsWrong := [45.0, 0.0]
get_bar_code_param_specif..."
52d3f9d5,full,0,"This example program shows problematic images with distorted
symbols of the type ECC200 where some s...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_distorted_003')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
Message := '...",15,178,
52d3f9d5,micro,1,"symbols of the type ECC200 where some symbols can not be read.
First, the program tries to find and ...","dev_update_off ()
dev_close_window ()",6,17,
52d3f9d5,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_distorted_003')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
Message := 'This program demonstrates problematic ...",18,30,
52d3f9d5,micro,3,,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",31,33,
52d3f9d5,micro,4,persistently and the search is done with enhanced recognition.,"set_data_code_2d_param (DataCodeHandle, 'persistence', 1)
set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'enhanced_recognition')
NumSymbols := 6
ImageNames := 'datacode/ecc200/ecc200_distorted_'
for Index := 3 to 5 by 1
read_image (Image, ImageNames + Index$'.3d')
if (Index == 3)
Mess...",34,184,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_distorted_003')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHand..."
c2838e5a,full,0,"***************************************************************
This program shows how to access int...","dev_update_off ()
dev_close_window ()
ImagePath := 'datacode/ecc200/'
ImageFiles := ImagePath + ['ecc200_distorted_001', 'ecc200_distorted_002', 'ecc200_to_preprocess_002', 'ecc200_to_preprocess_004', 'ecc200_to_preprocess_003']
dev_open_window (0, 0, 550, 600, 'black', ParamWindow)
set_display_font...",25,659,
c2838e5a,micro,1,,"dev_update_off ()
dev_close_window ()
ImagePath := 'datacode/ecc200/'
ImageFiles := ImagePath + ['ecc200_distorted_001', 'ecc200_distorted_002', 'ecc200_to_preprocess_002', 'ecc200_to_preprocess_004', 'ecc200_to_preprocess_003']",24,29,
c2838e5a,micro,2,,"dev_open_window (0, 0, 550, 600, 'black', ParamWindow)
set_display_font (ParamWindow, 14, 'mono', 'true', 'false')",30,33,
c2838e5a,micro,3,,"Message := 'This program shows how to access intermediate'
Message[1] := 'results while searching for ECC 200 data codes.'
Message[2] := ' '
Message[3] := 'This enables to obtain hints how the search process'
Message[4] := 'can be enhanced with respect to runtime or why a'
Message[5] := 'symbol is n...",34,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, 550, 600, 'black', ParamWindow)
* --- End of Automatically Added Context ---"
c2838e5a,micro,4,"-------------------------------------------------------
Create a 2d data code model of the 2d data c...","create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandle)
set_data_code_2d_param (DataCodeHandle, 'persistence', 1)",45,52,"* --- Automatically Added Context ---
Message[1] := 'results while searching for ECC 200 data codes.'
* --- End of Automatically Added Context ---"
c2838e5a,micro,5,"----------------------------------
Get the lists of parameters which can be used to query the
alphan...","query_data_code_2d_params (DataCodeHandle, 'get_result_params', GenParamName)
query_data_code_2d_params (DataCodeHandle, 'get_result_objects', GenObjectNames)",53,59,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandle)
* --- End of Automatically Added Context ---"
c2838e5a,micro,6,,"ColorAlph := gen_tuple_const(|GenParamName|,'#808080')
ColorIcon := gen_tuple_const(|GenObjectNames|,'#808080')",60,63,"* --- Automatically Added Context ---
query_data_code_2d_params (DataCodeHandle, 'get_result_params', GenParamName)
query_data_code_2d_params (DataCodeHandle, 'get_result_objects', GenObjectNames)
* -..."
c2838e5a,micro,7,"------------------------------
Open window for iconic objects.","WWidth := 600
WHeight := 300
WRatio := real(WWidth) / WHeight
dev_open_window (0, 560, WWidth, WHeight, 'white', ImageWindow)
set_display_font (ImageWindow, 14, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')",64,74,
c2838e5a,micro,8,,"dev_open_window (360, 560, 600, 240, 'white', ResultWindow)
set_display_font (ResultWindow, 14, 'mono', 'true', 'false')",75,78,
c2838e5a,micro,9,"--------------------------------------------------------------
Search the data codes in each image a...","for Index := 0 to |ImageFiles| - 1 by 1
dev_set_window (ImageWindow)
dev_clear_window ()
read_image (Image, ImageFiles[Index])
if (Index == 2)
zoom_image_size (Image, Image, 230, 230, 'constant')
endif
if (Index == 4)
gray_erosion_rect (Image, Image, 3, 3)
gauss_filter (Image, Image, 3)
endif
determ...",79,583,"* --- Automatically Added Context ---
ImageFiles := ImagePath + ['ecc200_distorted_001', 'ecc200_distorted_002', 'ecc200_to_preprocess_002', 'ecc200_to_preprocess_004', 'ecc200_to_preprocess_003']
Ima..."
c2838e5a,micro,10,,FormatString := TabWidth$'1',587,588,
c2838e5a,micro,11,,"Tmp := Input$FormatString + ','",589,591,"* --- Automatically Added Context ---
FormatString := TabWidth$'1'
* --- End of Automatically Added Context ---"
c2838e5a,micro,12,,"I := [ValuesPerRow - 1:ValuesPerRow:|Tmp| - 2]
String := sum(replace(Tmp,I,Tmp[I] + '\n'))",592,594,"* --- Automatically Added Context ---
FormatString := TabWidth$'1'
Tmp := Input$FormatString + ','
* --- End of Automatically Added Context ---"
c2838e5a,micro,13,,"FormattedString := String{0:strlen(String) - 2}
return ()",595,625,"* --- Automatically Added Context ---
format_text (3, ResultASCIICode, 10, FormattedString)
FormatString := TabWidth$'1'
Tmp := Input$FormatString + ','
String := sum(replace(Tmp,I,Tmp[I] + '\n'))
I :..."
c2838e5a,micro,14,,"get_image_size (Image, IWidth, IHeight)",629,631,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[Index])
* --- End of Automatically Added Context ---"
c2838e5a,micro,15,,"IRatio := real(IWidth) / IHeight
if (WRatio &lt;= IRatio)
Scale := real(IWidth) / WWidth
PartHeight := WHeight * Scale
Border := (PartHeight - IHeight) / 2
Row1 := -Border
Row2 := IHeight + Border - 1
Col1 := 0
Col2 := IWidth - 1
else
Row1 := 0
Row2 := IHeight - 1
Scale := real(IHeight) / WHeight
Pa...",632,674,"* --- Automatically Added Context ---
WWidth := 600
WHeight := 300
WRatio := real(WWidth) / WHeight
determine_part (Image, WRatio, WWidth, WHeight, Row1, Col1, Row2, Col2)
get_image_size (Image, IWidt..."
deec2662,full,0,"***************************************************************
This program demonstrates how to rea...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)
Message := 'This program demonstrates how to read 2d data'
Message[1] := 'codes with the following...",19,243,
deec2662,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)
Message := 'This program demonstrates how to read 2d data'
Message[1] := 'codes with the following...",18,37,
deec2662,micro,2,"-------------------------------------------------------
Choose the symbol types by (un)commenting th...","SymbolType := []
SymbolType := [SymbolType,'QR Code']
SymbolType := [SymbolType,'Micro QR Code']
SymbolType := [SymbolType,'PDF417']
SymbolType := [SymbolType,'Aztec Code']
SymbolType := [SymbolType,'Data Matrix ECC 200']
SymbolType := [SymbolType,'DotCode']",38,49,
deec2662,micro,3,"-------------------------------------------------------
Get images of the chosen symbol types, creat...","for Index := 0 to |SymbolType| - 1 by 1
if (SymbolType[Index] == 'Data Matrix ECC 200')
list_image_files ('datacode/ecc200', 'default', [], ImageFiles)
ImageFiles := regexp_select(ImageFiles,'(ecc200_cpu_)|(ecc200_disturbed_0)|(ecc200_quiet_zone_disturbed)|(ecc200_dmre_0)')
elseif (SymbolType[Index]...",50,192,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
SymbolType := [..."
deec2662,micro,4,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",204,239,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandleStandard, [], [], ResultHandles, DecodedDataStrings)
*..."
deec2662,micro,5,,"dev_disp_text (TitleMessage, 'window', 12, 12, 'black', [], [])
dev_disp_text (ResultMessage, 'window', 40, 12, ColorResult, [], [])
return ()",240,257,"* --- Automatically Added Context ---
SymbolType := []
ResultMessage := 'Runtime of recognition modes:'
TitleMessage := SymbolType[Index] + ': Image ' + (I + 1) + ' of ' + |ImageFiles|
for Index := 0 ..."
7bd81dde,full,0,"This program demonstrates how to minimize large
gaps between the modules by gray value morphology
so...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_003')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (Image)
Message :...",10,59,
7bd81dde,micro,1,"gaps between the modules by gray value morphology
so that 2d data code symbols can be found and deco...","dev_update_off ()
dev_close_window ()",6,12,
7bd81dde,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_003')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (Image)
Message := 'This program demonstrates how to'
M...",13,27,
7bd81dde,micro,3,biggest allowed module gap ’big’ before reading the code,"create_data_code_2d_model ('Data Matrix ECC 200', ['module_gap_min', 'module_gap_max'], ['no', 'big'], DataCodeHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)",28,32,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_003')
* --- End of Automatically Added Context ---"
7bd81dde,micro,4,,"if (|ResultHandles| == 0)
dev_display (Image)
Message := 'Search was carried out with adapted'
Message[1] := 'parameters in the data code model,'
Message[2] := 'but still no data code could be found!'
disp_message (WindowHandle, Message, 'window', 12, 12, 'red', 'true')
Message := 'Now adapt the ima...",33,56,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_003')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates..."
7bd81dde,micro,5,,"disp_message (WindowHandle, 'Decoded string: ' + DecodedDataStrings, 'window', 80, 12, 'black', 'true')
dev_display (SymbolXLDs)",57,65,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
* -..."
722cc228,full,0,"This program demonstrates how to preproccess of a symbol
with gaps, modules of different color, and ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_004')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (Image)
Message :...",9,82,
722cc228,micro,1,"with gaps, modules of different color, and a distorted quiet zone","dev_update_off ()
dev_close_window ()",6,10,
722cc228,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_004')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')
dev_display (Image)",11,18,
722cc228,micro,3,,"Message := 'This program demonstrates the'
Message[1] := 'preproccessing of a data code symbol'
Message[2] := 'with gaps, modules of different color'
Message[3] := 'and a distorted quiet zone.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandl...",19,27,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
722cc228,micro,4,"-------------------------------------------------------
Create a 2d data code model of the 2d data c...","create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandle)",28,34,
722cc228,micro,5,,"set_data_code_2d_param (DataCodeHandle, ['module_gap_min', 'module_gap_max'], ['no', 'big'])",35,37,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandle)
* --- End of Automatically Added Context ---"
722cc228,micro,6,,"find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)",38,40,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_004')
create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', Dat..."
722cc228,micro,7,"-----------------------------------------------
If no data code was found preprocess the image,
firs...","if (|ResultHandles| == 0)
gray_opening_shape (Image, ImageOpening, 7, 7, 'octagon')
find_data_code_2d (ImageOpening, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
dev_display (ImageOpening)
dev_display (SymbolXLDs)
disp_message (WindowHandle, 'Preprocessing: Gray value openi...",41,88,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_to_preprocess_004')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_data_code_2d_model ('Data Matr..."
2ed9b6d5,full,0,"This program demonstrates how to read a slanted
2d data code by preprocessing with rectification","dev_update_off ()
dev_close_window ()
read_image (Image_slanted, 'datacode/ecc200/ecc200_to_preprocess_001')
dev_open_window_fit_image (Image_slanted, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)
Message := 'T...",9,59,
2ed9b6d5,micro,1,2d data code by preprocessing with rectification,"dev_update_off ()
dev_close_window ()",6,10,
2ed9b6d5,micro,2,,"read_image (Image_slanted, 'datacode/ecc200/ecc200_to_preprocess_001')
dev_open_window_fit_image (Image_slanted, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)
Message := 'This program demonstrates how to prepro...",11,22,
2ed9b6d5,micro,3,,"XCoordCorners := [130, 225, 290, 63]
YCoordCorners := [101, 96, 289, 269]",23,26,
2ed9b6d5,micro,4,,"gen_cross_contour_xld (Crosses, XCoordCorners, YCoordCorners, 6, 0.785398)
dev_display (Image_slanted)
dev_display (Crosses)
disp_message (WindowHandle, 'Slanted image', 'window', 12, 12, 'black', 'true')
Message := 'The marked corners are used to generate a'
Message[1] := 'homogeneous transformatio...",27,39,"* --- Automatically Added Context ---
read_image (Image_slanted, 'datacode/ecc200/ecc200_to_preprocess_001')
dev_open_window_fit_image (Image_slanted, 0, 0, -1, -1, WindowHandle)
Message := 'This prog..."
2ed9b6d5,micro,5,"of the corners of the data code symbol and the corresponding points
of a square.","hom_vector_to_proj_hom_mat2d (XCoordCorners, YCoordCorners, [1, 1, 1, 1], [70, 270, 270, 70], [100, 100, 300, 300], [1, 1, 1, 1], 'normalized_dlt', HomMat2D)",40,44,"* --- Automatically Added Context ---
XCoordCorners := [130, 225, 290, 63]
YCoordCorners := [101, 96, 289, 269]
* --- End of Automatically Added Context ---"
2ed9b6d5,micro,6,,"projective_trans_image (Image_slanted, Image_rectified, HomMat2D, 'bilinear', 'false', 'false')",45,47,"* --- Automatically Added Context ---
read_image (Image_slanted, 'datacode/ecc200/ecc200_to_preprocess_001')
hom_vector_to_proj_hom_mat2d (XCoordCorners, YCoordCorners, [1, 1, 1, 1], [70, 270, 270, 70..."
2ed9b6d5,micro,7,for the data code in the rectified image,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
find_data_code_2d (Image_rectified, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)",48,52,"* --- Automatically Added Context ---
projective_trans_image (Image_slanted, Image_rectified, HomMat2D, 'bilinear', 'false', 'false')
* --- End of Automatically Added Context ---"
2ed9b6d5,micro,8,,"dev_display (Image_slanted)
dev_display (Image_rectified)
dev_display (SymbolXLDs)
disp_message (WindowHandle, 'Decoding successful ', 'window', 12, 12, 'black', 'true')
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')
disp_message (WindowHandle, DecodedDataStrings, 'window', 350, 70, 'f...",53,65,"* --- Automatically Added Context ---
read_image (Image_slanted, 'datacode/ecc200/ecc200_to_preprocess_001')
dev_open_window_fit_image (Image_slanted, 0, 0, -1, -1, WindowHandle)
projective_trans_imag..."
cfde7d86,full,0,"------------------------
EXAMPLE DESCRIPTION
------------------------
This program is a template and...","dev_update_off ()
dev_close_window ()
Offline := true
CodeType := 'EAN-13'
RefAperture := 1
XDimension := 1
BarCodeHandle := -1
ResultFileName := 'reflectance_cam_par.dat'
InterfaceName := 'USB3Vision'
EXPSTEP := 0.05
MAXSTEPS := 5
IncreaseLight := 0
if (Offline)
read_image (Image, '/barcode/gs1data...",138,1129,
cfde7d86,micro,1,"1).(automatic, if reference aperture for the card is not known)
A is 0.8 of the minimum X-Dimension ...","dev_update_off ()
dev_close_window ()",122,140,
cfde7d86,micro,2,"PLEASE ADAPT THESE VARIABLES TO YOUR APPLICATION
---------------------------------------------------...",Offline := true,141,145,
cfde7d86,micro,3,calibration plate.,CodeType := 'EAN-13',146,148,
cfde7d86,micro,4,"calibration plate). If no reference aperture is denoted, set
the X Dimension value to 1.",RefAperture := 1,149,152,
cfde7d86,micro,5,"If no X Dimension is denoted, set the X Dimension value to 1",XDimension := 1,153,155,
cfde7d86,micro,6,,BarCodeHandle := -1,156,157,
cfde7d86,micro,7,calibration.,ResultFileName := 'reflectance_cam_par.dat',158,160,
cfde7d86,micro,8,,InterfaceName := 'USB3Vision',161,163,
cfde7d86,micro,9,,EXPSTEP := 0.05,164,166,
cfde7d86,micro,10,"adjusting exposure time,i.e., if MAXSTEPS is 3,
then after each three adjustments of the exposure,
t...",MAXSTEPS := 5,167,172,
cfde7d86,micro,11,"The value of this variable signalizes how the
system should be adjusted in the next step. If the val...",IncreaseLight := 0,173,183,
cfde7d86,micro,12,,"if (Offline)
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
else
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
set_framegrabber_param (AcqHandle, 'GainSelector', ...",184,203,"* --- Automatically Added Context ---
Offline := true
InterfaceName := 'USB3Vision'
* --- End of Automatically Added Context ---"
cfde7d86,micro,13,"The camera needs to be calibrated so that the black corresponds to
the black in the image. To set th...","if (Offline)
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_black_level')
dev_display (Image)
disp_message (WindowHandle, 'Use black image to set the camera black level', 'window', 10, 10, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop (...",204,235,"* --- Automatically Added Context ---
Offline := true
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, ..."
cfde7d86,micro,14,"sensor is parallel to the plane of the symbol area. Place the
calibration card under the camera. The...","if (Offline)
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_aperture_focus')
dev_display (Image)
Message := 'Now the camera and calibration plate are placed'
Message := [Message,'and aperture and focus are adjusted']
disp_message (WindowHandle, Message, 'window', 10...",236,267,"* --- Automatically Added Context ---
Offline := true
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, ..."
cfde7d86,micro,15,,"ResultValueNames := ['A', 'MLCal', 'Rcal', 'SRexp', 'SRgain']",268,269,
cfde7d86,micro,16,"between 0.7 and 0.86 of the maximal gray value, that is
required by the standard.","if (Offline)
MaxGrayValue := 255
else
get_framegrabber_param (AcqHandle, 'bits_per_channel', BitsPerChannel)
MaxGrayValue := pow(2,BitsPerChannel) - 1
endif
MinBrightGrayValue := 0.7 * MaxGrayValue
MaxBrightGrayValue := 0.86 * MaxGrayValue",270,280,"* --- Automatically Added Context ---
Offline := true
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
* --- End of..."
cfde7d86,micro,17,,"MinSizeCodeSymbol := (ImWidth * ImHeight) / 10
MaxSizeCodeSymbol := (ImWidth * ImHeight) / 2
AdjustParams := []
IndIm := 1",281,287,"* --- Automatically Added Context ---
get_image_size (Image, ImWidth, ImHeight)
* --- End of Automatically Added Context ---"
cfde7d86,micro,18,,"create_bar_code_model ([], [], BarCodeHandle)
set_bar_code_param (BarCodeHandle, 'element_size_max', 32)
while (1)
if (Offline)
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_' + IndIm$'02')
IndIm := IndIm + 1
else
adjust_system_response (AcqHandle, IncreaseLight, A...",288,410,"* --- Automatically Added Context ---
Offline := true
CodeType := 'EAN-13'
RefAperture := 1
XDimension := 1
BarCodeHandle := -1
ResultFileName := 'reflectance_cam_par.dat'
EXPSTEP := 0.05
MAXSTEPS := ..."
cfde7d86,micro,19,"steps (NumExpSteps) and direction of the incrementation in the
last call (LastIncr)","if (|LastAdjustParams| &gt; 0)
NumExpSteps := LastAdjustParams[0]
LastIncr := LastAdjustParams[1]
else
NumExpSteps := 0
LastIncr := 0
endif",448,460,
cfde7d86,micro,20,,"get_framegrabber_param (AcqHandle, 'ExposureTime_range', ExposureRange)
MinExp := ExposureRange[0]
MaxExp := ExposureRange[1]
get_framegrabber_param (AcqHandle, 'Gain_range', GainRange)
MinGain := GainRange[0]
MaxGain := GainRange[1]",461,468,"* --- Automatically Added Context ---
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
* --- End of Automatically A..."
cfde7d86,micro,21,,"get_framegrabber_param (AcqHandle, 'Gain', GainValue)
get_framegrabber_param (AcqHandle, 'ExposureTime', ExposureValue)
if (IncreaseLight == 0)
NewAdjustParams := [0, 0]
AdjustmentImpossible := false
return ()
endif
if (LastIncr != IncreaseLight)
NumExpSteps := 0
endif",469,485,"* --- Automatically Added Context ---
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
set_framegrabber_param (AcqH..."
cfde7d86,micro,22,appears to be true,"AdjustmentImpossible := false
if (IncreaseLight == -1)
if ((ExposureValue - EXPSTEP * MaxExp) &lt; MinExp)
NumExpSteps := MAXSTEPS
endif
if ((NumExpSteps &gt;= MAXSTEPS) and (GainValue - 2 &gt;= MinGain))
GainValue := GainValue - 2
set_framegrabber_param (AcqHandle, 'Gain', GainValue)
NumExpSteps :=...",486,542,"* --- Automatically Added Context ---
EXPSTEP := 0.05
MAXSTEPS := 5
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle..."
cfde7d86,micro,23,LastAdjustParams in the next call of adjust_system_response,"NewAdjustParams := [NumExpSteps,IncreaseLight]
return ()
ProcStatus := 'error'
NumberSelectedBarCodeRegions := 0
NumberCandidates := 0
PhiBarCodeRegion := 0
gen_empty_obj (BarCodeRectangle)
find_bar_code (Image, SymbolRegions, BarCodeHandle, CodeType, DecodedDataStrings)",543,619,"* --- Automatically Added Context ---
CodeType := 'EAN-13'
BarCodeHandle := -1
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
IncreaseLight := 0
get_c..."
cfde7d86,micro,24,"then this region should be used for the calibration.
If not, the candidates' regions will be used
by...","if (|DecodedDataStrings| == 0)
get_bar_code_object (BarCodeSymbolRegions, BarCodeHandle, 'all', 'candidate_regions')
count_obj (BarCodeSymbolRegions, NumberCandidates)
elseif (|DecodedDataStrings| &gt;= 1)
count_obj (SymbolRegions, NumberCandidates)
copy_obj (SymbolRegions, BarCodeSymbolRegions, 1, ...",620,663,"* --- Automatically Added Context ---
BarCodeHandle := -1
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
get_image_size (Image, ImWidth, ImHeight)
dev..."
cfde7d86,micro,25,the code symbol for further processing.,"count_obj (CandidateBarCodeRegion, NumCandObj)
if (NumCandObj == 1)
smallest_rectangle2 (CandidateBarCodeRegion, Row1, Column1, PhiBarCodeRegion, Length1, Length2)
gen_rectangle2 (BarCodeRectangle, Row1, Column1, PhiBarCodeRegion, Length1, Length2)
gen_rectangle1 (ImDomain, 0, 0, ImHeight - 1, ImWid...",664,781,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
get_image_size (Image, ImWidth, ImHeight)
dev_open_window (0, 0, ..."
cfde7d86,micro,26,,"binary_threshold (ImageReduced, Region, 'max_separability', 'dark', UsedThreshold)
area_center (Region, AreaRegion, Row, Column)
smallest_rectangle2 (Region, RowRegion, ColRegion, PhiRegion, Length1Region, Length2Region)
if (Length1Region &gt; Length2Region)
RectSEHeight := Length2Region
else
RectSE...",782,965,"* --- Automatically Added Context ---
ResultFileName := 'reflectance_cam_par.dat'
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message := 'Cover the lens to set the camera black level'
get_..."
cfde7d86,micro,27,,"dilation_rectangle1 (BarCodeRectangle, BarCodeRectangleDilated, 7, 7)
reduce_domain (Image, BarCodeRectangleDilated, ImageReduced)",966,969,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
get_calib_bar_code_region (Image, BarCodeRectangle, BarCodeHandle..."
cfde7d86,micro,28,,"get_regions_dark_elements (ImageReduced, DarkElements, PhiElm)",970,972,"* --- Automatically Added Context ---
get_symbol_dark_elements (BarCodeRectangle, Image, ImageReduced, DarkElements, BarCodeSymbolRegion, WindowHandle, ImWidth, ImHeight, MinElmWidth, SymbolCenterValu..."
cfde7d86,micro,29,,"if ((|PhiElm| == 0) or ((max(abs(deg(PhiElm))) &gt; 5) and (max(abs(deg(PhiElm))) &lt; 85)))
dev_display (Image)
disp_calib_plate_instructions (WindowHandle)
return ()
endif
count_obj (DarkElements, NumDarkElements)
if (NumDarkElements &lt; 10)
dev_display (Image)
dev_set_color ('red')
dev_set_draw ...",973,997,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message :..."
cfde7d86,micro,30,,"gen_measure_rectangle2 (SymbolRectRow, SymbolCenterCol, SymbolPhi, SymbolHWidth + 5, SymbolHHeight + 5, ImWidth, ImHeight, 'nearest_neighbor', MeasureHandle)
measure_pairs (ImageReducedSymbol, MeasureHandle, 1, 30, 'all', 'all', RowEdgeFirst, ColumnEdgeFirst, AmplitudeFirst, RowEdgeSecond, ColumnEdg...",998,1000,"* --- Automatically Added Context ---
get_image_size (Image, ImWidth, ImHeight)
smallest_rectangle2 (DarkElementRegion, SymbolRectRow, SymbolCenterCol, SymbolPhi, SymbolHWidth, SymbolHHeight)
reduce_d..."
cfde7d86,micro,31,the calibration is canceled.,"if (|RowEdgeFirst| &lt; 10)
dev_display (Image)
Message := 'Not enough bar code symbol elements found'
Message := [Message,'Please check the symbol representation in the image']
disp_message (WindowHandle, Message, 'window', 10, 10, 'red', 'true')
return ()
endif
tuple_min (IntraDistance, MinElmWidt...",1001,1052,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message :..."
cfde7d86,micro,32,,"area_center (BrightConnectedRegions, Area, RowBrightCenter, ColumnBrightCenter)
if (|RowBrightCenter| == 0)
return ()
endif",1053,1057,"* --- Automatically Added Context ---
get_symbol_bright_elements (Image, DarkElements, BrightConnectedRegions, SymbolCenterValues[1], SymbolCenterValues[3], X, WindowHandle, ProcStatus)
gen_contour_po..."
cfde7d86,micro,33,"value. Get gray values of the area centers and calculate
the mean gray value. Check the gray value r...","create_circular_mask (A, Filter)
convol_image (Image, ImageReference, Filter, 'mirrored')
get_grayval (ImageReference, int(RowBrightCenter), int(ColumnBrightCenter), BrightElmGrayvals)",1058,1064,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
A := X * 0.8
get_bright_elm_gray_values (BrightConnectedRegions, ..."
cfde7d86,micro,34,and display results,"gen_contour_centers_bright (CrossCenters, RowBrightCenter, ColumnBrightCenter)
dev_display (Image)
dev_display (CrossCenters)
dev_set_draw ('margin')
dev_display (BrightConnectedRegions)
ProcStatus := 'success'
return ()
Message := 'Calculated values:'
Message := [Message,'A = ' + ReflectanceCalibVa...",1065,1140,"* --- Automatically Added Context ---
read_image (Image, '/barcode/gs1databar_expanded/gs1databar_expanded_calibration_init_position')
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
Message :..."
c2b31cdf,full,0,"This example demonstrates the impact of the parameter
'contrast_tolerance' parameter of the ECC200 r...","dev_update_off ()
dev_close_window ()
list_image_files ('datacode/ecc200', 'default', [], ImageFiles)
tuple_regexp_select (ImageFiles, 'contrast_variations', ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16...",20,96,
c2b31cdf,micro,1,mode of the ECC200 reader.,"dev_update_off ()
dev_close_window ()",17,22,
c2b31cdf,micro,2,,"list_image_files ('datacode/ecc200', 'default', [], ImageFiles)
tuple_regexp_select (ImageFiles, 'contrast_variations', ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_col...",23,31,
c2b31cdf,micro,3,,"Message := 'This example program demonstrates how the parameter'
Message[1] := '\'contrast_tolerance\' influences the search with a'
Message[2] := 'ECC200 reader for 2d data code symbols with local'
Message[3] := 'contrast variations.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', ...",32,40,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
c2b31cdf,micro,4,,"create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandleLow)
set_data_code_2d_param (DataCodeHandleLow, 'contrast_tolerance', 'low')",41,44,
c2b31cdf,micro,5,,"create_data_code_2d_model ('Data Matrix ECC 200', 'default_parameters', 'enhanced_recognition', DataCodeHandleHigh)
set_data_code_2d_param (DataCodeHandleHigh, 'contrast_tolerance', 'high')
for Index := 0 to 3 by 1
read_image (Image, ImageFiles[Index])
Loops := 2
count_seconds (T1)
for Loop := 1 to ...",45,102,"* --- Automatically Added Context ---
list_image_files ('datacode/ecc200', 'default', [], ImageFiles)
read_image (Image, ImageFiles[0])
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Me..."
c6f7948f,full,0,"***************************************************************
Example program that demonstrates th...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'This ...",33,289,
c6f7948f,micro,1,"simulate various qualities and investigates some of the
mentioned elements.
************************...","dev_update_off ()
dev_close_window ()",28,35,
c6f7948f,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",36,41,
c6f7948f,micro,3,,"Message := 'This program demonstrates the'
Message[1] := 'direct mark quality values of'
Message[2] := 'ECC 200 data codes based on the'
Message[3] := 'standard SEMI T10-0701.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true...",42,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
c6f7948f,micro,4,The values correspond to the position of the elements in the tuple,"CONTRAST := 10
CONTRAST_SNR := 11
CELL_WIDTH := 14
HORIZONTAL_MARK := 16
CELL_DEFECTS := 18
FP_DEFECTS := 19
UEC := 20
Wait := .5",51,61,
c6f7948f,micro,5,,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",62,64,"* --- Automatically Added Context ---
Message[2] := 'ECC 200 data codes based on the'
* --- End of Automatically Added Context ---"
c6f7948f,micro,6,,"set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'enhanced_recognition')",65,66,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
c6f7948f,micro,7,,"get_data_code_2d_results (DataCodeHandle, 'general', 'quality_semi_t10_labels', Labels)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_data_code_2d_results (DataCodeHandle, ResultHandles, 'quality_semi_t10_values', QualityValues)
RowP1 := int(Qua...",67,94,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'This program demonstrates t..."
c6f7948f,micro,8,"---------
Range between minimal and maximal pixel intensity","for Index := 1 to 10 by 1
scale_image (Image, ImageScaled, 1.0 / Index * 1.15, Index * 20 - 50)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_data_code_2d_results (DataCodeHandle, ResultHandles, 'quality_semi_t10_values', QualityValues)
de...",95,118,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'This program demonstrates t..."
c6f7948f,micro,9,,"gen_rectangle1 (Defect, 160, 220, 320, 335)
for Offset := 0 to 110 by 10
scale_image (Image, ImageScaled, 1, Offset)
dev_display (Image)
dev_display (ImageScaled)
reduce_domain (ImageScaled, Defect, ImageReduced)
paint_gray (ImageReduced, Image, ImageModulation)
find_data_code_2d (ImageModulation, S...",124,164,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'This program demonstrates t..."
c6f7948f,micro,10,"-----------------------------
Shift the horizontal alternating pattern and measure the horizontal ma...","hom_mat2d_identity (HomMat2D)
copy_image (Image, ImageDeformed)",165,170,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
* --- End of Automatically Added Context ---"
c6f7948f,micro,11,,"gen_rectangle1 (Rectangle, 127, 0, 137, Width)
reduce_domain (ImageDeformed, Rectangle, ImageDeformed)
hom_mat2d_translate (HomMat2D, 0.0, 0.5, HomMat2D)
for Trans := 1 to 14 by 1
projective_trans_image (ImageDeformed, ImageDeformed, HomMat2D, 'bilinear', 'false', 'true')
paint_gray (ImageDeformed, ...",171,194,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
M..."
c6f7948f,micro,12,"-----------------------
Generate and investigate an image with a damage at
the L-shape of the finder...","data_matrix_cell_width := QualityValues[CELL_WIDTH]
for NumModules := 0 to 10 by 1
gen_rectangle1 (Defect, 375, 171, 385, NumModules * data_matrix_cell_width + 171)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandle...",195,229,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'This program demonstrates t..."
c6f7948f,micro,13,"-----------------------------------------
Amount of error correcting capacities that are not already...","for NumModules := 1 to 18 by 1
gen_rectangle1 (Defect, 270, 171, 310, NumModules * data_matrix_cell_width + 171)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
get_data_code_2d_results (Dat...",230,280,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Message := 'This program demonstrates t..."
c6f7948f,micro,14,Return a formatted string for numbers.,"if (is_number(QualityValues[CONTRAST_SNR]))
ContrastSNRString := QualityValues[CONTRAST_SNR]$'.2f'
else
ContrastSNRString := QualityValues[CONTRAST_SNR]
endif
return ()",281,299,"* --- Automatically Added Context ---
CONTRAST_SNR := 11
get_contrast_snr_string (QualityValues, CONTRAST_SNR, ContrastSNRString)
get_data_code_2d_results (DataCodeHandle, ResultHandles, 'quality_semi..."
d6398c62,full,0,"This example program shows how to read ECC200 symbols
with heavily disturbed finder pattern. In this...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_damaged_finder_pattern_'
ImageFilesTrain := 'datacode/ecc200/ecc200_damaged_finder_pattern_training_'
ImageNum := 19
ImageTrainNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, Wi...",18,174,
d6398c62,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_damaged_finder_pattern_'
ImageFilesTrain := 'datacode/ecc200/ecc200_damaged_finder_pattern_training_'
ImageNum := 19
ImageTrainNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, Wi...",17,29,
d6398c62,micro,2,,"Message := 'This program demonstrates how to find and decode'
Message[1] := 'ECC200 symbols that have a heavily disturbed finder pattern.'
Message[2] := 'To read these symbols successfully, some example images'
Message[3] := 'that contain ECC200 symbols with similar disturbances'
Message[4] := 'are ...",30,39,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
d6398c62,micro,3,"----------------------------------------------------
Create a 2d data code model of the 2d data code...","create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",40,45,
d6398c62,micro,4,"-------------------------------------------------------
Train the model on some images containing EC...","for Index := 1 to ImageTrainNum by 1
read_image (Image, ImageFilesTrain + Index$'.2d')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'train', 'all', ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
TitleMessage := 'Train on image ' + Index + ' of ' + ImageTrain...",46,64,"* --- Automatically Added Context ---
ImageFilesTrain := 'datacode/ecc200/ecc200_damaged_finder_pattern_training_'
ImageTrainNum := 5
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (I..."
d6398c62,micro,5,,"dev_clear_window ()
Message := 'The trained data code model is now used to find the data codes'
Message[1] := 'in a sequence of images with similar disturbances.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",65,72,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates how to find and decode'
* --- End of Automatically Added Conte..."
d6398c62,micro,6,"-------------------------------------------------------
Search and read the data codes with the trai...","for Index := 1 to ImageNum by 1
read_image (Image, ImageFiles + Index$'.2d')
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := (T2 - T1) * 1000.0
TitleMessage := 'Image ' + Index + ' of '...",73,123,"* --- Automatically Added Context ---
ImageFiles := 'datacode/ecc200/ecc200_damaged_finder_pattern_'
ImageNum := 19
read_image (Image, ImageFiles + '01')
dev_open_window_fit_image (Image, 0, 0, -1, -1..."
d6398c62,micro,7,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",135,170,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'train', 'all', ResultHandles, DecodedDataStri..."
d6398c62,micro,8,,"disp_message (WindowHandle, TitleMessage, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, ResultMessage, 'window', 40, 12, ColorResult, 'true')
return ()",171,188,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
ImageTrainNum := 5
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
TitleMe..."
3fffb938,full,0,"***************************************************************
Example program that demonstrates th...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message := 'This program demon...",35,528,
3fffb938,micro,1,"overall quality and decode. For each of the other six
print quality elements the program adapts the ...","dev_update_off ()
dev_close_window ()",26,37,
3fffb938,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",38,43,
3fffb938,micro,3,,"Message := 'This program demonstrates the print quality'
Message[1] := 'grades of ECC200 data codes based on the'
Message[2] := 'standard ISO/IEC 15415:2011.'
Message[3] := 'Successively images with various qualities'
Message[4] := 'are generated and the respective print'
Message[5] := 'quality grad...",44,57,
3fffb938,micro,4,,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",58,60,
3fffb938,micro,5,,"set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'enhanced_recognition')",61,63,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
3fffb938,micro,6,compliant camera and lighting setups,"set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_decode_algorithm', 'reference')
ModuleWidth := 10",64,69,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
3fffb938,micro,7,"----------
Range between minimal and maximal pixel intensity
High contrast grade means high contrast","for Index := 1 to 10 by 1
scale_image (Image, ImageScaled, 1.0 / Index * 1.15, Index * 20 - 50)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, ResultHandles[0], 'isoiec15415', 'numeric', 'all', GradingResults...",70,96,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
Message := 'This program demonstrates the print quality'
dev_disp_text ('Press Run (F5) to continue'..."
3fffb938,micro,8,,"gen_rectangle1 (Defect, 160, 220, 320, 335)
for Offset := 0 to 110 by 10
scale_image (Image, ImageScaled, 1, Offset)
dev_display (ImageScaled)
reduce_domain (ImageScaled, Defect, ImageReduced)
paint_gray (ImageReduced, Image, ImageModulation)
find_data_code_2d (ImageModulation, SymbolXLDs, DataCodeH...",105,151,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Wait := .5
create_data_code_2d_model (..."
3fffb938,micro,9,,"for NumModules := 0 to 10 by 1
gen_rectangle1 (Defect, 388, 171, 398, NumModules * ModuleWidth + 171)
paint_region (Defect, Image, ImageDefect, 0, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, Result...",157,192,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates ..."
3fffb938,micro,10,the L-shape of the finder pattern,"for NumModules := 0 to 10 by 1
gen_rectangle1 (Defect, 375, 171, 385, NumModules * ModuleWidth + 171)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, Resu...",193,229,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates ..."
3fffb938,micro,11,alternating side of the finder pattern,"for NumModules := 0 to 10 by 1
gen_rectangle1 (Defect, 226, 376, NumModules * ModuleWidth + 226, 386)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, Resu...",230,266,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates ..."
3fffb938,micro,12,"---------------------
Distortion of width to height ratio result in degraded axial non-uniformity","IterationIndex := 0
for Scale := 1 to 1.2 by 0.02
affine_trans_image (Image, ImageDeformed, [Scale,0,(-Scale + 1) * 140,0, 1, 0], 'weighted', 'false')
find_data_code_2d (ImageDeformed, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, ResultHa...",267,298,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
Message := 'This program demonstrates the print quality'
Wait := .5
create_data_code_2d_model ('Data..."
3fffb938,micro,13,"--------------------
In addition to affine distortion, perspective or any
other distortions degrades...","for Diff := 0 to 10 by 2
R := [40, 40, 210, 210]
C := [30, 200, 200, 30]
R2 := R + [0, 0,Diff,0]
C2 := C + [0, 0,Diff,0]
vector_to_proj_hom_mat2d (R, C, R2, C2, 'normalized_dlt', [], [], [], [], [], [], HomMat2D, Covariance)
projective_trans_image (Image, ImageDeformed, HomMat2D, 'bilinear', 'false'...",299,339,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
Message := 'This program demonstrates the print quality'
Wait := .5
create_data_code_2d_model ('Data..."
3fffb938,micro,14,"------------------------
Amount of error correcting capacities which is not already used
reflects th...","for NumModules := 1 to 18 by 1
gen_rectangle1 (Defect, 270, 171, 310, NumModules * ModuleWidth + 171)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, Resu...",340,378,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates ..."
3fffb938,micro,15,"-------------
Measures if the modules are grown or shrunk from the nominal size","for Erosion := 1 to 17 by 2
zoom_image_factor (Image, ImageZoomed, 4, 4, 'bilinear')
gray_erosion_shape (ImageZoomed, ImageZoomedErosion, Erosion, Erosion, 'octagon')
zoom_image_factor (ImageZoomedErosion, ImageErosion, 0.25, 0.25, 'bilinear')
dev_display (ImageErosion)
find_data_code_2d (ImageErosi...",379,427,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
Message := 'This program demonstrates the print quality'
Wait := .5
create_data_code_2d_model ('Data..."
3fffb938,micro,16,,"gen_rectangle1 (Defect, 160, 220, 320, 335)
for Offset := 50 to 90 by 6
scale_image (Image, ImageScaled, 1, Offset)
dev_display (ImageScaled)
reduce_domain (ImageScaled, Defect, ImageReduced)
paint_gray (ImageReduced, Image, ImageReflectanceMargin)
find_data_code_2d (ImageReflectanceMargin, SymbolXL...",433,538,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates ..."
71004a29,full,0,"****************************************************************
Example program that shows intermed...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Message[0] := 'This program ex...",16,465,
71004a29,micro,1,"Example program that shows intermediate results determined
during the assessment of print quality gr...","dev_update_off ()
dev_close_window ()",6,18,
71004a29,micro,2,,"read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('green')
dev_set_line_width (3)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",19,24,
71004a29,micro,3,,"Message[0] := 'This program explains and demonstrates'
Message[1] := 'intermediate grades and values determined'
Message[2] := 'during the assessment of print quality'
Message[3] := 'grades of ECC200 data codes based on the'
Message[4] := 'standards ISO/IEC 15415:2011 and'
Message[5] := 'ISO/IEC 160...",25,43,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
71004a29,micro,4,,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",44,46,
71004a29,micro,5,,"get_data_code_2d_results (DataCodeHandle, 'general', 'quality_isoiec15415_intermediate_labels', ISOIEC15415IntermediateLabels)
Message := 'The intermediate parameters for'
Message[1] := 'ISO/IEC 15415:2011 are:\n'
Message[2] := ' '
for Index := 0 to |ISOIEC15415IntermediateLabels| - 1 by 1
Message[3...",47,63,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains and demonstrates'
Message[4] := 'standards ISO/IEC 15415:2011 a..."
71004a29,micro,6,"----------
The minimal and maximal reflectance value in the inspection area
including the quiet zone...","for Index := 1 to 10 by 1
scale_image (Image, ImageScaled, 1.0 / Index * 1.15, Index * 20 - 50)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, ResultHandles[0], 'isoiec15415', 'numeric', 'all', GradingResults...",64,91,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains a..."
71004a29,micro,7,"-------------------------------------------------
The grades and values for the segments L1, QZL1, L...","dev_clear_window ()
Message := 'The intermediate grades and values for '
Message[1] := '\'L1\', \'L2\', \'QZL1\' and \'QZL2\' enter'
Message[2] := 'the final grade for Fixed Pattern Damage, '
Message[3] := 'and measure the quality of the L-shaped'
Message[4] := 'part of the fixed pattern in the foll...",96,114,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains and demonstrates'
* --- End of Automatically Added Context ---"
71004a29,micro,8,"ISO/IEC 16022:2006, Chapter M 1.2.","gen_rectangle1 (RegionL1, 126, 125, 395, 135)
gen_rectangle1 (RegionQZL1, 116, 115, 395, 125)
gen_rectangle1 (RegionL2, 375, 116, 385, 385)
gen_rectangle1 (RegionQZL2, 385, 116, 395, 395)
dev_set_draw ('margin')
dev_set_color ('forest green')
dev_display (Image)
dev_display (RegionL1)
disp_message (...",115,162,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains a..."
71004a29,micro,9,,"for NumModules := 1 to 4 by 1
gen_rectangle1 (Defect, 156, 126, 156 + NumModules * ModuleWidth, 135)
paint_region (Defect, Image, ImageDefect, 255, 'fill')
find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, Resul...",163,205,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains a..."
71004a29,micro,10,"grades for 'Transition ratio', 'Clock track regularity',
'Clock track damage', and 'Solid fix patter...","dev_clear_window ()
Message := 'The intermediate grades and values for '
Message[1] := '\'Transition ratio\','
Message[2] := '\'Clock track regularity\','
Message[3] := '\'Clock track damage\', and'
Message[4] := '\'Solid fix pattern\''
Message[5] := 'measure the quality of the alternating and'
Mess...",234,257,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains and demonstrates'
* --- End of Automatically Added Context ---"
71004a29,micro,11,,"gen_rectangle1 (RegionSolidAreaTop, 116, 125, 125, 395)
gen_rectangle1 (RegionClockTrackTop, 126, 125, 135, 385)
gen_rectangle1 (RegionSolidAreaRight, 116, 385, 385, 395)
gen_rectangle1 (RegionClockTrackRight, 126, 375, 385, 385)
dev_set_draw ('margin')
dev_set_color ('forest green')
dev_display (Im...",258,295,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[2] := '\'Clock track regularit..."
71004a29,micro,12,right clock track segment of the finder pattern.,"dev_clear_window ()
Message := 'We successively introduce errors along'
Message[1] := 'right clock track to demonstrate'
Message[2] := 'the effect on the grades and values for'
Message[3] := '\'Clock track regularity\' and'
Message[4] := '\'Clock track damage\'.'
disp_message (WindowHandle, Message,...",296,339,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains a..."
71004a29,micro,13,solid area of the top segment of the finder pattern.,"dev_clear_window ()
Message := 'We successively introduce errors along'
Message[1] := 'solid area on the top segment to demonstrate'
Message[2] := 'the effect on the grades and values for'
Message[3] := '\'Transition Ratio\' and \'Solid fix pattern\'.'
disp_message (WindowHandle, Message, 'window', ...",340,385,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains a..."
71004a29,micro,14,both the clock track and solid area.,"dev_clear_window ()
Message := 'The combined grade for the clock track and'
Message[1] := 'adjacent solid area for all segments of a code'
Message[2] := 'is returned by'
Message[3] := '\'Clock track and adjacent solid pattern\''
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')...",386,396,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains and demonstrates'
Message[2] := '\'Clock track regularity\','
M..."
71004a29,micro,15,"the clock track and the solid area and then painting it with gray value
0 into the image.","gen_empty_region (DefectSolidArea)
for NumModules := 1 to 5 by 2
gen_rectangle1 (Rectangle, 116, 215 + (NumModules - 1) * ModuleWidth, 125, 215 + NumModules * ModuleWidth)
concat_obj (DefectSolidArea, Rectangle, DefectSolidArea)
endfor
NumModules := 2
gen_rectangle1 (DefectClockTrack, 226, 376, NumM...",397,408,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_print_quality_01')
ModuleWidth := 10
for NumModules := 1 to 4 by 1
gen_rectangle1 (Defect, 156, 126, 156 + NumModules *..."
71004a29,micro,16,,"find_data_code_2d (ImageDefect, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)",409,411,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, Decod..."
71004a29,micro,17,,"grade_data_code_2d (DataCodeHandle, ResultHandles[0], 'isoiec15415', 'numeric', 'all', GradingResults)
IntermediateResults := GradingResults.['Intermediate Results']",412,415,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, Decod..."
71004a29,micro,18,,"dev_display (ImageDefect)
dev_set_color ('green')
dev_display (SymbolXLDs)
set_line_style (WindowHandle, [2, 4])
gen_contour_region_xld (Defect, Contours, 'border')
dev_set_color ('red')
dev_display (Contours)
set_line_style (WindowHandle, [])",416,425,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_data_code_2d (ImageScaled, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataString..."
71004a29,micro,19,grades and values for the alternating pattern.,"Message := 'A bad \'Clock track and adjacent solid pattern\''
Message[1] := 'grade as one of the contributing grades is 0.'
Message[2] := ' '
Message[3] := 'Clock track and adjacent solid pattern: ' + IntermediateResults.['Clock track and adjacent solid pattern'].Grade
disp_message (WindowHandle, Me...",426,475,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message[0] := 'This program explains and demonstrates'
grade_message_text (['Rmin', 'Rmax'], Grading..."
b21e1818,full,0,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Margin := 275
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
set_data_code_2d_param (DataCodeHandle, 'default_paramete...",6,76,
b21e1818,micro,1,,"create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",12,14,
b21e1818,micro,2,,"set_data_code_2d_param (DataCodeHandle, 'default_parameters', 'enhanced_recognition')",15,17,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
b21e1818,micro,3,,"ImageFiles := ['datacode/ecc200/ecc200_print_quality_02', 'datacode/ecc200/ecc200_disturbed_006.png']
Mode := 'reflectance_margin_module_grades'
QualityStandard := 'isoiec15415'
DisplayInfo := true",18,23,
b21e1818,micro,4,,"for I := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[I])
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandle, DecodedDataStrings)
if (|ResultHandle| &gt; 0)
get_image_size (Image, Width, Height)
dev_set_window_extents (-1, -1, Margin + Width, Height)
dev_set_part ...",24,87,"* --- Automatically Added Context ---
Margin := 275
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
ImageFiles := ['datacode/ecc200/ecc200_print_quality_02', 'datacode/ecc200..."
06f11671,full,0,"This example program shows how to find and decode ECC200 symbols
that have a very small module size....","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_cpu_001')
ZoomFactorStart := 0.8
zoom_image_factor (Image, ImageZoomed, ZoomFactorStart, ZoomFactorStart, 'constant')
dev_open_window_fit_image (ImageZoomed, 0, 0, -1, -1, WindowHandle1)
get_window_extents (WindowHandle...",18,109,
06f11671,micro,1,"'small_modules_robustness', which is set to 'low' by default, must
be set to 'high'. Additionally, t...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_cpu_001')
ZoomFactorStart := 0.8
zoom_image_factor (Image, ImageZoomed, ZoomFactorStart, ZoomFactorStart, 'constant')
dev_open_window_fit_image (ImageZoomed, 0, 0, -1, -1, WindowHandle1)",9,24,
06f11671,micro,2,,"get_window_extents (WindowHandle1, Row, Column, WidthOriginal, HeightOriginal)
dev_open_window_fit_size (0, WidthOriginal + 10, WidthOriginal, HeightOriginal, -1, -1, WindowHandle2)
dev_set_line_width (2)",25,29,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageZoomed, 0, 0, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
06f11671,micro,3,"and 'small_modules_robustness' set to 'low', respectively (set 'module_size_min' to 1).","create_data_code_2d_model ('Data Matrix ECC 200', ['small_modules_robustness', 'module_size_min'], ['high', 1], DataCodeHandle1)
create_data_code_2d_model ('Data Matrix ECC 200', ['small_modules_robustness', 'module_size_min'], ['low', 1], DataCodeHandle2)",30,34,
06f11671,micro,4,"+ In each iteration step, the image is scaled down again
+ Find the data code with 'small_modules_ro...","Size := 16
for ZoomFactor := ZoomFactorStart to 0.3 by -0.1
zoom_image_factor (Image, ImageZoomed, ZoomFactor, ZoomFactor, 'constant')
set_display_font (WindowHandle1, Size, 'mono', 'true', 'false')
set_display_font (WindowHandle2, Size, 'mono', 'true', 'false')
Size := Size - 1
find_data_code_2d (I...",35,122,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_cpu_001')
ZoomFactorStart := 0.8
zoom_image_factor (Image, ImageZoomed, ZoomFactorStart, ZoomFactorStart, 'constant')
d..."
a06904df,full,0,"***************************************************************
This example program demonstrates ho...","dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')
...",15,205,
a06904df,micro,1,,"dev_update_off ()
dev_close_window ()
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_set_color ('green')",14,24,
a06904df,micro,2,"This program demonstrates the training of a 2d data code model
and how to write the trained model in...","Message := 'This program demonstrates the training of a 2d data code'
Message[1] := 'model, how to write the trained model into a file, and'
Message[2] := 'also how to read the saved model from the file. The'
Message[3] := 'model is then used to find data codes in a sequence of'
Message[4] := 'image...",25,40,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
a06904df,micro,3,"-------------------------------------------------------
Create a 2d data code model of the 2d data c...","create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)",41,48,
a06904df,micro,4,-------------------------------------------------------,"query_data_code_2d_params (DataCodeHandle, 'get_model_params', GenParamName)
get_data_code_2d_param (DataCodeHandle, GenParamName, ModelBeforeTraining)",49,53,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
a06904df,micro,5,,"read_image (Image, 'datacode/ecc200/ecc200_cpu_007')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'train', 'all', ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
TitleMessage := 'Train on a dark image'
display_found_data_codes (SymbolXLDs, WindowHandle, Decod...",58,67,"* --- Automatically Added Context ---
read_image (Image, ImageFiles + '07')
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHa..."
a06904df,micro,6,,"read_image (Image, 'datacode/ecc200/ecc200_cpu_008')
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'train', 'all', ResultHandles, DecodedDataStrings)
dev_display (Image)
dev_display (SymbolXLDs)
TitleMessage := 'Train on a bright image'
display_found_data_codes (SymbolXLDs, WindowHandle, Dec...",68,77,"* --- Automatically Added Context ---
read_image (Image, ImageFiles + '07')
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHa..."
a06904df,micro,7,-------------------------------------------------------,"get_data_code_2d_param (DataCodeHandle, GenParamName, ModelAfterTraining)",78,81,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
query_data_code_2d_params (DataCodeHandle, 'get_model_params', GenParamName)
* --- End o..."
a06904df,micro,8,,"dev_clear_window ()
ModelAdaption := (GenParamName + ':')$'-35' + ModelBeforeTraining$'15' + ' -&gt; ' + ModelAfterTraining
disp_message (WindowHandle, 'Model parameters before and after the training:', 'window', 12, 12, 'white', 'false')
disp_message (WindowHandle, ModelAdaption, 'window', 60, 12, ...",82,89,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
query_data_code_2d_params (DataCodeHandle, 'get_model_params', GenParamName)
get_data_code_2d_param (DataC..."
a06904df,micro,9,"--------------------------------------------------------
Save the model in a file so that it can be ...","write_data_code_2d_model (DataCodeHandle, '2d_data_code_model.dcm')",90,94,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
a06904df,micro,10,,"dev_clear_window ()
Message := 'The data code model is saved in \'2d_data_code_model.dcm\'.'
Message[1] := ' '
Message[2] := 'In the next step the saved model is read and used to'
Message[3] := 'find data codes in a sequence of images.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black',...",95,104,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
Message := 'This program demonstrates the training of a 2d data code'
Message[2] := 'also how to read the ..."
a06904df,micro,11,"----------------------------------------------------------
Read the previously saved data code model","read_data_code_2d_model ('2d_data_code_model.dcm', DataCodeHandle)",105,109,"* --- Automatically Added Context ---
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
a06904df,micro,12,"-------------------------------------------------------
Search and read the data codes in each image...","for Index := 7 to 16 by 1
read_image (Image, ImageFiles + Index$'.2d')
dev_display (Image)
count_seconds (T1)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (T2)
Time := 1000 * (T2 - T1)
TitleMessage := 'Image ' + (Index - 6) + ' of ' +...",110,154,"* --- Automatically Added Context ---
ImageFiles := 'datacode/ecc200/ecc200_cpu_0'
ImageNum := 16
read_image (Image, ImageFiles + '07')
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
create_d..."
a06904df,micro,13,,"for J := 0 to |DecodedDataStrings| - 1 by 1
select_obj (SymbolXLDs, SymbolXLD, J + 1)
get_contour_xld (SymbolXLD, Row, Column)
dev_display (SymbolXLD)
get_window_extents (WindowHandle, Row1, Column1, Width, Height)
get_string_extents (WindowHandle, DecodedDataStrings[J], Ascent, Descent, TWidth, THe...",166,201,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, 'train', 'all', ResultHandles, DecodedDataStrings)
*..."
a06904df,micro,14,,"disp_message (WindowHandle, TitleMessage, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, ResultMessage, 'window', 40, 12, ColorResult, 'true')
return ()",202,219,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 570, 'black', WindowHandle)
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
TitleMessage := 'Train on a dark..."
1b77943e,full,0,"GS1 DataMatrix, GS1 QR Code, GS1 Aztec Code, and
GS1 DotCode symbology.
The symbol structure of GS1 ...","ParameterSets := []
ParameterSets := [ParameterSets,'GS1 DataMatrix', 'Data Matrix ECC 200', 'datacode/gs1datamatrix/gs1datamatrix_generated_', 'standard_recognition']
ParameterSets := [ParameterSets,'GS1 QR Code', 'QR Code', 'datacode/gs1qrcode/gs1qrcode_generated_', 'standard_recognition']
Paramet...",29,103,
1b77943e,micro,1,"and non-GS1 symbology and the decoding results are compared.
While the symbol can still be decoded a...","ParameterSets := []
ParameterSets := [ParameterSets,'GS1 DataMatrix', 'Data Matrix ECC 200', 'datacode/gs1datamatrix/gs1datamatrix_generated_', 'standard_recognition']
ParameterSets := [ParameterSets,'GS1 QR Code', 'QR Code', 'datacode/gs1qrcode/gs1qrcode_generated_', 'standard_recognition']
Paramet...",20,34,
1b77943e,micro,2,,"StatusHeight := 300
StatusWidth := 800
Scale := 1.0
ScaleInv := 1. / Scale
Colors := ['black', 'magenta', 'black', 'black', 'forest green',gen_tuple_const(10,'black')]
NumImages := 3
NumParams := 4
FNC1Separator := '\x1D'",35,44,
1b77943e,micro,3,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 360, 256, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('green')
dev_set_line_width (3)
for ParameterSetIndex := 0 to |ParameterSets| - NumParams by NumParams
GS1...",45,110,"* --- Automatically Added Context ---
ParameterSets := []
StatusHeight := 300
StatusWidth := 800
Scale := 1.0
ScaleInv := 1. / Scale
Colors := ['black', 'magenta', 'black', 'black', 'forest green',gen..."
79cc66f1,full,0,"------------------------
EXAMPLE DESCRIPTION
------------------------
This program is a template and...","dev_close_window ()
dev_update_off ()
Offline := true
InterfaceName := 'USB3Vision'
EXPSTEP := 0.05
MAXSTEPS := 5
IncreaseLight := 0
ReflectanceCalibFile := 'reflectance_cam_par.dat'
CodeType := 'Data Matrix ECC 200'
ReflectanceCalibResultsNames := ['A', 'MLCal', 'Rcal', 'SRexp', 'SRgain']
if (Offli...",53,510,
79cc66f1,micro,1,"between 0.70 and 0.86. It represents the mean gray value of the
centers of the light symbols' module...","dev_close_window ()
dev_update_off ()",42,55,
79cc66f1,micro,2,"PLEASE ADAPT THESE VARIABLES TO YOUR APPLICATION
---------------------------------------------------...",Offline := true,56,60,
79cc66f1,micro,3,,InterfaceName := 'USB3Vision',61,63,
79cc66f1,micro,4,,EXPSTEP := 0.05,64,66,
79cc66f1,micro,5,"adjusting the exposure time,i.e., if MAXSTEPS is 3,
the amplification factor (gain) will be decrease...",MAXSTEPS := 5,67,72,
79cc66f1,micro,6,"The value of this variable signalizes how the
system should be adjusted in the next step. If the val...",IncreaseLight := 0,73,82,
79cc66f1,micro,7,reflectance calibration.,ReflectanceCalibFile := 'reflectance_cam_par.dat',83,86,
79cc66f1,micro,8,,"CodeType := 'Data Matrix ECC 200'
ReflectanceCalibResultsNames := ['A', 'MLCal', 'Rcal', 'SRexp', 'SRgain']
if (Offline == false)
read_reflectance_calib_file (ReflectanceCalibFile, ReflectanceCalibResultsValues)
else
A := 5.5
MLCal := 180
Rcal := 199
SRexp := 75
SRgain := 1
ReflectanceCalibResultsVa...",87,118,"* --- Automatically Added Context ---
Offline := true
InterfaceName := 'USB3Vision'
ReflectanceCalibFile := 'reflectance_cam_par.dat'
* --- End of Automatically Added Context ---"
79cc66f1,micro,9,,"dev_open_window_fit_image (Image, 0, 0, 700, 500, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",119,121,"* --- Automatically Added Context ---
grab_image_async (Image, AcqHandle, -1)
* --- End of Automatically Added Context ---"
79cc66f1,micro,10,,"if (Offline)
read_image (Image, 'datacode/ecc200/ecc200_quality_aimdpm_01')
dev_display (Image)
disp_message (WindowHandle, ['Position the code symbol under the camera', 'and adjust aperture and focus', 'OFFLINE MODE'], 'window', 10, 10, 'black', 'true')
wait_seconds (1)
else
Button := 0
while (Butt...",122,144,"* --- Automatically Added Context ---
Offline := true
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', '1', -1, -1, AcqHandle)
grab_image_async (..."
79cc66f1,micro,11,,"create_data_code_2d_model (CodeType, 'polarity', 'any', DataCodeHandle)
AdjustParams := []
Rtarget := 0
AdjustmentImpossible := false
while (true)
if (Offline)
read_image (Image, 'datacode/ecc200/ecc200_quality_aimdpm_' + IndIm$'02')
IndIm := IndIm + 1
else
adjust_system_response (AcqHandle, Increas...",145,220,"* --- Automatically Added Context ---
Offline := true
EXPSTEP := 0.05
MAXSTEPS := 5
IncreaseLight := 0
CodeType := 'Data Matrix ECC 200'
read_reflectance_calib_file (ReflectanceCalibFile, ReflectanceC..."
79cc66f1,micro,12,"Check if Rtarget is in the correct range
and set the corresponding value of the grade","if (not AdjustmentImpossible)
if (Rtarget &gt; 0.05)
Grade := 1
disp_message (WindowHandle, 'The quality grades of the 2d data code symbol:', 'window', 10, 10, 'black', 'true')
Color := []
Message := []
MessageValues := []
get_data_code_2d_results (DataCodeHandle, ResultHandles[0], 'quality_aimdpm_1...",221,276,"* --- Automatically Added Context ---
Offline := true
SRexp := 75
SRgain := 1
dev_open_window_fit_image (Image, 0, 0, 700, 500, WindowHandle)
create_data_code_2d_model (CodeType, 'polarity', 'any', Da..."
79cc66f1,micro,13,,"if (Offline == false)
close_framegrabber (AcqHandle)
endif
tuple_strchr (FileLine, '\n', PosNewLine)
if (PosNewLine &gt; 0)
tuple_str_first_n (FileLine, PosNewLine - 1, FileLine)
endif
tuple_regexp_match (FileLine, '([-+]?[0-9]*[\\.]?[0-9]+(?:[eE][-+]?[0-9]+)?$)', Matches)
if (strlen(Matches) &gt; 0...",277,373,"* --- Automatically Added Context ---
Offline := true
ReflectanceCalibFile := 'reflectance_cam_par.dat'
read_reflectance_calib_file (ReflectanceCalibFile, ReflectanceCalibResultsValues)
A := 5.5
MLCal..."
79cc66f1,micro,14,"steps (NumExpSteps) and direction of the incrementation in the
last call (LastIncr)","if (|LastAdjustParams| &gt; 0)
NumExpSteps := LastAdjustParams[0]
LastIncr := LastAdjustParams[1]
else
NumExpSteps := 0
LastIncr := 0
endif",411,423,
79cc66f1,micro,15,,"get_framegrabber_param (AcqHandle, 'ExposureTime_range', ExposureRange)
MinExp := ExposureRange[0]
MaxExp := ExposureRange[1]
get_framegrabber_param (AcqHandle, 'Gain_range', GainRange)
MinGain := GainRange[0]
MaxGain := GainRange[1]",424,431,"* --- Automatically Added Context ---
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', '1', -1, -1, AcqHandle)
* --- End of Automatically Added C..."
79cc66f1,micro,16,,"get_framegrabber_param (AcqHandle, 'Gain', GainValue)
get_framegrabber_param (AcqHandle, 'ExposureTime', ExposureValue)
if (IncreaseLight == 0)
NewAdjustParams := [0, 0]
AdjustmentImpossible := false
return ()
endif
if (LastIncr != IncreaseLight)
NumExpSteps := 0
endif",432,448,"* --- Automatically Added Context ---
IncreaseLight := 0
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', '1', -1, -1, AcqHandle)
set_framegrabbe..."
79cc66f1,micro,17,appears to be true,"AdjustmentImpossible := false
if (IncreaseLight == -1)
if ((ExposureValue - EXPSTEP * MaxExp) &lt; MinExp)
NumExpSteps := MAXSTEPS
endif
if ((NumExpSteps &gt;= MAXSTEPS) and (GainValue - 2 &gt;= MinGain))
GainValue := GainValue - 2
set_framegrabber_param (AcqHandle, 'Gain', GainValue)
NumExpSteps :=...",449,505,"* --- Automatically Added Context ---
EXPSTEP := 0.05
MAXSTEPS := 5
IncreaseLight := 0
open_framegrabber (InterfaceName, 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', '1', -1, ..."
79cc66f1,micro,18,LastAdjustParams in the next call of adjust_system_response,"NewAdjustParams := [NumExpSteps,IncreaseLight]
return ()",506,553,"* --- Automatically Added Context ---
IncreaseLight := 0
NumExpSteps := LastAdjustParams[0]
if (|LastAdjustParams| &gt; 0)
NewAdjustParams := [0, 0]
* --- End of Automatically Added Context ---"
6e10703b,full,0,"***************************************************************
Example program that demonstrates ho...","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_reflectance_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program demonstrates how to set a calibrated maximum re...",14,88,
6e10703b,micro,1,"1D symbols is the same.
****************************************************************","dev_update_off ()
dev_close_window ()
read_image (Image, 'datacode/ecc200/ecc200_reflectance_reference')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program demonstrates how to set a calibrated maximum re...",11,50,
6e10703b,micro,2,reference value.,"read_image (ImageWhite, 'datacode/ecc200/ecc200_reflectance_reference_calib')",51,54,
6e10703b,micro,3,,"gen_circle (Circle, 2, 2, 1)
mean_image_shape (ImageWhite, Circle, ImageMean)
Message := 'For example, use a calibration card to obtain a value for the maximum'
Message[1] := 'reflectance.'
Message[2] := 'The standards suggest to use barium sulphate or magnesium oxide'
Message[3] := 'samples.'
Messa...",55,71,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'This program demonstrates how to set a calibrated maximum reflectance'
Message[2] := 'Th..."
6e10703b,micro,4,reference value.,"gray_features (ImageMean, ImageMean, 'max', MaxValue)
set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_reflectance_reference', MaxValue)
find_data_code_2d (Image, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
grade_data_code_2d (DataCodeHandle, ResultHandles[0], ...",72,94,"* --- Automatically Added Context ---
read_image (Image, 'datacode/ecc200/ecc200_reflectance_reference')
Message := 'This program demonstrates how to set a calibrated maximum reflectance'
QualityGrade..."
e51d6a2a,full,0,"****************************************************************
Example program that demonstrates h...","dev_update_off ()
dev_close_window ()
read_image (ImageCalibration, 'datacode/ecc200/pqi_smallest_module_size_calplate')
dev_disp_introduction (ImageCalibration, WindowHandle, Message)
stop ()
gen_cam_par_area_scan_division (0.016, 0, 3.4e-7, 3.4e-7, 2592 / 2, 1944 / 2, 2592, 1944, CameraParam)
CalP...",12,152,
e51d6a2a,micro,1,"Example program that demonstrates how to set the minimum module
size for ISO/IEC 15415 print quality...","dev_update_off ()
dev_close_window ()
read_image (ImageCalibration, 'datacode/ecc200/pqi_smallest_module_size_calplate')
dev_disp_introduction (ImageCalibration, WindowHandle, Message)
stop ()",6,17,
e51d6a2a,micro,2,"in millimeters. In order to transform this size to pixels,
perform a single image camera calibration...","gen_cam_par_area_scan_division (0.016, 0, 3.4e-7, 3.4e-7, 2592 / 2, 1944 / 2, 2592, 1944, CameraParam)
CalPlateDescr := 'calplate_80mm.cpd'
create_calib_data ('calibration_object', 1, 1, CalibDataID)
set_calib_data_calib_object (CalibDataID, 0, CalPlateDescr)
set_calib_data_cam_param (CalibDataID, 0...",18,32,"* --- Automatically Added Context ---
read_image (ImageCalibration, 'datacode/ecc200/pqi_smallest_module_size_calplate')
* --- End of Automatically Added Context ---"
e51d6a2a,micro,3,known to be 0.5 millimeters.,X := 0.0005,33,35,
e51d6a2a,micro,4,"points onto the plane of the calibration object with a distance
of X and extracting that distance in...","project_3d_point (CalibratedPose[0], CalibratedPose[1], CalibratedPose[2], CalibratedParam, Row1, Column1)
project_3d_point (CalibratedPose[0] + X, CalibratedPose[1], CalibratedPose[2], CalibratedParam, Row2, Column2)
distance_pp (Row1, Column1, Row2, Column2, ModuleSizeInPx)
dev_display (ImageCalib...",36,47,"* --- Automatically Added Context ---
read_image (ImageCalibration, 'datacode/ecc200/pqi_smallest_module_size_calplate')
dev_disp_introduction (ImageCalibration, WindowHandle, Message)
CalPlateDescr :..."
e51d6a2a,micro,5,,"read_image (ImageReflectanceReference, 'datacode/ecc200/pqi_smallest_module_size_reflectance')",48,49,
e51d6a2a,micro,6,,"gen_circle (Circle, 2, 2, 1)
mean_image_shape (ImageReflectanceReference, Circle, ImageMean)
min_max_gray (ImageMean, ImageMean, 0, Min, ReflectanceReference, Range)
Message := 'Calibrate the reflectance with an appropriate calibration target.'
Message[|Message|] := ''
Message[|Message|] := 'Reflect...",50,64,"* --- Automatically Added Context ---
dev_disp_introduction (ImageCalibration, WindowHandle, Message)
read_image (ImageReflectanceReference, 'datacode/ecc200/pqi_smallest_module_size_reflectance')
* -..."
e51d6a2a,micro,7,"percentage of this minimum module size. Usually 80% is used
(which is also the default).
Note that b...","set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_smallest_module_size', ModuleSizeInPx)
set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_aperture_size', 0.8)",65,73,"* --- Automatically Added Context ---
distance_pp (Row1, Column1, Row2, Column2, ModuleSizeInPx)
create_data_code_2d_model ('Data Matrix ECC 200', [], [], DataCodeHandle)
* --- End of Automatically Ad..."
e51d6a2a,micro,8,grade the code.,"set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_reflectance_reference', ReflectanceReference)
set_data_code_2d_param (DataCodeHandle, 'quality_isoiec15415_decode_algorithm', 'reference')
grade_data_code_2d (DataCodeHandle, ResultHandles[0], 'isoiec15415', 'numeric', 'grades', GradingRes...",74,163,"* --- Automatically Added Context ---
read_image (ImageCalibration, 'datacode/ecc200/pqi_smallest_module_size_calplate')
dev_disp_introduction (ImageCalibration, WindowHandle, Message)
X := 0.0005
dis..."
3653a9fb,full,0,"This programs shows the robustness of the QR Code reader with
respect to slight perspective distorti...","dev_update_off ()
read_image (Image, 'datacode/qrcode/qr_version_25')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)
cr...",15,465,
3653a9fb,micro,1,"respect to slight perspective distortions and local deformations
when dealing with large codes. For ...","dev_update_off ()
read_image (Image, 'datacode/qrcode/qr_version_25')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_line_width (3)",6,24,
3653a9fb,micro,2,,"create_data_code_2d_model ('QR Code', [], [], DataCodeHandle)
set_data_code_2d_param (DataCodeHandle, 'polarity', 'dark_on_light')",25,28,
3653a9fb,micro,3,,"dev_clear_window ()
disp_message (WindowHandle, 'Find QR Code with perspective distortions', 'window', 12, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
AmpPersp := 50
AmpDeform := 0
AmpNoise := 50
find_deformed_codes (Image, AmpPersp, AmpDeform, AmpNoise, DataC...",29,39,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_data_code_2d_model ('QR Code', [], [], Da..."
3653a9fb,micro,4,,"dev_clear_window ()
disp_message (WindowHandle, 'Find QR Code with local deformations', 'window', 12, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
AmpPersp := 0
AmpDeform := 50
AmpNoise := 50
find_deformed_codes (Image, AmpPersp, AmpDeform, AmpNoise, DataCodeHa...",40,51,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_data_code_2d_model ('QR Code', [], [], Da..."
3653a9fb,micro,5,,"dev_clear_window ()
disp_message (WindowHandle, ['Find QR Code with perspective distortions', 'and local deformations'], 'window', 12, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
AmpPersp := 50
AmpDeform := 50
AmpNoise := 50
find_deformed_codes (Image, AmpPers...",52,83,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_data_code_2d_model ('QR Code', [], [], Da..."
3653a9fb,micro,6,,"vector_to_proj_hom_mat2d ([0, 0,Height - 1,Height - 1], [0,Width - 1,Width - 1,0], [0, 0,Height - 1,Height - 1] + (rand(4) - 0.5) * AmpPersp, [0,Width - 1,Width - 1,0] + (rand(4) - 0.5) * AmpPersp, 'normalized_dlt', [], [], [], [], [], [], HomMat2D, Covariance)
HomMat2D := HomMat2D / HomMat2D[8]",86,89,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
AmpPersp := 50
* --- End of Automatically Added Context ---"
3653a9fb,micro,7,,"gen_random_vector_field (VectorField, Width, Height, AmpDeform, 2.5)
vector_field_to_real (VectorField, VFRow, VFCol)
return ()",90,195,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
AmpDeform := 0
* --- End of Automatically Added Context ---"
3653a9fb,micro,8,,"gen_image_proto (Image, ImageCleared, 224)
get_image_size (Image, Width, Height)",196,199,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
3653a9fb,micro,9,,"HomMat2DInt := HomMat2DFrom + T * (HomMat2DTo - HomMat2DFrom)
projective_trans_image (Image, ImageProjTrans, HomMat2DInt, 'bilinear', 'false', 'false')
concat_obj (ImageCleared, ImageProjTrans, ObjectsConcat)
tile_images_offset (ObjectsConcat, ImageDistPersp, [0, 0], [0, 0], [-1, -1], [-1, -1], [-1,...",200,205,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
get_image_size (Image, Width, Height)
gen_image_proto (Image, ImageCleared, 224)
* --- End of Automatically Ad..."
3653a9fb,micro,10,,"scale_image (VFFromRow, VFFromRowInt, 1.0 - T, 0)
scale_image (VFFromCol, VFFromColInt, 1.0 - T, 0)
scale_image (VFToRow, VFToRowInt, T, 0)
scale_image (VFToCol, VFToColInt, T, 0)
add_image (VFFromRowInt, VFToRowInt, VFRowInt, 1.0, 0)
add_image (VFFromColInt, VFToColInt, VFColInt, 1.0, 0)
real_to_ve...",206,215,"* --- Automatically Added Context ---
tile_images_offset (ObjectsConcat, ImageDistPersp, [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], Width, Height)
* --- End of Automatically Added Context..."
3653a9fb,micro,11,,"add_noise_white (ImageDistDeform, ImageDistorted, AmpNoise)
return ()
WidthVec := 16
HeightVec := 16
gen_image_const (VectorField, 'vector_field', WidthVec, HeightVec)
vector_field_to_real (VectorField, VecRow, VecCol)
if (MaxDeform &gt; 0.0)
for R := 0 to HeightVec - 1 by 1
for C := 0 to WidthVec -...",216,436,"* --- Automatically Added Context ---
AmpNoise := 50
gen_random_vector_field (VectorField, Width, Height, AmpDeform, 2.5)
get_image_size (Image, Width, Height)
unwarp_image_vector_field (ImageDistPers..."
3653a9fb,micro,12,,"get_image_size (Image, Width, Height)
gen_random_distortions (VFFromRow, VFFromCol, 0, 0, Width, Height, HomMat2DFrom)
for Iter := 1 to 10 by 1
gen_random_distortions (VFToRow, VFToCol, AmpPersp, AmpDeform, Width, Height, HomMat2DTo)
for T := 0.0 to 1.0 by 0.05
apply_random_distortions (Image, VFFro...",437,478,"* --- Automatically Added Context ---
read_image (Image, 'datacode/qrcode/qr_version_25')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_data_code_2d_model ('QR Code', [], [], Da..."
d6768742,full,0,"This program creates artificial QR codes
with common problems such as a low resolution,
horizontal/v...","dev_update_off ()
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_close_window ()
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
get_window_param (WindowHandle, 'flush', Flush)
set_window_param (...",12,291,
d6768742,micro,1,,"dev_update_off ()
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_close_window ()
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
get_window_param (WindowHandle, 'flush', Flush)
set_window_param (...",11,22,
d6768742,micro,2,,"dev_display (QRCodeImageNoise)
Text := 'This program creates and reads artificial QR codes'
Text[1] := 'with common problems:'
Text[2] := ''
Text[3] := '1. Low resolution'
Text[4] := '2. Horizontal/vertical deformations'
Text[5] := '3. Blur'
Text[6] := '4. Print loss/growth'
dev_disp_text (Text, 'wi...",23,39,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
* --- End of Automatica..."
d6768742,micro,3,,"set_data_code_2d_param (DataCodeHandle, 'module_size_min', 2)
set_data_code_2d_param (DataCodeHandle, 'small_modules_robustness', 'high')",40,43,"* --- Automatically Added Context ---
create_data_code_2d_model ('QR Code', [], [], DataCodeHandle)
* --- End of Automatically Added Context ---"
d6768742,micro,4,,"Zoom := [1, 0.5, 0.3, 0.15, 0.14, 0.13, 0.12, 0.11]
for Index := 0 to |Zoom| - 1 by 1
zoom_image_factor (QRCodeImageNoise, ImageZoomed, Zoom[Index], Zoom[Index], 'weighted')
count_seconds (Start)
find_data_code_2d (ImageZoomed, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
c...",44,67,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
Text[3] := '1. Low reso..."
d6768742,micro,5,,"get_image_size (QRCodeImage, QRCodeWidth, QRCodeHeight)",68,70,"* --- Automatically Added Context ---
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
* --- End of Automatically Added Context ---"
d6768742,micro,6,,"Distortion := 7
Position := [5:60]
Position := [Position,inverse(Position)]",71,74,
d6768742,micro,7,,"for Mode := 0 to 2 by 1
for Index := 0 to |Position| - 1 by 1
distort_qrcode (QRCodeImage, QRCodeImageDeform, Position[Index], QRCodeWidth, QRCodeHeight, Mode, Distortion)
gen_image_noisy_qrcode (QRCodeImageDeform, QRCodeImageDeformNoise, 40, 42 + Mode * |Position| + Index)
count_seconds (Start)
fin...",75,98,"* --- Automatically Added Context ---
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
Text[4] := '2. Horizontal/ver..."
d6768742,micro,8,,"Blur := [7:2:17]
for Index := 0 to |Blur| - 1 by 1
mean_image (QRCodeImageNoise, ImageMean, Blur[Index], Blur[Index])
count_seconds (Start)
find_data_code_2d (ImageMean, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (End)
Time := ((End - Start) * 1000)$'.2f' + ...",99,121,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
Text[5] := '3. Blur'
cr..."
d6768742,micro,9,,"PrintLoss := [1:0.5:11]
for Index := 0 to |PrintLoss| - 1 by 1
gray_dilation_shape (QRCodeImageNoise, ImageMax, PrintLoss[Index], PrintLoss[Index], 'octagon')
count_seconds (Start)
find_data_code_2d (ImageMax, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_seconds (End)...",122,144,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
Text[6] := '4. Print lo..."
d6768742,micro,10,,"PrintGrowth := [1:0.5:11]
for Index := 0 to |PrintGrowth| - 1 by 1
gray_erosion_shape (QRCodeImageNoise, ImageMin, PrintGrowth[Index], PrintGrowth[Index], 'octagon')
count_seconds (Start)
find_data_code_2d (ImageMin, SymbolXLDs, DataCodeHandle, [], [], ResultHandles, DecodedDataStrings)
count_second...",145,161,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
Text[6] := '4. Print lo..."
d6768742,micro,11,,"set_window_param (WindowHandle, 'flush', Flush)",162,182,"* --- Automatically Added Context ---
dev_open_window_fit_image (QRCodeImageNoise, 0, 0, 1024, 768, WindowHandle)
get_window_param (WindowHandle, 'flush', Flush)
* --- End of Automatically Added Conte..."
d6768742,micro,12,,hom_mat2d_identity (HomMat2DIdentity),183,184,
d6768742,micro,13,,"hom_mat2d_translate_local (HomMat2DIdentity, 60, 160, HomMat2DTranslate)
affine_trans_image_size (QRCodeImage, ImageAffineTrans, HomMat2DTranslate, 'constant', 640, 480)
full_domain (ImageAffineTrans, QRCodeImageNoise)",185,189,"* --- Automatically Added Context ---
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
hom_mat2d_identity (HomMat2DIdentity)
* --..."
d6768742,micro,14,,"difference (QRCodeImageNoise, ImageAffineTrans, Rest)",190,191,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
affine_trans_image_size (QRCodeImage, ImageAffineTrans, HomMat2DTranslate, 'constant', 640, 480)
* ..."
d6768742,micro,15,,"overpaint_region (QRCodeImageNoise, Rest, 255, 'fill')",192,193,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
difference (QRCodeImageNoise, ImageAffineTrans, Rest)
* --- End of Automatically Added Context ---"
d6768742,micro,16,,"gauss_filter (QRCodeImageNoise, ImageGauss, 7)",194,195,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
* --- End of Automatically Added Context ---"
d6768742,micro,17,,"set_system ('seed_rand', SeedRand)
add_noise_white (ImageGauss, ImageNoise, Noise)",196,198,"* --- Automatically Added Context ---
gauss_filter (QRCodeImageNoise, ImageGauss, 7)
* --- End of Automatically Added Context ---"
d6768742,micro,18,,"scale_image (ImageNoise, QRCodeImageNoise, 0.6, 0.2)
return ()",199,250,"* --- Automatically Added Context ---
gen_image_noisy_qrcode (QRCodeImage, QRCodeImageNoise, 40, 42)
add_noise_white (ImageGauss, ImageNoise, Noise)
* --- End of Automatically Added Context ---"
d6768742,micro,19,,"WidthVectorField := 64
HeightVectorField := 64
gen_image_const (VectorField, 'vector_field', WidthVectorField, HeightVectorField)
vector_field_to_real (VectorField, VectorFieldRow, VectorFieldColumn)
for Row := 0 to HeightVectorField - 1 by 1
ColumnIndices := [0:WidthVectorField - 1]
Values := 20 * ...",251,282,"* --- Automatically Added Context ---
Distortion := 7
Position := [5:60]
for Mode := 0 to 2 by 1
* --- End of Automatically Added Context ---"
d6768742,micro,20,,"derivate_gauss (VectorFieldRow, VectorFieldRow, 2.5, 'none')
derivate_gauss (VectorFieldColumn, VectorFieldColumn, 2.5, 'none')
zoom_image_size (VectorFieldRow, VectorFieldRowOrigin, QRCodeWidth, QRCodeHeight, 'weighted')
zoom_image_size (VectorFieldColumn, VectorFieldColumnOrigin, QRCodeWidth, QRCo...",283,359,"* --- Automatically Added Context ---
read_image (QRCodeImage, 'datacode/qrcode/qr_generated')
get_image_size (QRCodeImage, QRCodeWidth, QRCodeHeight)
distort_qrcode (QRCodeImage, QRCodeImageDeform, P..."
2f3d5c60,full,0,This example demonstrates how to use the operator get_grayval_contour_xld.,"read_image (Image, 'fabrik')
StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
SamplingPoints := 200.0
RowInc := (EndRow - StartRow) / (SamplingPoints - 1)
ColumnInc := (EndColumn - StartColumn) / (SamplingPoints - 1)
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc...",8,50,
2f3d5c60,micro,1,,"read_image (Image, 'fabrik')",6,9,
2f3d5c60,micro,2,,"StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
SamplingPoints := 200.0
RowInc := (EndRow - StartRow) / (SamplingPoints - 1)
ColumnInc := (EndColumn - StartColumn) / (SamplingPoints - 1)
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:EndColumn]",10,20,
2f3d5c60,micro,3,,"gen_contour_polygon_xld (Contour, Rows, Columns)",21,23,"* --- Automatically Added Context ---
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:EndColumn]
StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
RowInc := (EndRow ..."
2f3d5c60,micro,4,,"get_grayval_contour_xld (Image, Contour, 'bilinear', Grayval)",24,26,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
gen_contour_polygon_xld (Contour, Rows, Columns)
* --- End of Automatically Added Context ---"
2f3d5c60,micro,5,,"create_funct_1d_array (Grayval, Function)
local_min_max_funct_1d (Function, 'strict_min_max', 'false', Min, Max)
NumberOfHoles := |Min|",27,31,"* --- Automatically Added Context ---
get_grayval_contour_xld (Image, Contour, 'bilinear', Grayval)
* --- End of Automatically Added Context ---"
2f3d5c60,micro,6,,"GrayvalPointsY := EndRow + 10 - Grayval / 10.0
gen_contour_polygon_xld (GrayValueGraph, GrayvalPointsY, Columns)
gen_cross_contour_xld (Holes, subset(Rows,Min), subset(Columns,Min), 2, 0.785398)
gen_cross_contour_xld (Minima, subset(GrayvalPointsY,Min), subset(Columns,Min), 1, 0.0)
dev_close_window ...",32,56,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:..."
2ab811e3,full,0,This example demonstrates how to use the operator get_grayval_contour_xld.,"read_image (Image, 'fabrik')
StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
SamplingPoints := 200.0
RowInc := (EndRow - StartRow) / (SamplingPoints - 1)
ColumnInc := (EndColumn - StartColumn) / (SamplingPoints - 1)
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc...",8,49,
2ab811e3,micro,1,,"read_image (Image, 'fabrik')",6,9,
2ab811e3,micro,2,,"StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
SamplingPoints := 200.0
RowInc := (EndRow - StartRow) / (SamplingPoints - 1)
ColumnInc := (EndColumn - StartColumn) / (SamplingPoints - 1)
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:EndColumn]",10,20,
2ab811e3,micro,3,,"get_grayval_interpolated (Image, Rows, Columns, 'bilinear', Grayval)",21,23,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:EndColumn]
StartRow := 345
StartColumn := 281
EndRow := 404
EndCol..."
2ab811e3,micro,4,,"create_funct_1d_array (Grayval, Function)
local_min_max_funct_1d (Function, 'strict_min_max', 'false', Min, Max)
NumberOfHoles := |Min|",24,28,"* --- Automatically Added Context ---
get_grayval_interpolated (Image, Rows, Columns, 'bilinear', Grayval)
* --- End of Automatically Added Context ---"
2ab811e3,micro,5,,"GrayvalPointsY := EndRow + 10 - Grayval / 10.0
gen_contour_polygon_xld (GrayValueGraph, GrayvalPointsY, Columns)
gen_cross_contour_xld (Points, Rows, Columns, 0.5, 0.785398)
gen_cross_contour_xld (Holes, subset(Rows,Min), subset(Columns,Min), 2, 0.785398)
gen_cross_contour_xld (Minima, subset(Grayva...",29,55,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
StartRow := 345
StartColumn := 281
EndRow := 404
EndColumn := 350
Rows := [StartRow:RowInc:EndRow]
Columns := [StartColumn:ColumnInc:..."
a419327b,full,0,"This example program shows how to use gen_image_interleaved.  It performs
various transformations of...","read_image (Image, 'claudia')
rgb3_to_interleaved (Image, ImageInterleaved)
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 3, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height, Width / 3)
gen_image_interleaved (BImage...",11,99,
a419327b,micro,1,,"read_image (Image, 'claudia')
rgb3_to_interleaved (Image, ImageInterleaved)
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 3, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height, Width / 3)",10,18,
a419327b,micro,2,,"gen_image_interleaved (BImageRGB1, Pointer, 'rgb', Width / 3, Height, -1, 'byte', 0, 0, 0, 0, -1, 0)
stop ()",19,22,"* --- Automatically Added Context ---
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
* --- End of Automatically Added Context ---"
a419327b,micro,3,,"gen_image_interleaved (BImageRGB2, Pointer, 'rgb', Width / 3, Height, -1, 'byte', Width / 6, Height / 2, 0, Width / 12, -1, 0)
stop ()",23,26,"* --- Automatically Added Context ---
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
* --- End of Automatically Added Context ---"
a419327b,micro,4,"red and blue channels are swapped. Therefore, applying gen_image_interleaved
on an image matrix with...","gen_image_interleaved (BImageBGR1, Pointer, 'bgr', Width / 3, Height, -1, 'byte', 0, 0, 0, 0, -1, 0)
stop ()",27,32,"* --- Automatically Added Context ---
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
* --- End of Automatically Added Context ---"
a419327b,micro,5,,"gen_image_interleaved (UImageRGB1, Pointer, 'rgb', Width / 3, Height, -1, 'uint2', 0, 0, 0, 0, -1, 0)
stop ()",33,36,"* --- Automatically Added Context ---
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
* --- End of Automatically Added Context ---"
a419327b,micro,6,this affects the ColorFormat parameter.,"convert_image_type (ImageInterleaved, ImageConverted, 'uint2')
scale_image (ImageConverted, ImageConverted, 64, 0)
get_image_pointer1 (ImageConverted, UPointer, UTypeRGB, UWidth, UHeight)
gen_image_interleaved (UImageRGB2, UPointer, 'rgb48', UWidth / 3, UHeight, -1, 'uint2', 0, 0, 0, 0, -1, 0)
stop ...",37,44,"* --- Automatically Added Context ---
rgb3_to_interleaved (Image, ImageInterleaved)
* --- End of Automatically Added Context ---"
a419327b,micro,7,"However, the difference between UImageRGB2 and UImageRGB3 is only visible
in the gray histogram but ...","gen_image_interleaved (UImageRGB3, UPointer, 'rgb48', UWidth / 3, UHeight, -1, 'uint2', 0, 0, 0, 0, -1, 6)
stop ()",45,51,"* --- Automatically Added Context ---
get_image_pointer1 (ImageConverted, UPointer, UTypeRGB, UWidth, UHeight)
* --- End of Automatically Added Context ---"
a419327b,micro,8,matrix cannot be stored in a byte image.,"gen_image_interleaved (ErrorImage, UPointer, 'rgb48', UWidth / 3, UHeight, -1, 'byte', 0, 0, 0, 0, -1, 0)",52,55,"* --- Automatically Added Context ---
get_image_pointer1 (ImageConverted, UPointer, UTypeRGB, UWidth, UHeight)
* --- End of Automatically Added Context ---"
a419327b,micro,9,,"gen_image_interleaved (ErrorImage, Pointer, 'rgb', Width / 3, Height, -1, 'byte', Width / 3, Height, 16, 16, -1, 0)
get_image_pointer3 (ImageRGB, PointerRed, PointerGreen, PointerBlue, Type, Width, Height)
gen_image_const (ImageInterleaved, 'byte', Width * 3, Height)
hom_mat2d_identity (HomMat2DIden...",56,83,"* --- Automatically Added Context ---
rgb3_to_interleaved (Image, ImageInterleaved)
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
gen_image_interleaved (ErrorImage, UPointer, ..."
a419327b,micro,10,"cannot be displayed by HDevelop.Trying to display one of these images results in the
error message '...","reduce_domain (ImageRed, RegionClipped, ImageRed)
move_region (RegionGrid, RegionMoved, -1, 1)
clip_region (RegionMoved, RegionClipped, 0, 0, Height - 1, (3 * Width) - 1)
reduce_domain (ImageGreen, RegionClipped, ImageGreen)
move_region (RegionGrid, RegionMoved, -1, 2)
clip_region (RegionMoved, Regi...",84,109,"* --- Automatically Added Context ---
rgb3_to_interleaved (Image, ImageInterleaved)
get_image_pointer1 (ImageInterleaved, Pointer, TypeRGB, Width, Height)
decompose3 (ImageAffineTrans, ImageRed, Image..."
bd569955,full,0,"This program checks the accuracy of the gray value features that are
returned by area_center_gray.  ...","dev_update_off ()
Size := 512
Radius := 32 * 3
ScaleFactor := 1. / 32.
Foreground := 200
gen_image_const (Image, 'byte', Size, Size)
dev_close_window ()
dev_open_window (0, 0, Size, Size, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_s...",20,76,
bd569955,micro,1,"returned by area_center_gray.  This is done by comparing the results
of the output of the correspond...","dev_update_off ()
Size := 512
Radius := 32 * 3
ScaleFactor := 1. / 32.
Foreground := 200
gen_image_const (Image, 'byte', Size, Size)
dev_close_window ()
dev_open_window (0, 0, Size, Size, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_s...",6,82,
88f0754b,full,0,Calculate a co-occurrence matrix and derive gray value features thereof,"read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
cooc_feature_imag...",8,18,
88f0754b,micro,1,,"read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')",6,13,
88f0754b,micro,2,,"gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
cooc_feature_image (Rectangle1, Image, 6, 0, Energy1, Correlation1, Homogenity1, Contrast1)
cooc_feature_image (Rectangle2, Image, 6, 0, Energy2, Correlation2, Homogenity2, Contrast2)",14,24,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
08fce4dd,full,0,"This example shows how to calculate co-occurrence matrices
from given image regions and how to deriv...","dev_update_off ()
read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
CoocWinSize := 320
Border := 10
dev_open_window (0, CoocWinSize + Border, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_dra...",9,84,
08fce4dd,micro,1,"from given image regions and how to derive gray value features
from these co-occurrence matrices.",dev_update_off (),6,10,
08fce4dd,micro,2,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
CoocWinSize := 320
Border := 10
dev_open_window (0, CoocWinSize + Border, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_draw ('margin')
dev_s...",11,36,
08fce4dd,micro,3,,"gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
inner_circle (Rectangle1, Row1, Column1, Radius1)
inner_circle (Rectangle2, Row2, Column2, Radius2)",37,42,
08fce4dd,micro,4,,"for Direction := 0 to 135 by 45
gen_cooc_matrix (Rectangle1, Image, Matrix1, 6, Direction)
gen_cooc_matrix (Rectangle2, Image, Matrix2, 6, Direction)
cooc_feature_matrix (Matrix1, Energy1, Correlation1, Homogeneity1, Contrast1)
cooc_feature_matrix (Matrix2, Energy2, Correlation2, Homogeneity2, Contr...",43,90,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, CoocWinSize + Border, Width, Height, 'black', WindowID)
dev_open_window (Height - CoocWinSize, 0, CoocWinSize, Coo..."
0b81a985,full,0,,"dev_update_off ()
Size := 512
Radius1 := 32 * 3
Radius2 := 32 * 2
ScaleFactor := 1. / 32.
Foreground := 200
gen_image_const (Image, 'byte', Size, Size)
dev_close_window ()
dev_open_window (0, 0, Size, Size, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_d...",6,64,
0b81a985,micro,1,,"DiffPhiRegionZoomed := fmod((PhisRegion - PhisZoomed) * 180. / 3.14,180.0)
DiffRaRegionZoomed := (RasRegion - RasZoomed) * ScaleFactor
DiffRbRegionZoomed := (RbsRegion - RbsZoomed) * ScaleFactor",61,70,"* --- Automatically Added Context ---
ScaleFactor := 1. / 32.
PhisRegion := []
PhisZoomed := []
RasRegion := []
RasZoomed := []
RbsRegion := []
RbsZoomed := []
* --- End of Automatically Added Context..."
5020de31,full,0,Determine the entropy and anisotropy of images,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
entropy_gray (Rec...",8,18,
5020de31,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')",6,13,
5020de31,micro,2,,"gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
entropy_gray (Rectangle1, Image, Entropy1, Anisotropy1)
entropy_gray (Rectangle2, Image, Entropy2, Anisotropy2)",14,24,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
f1ce13fc,full,0,"This program shows how to use estimate_noise.
The program estimates the standard deviation of the no...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
TestImages := ['for6', 'pumpe', 'die/die_02', 'clip', 'ic0', 'horses', 'board/board-01', 'combine']
NumImages := |TestImages|
for I := 0 to NumIm...",12,40,
f1ce13fc,micro,1,"The program estimates the standard deviation of the noise within
8 example images, which show differ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
TestImages := ['for6', 'pumpe', 'die/die_02', 'clip', 'ic0', 'horses', 'board/board-01', 'combine']
NumImages := |TestImages|
for I := 0 to NumIm...",6,46,
2eb2e01c,full,0,Determine the fuzzy entropy of regions,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
fuzzy_entropy (Re...",8,18,
2eb2e01c,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)",6,12,
2eb2e01c,micro,2,,"dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
fuzzy_entropy (Rectangle1, Image, 0, 255, Entropy1)
fuzzy_entropy (Rectangle2, Image, 0, 255, Entropy2)",13,24,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
866fccac,full,0,Calculate the fuzzy perimeter of a region,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
fuzzy_perimeter (...",8,19,
866fccac,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)",6,12,
866fccac,micro,2,,dev_set_draw ('margin'),13,14,
866fccac,micro,3,,"gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
fuzzy_perimeter (Rectangle1, Image, 0, 255, Perimeter1)
fuzzy_perimeter (Rectangle2, Image, 0, 255, Perimeter2)",15,25,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
1cef4ff5,full,0,Calculate the co-occurrence matrices of two regions in an image,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
dev_set_lut ('tem...",8,21,
1cef4ff5,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')",6,13,
1cef4ff5,micro,2,,"gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)",14,16,
1cef4ff5,micro,3,,"dev_set_lut ('temperature')
gen_cooc_matrix (Rectangle1, Image, Matrix1, 6, 0)
gen_cooc_matrix (Rectangle2, Image, Matrix2, 6, 0)
dev_set_lut ('default')",17,27,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
* --- End of Automatically Added Conte..."
bd0acb71,full,0,Calculation of standard and gray value image features,"read_image (Image, 'monkey')
threshold (Image, Region, 128, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, ['area', 'anisometry'], 'and', [500, 1], [2000, 1.7])
area_center (SelectedRegions, AreaRegion, RowRegion, ColumnRegion)
area_center_gray (SelectedR...",8,15,
bd0acb71,micro,1,,"read_image (Image, 'monkey')
threshold (Image, Region, 128, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, ['area', 'anisometry'], 'and', [500, 1], [2000, 1.7])
area_center (SelectedRegions, AreaRegion, RowRegion, ColumnRegion)
area_center_gray (SelectedR...",6,21,
dcff1ee0,full,0,Calculate the gray value distribution of two regions of an image,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('red')
gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
dev_set_color ('green')
gen_rectangle1 (Re...",8,25,
dcff1ee0,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('red')",6,14,
dcff1ee0,micro,2,,"gen_rectangle1 (Rectangle1, 351, 289, 407, 340)
dev_set_color ('green')
gen_rectangle1 (Rectangle2, 78, 178, 144, 244)
gray_histo (Rectangle1, Image, AbsoluteHisto1, RelativeHisto1)
gray_histo (Rectangle2, Image, AbsoluteHisto2, RelativeHisto2)
dev_set_color ('red')",15,21,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
dcff1ee0,micro,3,,"gen_region_histo (Histo1, AbsoluteHisto1, 255, 255, 1)
dev_set_color ('green')
gen_region_histo (Histo2, AbsoluteHisto2, 255, 255, 1)",22,31,"* --- Automatically Added Context ---
gray_histo (Rectangle1, Image, AbsoluteHisto1, RelativeHisto1)
gray_histo (Rectangle2, Image, AbsoluteHisto2, RelativeHisto2)
* --- End of Automatically Added Con..."
e906dcef,full,0,"This example shows how to use gray_histo_range to calculate
the gray value histogram of an image in ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'mreut_dgm_2.0.tif')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleImage)
dev_open_window (0, Width + 5, Width, Height, 'black', WindowHandleHisto)
set_display_font (WindowHandleImage, 14, 'mo...",10,328,
e906dcef,micro,1,"the gray value histogram of an image in a user-defined gray
value range and bin size.","dev_update_off ()
dev_close_window ()
read_image (Image, 'mreut_dgm_2.0.tif')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleImage)
dev_open_window (0, Width + 5, Width, Height, 'black', WindowHandleHisto)
set_display_font (WindowHandleImage, 14, 'mo...",6,19,
e906dcef,micro,2,,"HistoBorder := 0.2
min_max_gray (Image, Image, 0, Min, Max, Range)
gray_histo_range (Image, Image, Min, Max, int(Max - Min + 1), Histo, BinSize)",20,24,"* --- Automatically Added Context ---
read_image (Image, 'mreut_dgm_2.0.tif')
* --- End of Automatically Added Context ---"
e906dcef,micro,3,,"Button := 1
while (Button != 4)
dev_set_window (WindowHandleImage)
dev_display (Image)
disp_message (WindowHandleImage, 'Original image', 'window', 12, 12, 'black', 'true')
dev_set_window (WindowHandleHisto)
dev_clear_window ()
dev_set_draw ('fill')
plot_histo (Histo, WindowHandleHisto, 'Gray values...",25,108,"* --- Automatically Added Context ---
read_image (Image, 'mreut_dgm_2.0.tif')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleImage)
dev_open_window (0..."
e906dcef,micro,4,"[LabelXMin,LabelXMax] into the WindowHandle by leaving a
relative Border around the plot.","if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
disp_message (WindowHandle, 'Failed to plot histogram', 'window', 12, 12, 'black', 'true')
return ()
endif",109,117,
e906dcef,micro,5,,"get_part (WindowHandle, Row1, Column1, Row2, Column2)
PlotAreaX := (Column2 - Column1 + 1) * (1 - Border * 2)
PlotAreaY := (Row2 - Row1 + 1) * (1 - Border * 2)
OriginX := Column1 + Border * (Column2 - Column1 + 1)
OriginY := Row2 - Border * (Row2 - Column1 + 1)",118,124,"* --- Automatically Added Context ---
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
disp_message (WindowHandle, 'Failed to plo..."
e906dcef,micro,6,,"MinY := min([Histogram,0])
MaxY := max(Histogram)",125,128,"* --- Automatically Added Context ---
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
* --- End of Automatically Added Context ---"
e906dcef,micro,7,,"ScaleX := PlotAreaX / |Histogram|
if (MaxY == MinY)
ScaleY := PlotAreaY
MaxY := ''
else
ScaleY := PlotAreaY / (MaxY - MinY)
endif",129,137,"* --- Automatically Added Context ---
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
PlotAreaX := (Column2 - Column1 + 1) * (1 ..."
e906dcef,micro,8,,"polyX := []
polyY := []
for Value := 0 to |Histogram| - 1 by 1
polyX := [polyX,OriginX + Value * ScaleX]
polyY := [polyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
polyX := [polyX,OriginX + (Value + 1) * ScaleX]
polyY := [polyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
endfor
polyX := [polyX,...",138,154,"* --- Automatically Added Context ---
gray_histo_range (Image, Image, Min, Max, int(Max - Min + 1), Histo, BinSize)
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
if (|Histogram| &lt;= 0 ..."
e906dcef,micro,9,,"dev_set_line_width (1)
dev_set_color (ColorAxis)
gen_arrow_contour_xld (ArrowX, OriginY, OriginX, OriginY, OriginX + PlotAreaX, 5, 5)
gen_arrow_contour_xld (ArrowY, OriginY, OriginX, OriginY - PlotAreaY, OriginX, 5, 5)
dev_display (ArrowX)
dev_display (ArrowY)
dev_set_color (ColorAxis)
get_string_ex...",155,222,"* --- Automatically Added Context ---
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
disp_message (WindowHandle, 'Failed to plot histogram', 'window', 12, 12, 'black', 'true')
if (|Histog..."
e906dcef,micro,10,"[ValueXMin2,ValueXMax2] into the WindowHandle by leaving a
relative Border around the plot.
The hist...","if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
disp_message (WindowHandle, 'Failed to plot histogram', 'window', 12, 12, 'black', 'true')
return ()
endif",223,235,"* --- Automatically Added Context ---
if (|Histogram| &lt;= 0 or Border &lt; 0 or Border &gt;= 1)
disp_message (WindowHandle, 'Failed to plot histogram', 'window', 12, 12, 'black', 'true')
* --- End o..."
e906dcef,micro,11,,"PolyX := []
PolyY := []
for Value := 0 to |Histogram| - 1 by 1
PolyX := [PolyX,OriginX + Value * ScaleX]
PolyY := [PolyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
PolyX := [PolyX,OriginX + (Value + 1) * ScaleX]
PolyY := [PolyY,OriginY - (Histogram[Value] - MinY) * ScaleY]
endfor
PolyX := [PolyX,...",256,272,"* --- Automatically Added Context ---
gray_histo_range (Image, Image, Min, Max, int(Max - Min + 1), Histo, BinSize)
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
for Value := 0 to |Histo..."
e906dcef,micro,12,,"StartZoom := max([0,int((|Histogram| * (ValueXMin2 - ValueXMin)) / (ValueXMax - ValueXMin))])
EndZoom := min([|Histogram| - 1,int((|Histogram| * (ValueXMax2 - ValueXMin)) / (ValueXMax - ValueXMin))])
PolyX := []
PolyY := []
for Value := StartZoom to EndZoom by 1
PolyX := [PolyX,OriginX + Value * Sca...",273,291,"* --- Automatically Added Context ---
gray_histo_range (Image, Image, MinZoom, MaxZoom, int(MaxZoom - MinZoom + 1), HistoZoom, BinSize)
draw_rectangle1 (WindowHandleHisto, Row1, Col1, Row2, Col2)
if (..."
7b6230b9,full,0,Calculate gray value moments and approximation by a plane,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle, 50, 340, 180, 464)
moments_gray_plane (Rectangle, Image, MRow, MCol, Alpha, Beta, Mean...",8,22,
7b6230b9,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle, 50, 340, 180, 464)",6,14,
7b6230b9,micro,2,,"moments_gray_plane (Rectangle, Image, MRow, MCol, Alpha, Beta, Mean)",15,16,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
gen_rectangle1 (Rectangle, 50, 340, 180, 464)
* --- End of Automatically Added Context ---"
7b6230b9,micro,3,,"gen_image_gray_ramp (ImagePlane, Alpha, Beta, Mean, MRow, MCol, Width, Height)
dev_set_lut ('cyclic_gray')",17,19,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
moments_gray_plane (Rectangle, Image, MRow, MCol, Alpha, Beta, Mean)
* --- End of Automatically Added Context ---"
7b6230b9,micro,4,,"sub_image (ImagePlane, Image, ImageSub, 1, 128)
dev_set_lut ('default')",20,28,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
gen_image_gray_ramp (ImagePlane, Alpha, Beta, Mean, MRow, MCol, Width, Height)
* --- End of Automatically Added Context ---"
0c308677,full,0,Calculate horizontal and vertical gray-value projections of a region,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('red')
Row1 := 130
Col1 := 90
gen_rectangle1 (Rectangle, Row1, Col1, 300, Col1 + 10)
gray_projecti...",8,26,
0c308677,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
dev_set_color ('red')
Row1 := 130
Col1 := 90",6,16,
0c308677,micro,2,,"gen_rectangle1 (Rectangle, Row1, Col1, 300, Col1 + 10)
gray_projections (Rectangle, Image, 'simple', HorProjection, VertProjection)
dev_update_time ('off')
dev_update_var ('off')
dev_update_pc ('off')",17,22,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Row1 := 130
Col1 := 90
* --- End of Automatically Added Context ---"
0c308677,micro,3,,"for i := 0 to |HorProjection| - 1 by 1
disp_line (WindowID, Row1 + i, Col1 + 40, Row1 + i, HorProjection[i] + Col1 + 40)
endfor",23,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowID)
Row1 := 130
Col1 := 90
gray_projections (Rectangle, Image, 'simple', HorProjection, VertProjection)
* ---..."
0f7f4248,full,0,Calculate the histogram of two-channel gray value images,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
texture_laws (Image, ImageTexture1, 'le', 3, 5)
texture_laws (Image, ImageTexture2, 'el', 3, 5)
dev_set_draw ('margin')
dev_set_color ('red')
gen_rectangle1 ...",8,25,
0f7f4248,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)",6,11,
0f7f4248,micro,2,,"texture_laws (Image, ImageTexture1, 'le', 3, 5)
texture_laws (Image, ImageTexture2, 'el', 3, 5)
dev_set_draw ('margin')
dev_set_color ('red')",12,16,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
0f7f4248,micro,3,,"gen_rectangle1 (Rectangle, 215, 320, 250, 440)
histo_2dim (Rectangle, ImageTexture1, ImageTexture2, Histo2Dim)",17,19,"* --- Automatically Added Context ---
texture_laws (Image, ImageTexture1, 'le', 3, 5)
texture_laws (Image, ImageTexture2, 'el', 3, 5)
* --- End of Automatically Added Context ---"
0f7f4248,micro,4,,"dev_set_lut ('temperature')
dev_set_draw ('fill')",20,22,
0f7f4248,micro,5,,"threshold (Histo2Dim, Distrib, 1, 100000)
dev_set_lut ('default')",23,31,"* --- Automatically Added Context ---
histo_2dim (Rectangle, ImageTexture1, ImageTexture2, Histo2Dim)
* --- End of Automatically Added Context ---"
e788da13,full,0,Calculate the mean and deviation of gray values of regions of an image,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
intensity (Rectan...",8,18,
e788da13,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')",6,13,
e788da13,micro,2,,"gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
intensity (Rectangle1, Image, Mean1, Deviation1)
intensity (Rectangle2, Image, Mean2, Deviation2)",14,24,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
7451b3ab,full,0,Determine the minimum and maximum gray values within two regions,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')
gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
min_max_gray (Rec...",8,18,
7451b3ab,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_draw ('margin')",6,13,
7451b3ab,micro,2,,"gen_rectangle1 (Rectangle1, 350, 100, 450, 200)
gen_rectangle1 (Rectangle2, 100, 200, 200, 300)
min_max_gray (Rectangle1, Image, 5, Min1, Max1, Range1)
min_max_gray (Rectangle2, Image, 5, Min2, Max2, Range2)",14,24,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
50567228,full,0,,"read_image (Xing1, 'xing/xing000')
read_image (Xing2, 'xing/xing010')
read_image (Xing3, 'xing/xing020')
read_image (Xing4, 'xing/xing030')
read_image (Xing5, 'xing/xing040')
read_image (Xing6, 'xing/xing050')
read_image (Xing7, 'xing/xing060')
get_image_size (Xing1, Width, Height)
gen_rectangle1 (I...",6,28,
e6707bee,full,0,,"read_image (Xing1, 'xing/xing000')
read_image (Xing2, 'xing/xing010')
read_image (Xing3, 'xing/xing020')
read_image (Xing4, 'xing/xing030')
read_image (Xing5, 'xing/xing040')
read_image (Xing6, 'xing/xing050')
read_image (Xing7, 'xing/xing060')
get_image_size (Xing1, Width, Height)
gen_rectangle1 (I...",6,28,
6d7dad94,full,0,,"read_image (Image, 'claudia')
concat_obj (Image, Image, Images)
tile_images (Images, TiledImage1, 1, 'vertical')
tile_images (Images, TiledImage2, 2, 'horizontal')
scale_image (Image, ImageInverted, -1, 256)
concat_obj (ImageInverted, ImageInverted, ImagesInverted)
concat_obj (Images, ImagesInverted...",6,23,
f9b7310d,full,0,,"read_image (Image, 'claudia')
crop_rectangle1 (Image, ImageParts, [10, 230], [60, 120], [219, 339], [299, 219])
concat_obj (Image, ImageParts, Images)
tile_images_offset (Images, TiledImage, [0, 290, 390], [0, 340, 210], [-1, -1, -1], [-1, -1, -1], [-1, -1, -1], [-1, -1, -1], 500, 500)
concat_obj (I...",6,13,
69b1dee7,full,0,,"read_image (Image, 'claudia')
get_image_size (Image, Width, Height)
rectangle1_domain (Image, Image, 0, 0, Height / 2, Width - 1)
concat_obj (Image, Image, Images)
tile_images (Images, TiledImage1, 1, 'vertical')
tile_images (Images, TiledImage2, 2, 'horizontal')
scale_image (Image, ImageInverted, -...",6,25,
0be34f51,full,0,,"read_image (Image, 'claudia')
concat_obj (Image, Image, Images)
tile_images (Images, TiledImage1, 1, 'vertical')
tile_images (Images, TiledImage2, 2, 'horizontal')
crop_rectangle1 (Image, ImagePart1, 20, 20, 459, 349)
concat_obj (ImagePart1, ImagePart1, ImagesPart1)
concat_obj (Images, ImagesPart1, ...",6,23,
4239db3b,full,0,,"dev_close_window ()
read_image (Image1, 'green-dot')
dev_open_window (0, 0, 640, 482, 'black', WindowHandle)
dev_display (Image1)
threshold_sub_pix (Image1, Border, 128)
select_shape_xld (Border, circle, ['area', 'circularity'], 'and', [1500, 0.8], [99999, 1.0])
select_shape_xld (Border, arrows, ['a...",6,20,
4239db3b,micro,1,,"threshold_sub_pix (Image1, Border, 128)
select_shape_xld (Border, circle, ['area', 'circularity'], 'and', [1500, 0.8], [99999, 1.0])
select_shape_xld (Border, arrows, ['area', 'circularity'], 'and', [1500, 0.3], [99999, 0.5])
concat_obj (circle, arrows, green_dot)",10,14,"* --- Automatically Added Context ---
read_image (Image1, 'green-dot')
* --- End of Automatically Added Context ---"
4239db3b,micro,2,,"grayval := [0, 255, 0, 255, 255, 255]
copy_image (Image1, Image2)
copy_image (Image1, Image3)
compose3 (Image1, Image2, Image3, Image)
paint_xld (green_dot, Image, ImageResult, grayval)",15,26,"* --- Automatically Added Context ---
read_image (Image1, 'green-dot')
* --- End of Automatically Added Context ---"
ee7ed54b,full,0,,"read_image (Image, 'fabrik')
dev_display (Image)
for i := 1 to 500 by 1
set_grayval (Image, i, i, fmod(i,255))
endfor
dev_display (Image)",6,11,
de57f99a,full,0,"This example shows how to create an image source handle.
Note: The example might fail if some of the...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
* query_image_sources ('mvtec_gigevision', [], [], ImageSourceHandles)
* query_image_sources ('mvtec_usb3vision', [], [], ImageSourceHandles)
ImageSourceHandle := ...",12,110,
de57f99a,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",9,15,
de57f99a,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",18,19,
de57f99a,micro,3,,"* query_image_sources ('mvtec_gigevision', [], [], ImageSourceHandles)
* query_image_sources ('mvtec_usb3vision', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]",20,24,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
de57f99a,micro,4,-&gt; device ID,"* create_image_source ('mvtec_gigevision', '00305324c805_Basler_acA244020gc', [], [], ImageSourceHandle)",33,35,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,5,,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'CameraLeft', ImageSourceHandle)",36,37,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,6,,"* create_image_source ('mvtec_gigevision', 'ignore', 'device_serial_number', '22410501', ImageSourceHandle)",38,40,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,7,"The 'plugin_path' variable can be used to specify the full
path of the desired &lt;plugin_name&gt;.c...","get_mvtec_plugin_dir (PluginDir)
PluginName := 'mvtec_gigevision'
PluginPath := PluginDir + PluginName + '.cti'
* create_image_source ('ignore', '00305324c805_Basler_acA244020gc', 'plugin_path', PluginPath, ImageSourceHandle)",41,50,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,8,"- Images can only be acquired for connected image sources.
- The image source handle cannot be conne...","connect_image_source (ImageSourceHandle, [], [])",52,56,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,9,"Note: Inspect the Data variable to see the metadata of the
acquired image.","snap_from_image_source (Images, ImageSourceHandle, Data)",57,61,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
de57f99a,micro,10,,"disconnect_image_source (ImageSourceHandle, [], [])
get_system ('halcon_dir', HalconRoot)
get_system ('halcon_arch', HalconArch)
get_system ('operating_system', OS)
PluginSubdir := '/bin/'
if (OS != 'Windows NT')
PluginSubdir := '/lib/'
endif
PluginDir := HalconRoot + PluginSubdir + HalconArch + '/'...",62,118,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
get_mvtec_plugin_dir..."
173829ec,full,0,"This example shows how to measure the frame rate.
In order to achieve the maximum frame rate:
- Chec...","NumImages := 100
FramesPerSecond := 0
dev_close_window ()
check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspec...",21,163,
173829ec,micro,1,,"NumImages := 100
FramesPerSecond := 0
dev_close_window ()
check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",20,28,
173829ec,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",29,30,
173829ec,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",31,35,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
173829ec,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",36,38,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
173829ec,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",39,41,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
173829ec,micro,6,"Note: Some of these parameters might not be available in your
device. Therefore, errors are silently...","try
get_image_source_param (ImageSourceHandle, 'PixelFormat', 'property', 'values', PixelFormatValues)
stop ()
PixelFormat := 'Mono8'
set_image_source_param (ImageSourceHandle, 'PixelFormat', [], [], 'Mono8')
catch (Exception)
get_image_source_param (ImageSourceHandle, 'PixelFormat', [], [], PixelFo...",42,77,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
173829ec,micro,7,,"get_image_source_param (ImageSourceHandle, 'Width', [], [], Width)
get_image_source_param (ImageSourceHandle, 'Height', [], [], Height)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_text ('Image Size:   ' + Width + 'x' +...",78,85,"* --- Automatically Added Context ---
NumImages := 100
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
get_image_source_param (ImageSourceHandle, 'Pi..."
173829ec,micro,8,,dev_update_off (),86,88,
173829ec,micro,9,,"start_image_source (ImageSourceHandle, [], [])",89,90,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
173829ec,micro,10,,"count_seconds (SecondsStart)
NumIncomplete := 0
FirstBufferID := -1
for Index := 1 to NumImages by 1
fetch_from_image_source (Image, ImageSourceHandle, Data)
if (Data.buffer_info.is_incomplete)
NumIncomplete := NumIncomplete + 1
endif
if (FirstBufferID &lt; 0)
FirstBufferID := Data.buffer_info.frame...",91,109,"* --- Automatically Added Context ---
NumImages := 100
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
dev_disp_text ('Image Size:   ' + Width + 'x' ..."
173829ec,micro,11,,"stop_image_source (ImageSourceHandle, [], [])",110,112,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
173829ec,micro,12,,dev_update_on (),113,115,
173829ec,micro,13,,"FramesPerSecond := NumImages / (SecondsEnd - SecondsStart)
dev_clear_window ()
dev_disp_text ('Measured frame rate [fps]: ' + FramesPerSecond$'.2f', 'window', 'top', 'left', 'black', [], [])",116,120,"* --- Automatically Added Context ---
NumImages := 100
FramesPerSecond := 0
count_seconds (SecondsStart)
count_seconds (SecondsEnd)
* --- End of Automatically Added Context ---"
173829ec,micro,14,"that not all images that were exposed on the device were
grabbed, or that images got lost during tra...","Text := ''
NumSkipped := (Data.buffer_info.frame_id - FirstBufferID + 1) - NumImages
if (NumSkipped &gt; 0)
Text := 'Warning:\n- Number of skipped buffers: ' + NumSkipped
dev_disp_text (Text, 'window', 'center', 'left', 'orange red', [], [])
endif",121,130,"* --- Automatically Added Context ---
NumImages := 100
FirstBufferID := -1
fetch_from_image_source (Image, ImageSourceHandle, Data)
* --- End of Automatically Added Context ---"
173829ec,micro,15,,"if (NumIncomplete &gt; 0)
Text := Text + '\n- Number of incomplete buffers: ' + NumIncomplete
dev_disp_text (Text, 'window', 'center', 'left', 'orange red', [], [])
endif",131,136,"* --- Automatically Added Context ---
NumIncomplete := 0
Text := ''
* --- End of Automatically Added Context ---"
173829ec,micro,16,,"disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text ('      End of program      ', 'window', 'bottom', 'right', 'black', [], [])
query_image_sources ('all', 'query', 'plugins', PluginHandles)
PluginsFound := |PluginHandles| &gt; 0
if (not PluginsFound)
Text := 'No installed plugins fou...",137,171,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
dev_open_window (0, ..."
6a709780,full,0,"Program to gather information about the available image sources
in the system.
Please attach the res...","FolderLocation := ''
DependenciesPath := '&lt;PATH_TO_DEPENDENCIES&gt;'
get_system ('operating_system', OSName)
if (OSName == 'Windows NT')
tuple_strstr (DependenciesPath, 'Dependencies.exe', Position)
if (Position == -1)
stop ()
endif
endif
prepare_folder_and_file (FolderLocation, FolderPath, Confi...",14,922,
6a709780,micro,1,,FolderLocation := '',13,15,
6a709780,micro,2,"Please go to https://github.com/lucasg/Dependencies, download
the executable and indicate its full p...","DependenciesPath := '&lt;PATH_TO_DEPENDENCIES&gt;'
get_system ('operating_system', OSName)
if (OSName == 'Windows NT')
tuple_strstr (DependenciesPath, 'Dependencies.exe', Position)
if (Position == -1)
stop ()
endif
endif
prepare_folder_and_file (FolderLocation, FolderPath, ConfigLogFile)
get_halcon_...",16,59,"* --- Automatically Added Context ---
FolderLocation := ''
* --- End of Automatically Added Context ---"
6a709780,micro,3,,"if (OutputPath == '')
get_system ('operating_system', OSName)
get_folder_location (OSName, OutputPath)
endif
OutputPath := OutputPath + '/'",60,65,"* --- Automatically Added Context ---
get_system ('operating_system', OSName)
* --- End of Automatically Added Context ---"
6a709780,micro,4,image_source_config_&lt;date&gt;,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
DateString := Year$'4d' + '-' + Month$'02d' + '-' + Day$'02d' + '_' + Hour$'02d' + '-' + Minute$'02d' + '-' + Second$'02d'
FolderName := 'image_source_config_' + DateString",66,70,
6a709780,micro,5,,"FolderPath := OutputPath + FolderName
LogFilePath := FolderPath + '/' + 'config.txt'
make_dir (FolderPath)
open_file (LogFilePath, 'output', FileHandle)
close_file (FileHandle)
return ()
open_file (LogFilePath, 'append', FileHandle)
set_system ('do_low_error', ['file',FileHandle])
fwrite_string (Fil...",71,101,"* --- Automatically Added Context ---
prepare_folder_and_file (FolderLocation, FolderPath, ConfigLogFile)
if (OutputPath == '')
FolderName := 'image_source_config_' + DateString
DateString := Year$'4d..."
6a709780,micro,6,,"HalconEdition := ''
get_system ('version', HalconVersion)
get_system ('halcon_xl', XL)
NumHalconVersion := number(HalconVersion)
if (NumHalconVersion &gt; 13.0)
get_system ('edition', HalconEdition)
endif
get_system ('revision', HalconRev)
get_system ('halcon_arch', HalconArchitecture)
HALCON := 'HA...",102,131,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
fwrite_string (FileHandle, 'Image sources overview: \n')
* --- End of Automatically Added Context ---"
6a709780,micro,7,,"fwrite_string (FileHandle, '---------------------------------------------------------------------------\n\n')
query_image_sources ('all', 'query', 'plugins', PluginHandles)
NumPlugins := |PluginHandles|
fwrite_string (FileHandle, 'Number of plugins: ' + NumPlugins + '\n')
if (NumPlugins == 0)
fwrite...",132,141,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
* --- End of Automatically Added Context ---"
6a709780,micro,8,,"for Index1 := 0 to NumPlugins - 1 by 1
PluginHandle := PluginHandles[Index1]
fwrite_string (FileHandle, ''$'2s' + 'Plugin ' + (Index1 + 1) + '/' + NumPlugins + ':\n')
try_get_and_print_image_source_paramter (PluginHandle, FileHandle, 'plugin_name', 'image_source', ''$'4s' + 'Name: ')
try_get_and_pri...",142,389,"* --- Automatically Added Context ---
if (OSName == 'Windows NT')
prepare_folder_and_file (FolderLocation, FolderPath, ConfigLogFile)
get_system ('operating_system', OSName)
LogFilePath := FolderPath ..."
6a709780,micro,9,and GENICAM_GENTL32_PATH.,"if (IsHalcon64 == 'true')
tuple_environment ('GENICAM_GENTL64_PATH', GenTL_PATH)
else
tuple_environment ('GENICAM_GENTL32_PATH', GenTL_PATH)
endif
LogFilePathQuote := '""' + LogFilePath + '""'
try
tuple_split (GenTL_PATH, Separator, Paths)
Paths := sort(Paths)
Paths := uniq(Paths)
for Index := 0 to |P...",390,668,"* --- Automatically Added Context ---
DependenciesPath := '&lt;PATH_TO_DEPENDENCIES&gt;'
tuple_strstr (DependenciesPath, 'Dependencies.exe', Position)
prepare_folder_and_file (FolderLocation, FolderPa..."
6a709780,micro,10,(assuming TriggerSelector and TriggerMode are implemented),"try
get_image_source_param (ImageSourceHandle, 'TriggerSelector', 'property', 'values', TriggerSelectors)
tuple_gen_const (|TriggerSelectors|, 'Off', TriggerModesNew)
set_all_triggers_modes (ImageSourceHandle, TriggerSelectors, TriggerModesNew, TriggerModesBefore)
tuple_regexp_select (TriggerModesBe...",669,686,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
create_image_source ('none', 'none', [], [], ImageSourceHandle)
catch (Exception)
system_call ('dir /b /On ""' + Path..."
6a709780,micro,11,,"try
get_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], AcqModeBefore)
if (AcqModeBefore != 'Continuous')
fwrite_string (FileHandle, '\nChanging AcquisitionMode from ' + AcqModeBefore + ' to Continuous.\n')
set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Cont...",687,758,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
create_image_source ('none', 'none', [], [], ImageSourceHandle)
for Index := 0 to |Paths| - 1 by 1
configure_camera_..."
6a709780,micro,12,,"try
if (AcqModeBefore != 'Continuous')
fwrite_string (FileHandle, '\nRestoring AcquisitionMode to ' + AcqModeBefore + '...\n')
set_image_source_param (ImageSourceAcqHandle, 'AcquisitionMode', [], [], AcqModeBefore)
fwrite_string (FileHandle, ' -&gt; done!\n')
endif
catch (Exception)
fwrite_string (F...",759,770,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
configure_camera_free_running (DeviceHandle, FileHandle, TriggerSelectors, TriggersBefore, AcqModeBefore)
catch (Exc..."
6a709780,micro,13,,"try
tuple_regexp_select (TriggerModesBefore, 'On', OnTriggers)
if (|OnTriggers| &gt; 0)
fwrite_string (FileHandle, '\nRestoring trigger settings:\n')
set_all_triggers_modes (ImageSourceAcqHandle, TriggerSelectors, TriggerModesBefore, TriggerModesOff)
fwrite_string (FileHandle, ' -&gt; done!\n')
endi...",771,900,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
DeviceHandle := DeviceHandles[Index3]
fwrite_string (FileHandle, PreText + ParamValue + '\n')
query_image_sources ('..."
6a709780,micro,14,misconfigured device is connected.,"create_image_source ('mvtec_gigevision', 'none', 'interface_id', InterfaceID, GEVInterface)",901,903,"* --- Automatically Added Context ---
get_image_source_param (DeviceHandle, 'interface_id', 'group', 'image_source', InterfaceID)
* --- End of Automatically Added Context ---"
6a709780,micro,15,connected).,"connect_image_source (GEVInterface, [], [])",904,906,"* --- Automatically Added Context ---
create_image_source ('mvtec_gigevision', 'none', 'interface_id', InterfaceID, GEVInterface)
* --- End of Automatically Added Context ---"
6a709780,micro,16,,"set_image_source_param (GEVInterface, 'DeviceUpdateList', 'group', 'interface', 'execute')
get_image_source_param (GEVInterface, 'DeviceSelector', ['group', 'property'], ['interface', 'max'], MaxDeviceIndex)",907,909,"* --- Automatically Added Context ---
create_image_source ('mvtec_gigevision', 'none', 'interface_id', InterfaceID, GEVInterface)
* --- End of Automatically Added Context ---"
6a709780,micro,17,,"for Index := 0 to MaxDeviceIndex by 1
set_image_source_param (GEVInterface, 'DeviceSelector', 'group', 'interface', Index)
get_image_source_param (GEVInterface, 'DeviceID', 'group', 'interface', CurrentDeviceID)
if (CurrentDeviceID == DeviceID)
try_get_and_print_image_source_paramter (GEVInterface, ...",910,932,"* --- Automatically Added Context ---
open_file (LogFilePath, 'output', FileHandle)
try_get_and_print_image_source_paramter (InterfaceHandle, FileHandle, 'GevInterfaceSubnetIPAddress', Group, ''$'8s' ..."
09c5ec4c,full,0,"This example shows the different modules of the image source
and how to access them.
A module tree i...","dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')
Text := 'Image source module tree of your system:\n'
query_image_sources ('all', 'query', 'plugins', PluginHandles)
if (|PluginHandles| == 0)
Text := 'No installe...",22,116,
09c5ec4c,micro,1,"Plugin1
L Interface1
L Device1
L Device2
Plugin2
L Interface1
L Device1
L Interface2
L Device1
...","dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')
Text := 'Image source module tree of your system:\n'",10,26,
09c5ec4c,micro,2,,"query_image_sources ('all', 'query', 'plugins', PluginHandles)
if (|PluginHandles| == 0)
Text := 'No installed plugins found.'
Text[|Text|] := 'Use the MVTec Software Manager to select and install them.'
dev_disp_text (Text, 'window', 'top', 'left', 'red', [], [])
return ()
endif",27,34,"* --- Automatically Added Context ---
Text := 'Image source module tree of your system:\n'
* --- End of Automatically Added Context ---"
09c5ec4c,micro,3,,"for Index := 0 to |PluginHandles| - 1 by 1
PluginHandle := PluginHandles[Index]
get_image_source_param (PluginHandle, 'plugin_name', 'group', 'image_source', PluginName)
Text := Text + '\n' + PluginName + '\n'
try
connect_image_source (PluginHandle, [], [])
catch (Exception)
get_exception_info (Exce...",35,99,"* --- Automatically Added Context ---
Text := 'Image source module tree of your system:\n'
query_image_sources ('all', 'query', 'plugins', PluginHandles)
* --- End of Automatically Added Context ---"
09c5ec4c,micro,4,display window. Split and justify the text.,"LineLenght := 128
ErrorMessageLenght := strlen(ErrorMessage)
NumLines := ceil(1.0 * ErrorMessageLenght / LineLenght)
MultilineErrorMessage := ''
for Index := 0 to NumLines - 1 by 1
Pos1 := Index * LineLenght
if (Index == NumLines - 1)
Pos2 := ErrorMessageLenght - 1
else
Pos2 := Pos1 + LineLenght - 1...",100,125,"* --- Automatically Added Context ---
Text := 'Image source module tree of your system:\n'
for Index := 0 to |PluginHandles| - 1 by 1
catch (Exception)
get_extended_error_info (OperatorName, ErrorCode..."
92a75bea,full,0,"This example shows how to query and display all available
parameters.
Enable/disable writing of para...","InfoFile := ''
* InfoFile := 'parameters_info.dat'
if ('' != InfoFile)
open_file (InfoFile, 'output', FileHandle)
else
FileHandle := []
endif
check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (Ima...",12,278,
92a75bea,micro,1,Adjust the filename to your needs.,"InfoFile := ''
* InfoFile := 'parameters_info.dat'
if ('' != InfoFile)
open_file (InfoFile, 'output', FileHandle)
else
FileHandle := []
endif
check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",10,23,
92a75bea,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",24,25,
92a75bea,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",26,30,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
92a75bea,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",31,34,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
92a75bea,micro,5,,"dev_close_window ()
WindowHeight := 800
WindowWidth := 800",35,39,
92a75bea,micro,6,,"connect_image_source (ImageSourceHandle, [], [])
start_image_source (ImageSourceHandle, [], [])",40,43,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
92a75bea,micro,7,,"control_image_source (ImageSourceHandle, 'enumerate_groups', [], [], Groups)
for Index := 0 to |Groups| - 1 by 1
control_image_source (ImageSourceHandle, 'enumerate_params', 'group', Groups[Index], Names)
list_parameters (Groups[Index], Names, WindowWidth, WindowHeight, FileHandle, ImageSourceHandle...",44,50,"* --- Automatically Added Context ---
open_file (InfoFile, 'output', FileHandle)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
WindowHeight := 800
..."
92a75bea,micro,8,,"if (0 != |FileHandle|)
fwrite_string (FileHandle, '\n')
close_file (FileHandle)
endif
stop_image_source (ImageSourceHandle, [], [])
disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text ('         End of program         ', 'window', 'bottom', 'right', 'black', [], [])
if (0 == |Value|)
w...",51,116,"* --- Automatically Added Context ---
open_file (InfoFile, 'output', FileHandle)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automat..."
92a75bea,micro,9,,"InfoForWindow := Info
if (sem_type(Info) == 'string')
InfoForWindow := str_replace(Info,'\n','')
endif",117,121,
92a75bea,micro,10,,"for Index := 0 to |Handles| - 1 by 1
tuple_sem_type (Handles[Index], SemType)
if (SemType == 'window')
dev_set_color (Color)
write_string (Handles[Index], InfoForWindow)
elseif (SemType == 'file')
fwrite_string (Handles[Index], Info)
else
stop ()
endif
endfor
return ()",122,157,"* --- Automatically Added Context ---
for Index := 0 to |Groups| - 1 by 1
write_info (Handles, '[]', Color)
InfoForWindow := Info
if (sem_type(Info) == 'string')
* --- End of Automatically Added Conte..."
92a75bea,micro,11,,"WindowHandles := []
NumParamsPerWin := 62
NumWindows := |Names| / NumParamsPerWin
for Index := 0 to NumWindows by 1
dev_open_window (0, Index * 300, WindowWidth, WindowHeight, 'black', CurrentWindowHandle)
WindowHandles := [WindowHandles,CurrentWindowHandle]
endfor",158,166,"* --- Automatically Added Context ---
WindowHeight := 800
WindowWidth := 800
for Index := 0 to |Groups| - 1 by 1
control_image_source (ImageSourceHandle, 'enumerate_params', 'group', Groups[Index], Na..."
92a75bea,micro,12,,"Count := 0
for Index := 0 to |Names| - 1 by 1
if (Index % NumParamsPerWin == 0)
CurrentWindowHandle := WindowHandles[Count]
dev_set_window (CurrentWindowHandle)
Count := Count + 1
endif
Handles := [CurrentWindowHandle,FileHandle]
if (Index == 0)
write_info (Handles, '---------------------------\n', ...",167,286,"* --- Automatically Added Context ---
open_file (InfoFile, 'output', FileHandle)
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle :=..."
eacd99e1,full,0,"This example shows how to query and test the device supported
pixel formats.
Note: The example might...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)
* create_image_source ('mvtec_...",13,113,
eacd99e1,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",10,16,
eacd99e1,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",17,18,
eacd99e1,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",19,23,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
eacd99e1,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",24,26,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",27,29,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,6,,"get_image_source_param (ImageSourceHandle, 'DeviceManufacturerInfo', 'group', 'local_device', Model)
get_image_source_param (ImageSourceHandle, 'DeviceSerialNumber', 'group', 'local_device', SerialNumber)",30,33,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,7,,"get_image_source_param (ImageSourceHandle, 'PixelFormat', 'property', 'values', PixelFormatsList)",34,35,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,8,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_text (['Supported pixel formats:\n','- ' + PixelFormatsList], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'tru...",36,43,"* --- Automatically Added Context ---
get_image_source_param (ImageSourceHandle, 'PixelFormat', 'property', 'values', PixelFormatsList)
* --- End of Automatically Added Context ---"
eacd99e1,micro,9,,set_free_run_mode (ImageSourceHandle),44,46,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,10,,"for Index := 0 to |PixelFormatsList| - 1 by 1
set_image_source_param (ImageSourceHandle, 'PixelFormat', [], [], PixelFormatsList[Index])
snap_from_image_source (Image, ImageSourceHandle, Data)
dev_disp_text (PixelFormatsList[Index], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (Wi...",47,61,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
get_image_source_param (ImageSourceHandle, 'PixelFormat', 'prop..."
eacd99e1,micro,11,,"disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text ('   End of program   ', 'window', 'bottom', 'right', 'black', [], [])",62,78,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
eacd99e1,micro,12,,"try
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'Off')
catch (Exception)
endtry
try
set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Continuous')
catch (Exception)
endtry
return ()
query_image_sources ('all', 'query', 'plugins', PluginHandles)
PluginsFound...",79,121,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
dev_open_window (0, ..."
539991e4,full,0,"This example shows how to use a non-MVTec plugin.
The mvtec_gigevision plugin has been used to exemp...","get_mvtec_plugin_dir (PluginDir)
PluginName := 'mvtec_gigevision'
PluginPath := PluginDir + PluginName + '.cti'
create_image_source ('ignore', 'none', 'plugin_path', PluginPath, PluginHandle)
connect_image_source (PluginHandle, [], [])
query_image_sources ('ignore', ['plugin_handle', 'query'], [Plug...",15,56,
539991e4,micro,1,documentation.,"get_mvtec_plugin_dir (PluginDir)
PluginName := 'mvtec_gigevision'",12,16,
539991e4,micro,2,the GenICam GenTL producer (*.cti) you want to use.,"PluginPath := PluginDir + PluginName + '.cti'
create_image_source ('ignore', 'none', 'plugin_path', PluginPath, PluginHandle)",17,20,"* --- Automatically Added Context ---
get_mvtec_plugin_dir (PluginDir)
PluginName := 'mvtec_gigevision'
* --- End of Automatically Added Context ---"
539991e4,micro,3,,"connect_image_source (PluginHandle, [], [])",21,22,"* --- Automatically Added Context ---
create_image_source ('ignore', 'none', 'plugin_path', PluginPath, PluginHandle)
* --- End of Automatically Added Context ---"
539991e4,micro,4,,"query_image_sources ('ignore', ['plugin_handle', 'query'], [PluginHandle,'devices'], DeviceHandles)",23,24,"* --- Automatically Added Context ---
create_image_source ('ignore', 'none', 'plugin_path', PluginPath, PluginHandle)
* --- End of Automatically Added Context ---"
539991e4,micro,5,device has been found.,"if (|DeviceHandles| != 0)
get_image_source_param (DeviceHandles[0], 'device_id', 'group', 'image_source', Value)
connect_image_source (DeviceHandles[0], [], [])
snap_from_image_source (Images, DeviceHandles[0], Data)
disconnect_image_source (DeviceHandles[0], [], [])
endif
disconnect_image_source (P...",25,64,"* --- Automatically Added Context ---
get_mvtec_plugin_dir (PluginDir)
create_image_source ('ignore', 'none', 'plugin_path', PluginPath, PluginHandle)
query_image_sources ('ignore', ['plugin_handle', ..."
dc935ed9,full,0,"This example shows how to query all devices.
Note: The example might fail if some of the used GenICa...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')
PluginName := 'all'
* PluginName := 'mvtec_gigevision'
* PluginName := 'mvtec_usb...",12,156,
dc935ed9,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')",9,20,
dc935ed9,micro,2,,PluginName := 'all',21,22,
dc935ed9,micro,3,,"* PluginName := 'mvtec_gigevision'
* PluginName := 'mvtec_usb3vision'
query_image_sources (PluginName, [], [], ImageSourceHandles)",23,26,"* --- Automatically Added Context ---
PluginName := 'all'
* --- End of Automatically Added Context ---"
dc935ed9,micro,4,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
dev_close_inspect_ctrl (ImageSourceHandles)",27,31,"* --- Automatically Added Context ---
query_image_sources (PluginName, [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
dc935ed9,micro,5,,"NumImageSources := |ImageSourceHandles|
for Index := 0 to NumImageSources - 1 by 1
dev_clear_window ()
ImageSourceHandle := ImageSourceHandles[Index]
get_image_source_param (ImageSourceHandle, 'device_id', 'group', 'image_source', Device)
get_image_source_param (ImageSourceHandle, 'plugin_name', 'gr...",32,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
query_image_sources (PluginName, [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
dc935ed9,micro,6,,"try
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'Off')
catch (Exception)
endtry
try
set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Continuous')
catch (Exception)
endtry
return ()
get_extended_error_info (OperatorName, ErrorCode, ErrorMessage)
dev_clear_w...",104,164,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
query_image_sources (PluginName, [], [], ImageSourceHandles)
I..."
46edb726,full,0,"This example shows how to query plugins and how to list
devices from a plugin handle.
Note: For info...","dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')
query_image_sources ('all', 'query', 'plugins', PluginHandles)
NumPlugins := |PluginHandles|
if (NumPlugins == 0)
Text := 'No installed plugins found.'
Text[|Text...",13,110,
46edb726,micro,1,documentation.,"dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 12, 'mono', 'true', 'false')",10,16,
46edb726,micro,2,,"query_image_sources ('all', 'query', 'plugins', PluginHandles)
NumPlugins := |PluginHandles|
if (NumPlugins == 0)
Text := 'No installed plugins found.'
Text[|Text|] := 'Use the MVTec Software Manager to select and install them.'
dev_disp_text (Text, 'window', 'top', 'left', 'red', [], [])
return ()
...",17,26,
46edb726,micro,3,,"dev_get_window (WindowHandle)
Text := 'Number of plugins found: ' + NumPlugins + '\n'
for Index := 0 to |PluginHandles| - 1 by 1
get_image_source_param (PluginHandles[Index], 'plugin_name', 'group', 'image_source', PluginName)
get_image_source_param (PluginHandles[Index], 'plugin_path', 'group', 'im...",27,38,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
query_image_sources ('all', 'query', 'plugins', PluginHandles)
NumPlugins := |PluginHandles|
Text := 'No ..."
46edb726,micro,4,,"for Index1 := 0 to |PluginHandles| - 1 by 1
dev_clear_window ()
get_image_source_param (PluginHandles[Index1], 'plugin_name', 'group', 'image_source', PluginName)
Text := 'Plugin ' + (Index1 + 1) + '/' + NumPlugins + ' - ' + PluginName + '\n\n'
try
connect_image_source (PluginHandles[Index1], [], []...",39,93,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
query_image_sources ('all', 'query', 'plugins', PluginHandles)
NumPlugins := |PluginHandles|
Text := 'No ..."
46edb726,micro,5,display window. Split and justify the text.,"LineLenght := 128
ErrorMessageLenght := strlen(ErrorMessage)
NumLines := ceil(1.0 * ErrorMessageLenght / LineLenght)
MultilineErrorMessage := ''
for Index := 0 to NumLines - 1 by 1
Pos1 := Index * LineLenght
if (Index == NumLines - 1)
Pos2 := ErrorMessageLenght - 1
else
Pos2 := Pos1 + LineLenght - 1...",94,119,"* --- Automatically Added Context ---
Text := 'No installed plugins found.'
for Index := 0 to |PluginHandles| - 1 by 1
catch (Exception)
get_extended_error_info (OperatorName, ErrorCode, ErrorMessage)..."
61a86355,full,0,"This example shows how to connect and acquire an image
from an image source.","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)
connect_image_so...",10,62,
61a86355,micro,1,from an image source.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",7,13,
61a86355,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",14,15,
61a86355,micro,3,,ImageSourceHandle := ImageSourceHandles[0],16,17,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
61a86355,micro,4,specific plugin and device.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",18,21,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
61a86355,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",22,24,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
61a86355,micro,6,,"snap_from_image_source (Images, ImageSourceHandle, Data)",25,27,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
61a86355,micro,7,,"start_image_source (ImageSourceHandle, [], [])
for Index := 1 to 100 by 1
fetch_from_image_source (Images, ImageSourceHandle, Data)
endfor",28,33,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
snap_from_image_source (Images, ImageSourceHandle, Data)
* --- ..."
61a86355,micro,8,,"stop_image_source (ImageSourceHandle, [], [])",34,36,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
61a86355,micro,9,,"disconnect_image_source (ImageSourceHandle, [], [])
query_image_sources ('all', 'query', 'plugins', PluginHandles)
PluginsFound := |PluginHandles| &gt; 0
if (not PluginsFound)
Text := 'No installed plugins found.'
Text[|Text|] := 'Use the MVTec Software Manager to select and install them.'
dev_close...",37,70,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automat..."
8dbecc6e,full,0,"This example demonstrates how to use the hardware trigger
functionality.
Note: The example might fai...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)
* create_image_source ('mvtec_...",13,135,
8dbecc6e,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",10,16,
8dbecc6e,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",17,18,
8dbecc6e,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",19,23,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
8dbecc6e,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",24,26,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",27,29,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,6,,"set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Continuous')",35,36,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,7,Select the input line to use for the hardware trigger.,"InputLine := 'Line1'
set_image_source_param (ImageSourceHandle, 'TriggerSelector', [], [], 'FrameStart')
set_image_source_param (ImageSourceHandle, 'TriggerSource', [], [], InputLine)
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'On')
* set_image_source_param (ImageSourceHandle,...",37,45,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,8,"- 'fetch_timeout': Regardless of the trigger mode, the
'fetch_timeout' must be configured to a sensi...","FetchTimeout := 5000
set_image_source_param (ImageSourceHandle, 'fetch_timeout', 'group', 'image_source', FetchTimeout)",46,53,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,9,"prepared by start_image_source for receiving images. A larger
number of buffers can help preventing ...","NumBuffers := 4
set_image_source_param (ImageSourceHandle, 'num_buffers', 'group', 'image_source', NumBuffers)
stop ()",54,61,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,10,,"start_image_source (ImageSourceHandle, [], [])",62,63,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,11,,"NumImages := 10
NumFetched := 0
NumTimeouts := 0
NumErrors := 0
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
while (NumFetched + NumTimeouts + NumErrors &lt; NumImages)
try
fetch_from_image_source (Image, Ima...",64,103,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,12,of images of the image source. The camera is still connected.,"stop_image_source (ImageSourceHandle, [], [])",104,106,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
8dbecc6e,micro,13,,"set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'Off')",107,108,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [..."
8dbecc6e,micro,14,,"disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text (' End of program ', 'window', 'bottom', 'right', 'black', [], [])
query_image_sources ('all', 'query', 'plugins', PluginHandles)
PluginsFound := |PluginHandles| &gt; 0
if (not PluginsFound)
Text := 'No installed plugins found.'
Text[...",109,143,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
dev_open_window (0, ..."
84b7d409,full,0,"This example demonstrates how to use the software trigger
functionality in the case that the softwar...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)
* create_image_source ('mvtec_...",14,110,
84b7d409,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",11,17,
84b7d409,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",18,19,
84b7d409,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",20,24,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
84b7d409,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",25,27,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",28,30,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,6,,"set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Continuous')",36,37,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,7,,"set_image_source_param (ImageSourceHandle, 'TriggerSelector', [], [], 'FrameStart')
set_image_source_param (ImageSourceHandle, 'TriggerSource', [], [], 'Software')
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'On')
stop ()",38,43,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,8,,"start_image_source (ImageSourceHandle, [], [])",44,45,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,9,,"NumImages := 200
NumFetched := 0
FirstBufferID := -1
count_seconds (TimeStart)
while (NumFetched &lt; NumImages)
set_image_source_param (ImageSourceHandle, 'TriggerSoftware', [], [], 'execute')
fetch_from_image_source (Image, ImageSourceHandle, Data)
NumFetched := NumFetched + 1
if (FirstBufferID &l...",46,66,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,10,,"stop_image_source (ImageSourceHandle, [], [])",67,69,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
84b7d409,micro,11,,"get_image_source_param (ImageSourceHandle, 'interface_display_name', 'group', 'image_source', InterfaceName)
get_image_source_param (ImageSourceHandle, 'device_id', 'group', 'image_source', DeviceID)
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono',...",70,80,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
NumFetched := 0
count_seconds (TimeStart)
count_seconds (TimeEn..."
84b7d409,micro,12,,"set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'Off')",81,82,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [..."
84b7d409,micro,13,,"disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text ('   End of program   ', 'window', 'bottom', 'right', 'black', [], [])
query_image_sources ('all', 'query', 'plugins', PluginHandles)
PluginsFound := |PluginHandles| &gt; 0
if (not PluginsFound)
Text := 'No installed plugins found.'
T...",83,118,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
set_image_source_par..."
14e66c73,full,0,"This example demonstrates how to use the software trigger
functionality in the case that the main th...","check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif
query_image_sources ('all', [], [], ImageSourceHandles)
dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)
* create_image_source ('mvtec_...",15,293,
14e66c73,micro,1,standard features are not supported.,"check_for_installed_plugins (PluginsFound)
if (not PluginsFound)
return ()
endif",12,18,
14e66c73,micro,2,,"query_image_sources ('all', [], [], ImageSourceHandles)",19,20,
14e66c73,micro,3,,"dev_inspect_ctrl (ImageSourceHandles)
stop ()
ImageSourceHandle := ImageSourceHandles[0]
dev_close_inspect_ctrl (ImageSourceHandles)",21,25,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
* --- End of Automatically Added Context ---"
14e66c73,micro,4,specific camera.,"* create_image_source ('mvtec_usb3vision', 'ignore', 'device_user_name', 'MyU3VCam', ImageSourceHandle)",26,28,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,5,,"connect_image_source (ImageSourceHandle, [], [])",29,31,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,6,,"set_image_source_param (ImageSourceHandle, 'AcquisitionMode', [], [], 'Continuous')",37,38,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,7,,"set_image_source_param (ImageSourceHandle, 'TriggerSelector', [], [], 'FrameStart')
set_image_source_param (ImageSourceHandle, 'TriggerSource', [], [], 'Software')
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'On')",39,43,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,8,"- 'fetch_timeout': Regardless of the trigger mode, the
'fetch_timeout' must be configured to a sensi...","FetchTimeout := 5000
set_image_source_param (ImageSourceHandle, 'fetch_timeout', 'group', 'image_source', FetchTimeout)",44,51,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,9,"prepared by start_image_source for receiving images.
A larger number of buffers can help preventing ...","NumBuffers := 4
set_image_source_param (ImageSourceHandle, 'num_buffers', 'group', 'image_source', NumBuffers)
stop ()",52,59,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,10,"- To send a stop signal from the main thread to the
fetching thread.","create_event ([], [], StopLoopEvent)",61,64,
14e66c73,micro,11,the main thread.,"create_event ([], [], NextTriggerEvent)",65,68,
14e66c73,micro,12,,"start_image_source (ImageSourceHandle, [], [])",69,71,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,13,,"NumFetched := 0
NumTimeouts := 0
NumErrors := 0
par_start&lt;FetchThreadID&gt; : fetch_images_in_loop (ImageSourceHandle, StopLoopEvent, NextTriggerEvent, NumFetched, NumTimeouts, NumErrors)",72,77,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
create_event ([], [], StopLoopEvent)
create_event ([], [], Next..."
14e66c73,micro,14,Set the duration of the image acquisition (in seconds).,"AcqDuration := 60
NumTriggersSent := 0
ElapsedTime := 0
count_seconds (StartTime)
while (ElapsedTime &lt; AcqDuration)
set_image_source_param (ImageSourceHandle, 'TriggerSoftware', [], [], 'execute')
NumTriggersSent := NumTriggersSent + 1
wait_event (NextTriggerEvent)
wait_seconds (rand(1) * 2)
coun...",78,104,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
create_event ([], [], NextTriggerEvent)
* --- End of Automatica..."
14e66c73,micro,15,"This will stop the loop in the fetching thread, regardless of
any errors or timing issues. However, ...",signal_event (StopLoopEvent),105,113,"* --- Automatically Added Context ---
create_event ([], [], StopLoopEvent)
* --- End of Automatically Added Context ---"
14e66c73,micro,16,"immediately, even while waiting for trigger signals.
stop_image_source also reverses the effects of
...","stop_image_source (ImageSourceHandle, [], [])",114,121,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,17,succeeds.,par_join (FetchThreadID),122,125,"* --- Automatically Added Context ---
par_start&lt;FetchThreadID&gt; : fetch_images_in_loop (ImageSourceHandle, StopLoopEvent, NextTriggerEvent, NumFetched, NumTimeouts, NumErrors)
* --- End of Automa..."
14e66c73,micro,18,,"dev_close_window ()
dev_open_window (0, 0, 1024, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Text := 'Acquiring images with software trigger (triggers are sent from the main thread):'
Text[|Text|] := 'After acquiring for ' + AcqDuration + ' seconds:'
Text...",126,137,"* --- Automatically Added Context ---
NumFetched := 0
NumTimeouts := 0
NumErrors := 0
AcqDuration := 60
NumTriggersSent := 0
* --- End of Automatically Added Context ---"
14e66c73,micro,19,,"set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [], 'Off')",138,139,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
set_image_source_param (ImageSourceHandle, 'TriggerMode', [], [..."
14e66c73,micro,20,,"disconnect_image_source (ImageSourceHandle, [], [])
dev_disp_text ('   End of program   ', 'window', 'bottom', 'right', 'black', [], [])",140,163,"* --- Automatically Added Context ---
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
* --- End of Automatically Added Context ---"
14e66c73,micro,21,of timeout and other errors.,"NumFetched := 0
NumTimeouts := 0
NumErrors := 0",164,169,"* --- Automatically Added Context ---
NumFetched := 0
NumTimeouts := 0
NumErrors := 0
* --- End of Automatically Added Context ---"
14e66c73,micro,22,fetching loop is not even started in the first place.,"try_wait_event (StopLoopEvent, StopLoopEventState)
StopLoop := StopLoopEventState == 0
while (not StopLoop)
try
fetch_from_image_source (Image, ImageSourceHandle, Data)
NumFetched := NumFetched + 1
wait_seconds (0.5)
dev_display (Image)
catch (Exception)
ErrorCode := Exception[0]
if (ErrorCode == 58...",170,301,"* --- Automatically Added Context ---
check_for_installed_plugins (PluginsFound)
query_image_sources ('all', [], [], ImageSourceHandles)
ImageSourceHandle := ImageSourceHandles[0]
set_image_source_par..."
92c5f447,full,0,"This example shows how to use bead inspection to verify
adhesive beads. Bead inspection can be used ...","dev_update_off ()
prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
smallest_rectangle1 (RegionPart, PartRow1, PartColumn1, PartRow2, PartColumn2)
gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360.28, 354.247, 363.9, 400.1, 458.02, 509.907, 588.34, 659.533, 696...",18,287,
92c5f447,micro,1,"are already aligned with the reference contour. In this example,
the alignment is based on planar de...",dev_update_off (),14,19,
92c5f447,micro,2,reference contour,"prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
smallest_rectangle1 (RegionPart, PartRow1, PartColumn1, PartRow2, PartColumn2)",20,24,
92c5f447,micro,3,"also be generated by drawing it on a reference image with, e.g.,
draw_xld.","gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360.28, 354.247, 363.9, 400.1, 458.02, 509.907, 588.34, 659.533, 696.94], [319.24, 336.133, 367.507, 431.46, 489.38, 546.093, 646.247, 722.267, 776.567, 826.04, 869.48, 912.92, 934.64, 929.813], 'auto', [15, 15, 15, 15, ...",25,29,
92c5f447,micro,4,,"TargetWidth := 14
WidthTolerance := 7
PositionTolerance := 30
Polarity := 'dark'
create_bead_inspection_model (ContourRef, TargetWidth, WidthTolerance, PositionTolerance, Polarity, [], [], BeadInspectionModel)",30,36,"* --- Automatically Added Context ---
gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360.28, 354.247, 363.9, 400.1, 458.02, 509.907, 588.34, 659.533, 696.94], [319.24,..."
92c5f447,micro,5,,"read_image (Image, 'bead/adhesive_bead_01')
align_bead (Image, ImageAligned, ModelID, RowT, ColumnT)",37,40,"* --- Automatically Added Context ---
prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
* --- End of Automatically Added Context ---"
92c5f447,micro,6,thick a correct adhesive bead should be,"gen_parallel_contour_xld (ContourRef, ModelSide1, 'regression_normal', TargetWidth * 0.5)
gen_parallel_contour_xld (ContourRef, ModelSide2, 'regression_normal', -TargetWidth * 0.5)
concat_obj (ModelSide1, ModelSide2, ModelSides)",41,46,"* --- Automatically Added Context ---
gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360.28, 354.247, 363.9, 400.1, 458.02, 509.907, 588.34, 659.533, 696.94], [319.24,..."
92c5f447,micro,7,a correct adhesive bead should be located,"gen_parallel_contour_xld (ContourRef, PositionToleranceSide1, 'regression_normal', PositionTolerance)
gen_parallel_contour_xld (ContourRef, PositionToleranceSide2, 'regression_normal', -PositionTolerance)
concat_obj (PositionToleranceSide1, PositionToleranceSide2, PositionToleranceSides)
dev_close_w...",47,70,"* --- Automatically Added Context ---
smallest_rectangle1 (RegionPart, PartRow1, PartColumn1, PartRow2, PartColumn2)
gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360..."
92c5f447,micro,8,,"TextOffset := 20
NumImages := 7
for Index := 1 to NumImages by 1
read_image (Image, 'bead/adhesive_bead_' + Index$'02')
align_bead (Image, ImageAligned, ModelID, RowT, ColumnT)
apply_bead_inspection_model (ImageAligned, LeftContour, RightContour, ErrorSegment, BeadInspectionModel, ErrorType)
set_win...",71,162,"* --- Automatically Added Context ---
prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
gen_contour_nurbs_xld (ContourRef, [701.767, 626.953, 538.867, 443.54, 390.447, 360.28, 354.247, 363.9, 400..."
92c5f447,micro,9,planar deformable matching,"find_planar_uncalib_deformable_model (Image, ModelID, -0.39, 0.78, 1, 1, 1, 1, 0.4, 1, 1, 5, 0.9, [], [], HomMat2D1, Score)
hom_mat2d_invert (HomMat2D1, HomMat2DInvert)
hom_mat2d_translate (HomMat2DInvert, RowT, ColumnT, HomMat2DTranslate)
projective_trans_image (Image, ImageAligned, HomMat2DTransla...",163,223,"* --- Automatically Added Context ---
prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
read_image (Image, 'bead/adhesive_bead_01')
align_bead (Image, ImageAligned, ModelID, RowT, ColumnT)
for In..."
92c5f447,micro,10,returned by the bead inspection,"gen_parallel_contour_xld (TooThinSegments, ParallelContours1, 'regression_normal', 50)
gen_parallel_contour_xld (TooThinSegments, ParallelContours2, 'regression_normal', -50)
close_parallels (ParallelContours1, ParallelContours2, Contour)
close_parallels (LeftContour, RightContour, Contour1)
interse...",224,253,"* --- Automatically Added Context ---
apply_bead_inspection_model (ImageAligned, LeftContour, RightContour, ErrorSegment, BeadInspectionModel, ErrorType)
count_obj (ParallelContours1, Number)
gen_empt..."
92c5f447,micro,11,"a projective transformation to rectify the reference
image","Row := [658.232, 291.923, 314.817, 691.533]
Col := [330.071, 316.617, 971.032, 947.008]",254,258,"* --- Automatically Added Context ---
area_center_points_xld (SelectedSegments, Area, Row, Column)
* --- End of Automatically Added Context ---"
92c5f447,micro,12,defined points will be rectified,"W := 5.4
H := 3.4
Row1 := 300 + [H,0, 0,H] * 120.0
Col1 := 300 + [0, 0,W,W] * 120.0
vector_to_proj_hom_mat2d (Row, Col, Row1, Col1, 'normalized_dlt', [], [], [], [], [], [], HomMat2D, Covariance)",259,266,"* --- Automatically Added Context ---
area_center_points_xld (SelectedSegments, Area, Row, Column)
get_contour_xld (Parallel1, Row1, Col1)
Col := [330.071, 316.617, 971.032, 947.008]
* --- End of Auto..."
92c5f447,micro,13,,"read_image (ImageRef, 'bead/adhesive_bead_ref')",267,269,
92c5f447,micro,14,,"projective_trans_image (ImageRef, ImageRefTrans, HomMat2D, 'bilinear', 'false', 'false')",270,272,"* --- Automatically Added Context ---
vector_to_proj_hom_mat2d (Row, Col, Row1, Col1, 'normalized_dlt', [], [], [], [], [], [], HomMat2D, Covariance)
read_image (ImageRef, 'bead/adhesive_bead_ref')
* ..."
92c5f447,micro,15,"part on which the adhesive bead will be applied.
This planar part will also be used to align the
tes...","binary_threshold (ImageRefTrans, Region, 'smooth_histo', 'light', UsedThreshold)
opening_circle (Region, RegionOpening, 5.5)
connection (RegionOpening, ConnectedRegions)
area_center (ConnectedRegions, AreaCR, RowCR, ColumnCR)
select_obj (ConnectedRegions, ObjectSelected, sort_index(-AreaCR)[0] + 1)
...",273,298,"* --- Automatically Added Context ---
prepare_alignment (RegionPart, RowT, ColumnT, ModelID)
projective_trans_image (ImageRef, ImageRefTrans, HomMat2D, 'bilinear', 'false', 'false')
* --- End of Autom..."
9b30a5a4,full,0,Saving an OCV tool to file,"read_image (Image, 'a01')
threshold (Image, Region, 0, 100)
shape_trans (Region, RegionTrans, 'rectangle1')
dilation_rectangle1 (RegionTrans, RegionDilation, 10, 10)
reduce_domain (Image, RegionDilation, ImageReduced)
create_ocv_proj ('A', OCVHandle)
traind_ocv_proj (ImageReduced, OCVHandle, 'A', 's...",8,20,
9b30a5a4,micro,1,,"read_image (Image, 'a01')
threshold (Image, Region, 0, 100)
shape_trans (Region, RegionTrans, 'rectangle1')
dilation_rectangle1 (RegionTrans, RegionDilation, 10, 10)",6,11,
9b30a5a4,micro,2,,"reduce_domain (Image, RegionDilation, ImageReduced)",12,13,"* --- Automatically Added Context ---
read_image (Image, 'a01')
dilation_rectangle1 (RegionTrans, RegionDilation, 10, 10)
* --- End of Automatically Added Context ---"
9b30a5a4,micro,3,,"create_ocv_proj ('A', OCVHandle)
traind_ocv_proj (ImageReduced, OCVHandle, 'A', 'single')
write_ocv (OCVHandle, 'test_ocv.ocv')
OCVHandle := []
stop ()
read_ocv ('test_ocv.ocv', OCVHandle)",14,26,"* --- Automatically Added Context ---
reduce_domain (Image, RegionDilation, ImageReduced)
* --- End of Automatically Added Context ---"
5d5e3f51,full,0,"This example shows how to improve defect detection on partially
specular surfaces using deflectometr...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_disp_intro_text ()
stop ()
dev_set_draw ('margin')
dev_set_line_width (3)
create_structured_light_model ('deflectometry', StructuredLightMo...",19,368,
5d5e3f51,micro,1,"be achieved with this pattern type in comparison to the default type.
For a detailed example of the ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_disp_intro_text ()
stop ()
dev_set_draw ('margin')
dev_set_line_width (3)",14,28,
5d5e3f51,micro,2,gray_code_and_phase_shift and set its necessary parameters.,"create_structured_light_model ('deflectometry', StructuredLightModel)
PatternWidth := 1600
PatternHeight := 1200
MinStripeWidth := 32
MinGrayDifference := 0
Persistence := 'true'
Normalization := 'inverted_pattern'
set_structured_light_model_param (StructuredLightModel, ['pattern_width', 'pattern_he...",29,39,
5d5e3f51,micro,3,,"gen_structured_light_pattern (PatternImages, StructuredLightModel)",43,44,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
* --- End of Automatically Added Context ---"
5d5e3f51,micro,4,,"count_obj (PatternImages, Number)
gen_empty_obj (CameraImages)
for Index := 1 to Number by 1
read_image (Image, 'structured_light/varnished_metal_sheet/varnished_metal_sheet_' + Index$'02' + '.png')
concat_obj (CameraImages, Image, CameraImages)
endfor",45,51,"* --- Automatically Added Context ---
gen_structured_light_pattern (PatternImages, StructuredLightModel)
* --- End of Automatically Added Context ---"
5d5e3f51,micro,5,,"decode_structured_light_pattern (CameraImages, StructuredLightModel)",52,53,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
gen_empty_obj (CameraImages)
* --- End of Automatically Added Context ---"
5d5e3f51,micro,6,,"get_structured_light_object (BinarizedImages, StructuredLightModel, 'binarized_image')
stop ()
InspectSegmentation := 'false'
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')",54,61,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
* --- End of Automatically Added Context ---"
5d5e3f51,micro,7,"The idea here is to call the procedure and check
whether the decoded bright regions match the bright...","if (InspectSegmentation == 'true')
select_obj (CameraImages, CameraImagesGC, [1:2:28])
dev_set_window (WindowHandle2)
dev_clear_window ()
Text := 'The decoded bright regions for min_gray_difference = 0.'
Text[1] := ' '
Text[2] := 'If the visualized region does not match the bright region on the'
Tex...",62,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_structured_light_model ('deflectometry', StructuredLightModel)
gen_structured_light_pattern (Patte..."
5d5e3f51,micro,8,inverted_pattern normalization.,"select_obj (CameraImages, CameraImage1, 1)
select_obj (CameraImages, CameraImage2, 2)
dev_set_window (WindowHandle1)
dev_display (CameraImage1)
dev_disp_text ('First camera image.', 'window', 12, 12, 'black', [], [])
dev_set_window (WindowHandle2)
dev_display (CameraImage2)
dev_disp_text ('Second ca...",85,117,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
gen_empty_obj (CameraImages)
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
get_structured_li..."
5d5e3f51,micro,9,,"get_structured_light_object (CorrespondenceImages, StructuredLightModel, 'correspondence_image')
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (CorrespondenceImages)
dev_disp_text ('A wrongly decoded correspondence image.', 'window', 12, 12, 'black', [], [])
gen_rectangle1 (Problema...",118,128,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_structured_light_model ('deflectometry', StructuredLightModel)
dev_open_window (0, 609, 600, 450, ..."
5d5e3f51,micro,10,,"get_structured_light_object (DefectImage, StructuredLightModel, 'defect_image')
scale_image_range (DefectImage, ScaledDefectImage, 0, 4)
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (ScaledDefectImage)
dev_display (ProblematicRegion)
dev_disp_text ('Scaled defect image with default...",129,141,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
create_structured_light_model ('deflectometry', StructuredLightModel)
dev_open_window (0, 609, 600, 450, ..."
5d5e3f51,micro,11,single_stripe and set the necessary parameters.,"create_structured_light_model ('deflectometry', StructuredLightModelSS)
PatternType := 'single_stripe'
SingleStripeWidth := 64
set_structured_light_model_param (StructuredLightModelSS, ['pattern_width', 'pattern_height', 'min_stripe_width', 'min_gray_difference', 'pattern_type', 'single_stripe_width...",142,147,"* --- Automatically Added Context ---
PatternWidth := 1600
PatternHeight := 1200
MinStripeWidth := 32
MinGrayDifference := 0
Persistence := 'true'
* --- End of Automatically Added Context ---"
5d5e3f51,micro,12,,"gen_structured_light_pattern (PatternImagesSS, StructuredLightModelSS)
dev_open_window (510, 0, 900, 220, 'black', WindowHandle3)
set_display_font (WindowHandle3, 14, 'mono', 'true', 'false')
dev_disp_single_stripe_text ()",151,155,"* --- Automatically Added Context ---
dev_open_window (510, 0, 900, 220, 'black', WindowHandle3)
create_structured_light_model ('deflectometry', StructuredLightModelSS)
* --- End of Automatically Adde..."
5d5e3f51,micro,13,,"dev_set_window (WindowHandle1)
SingleStripesNum := round((PatternWidth + PatternHeight) / real(SingleStripeWidth))
count_obj (PatternImagesSS, NumberSS)
gen_empty_obj (CameraImagesSS)
for Index := 1 to NumberSS by 1
select_obj (PatternImagesSS, Image, Index)
read_image (CameraImage, 'structured_ligh...",156,180,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
PatternWidth := 1600
PatternHeight := 1200
for Index := 1 to Number by 1
read_image (Image, 'structured_l..."
5d5e3f51,micro,14,,"get_structured_light_object (CorrespondenceImagesSS, StructuredLightModelSS, 'correspondence_image')
dev_disp_comparison (CorrespondenceImagesSS, CorrespondenceImages, WindowHandle1, WindowHandle2, 'Correspondence image with single_stripe shows\n   - expected gradual change in gray values,\n   - no ...",181,184,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
get_structured_light_object (CorrespondenceIma..."
5d5e3f51,micro,15,,"get_structured_light_object (DefectImageSS, StructuredLightModelSS, 'defect_image')
scale_image_range (DefectImageSS, ScaledDefectImageSS, 0, 4)
dev_disp_comparison (ScaledDefectImageSS, ScaledDefectImage, WindowHandle1, WindowHandle2, 'Scaled defect image with single_stripe shows\n   - more pronoun...",185,374,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
InspectSegmentation := 'false'
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
Text := 'The de..."
814db61e,full,0,"This example shows the main workflow necessary when using the method
of deflectometry for defect det...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_displ_workflow_text ()
stop ()
create_structured_light_model ('deflectometry', StructuredLightModel)
PatternWidth := 1600
PatternHeight := 12...",12,368,
814db61e,micro,1,certain parameters need to be adapted to the particular setup.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_displ_workflow_text ()
stop ()",9,19,
814db61e,micro,2,"needs to be created and the parameters necessary for the
generation of the pattern images need to be...","create_structured_light_model ('deflectometry', StructuredLightModel)",20,24,
814db61e,micro,3,"Height and width of the pattern images that are to be
displayed on the monitor.","PatternWidth := 1600
PatternHeight := 1200",25,29,
814db61e,micro,4,images in addition to gray code images are displayed.,PatternType := 'gray_code_and_phase_shift',30,32,
814db61e,micro,5,"we display patterns with stripes in both the vertical and
the horizontal direction.",PatternOrientation := 'both',33,36,
814db61e,micro,6,"gray code images. The parameter is chosen such that the
smallest stripes are still clearly visible i...",MinStripeWidth := 8,37,41,
814db61e,micro,7,"the gray code images. In this case we use the type 'global'
in which a completely white image and a ...",Normalization := 'global',42,46,
814db61e,micro,8,,"set_structured_light_model_param (StructuredLightModel, ['pattern_width', 'pattern_height', 'pattern_type', 'pattern_orientation', 'min_stripe_width', 'normalization'], [PatternWidth,PatternHeight,PatternType,PatternOrientation,MinStripeWidth,Normalization])
dev_disp_parameters_text ()
stop ()",47,52,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
PatternWidth := 1600
PatternHeight := 1200
PatternType := 'gray_code_and_phase_shift'
Patter..."
814db61e,micro,9,,"gen_structured_light_pattern (PatternImages, StructuredLightModel)
dev_disp_acquisition_text ()
stop ()",53,57,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
* --- End of Automatically Added Context ---"
814db61e,micro,10,the corresponding camera images.,"acquire_camera_images_deflectometry (PatternImages, CameraImages, PatternWidth, PatternHeight)",58,61,"* --- Automatically Added Context ---
PatternWidth := 1600
PatternHeight := 1200
gen_structured_light_pattern (PatternImages, StructuredLightModel)
* --- End of Automatically Added Context ---"
814db61e,micro,11,"images and estimate the reliable pixels. This allows to
generate more robust results and also reduce...","UseModulation := true
if (UseModulation)
dev_disp_modulation_text ()
stop ()
ModulationType := 'phase_shift_saturation'
compute_structured_light_modulation (CameraImages, ModulationImage, StructuredLightModel, ModulationType)
MinPSSaturation := 60
MaxPSSaturation := 254
threshold (ModulationImage, R...",62,94,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
create_structured_light_model ('deflectometry', StructuredLightModel)
acquire_camera_images_deflectometry ..."
814db61e,micro,12,Set the parameter 'min_gray_difference' to a suitable value.,"MinGrayDifference := 130
set_structured_light_model_param (StructuredLightModel, 'min_gray_difference', MinGrayDifference)
dev_disp_decoding_text ()
stop ()
decode_structured_light_pattern (CameraImages, StructuredLightModel)",95,101,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
acquire_camera_images_deflectometry (PatternImages, CameraImages, PatternWidth, PatternHeigh..."
814db61e,micro,13,,"get_structured_light_object (CorrespondenceImages, StructuredLightModel, 'correspondence_image')
dev_clear_window ()
select_obj (CorrespondenceImages, CorrespondenceColumn, 1)
dev_display (CorrespondenceColumn)
dev_disp_text (['Correspondence image (1/2): Column values of the corresponding', '      ...",102,116,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
* --- End of Automatically Added Context ---"
814db61e,micro,14,,"dev_disp_defects_text ()
stop ()",117,119,
814db61e,micro,15,,"Sigma := 1
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
set_structured_light_model_param (StructuredLightModel, 'derivative_sigma', Sigma)
get_structured_light_object (DefectImage1, StructuredLightModel, 'defect_image')
scale_image_range (DefectImage1, ScaledDefectImage1, 0, 4)
dev_c...",120,129,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle)
create_structured_light_model ('deflectometry', StructuredLightModel)
* --- End of Automatically Added Con..."
814db61e,micro,16,,"Sigma := 5
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
dev_set_window (WindowHandle2)
set_structured_light_model_param (StructuredLightModel, 'derivative_sigma', Sigma)
get_structured_light_object (DefectImage5, StructuredL...",130,158,"* --- Automatically Added Context ---
create_structured_light_model ('deflectometry', StructuredLightModel)
Sigma := 1
dev_disp_text ('Defect image with \'derivative_sigma\' set to ' + Sigma + ':', 'w..."
814db61e,micro,17,"displayed. In this example, we display the pattern images
in an HDevelop graphics window for visuali...","dev_open_window (0, 0, 600, 450, 'black', WindowHandleScreen)
dev_open_window (0, 609, 600, 450, 'black', WindowHandleCamera)",159,167,
814db61e,micro,18,"gray value images of byte or uint2 type.
Adapt the call of open_framegrabber to your camera
and set ...","DirName := 'structured_light/tap_collar/'
open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', DirName, 'default', -1, -1, AcqHandle)",168,175,
814db61e,micro,19,"and acquire a camera image of the inspected specular
object that shows the reflection of the display...","count_obj (PatternImages, NumberOfPatternImages)
gen_empty_obj (CameraImages)
for Index := 1 to NumberOfPatternImages by 1
select_obj (PatternImages, DisplayImage, Index)
dev_set_window (WindowHandleScreen)
dev_display (DisplayImage)
dev_disp_text ('Pattern image ' + Index + ' of ' + NumberOfPattern...",176,198,"* --- Automatically Added Context ---
gen_structured_light_pattern (PatternImages, StructuredLightModel)
acquire_camera_images_deflectometry (PatternImages, CameraImages, PatternWidth, PatternHeight)
..."
814db61e,micro,20,,close_framegrabber (AcqHandle),199,201,"* --- Automatically Added Context ---
open_framegrabber ('File', -1, -1, -1, -1, -1, -1, 'default', -1, 'default', -1, 'default', DirName, 'default', -1, -1, AcqHandle)
* --- End of Automatically Adde..."
814db61e,micro,21,images were displayed.,"dev_set_window (WindowHandleCamera)
dev_close_window ()
dev_set_window (WindowHandleScreen)
dev_close_window ()
return ()
Text := 'This example shows how the Structured Light operators can be used to'
Text[1] := 'detect defects on a specular surface, by applying the method of'
Text[2] := 'deflectome...",202,374,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_disp_text ('Defect image with \'derivative_sigma\' set to ' + Sigma..."
71a02f79,full,0,"This example program demonstrates how to fine-tune
the texture inspection model.
First, a texture in...","dev_update_off ()
dev_close_window ()
read_image (Image, 'carpet/carpet_01')
get_image_size (Image, Width, Height)
NumImages := 7
TrainingImageIndices := [1, 2]
TextureModelFilename := 'texture_model_carpet'
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle1)
get_window_extents (Wi...",16,290,
71a02f79,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'carpet/carpet_01')
get_image_size (Image, Width, Height)
NumImages := 7",15,20,
71a02f79,micro,2,,"TrainingImageIndices := [1, 2]
TextureModelFilename := 'texture_model_carpet'",21,24,
71a02f79,micro,3,,"dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, WindowWidth, WindowHeight)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)
Message := 'This example program demonstrates ...",25,48,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
71a02f79,micro,4,(This only works if the example has been run before),"dev_clear_window ()
file_exists (TextureModelFilename + '.htim', FileExists)
if (FileExists)
read_texture_inspection_model (TextureModelFilename, TextureInspectionModel)
get_texture_inspection_model_param (TextureInspectionModel, 'levels', Levels)
Message := 'The previously trained texture inspectio...",49,115,"* --- Automatically Added Context ---
read_image (Image, 'carpet/carpet_01')
TrainingImageIndices := [1, 2]
TextureModelFilename := 'texture_model_carpet'
Message := 'This example program demonstrates..."
71a02f79,micro,5,"The novelty thresholds define for each pyramid level at which point the
distinction between defectiv...","get_texture_inspection_model_param (TextureInspectionModel, 'novelty_threshold', NoveltyThreshold)",116,123,"* --- Automatically Added Context ---
read_texture_inspection_model (TextureModelFilename, TextureInspectionModel)
* --- End of Automatically Added Context ---"
71a02f79,micro,6,apply_texture_inspection_model.,"set_texture_inspection_model_param (TextureInspectionModel, 'gen_result_handle', 'true')
dev_close_window ()
WindowWidth := 320
WindowHeight := 280
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window ...",124,140,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle1)
get_window_extents (WindowHandle1, Row, Column, WindowWidth, WindowHeight)
read_texture_insp..."
71a02f79,micro,7,,"for Index := 1 to 3 by 1
ImageIndex := 5
read_image (TestImage, 'carpet/carpet_' + ImageIndex$'02')
apply_texture_inspection_model (TestImage, NoveltyRegion, TextureInspectionModel, TextureInspectionResultID)
get_texture_inspection_result_object (NovScoreImage, TextureInspectionResultID, 'novelty_sc...",141,240,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
get_window_extents (WindowHandle1, Row, Column, WindowWidth, WindowHeight)
Message := 'This example program demonstrates how..."
71a02f79,micro,8,,"for Index := 1 to NumImages by 1
read_image (TestImage, 'carpet/carpet_' + Index$'02')
apply_texture_inspection_model (TestImage, NoveltyRegion, TextureInspectionModel, TextureInspectionResultID)
get_texture_inspection_result_object (NovScoreImage, TextureInspectionResultID, 'novelty_score_image')
g...",241,296,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
NumImages := 7
get_window_extents (WindowHandle1, Row, Column, WindowWidth, WindowHeight)
read_texture_inspection_model (Tex..."
287c286a,full,0,"This example shows the usage and advantage of a texture
inspection model that has been trained with ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)
Message := 'This example demonstrates the usage and advantage'
Message[1] := 'of a texture inspect...",14,175,
287c286a,micro,1,"models. One for the gray-scale images and one that
processes the RGB images.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)
Message := 'This example demonstrates the usage and advantage'
Message[1] := 'of a texture inspect...",11,32,
287c286a,micro,2,,"TrainImageFiles := ['leather/good/leather_good_01.png', 'leather/good/leather_good_02.png']",33,34,
287c286a,micro,3,,"TestImageFiles := ['leather/defect/leather_defect_01.png', 'leather/defect/leather_defect_02.png', 'leather/defect/leather_defect_03.png', 'leather/defect/leather_defect_04.png', 'leather/defect/leather_defect_05.png', 'leather/defect/leather_defect_06.png']",35,37,
287c286a,micro,4,image pyramid levels.,"create_texture_inspection_model ('basic', TextureInspectionModelColor)
set_texture_inspection_model_param (TextureInspectionModelColor, 'levels', [2, 3])
create_texture_inspection_model ('basic', TextureInspectionModelGray)
set_texture_inspection_model_param (TextureInspectionModelGray, 'levels', [2...",38,45,
287c286a,micro,5,,"for ImageIndex := 0 to |TrainImageFiles| - 1 by 1
read_image (TrainImage, TrainImageFiles[ImageIndex])
rgb1_to_gray (TrainImage, GrayTrainImage)
dev_set_window (WindowHandle)
dev_display (TrainImage)
if (ImageIndex == 0)
Message := 'The images are added to the '
Message[1] := 'texture inspection mod...",46,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Message := 'This example demonstrates the usage and advantage'
dev_disp_text ('Press Run (F5) to continue'..."
287c286a,micro,6,,"FileNameGrayScale := 'texture_inspection_model.htim'
FileNameColor := 'texture_inspection_model_color.htim'
file_exists (FileNameGrayScale, FileExistsGrayScale)
file_exists (FileNameColor, FileExistsColor)
dev_clear_window ()
if (not FileExistsGrayScale or not FileExistsColor)
Message := 'Training t...",65,96,"* --- Automatically Added Context ---
Message := 'This example demonstrates the usage and advantage'
create_texture_inspection_model ('basic', TextureInspectionModelColor)
create_texture_inspection_mo..."
287c286a,micro,7,and visually compare their performance.,"read_image (TestImage, TestImageFiles[0])
dev_display (TestImage)
Message := 'The models are applied to images with'
Message[1] := 'defects.'
Message[3] := 'The sensitivity of the models can be adapted'
Message[4] := 'by either setting the \'sensitivity\''
Message[5] := 'or the \'novelty_threshold\'...",97,109,"* --- Automatically Added Context ---
Message := 'This example demonstrates the usage and advantage'
TestImageFiles := ['leather/defect/leather_defect_01.png', 'leather/defect/leather_defect_02.png', ..."
287c286a,micro,8,,"set_texture_inspection_model_param (TextureInspectionModelColor, 'sensitivity', -60)
set_texture_inspection_model_param (TextureInspectionModelGray, 'sensitivity', -20)
dev_open_window (0, 514, 512, 512, 'black', WindowHandleGray)
set_display_font (WindowHandleGray, 16, 'mono', 'true', 'false')
dev_...",110,185,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Message := 'This example demonstrates the usage and advantage'
TestImageFiles := ['leather/defect/leather_..."
af77f136,full,0,"This example program demonstrates how to detect texture
defects with the texture inspection model.
F...","dev_update_off ()
dev_close_window ()
read_image (Image, 'isolation_foam/isolation_foam_01')
get_image_size (Image, Width, Height)
NumImages := 6
TrainingImageIndices := [1, 2]
TrainingROIs := {[20, 70], [300, 30], [500, 250], [600, 600]}
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, Window...",14,131,
af77f136,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Image, 'isolation_foam/isolation_foam_01')
get_image_size (Image, Width, Height)
NumImages := 6",13,18,
af77f136,micro,2,,"TrainingImageIndices := [1, 2]
TrainingROIs := {[20, 70], [300, 30], [500, 250], [600, 600]}",19,22,
af77f136,micro,3,,"dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
get_window_extents (WindowHandle, Row, Column, WindowWidth, WindowHeight)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
Message := 'This example program demonstrates how to detect texture'
Mes...",23,39,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
af77f136,micro,4,,"create_texture_inspection_model ('basic', TextureInspectionModel)",40,42,
af77f136,micro,5,,"for Index := 0 to |TrainingImageIndices| - 1 by 1
read_image (Image, 'isolation_foam/isolation_foam_' + TrainingImageIndices[Index]$'02')
gen_rectangle1 (Rectangle, TrainingROIs.at(0)[Index], TrainingROIs.at(1)[Index], TrainingROIs.at(2)[Index], TrainingROIs.at(3)[Index])
reduce_domain (Image, Recta...",43,65,"* --- Automatically Added Context ---
read_image (Image, 'isolation_foam/isolation_foam_01')
TrainingImageIndices := [1, 2]
TrainingROIs := {[20, 70], [300, 30], [500, 250], [600, 600]}
Message := 'Th..."
af77f136,micro,6,,"dev_clear_window ()
Message[0] := 'Train the texture inspection model.'
Message[1] := ' '
Message[2] := 'This may take a minute (see the'
Message[3] := 'status bar for the progress).'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])",66,73,"* --- Automatically Added Context ---
Message := 'This example program demonstrates how to detect texture'
* --- End of Automatically Added Context ---"
af77f136,micro,7,Set normalization to 'weber' to allow the handling of images with different brightness.,"set_texture_inspection_model_param (TextureInspectionModel, 'patch_normalization', 'weber')",74,77,"* --- Automatically Added Context ---
create_texture_inspection_model ('basic', TextureInspectionModel)
* --- End of Automatically Added Context ---"
af77f136,micro,8,"Adjusting this parameter is usually not necessary.
It is done here to guarantee identical results to...","set_texture_inspection_model_param (TextureInspectionModel, 'gmm_preprocessing', 'none')",78,82,"* --- Automatically Added Context ---
create_texture_inspection_model ('basic', TextureInspectionModel)
* --- End of Automatically Added Context ---"
af77f136,micro,9,"In many cases, the defects can be detected on lower resolutions
(corresponding to higher pyramid lev...","set_texture_inspection_model_param (TextureInspectionModel, 'levels', [2, 3, 4, 5])",83,91,"* --- Automatically Added Context ---
create_texture_inspection_model ('basic', TextureInspectionModel)
* --- End of Automatically Added Context ---"
af77f136,micro,10,,train_texture_inspection_model (TextureInspectionModel),92,94,"* --- Automatically Added Context ---
create_texture_inspection_model ('basic', TextureInspectionModel)
* --- End of Automatically Added Context ---"
af77f136,micro,11,,"dev_clear_window ()
Message := 'Next, the trained texture model can be applied'
Message[1] := 'to detect texture defects...'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()
for Index := 1 to...",95,137,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
NumImages := 6
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
get_window_extents (WindowHandle, Row, C..."
88f34081,full,0,Arithmetic operations,"R1 := 5 * 5
R2 := 5 * 5
R3 := [1, 2, 3] * 2
R4 := [1, 2, 3] * 2.1 + 10
R5 := [1, 2, 3] * [1, 2, 3]
R6 := 'Text1' + 'Text2'
R7 := 17.23 + 'Text'
R8 := 'Text1 ' + 99 + ' Text2'
R9 := 'Text ' + 3.1 * 2
R10 := 3.1 + 2 + ' Text'
R11 := 3.1 + (2 + ' Text')
R12 := 'Text ' + 2.1 + 3
ThatIsAnError := 3.1 * (...",7,20,
88f34081,micro,1,,"R1 := 5 * 5
R2 := 5 * 5
R3 := [1, 2, 3] * 2
R4 := [1, 2, 3] * 2.1 + 10
R5 := [1, 2, 3] * [1, 2, 3]
R6 := 'Text1' + 'Text2'
R7 := 17.23 + 'Text'
R8 := 'Text1 ' + 99 + ' Text2'
R9 := 'Text ' + 3.1 * 2
R10 := 3.1 + 2 + ' Text'
R11 := 3.1 + (2 + ' Text')
R12 := 'Text ' + 2.1 + 3
ThatIsAnError := 3.1 * (...",6,26,
cc755526,full,0,,"Number := 128
LShift := lsh(Number,2)
RShift := rsh(Number,2)
Select := Number band 1
Select := 127 band 4
Set := 127 bor lsh(1,7)",6,11,
65080334,full,0,,"R1 := 1 == 1.0
R2 := [] == []
R3 := '' == []
R4 := [1, '2'] == [1, 2]
R5 := [1, 2, 3] == [1, 2]
R6 := [4711, 'Hugo'] == [4711, 'Hugo']
R7 := 'Hugo' == 'hugo'
R8 := 2 &gt; 1
R9 := 2 &gt; 1.0
R10 := [5, 4, 1] &gt; [5, 4]
R11 := [2, 1] &gt; [2, 0]
R12 := 'Hugo' &lt; 'hugo'
R13 := true &gt; false",6,18,
e22dbfc7,full,0,,"read_image (Image, 'printer_chip/printer_chip_01')
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'SingleInteger', 27)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
set_dict_object (Image, DictHandle, 'SingleImage')
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
RightAnswer :...",6,38,
e22dbfc7,micro,1,,create_dict (DictHandle),8,9,
e22dbfc7,micro,2,,"set_dict_tuple (DictHandle, 'SingleInteger', 27)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
set_dict_object (Image, DictHandle, 'SingleImage')",10,13,"* --- Automatically Added Context ---
read_image (Image, 'printer_chip/printer_chip_01')
create_dict (DictHandle)
* --- End of Automatically Added Context ---"
e22dbfc7,micro,3,,"get_dict_tuple (DictHandle, 'MixedTuple', Tuple)",14,15,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
* --- End of Automatically Added Context ---"
e22dbfc7,micro,4,,"RightAnswer := Tuple[1] + 1
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer',RightAnswer])
stop ()",16,20,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
* --- End of Automatically..."
e22dbfc7,micro,5,Add data.,"DictHandle := dict{['SingleInteger']: 27, ['MixedTuple']: ['The answer', 41]}
read_image (DictHandle.['SingleImage'], 'printer_chip/printer_chip_01')",21,24,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'SingleInteger', 27)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
set_dict_object (Image, Di..."
e22dbfc7,micro,6,,RightAnswer := DictHandle.['MixedTuple'][1] + 1,25,26,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
RightAnswer := Tuple[1] + ..."
e22dbfc7,micro,7,,"DictHandle.['MixedTuple'] := ['The answer',RightAnswer]
stop ()",27,30,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
RightAnswer := Tuple[1] + ..."
e22dbfc7,micro,8,Add data.,"DictHandle := dict{SingleInteger: 27, MixedTuple: ['The answer', 41]}
read_image (DictHandle.SingleImage, 'printer_chip/printer_chip_01')",31,34,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'SingleInteger', 27)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
set_dict_object (Image, Di..."
e22dbfc7,micro,9,,RightAnswer := DictHandle.MixedTuple[1] + 1,35,36,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
RightAnswer := Tuple[1] + ..."
e22dbfc7,micro,10,,"DictHandle.MixedTuple := ['The answer',RightAnswer]",37,44,"* --- Automatically Added Context ---
create_dict (DictHandle)
set_dict_tuple (DictHandle, 'MixedTuple', ['The answer', 41])
get_dict_tuple (DictHandle, 'MixedTuple', Tuple)
RightAnswer := Tuple[1] + ..."
ebceac65,full,0,,"V1 := [18.8, 132.4, 33, 19.3]
V2 := [233.23, 32.786, 234.4224, 63.33]
Diff := V1 - V2
Distance := sqrt(sum(Diff * Diff))
Scalarproduct := sum(V1 * V2)",6,10,
d587ba27,full,0,Compute the sine from 0 to 3*PI and print to the graphical window,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_part (0, 0, 511, 511)
old_x := 0
old_y := 0
dev_set_color ('red')
for x := 1 to 511 by 4
y := sin(x / 511.0 * 2 * 3.1416 * 3) * 255
disp_line (WindowID, old_y + 256, old_x, y + 256, x)
old_x := x
old_y := y
endfor",8,19,
d587ba27,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_part (0, 0, 511, 511)
old_x := 0
old_y := 0
dev_set_color ('red')
for x := 1 to 511 by 4
y := sin(x / 511.0 * 2 * 3.1416 * 3) * 255
disp_line (WindowID, old_y + 256, old_x, y + 256, x)
old_x := x
old_y := y
endfor",6,25,
042cfc92,full,0,String types,"i1 := 123$'#o'
i2 := 123$'#x'
i3 := 123$'#X'
i4 := 123$'#f'
i5 := 123$'#g'
i6 := 123$'#G'
i7 := 123$'#e'
i8 := 123$'#E'
d1 := 123$'6'
d2 := 123$'-6'
d3 := 123$'.6'
d4 := 123$'10.5'
g1 := 123.456$'.1'
g2 := 123.456$'.2'
g3 := 123.456$'.3'
g4 := 123.456$'.4'
g5 := 123.456$'.5'
g6 := 123.456$'.15'
g7 :...",8,31,
042cfc92,micro,1,,"i1 := 123$'#o'
i2 := 123$'#x'
i3 := 123$'#X'
i4 := 123$'#f'
i5 := 123$'#g'
i6 := 123$'#G'
i7 := 123$'#e'
i8 := 123$'#E'
d1 := 123$'6'
d2 := 123$'-6'
d3 := 123$'.6'
d4 := 123$'10.5'
g1 := 123.456$'.1'
g2 := 123.456$'.2'
g3 := 123.456$'.3'
g4 := 123.456$'.4'
g5 := 123.456$'.5'
g6 := 123.456$'.15'
g7 :...",6,37,
83040edb,full,0,Simple tuple operations,"Tuple1 := [1, 2, 3, 4, 5]
Number := |Tuple1|
SingleElement := Tuple1[3]
Part := Tuple1[1:3]
Copy := Tuple1[0:|Tuple1| - 1]",8,12,
83040edb,micro,1,,"Tuple1 := [1, 2, 3, 4, 5]
Number := |Tuple1|
SingleElement := Tuple1[3]
Part := Tuple1[1:3]
Copy := Tuple1[0:|Tuple1| - 1]",6,18,
b18a1e01,full,0,"This example program shows how to use HALCON's
operator determine_ncc_model_params to determine
the ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
for Index := 1 to 3 by 1
if (Index == 1)
read_image (Image, 'smd/smd_on_chip_05')
gen_rectangle1 (Rectangle, 180, 180, 430, 450)
elseif (Index == 2)
read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 3...",10,43,
b18a1e01,micro,1,"operator determine_ncc_model_params to determine
the parameters for a correlation-based matching.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
for Index := 1 to 3 by 1
if (Index == 1)
read_image (Image, 'smd/smd_on_chip_05')
gen_rectangle1 (Rectangle, 180, 180, 430, 450)
elseif (Index == 2)
read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 3...",6,49,
c9e26da8,full,0,"This example program shows how to use HALCON's correlation-based
matching.  In particular it demonst...","dev_update_off ()
read_image (Image, 'smd/smd_on_chip_05')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
gen_rectangle...",11,36,
c9e26da8,micro,1,"matching.  In particular it demonstrates the robustness of this method against
varying texture and d...","dev_update_off ()
read_image (Image, 'smd/smd_on_chip_05')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_set_draw ('margin')
gen_rectangle...",6,42,
4f26e413,full,0,"Purpose of this example is to examine the deviation of the ncc detection
results from its reference ...","dev_close_window ()
read_image (ImageRef, 'pcb_focus/pcb_focus_telecentric_061')
get_image_size (ImageRef, Width, Height)
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_co...",12,66,
4f26e413,micro,1,"results from its reference model while the focus of the lens changes
iteratively over the sequence. ...","dev_close_window ()
read_image (ImageRef, 'pcb_focus/pcb_focus_telecentric_061')
get_image_size (ImageRef, Width, Height)
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_set_draw ('margin')
dev_set_co...",6,21,
4f26e413,micro,2,,"dev_clear_window ()
dev_display (TemplateImage)
disp_message (WindowHandle, 'Creating the ncc model may take a few seconds ... ', 'window', 12, 12, 'black', 'true')
create_ncc_model (TemplateImage, 'auto', -rad(5), rad(10), 'auto', 'use_polarity', ModelID)",22,29,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
4f26e413,micro,3,,"set_window_param (WindowHandle, 'flush', 'false')",30,32,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
4f26e413,micro,4,,"area_center (ModelRegion, Area, ModelRow, ModelColumn)
Rows := []
Columns := []
for Index := 1 to 121 by 1
find_ncc_model (Image, ModelID, -rad(5), rad(10), 0.5, 1, 0.5, 'true', 0, Row, Column, Angle, Score)
Rows := [Rows,Row]
Columns := [Columns,Column]
dev_display (Image)
dev_display_ncc_matching_...",33,49,"* --- Automatically Added Context ---
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHandle)
create_ncc_model (TemplateImage, 'auto', -rad(5), rad(10), 'auto', 'use_polarity', ModelID)
* ---..."
4f26e413,micro,5,,"dev_display (Image)
wait_seconds (1)
gen_contour_polygon_xld (Contour, Rows, Columns)
fit_line_contour_xld (Contour, 'tukey', -1, 0, 5, 2, RowBegin, ColBegin, RowEnd, ColEnd, Nr, Nc, Dist)
gen_contour_polygon_xld (Regression, [RowBegin,RowEnd], [ColBegin,ColEnd])",50,55,"* --- Automatically Added Context ---
Rows := []
Columns := []
find_ncc_model (Image, ModelID, -rad(5), rad(10), 0.5, 1, 0.5, 'true', 0, Row, Column, Angle, Score)
* --- End of Automatically Added Con..."
4f26e413,micro,6,,"Ratio := (394 - 389 + 1) / real(252 - 250 + 1)
dev_resize_window_fit_size (0, 0, Height * Ratio, Height, 640, 480)
dev_set_part (250, 389, 252, 394)
dev_display (ImageRef)
dev_set_color ('green')
dev_display (Contour)
dev_set_color ('yellow')
dev_display (Regression)
disp_message (WindowHandle, ['De...",56,72,"* --- Automatically Added Context ---
read_image (ImageRef, 'pcb_focus/pcb_focus_telecentric_061')
get_image_size (ImageRef, Width, Height)
dev_open_window_fit_image (ImageRef, 0, 0, -1, -1, WindowHan..."
7edfd007,full,0,"This example program shows how to use HALCON's correlation-based
matching. In particular it demonstr...","read_image (Image, 'cap_exposure/cap_exposure_03')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
gen_circle (Circle, 246, 336, 150)
area_center (Circle, Area, RowRef, ColumnRef)
reduce_...",11,47,
7edfd007,micro,1,"matching. In particular it demonstrates the robustness of this method against
linear illumination ch...","read_image (Image, 'cap_exposure/cap_exposure_03')
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_update_off ()
gen_circle (Circle, 246, 336, 150)
area_center (Circle, Area, RowRef, ColumnRef)
reduce_...",6,41,
7edfd007,micro,2,"positions in Rows and Cols are examined, it can be seen that the standard
deviation is caused mainly...","StdDevRows := deviation(Rows)
StdDevCols := deviation(Cols)",42,53,"* --- Automatically Added Context ---
Rows := []
Cols := []
* --- End of Automatically Added Context ---"
646a2cc4,full,0,"*****************************************************
This example shows the workflow of NCC matchin...","dev_update_off ()
dev_close_window ()
read_image (Image, 'face_masks/face_mask_01')
get_image_size (Image, Width0, Height0)
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
dev_set_draw ('marg...",12,208,
646a2cc4,micro,1,,"dev_update_off ()
dev_close_window ()",11,14,
646a2cc4,micro,2,,"read_image (Image, 'face_masks/face_mask_01')
get_image_size (Image, Width0, Height0)
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
dev_set_draw ('margin')
dev_set_line_width (3)
dev_displa...",15,24,
646a2cc4,micro,3,,"get_handle_tuple (WindowHandle, 'Width', Width)
get_handle_tuple (WindowHandle, 'Height', Height)
dev_open_window_fit_size (0, Width + 8, Width0 / 2, Height0, -1, Height, WindowHandleText)
set_display_font (WindowHandleText, 16, 'mono', 'true', 'false')
dev_disp_description_text_introduction (Window...",25,32,"* --- Automatically Added Context ---
get_image_size (Image, Width0, Height0)
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
646a2cc4,micro,4,,"gen_rectangle2 (ROI, 616.5, 708.5, rad(-82.4054), 50, 35)
reduce_domain (Image, ROI, ImageReduced)",37,40,"* --- Automatically Added Context ---
read_image (Image, 'face_masks/face_mask_01')
* --- End of Automatically Added Context ---"
646a2cc4,micro,5,,"dev_set_window (WindowHandle)
dev_display (ROI)
dev_disp_description_text_application_area (WindowHandleText)
stop ()",41,46,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
dev_open_window_fit_size (0, Width + 8, Width0 / 2, Height0, -1, Height, WindowHandleText)
..."
646a2cc4,micro,6,,"create_ncc_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 'use_polarity', ModelID)",51,53,"* --- Automatically Added Context ---
reduce_domain (Image, ROI, ImageReduced)
* --- End of Automatically Added Context ---"
646a2cc4,micro,7,"3. Find objects (online step)                       *
**********************************************...","dev_disp_description_text_find_model (WindowHandleText)
NumImages := 5
for Index := 1 to NumImages by 1
read_image (Image, 'face_masks/face_mask_' + Index$'02')
count_seconds (T0)
find_ncc_model (Image, ModelID, rad(0), rad(360), 0.7, 1, 0.5, 'true', 0, Row, Column, Angle, Score)
count_seconds (T1)
...",54,81,"* --- Automatically Added Context ---
read_image (Image, 'face_masks/face_mask_01')
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
dev_open_window_fit_size (0, Width + 8, Width..."
646a2cc4,micro,8,"*****************************************************
End of program                                ...","disp_end_of_program_message (WindowHandle, 'black', 'true')
dev_set_window (WindowHandleText)
dev_close_window ()
dev_update_on ()",82,101,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
dev_open_window_fit_size (0, Width + 8, Width0 / 2, Height0, -1, Height, WindowHandleText)
..."
646a2cc4,micro,9,,"dev_set_window (WindowHandle)
Text := 'This example shows the workflow'
Text[|Text|] := 'of NCC matching, by checking the'
Text[|Text|] := 'presence of the CE logo.'
Text[|Text|] := ''
Text[|Text|] := 'The workflow is as follows:'
Text[|Text|] := ''
Text[|Text|] := '1. Define the model. - offline st...",102,130,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
select_color_and_text_for_visualization (Score, Time, Color, Text)
* --- End of Automatical..."
646a2cc4,micro,10,,"dev_set_window (WindowHandle)
dev_clear_window ()
Text := 'Define the template for the NCC model: '
Text[|Text|] := ''
Text[|Text|] := 'NCC matching is particularly well '
Text[|Text|] := 'suited to find instances with e.g.,'
Text[|Text|] := ''
Text[|Text|] := '- slightly changing shapes,'
Text[|Tex...",131,163,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
select_color_and_text_for_visualization (Score, Time, Color, Text)
Text[|Text|] := 'of NCC ..."
646a2cc4,micro,11,,"dev_set_window (WindowHandle)
dev_clear_window ()
Text := 'Find the NCC model in the image:'
Text[|Text|] := ''
Text[|Text|] := 'The decision whether CE logo is'
Text[|Text|] := 'present or not is done by setting'
Text[|Text|] := 'the MinScore to 0.7.'
dev_disp_text (Text, 'window', 'top', 'left', '...",164,194,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, Width0, Height0, -1, -1, WindowHandle)
select_color_and_text_for_visualization (Score, Time, Color, Text)
Text[|Text|] := 'of NCC ..."
646a2cc4,micro,12,of the result based on the number of matches.,"if (|Score| == 0)
Color := 'red'
Text := 'Result:  CE logo is missing'
Text[1] := 'Runtime: ' + Time$'.1f' + '[ms]'
else
Color := 'forest green'
Text[0] := 'Result:  CE logo is present'
Text[1] := 'Runtime: ' + Time$'.1f' + '[ms]'
Text[2] := 'Score:   ' + Score$'.2f'
endif
return ()",195,219,"* --- Automatically Added Context ---
find_ncc_model (Image, ModelID, rad(0), rad(360), 0.7, 1, 0.5, 'true', 0, Row, Column, Angle, Score)
Time := (T1 - T0) * 1000
select_color_and_text_for_visualizat..."
2fb61c5c,full,0,"This example shows the technical workflow of Deep Counting
on three different sample image sets.","ImageSets := ['pipes', 'flasks', 'rods']
dev_update_off ()
create_deep_counting_model ([], [], DeepCountingHandle)
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
set_deep_counting_model_param (DeepCountingHandle, 'device', DLDeviceHandles[0])
for Index := 0 to |...",10,93,
2fb61c5c,micro,1,on three different sample image sets.,"ImageSets := ['pipes', 'flasks', 'rods']
dev_update_off ()",7,12,
2fb61c5c,micro,2,the different objects by changing the templates.,"create_deep_counting_model ([], [], DeepCountingHandle)",13,15,
2fb61c5c,micro,3,,"query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDeviceHandles)
set_deep_counting_model_param (DeepCountingHandle, 'device', DLDeviceHandles[0])",16,19,"* --- Automatically Added Context ---
create_deep_counting_model ([], [], DeepCountingHandle)
* --- End of Automatically Added Context ---"
2fb61c5c,micro,4,,"for Index := 0 to |ImageSets| - 1 by 1
ImageSet := ImageSets[Index]
read_image (TemplateImage, 'counting/' + ImageSet + '_01')
read_object (TemplateRegions, 'template_regions_' + ImageSet)
get_image_size (TemplateImage, Width, Height)
dev_open_window_fit_image (TemplateImage, 0, 0, 800, 600, WindowH...",20,100,"* --- Automatically Added Context ---
ImageSets := ['pipes', 'flasks', 'rods']
create_deep_counting_model ([], [], DeepCountingHandle)
* --- End of Automatically Added Context ---"
731ece3e,full,0,"This example shows the typical workflow of a Deep Counting application.
Initialization.","dev_update_off ()
dev_get_window (WindowHandle)
if (WindowHandle == -1)
dev_open_window (0, 0, 600, 512, 'black', WindowHandle)
endif
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
list_image_files ('bottles/', 'default', [], ImageFiles)
tuple_regexp_select (ImageFiles, 'crate*', Bottl...",10,229,
731ece3e,micro,1,,"dev_update_off ()
dev_get_window (WindowHandle)
if (WindowHandle == -1)
dev_open_window (0, 0, 600, 512, 'black', WindowHandle)
endif
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",9,16,
731ece3e,micro,2,,"list_image_files ('bottles/', 'default', [], ImageFiles)
tuple_regexp_select (ImageFiles, 'crate*', BottlesImages)",17,21,
731ece3e,micro,3,"Create a Deep Counting model. *
********************************
Per default nothing has to be set v...","dev_clear_window ()
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_disp_text ('Creating Deep Counting Model...', 'window', 'top', 'left', 'black', [], [])
cre...",22,37,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
* --- End of Automatically Added Context ---"
731ece3e,micro,4,,"* get_deep_counting_model_param (DeepCountingHandle, 'scale_min', ScaleMin)
* set_deep_counting_model_param (DeepCountingHandle, 'angle_end', rad(90))",38,41,"* --- Automatically Added Context ---
create_deep_counting_model ([], [], DeepCountingHandle)
* --- End of Automatically Added Context ---"
731ece3e,micro,5,,"dev_clear_window ()
dev_disp_text (['Done creating Deep Counting Model.', '', 'Next, an appropriate device is set for inference.'], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",42,45,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('Creating Deep..."
731ece3e,micro,6,,"stop ()
dev_clear_window ()
dev_disp_text ('Setting an appropriate device...', 'window', 'top', 'left', 'black', [], [])
query_available_dl_devices (['runtime', 'runtime'], ['gpu', 'cpu'], DLDevices)
DLDevice := DLDevices[0]
set_deep_counting_model_param (DeepCountingHandle, 'device', DLDevice)",46,56,"* --- Automatically Added Context ---
create_deep_counting_model ([], [], DeepCountingHandle)
* --- End of Automatically Added Context ---"
731ece3e,micro,7,"Draw templates *
*****************
Now we are ready to ""train"" our DeepCountingHandle but before tha...","dev_clear_window ()
dev_disp_text (['Done setting device.', '', 'Next, template regions are drawn interactively.'], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",57,65,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text (['Done creating Deep Counting Model.', '', 'Next, an appropriate device is set for inference.'], 'window', 'top', 'le..."
731ece3e,micro,8,,"stop ()
DrawImage := BottlesImages[0]
read_image (Image, DrawImage)
draw_deep_counting_templates (Image, TemplatesRegion, Templates)",66,73,"* --- Automatically Added Context ---
tuple_regexp_select (ImageFiles, 'crate*', BottlesImages)
* --- End of Automatically Added Context ---"
731ece3e,micro,9,"Prepare the Deep Counting model *
**********************************
The next step is the ""train"" st...","dev_clear_window ()
dev_disp_text (['Done drawing templates.', '', 'Next, the Deep Counting model is prepared using the drawn templates.'], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",74,80,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text (['Done creatin..."
731ece3e,micro,10,,"stop ()
prepare_deep_counting_model (Templates, DeepCountingHandle)",81,86,"* --- Automatically Added Context ---
create_deep_counting_model ([], [], DeepCountingHandle)
draw_deep_counting_templates (Image, TemplatesRegion, Templates)
* --- End of Automatically Added Context ..."
731ece3e,micro,11,"Infer the template image *
***************************
After a successful setting of the templates w...","dev_clear_window ()
dev_disp_text (['Done preparing Deep Counting model.', '', 'Next, the Deep Counting model is applied on the template image.'], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",87,96,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text (['Done creatin..."
731ece3e,micro,12,,"stop ()
apply_deep_counting_model (Image, DeepCountingHandle, Count, DeepCountingResult)
GenParamNameFont := 'font_size'
GenParamValueFont := '20'
GenParamName := [GenParamNameFont,'interactive_min_score']
GenParamValue := [GenParamValueFont,'true']
dev_display_deep_counting_results (Image, [], Deep...",97,113,"* --- Automatically Added Context ---
create_deep_counting_model ([], [], DeepCountingHandle)
read_image (Image, DrawImage)
* --- End of Automatically Added Context ---"
731ece3e,micro,13,"Inspect the other images *
***************************
Check if the chosen template and the prepared...","dev_clear_window ()
dev_disp_text ('Next, the Deep Counting model is applied on several search images.', 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",114,122,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text (['Done creatin..."
731ece3e,micro,14,,stop (),123,125,
731ece3e,micro,15,and visualize the results.,"for Index := 1 to |BottlesImages| - 1 by 1
ApplyImage := BottlesImages[Index]
read_image (Image, ApplyImage)
apply_deep_counting_model (Image, DeepCountingHandle, Count, DeepCountingResult)
dev_display_deep_counting_results (Image, [], DeepCountingResult, GenParamNameFont, GenParamValueFont)
dev_get...",126,140,"* --- Automatically Added Context ---
tuple_regexp_select (ImageFiles, 'crate*', BottlesImages)
create_deep_counting_model ([], [], DeepCountingHandle)
read_image (Image, DrawImage)
apply_deep_countin..."
731ece3e,micro,16,"Optimize backbone *
********************","dev_clear_window ()
dev_disp_text (['Next, the backbone of the Deep Counting model is optimized.', 'This can improve the runtime of the operator apply_deep_counting_model.'], 'window', 'top', 'left', 'black', [], [])
disp_continue_message (WindowHandle, 'black', 'true')",141,146,"* --- Automatically Added Context ---
dev_get_window (WindowHandle)
dev_disp_text ('First, the Deep Counting model is created.', 'window', 'top', 'left', 'black', [], [])
dev_disp_text (['Done creatin..."
731ece3e,micro,17,,"query_available_dl_devices ('ai_accelerator_interface', 'tensorrt', DLDeviceTensorRT)
if (DLDeviceTensorRT != [])
dev_clear_window ()
dev_disp_text ('Optimizing backbone...', 'window', 'top', 'left', 'black', [], [])
DLDeviceTensorRT := DLDeviceTensorRT[0]
ImageTest := Image
count_seconds (T0)
apply...",150,236,"* --- Automatically Added Context ---
tuple_regexp_select (ImageFiles, 'crate*', BottlesImages)
create_deep_counting_model ([], [], DeepCountingHandle)
read_image (Image, DrawImage)
GenParamNameFont :..."
69bbb9c9,full,0,"This example program shows how to create a local deformable
model from an XLD contour. In this case ...","dev_update_off ()
Width := 256
Height := 256
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black...",12,324,
69bbb9c9,micro,1,,"dev_update_off ()
Width := 256
Height := 256
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black...",11,25,
69bbb9c9,micro,2,compared later with the rectified version of the search image.,"* edges_sub_pix (ImageReduced, Edges, 'canny', 1, 10, 20)
smallest_rectangle1_xld (LogoContours, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangle1, floor(min(Row1)), floor(min(Column1)), ceil(max(Row2)), ceil(max(Column2)))
reduce_domain (GrayImage, Rectangle1, ImageReduced1)
crop_domain (Ima...",26,37,"* --- Automatically Added Context ---
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
rgb1_to_..."
69bbb9c9,micro,3,,"create_local_deformable_model_xld (LogoContours, 'auto', [], [], 'auto', 1, [], 'auto', 1, [], 'auto', 'auto', 'ignore_local_polarity', 5, [], [], ModelID)
get_deformable_model_contours (ModelContours, ModelID, 1)
disp_continue_message (WindowHandle1, 'black', 'true')",38,41,"* --- Automatically Added Context ---
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
* --- En..."
69bbb9c9,micro,4,matches with the cropped model image.,"get_image_size (ImagePart, WidthPart, HeightPart)
WindowWidthPart := 2 * WidthPart
WindowHeightPart := 2 * HeightPart
dev_open_window (0, WindowWidth + 8, WindowWidthPart * 1.5, WindowHeightPart * 1.5, 'black', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')",42,48,"* --- Automatically Added Context ---
WindowWidth := 2 * Width
Width := 256
crop_domain (ImageReduced1, ImagePart)
* --- End of Automatically Added Context ---"
69bbb9c9,micro,5,"search images that show the logo with an increasing
magnitude of artificial deformations.","gen_random_vector_field (VectorFieldFrom, Width, Height, 0, 2)
vector_field_to_real (VectorFieldFrom, VFFromRow, VFFromColumn)
PolaritySet := false
for Index := 1 to 5 by 1
gen_random_vector_field (VectorFieldTo, Width, Height, 40, 2)
vector_field_to_real (VectorFieldTo, VFToRow, VFToColumn)
for T :...",49,130,"* --- Automatically Added Context ---
Width := 256
Height := 256
decompose3 (LogoImage, ImageR, ImageG, ImageB)
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
rgb1_to_gray (..."
69bbb9c9,micro,6,,"read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)",131,134,"* --- Automatically Added Context ---
Width := 256
Height := 256
* --- End of Automatically Added Context ---"
69bbb9c9,micro,7,,"auto_threshold (Image, Regions, 10)
connection (Regions, Regions)
select_shape (Regions, SelectedRegions, ['row1', 'holes_num'], 'and', [80, 0], [100, 0])
sort_region (SelectedRegions, SelectedRegions, 'character', 'true', 'row')
closing_rectangle1 (SelectedRegions, Characters, 3, 3)
opening_rectang...",135,142,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
* --- End of Automatically Added Context ---"
69bbb9c9,micro,8,,"dilation_rectangle1 (Characters, RegionDilation, 5, 5)
erosion_rectangle1 (Characters, RegionErosion, 5, 5)
difference (RegionDilation, RegionErosion, RegionDifference)
count_obj (RegionDifference, Number)
gen_empty_obj (LogoContoursTemp)
for Index := 1 to Number by 1
select_obj (RegionDifference, O...",143,157,"* --- Automatically Added Context ---
reduce_domain (GrayImage, Rectangle, ImageReduced)
* edges_sub_pix (ImageReduced, Edges, 'canny', 1, 10, 20)
for Index := 1 to 5 by 1
read_image (Image, 'pen/pen-..."
69bbb9c9,micro,9,,"smallest_rectangle1_xld (LogoContoursTemp, Row1, Column1, Row2, Column2)
Row1 := min(Row1)
Column1 := min(Column1)
Row2 := max(Row2)
Column2 := max(Column2)
WidthLogoOrig := Column2 - Column1 + 1
ScaleFactor := real(WidthLogo) / WidthLogoOrig
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate...",158,176,"* --- Automatically Added Context ---
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
smallest_rectangle1_xld (LogoContours, Row1, Column1, Row2, Column2)
Blue := [0, 4..."
69bbb9c9,micro,10,,"if (Broadening &gt; 0)
gray_dilation_shape (LogoImage, LogoImage, 2 * Broadening + 1, 2 * Broadening + 1, 'octagon')
elseif (Broadening &lt; 0)
gray_erosion_shape (LogoImage, LogoImage, -2 * Broadening + 1, -2 * Broadening + 1, 'octagon')
endif
return ()
WidthVec := 32
HeightVec := 32
gen_image_cons...",177,334,"* --- Automatically Added Context ---
Width := 256
Height := 256
create_mvtec_logo_and_contours (LogoImage, LogoContours, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
smallest..."
8aa0cc60,full,0,"This example program shows the creation of a planar calibrated
deformable model from a dxf file.
Fir...","read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (1)
gen_cam_par_area_scan_divisio...",21,231,
8aa0cc60,micro,1,,"read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (1)
gen_cam_par_area_scan_divisio...",20,33,
8aa0cc60,micro,2,"the original dxf model is one mm for one pixel. The operator
create_planar_calib_deformable_model_xl...","disp_message (WindowHandle, 'Prepare and create the Model', 'window', 12, 84, 'lime green', 'false')
get_system ('example_dir', HalconExamples)
read_contour_xld_dxf (Contours, HalconExamples + '/hdevelop/Applications/Object-Recognition-2D/metal-part-01.dxf', [], [], DxfStatus)
dev_set_color ('cyan')...",34,66,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
gen_cam_par_area_scan_division (0.0131933, -1039.78, 8.3e-006, 8.3e-006, 313.191, 253.978, 640, 48..."
8aa0cc60,micro,3,"contour. For that, the model contours in world coordinates,
the camera parameters, and the reference...","create_planar_calib_deformable_model_xld (ContoursTrans, CamParam, ReferencePose, 'auto', [], [], 'auto', 0.9, [], 'auto', 0.9, [], 'auto', 'none', 'ignore_local_polarity', 5, [], [], ModelID)",67,72,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0131933, -1039.78, 8.3e-006, 8.3e-006, 313.191, 253.978, 640, 480, CamParam)
create_pose (0.0185843, -0.015084, 0.372976, 359.87..."
8aa0cc60,micro,4,"to the uncalibrated case, the model contours are returned in
world coordinates.","get_deformable_model_contours (ModelContours, ModelID, 1)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",73,79,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
create_planar_calib_deformable_model_xld (ContoursTrans, CamParam, ReferencePose, 'auto', [], [], ..."
8aa0cc60,micro,5,,"for I := 1 to 9 by 1
read_image (Image, 'metal-parts/bracket_tilted_' + I$'.02')
dev_display (Image)
count_seconds (Seconds1)
find_planar_calib_deformable_model (Image, ModelID, -0.39, 6.29, 1.0, 1.0, 1, 1, 0.8, 1, 1, 0, 0.9, [], [], Pose, CovPose, Score)
count_seconds (Seconds2)
for J := 0 to |Scor...",80,120,"* --- Automatically Added Context ---
read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
gen_cam_par_area_scan_division (0.0131933,..."
8aa0cc60,micro,6,image and the respective pose of the last match.,"dev_display (Image)
dev_set_color ('cyan')
dev_display (FoundContour)
disp_message (WindowHandle, 'Use polarity of an image to update the model', 'window', 12, 12, 'lime green', 'false')
set_planar_calib_deformable_model_metric (Image, ModelID, PoseSelected, 'use_polarity')",121,127,"* --- Automatically Added Context ---
read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
create_planar_calib_deformable_model_xld (..."
8aa0cc60,micro,7,"i.e., ModelContoursMetric corresponds to ModelContours","get_deformable_model_contours (ModelContoursMetric, ModelID, 1)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",128,132,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
create_planar_calib_deformable_model_xld (ContoursTrans, CamParam, ReferencePose, 'auto', [], [], ..."
8aa0cc60,micro,8,polarity setting.,"for I := 1 to 9 by 1
read_image (Image, 'metal-parts/bracket_tilted_' + I$'.02')
dev_display (Image)
count_seconds (Seconds1)
find_planar_calib_deformable_model (Image, ModelID, -0.39, 6.29, 1.0, 1.0, 1, 1, 0.7, 1, 1, 0, 0.9, [], [], Pose, CovPose, Score)
count_seconds (Seconds2)
for J := 0 to |Scor...",133,174,"* --- Automatically Added Context ---
read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
gen_cam_par_area_scan_division (0.0131933,..."
8aa0cc60,micro,9,"the world coordinate system, although this is in most cases
not recommended, because it might lead t...","dev_clear_window ()
dev_set_color ('cyan')
disp_message (WindowHandle, 'Change the origin of the model', 'window', 12, 12, 'lime green', 'false')
set_deformable_model_origin (ModelID, 0.010, 0.0425)",175,182,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
create_planar_calib_deformable_model_xld (ContoursTrans, CamParam, ReferencePose, 'auto', [], [], ..."
8aa0cc60,micro,10,,"get_deformable_model_contours (ModelContoursNewOrigin, ModelID, 1)
dev_display (ModelContoursNewOrigin)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",183,187,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
create_planar_calib_deformable_model_xld (ContoursTrans, CamParam, ReferencePose, 'auto', [], [], ..."
8aa0cc60,micro,11,reference point.,"for I := 1 to 9 by 1
read_image (Image, 'metal-parts/bracket_tilted_' + I$'.02')
dev_display (Image)
count_seconds (Seconds1)
find_planar_calib_deformable_model (Image, ModelID, -0.39, 6.29, 1.0, 1.0, 1, 1, 0.7, 1, 1, 0, 0.9, [], [], Pose, CovPose, Score)
count_seconds (Seconds2)
for J := 0 to |Scor...",188,237,"* --- Automatically Added Context ---
read_image (Image, 'metal-parts/bracket_tilted_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 480, WindowHandle)
gen_cam_par_area_scan_division (0.0131933,..."
ab04edc1,full,0,"This example program shows the creation of a planar uncalibrated
deformable model from a dxf file.
F...","read_image (Image, 'brake_disk/brake_disk_bike_01.png')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)
read_contour_xld_dxf (Contour...",21,87,
ab04edc1,micro,1,,"read_image (Image, 'brake_disk/brake_disk_bike_01.png')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)",20,28,
ab04edc1,micro,2,,"read_contour_xld_dxf (Contours, 'brake_disk_bike.dxf', [], [], DxfStatus)
dev_display (Contours)
disp_message (WindowHandle, 'DXF file of the inner part of a brake disk', 'window', 12, 12, 'lime green', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",29,36,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
* --- End of Automatically Added Context ---"
ab04edc1,micro,3,,"create_planar_uncalib_deformable_model_xld (Contours, 'auto', [], [], 'auto', 1.0, [], 'auto', 1.0, [], 'auto', 'point_reduction_high', 'ignore_part_polarity', 5, [], [], ModelID)
get_deformable_model_params (ModelID, 'num_levels', GenParamValue)
get_deformable_model_contours (ModelContours, ModelID...",37,41,"* --- Automatically Added Context ---
read_contour_xld_dxf (Contours, 'brake_disk_bike.dxf', [], [], DxfStatus)
* --- End of Automatically Added Context ---"
ab04edc1,micro,4,,"for I := 1 to 11 by 1
read_image (Image, 'brake_disk/brake_disk_bike_' + I$'02d')
dev_display (Image)
count_seconds (Seconds1)
find_planar_uncalib_deformable_model (Image, ModelID, 0, 0.78, 1, 1, 1, 1, 0.6, 1, 0.5, 0, 0.9, 'subpixel', 'least_squares', HomMat2D, Score)
count_seconds (Seconds2)
for J ...",42,57,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_bike_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_planar_uncalib_deformable_model_xld..."
ab04edc1,micro,5,,"dev_display (Image)
dev_display (ContoursProjTrans)
disp_message (WindowHandle, 'Use polarity of an image to update the model', 'window', 12, 12, 'lime green', 'false')
set_planar_uncalib_deformable_model_metric (Image, ModelID, HomMatSelected, 'use_polarity')",58,62,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_bike_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_planar_uncalib_deformable_model_xld..."
ab04edc1,micro,6,ModelContoursMetric corresponds to ModelContours,"get_deformable_model_contours (ModelContoursMetric, ModelID, 1)
get_deformable_model_params (ModelID, 'metric', Metric)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",63,69,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_planar_uncalib_deformable_model_xld (Contours, 'auto', [], [], 'auto', 1.0, [], 'auto', 1.0..."
ab04edc1,micro,7,,"for I := 1 to 11 by 1
read_image (Image, 'brake_disk/brake_disk_bike_' + I$'02d')
dev_display (Image)
count_seconds (Seconds1)
find_planar_uncalib_deformable_model (Image, ModelID, -0.2, 0.78, 1, 1, 1, 1, 0.5, 1, 1, 0, 0.9, 'subpixel', 'least_squares', HomMat2D, Score)
count_seconds (Seconds2)
for J...",70,93,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_bike_01.png')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_planar_uncalib_deformable_model_xld..."
3336b48f,full,0,"This example program shows how to use the local deformable
matching to find objects that are deforme...","dev_update_off ()
Width := 256
Height := 256
create_mvtec_logo_broadened (LogoImage, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
Smoothness := 21
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black...",12,306,
3336b48f,micro,1,,"dev_update_off ()
Width := 256
Height := 256
create_mvtec_logo_broadened (LogoImage, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
Smoothness := 21
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black...",11,27,
3336b48f,micro,2,compared later with the rectified version of the search image.,"crop_domain (ImageReduced, ImagePart)",28,30,"* --- Automatically Added Context ---
reduce_domain (GrayImage, Rectangle, ImageReduced)
* --- End of Automatically Added Context ---"
3336b48f,micro,3,,"create_local_deformable_model (ImageReduced, 'auto', [], [], 'auto', 1, [], 'auto', 1, [], 'auto', 'none', 'use_polarity', 'auto', 'auto', [], [], ModelID)
get_deformable_model_contours (ModelContours, ModelID, 1)
disp_continue_message (WindowHandle1, 'black', 'true')
stop ()",31,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
reduce_domain (GrayImage, Rectangle, ImageReduced)
* --- End of Automatically Added Cont..."
3336b48f,micro,4,matches with the cropped model image.,"get_image_size (ImagePart, WidthPart, HeightPart)
WindowWidthPart := 2 * WidthPart
WindowHeightPart := 2 * HeightPart
dev_open_window (0, WindowWidth + 8, WindowWidthPart * 1.5, WindowHeightPart * 1.5, 'black', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')",36,42,"* --- Automatically Added Context ---
WindowWidth := 2 * Width
Width := 256
crop_domain (ImageReduced, ImagePart)
* --- End of Automatically Added Context ---"
3336b48f,micro,5,"search images that show the logo with an increasing
magnitude of artificial deformations.","gen_random_vector_field (VectorFieldFrom, Width, Height, 0, 2)
vector_field_to_real (VectorFieldFrom, VFFromRow, VFFromCol)
for Index := 1 to 5 by 1
gen_random_vector_field (VectorFieldTo, Width, Height, 40, 2)
vector_field_to_real (VectorFieldTo, VFToRow, VFToCol)
for T := 0.0 to 0.95 by 0.05
creat...",43,114,"* --- Automatically Added Context ---
Width := 256
Height := 256
decompose3 (LogoImage, ImageR, ImageG, ImageB)
Smoothness := 21
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle..."
3336b48f,micro,6,,"read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)",115,118,"* --- Automatically Added Context ---
Width := 256
Height := 256
* --- End of Automatically Added Context ---"
3336b48f,micro,7,,"auto_threshold (Image, Regions, 10)
connection (Regions, Regions)
select_shape (Regions, SelectedRegions, ['row1', 'holes_num'], 'and', [80, 0], [100, 0])
sort_region (SelectedRegions, SelectedRegions, 'character', 'true', 'row')
closing_rectangle1 (SelectedRegions, Characters, 3, 3)
opening_rectang...",119,126,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
* --- End of Automatically Added Context ---"
3336b48f,micro,8,,"dilation_rectangle1 (Characters, RegionDilation, 5, 5)
erosion_rectangle1 (Characters, RegionErosion, 5, 5)
difference (RegionDilation, RegionErosion, RegionDifference)
count_obj (RegionDifference, Number)
gen_empty_obj (MVTecContours)
for Index := 1 to Number by 1
select_obj (RegionDifference, Obje...",127,141,"* --- Automatically Added Context ---
reduce_domain (GrayImage, Rectangle, ImageReduced)
for Index := 1 to 5 by 1
read_image (Image, 'pen/pen-01')
closing_rectangle1 (SelectedRegions, Characters, 3, 3..."
3336b48f,micro,9,,"smallest_rectangle1_xld (MVTecContours, Row1, Column1, Row2, Column2)
Row1 := min(Row1)
Column1 := min(Column1)
Row2 := max(Row2)
Column2 := max(Column2)
WidthLogoOrig := Column2 - Column1 + 1
ScaleFactor := real(WidthLogo) / WidthLogoOrig
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (H...",142,160,"* --- Automatically Added Context ---
create_mvtec_logo_broadened (LogoImage, 0, 200, Width, Height)
Blue := [0, 48, 117]
Orange := [255, 181, 41]
gen_empty_obj (MVTecContours)
* --- End of Automatica..."
3336b48f,micro,10,,"if (Broadening &gt; 0)
gray_dilation_shape (LogoImage, LogoImage, 2 * Broadening + 1, 2 * Broadening + 1, 'octagon')
elseif (Broadening &lt; 0)
gray_erosion_shape (LogoImage, LogoImage, -2 * Broadening + 1, -2 * Broadening + 1, 'octagon')
endif
return ()
WidthVec := 32
HeightVec := 32
gen_image_cons...",161,316,"* --- Automatically Added Context ---
Width := 256
Height := 256
create_mvtec_logo_broadened (LogoImage, 0, 200, Width, Height)
decompose3 (LogoImage, ImageR, ImageG, ImageB)
vector_field_to_real (Vec..."
99d70ab5,full,0,"This program demonstrates descriptor-based matching and
compares three different possibilities to ca...","dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.0155565, -109.42, 1.28008e-005, 1.2...",18,123,
99d70ab5,micro,1,"compares three different possibilities to calculate a pose
from point correspondences.
The first met...","dev_update_off ()
dev_close_window ()
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_draw ('margin')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_cam_par_area_scan_division (0.0155565, -109.42, 1.28008e-005, 1.2...",6,32,
99d70ab5,micro,2,,"gen_rectangle1 (Rectangle, 224, 115, 406, 540)
dev_set_line_width (4)
dev_set_color ('blue')
dev_display (Image)
dev_display (Rectangle)
reduce_domain (Image, Rectangle, ImageReduced)
disp_message (WindowHandle, 'Creating model  ... please wait.', 'window', 10, 10, 'black', 'true')",33,41,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
99d70ab5,micro,3,,"RowsRoi := [224, 224, 406, 406]
ColumnsRoi := [115, 540, 540, 115]
WorldX := [-189, 189, 189, -189] / 1000.0
WorldY := [-80, -80, 80, 80] / 1000.0
vector_to_pose (WorldX, WorldY, [], RowsRoi, ColumnsRoi, CamParam, 'iterative', 'error', Pose, Quality)
image_points_to_world_plane (CamParam, Pose, Rows...",42,60,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0155565, -109.42, 1...."
99d70ab5,micro,4,search model in image sequence,"for Index := 1 to 10 by 1
read_image (Image, 'packaging/cookie_box_' + Index$'.02')
dev_display (Image)
count_seconds (Seconds1)
find_calib_descriptor_model (Image, DescriptorHandle, [], [], [], [], 0.25, 1, CamParam, 'num_points', Pose, Score)
count_seconds (Seconds2)
TimeCalib := Seconds2 - Second...",61,129,"* --- Automatically Added Context ---
read_image (Image, 'packaging/cookie_box_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
gen_cam_par_area_scan_division (0.0155565, -109.42, 1...."
045083e7,full,0,"***********************************************************
This example shows how to use the 'high_...","dev_update_off ()
dev_close_window ()
read_image (Image, 'crosses/crosses_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)
dev_display_description_text (WindowHandle)
...",17,267,
045083e7,micro,1,,"dev_update_off ()
dev_close_window ()",16,19,
045083e7,micro,2,,"read_image (Image, 'crosses/crosses_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)",20,26,
045083e7,micro,3,,"dev_display_description_text (WindowHandle)
stop ()
dev_display_sample_image (Image, WindowHandle)
stop ()",27,32,"* --- Automatically Added Context ---
read_image (Image, 'crosses/crosses_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
* --- End of Automatically Added Context ---"
045083e7,micro,4,"Create the shape model (offline step)                     *
****************************************...",create_generic_shape_model (ModelID),33,38,
045083e7,micro,5,,"read_object (ModelContour, 'model_contour')",43,45,
045083e7,micro,6,"Set the model parameters (offline step)                   *
****************************************...","set_generic_shape_model_param (ModelID, 'iso_scale_min', 0.75)
set_generic_shape_model_param (ModelID, 'iso_scale_max', 1.25)",46,52,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
045083e7,micro,7,"Train the shape model (offline step)                      *
****************************************...","train_generic_shape_model (ModelContour, ModelID)",53,58,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
read_object (ModelContour, 'model_contour')
* --- End of Automatically Added Context ---"
045083e7,micro,8,,"gen_image_const (PolarityImage, 'byte', 512, 512)
paint_region (PolarityImage, PolarityImage, PolarityImage, 255, 'fill')
paint_xld (ModelContour, PolarityImage, PolarityImage, 0)",63,67,"* --- Automatically Added Context ---
read_object (ModelContour, 'model_contour')
* --- End of Automatically Added Context ---"
045083e7,micro,9,,"find_generic_shape_model (PolarityImage, ModelID, PolarityMatchResultID, NumMatchResult)
get_generic_shape_model_result (PolarityMatchResultID, 0, 'hom_mat_2d', HomMat2D)
set_shape_model_metric (PolarityImage, ModelID, HomMat2D, 'use_polarity')",68,72,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
gen_image_const (PolarityImage, 'byte', 512, 512)
* --- End of Automatically Added Context ---"
045083e7,micro,10,,"dev_display_metric (PolarityImage, PolarityMatchResultID, WindowHandle)
stop ()",73,76,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
gen_image_const (PolarityImage, 'byte', 512, 512)
find_generic_shape_model (PolarityImage, ModelID..."
045083e7,micro,11,search image.,"gen_rectangle1 (Rectangle, 97, 355, 222, 455)
reduce_domain (Image, Rectangle, ImageReduced)
set_generic_shape_model_object (ImageReduced, ModelID, 'high_noise_sample')
get_generic_shape_model_param (ModelID, 'pyramid_level_lowest', PyramidLevelLowest)",81,87,"* --- Automatically Added Context ---
read_image (Image, 'crosses/crosses_01')
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
045083e7,micro,12,,"dev_display_high_noise_sample (ImageReduced, PyramidLevelLowest, WindowHandle)
stop ()",88,91,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
reduce_domain (Image, Rectangle, ImageReduced)
get_generic_shape_model_param (ModelID, 'pyramid_le..."
045083e7,micro,13,online phase.,"set_generic_shape_model_param (ModelID, 'angle_start', rad(-50))",96,98,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
045083e7,micro,14,"allowed angle range to prevent multiple, almost equally
good matches on the same object at different...","set_generic_shape_model_param (ModelID, 'angle_end', rad(50))
set_generic_shape_model_param (ModelID, 'num_matches', 5)
set_generic_shape_model_param (ModelID, 'max_overlap', 0.0)
set_generic_shape_model_param (ModelID, 'greediness', 0.0)",99,106,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
045083e7,micro,15,,"dev_set_color ('lime green')
NumImages := 10
for Index := 1 to NumImages by 1
read_image (Image, 'crosses/crosses_' + Index$'02')
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result_object (Contours, MatchResultID, 'all', 'contours')
dev_display (I...",111,127,"* --- Automatically Added Context ---
read_image (Image, 'crosses/crosses_01')
create_generic_shape_model (ModelID)
find_generic_shape_model (PolarityImage, ModelID, PolarityMatchResultID, NumMatchRes..."
045083e7,micro,16,"Clean up                                                  *
****************************************...","dev_clear_window ()
dev_disp_text ('End of program', 'window', 'bottom', 'right', 'black', [], [])
dev_update_on ()",128,145,
045083e7,micro,17,,"Text := 'This example shows how to use the parameter \'high_noise_sample\''
Text[|Text|] := 'from the set_generic_shape_model_object operator to improve'
Text[|Text|] := 'the matching rate for images that have very high noise levels.'
Text[|Text|] := ' '
Text[|Text|] := 'The main steps of this examp...",146,180,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
* --- End of Automatically Added Context ---"
045083e7,micro,18,,"Text := 'Sample image with high level of noise. Many matches can'
Text[|Text|] := 'not be tracked to the lowest pyramid level in such images.'
dev_set_window (WindowHandle)
dev_clear_window ()
dev_display (Image)
dev_disp_text (Text, 'window', 'top', 'left', 'black', 'box', 'true')
dev_disp_text ('P...",181,210,"* --- Automatically Added Context ---
read_image (Image, 'crosses/crosses_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
Text := 'This example shows how to use the parameter \'hi..."
045083e7,micro,19,,"Text := 'To set the metric \'use_polarity\''
Text[|Text|] := 'for a shape model created by'
Text[|Text|] := 'an XLD we perform the following steps:'
Text[|Text|] := ''
Text[|Text|] := '1. Create an artificial polarity image.'
Text[|Text|] := '2. Determine the associated homography'
Text[|Text|] := '...",211,249,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
gen_image_const (PolarityImage, 'byte', 512, 512)
find_generic_shape_model (PolarityImage, ModelID..."
045083e7,micro,20,,"Text := 'Provide a sample search image'
Text[|Text|] := 'with a reduced domain that'
Text[|Text|] := 'includes one match and some'
Text[|Text|] := 'background. The operator'
Text[|Text|] := 'set_generic_shape_model_object'
Text[|Text|] := 'estimates the lowest pyramid'
Text[|Text|] := 'level based o...",250,277,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
reduce_domain (Image, Rectangle, ImageReduced)
get_generic_shape_model_param (ModelID, 'pyramid_le..."
5caa263e,full,0,"This example shows how to use shape-based matching
in order to find a model region and use it for
fu...","dev_update_window ('off')
dev_close_window ()
read_image (ReferenceImage, 'board/board_01')
get_image_size (ReferenceImage, Width, Height)
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
disp_continue_message (WindowHandle, 'black', 'true')
disp_description_text (Win...",14,457,
5caa263e,micro,1,,"dev_update_window ('off')
dev_close_window ()",13,15,
5caa263e,micro,2,,"read_image (ReferenceImage, 'board/board_01')
get_image_size (ReferenceImage, Width, Height)
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
disp_continue_message (WindowHandle, 'black', 'true')
disp_description_text (WindowHandleText)",16,22,
5caa263e,micro,3,ROI for the shape model.,"dev_set_window (WindowHandle)
dev_display (ReferenceImage)
gen_rectangle1 (ROIModel, 60, 535, 185, 900)
dev_display (ROIModel)",23,28,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'board/board_01')
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
* --- End of Automatically Added Co..."
5caa263e,micro,4,,"gen_rectangle1 (ROIText, 445, 585, 590, 765)
dev_display (ROIText)
disp_model_message (WindowHandle)
stop ()",29,34,"* --- Automatically Added Context ---
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
* --- End of Automatically Added Context ---"
5caa263e,micro,5,,"reduce_domain (ReferenceImage, ROIModel, ModelImage)",35,36,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'board/board_01')
gen_rectangle1 (ROIModel, 60, 535, 185, 900)
* --- End of Automatically Added Context ---"
5caa263e,micro,6,,create_generic_shape_model (ModelHandle),37,38,
5caa263e,micro,7,,"train_generic_shape_model (ModelImage, ModelHandle)",39,41,"* --- Automatically Added Context ---
reduce_domain (ReferenceImage, ROIModel, ModelImage)
create_generic_shape_model (ModelHandle)
* --- End of Automatically Added Context ---"
5caa263e,micro,8,,"create_text_model_reader ('auto', 'Industrial_0-9A-Z_Rej.omc', TextModel)",42,44,
5caa263e,micro,9,"for the alignment. We can extract it by finding the instance
on the reference image.
Set find parame...","set_generic_shape_model_param (ModelHandle, 'num_matches', 1)
set_generic_shape_model_param (ModelHandle, 'min_score', 0.5)
find_generic_shape_model (ReferenceImage, ModelHandle, MatchResultID, Matches)
get_generic_shape_model_result (MatchResultID, 'all', 'hom_mat_2d', HomMat2DModel)",45,53,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'board/board_01')
create_generic_shape_model (ModelHandle)
* --- End of Automatically Added Context ---"
5caa263e,micro,10,,"for i := 1 to 9 by 1
read_image (SearchImage, 'board/board_' + i$'02')
find_generic_shape_model (SearchImage, ModelHandle, MatchResultID, Matches)
get_generic_shape_model_result (MatchResultID, 'all', 'hom_mat_2d', HomMat2DMatch)
hom_mat2d_invert (HomMat2DMatch, HomMat2DMatchInvert)
hom_mat2d_compos...",54,172,"* --- Automatically Added Context ---
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
gen_rectangle1 (ROIText, 445, 585, 590, 765)
create_generic_shape_model (ModelHan..."
5caa263e,micro,11,,"SubStringEnumGap := []
TableAlphabetical := ['a)', 'b)', 'c)', 'd)', 'e)', 'f)', 'e)', 'g)', 'h)', 'i)', 'j)']
TableRoman := ['i)', 'ii)', 'iii)', 'iv)', 'v)', 'vi)', 'vii)', 'viii)', 'ix)', 'x)', 'xi)']
GapsRoman := [' ', '', '', '', ' ', '', '', '', '', ' ', '']
Check := []
for k := 0 to |StringOu...",173,387,"* --- Automatically Added Context ---
get_image_size (ReferenceImage, Width, Height)
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
tuple_split (StringComponent, ' ',..."
5caa263e,micro,12,,"dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
dev_set_draw ('margin')
dev_set_line_width (2)
dev_open_window (0, Width + 10, Width, Height, 'black', WindowHandleText)
set_display_font (WindowHandleTe...",388,418,"* --- Automatically Added Context ---
get_image_size (ReferenceImage, Width, Height)
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
* --- End of Automatically Added C..."
5caa263e,micro,13,,"dev_set_window (WindowHandleModel)
MessageInstance := 'Find instances defined by a model based on an image'
dev_disp_text (MessageInstance, 'window', 12, 12, 'black', [], [])",419,423,
5caa263e,micro,14,reading the text in the aligned image.,"dev_set_window (WindowHandleText)
MessageText := 'Align the image for further tasks as e.g., OCR reading'
dev_disp_text (MessageText, 'window', 'top', 'left', 'black', [], [])",424,429,"* --- Automatically Added Context ---
initialize_visualization (Width / 2, Height / 2, WindowHandle, WindowHandleText)
* --- End of Automatically Added Context ---"
5caa263e,micro,15,,"area_center (Characters, Area, Row4, Column4)
dev_disp_text (TextResult, 'window', (Row4 - 200) / 2, (Column4 - 300) * 0.9, 'yellow', 'box', 'false')
return ()
dev_set_window (WindowHandleModel)
Text := 'Reference Image:'
Text[|Text|] := 'The ROI around the CE Fc Logo'
Text[|Text|] := 'is used to cr...",430,465,"* --- Automatically Added Context ---
get_text_object (Characters, TextResultID, 'all_lines')
Text := 'This example program shows'
dev_set_window (WindowHandleModel)
* --- End of Automatically Added C..."
918f70a5,full,0,"This example demonstrates how to create a model out of a set
of samples in order to achieve greater ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'smd/smd_samples')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
MinScore1 := 0.65
Min...",19,136,
918f70a5,micro,1,"the samples. In this particular example, sample objects are
found and aligned by means of shape-base...","dev_update_off ()
dev_close_window ()
read_image (Image, 'smd/smd_samples')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
MinScore1 := 0.65
Min...",13,39,
918f70a5,micro,2,,"create_scaled_shape_model (ReducedReferenceImage, 0, rad(-1), rad(2), 0, 0.77, 0.78, 0, 'point_reduction_low', 'use_polarity', 30, 3, ModelID)
get_shape_model_params (ModelID, NumLevels, AngleStart, AngleExtent, AngleStep, ScaleMin, ScaleMax, ScaleStep, Metric, MinContrast)
find_scaled_shape_model (...",40,51,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_samples')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
MinScore1 := 0.65
create_reference_image (ReducedReferenceImage..."
918f70a5,micro,3,,"dev_set_window (WindowHandleAvg)
dev_set_line_width (2)
get_shape_model_contours (ModelContours, ModelID, 1)
gen_empty_obj (Templates)
for K := 0 to |Row| - 1 by 1
vector_angle_to_rigid (RowRef, ColumnRef, 0, Row[K], Column[K], Angle[K], HomMat2DTranslate)
hom_mat2d_scale (HomMat2DTranslate, Scale[K...",52,73,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_samples')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
area_center (ReducedReferenceImage, Area, RowRef, ColumnRef)
de..."
918f70a5,micro,4,,"channels_to_image (Templates, MultiChannelImage)
mean_n (MultiChannelImage, ImageMean)
dev_set_window (WindowHandle)
dev_display_shape_matching_results (ModelID, 'green', Row[K - 1], Column[K - 1], Angle[K - 1], Scale[K - 1], Scale[K - 1], 0)
dev_set_window (WindowHandleAvg)
dev_display (ImageMean)
...",74,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 12, 3 * RefImgWidth, 3 * RefImgHeight, 'black', WindowHandleAvg)
create_s..."
918f70a5,micro,5,the actual appearance of the smd,"create_scaled_shape_model (ImageMean, 0, rad(-1), rad(2), 0, 0.77, 0.78, 0, 'point_reduction_low', 'use_polarity', 45, 30, ModelIDAvg)
find_scaled_shape_model (Image, ModelIDAvg, rad(-1), rad(2), 0.77, 0.78, MinScore2, 0, 0, 'interpolation', 2, 0.5, Row, Column, Angle, Scale, Score)
dev_display (Ima...",85,144,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_samples')
get_image_size (Image, Width, Height)
MinScore2 := 0.8
create_reference_image (ReducedReferenceImage)
dev_open_window (0, Wi..."
80da8031,full,0,"This example program shows the creation of shape models
from XLD contours.
In this example, the poss...","read_image (Image, 'brake_disk/brake_disk_part_01')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)
binary_threshold (Image, Region, ...",26,211,
80da8031,micro,1,,"read_image (Image, 'brake_disk/brake_disk_part_01')
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('lime green')
dev_set_line_width (3)
binary_threshold (Image, Region, ...",25,47,
80da8031,micro,2,,"dev_clear_window ()
disp_message (WindowHandle, 'First example:\nCreate a shape model from one circular contour', 'window', 12, 12, 'lime green', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
MeanRadius := mean(Radius)
gen_circle_contour_xld (ContCircle, 300, 300, MeanRadius...",48,60,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
fit_circle_contour_xld (Edges, 'algebraic', -1, 0, 0, 3, 2, RowCenter, ColumnCenter, Radius, Start..."
80da8031,micro,3,,"create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'metric', 'ignore_local_polarity')
train_generic_shape_model (ContCircle, ModelID)",61,65,"* --- Automatically Added Context ---
gen_circle_contour_xld (ContCircle, 300, 300, MeanRadius, 0, 6.28318, 'positive', 1)
* --- End of Automatically Added Context ---"
80da8031,micro,4,,"set_generic_shape_model_param (ModelID, 'angle_start', 0.0)
set_generic_shape_model_param (ModelID, 'angle_end', 0.0)
set_generic_shape_model_param (ModelID, 'min_score', 0.7)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)",66,71,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
80da8031,micro,5,"i.e., which of the circles have a brighter interior.","IsHole := []
SeamWidth := 5.5
IsPosHole := gen_tuple_const(NumMatchResult,0)
get_generic_shape_model_result_object (Objects, MatchResultID, 'all', 'contours')
for Index := 0 to NumMatchResult - 1 by 1
select_obj (Objects, PosHole, Index + 1)
gen_region_contour_xld (PosHole, Region, 'filled')
erosion...",72,96,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
binary_threshold (Image, Region, 'smooth_histo', 'light', UsedThreshold)
find_generic_shape_model (Image, Mode..."
80da8031,micro,6,,"dev_display (Image)
get_generic_shape_model_result_object (ObjectsHoles, MatchResultID, HoleIndices, 'contours')
dev_set_color ('lime green')
dev_display (ObjectsHoles)
get_generic_shape_model_result_object (ObjectsNoHoles, MatchResultID, NoHoleIndices, 'contours')
dev_set_color ('red')
dev_display ...",97,110,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
fit_circle_contour_xld (Edges, 'algebraic', -1..."
80da8031,micro,7,,"get_generic_shape_model_result (MatchResultID, 0, 'hom_mat_2d', HomMat2D)
set_generic_shape_model_param (ModelID, 'min_score', 0.7)
set_shape_model_metric (Image, ModelID, HomMat2D, 'use_polarity')
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_resul...",111,123,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_generic_shape_model (ModelID)
find_gene..."
80da8031,micro,8,,"for Index := 2 to 9 by 1
read_image (Image, 'brake_disk/brake_disk_part_' + Index$'02d')
count_seconds (Seconds1)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
count_seconds (Seconds2)
get_generic_shape_model_result_object (Objects, MatchResultID, 'all', 'contours')
dev_di...",124,138,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
create_generic_shape_model (ModelID)
for Index..."
80da8031,micro,9,same area as the quadrilateral formed by the four holes.,"dev_clear_window ()
disp_message (WindowHandle, 'Second example:\nCreate a shape model from four circular\ncontours that are arranged in a square', 'window', 12, 12, 'lime green', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
read_image (Image, 'brake_disk/brake_disk_part_01...",139,159,"* --- Automatically Added Context ---
read_image (Image, 'brake_disk/brake_disk_part_01')
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
fit_circle_contour_xld (Edges, 'algebraic', -1..."
80da8031,micro,10,,"create_generic_shape_model (ModelIDXLD)
set_generic_shape_model_param (ModelIDXLD, 'metric', 'ignore_local_polarity')
train_generic_shape_model (Objects, ModelIDXLD)",160,164,"* --- Automatically Added Context ---
get_generic_shape_model_result_object (Objects, MatchResultID, 'all', 'contours')
* --- End of Automatically Added Context ---"
80da8031,micro,11,,"count_seconds (Seconds1)
set_generic_shape_model_param (ModelIDXLD, 'angle_start', rad(0))
set_generic_shape_model_param (ModelIDXLD, 'angle_end', rad(90))
set_generic_shape_model_param (ModelIDXLD, 'min_score', 0.8)
find_generic_shape_model (Image, ModelIDXLD, MatchResultID, NumMatchResult)
count_s...",165,179,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_r..."
80da8031,micro,12,,"get_generic_shape_model_result (MatchResultID, 'all', 'hom_mat_2d', HomMat2D)
set_shape_model_metric (Image, ModelIDXLD, HomMat2D, 'use_polarity')
count_seconds (Seconds1)
find_generic_shape_model (Image, ModelIDXLD, MatchResultID, NumMatchResult)
count_seconds (Seconds2)
dev_clear_window ()
dev_dis...",180,193,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
get_generic_shape_model_result (MatchResultID, 0, 'hom_mat_2d', HomMat2D)
find_generic_shape_model..."
80da8031,micro,13,,"for Index := 2 to 9 by 1
read_image (Image, 'brake_disk/brake_disk_part_' + Index$'02d')
count_seconds (Seconds1)
find_generic_shape_model (Image, ModelIDXLD, MatchResultID, NumMatchResult)
count_seconds (Seconds2)
dev_display (Image)
get_generic_shape_model_result_object (Objects, MatchResultID, 'a...",194,217,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, 640, 640, WindowHandle)
for Index := 0 to NumMatchResult - 1 by 1
find_generic_shape_model (Image, ModelID, MatchResultID,..."
79dbdf66,full,0,"This example program shows how to use HALCON's shape-based matching
to find SMD capacitors that exhi...","dev_update_off ()
dev_close_window ()
set_system ('int2_bits', 10)
read_image (Image, 'smd/smd_capacitors_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
disp_message_intro (WindowHandle)
stop ()
dev_close_window ()
dev_ope...",11,161,
79dbdf66,micro,1,"to find SMD capacitors that exhibit independent size changes in the
row and column direction in imag...","dev_update_off ()
dev_close_window ()",6,13,
79dbdf66,micro,2,"bits in the uint2 images.  We do this because this information
cannot be stored in the image files t...","set_system ('int2_bits', 10)
read_image (Image, 'smd/smd_capacitors_01')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_display (Image)
disp_message_intro (WindowHandle)
stop ()
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black'...",14,28,
79dbdf66,micro,3,This is just a rectangle with rounded corners.,"gen_contour_polygon_rounded_xld (Contour, [50, 100, 100, 50, 50], [50, 50, 150, 150, 50], [6, 6, 6, 6, 6], 1)
gen_image_const (Image, 'byte', 200, 150)
paint_xld (Contour, Image, ImageModel, 128)",29,33,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_capacitors_01')
* --- End of Automatically Added Context ---"
79dbdf66,micro,4,,"create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'scale_row_min', 0.9)
set_generic_shape_model_param (ModelID, 'scale_row_max', 1.7)
set_generic_shape_model_param (ModelID, 'scale_column_min', 0.9)
set_generic_shape_model_param (ModelID, 'scale_column_max', 1.1)
set_gener...",34,43,"* --- Automatically Added Context ---
paint_xld (Contour, Image, ImageModel, 128)
* --- End of Automatically Added Context ---"
79dbdf66,micro,5,"and display the number of found models an the recognition time
and the model's scale","set_generic_shape_model_param (ModelID, 'min_score', 0.7)
set_generic_shape_model_param (ModelID, 'angle_start', rad(-10))
set_generic_shape_model_param (ModelID, 'angle_end', rad(10))
for J := 1 to 4 by 1
read_image (Image, 'smd/smd_capacitors_' + J$'02d')
dev_display (Image)
count_seconds (S1)
fin...",44,71,"* --- Automatically Added Context ---
read_image (Image, 'smd/smd_capacitors_01')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_generic_shape_model (ModelID)
* --- End of Automa..."
79dbdf66,micro,6,,"set_system ('int2_bits', -1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program shows how to use shape-based matching'
Message[|Message|] := 'to find SMD capacitors that exhibit independent'
Message[|Message|] := 'size changes in the row and column direction in'
Me...",72,112,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
79dbdf66,micro,7,matching instances in order to display them as text message.,"set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",113,117,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
79dbdf66,micro,8,,"get_generic_shape_model_result (MatchResultID, 'all', 'row', Row)
get_generic_shape_model_result (MatchResultID, 'all', 'column', Column)
get_generic_shape_model_result (MatchResultID, 'all', 'scale_row', ScaleR)
get_generic_shape_model_result (MatchResultID, 'all', 'scale_column', ScaleC)
MeanColum...",118,124,"* --- Automatically Added Context ---
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
* --- End of Automatically Added Context ---"
79dbdf66,micro,9,,"for I := 0 to NumMatchResult - 1 by 1
ScaleRowStr := 'ScaleRow=' + ScaleR[I]$'5.3f'
ScaleColStr := 'ScaleCol=' + ScaleC[I]$'5.3f'
get_string_extents (WindowHandle, ScaleRowStr, AscentStr, DescentStr, WidthStr, HeightStr)
if (Column[I] &lt;= MeanColumn)
disp_message (WindowHandle, [ScaleRowStr,ScaleC...",125,154,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_res..."
79dbdf66,micro,10,,"set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := NumMatchResult$'d' + ' models found in ' + Time$'5.2f' + ' ms'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
return ()",155,171,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
Time := (S2 - S1) * 1000
co..."
ad9b8aa2,full,0,"**************************************************
This example program shows the workflow of       ...","dev_update_window ('off')
dev_close_window ()
read_image (ReferenceImage, 'board/board_01')
dev_set_color ('yellow')
dev_set_draw ('margin')
get_image_size (ReferenceImage, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono',...",19,75,
ad9b8aa2,micro,1,,"dev_update_window ('off')
dev_close_window ()
read_image (ReferenceImage, 'board/board_01')
dev_set_color ('yellow')
dev_set_draw ('margin')
get_image_size (ReferenceImage, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono',...",18,28,
ad9b8aa2,micro,2,"1. Creation of the shape model (offline step)    *
*************************************************...",create_generic_shape_model (ModelID),29,34,
ad9b8aa2,micro,3,,"gen_rectangle1 (ROI, 450, 470, 580, 755)
dev_display (ReferenceImage)
dev_display (ROI)
Text := 'Define ROI that is used to derive the shape model '
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
dev_...",39,46,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'board/board_01')
* --- End of Automatically Added Context ---"
ad9b8aa2,micro,4,shape model.,"reduce_domain (ReferenceImage, ROI, TrainingImage)
stop ()",47,51,"* --- Automatically Added Context ---
read_image (ReferenceImage, 'board/board_01')
gen_rectangle1 (ROI, 450, 470, 580, 755)
* --- End of Automatically Added Context ---"
ad9b8aa2,micro,5,,"train_generic_shape_model (TrainingImage, ModelID)",52,54,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
reduce_domain (ReferenceImage, ROI, TrainingImage)
* --- End of Automatically Added Context ---"
ad9b8aa2,micro,6,,"set_generic_shape_model_param (ModelID, 'num_matches', 1)
set_generic_shape_model_param (ModelID, 'min_score', 0.6)
for i := 1 to 9 by 1
read_image (SearchImage, 'board/board_' + i$'02')
find_generic_shape_model (SearchImage, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result_obj...",59,81,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
create_generic_shape_model (ModelID)
Text := 'Define ROI that is used to derive the shape mod..."
d251937c,full,0,"***************************************************
This example program shows how to use HALCON's  ...","dev_update_window ('off')
dev_close_window ()
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
get_image_size (SearchImage, Width, Height)
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('yell...",20,79,
d251937c,micro,1,,"dev_update_window ('off')
dev_close_window ()
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
get_image_size (SearchImage, Width, Height)
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('yell...",19,29,
d251937c,micro,2,"1. Creation of the shape model (offline step)    *
*************************************************...",create_generic_shape_model (ModelID),30,35,
d251937c,micro,3,,"read_contour_xld_dxf (ModelContour, 'contour_metal_part.dxf', [], [], DxfStatus)
dev_display (ModelContour)
Text := 'DXF contours used as shape model'
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
de...",40,47,
d251937c,micro,4,"For this example it is sufficient to set the maximum isotropic
scaling factor.","set_generic_shape_model_param (ModelID, 'iso_scale_max', 1.25)",48,51,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
d251937c,micro,5,,"train_generic_shape_model (ModelContour, ModelID)",52,54,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
read_contour_xld_dxf (ModelContour, 'contour_metal_part.dxf', [], [], DxfStatus)
* --- End of Automatically Added Context ---"
d251937c,micro,6,,"set_generic_shape_model_param (ModelID, 'num_matches', 4)
set_generic_shape_model_param (ModelID, 'min_score', 0.8)",59,62,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
d251937c,micro,7,,"for Index := 1 to 6 by 1
read_image (SearchImage, 'metal-parts/metal_parts_large_' + Index$'.2d')
find_generic_shape_model (SearchImage, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result_object (Objects, MatchResultID, 'all', 'contours')
dev_display (SearchImage)
dev_display (Ob...",63,86,"* --- Automatically Added Context ---
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
create_generic_shape_model (Model..."
f79071d6,full,0,This example program shows how to find scaled and rotated shape models.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'green-dot')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
dev_display (Image)
threshold (Image, Region, 0, 128)
co...",7,39,
f79071d6,micro,1,,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'green-dot')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
dev_display (Image)
threshold (Image, Region, 0, 128)
co...",6,45,
923fb1c9,full,0,"This example demonstrates how to adapt parameters for images
with a low contrast and high noise for ...","ImgPath := 'crosses/'
read_image (Image, ImgPath + 'crosses_01')
dev_update_off ()
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('lime green')
dev_set_line_width (3)
dev_open_window (0, Width + 10, 480, Height, '...",23,480,
923fb1c9,micro,1,"search by optimizing the parameters pyramid levels,
minimum contrast, and metric. When we are satisf...","ImgPath := 'crosses/'
read_image (Image, ImgPath + 'crosses_01')
dev_update_off ()
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('lime green')
dev_set_line_width (3)
dev_open_window (0, Width + 10, 480, Height, '...",17,38,
923fb1c9,micro,2,,"read_object (ModelContour, 'model_contour')",41,42,
923fb1c9,micro,3,before its training.,"create_generic_shape_model (ModelID)
set_generic_shape_model_param (ModelID, 'iso_scale_min', 0.75)
set_generic_shape_model_param (ModelID, 'iso_scale_max', 1.25)
set_generic_shape_model_param (ModelID, 'metric', 'ignore_local_polarity')
train_generic_shape_model (ModelContour, ModelID)",43,50,"* --- Automatically Added Context ---
read_object (ModelContour, 'model_contour')
* --- End of Automatically Added Context ---"
923fb1c9,micro,4,"The parameter greediness is set to 0.0 for an exhaustive search.
The parameter min_score should be l...","disp_message_case1 (WindowHandleText, WindowHandle)
set_generic_shape_model_param (ModelID, 'border_shape_models', 'true')
set_generic_shape_model_param (ModelID, 'angle_start', rad(-50))
set_generic_shape_model_param (ModelID, 'angle_end', rad(50))
set_generic_shape_model_param (ModelID, 'min_score...",53,85,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
read_image (Image, ImgPath + 'crosses_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480,..."
923fb1c9,micro,5,"of pyramid levels, minimum contrast, and shape of the model
contours. Is the object still well defin...","disp_message_model_check (WindowHandleText, WindowHandle)
read_image (Image, ImgPath + 'crosses_01')
gen_gauss_pyramid (Image, ImagePyramid, 'weighted', 0.5)
get_generic_shape_model_param (ModelID, 'num_levels', NumLevels)
hom_mat2d_identity (HomMat2DIdentityVisContour)
for Level := 1 to NumLevels b...",88,115,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
read_image (Image, ImgPath + 'crosses_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
923fb1c9,micro,6,"approach. Here, using only the topmost level yields the best
result. So we set the lowest level to t...","PyramidLevelHighest := 3
set_generic_shape_model_param (ModelID, 'pyramid_level_lowest', PyramidLevelHighest)
disp_message_case2 (WindowHandleText, WindowHandle)
for Index := 1 to NumImages by 1
read_image (Image, ImgPath + 'crosses_' + Index$'02')
find_generic_shape_model (Image, ModelID, MatchResu...",118,142,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480, Height, 'black', WindowHandleText)
NumImag..."
923fb1c9,micro,7,"sufficient, we systematically try to improve the model
before adapting the lowest pyramid level agai...","set_generic_shape_model_param (ModelID, 'pyramid_level_lowest', 1)
set_generic_shape_model_param (ModelID, 'pyramid_level_highest', PyramidLevelHighest)",145,150,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
PyramidLevelHighest := 3
* --- End of Automatically Added Context ---"
923fb1c9,micro,8,,"estimate_noise (Image, 'foerstner', 20, Sigma)
set_generic_shape_model_param (ModelID, 'min_contrast', Sigma)",151,154,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
read_image (Image, ImgPath + 'crosses_01')
* --- End of Automatically Added Context ---"
923fb1c9,micro,9,"Here, an artificial image is used in order to avoid the
influence of noise.","gen_image_const (Image1, 'byte', 512, 512)
paint_region (Image1, Image1, ImageResult1, 255, 'fill')
paint_xld (ModelContour, ImageResult1, Image, 0)
find_generic_shape_model (Image, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result (MatchResultID, 'best', 'hom_mat_2d', HomMat2DT...",155,185,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480, Height, 'black', WindowHandleText)
NumImag..."
923fb1c9,micro,10,"case before. Additionally we now adapt the lowest pyramid level.
Here, using only the topmost level ...","disp_message_case4 (WindowHandleText, WindowHandle)
set_generic_shape_model_param (ModelID, 'pyramid_level_lowest', 3)
set_generic_shape_model_param (ModelID, 'pyramid_level_highest', 3)
for Index := 1 to NumImages by 1
read_image (Image, ImgPath + 'crosses_' + Index$'02')
dev_display (Image)
find_g...",189,214,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480, Height, 'black', WindowHandleText)
NumImag..."
923fb1c9,micro,11,"matches. Here, setting min_score to a higher value helps
to eliminate false positives.","set_generic_shape_model_param (ModelID, 'min_score', 0.5)
disp_message_case5 (WindowHandleText, WindowHandle)
for Index := 1 to NumImages by 1
read_image (Image, ImgPath + 'crosses_' + Index$'02')
find_generic_shape_model (Image, ModelID, MatchResultID5, NumMatchResult5)
if (NumMatchResult1 &gt; 0)
...",218,239,"* --- Automatically Added Context ---
ImgPath := 'crosses/'
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480, Height, 'black', WindowHandleText)
NumImag..."
923fb1c9,micro,12,,"set_window_param (WindowHandle, 'flush', Flush)
Message := 'This example demonstrates how to adapt parameters'
Message[|Message|] := 'of a shape model for images with low contrast'
Message[|Message|] := 'and high noise for robust search results.'
Message[|Message|] := ' '
Message[|Message|] := 'The ...",240,489,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 10, 480, Height, 'black', WindowHandleText)
get_window_param (WindowHandl..."
2b6a26a9,full,0,"This example shows how to use clutter parameters
(set with set_shape_model_clutter) to exclude match...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_disp_workflow_text ()
stop ()
list_image_files ('bga_gap', 'default', [], ImageFiles)
read_image (ImageModel, ImageF...",18,322,
2b6a26a9,micro,1,"applications, in which case the clutter parameters need
to be adapted to the particular use case.","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_set_line_width (3)
dev_disp_workflow_text ()
stop ()",14,25,
2b6a26a9,micro,2,,"list_image_files ('bga_gap', 'default', [], ImageFiles)
read_image (ImageModel, ImageFiles[0])
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')",26,30,
2b6a26a9,micro,3,,"dev_disp_problem_description (ImageModel, WindowHandle1, WindowHandle2)
stop ()
dev_close_window ()",31,35,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
read_image (ImageModel, ImageFiles[0])
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
* --- E..."
2b6a26a9,micro,4,"such that for NumMatches=0 the wanted matches are found.
Untypical matches, e.g., in the background,...","gen_circle (ROI, 753.869, 551.624, 28.4027)
reduce_domain (ImageModel, ROI, ImageReduced)
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(0), 'auto', 0.95, 1.05, 'auto', 0.95, 1.05, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)
MinScoreStandard := 0.83
dev_set_window (WindowHa...",36,56,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
list_image_files ('bga_gap', 'default', [], ImageFiles)
read_image (ImageModel, ImageFiles[0])
dev_open_w..."
2b6a26a9,micro,5,"model accordingly.
a) Determine the transformation HomMat2D for a correct match.","find_aniso_shape_model (ImageModel, ModelID, rad(0), rad(0), 0.95, 1.05, 0.95, 1.05, MinScoreStandard, 0, 0.0, 'least_squares', 0, 0.0, Row, Column, Angle, ScaleR, ScaleC, Score)
MatchIndex := 0
get_hom_mat2d_from_matching_result (Row[MatchIndex], Column[MatchIndex], Angle[MatchIndex], ScaleR[MatchI...",57,64,"* --- Automatically Added Context ---
read_image (ImageModel, ImageFiles[0])
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(0), 'auto', 0.95, 1.05, 'auto', 0.95, 1.05, 'auto', 'auto', 'us..."
2b6a26a9,micro,6,"It should contain the regions around the superfluous edges
that are typical for the expected manifes...","gen_circle (ROI_0, 700.655, 548.666, 21.6273)
gen_circle (ROI_1_0, 810.655, 550.611, 21.6273)
union2 (ROI_0, ROI_1_0, ClutterRegion)
dev_clear_window ()
dev_display (ImageModel)
dev_disp_text ('Specify the ClutterRegion for one of the matches.', 'window', 'top', 'left', 'black', [], [])
dev_set_colo...",65,84,"* --- Automatically Added Context ---
read_image (ImageModel, ImageFiles[0])
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
affine_trans_contour_xld (ModelContours, ContoursAffinTrans, Hom..."
2b6a26a9,micro,7,"It specifies the contrast the edges in the clutter region must
have in order to be counted as clutte...","sobel_amp (ImageModel, EdgeAmplitude, 'sum_sqrt', 3)
get_shape_model_params (ModelID, NumLevels, AngleStart, AngleExtent, AngleStep, ScaleMin, ScaleMax, ScaleStep, Metric, MinContrast)
Contrast := -1
determine_shape_model_params (ImageReduced, NumLevels, AngleStart, AngleExtent, ScaleMin, ScaleMax, ...",85,102,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
read_image (ImageModel, ImageFiles[0])
reduce_domain (ImageModel, ROI, ImageReduced)
create_aniso_shape_m..."
2b6a26a9,micro,8,,"set_shape_model_clutter (ClutterRegion, ModelID, HomMat2D, ClutterContrast, 'clutter_border_mode', 'clutter_border_average')",103,105,"* --- Automatically Added Context ---
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(0), 'auto', 0.95, 1.05, 'auto', 0.95, 1.05, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)
g..."
2b6a26a9,micro,9,wanted matches remain.,"MaxClutterSmallClutter := 0.09
MaxClutterMoreClutter := 0.18
MinScoreSmallClutter := [MinScoreStandard,MaxClutterSmallClutter]
MinScoreMoreClutter := [MinScoreStandard,MaxClutterMoreClutter]
NumMatchesSmallClutter := 0
NumMatchesMoreClutter := 5
dev_open_window (510, 0, 900, 220, 'black', WindowHand...",106,137,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
list_image_files ('bga_gap', 'default', [], ImageFiles)
dev_open_window (0, 609, 600, 450, 'black', Windo..."
2b6a26a9,micro,10,set_shape_model_param.,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (Image)
dev_disp_text ('\'use_clutter\' set to \'true\'', 'window', 'top', 'left', 'black', [], [])
dev_display_shape_matching_results (ModelID, ['green', 'red'], Row1, Column1, Angle1, ScaleR1, ScaleC1, 0)
set_shape_model_param (ModelID...",138,332,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 450, 'black', WindowHandle1)
read_image (ImageModel, ImageFiles[0])
dev_open_window (0, 609, 600, 450, 'black', WindowHandle2)
create_..."
49647698,full,0,"This example program shows how to use the 'max_deformation'
parameter in the shape-based matching to...","create_mvtec_logo_broadened (LogoImage, 0, 200, 256, 256)
get_image_size (LogoImage, Width, Height)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', '...",12,175,
49647698,micro,1,,"create_mvtec_logo_broadened (LogoImage, 0, 200, 256, 256)
get_image_size (LogoImage, Width, Height)
WindowWidth := 2 * Width
WindowHeight := 2 * Height
dev_close_window ()
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', '...",11,27,
49647698,micro,2,"in a deformed way. The search is performed two times: In the first
pass, no model deformation is all...","dev_open_window (0, WindowWidth + 8, WindowWidth, WindowHeight, 'black', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
DispString := ['No deformations allowed', 'Deformations allowed']
Rows1 := []
Columns1 := []
Scores1 := []
Rows2 := []
Columns2 := []
Scores2 := []
Nu...",28,85,"* --- Automatically Added Context ---
WindowWidth := 2 * Width
WindowHeight := 2 * Height
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
create_shape_model (LogoImage, 'auto..."
49647698,micro,3,,"MeanError1 := mean(sqrt(pow(Rows1 - RowRef,2) + pow(Columns1 - ColumnRef,2)))
MeanScore1 := mean(Scores1)
MeanError2 := mean(sqrt(pow(Rows2 - RowRef,2) + pow(Columns2 - ColumnRef,2)))
MeanScore2 := mean(Scores2)
dev_set_window (WindowHandle1)
disp_message (WindowHandle1, |Scores1| + ' of ' + NumImag...",86,98,"* --- Automatically Added Context ---
WindowHeight := 2 * Height
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
area_center (LogoImage, Area, RowRef, ColumnRef)
get_image_si..."
49647698,micro,4,,"dev_set_window (WindowHandle2)
dev_close_window ()
blue := [0, 48, 117]
orange := [255, 181, 41]",99,122,"* --- Automatically Added Context ---
dev_open_window (0, WindowWidth + 8, WindowWidth, WindowHeight, 'black', WindowHandle2)
* --- End of Automatically Added Context ---"
49647698,micro,5,,"read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)",123,126,"* --- Automatically Added Context ---
get_image_size (LogoImage, Width, Height)
* --- End of Automatically Added Context ---"
49647698,micro,6,,"auto_threshold (Image, Regions, 10)
connection (Regions, Regions)
select_shape (Regions, SelectedRegions, ['row1', 'holes_num'], 'and', [80, 0], [100, 0])
sort_region (SelectedRegions, SelectedRegions, 'character', 'true', 'row')
closing_rectangle1 (SelectedRegions, Characters, 3, 3)
opening_rectang...",127,134,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
* --- End of Automatically Added Context ---"
49647698,micro,7,,"dilation_rectangle1 (Characters, RegionDilation, 5, 5)
erosion_rectangle1 (Characters, RegionErosion, 5, 5)
difference (RegionDilation, RegionErosion, RegionDifference)
count_obj (RegionDifference, Number)
gen_empty_obj (MVTecContours)
for Index := 1 to Number by 1
select_obj (RegionDifference, Obje...",135,149,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
closing_rectangle1 (SelectedRegions, Characters, 3, 3)
* --- End of Automatically Added Context ---"
49647698,micro,8,,"smallest_rectangle1_xld (MVTecContours, Row1, Column1, Row2, Column2)
Row1 := min(Row1)
Column1 := min(Column1)
Row2 := max(Row2)
Column2 := max(Column2)
WidthLogoOrig := Column2 - Column1 + 1
ScaleFactor := real(WidthLogo) / WidthLogoOrig
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (H...",150,168,"* --- Automatically Added Context ---
create_mvtec_logo_broadened (LogoImage, 0, 200, 256, 256)
gen_empty_obj (MVTecContours)
* --- End of Automatically Added Context ---"
49647698,micro,9,,"if (Broadening &gt; 0)
gray_dilation_shape (LogoImage, LogoImage, 2 * Broadening + 1, 2 * Broadening + 1, 'octagon')
elseif (Broadening &lt; 0)
gray_erosion_shape (LogoImage, LogoImage, -2 * Broadening + 1, -2 * Broadening + 1, 'octagon')
endif
return ()",169,188,"* --- Automatically Added Context ---
create_mvtec_logo_broadened (LogoImage, 0, 200, 256, 256)
for Broadening := -5 to 5 by 0.1
* --- End of Automatically Added Context ---"
241e6a73,full,0,This example demonstrates the use of the operator set_shape_model_param.,"dev_close_window ()
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')
add_noise_white (Image, ImageNoise, 60)
dev_display (ImageNoise)
gen_rectangle1 (Rectangle, 60, ...",7,79,
241e6a73,micro,1,,"dev_close_window ()
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('green')",6,12,
241e6a73,micro,2,This leads to a large value of (the automatically determined) MinContrast.,"add_noise_white (Image, ImageNoise, 60)
dev_display (ImageNoise)
gen_rectangle1 (Rectangle, 60, 60, 200, 200)
reduce_domain (ImageNoise, Rectangle, ImageReduced)
determine_shape_model_params (ImageReduced, 'auto', -0.39, 0.79, 0.9, 1.1, 'auto', 'use_polarity', 'auto', 'auto', 'all', ParameterName, P...",13,27,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
241e6a73,micro,3,,"scale_image (Image, ImageLowContrast, 0.1, 100)
dev_display (ImageLowContrast)
disp_message (WindowHandle, 'Creating Search Image with low Contrast', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",28,33,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
241e6a73,micro,4,"because the edge amplitude in ImageLowContrast is below the automatically
determined MinContrast.
In...","edges_image (ImageLowContrast, ImaAmp, ImaDir, 'sobel_fast', 0.5, 'nms', ParameterValue[7] - 20, ParameterValue[7] - 20)
get_domain (ImaAmp, Domain)
full_domain (ImaAmp, ImageFull)
dev_clear_window ()
dev_display (Domain)
disp_message (WindowHandle, 'Edge Amplitude of Search Image is\nbelow MinContr...",34,47,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
determine_shape_model_params (ImageReduced, 'auto', -0.39, 0.79..."
241e6a73,micro,5,because of the high value of MinContrast.,"find_shape_model (ImageLowContrast, ModelID, -0.39, 0.78, 0.5, 1, 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
NumMatches := |Score|
dev_clear_window ()
dev_display (ImageLowContrast)
dev_inspect_ctrl (NumMatches)
disp_message (WindowHandle, 'Hence, no Matches found on the Search Image',...",48,59,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
create_shape_model (ImageReduced, 'auto', -0.39, 0.79, 'auto', ..."
241e6a73,micro,6,,"edges_image (ImageLowContrast, ImaAmp, ImaDir, 'sobel_fast', 0.5, 'nms', 5, 5)
get_domain (ImaAmp, Domain)
dev_clear_window ()
dev_display (ImageLowContrast)
dev_display (Domain)
disp_message (WindowHandle, 'Extracted Edges on Search Image\nwith Threshold lower than MinContrast', 'window', 12, 12, '...",60,69,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
disp_message (WindowHandle, '\'Auto\' MinContrast on a Noisy Im..."
241e6a73,micro,7,,"set_shape_model_param (ModelID, 'min_contrast', 5)
find_shape_model (ImageLowContrast, ModelID, -0.39, 0.78, 0.5, 1, 0.5, 'least_squares', 0, 0.9, Row, Column, Angle, Score)
get_shape_model_contours (ModelContours, ModelID, 1)
vector_angle_to_rigid (0, 0, 0, Row, Column, Angle, HomMat2D)
affine_tran...",70,86,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
disp_message (WindowHandle, '\'Auto\' MinContrast on a Noisy Image: ' + ParameterValue[7], 'window',..."
e64d7cb9,full,0,"This example shows how the 'model_cache' parameter affects
the memory consumption of a find operatio...","read_image (Image, 'printer_chip/printer_chip_01')
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_description_text_1 ()
stop ()
gen_rectangle1 (ROI_0, 310.0, 390.0, 670.0, 920.0)
redu...",16,129,
e64d7cb9,micro,1,"the memory consumption of a find operation in
shape-based matching. It shows that without 'model_cac...","read_image (Image, 'printer_chip/printer_chip_01')
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_disp_description_text_1 ()
stop ()",7,24,
e64d7cb9,micro,2,,"gen_rectangle1 (ROI_0, 310.0, 390.0, 670.0, 920.0)
reduce_domain (Image, ROI_0, ImageReduced)",25,27,"* --- Automatically Added Context ---
read_image (Image, 'printer_chip/printer_chip_01')
* --- End of Automatically Added Context ---"
e64d7cb9,micro,3,,"create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 0.9, 1.1, 'auto', 0.9, 1.1, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)",28,30,"* --- Automatically Added Context ---
reduce_domain (Image, ROI_0, ImageReduced)
* --- End of Automatically Added Context ---"
e64d7cb9,micro,4,because the model region has a big diameter.,"get_shape_model_params (ModelID, NumLevels, AngleStart, AngleExtent, AngleStep, ScaleMin, ScaleMax, ScaleStep, Metric, MinContrast)
dev_disp_description_text_2 (AngleStep, ScaleStep)
stop ()",31,37,"* --- Automatically Added Context ---
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 0.9, 1.1, 'auto', 0.9, 1.1, 'auto', 'auto', 'use_polarity', 'auto', 'auto', ModelID)
* -..."
e64d7cb9,micro,5,,"set_shape_model_param (ModelID, 'model_cache', 'false')
set_check ('memory')
find_aniso_shape_model (Image, ModelID, 0, 0, 0.95, 1.05, 0.95, 1.05, 0.7, 1, 0, 'least_squares', 0, 0.7, Row, Column, Angle, ScaleR, ScaleC, Score)
get_system ('temp_mem', TempMem1)",40,45,"* --- Automatically Added Context ---
read_image (Image, 'printer_chip/printer_chip_01')
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 0.9, 1.1, 'auto', 0.9, 1.1, 'auto', '..."
e64d7cb9,micro,6,Note that the operator runs faster.,"set_shape_model_param (ModelID, 'model_cache', 'true')
find_aniso_shape_model (Image, ModelID, 0, 0, 0.95, 1.05, 0.95, 1.05, 0.7, 1, 0, 'least_squares', 0, 0.7, Row, Column, Angle, ScaleR, ScaleC, Score)
get_system ('temp_mem', TempMem2)
dev_disp_description_text_3 (TempMem1, TempMem2)",46,54,"* --- Automatically Added Context ---
read_image (Image, 'printer_chip/printer_chip_01')
create_aniso_shape_model (ImageReduced, 'auto', rad(0), rad(360), 'auto', 0.9, 1.1, 'auto', 0.9, 1.1, 'auto', '..."
e64d7cb9,micro,7,,"set_check ('~memory')
Text := '\'AngleStep\' and \'ScaleStep\' are estimated as'
Text[1] := 'very small values because the model region'
Text[2] := 'has a big diameter.'
Text[3] := '\'AngleStep\' is: ' + AngleStep
Text[4] := '\'ScaleStep\' is: ' + ScaleStep[0] + ' and ' + ScaleStep[1]
dev_clear_wind...",55,138,"* --- Automatically Added Context ---
get_shape_model_params (ModelID, NumLevels, AngleStart, AngleExtent, AngleStep, ScaleMin, ScaleMax, ScaleStep, Metric, MinContrast)
* --- End of Automatically Add..."
d4bf1b2f,full,0,"This example demonstrates the usage of the shape based matching timeout
mechanism integrated in HALC...","dev_update_off ()
dev_close_window ()
get_system ('border_shape_models', BorderShapeModels)
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
Warning := 'ATTENTION!'
Warning[1] := 'This ex...",20,150,
d4bf1b2f,micro,1,"The timeout mechanism throws exceptions!
That implies, that HDevelop will open an error dialog,
unle...","dev_update_off ()
dev_close_window ()",11,22,
d4bf1b2f,micro,2,partially lie outside the image,"get_system ('border_shape_models', BorderShapeModels)",25,29,
d4bf1b2f,micro,3,,"dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)",30,35,
d4bf1b2f,micro,4,,"Warning := 'ATTENTION!'
Warning[1] := 'This examples throws exceptions to demonstrate'
Warning[2] := 'timeouts!'
Warning[3] := 'To get meaningful runtime measurements make sure that'
Warning[4] := 'the error messages are suppressed in'
Warning[5] := 'Edit / Preferences / General Options / Experience...",36,47,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
* --- End of Automatically Added Context ---"
d4bf1b2f,micro,5,model image. The first run is made to fill the caches.,"Loops := 10
count_seconds (S1)
for Index := 1 to Loops by 1
endfor
count_seconds (S2)
Runtime := (S2 - S1) * 1000.0 / Loops",54,64,
d4bf1b2f,micro,6,should not exceed the measured runtime by more than 50 percent,"Timeout := floor(Runtime * 1.5)
dev_display (Image)
disp_message (WindowHandle, 'Model image', 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, 'Timeout set to ' + Timeout + ' ms', 'window', 40, 12, 'lime green', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",65,73,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
Runtime := (S2 - S1) * 1000.0 / Loops
Loops := 10
count_seconds (S1)
count_seconds (..."
d4bf1b2f,micro,7,the time measurement,"set_shape_model_param (ModelId, 'timeout', Timeout)
set_system ('timer_mode', 'performance_counter')",74,78,"* --- Automatically Added Context ---
Runtime := (S2 - S1) * 1000.0 / Loops
Loops := 10
count_seconds (S1)
count_seconds (S2)
Timeout := floor(Runtime * 1.5)
* --- End of Automatically Added Context -..."
d4bf1b2f,micro,8,error message in case of timeout,"for Index := 1 to Loops by 1
add_clutter (Image, ImageClutter)
dev_display (ImageClutter)
try
count_seconds (S1)
find_shape_model (ImageClutter, ModelId, rad(0), rad(360), 0.7, 1, 0.5, 'least_squares', [4, 1], 0.75, ModelRow, ModelColumn, ModelAngle, ModelScore)
count_seconds (S2)
Time := (S2 - S1) ...",79,126,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
Loops := 10
count_seconds (S1)
for Index := 1 to Loops by 1
count_seconds (S2)
Runti..."
d4bf1b2f,micro,9,,"set_system ('border_shape_models', BorderShapeModels)
set_shape_model_param (ModelId, 'timeout', 'false')
get_image_size (Image, Width, Height)
NumRectangle := int(rand(1) * 127.0) + 1
gen_random_regions (Regions, 'rectangle2', 2, 5, 10, 20, -0.78539997339248657, 0.78539997339248657, NumRectangle, W...",127,159,"* --- Automatically Added Context ---
get_system ('border_shape_models', BorderShapeModels)
dev_open_window_fit_image (Image, 0, 0, [600, 800], [400, 600], WindowHandle)
set_shape_model_param (ModelId..."
afd4fd9f,full,0,"***************************************************************
This example program shows how to us...","dev_update_window ('off')
dev_close_window ()
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
get_image_size (SearchImage, Width, Height)
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('yell...",21,156,
afd4fd9f,micro,1,,"dev_update_window ('off')
dev_close_window ()
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
get_image_size (SearchImage, Width, Height)
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 18, 'mono', 'true', 'false')
dev_set_color ('yell...",20,31,
afd4fd9f,micro,2,"1. Creation of the shape model (offline step)                 *
************************************...",create_generic_shape_model (ModelID),32,37,
afd4fd9f,micro,3,user.,gen_training_samples (TrainingSamples),42,44,
afd4fd9f,micro,4,"When samples are set, the extended parameter estimation is the
default behavior during training of t...","set_generic_shape_model_param (ModelID, 'training_samples', TrainingSamples)",45,48,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
gen_training_samples (TrainingSamples)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,5,,"dev_set_colored (3)
for Index := 0 to |TrainingSamples| - 1 by 1
Sample := TrainingSamples[Index]
count_obj (Sample.region, NumSampleRegions)
Text := join(['Sample image ',(Index + 1)$'d',' with ',NumSampleRegions$'d',' sample region',select_mask('s',NumSampleRegions [&gt;] 1)],'')
dev_display (Samp...",49,62,"* --- Automatically Added Context ---
gen_training_samples (TrainingSamples)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,6,,"dev_clear_window ()
read_contour_xld_dxf (ModelContour, 'contour_metal_part.dxf', [], [], DxfStatus)
dev_display (ModelContour)
Text := 'DXF contours used as shape model'
dev_disp_text (Text, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right',...",67,76,"* --- Automatically Added Context ---
Text := join(['Sample image ',(Index + 1)$'d',' with ',NumSampleRegions$'d',' sample region',select_mask('s',NumSampleRegions [&gt;] 1)],'')
dev_disp_text ('Press..."
afd4fd9f,micro,7,,"set_generic_shape_model_param (ModelID, 'extended_parameter_estimation', 'linear')",77,78,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,8,scaling factor.,"set_generic_shape_model_param (ModelID, 'iso_scale_max', 1.25)",79,82,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,9,"can be taken into account for the extended parameter
estimation.","set_generic_shape_model_param (ModelID, 'num_matches', 4)",83,86,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,10,,"train_generic_shape_model (ModelContour, ModelID)",87,88,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
read_contour_xld_dxf (ModelContour, 'contour_metal_part.dxf', [], [], DxfStatus)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,11,,"get_generic_shape_model_param (ModelID, 'min_score', EstimatedMinScore)",89,91,"* --- Automatically Added Context ---
create_generic_shape_model (ModelID)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,12,,"for Index := 1 to 6 by 1
read_image (SearchImage, 'metal-parts/metal_parts_large_' + Index$'.2d')
find_generic_shape_model (SearchImage, ModelID, MatchResultID, NumMatchResult)
get_generic_shape_model_result_object (Objects, MatchResultID, 'all', 'contours')
dev_display (SearchImage)
dev_display (Ob...",96,126,"* --- Automatically Added Context ---
read_image (SearchImage, 'metal-parts/metal_parts_large_01')
dev_open_window_fit_image (SearchImage, 0, 0, -1, -1, WindowHandle)
create_generic_shape_model (Model..."
afd4fd9f,micro,13,,"read_image (SampleImage1, 'metal-parts/metal_parts_large_01')
gen_rectangle2 (SampleImage1Label1, 535, 613, rad(-48), 250, 80)
SampleImage1Labels := SampleImage1Label1
TrainingSamples[0] := dict{image: SampleImage1, region: SampleImage1Labels}",141,145,"* --- Automatically Added Context ---
gen_training_samples (TrainingSamples)
* --- End of Automatically Added Context ---"
afd4fd9f,micro,14,,"read_image (SampleImage2, 'metal-parts/metal_parts_large_06')
gen_rectangle2 (SampleImage2Label1, 401, 637, rad(-64), 250, 80)
gen_rectangle2 (SampleImage2Label2, 357, 363, rad(-10), 250, 80)
gen_rectangle2 (SampleImage2Label3, 568, 338, rad(-37), 250, 80)",146,150,
afd4fd9f,micro,15,combined in a common region object.,"insert_obj (SampleImage2Label1, SampleImage2Label2, SampleImage2Labels, 2)
insert_obj (SampleImage2Labels, SampleImage2Label3, SampleImage2Labels, 3)
TrainingSamples[1] := dict{image: SampleImage2, region: SampleImage2Labels}
return ()",151,164,"* --- Automatically Added Context ---
gen_training_samples (TrainingSamples)
read_image (SampleImage2, 'metal-parts/metal_parts_large_06')
gen_rectangle2 (SampleImage2Label1, 401, 637, rad(-64), 250, ..."
fea70262,full,0,"This example program shows how to use matrices in HALCON.
In this example the holes with a radius of...","ExpectedRadius := [4.0, 6.5]
QualityValue := [0.3, 0.5]
NumberOfMaxIterations := 10
dev_update_off ()
dev_close_window ()
read_image (Image, 'board/board-04.png')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, '...",24,136,
fea70262,micro,1,"In this example the holes with a radius of 4.0 and 6.5 pixel
are searched for within a board.  The e...","ExpectedRadius := [4.0, 6.5]",6,24,
fea70262,micro,2,,"QualityValue := [0.3, 0.5]",25,26,
fea70262,micro,3,,NumberOfMaxIterations := 10,27,28,
fea70262,micro,4,,"dev_update_off ()
dev_close_window ()",29,31,
fea70262,micro,5,,"read_image (Image, 'board/board-04.png')
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_colored (12)
edges_sub_pix (Image, Edges, 'canny', 0.95, 20, 40)
dev_display (Edges)",32,39,
fea70262,micro,6,,"unknowns := 2
max_iter := 10",40,42,
fea70262,micro,7,,"dev_display (Image)
NrHoles := |ExpectedRadius|
CountHoles := []
Colors := ['magenta', 'blue']
for R := 0 to NrHoles - 1 by 1
CountHoles := [CountHoles,0]
select_contours_xld (Edges, SelectedContours, 'closed', 0, ExpectedRadius[R], 0, 0)
select_contours_xld (SelectedContours, SelectedContours, 'con...",43,142,"* --- Automatically Added Context ---
ExpectedRadius := [4.0, 6.5]
QualityValue := [0.3, 0.5]
NumberOfMaxIterations := 10
read_image (Image, 'board/board-04.png')
get_image_size (Image, Width, Height)..."
658ceca4,full,0,"This example shows how to estimate a HomMat3D from given
3D point correspondences.
For that, a least...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Please see the code for further information.', 'window', 12, 12, 'black', 'true')
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0...",10,154,
658ceca4,micro,1,"3D point correspondences.
For that, a least-squares estimation based on an SVD is used.
First, only ...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Please see the code for further information.', 'window', 12, 12, 'black', 'true')",6,13,
658ceca4,micro,2,,"PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
QX := [0.2, 0.3, 0.4]
QY := [0.1, 0.2, 0.1]
QZ := [0.1, 0.1, 0.1]",14,20,
658ceca4,micro,3,,"hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, QX, QY, QZ, HomMat3D)",21,22,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
QX := [0.2, 0.3, 0.4]
QY := [0.1, 0.2, 0.1]
QZ := [0.1, 0.1, 0.1]
* --- End of Automatically Add..."
658ceca4,micro,4,,"affine_trans_point_3d (HomMat3D, PX, PY, PZ, Qxtest, Qytest, Qztest)",23,24,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, QX, QY, QZ, HomMat3D)
* --- End of Autom..."
658ceca4,micro,5,"Because of numerical reasons, we obtain not 0 for some pose parameters,
but some very small number.","hom_mat3d_to_pose (HomMat3D, Pose)
* stop ()",25,29,"* --- Automatically Added Context ---
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, QX, QY, QZ, HomMat3D)
* --- End of Automatically Added Context ---"
658ceca4,micro,6,,"create_pose (1, 0, 0, 45, 0, 0, 'Rp+T', 'gba', 'point', Pose1)
pose_to_hom_mat3d (Pose1, HomMat3D1)
affine_trans_point_3d (HomMat3D1, PX, PY, PZ, Qxpose1, Qypose1, Qzpose1)
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, Qxpose1, Qypose1, Qzpose1, HomMat3DEstimated)",30,34,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
* --- End of Automatically Added Context ---"
658ceca4,micro,7,,"hom_mat3d_to_pose (HomMat3DEstimated, Posetest)",35,36,"* --- Automatically Added Context ---
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, Qxpose1, Qypose1, Qzpose1, HomMat3DEstimated)
* --- End of Automatically Added Context ---"
658ceca4,micro,8,,"affine_trans_point_3d (HomMat3DEstimated, PX, PY, PZ, Qxtest, Qytest, Qztest)
* dev_inspect_ctrl ([Qxpose1,Qxtest,Qypose1,Qytest,Qzpose1,Qztest])
* stop ()
* dev_close_inspect_ctrl ([Qxpose1,Qxtest,Qypose1,Qytest,Qzpose1,Qztest])",37,41,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
affine_trans_point_3d (HomMat3D, PX, PY, PZ, Qxtest, Qytest, Qztest)
affine_trans_point_3d (HomM..."
658ceca4,micro,9,,"create_pose (1, -320, 10, 45, -53, 22, 'Rp+T', 'gba', 'point', Pose1)
pose_to_hom_mat3d (Pose1, HomMat3D1)
affine_trans_point_3d (HomMat3D1, PX, PY, PZ, Qxpose1, Qypose1, Qzpose1)
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, Qxpose1, Qypose1, Qzpose1, HomMat3DEstimated)",42,46,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
create_pose (1, 0, 0, 45, 0, 0, 'Rp+T', 'gba', 'point', Pose1)
pose_to_hom_mat3d (Pose1, HomMat3..."
658ceca4,micro,10,"is estimated. Hence, in case of noise or errors only the ""best"" possible
estimate is returned, but i...","PX := [0.2, 0.4, 0.2, 0.3]
PY := [0.4, 0.6, 0.8, 0.6]
PZ := [0.6, 0.8, 0.6, 0.5]
QX := [0.25, 0.44, 0.61, 0.3]
QY := [0.32, 0.56, 0.82, 0.4]
QZ := [0.4, 0.18, 0.6, 0.51]
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, QX, QY, QZ, HomMat3D)
affine_trans_point_3d (HomMat3D, PX, PY, PZ, Qxtest,...",54,85,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
QX := [0.2, 0.3, 0.4]
QY := [0.1, 0.2, 0.1]
QZ := [0.1, 0.1, 0.1]
hom_mat_3d_from_3d_3d_point_co..."
658ceca4,micro,11,,"* sum_matrix (P, 'rows', PSum)
* scale_matrix (PSum, 1. / Columns, PMean)",86,88,"* --- Automatically Added Context ---
get_size_matrix (P, Rows, Columns)
* --- End of Automatically Added Context ---"
658ceca4,micro,12,,"mean_matrix (P, 'rows', PMean)",89,90,"* --- Automatically Added Context ---
get_size_matrix (P, Rows, Columns)
* scale_matrix (PSum, 1. / Columns, PMean)
* --- End of Automatically Added Context ---"
658ceca4,micro,13,,"create_matrix (1, Columns, 1, Ones)
mult_matrix (PMean, Ones, 'AB', PSub)
sub_matrix (P, PSub, PShift)
return ()",91,119,"* --- Automatically Added Context ---
get_size_matrix (P, Rows, Columns)
* scale_matrix (PSum, 1. / Columns, PMean)
* --- End of Automatically Added Context ---"
658ceca4,micro,14,,"create_matrix (3, |PX|, [PX,PY,PZ], P)
shift_data_to_origin (P, PShift, PMean)
create_matrix (3, |QX|, [QX,QY,QZ], Q)
shift_data_to_origin (Q, QShift, QMean)",120,124,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
PY := [0.1, 0.2, 0.1]
PZ := [0.1, 0.1, 0.1]
QX := [0.2, 0.3, 0.4]
QY := [0.1, 0.2, 0.1]
QZ := [0.1, 0.1, 0.1]
get_size_matrix (P, Rows, Colu..."
658ceca4,micro,15,,"create_matrix (3, 3, 0, M)
for Index := 0 to |PX| - 1 by 1
get_sub_matrix (PShift, 0, Index, 3, 1, PVec)
get_sub_matrix (QShift, 0, Index, 3, 1, QVec)
transpose_matrix_mod (QVec)
mult_matrix (PVec, QVec, 'AB', PQ)
add_matrix_mod (M, PQ)
endfor",125,133,"* --- Automatically Added Context ---
PX := [0.1, 0.2, 0.3]
mult_matrix (PMean, Ones, 'AB', PSub)
sub_matrix (P, PSub, PShift)
shift_data_to_origin (Q, QShift, QMean)
* --- End of Automatically Added ..."
658ceca4,micro,16,,"svd_matrix (M, 'full', 'both', U, S, V)
transpose_matrix_mod (U)",134,136,"* --- Automatically Added Context ---
create_matrix (3, 3, 0, M)
* --- End of Automatically Added Context ---"
658ceca4,micro,17,,"mult_matrix (V, U, 'AB', R)",137,138,"* --- Automatically Added Context ---
mult_matrix (PMean, Ones, 'AB', PSub)
svd_matrix (M, 'full', 'both', U, S, V)
* --- End of Automatically Added Context ---"
658ceca4,micro,18,,"determinant_matrix (R, 'general', Value)
if (Value &lt; 0)
get_value_matrix (V, [0, 1, 2], [2, 2, 2], Value1)
set_value_matrix (V, [0, 1, 2], [2, 2, 2], [-Value1[0],-Value1[1],-Value1[2]])
mult_matrix (V, U, 'AB', R)
endif",139,145,"* --- Automatically Added Context ---
mult_matrix (PMean, Ones, 'AB', PSub)
svd_matrix (M, 'full', 'both', U, S, V)
mult_matrix (V, U, 'AB', R)
* --- End of Automatically Added Context ---"
658ceca4,micro,19,,"mult_matrix (R, PMean, 'AB', RPMean)
sub_matrix (QMean, RPMean, t)",146,148,"* --- Automatically Added Context ---
* scale_matrix (PSum, 1. / Columns, PMean)
mult_matrix (PMean, Ones, 'AB', PSub)
shift_data_to_origin (Q, QShift, QMean)
mult_matrix (V, U, 'AB', R)
* --- End of ..."
658ceca4,micro,20,,"create_matrix (3, 4, 0, HomMat3DID)
set_sub_matrix (HomMat3DID, R, 0, 0)
set_sub_matrix (HomMat3DID, t, 0, 3)
get_full_matrix (HomMat3DID, HomMat3D)
return ()",149,170,"* --- Automatically Added Context ---
hom_mat_3d_from_3d_3d_point_correspondence (PX, PY, PZ, QX, QY, QZ, HomMat3D)
mult_matrix (V, U, 'AB', R)
* --- End of Automatically Added Context ---"
093a301f,full,0,"This example programs shows how to use matrices in HALCON to
solve a system of equations.
The exampl...","dev_update_off ()
dev_close_window ()
Size := 500
dev_open_window (0, 0, Size, Size, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_part (0, 0, Size - 1, Size - 1)
X := [25:50:Size]
Y := 15 + 0.4 * X + 0.001 * X * X
Y := Y + 40 * rand(|Y|)
gen_cross_conto...",10,72,
093a301f,micro,1,"solve a system of equations.
The example generates a sequence of random points and fits
a quadratic ...","dev_update_off ()
dev_close_window ()
Size := 500
dev_open_window (0, 0, Size, Size, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_part (0, 0, Size - 1, Size - 1)",6,16,
093a301f,micro,2,a second order curve,"X := [25:50:Size]
Y := 15 + 0.4 * X + 0.001 * X * X
Y := Y + 40 * rand(|Y|)",17,23,"* --- Automatically Added Context ---
Size := 500
* --- End of Automatically Added Context ---"
093a301f,micro,3,,"gen_cross_contour_xld (Cross, Size - Y, X, 15, 0.785398)
dev_set_color ('blue')
dev_set_line_width (3)
dev_display (Cross)
disp_message (WindowHandle, 'Input point sequence', 'window', 70, 25, 'blue', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",24,33,"* --- Automatically Added Context ---
Size := 500
dev_open_window (0, 0, Size, Size, 'white', WindowHandle)
X := [25:50:Size]
Y := 15 + 0.4 * X + 0.001 * X * X
* --- End of Automatically Added Context..."
093a301f,micro,4,,"create_matrix (|X|, 3, 1.0, MatrixA)
create_matrix (|X|, 1, X, MatrixACol1)
create_matrix (|X|, 1, X * X, MatrixACol0)
set_sub_matrix (MatrixA, MatrixACol1, 0, 1)
set_sub_matrix (MatrixA, MatrixACol0, 0, 0)
create_matrix (|X|, 1, Y, MatrixB)
solve_matrix (MatrixA, 'general', 0, MatrixB, MatrixX)",48,58,"* --- Automatically Added Context ---
Size := 500
X := [25:50:Size]
Y := 15 + 0.4 * X + 0.001 * X * X
* --- End of Automatically Added Context ---"
093a301f,micro,5,,"Sequence := [0:1200]
get_value_matrix (MatrixX, 0, 0, A)
get_value_matrix (MatrixX, 1, 0, B)
get_value_matrix (MatrixX, 2, 0, C)
Distances := A * Sequence * Sequence + B * Sequence + C
gen_contour_polygon_xld (Contour, Size - Distances, Sequence)
dev_set_color ('forest green')
dev_display (Contour)
...",59,79,"* --- Automatically Added Context ---
Size := 500
dev_open_window (0, 0, Size, Size, 'white', WindowHandle)
solve_matrix (MatrixA, 'general', 0, MatrixB, MatrixX)
* --- End of Automatically Added Cont..."
7fab5223,full,0,,"read_image (Image, 'mreut')
gray_closing_rect (Image, ImageClosing, 11, 11)",6,7,
00570e12,full,0,"This example program shows how to use gray_closing_shape.  It performs
a gray value closing with dif...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_clo...",10,46,
00570e12,micro,1,"a gray value closing with different mask sizes, using as well integer as float
values for the mask s...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']",6,20,
00570e12,micro,2,The gaps between the odd integer values are filled with float values.,"for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_closing_shape (Image, ImageClosing, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 - Step by Step
gray_closing_shape (Image, ImageClosing, Float, Float, Shape[CurShape])
endfor
endfor
stop ()
endfor",21,33,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
* --- End of Automatically Added Context ---"
00570e12,micro,3,different width and height.,"for Float := Start to End by Step
gray_closing_shape (Image, ImageClosing, 1.0, Float, 'rectangle')
endfor
stop ()",34,41,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
gray_closing_shape (Image, ImageClosing, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + ..."
00570e12,micro,4,mask size was passed as an integer or a float!,"gray_closing_shape (Image, ImageClosingInteger, 12, 12, 'rhombus')
gray_closing_shape (Image, ImageClosingFloat, 12.0, 12.0, 'rhombus')
sub_image (ImageClosingInteger, ImageClosingFloat, ImageSub, 1, 128)",42,52,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
c4e56524,full,0,,"read_image (Image, 'mreut')
gray_dilation_rect (Image, Dilation, 11, 11)
gray_erosion_rect (Dilation, Closing, 11, 11)",6,8,
b5a6b8d9,full,0,"This example program shows how to use gray_dilation_shape.  It performs
a gray value dilation with d...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_dil...",11,62,
b5a6b8d9,micro,1,"a gray value dilation with different mask sizes, using as well integer as float
values for the mask ...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']",6,21,
b5a6b8d9,micro,2,"The gaps between the odd integer values are filled with float values. Subsequently,
the result of th...","for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_dilation_shape (Image, ImageMax, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 - Step by Step
gray_dilation_shape (Image, ImageMax, Float, Float, Shape[CurShape])
endfor
endfor
for Int := Start to End by 2
gray_e...",22,44,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
* --- End of Automatically Added Context ---"
b5a6b8d9,micro,3,different width and height.,"for Float := Start to End by Step
gray_dilation_shape (Image, ImageMax, 1.0, Float, 'rectangle')
endfor
for Float := Start to End by Step
gray_erosion_shape (ImageMax, ImageMin, 1.0, Float, 'rectangle')
endfor
stop ()",45,57,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
gray_dilation_shape (Image, ImageMax, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 -..."
b5a6b8d9,micro,4,mask size was passed as an integer or a float!,"gray_dilation_shape (Image, ImageMaxInteger, 12, 12, 'rhombus')
gray_dilation_shape (Image, ImageMaxFloat, 12.0, 12.0, 'rhombus')
sub_image (ImageMaxInteger, ImageMaxFloat, ImageSub, 1, 128)",58,68,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
b3b6a36c,full,0,,"read_image (Image, 'mreut')
gray_erosion_rect (Image, Erosion, 11, 11)
gray_dilation_rect (Erosion, Opening, 11, 11)",6,8,
9cba9a95,full,0,"This example program shows how to use gray_erosion_shape.  It performs
a gray value erosion with dif...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_ero...",11,62,
9cba9a95,micro,1,"a gray value erosion with different mask sizes, using as well integer as float
values for the mask s...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']",6,21,
9cba9a95,micro,2,"The gaps between the odd integer values are filled with float values. Subsequently,
the result of th...","for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_erosion_shape (Image, ImageMin, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 - Step by Step
gray_erosion_shape (Image, ImageMin, Float, Float, Shape[CurShape])
endfor
endfor
for Int := Start to End by 2
gray_dil...",22,44,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
* --- End of Automatically Added Context ---"
9cba9a95,micro,3,different width and height.,"for Float := Start to End by Step
gray_erosion_shape (Image, ImageMin, 1.0, Float, 'rectangle')
endfor
for Float := Start to End by Step
gray_dilation_shape (ImageMin, ImageMax, 1.0, Float, 'rectangle')
endfor
stop ()",45,57,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
gray_erosion_shape (Image, ImageMin, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 - ..."
9cba9a95,micro,4,mask size was passed as an integer or a float!,"gray_erosion_shape (Image, ImageMinInteger, 12, 12, 'rhombus')
gray_erosion_shape (Image, ImageMinFloat, 12.0, 12.0, 'rhombus')
sub_image (ImageMinInteger, ImageMinFloat, ImageSub, 1, 128)",58,68,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
9f9cdcbe,full,0,"This programs demonstrates the effect of the gray
morphology operator gray_erosion_shape applied
wit...","dev_update_off ()
read_image (Image, 'alpha2')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
for Size := 1 to 20 by 0.05
gray_erosion_shape (Image...",10,31,
9f9cdcbe,micro,1,"morphology operator gray_erosion_shape applied
with subpixel-precision","dev_update_off ()
read_image (Image, 'alpha2')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)",6,17,
9f9cdcbe,micro,2,,"for Size := 1 to 20 by 0.05
gray_erosion_shape (Image, ImageMin, Size, Size, 'octagon')
dev_display (ImageMin)
endfor
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",18,25,"* --- Automatically Added Context ---
read_image (Image, 'alpha2')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
9f9cdcbe,micro,3,,"dev_set_part (280, 280, 330, 330)
for Size := 1 to 5 by 0.01
gray_erosion_shape (Image, ImageMin, Size, Size, 'octagon')
dev_display (ImageMin)
endfor",26,37,"* --- Automatically Added Context ---
read_image (Image, 'alpha2')
for Size := 1 to 20 by 0.05
gray_erosion_shape (Image, ImageMin, Size, Size, 'octagon')
* --- End of Automatically Added Context ---"
9469bd0d,full,0,"This example demonstrates the general gray morphology. ""General""
means, that any shape for the struc...","dev_close_window ()
read_image (Image, 'pcb_layout')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 800, 700, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('fill')
dev_update_off ()
dev_set_colored (6)
dev_display (Imag...",11,90,
9469bd0d,micro,1,"means, that any shape for the structuring elements can be used.
The example shows how to segment the...","dev_close_window ()
read_image (Image, 'pcb_layout')
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, 800, 700, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('fill')
dev_update_off ()
dev_set_colored (6)
dev_display (Imag...",7,23,
9469bd0d,micro,2,of the drill holes we are looking for.,"gen_image_const (ConstImage, 'byte', 11, 11)
get_image_size (ConstImage, MaskWidth, MaskHeight)
gen_circle (Circle, (MaskHeight - 1) / 2.0, (MaskWidth - 1) / 2.0, 3)
reduce_domain (ConstImage, Circle, ImageReduced)",24,30,
9469bd0d,micro,3,to load the program code into memory,"gray_closing (Image, ImageReduced, ImageClosingFast)
gray_opening (Image, ImageReduced, ImageOpeningFast)
sub_image (ImageClosingFast, ImageOpeningFast, ImageSubFast, 1, 0)",31,35,"* --- Automatically Added Context ---
read_image (Image, 'pcb_layout')
reduce_domain (ConstImage, Circle, ImageReduced)
* --- End of Automatically Added Context ---"
9469bd0d,micro,4,,"count_seconds (Start)
gray_closing (Image, ImageReduced, ImageClosingFast)
gray_opening (Image, ImageReduced, ImageOpeningFast)
sub_image (ImageClosingFast, ImageOpeningFast, ImageSubFast, 1, 0)
count_seconds (End)
dev_display (ImageSubFast)
disp_message (WindowHandle, ['Subtraction of gray_closing'...",36,80,"* --- Automatically Added Context ---
read_image (Image, 'pcb_layout')
dev_open_window_fit_size (0, 0, Width, Height, 800, 700, WindowHandle)
gen_image_const (ConstImage, 'byte', 11, 11)
get_image_siz..."
9469bd0d,micro,5,,"select_shape (ConnectedRegions, SelectedRegions, ['circularity', 'area'], 'and', [0.85, 7], [1.0, 30])",81,82,"* --- Automatically Added Context ---
connection (Region, ConnectedRegions)
* --- End of Automatically Added Context ---"
9469bd0d,micro,6,(select objects with a minimum contrast),"dilation_circle (SelectedRegions, RegionDilation, 5)
difference (RegionDilation, SelectedRegions, RegionDifference)
intensity (SelectedRegions, Image, Mean, Deviation)
intensity (RegionDifference, Image, Mean1, Deviation1)
select_mask_obj (SelectedRegions, Holes, Mean - Mean1 [&gt;] Contrast)
return...",83,101,"* --- Automatically Added Context ---
read_image (Image, 'pcb_layout')
dilation_circle (HolesFast, RegionDilation, 3.5)
select_shape (ConnectedRegions, SelectedRegions, ['circularity', 'area'], 'and',..."
d455e784,full,0,,"read_image (Image, 'mreut')
gray_opening_rect (Image, ImageOpening, 11, 11)",6,7,
52ea294d,full,0,"This example program shows how to use gray_opening_shape.  It performs
a gray value opening with dif...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_ope...",10,46,
52ea294d,micro,1,"a gray value opening with different mask sizes, using as well integer as float
values for the mask s...","read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']",6,20,
52ea294d,micro,2,The gaps between the odd integer values are filled with float values.,"for CurShape := 0 to |Shape| - 1 by 1
for Int := Start to End by 2
gray_opening_shape (Image, ImageOpening, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + 2 - Step by Step
gray_opening_shape (Image, ImageOpening, Float, Float, Shape[CurShape])
endfor
endfor
stop ()
endfor",21,33,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
Shape := ['rhombus', 'octagon', 'rectangle']
* --- End of Automatically Added Context ---"
52ea294d,micro,3,different width and height.,"for Float := Start to End by Step
gray_opening_shape (Image, ImageOpening, 1.0, Float, 'rectangle')
endfor
stop ()",34,41,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
Step := 0.1
Start := 1
End := 13
gray_opening_shape (Image, ImageOpening, Int, Int, Shape[CurShape])
for Float := Int + Step to Int + ..."
52ea294d,micro,4,mask size was passed as an integer or a float!,"gray_opening_shape (Image, ImageOpeningInteger, 12, 12, 'rhombus')
gray_opening_shape (Image, ImageOpeningFloat, 12.0, 12.0, 'rhombus')
sub_image (ImageOpeningInteger, ImageOpeningFloat, ImageSub, 1, 128)",42,52,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
191d9a4d,full,0,,"read_image (Image, 'pcb')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (Image)
gray_opening_shape (Image, ImageOpening, 7, 7, 'octagon')
gray_closing_shape (Image, ImageClosing, 7, 7, 'octagon')
dyn_threshold (Imag...",6,18,
191d9a4d,micro,1,,"gray_opening_shape (Image, ImageOpening, 7, 7, 'octagon')
gray_closing_shape (Image, ImageClosing, 7, 7, 'octagon')
dyn_threshold (ImageOpening, ImageClosing, RegionDynThresh, 75, 'not_equal')
dev_display (Image)
dev_set_color ('red')
dev_set_draw ('margin')
dev_display (RegionDynThresh)",11,24,"* --- Automatically Added Context ---
read_image (Image, 'pcb')
* --- End of Automatically Added Context ---"
92639670,full,0,"This programs demonstrates the use of basic morphology
operators.
The aim of the program is to detec...","dev_update_off ()
read_image (Image, 'pellets')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_set_colored (6)
dev_set_draw ('ma...",11,65,
92639670,micro,1,"operators.
The aim of the program is to detect each single pellet
(bright particle on a darker backg...","dev_update_off ()
read_image (Image, 'pellets')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_set_colored (6)
dev_set_draw ('ma...",6,25,
92639670,micro,2,,"binary_threshold (Image, LightRegion, 'max_separability', 'light', UsedThreshold)
opening_circle (LightRegion, Region, 3.5)
dev_display (Region)
disp_message (WindowID, 'First, segment the pellets', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowID, 'black', 'true')
stop ()",26,33,"* --- Automatically Added Context ---
read_image (Image, 'pellets')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
92639670,micro,3,"Note, that this approach fails, because some of
the pellets are still connected.","connection (Region, ConnectedRegionsWrong)
dev_display (Image)
dev_display (ConnectedRegionsWrong)
disp_message (WindowID, 'Simple connection fails', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowID, 'black', 'true')
stop ()",34,43,"* --- Automatically Added Context ---
read_image (Image, 'pellets')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
opening_circle (LightRegion, Region, 3.5)
* --- End of Automatically Added ..."
92639670,micro,4,,"erosion_circle (Region, RegionErosion, 7.5)
dev_display (Image)
dev_display (RegionErosion)
disp_message (WindowID, 'Erosion of the pellet regions', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowID, 'black', 'true')
stop ()",44,51,"* --- Automatically Added Context ---
read_image (Image, 'pellets')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
opening_circle (LightRegion, Region, 3.5)
* --- End of Automatically Added ..."
92639670,micro,5,,"connection (RegionErosion, ConnectedRegions)
dev_display (Image)
dev_display (ConnectedRegions)
disp_message (WindowID, 'Perform connection now', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowID, 'black', 'true')
stop ()",52,59,"* --- Automatically Added Context ---
read_image (Image, 'pellets')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
erosion_circle (Region, RegionErosion, 7.5)
* --- End of Automatically Adde..."
92639670,micro,6,,"dilation_circle (ConnectedRegions, RegionDilation, 7.5)
count_obj (RegionDilation, Number)
dev_display (Image)
dev_display (RegionDilation)
disp_message (WindowID, Number + ' pellets detected', 'window', 12, 12, 'black', 'true')",60,71,"* --- Automatically Added Context ---
read_image (Image, 'pellets')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
connection (RegionErosion, ConnectedRegions)
* --- End of Automatically Add..."
bc87861b,full,0,Apply an opening to a region,"dev_close_window ()
read_image (letters, 'letters')
get_image_size (letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
dev_display (letters)
threshold (letters, Region, 0, 100)
connection (Region, ConnectedRegions)
select_obj (ConnectedRegions, ObjectSelected, 1...",8,21,
bc87861b,micro,1,,"dev_close_window ()
read_image (letters, 'letters')
get_image_size (letters, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
dev_display (letters)
threshold (letters, Region, 0, 100)
connection (Region, ConnectedRegions)
select_obj (ConnectedRegions, ObjectSelected, 1...",6,15,
bc87861b,micro,2,,"erosion_circle (ObjectSelected, RegionErosion, 1.5)
opening (Region, RegionErosion, RegionOpening)
dev_display (letters)
dev_set_color ('red')
dev_display (RegionOpening)",16,27,"* --- Automatically Added Context ---
threshold (letters, Region, 0, 100)
select_obj (ConnectedRegions, ObjectSelected, 100)
* --- End of Automatically Added Context ---"
74df708a,full,0,"This example program shows the usage of the operator compare_obj.
In particular, it shows the differ...","dev_update_off ()
read_image (Images, ['particle', 'particle', 'monkey'])
select_obj (Images, Image1, 1)
select_obj (Images, Image2, 2)
select_obj (Images, Image3, 3)
TextColor := ['red', 'green']
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Column1,...",13,241,
74df708a,micro,1,"In particular, it shows the difference between compare_obj and
test_equal_obj. compare_obj compares ...",dev_update_off (),6,14,
74df708a,micro,2,,"read_image (Images, ['particle', 'particle', 'monkey'])
select_obj (Images, Image1, 1)
select_obj (Images, Image2, 2)
select_obj (Images, Image3, 3)
TextColor := ['red', 'green']
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
dis...",15,26,
74df708a,micro,3,test_equal_obj and compare_obj are both 1.,"test_equal_obj (Image1, Image1, EqualObj)
compare_obj (Image1, Image1, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[1] + 150, Column1[1] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1[1] ...",29,35,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
* --- End of Automatica..."
74df708a,micro,4,"The results of the operators differ. test_equal_obj returns
the information that the two objects are...","test_equal_obj (Image1, Image2, EqualObj)
compare_obj (Image1, Image2, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[3] + 150, Column1[3] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1[3] ...",38,47,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
select_obj (Images, Image2, 2)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, Window..."
74df708a,micro,5,"Test two objects with different content.
The result of both operators is 0.","test_equal_obj (Image1, Image3, EqualObj)
compare_obj (Image1, Image3, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[5] + 150, Column1[5] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1[5] ...",48,58,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
select_obj (Images, Image3, 3)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, Window..."
74df708a,micro,6,,"threshold (Image1, Region1, 128, 255)
threshold (Image1, Region2, 128, 255)
threshold (Image3, Region3, 210, 255)
concat_obj (Region1, Region2, Regions)
concat_obj (Regions, Region3, Regions)
disp_compared_regions (Regions, TestObjectIndices, Row1, Column1, WindowHandle)
disp_message (WindowHandle, ...",59,68,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
select_obj (Images, Image3, 3)
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Colum..."
74df708a,micro,7,test_equal_obj and compare_obj are both 1.,"test_equal_obj (Region1, Region1, EqualObj)
compare_obj (Region1, Region1, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[1] + 150, Column1[1] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1...",71,77,"* --- Automatically Added Context ---
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
test_equal_obj (Image1, Image1, EqualObj)
compare_obj ..."
74df708a,micro,8,"For regions, both operators compare the content.
Thus, both operators return 1 in this case.","test_equal_obj (Region1, Region2, EqualObj)
compare_obj (Region1, Region2, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[3] + 150, Column1[3] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1...",80,87,"* --- Automatically Added Context ---
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
test_equal_obj (Image1, Image1, EqualObj)
compare_obj ..."
74df708a,micro,9,"Test two objects with different content.
The result of both operators is 0.","test_equal_obj (Region1, Region3, EqualObj)
compare_obj (Region1, Region3, 0, CompareObj)
disp_message (WindowHandle, 'test_equal_obj = ' + EqualObj, 'image', Row1[5] + 150, Column1[5] + 600, TextColor[EqualObj], 'false')
disp_message (WindowHandle, 'compare_equal_obj = ' + CompareObj, 'image', Row1...",88,98,"* --- Automatically Added Context ---
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
test_equal_obj (Image1, Image1, EqualObj)
compare_obj ..."
74df708a,micro,10,"small changes of the gray values of a pixel (or
the row or column coordinates of the XLD points)
are...","add_noise_white (Image1, ImageNoise15, 15)
add_noise_white (Image1, ImageNoise30, 30)
concat_obj (Image1, ImageNoise15, ImagesNoise)
concat_obj (ImagesNoise, ImageNoise30, ImagesNoise)
disp_compared_images (ImagesNoise, TestObjectIndices, Row1, Column1, WindowHandle)
disp_message (WindowHandle, 'Whe...",99,110,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
* --- End of ..."
74df708a,micro,11,,"compare_obj (Image1, Image1, 0, CompareObjEps0)
compare_obj (Image1, Image1, 20, CompareObjEps20)
disp_message (WindowHandle, 'compare_equal_obj ', 'image', Row1[1] + 050, Column1[1] + 600, 'white', 'false')
disp_message (WindowHandle, ' with Epsilon =  0: ' + CompareObjEps0, 'image', Row1[1] + 150,...",115,121,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
disp_message (WindowHan..."
74df708a,micro,12,,"compare_obj (Image1, ImageNoise15, 0, CompareObjEps0)
compare_obj (Image1, ImageNoise15, 20, CompareObjEps20)
disp_message (WindowHandle, 'compare_equal_obj (Noise = 15):', 'image', Row1[3] + 050, Column1[3] + 600, 'white', 'false')
disp_message (WindowHandle, ' with Epsilon =  0: ' + CompareObjEps0...",122,128,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
add_noise_white (Image1..."
74df708a,micro,13,,"compare_obj (Image1, ImageNoise30, 0, CompareObjEps0)
compare_obj (Image1, ImageNoise30, 20, CompareObjEps20)
disp_message (WindowHandle, 'compare_equal_obj (Noise = 30):', 'image', Row1[5] + 050, Column1[5] + 600, 'white', 'false')
disp_message (WindowHandle, ' with Epsilon =  0: ' + CompareObjEps0...",129,155,"* --- Automatically Added Context ---
select_obj (Images, Image1, 1)
TextColor := ['red', 'green']
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
add_noise_white (Image1..."
74df708a,micro,14,,"gen_empty_obj (RegionsDisp)
for I := 1 to |TestObjectIndices| by 1
select_obj (Images, ObjectSelected, TestObjectIndices[I - 1])
concat_obj (RegionsDisp, ObjectSelected, RegionsDisp)
endfor
Row1 := [500, 500, 1150, 1150, 1800, 1800]
Column1 := [150, 700, 150, 700, 150, 700]
Color1 := 'cyan'
Color2 :...",156,174,"* --- Automatically Added Context ---
read_image (Images, ['particle', 'particle', 'monkey'])
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Column1, Wi..."
74df708a,micro,15,,"dev_close_window ()
dev_open_window_fit_image (TiledImage, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (TiledImage)
dev_set_draw ('margin')
dev_set_color (Color)
dev_display (Rectangle)
disp_message (WindowHandle, 'Image ' + TestObjectIndices,...",175,211,"* --- Automatically Added Context ---
TestObjectIndices := [1, 1, 1, 2, 1, 3]
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
Color := [Color1,Color1,Color1,Color2,Color1..."
74df708a,micro,16,,"Row1 := [500, 500, 1150, 1150, 1800, 1800]
Column1 := [150, 700, 150, 700, 150, 700]
gen_empty_obj (RegionsDisp)
for I := 1 to |RegionTestIndices| by 1
select_obj (Regions, ObjectSelected, RegionTestIndices[I - 1])
move_region (ObjectSelected, RegionMoved, Row1[I - 1], Column1[I - 1])
concat_obj (Re...",212,229,"* --- Automatically Added Context ---
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
concat_obj (Region1, Region2, Regions)
gen_empty_obj (RegionsDisp)
for I := 1 to |Te..."
74df708a,micro,17,,"dev_close_window ()
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_color ('white')
dev_display (Rectangle)
dev_set_draw ('fill')
dev_set_color (Color)
dev_display (RegionsDisp)
disp_mes...",230,253,"* --- Automatically Added Context ---
disp_compared_images (Images, TestObjectIndices, Row1, Column1, WindowHandle)
gen_empty_obj (RegionsDisp)
Color := [Color1,Color1,Color1,Color2,Color1,Color3]
gen..."
81dc1d12,full,0,This example demonstrates a use case for the insert_obj operator.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (Images, ['food/vegetables/apple_1', 'food/vegetables/carrot_1'])
read_image (ImageBlueberry, 'food/vegetables/blueberry_1')
tile_imag...",9,28,
81dc1d12,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",7,13,
81dc1d12,micro,2,,"read_image (Images, ['food/vegetables/apple_1', 'food/vegetables/carrot_1'])
read_image (ImageBlueberry, 'food/vegetables/blueberry_1')",14,17,
81dc1d12,micro,3,,"tile_images (Images, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text ('Starting with an array of two images.', 'window', 'top', 'left', 'black', [], [])
stop ()",18,23,"* --- Automatically Added Context ---
read_image (Images, ['food/vegetables/apple_1', 'food/vegetables/carrot_1'])
* --- End of Automatically Added Context ---"
81dc1d12,micro,4,,"insert_obj (Images, ImageBlueberry, ImagesExtended, 2)
tile_images (ImagesExtended, ImagesExtendedTiled, 1, 'vertical')
dev_display (ImagesExtendedTiled)
dev_disp_text ('Inserted an image in-between the existing images.', 'window', 'top', 'left', 'black', [], [])",24,34,"* --- Automatically Added Context ---
read_image (Images, ['food/vegetables/apple_1', 'food/vegetables/carrot_1'])
read_image (ImageBlueberry, 'food/vegetables/blueberry_1')
* --- End of Automatically..."
36466dc2,full,0,This example program shows how to use obj_diff.,"read_image (Image, 'particle')
threshold (Image, Region, 57, 255)
connection (Region, ConnectedRegions)
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_...",8,68,
36466dc2,micro,1,,"read_image (Image, 'particle')
threshold (Image, Region, 57, 255)
connection (Region, ConnectedRegions)",7,11,
36466dc2,micro,2,,"dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_draw ('fill')
dev_set_colored (6)",12,19,"* --- Automatically Added Context ---
read_image (Image, 'particle')
* --- End of Automatically Added Context ---"
36466dc2,micro,3,"e.g., to extract those objects from an input tuple
that have not yet been processed.","select_shape (ConnectedRegions, LeftRegions, 'column', 'and', 0.0, 256.0)
obj_diff (ConnectedRegions, LeftRegions, RightRegions)
dev_clear_window ()
dev_display (RightRegions)
disp_message (WindowHandle, 'Difference of all regions and\nleft hand side regions:\nRight hand side regions', 'window', 12,...",20,30,"* --- Automatically Added Context ---
connection (Region, ConnectedRegions)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
* --- End of Automatically Added Context ---"
36466dc2,micro,4,,"gen_empty_obj (EmptyObject)
obj_diff (ConnectedRegions, EmptyObject, ObjectsDiff)
dev_clear_window ()
dev_display (ObjectsDiff)
disp_message (WindowHandle, 'Difference of all regions and\nan empty object:\nAll regions', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black',...",31,39,"* --- Automatically Added Context ---
connection (Region, ConnectedRegions)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
disp_message (WindowHandle, 'Difference of all regions ..."
36466dc2,micro,5,,"obj_diff (EmptyObject, LeftRegions, ObjectsDiff)
dev_clear_window ()
dev_display (ObjectsDiff)
disp_message (WindowHandle, 'Difference of an empty object\nand any other object:\nAn empty object', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",40,47,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
select_shape (ConnectedRegions, LeftRegions, 'column', 'and', 0.0, 256.0)
disp_message (Windo..."
36466dc2,micro,6,"the memory but not by their actual contents! Therefore,
the following images are considered as being...","read_image (SameImage, 'particle')
obj_diff (Image, SameImage, ObjectsDiff)
dev_clear_window ()
dev_display (ObjectsDiff)
disp_message (WindowHandle, 'Difference of an image and\nthe same image reloaded:\nThe original image', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'b...",48,60,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
disp_message (WindowHandle, 'Difference of all regions and\nle..."
36466dc2,micro,7,,"gen_contour_polygon_xld (Contour, [50, 150, 250, 250, 250], [50, 50, 50, 150, 250])
concat_obj (Region, Contour, RegionAndXLD)
concat_obj (Region, Image, ImageAndRegion)
obj_diff (RegionAndXLD, ImageAndRegion, ObjectsDiff)
dev_clear_window ()
dev_display (ObjectsDiff)
disp_message (WindowHandle, 'Di...",61,74,"* --- Automatically Added Context ---
read_image (Image, 'particle')
threshold (Image, Region, 57, 255)
dev_open_window_fit_image (Image, 0, 0, Width, Height, WindowHandle)
disp_message (WindowHandle,..."
1421d511,full,0,This example demonstrates various use cases for the remove_obj operator.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
tile_i...",9,57,
1421d511,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",7,13,
1421d511,micro,2,,"read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])",14,16,
1421d511,micro,3,,"tile_images (ImagesAll, TiledImagesAll, 1, 'vertical')
dev_display (TiledImagesAll)
dev_disp_text ('There are four objects in the iconic array.', 'window', 'top', 'left', 'black', [], [])
stop ()",17,22,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
* --- End of Automatica..."
1421d511,micro,4,,"remove_obj (ImagesAll, ImagesReduced, 3)
tile_images (ImagesReduced, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text ('Removed the Carrots (array element 3) from original.', 'window', 'top', 'left', 'black', [], [])
stop ()",23,29,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
* --- End of Automatica..."
1421d511,micro,5,,"remove_obj (ImagesAll, ImagesReduced, [1, 3, 4])
tile_images (ImagesReduced, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text ('Removed Carrots, Potatoes and Apples (Elements 1, 3 and 4).', 'window', 'top', 'left', 'black', [], [])
stop ()",30,36,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
remove_obj (ImagesAll, ..."
1421d511,micro,6,,"remove_obj (ImagesAll, ImagesReduced, [3, 2, 2, 3, 3])
tile_images (ImagesReduced, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text (['remove_obj is tolerant against duplicates.', 'Removed Carrots and Blueberries with Index [3,2,2,3,3].'], 'window', 'top', 'left', 'black', [], [])
s...",37,43,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
remove_obj (ImagesAll, ..."
1421d511,micro,7,,"remove_obj (ImagesAll, ImagesReduced, [])
tile_images (ImagesReduced, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text ('Remove none of the objects.', 'window', 'top', 'left', 'black', [], [])
stop ()",44,50,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
remove_obj (ImagesAll, ..."
1421d511,micro,8,,"remove_obj (ImagesAll, ImagesReduced, [1, 2, 3, 4])
tile_images (ImagesReduced, TiledImage, 1, 'vertical')
dev_clear_window ()
dev_display (TiledImage)
count_obj (ImagesReduced, RemainCount)
dev_disp_text ('Removed all objects, there are ' + RemainCount + ' remaining objects', 'window', 'top', 'left...",51,63,"* --- Automatically Added Context ---
read_image (ImagesAll, ['food/vegetables/apple_1', 'food/vegetables/blueberry_1', 'food/vegetables/carrot_1', 'food/vegetables/potato_1'])
remove_obj (ImagesAll, ..."
1e034ee5,full,0,This example demonstrates how to use the replace_obj operator.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_image (ImagesFood, ['food/vegetables/apple_1', 'food/vegetables/carrot_1', 'food/vegetables/blueberry_1'])
tile_images (ImagesFood, TiledIma...",9,28,
1e034ee5,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",7,13,
1e034ee5,micro,2,,"read_image (ImagesFood, ['food/vegetables/apple_1', 'food/vegetables/carrot_1', 'food/vegetables/blueberry_1'])",14,16,
1e034ee5,micro,3,,"tile_images (ImagesFood, TiledImage, 1, 'vertical')
dev_display (TiledImage)
dev_disp_text ('Starting with three images.', 'window', 'top', 'left', 'black', [], [])
stop ()",17,22,"* --- Automatically Added Context ---
read_image (ImagesFood, ['food/vegetables/apple_1', 'food/vegetables/carrot_1', 'food/vegetables/blueberry_1'])
* --- End of Automatically Added Context ---"
1e034ee5,micro,4,,"read_image (ImagesReplace, ['food/vegetables/strawberry_1', 'food/vegetables/raspberry_1'])
replace_obj (ImagesFood, ImagesReplace, ImagesFruits, [2, 4])
tile_images (ImagesFruits, ImagesTiled, 1, 'vertical')
dev_display (ImagesTiled)
dev_disp_text ('Replaced (and added) vegetables by fruits.', 'win...",23,34,"* --- Automatically Added Context ---
read_image (ImagesFood, ['food/vegetables/apple_1', 'food/vegetables/carrot_1', 'food/vegetables/blueberry_1'])
* --- End of Automatically Added Context ---"
0dc464af,full,0,"This example compares the performance of pretrained
MLP and CNN fonts on artificially distorted char...","dev_update_off ()
dev_close_window ()
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_mlp ('Industrial_NoRej', OCRHandleMLP)
read_ocr_class_cnn ('Universal_NoRej.occ', OCRHandleCNN...",9,154,
0dc464af,micro,1,MLP and CNN fonts on artificially distorted characters.,"dev_update_off ()
dev_close_window ()
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_mlp ('Industrial_NoRej', OCRHandleMLP)
read_ocr_class_cnn ('Universal_NoRej.occ', OCRHandleCNN...",6,16,
0dc464af,micro,2,,"binary_threshold (Image, DarkRegion, 'max_separability', 'dark', UsedThreshold)
dilation_circle (DarkRegion, CharRegion, 2.500000)
connection (CharRegion, CharConnected)
intersection (CharConnected, DarkRegion, CharOrig)
sort_region (CharOrig, Characters, 'character', 'true', 'row')",17,23,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
0dc464af,micro,3,,"count_obj (Characters, Number)
Length := Number / 27
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(Length,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(Length,'.')]",24,32,"* --- Automatically Added Context ---
sort_region (CharOrig, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
0dc464af,micro,4,,"dev_display (Image)
dev_set_colored (12)
dev_set_draw ('margin')
dev_set_shape ('rectangle1')
dev_display (Characters)
dev_disp_text (['Read distorted variants of the shown characters', 'with pretrained MLP and CNN fonts.'], 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to contin...",33,43,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (CharOrig, Characters, 'character', 'true', 'row')
* --- E..."
0dc464af,micro,5,rates and classification times.,"NumDistort := 10
ErrorsCNN := 0
ErrorsMLP := 0
TimeCNN := 0
TimeMLP := 0
Num := 0
for J := 0 to |Classes| - 1 by 1
select_obj (Characters, Char, J + 1)
shape_trans (Char, RegionTrans, 'rectangle1')
dilation_rectangle1 (RegionTrans, RegionDilation, 5, 5)
reduce_domain (Image, RegionDilation, ImageRed...",44,177,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
read_ocr_class_mlp ('Industrial_NoRej', OCRHandleMLP)
read_ocr_class_c..."
73ece3df,full,0,"This example shows how OCR results can be improved by restricting the
allowed results using a regula...","dev_update_off ()
dev_close_window ()
read_image (Image, 'label/label_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
read_ocr_class_cnn ('Universal_NoRej', OCRHandle)
create_lexicon ...",9,86,
73ece3df,micro,1,"allowed results using a regular expression or a lexicon. Note, that the
classification results are a...","dev_update_off ()
dev_close_window ()
read_image (Image, 'label/label_01')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')",6,14,
73ece3df,micro,2,,"read_ocr_class_cnn ('Universal_NoRej', OCRHandle)",15,16,
73ece3df,micro,3,,"create_lexicon ('label', ['BEST', 'BEFORE', 'END'], LexiconHandle)
for I := 1 to 9 by 1
read_image (Image, 'label/label_0' + I)
threshold (Image, Region, 128, 230)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, LabelRaw, 'width', 'and', 350, 450)
shape_trans (LabelRaw, Label, ...",17,93,"* --- Automatically Added Context ---
read_image (Image, 'label/label_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_ocr_class_cnn ('Universal_NoRej', OCRHandle)
* --- End of A..."
ac0b3ab7,full,0,This example program shows how to use a simple CNN-based OCR classifier.,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle...",8,32,
ac0b3ab7,micro,1,,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,14,
ac0b3ab7,micro,2,,"read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle)",15,16,
ac0b3ab7,micro,3,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold1)
dilation_circle (Region, RegionDilation, 3.5)
connection (RegionDilation, ConnectedRegions)
intersection (ConnectedRegions, Region, RegionIntersection)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row'...",17,22,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
ac0b3ab7,micro,4,,"do_ocr_multi_class_cnn (Characters, Image, OCRHandle, Class, Confidence)",23,25,"* --- Automatically Added Context ---
read_image (Image, 'letters')
read_ocr_class_cnn ('Universal_Rej.occ', OCRHandle)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- E..."
ac0b3ab7,micro,5,,"area_center (Characters, Area, Row, Column)
dev_display (Image)
set_display_font (WindowHandle, 16, 'sans', 'true', 'false')
dev_disp_text (Class, 'image', Row - 16, Column + 8, 'orange red', 'box', 'false')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_disp_text ('Classification ...",26,38,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row..."
35675eb6,full,0,"Deep OCR detection training workflow:
This example demonstrates how to train the detection
component...","dev_close_window ()
dev_update_off ()
DatasetFilename := 'punched_numbers.hdict'
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
file_exists (OutputDir, FolderExists)
if (not FolderExists)
make_dir (OutputDir)
endif
RemoveOutputs := true
S...",16,666,
35675eb6,micro,1,HALCON Operator Reference -&gt; OCR -&gt; Deep OCR,"dev_close_window ()
dev_update_off ()",13,18,
35675eb6,micro,2,"The compatible dataset format is described in the
HALCON Operator Reference (OCR -&gt; Deep OCR).","DatasetFilename := 'punched_numbers.hdict'
parse_filename (DatasetFilename, BaseNameDataset, _, _)",21,26,
35675eb6,micro,3,"(e.g., preprocessed dataset and the trained model files).","OutputDir := 'ocr_detection_data_' + BaseNameDataset
file_exists (OutputDir, FolderExists)
if (not FolderExists)
make_dir (OutputDir)
endif",27,34,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
* --- End of Automatically Added Context ---"
35675eb6,micro,4,this program.,RemoveOutputs := true,35,38,
35675eb6,micro,5,,SkipTraining := false,39,41,
35675eb6,micro,6,"Note that the parameter values have a big impact on results,
runtime and memory usage. The optimal s...","ImageWidth := 512
ImageHeight := 384",42,48,
35675eb6,micro,7,"Note that if the batch size is increased, it is recommended to also
increase the number of epochs an...",BatchSize := 2,49,54,
35675eb6,micro,8,"Note that we choose a fairly low number of epochs here.
Please observe the training error and increa...",NumEpochs := 20,55,60,
35675eb6,micro,9,,UseAugmentation := true,61,63,
35675eb6,micro,10,undergo augmentation.,AugmentationRate := 75,64,67,
35675eb6,micro,11,,"BrightnessVariation := 20
BrightnessVariationSpot := 20
ContrastVariation := 0.2
SaturationVariation := 0.2
RotateRange := 15",68,74,
35675eb6,micro,12,Training supports CPU and GPU.,"DeviceRuntime := ['gpu', 'cpu']",75,78,
35675eb6,micro,13,These parameters determine the split percentages.,"SplitPercentageTrain := 80
SplitPercentageValidation := 10",79,83,
35675eb6,micro,14,"'auto':  It will be determined if the data has to be recomputed
'true':  Always preprocess the data
...",OverwritePreprocessing := 'auto',84,90,
35675eb6,micro,15,,"set_system ('seed_rand', 42)",91,93,
35675eb6,micro,16,,"OutputDirPreprocessing := OutputDir + '/dlsample_files'
BestModelFilename := OutputDir + '/model_' + BaseNameDataset + '_best.hdl'",94,97,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
* --- End of Automatically Added Context ---"
35675eb6,micro,17,,"BaselineModelFilename := 'pretrained_deep_ocr_detection.hdl'
read_dl_model (BaselineModelFilename, DLModelHandle)",98,101,
35675eb6,micro,18,,"set_dl_model_param (DLModelHandle, 'image_size', [ImageWidth,ImageHeight])",102,104,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 384
read_dl_model (BaselineModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
35675eb6,micro,19,,"query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",105,109,"* --- Automatically Added Context ---
DeviceRuntime := ['gpu', 'cpu']
* --- End of Automatically Added Context ---"
35675eb6,micro,20,,"DLDevice := DLDeviceHandles[0]
set_dl_model_param (DLModelHandle, 'device', DLDevice)",110,113,"* --- Automatically Added Context ---
read_dl_model (BaselineModelFilename, DLModelHandle)
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
* ---..."
35675eb6,micro,21,,"read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, InvalidSamplesIndices, InvalidSamplesReasons)",114,116,"* --- Automatically Added Context ---
DatasetFilename := 'punched_numbers.hdict'
* --- End of Automatically Added Context ---"
35675eb6,micro,22,,"dev_display_dl_invalid_samples (DLDataset, DLModelHandle, InvalidSamplesIndices, InvalidSamplesReasons)",117,119,"* --- Automatically Added Context ---
read_dl_model (BaselineModelFilename, DLModelHandle)
read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, InvalidSamplesIndices, InvalidSamplesReaso..."
35675eb6,micro,23,,"split_dl_dataset (DLDataset, SplitPercentageTrain, SplitPercentageValidation, [])",120,122,"* --- Automatically Added Context ---
SplitPercentageTrain := 80
SplitPercentageValidation := 10
read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, InvalidSamplesIndices, InvalidSample..."
35675eb6,micro,24,,"if (UseAugmentation)
GenParamPreprocessing := dict{augmentation: 'true'}
else
GenParamPreprocessing := dict{augmentation: 'false'}
endif
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], GenParamPreprocessing, DLPreprocessParam)",123,130,"* --- Automatically Added Context ---
UseAugmentation := true
read_dl_model (BaselineModelFilename, DLModelHandle)
* --- End of Automatically Added Context ---"
35675eb6,micro,25,,"WindowDict := dict{}
for Index := 0 to 4 by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
gen_dl_samples (DLDataset, SampleIndex, 'ocr_detection', [], DLSample)
preprocess_dl_samples (DLSample, DLPreprocessParam)
dev_display_dl_data (DLSample, [], DLDataset, 'ocr_detection_ground_truth...",131,142,"* --- Automatically Added Context ---
read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, InvalidSamplesIndices, InvalidSamplesReasons)
create_dl_preprocess_param_from_model (DLModelHan..."
35675eb6,micro,26,preprocessing parameters or the dataset have changed.,"preprocess_dl_dataset (DLDataset, OutputDirPreprocessing, DLPreprocessParam, dict{overwrite_files: OverwritePreprocessing}, DLDatasetFileName)",145,148,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
OverwritePreprocessing := 'auto'
OutputDirPreprocessi..."
35675eb6,micro,27,,"set_dl_model_param (DLModelHandle, 'batch_size', BatchSize)
if (not SkipTraining)
set_dl_model_param (DLModelHandle, 'learning_rate', 0.0001)
SerializationStrategy := dict{['type']: 'best'}
parse_filename (BestModelFilename, BaseName, Extension, Directory)
SerializationStrategy.basename := Directory...",149,188,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
SkipTraining := false
BatchSize := 2
NumEpochs := 20
..."
35675eb6,micro,28,,BatchSizeEval := BatchSize,191,193,"* --- Automatically Added Context ---
BatchSize := 2
* --- End of Automatically Added Context ---"
35675eb6,micro,29,"You could add the 'validation' split also for
additional insights.","EvaluationSplits := ['test', 'train']",205,209,
35675eb6,micro,30,"samples to be evaluated. If -1 is specified the full split
is evaluated.","EvaluationSplitsMaxNumSamples := [-1, 100]",210,214,
35675eb6,micro,31,,"read_dl_model (BaselineModelFilename, DLModelHandleBaseline)
read_dl_model (BestModelFilename, DLModelHandle)",215,218,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
BestModelFilename := OutputDir + '/model_' + BaseName..."
35675eb6,micro,32,,"EvalDict := dict{}
WindowHandles := []
WindowPos := 0",219,222,
35675eb6,micro,33,,"for I := 0 to |EvaluationSplits| - 1 by 1
EvaluationSplit := EvaluationSplits[I]
EvalResults := dict{}
EvalDict.[EvaluationSplits[I]] := EvalResults
if (|EvaluationSplitsMaxNumSamples| &gt; 1)
MaxNumSamples := EvaluationSplitsMaxNumSamples[I]
else
MaxNumSamples := EvaluationSplitsMaxNumSamples
endif...",223,252,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 384
BatchSize := 2
read_dl_model (BaselineModelFilename, DLModelHandle)
query_available_dl_devices (gen_tuple_const(|DeviceRuntim..."
35675eb6,micro,34,,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandleBaseline, 'batch_size', 1)
prepare_detailed_comparison_visualization (ImageWidth, ImageHeight, VisualizationDict)
find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
set_dl_model_param (DLMo...",255,283,"* --- Automatically Added Context ---
ImageWidth := 512
ImageHeight := 384
read_dl_model (BaselineModelFilename, DLModelHandle)
read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, Inval..."
35675eb6,micro,35,,"create_deep_ocr ([], [], DeepOcrHandle)",286,288,
35675eb6,micro,36,alphabet to 0-9.,"if (BaseNameDataset == 'punched_numbers')
Alphabet := [0:9] + ''
set_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', Alphabet)
endif",289,295,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
35675eb6,micro,37,component.,"set_deep_ocr_param (DeepOcrHandle, 'detection_model', BestModelFilename)",296,299,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
BestModelFilename := OutputDir + '/model_' + BaseName..."
35675eb6,micro,38,are set optimally for inference.,"set_deep_ocr_param (DeepOcrHandle, 'detection_batch_size', 1)
set_deep_ocr_param (DeepOcrHandle, 'detection_optimize_for_inference', 'true')
set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)",300,305,"* --- Automatically Added Context ---
query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
DLDevice := DLDeviceHandles[0]
create_deep_ocr ([], [], De..."
35675eb6,micro,39,directory. That way it can be easily read via read_deep_ocr.,"BestModelDeepOCRFilename := OutputDir + '/model_' + BaseNameDataset + '_best.hdo'
write_deep_ocr (DeepOcrHandle, BestModelDeepOCRFilename)
find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
tuple_shuffle (SampleIndices, SampleIndices)
WindowHandle := []
NumSamplesComparison...",306,329,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
read_dl_dataset_ocr_detection (DatasetFilename, [], [..."
35675eb6,micro,40,,"clean_up_output (OutputDir, RemoveOutputs)
set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandle, 'image_size', [ImageWidth,ImageHeight])
set_dl_model_param (DLModelHandle, 'device', DLDevice)
set_dl_model_param (DLModelHandle, 'optimize_for_inference', 'true')
set_dl...",330,371,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
RemoveOutputs := true
ImageWidth := 512
ImageHeight :..."
35675eb6,micro,41,,"GenParamEval := dict{show_progress: true}
NumSamples := |SampleIndices|
evaluate_dl_model (DLDataset, DLModelHandle, 'sample_indices', SampleIndices, GenParamEval, EvaluationResult, EvalParamsOrig)
EvaluationResult.num_samples_eval := NumSamples
EvaluationResult.num_samples_split := NumSamplesSplit
...",372,471,"* --- Automatically Added Context ---
read_dl_model (BaselineModelFilename, DLModelHandle)
read_dl_dataset_ocr_detection (DatasetFilename, [], [], DLDataset, InvalidSamplesIndices, InvalidSamplesReaso..."
35675eb6,micro,42,,"if (|ModelNames| != 2 or |EvaluationResults| != 2)
throw ('This procedure works only with 2 models.')
endif
WindowWidth := 470
WindowHeight := 512
PieColors := ['#008000', '#800000']
ContentStart := WindowHeight * 0.12
AvailableHeight := WindowHeight * 0.70
PieRadius := AvailableHeight * 0.12
dev_op...",472,590,"* --- Automatically Added Context ---
WindowHandle := []
find_dl_samples (DLDataset.samples, 'split', 'test', 'match', SampleIndices)
NumSamplesSplit := |SampleIndices|
NumSamples := |SampleIndices|
*..."
35675eb6,micro,43,,"if (not RemoveResults)
return ()
endif",591,595,
35675eb6,micro,44,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",596,604,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
WindowHandle := []
* --- End of Automatically Added Context ---"
35675eb6,micro,45,,"remove_dir_recursively (OutputDir)
return ()
WindowDictTop := dict{}
ImageSize := [ImageWidth,ImageHeight]
WindowSize := int(ImageSize * 0.9)
ScoreMapSize := int(WindowSize * 0.75)
dev_open_window (0, 0, WindowSize[0], WindowSize[1], 'black', WindowHandle)
dev_open_window (0, WindowSize[0] + 10, Sco...",605,697,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_detection_data_' + BaseNameDataset
ImageWidth := 512
ImageHeight := 384
DisplayParam := ..."
0deb4691,full,0,"This example shows how images can be prelabeled using Deep OCR.
The resulting DLDataset can be impor...","dev_update_off ()
dev_close_window ()
DisplayExampleInfo := true
UseWordCrops := false
SimpleFormat := false
DisplayResults := true
DisplaySize := 480
ImageDir := 'printer_chip'
if (UseWordCrops)
ImageDir := 'expiration_date'
endif
OutputDir := '.'
OutputName := OutputDir + '/dl_dataset_ocr.hdict'
f...",16,308,
0deb4691,micro,1,"The resulting DLDataset can be imported into the
Deep Learning Tool (DLT) for refining the labels.
A...","dev_update_off ()
dev_close_window ()",7,18,
0deb4691,micro,2,,DisplayExampleInfo := true,23,26,
0deb4691,micro,3,"required, set the variable UseWordCrops to true.
In this case, the resulting prelabeled dataset can ...",UseWordCrops := false,27,32,
0deb4691,micro,4,"exactly one single word. In this case the DLDataset can also be
written in a simpler format that doe...",SimpleFormat := false,33,38,
0deb4691,micro,5,,"DisplayResults := true
DisplaySize := 480",39,43,
0deb4691,micro,6,,"ImageDir := 'printer_chip'
if (UseWordCrops)
ImageDir := 'expiration_date'
endif",44,49,"* --- Automatically Added Context ---
UseWordCrops := false
* --- End of Automatically Added Context ---"
0deb4691,micro,7,,"OutputDir := '.'
OutputName := OutputDir + '/dl_dataset_ocr.hdict'
file_exists (OutputDir, OutputDirExists)
if (not OutputDirExists)
make_dir (OutputDir)
endif",50,58,
0deb4691,micro,8,"obtained by using an AI² device for inference (e.g. TensorRT/OpenVINO).
Note, however the initializa...",UseFastAI2Devices := 'false',59,63,
0deb4691,micro,9,,"get_inference_dl_device (UseFastAI2Devices, DLDevice)",64,66,"* --- Automatically Added Context ---
UseFastAI2Devices := 'false'
* --- End of Automatically Added Context ---"
0deb4691,micro,10,,"list_image_files (ImageDir, 'default', [], ImageFiles)
parse_filename (ImageFiles, BaseName, Extension, Directory)",71,74,"* --- Automatically Added Context ---
ImageDir := 'printer_chip'
* --- End of Automatically Added Context ---"
0deb4691,micro,11,,"Mode := 'auto'
if (UseWordCrops)
Mode := 'recognition'
endif
create_deep_ocr ('mode', Mode, DeepOcrHandle)",75,81,"* --- Automatically Added Context ---
UseWordCrops := false
* --- End of Automatically Added Context ---"
0deb4691,micro,12,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)",82,84,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ('mode', Mode, DeepOcrHandle)
* --- End of Automatically Added Context ---"
0deb4691,micro,13,,"if (DisplayExampleInfo)
dev_display_example_info_start ()
stop ()
dev_close_window ()
endif",85,91,"* --- Automatically Added Context ---
DisplayExampleInfo := true
* --- End of Automatically Added Context ---"
0deb4691,micro,14,,"if (DisplayResults)
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_window (WindowHandle)
endif",92,97,"* --- Automatically Added Context ---
DisplayResults := true
* --- End of Automatically Added Context ---"
0deb4691,micro,15,,"Samples := gen_tuple_const(|ImageFiles|,HNULL)",98,100,"* --- Automatically Added Context ---
list_image_files (ImageDir, 'default', [], ImageFiles)
* --- End of Automatically Added Context ---"
0deb4691,micro,16,,"DLDataset := dict{}
DLDataset.image_dir := ImageDir
if (not (UseWordCrops and SimpleFormat))
DLDataset.class_names := ['word', 'ignore']
DLDataset.class_ids := [0, 1]
endif",101,109,"* --- Automatically Added Context ---
UseWordCrops := false
SimpleFormat := false
ImageDir := 'printer_chip'
* --- End of Automatically Added Context ---"
0deb4691,micro,17,prelabeling.,"for Index := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[Index])
get_image_size (Image, Width, Height)
apply_deep_ocr (Image, DeepOcrHandle, Mode, DeepOcrResult)
Sample := dict{}
ImageFileName := BaseName[Index] + '.' + Extension[Index]
Sample.image_id := Index
Sample.image_file_name :=...",110,196,"* --- Automatically Added Context ---
UseWordCrops := false
SimpleFormat := false
DisplayResults := true
DisplaySize := 480
list_image_files (ImageDir, 'default', [], ImageFiles)
parse_filename (Image..."
0deb4691,micro,18,,DLDataset.samples := Samples,197,199,"* --- Automatically Added Context ---
list_image_files (ImageDir, 'default', [], ImageFiles)
Samples := gen_tuple_const(|ImageFiles|,HNULL)
DLDataset := dict{}
* --- End of Automatically Added Context..."
0deb4691,micro,19,,"write_dict (DLDataset, OutputName, [], [])",200,203,"* --- Automatically Added Context ---
OutputName := OutputDir + '/dl_dataset_ocr.hdict'
OutputDir := '.'
DLDataset := dict{}
* --- End of Automatically Added Context ---"
0deb4691,micro,20,,"if (DisplayExampleInfo)
dev_close_window ()
dev_inspect_ctrl (DLDataset)
dev_display_example_info_end (OutputName)
stop ()
dev_close_window ()
endif
dev_open_window (0, 0, 800, 300, 'black', WindowHandleInfo)
set_display_font (WindowHandleInfo, 16, 'mono', 'true', 'false')
Text := 'This example show...",204,273,"* --- Automatically Added Context ---
DisplayExampleInfo := true
OutputName := OutputDir + '/dl_dataset_ocr.hdict'
OutputDir := '.'
DLDataset := dict{}
dev_disp_text ('Press Run (F5) to continue', 'wi..."
0deb4691,micro,21,,"GenParamName := ['ai_accelerator_interface', 'runtime', 'ai_accelerator_interface', 'runtime']
GenParamValue := ['tensorrt', 'gpu', 'openvino', 'cpu']
if (UseFastAI2Devices == 'false')
AIIdx := find(GenParamName,'ai_accelerator_interface')
GenParamName := remove(GenParamName,AIIdx)
GenParamValue := ...",278,286,"* --- Automatically Added Context ---
UseFastAI2Devices := 'false'
* --- End of Automatically Added Context ---"
0deb4691,micro,22,,"DLDevices := []
for P := 0 to |GenParamName| - 1 by 1
query_available_dl_devices (GenParamName[P], GenParamValue[P], DLDeviceHandles)
DLDevices := [DLDevices,DLDeviceHandles]
if (DLDevices != [])
break
endif
endfor
if (DLDevices == [])
throw ('No supported deep learning device found')
endif
DLDevice...",287,300,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
GenParamName := ['ai_accelerator_interface', 'runtime', 'ai_accelerator_interface', 'runtime']
GenParamValue..."
0deb4691,micro,23,,"get_dl_device_param (DLDevice, 'ai_accelerator_interface', DLDeviceAI)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceAI == 'none' and DLDeviceType == 'cpu')
set_system ('thread_num', 4)
endif
return ()",301,344,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
* --- End of Automatically Added Context ---"
74a278fd,full,0,"Deep OCR recognition training workflow:
This example demonstrates how to train the recognition
part ...","dev_close_window ()
dev_update_off ()
DatasetFilename := 'expiration_date_full.hdict'
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
RemoveOutputs := false
SkipTraining := false
SkipStatistics := false
TrainForAlignment := false
if (Tra...",16,1014,
74a278fd,micro,1,HALCON Operator Reference -&gt; OCR -&gt; Deep OCR,"dev_close_window ()
dev_update_off ()",13,19,
74a278fd,micro,2,"The compatible dataset formats are described in the
HALCON Operator Reference (OCR -&gt; Deep OCR).",DatasetFilename := 'expiration_date_full.hdict',22,26,
74a278fd,micro,3,"(e.g., preprocessed dataset and the trained model files).","parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset",27,31,"* --- Automatically Added Context ---
DatasetFilename := 'expiration_date_full.hdict'
* --- End of Automatically Added Context ---"
74a278fd,micro,4,this program.,RemoveOutputs := false,32,35,
74a278fd,micro,5,,"SkipTraining := false
SkipStatistics := false",36,39,
74a278fd,micro,6,"model should be prepared for word alignment.
If TrainForAlignment is set to true, word boxes are str...",TrainForAlignment := false,40,50,
74a278fd,micro,7,"important parameter. It has to be increased if the dataset
contains samples with many characters.
Th...","if (TrainForAlignment)
ImageWidth := 'auto'
else
ImageWidth := 120
endif",51,72,"* --- Automatically Added Context ---
TrainForAlignment := false
* --- End of Automatically Added Context ---"
74a278fd,micro,8,"samples of the dataset using the procedure
find_invalid_samples_dl_ocr_recognition.
Also this estima...",PixelPerCharEstimate := 6.0,73,79,
74a278fd,micro,9,,BatchSizeTraining := 32,80,82,
74a278fd,micro,10,"Note, we choose a fairly low number of epochs here.
Please observe the training error and increase t...",NumEpochs := 10,83,88,
74a278fd,micro,11,,UseAugmentation := true,89,91,
74a278fd,micro,12,,ReduceAlphabetToDataset := true,92,94,
74a278fd,micro,13,Training is only supported on a GPU.,DeviceRuntime := 'gpu',95,98,
74a278fd,micro,14,These parameters determine the split percentages.,"SplitPercentageTrain := 80
SplitPercentageValidation := 10",99,103,
74a278fd,micro,15,"'auto':  It will be determined if the data has to be recomputed
'true':  Always preprocess the data
...",OverwritePreprocessing := 'auto',104,111,
74a278fd,micro,16,,"set_system ('seed_rand', 42)",112,114,
74a278fd,micro,17,,"OutputDirPreprocessing := OutputDir + '/dlsample_files'
BestModelFilename := OutputDir + '/model_' + BaseNameDataset + 'best.hdl'
file_exists (OutputDir, FileExists)
if (not FileExists)
make_dir (OutputDir)
endif",115,123,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
* --- End of Automatically Added Context ---"
74a278fd,micro,18,,"read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)",124,126,"* --- Automatically Added Context ---
DatasetFilename := 'expiration_date_full.hdict'
* --- End of Automatically Added Context ---"
74a278fd,micro,19,,"gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)",127,129,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
74a278fd,micro,20,,"read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)",130,132,
74a278fd,micro,21,,"if (ReduceAlphabetToDataset)
set_dl_model_param (DLModelHandle, 'alphabet', CharStats.charset)
endif",133,137,"* --- Automatically Added Context ---
ReduceAlphabetToDataset := true
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHand..."
74a278fd,micro,22,based on the dataset.,"if (ImageWidth == 'auto')
set_optimal_deep_ocr_recognition_image_width_for_alignment (DLModelHandle, DLDataset)
get_dl_model_param (DLModelHandle, 'image_width', ImageWidth)
else
set_dl_model_param (DLModelHandle, 'image_width', ImageWidth)
endif",138,146,"* --- Automatically Added Context ---
ImageWidth := 'auto'
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
* -..."
74a278fd,micro,23,,"InvalidGenericParam := dict{pixel_per_char_estimate: PixelPerCharEstimate, train_for_alignment: TrainForAlignment}
find_invalid_samples_dl_ocr_recognition (DLDataset.samples, DLModelHandle, InvalidGenericParam, InvalidSamplesIndices, InvalidSamplesReasons)",147,149,"* --- Automatically Added Context ---
TrainForAlignment := false
PixelPerCharEstimate := 6.0
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_re..."
74a278fd,micro,24,,"dev_display_dl_invalid_samples (DLDataset, DLModelHandle, InvalidSamplesIndices, InvalidSamplesReasons)",150,152,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
find_invalid_samples_dl_..."
74a278fd,micro,25,,"tuple_remove (DLDataset.samples, InvalidSamplesIndices, DLDataset.samples)
if (|InvalidSamplesIndices| &gt; 0)
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
endif",153,160,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
find_invalid_samples_dl_ocr_..."
74a278fd,micro,26,,"WindowDict := dict{}
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [], [], DLPreprocessParam)
for Index := 0 to 4 by 1
SampleIndex := round(rand(1) * (|DLDataset.samples| - 1))
gen_dl_samples (DLDataset, SampleIndex, 'ocr_recognition', dict{train_for_alignment: Tra...",161,194,"* --- Automatically Added Context ---
SkipStatistics := false
TrainForAlignment := false
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_recogn..."
74a278fd,micro,27,,"split_dl_dataset (DLDataset, SplitPercentageTrain, SplitPercentageValidation, [])",195,198,"* --- Automatically Added Context ---
SplitPercentageTrain := 80
SplitPercentageValidation := 10
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added C..."
74a278fd,micro,28,,"if (UseAugmentation)
GenParamPreprocessing := dict{augmentation: 'true'}
else
GenParamPreprocessing := dict{augmentation: 'false'}
endif
set_dict_tuple (GenParamPreprocessing, 'train_for_alignment', TrainForAlignment)
create_dl_preprocess_param_from_model (DLModelHandle, 'none', 'full_domain', [], [...",201,211,"* --- Automatically Added Context ---
TrainForAlignment := false
UseAugmentation := true
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
create_dl_preprocess_param_from_model (DLM..."
74a278fd,micro,29,preprocessing parameters or the dataset have changed.,"preprocess_dl_dataset (DLDataset, OutputDirPreprocessing, DLPreprocessParam, dict{overwrite_files: OverwritePreprocessing}, DLDatasetFileName)",212,216,"* --- Automatically Added Context ---
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OverwritePreprocessing := 'auto'
OutputDirPreproces..."
74a278fd,micro,30,,"query_available_dl_devices (gen_tuple_const(|DeviceRuntime|,'runtime'), DeviceRuntime, DLDeviceHandles)
if (|DLDeviceHandles| == 0)
throw ('No supported device found to continue this example.')
endif",217,222,"* --- Automatically Added Context ---
DeviceRuntime := 'gpu'
* --- End of Automatically Added Context ---"
74a278fd,micro,31,,"DLDevice := DLDeviceHandles[0]
set_dl_model_param (DLModelHandle, 'device', DLDevice)
if (not SkipTraining)
set_dl_model_param (DLModelHandle, 'batch_size', BatchSizeTraining)
set_dl_model_param (DLModelHandle, 'learning_rate', 3E-4)
find_dl_samples (DLDataset.samples, 'split', 'train', 'match', Sam...",223,290,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
SkipTraining := false
PixelPerCharEstimate := 6.0
B..."
74a278fd,micro,32,"finetuned model. By default we suggest the same image width as
used during training. It is possible ...",ImageWidthEvaluation := ImageWidth,293,298,"* --- Automatically Added Context ---
ImageWidth := 'auto'
* --- End of Automatically Added Context ---"
74a278fd,micro,33,,BatchSizeEval := BatchSizeTraining,299,301,"* --- Automatically Added Context ---
BatchSizeTraining := 32
* --- End of Automatically Added Context ---"
74a278fd,micro,34,,EvaluationSplit := 'test',302,304,
74a278fd,micro,35,,GenParamEval := dict{show_progress: true},305,307,
74a278fd,micro,36,,"read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandleBaseline)
evaluate_ocr_recognition (DLModelHandleBaseline, DLDevice, ImageWidthEvaluation, BatchSizeEval, DLDataset, EvaluationSplit, GenParamEval, EvaluationResultBaseline, AccuracyBaseline)",308,311,"* --- Automatically Added Context ---
ImageWidth := 'auto'
BatchSizeTraining := 32
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
query_available_dl_devices (gen_tuple_const(|Dev..."
74a278fd,micro,37,,"read_dl_model (BestModelFilename, DLModelHandle)
evaluate_ocr_recognition (DLModelHandle, DLDevice, ImageWidthEvaluation, BatchSizeEval, DLDataset, EvaluationSplit, GenParamEval, EvaluationResultFinetuning, AccuracyFinetuning)",312,316,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
ImageWidth := 'auto'
BatchSizeTraining := 32
BestMo..."
74a278fd,micro,38,samples will be processed.,"set_dl_model_param (DLModelHandle, 'batch_size', 1)
set_dl_model_param (DLModelHandleBaseline, 'batch_size', 1)
find_dl_samples (DLDataset.samples, 'split', EvaluationSplit, 'match', SampleIndices)
WindowDict1 := dict{}
WindowDict2 := dict{}
WindowHandleAccuracy := []
tuple_shuffle (SampleIndices, S...",319,357,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
dev_disp_text ('Press F5..."
74a278fd,micro,39,,"create_deep_ocr ('mode', 'recognition', DeepOcrHandle)",360,362,
74a278fd,micro,40,component.,"set_deep_ocr_param (DeepOcrHandle, 'recognition_model', BestModelFilename)",363,366,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
BestModelFilename := OutputDir + '/model_' + BaseNa..."
74a278fd,micro,41,are set optimally for inference.,"set_deep_ocr_param (DeepOcrHandle, 'recognition_batch_size', 1)
set_deep_ocr_param (DeepOcrHandle, 'recognition_optimize_for_inference', 'true')",367,371,"* --- Automatically Added Context ---
create_deep_ocr ('mode', 'recognition', DeepOcrHandle)
* --- End of Automatically Added Context ---"
74a278fd,micro,42,directory. That way it can be easily read via read_deep_ocr.,"BestModelDeepOCRFilename := OutputDir + '/model_' + BaseNameDataset + 'best.hdo'
write_deep_ocr (DeepOcrHandle, BestModelDeepOCRFilename)
dev_open_window (0, 0, 500, 200, 'black', WindowHandle)",372,379,"* --- Automatically Added Context ---
parse_filename (DatasetFilename, BaseNameDataset, _, _)
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
create_deep_ocr ('mode', 'recognition', DeepOcrHand..."
74a278fd,micro,43,,"list_image_files ('expiration_date', 'default', [], ImageFiles)
tuple_shuffle (ImageFiles, ImageFiles)
NumImages := 10
for I := 0 to min2(NumImages,|ImageFiles|) - 1 by 1
read_image (Image, ImageFiles[I])
apply_deep_ocr (Image, DeepOcrHandle, 'recognition', DeepOcrResult)
dev_display_deep_ocr_result...",380,393,"* --- Automatically Added Context ---
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
create_deep_ocr ('mode', 'recognition', DeepOcrHandle)
dev_open_window (0, 0,..."
74a278fd,micro,44,"pretrained alignment. The results between enabled and disabled
alignment are compared.","if (TrainForAlignment)
DisplaySize := 250
get_deep_ocr_param (DeepOcrHandle, 'recognition_image_size', RecognitionImageSize)
RecognitionImageWidth := RecognitionImageSize[0]
RecognitionImageHeight := RecognitionImageSize[1]
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowNoAlignment)...",396,448,"* --- Automatically Added Context ---
TrainForAlignment := false
create_deep_ocr ('mode', 'recognition', DeepOcrHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [],..."
74a278fd,micro,45,,"clean_up_output (OutputDir, RemoveOutputs)",449,463,"* --- Automatically Added Context ---
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
parse_filename (DatasetFilename, BaseNameDataset, _, _)
RemoveOutputs := false
* --- End of Automatically A..."
74a278fd,micro,46,,"if (not RemoveResults)
return ()
endif",464,468,
74a278fd,micro,47,,"dev_open_window (0, 0, 600, 300, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
WarningCleanup := ['Congratulations, you have finished the example.', '', 'Unless you would like to use the output data / model,', 'press F5 to clean up.']
dev_disp_text (WarningClean...",469,477,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 200, 'black', WindowHandle)
dev_disp_text ('Press F5 to continue', 'window', 'bottom', 'right', 'black', [], [])
* --- End of Automati..."
74a278fd,micro,48,,"remove_dir_recursively (OutputDir)
delete_file ('model_best.hdl')
delete_file ('model_best_info.hdict')
return ()",478,514,"* --- Automatically Added Context ---
OutputDir := 'ocr_recognition_data_' + BaseNameDataset
parse_filename (DatasetFilename, BaseNameDataset, _, _)
* --- End of Automatically Added Context ---"
74a278fd,micro,49,,"if (|ModelNames| != 2 or |Accuracies| != 2)
throw ('This procedure works only with 2 models.')
endif
WindowWidth := 512
WindowHeight := 320
dev_open_window (0, WindowColumn, WindowWidth, WindowHeight, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
Headline := 'Ac...",515,608,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 200, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
74a278fd,micro,50,,"Chars := gen_tuple_const(CharStats.charset_size,'')
Count := gen_tuple_const(CharStats.charset_size,0)
AverageRatio := gen_tuple_const(CharStats.charset_size,0)
for C := 0 to CharStats.charset_size - 1 by 1
Char := CharStats.charset[C]
Chars[C] := Char
Count[C] := CharStats.chars.[Char].count
Averag...",612,622,"* --- Automatically Added Context ---
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
get_dataset_characters_info (CharStats, Chars, Count, AverageRatio)
* --- End of Automatically Ad..."
74a278fd,micro,51,,"SortIdx := sort_index(Count)
Chars := Chars[SortIdx]
Count := Count[SortIdx]
AverageRatio := AverageRatio[SortIdx]
return ()",623,689,"* --- Automatically Added Context ---
get_dataset_characters_info (CharStats, Chars, Count, AverageRatio)
* --- End of Automatically Added Context ---"
74a278fd,micro,52,,"WindowHandles := []
if (AverageRatioThreshold &lt; 0.0)
throw ('The average ratio threshold must not be negative.')
endif
if (CharStats.charset_size &lt; 1)
throw ('There are no character statistics to display.')
endif",690,698,"* --- Automatically Added Context ---
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
dev_display_dl_dataset_ocr_recognition_statistics (CharStats, 0.1, WindowHandles, ThresholdUsed)
..."
74a278fd,micro,53,,UseThreshold := AverageRatioThreshold &gt; 0.0,699,701,"* --- Automatically Added Context ---
if (AverageRatioThreshold &lt; 0.0)
* --- End of Automatically Added Context ---"
74a278fd,micro,54,,"Chars := []
Counts := []
Ratios := []
NumChars := 0
for N := 1 to 2 by 1
for C := 0 to CharStats.charset_size - 1 by 1
Char := CharStats.charset[C]
Count := CharStats.chars.[Char].count
Ratio := CharStats.chars.[Char].average_ratio
if (not UseThreshold or Ratio &lt;= AverageRatioThreshold)
Chars := ...",702,733,"* --- Automatically Added Context ---
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
get_dataset_characters_info (CharStats, Chars, Count, AverageRatio)
Ratio := Accuracies[M] / 100
..."
74a278fd,micro,55,,"FontSize := 14
WindowWidth := 850
WindowHeight := 600
WindowInfoWidth := int(WindowWidth * 0.51)
dev_open_window (0, 0, WindowInfoWidth, WindowHeight, 'black', WindowHandleInfo)
set_display_font (WindowHandleInfo, FontSize, 'mono', 'true', 'false')
get_string_extents (WindowHandleInfo, sum(CharStats...",734,800,"* --- Automatically Added Context ---
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
dev_display_dl_dataset_ocr_recognition_statistics (CharStats, 0.1, WindowHandles, ThresholdUsed)
..."
74a278fd,micro,56,,"if (NumChars == 0)
return ()
endif
PieStartRow := 0
PieStartCol := 0
PieWindowWidth := WindowWidth - PieStartCol
PieWindowHeight := WindowHeight - PieStartRow
PieHWRatio := real(PieWindowHeight) / PieWindowWidth
NumPieCols := int(ceil(sqrt(NumChars / PieHWRatio)))
NumPieRows := int(ceil(real(NumChar...",801,835,"* --- Automatically Added Context ---
gen_dl_dataset_ocr_recognition_statistics (DLDataset, CharStats)
WindowWidth := 512
WindowHeight := 320
PieColors := ['#008000', '#800000']
PieParams := dict{}
Pi..."
74a278fd,micro,57,,"gen_empty_obj (SepLines)
for R := 1 to NumPieRows - 1 by 1
SepRow := PieRowFirst + (R - 0.5) * PieRowDelta
gen_contour_polygon_xld (SepLine, [SepRow,SepRow], [0,WindowWidth - 1])
concat_obj (SepLines, SepLine, SepLines)
endfor
for C := 1 to NumPieCols - 1 by 1
SepCol := PieColFirst + (C - 0.5) * Pie...",836,851,"* --- Automatically Added Context ---
WindowWidth := 512
WindowHeight := 320
PieRadius := WindowHeight / 6
for C := 0 to CharStats.charset_size - 1 by 1
NumChars := 0
NumPieCols := int(ceil(sqrt(NumCh..."
74a278fd,micro,58,,"for P := 0 to NumChars - 1 by 1
Count := Counts[P]
Ratio := min2(1,Ratios[P])
PieRatios := [Ratio,1 - Ratio]
PieParams.title := '\'' + Chars[P] + '\''
PieParams.footnote := '' + Count
PieRow := PieRowFirst + (P / NumPieCols) * PieRowDelta
PieCol := PieColFirst + (P % NumPieCols) * PieColDelta
dev_di...",852,977,"* --- Automatically Added Context ---
ImageWidth := 'auto'
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
dev..."
74a278fd,micro,59,"for an alignment-ready recognition model.
The width is determined from the samples of dataset.","get_dl_model_param (DLModelHandle, 'image_height', ImageHeight)",978,982,"* --- Automatically Added Context ---
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
* --- End of Automatically Added Context ---"
74a278fd,micro,60,,"get_dict_param (DLDataset, 'key_exists', 'samples', SamplesKeyExists)
if (not SamplesKeyExists)
throw ('Key samples is missing in the dataset.')
endif
Samples := DLDataset.samples
NumSamples := |Samples|",983,990,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
* --- End of Automatically Added Context ---"
74a278fd,micro,61,,"tuple_gen_const (|Samples|, -1, Length1s)
tuple_gen_const (|Samples|, -1, Length2s)
for S := 0 to NumSamples - 1 by 1
Sample := Samples[S]
get_dict_param (Sample, 'key_exists', 'bbox_length1', BoxKeyExists)
if (not BoxKeyExists)
throw ('Incorrect or missing word box in samples of the dataset.')
endi...",991,1008,"* --- Automatically Added Context ---
read_dl_dataset_ocr_recognition (DatasetFilename, [], [], DLDataset)
Samples := DLDataset.samples
NumSamples := |Samples|
* --- End of Automatically Added Context..."
74a278fd,micro,62,,"ImageWidth := int(ceil(max(Length1s / Length2s * ImageHeight)))
set_dl_model_param (DLModelHandle, 'image_width', ImageWidth)
return ()",1009,1056,"* --- Automatically Added Context ---
ImageWidth := 'auto'
read_dl_model ('pretrained_deep_ocr_recognition.hdl', DLModelHandle)
get_dl_model_param (DLModelHandle, 'image_height', ImageHeight)
tuple_ge..."
097a139c,full,0,"This example shows the usage of the Deep OCR:
- Part 1: Detection and recognition of the words withi...","dev_update_off ()
dev_close_window ()
ImagesDir := 'ocr/'
ImagesPath := ImagesDir + ['chars_training_05.png', 'chip_01.png', 'dot_print_02.png', 'dot_print_10.png', 'industrial_text_01.png', 'industrial_text_02.png', 'keys_01.png', 'street_sign_01.png', 'wafer_semi_font_10.png']
UseFastAI2Devices :=...",14,522,
097a139c,micro,1,"- Part 1: Detection and recognition of the words within an image.
- Part 2: Recognition of the words...","dev_update_off ()
dev_close_window ()",7,16,
097a139c,micro,2,,"ImagesDir := 'ocr/'
ImagesPath := ImagesDir + ['chars_training_05.png', 'chip_01.png', 'dot_print_02.png', 'dot_print_10.png', 'industrial_text_01.png', 'industrial_text_02.png', 'keys_01.png', 'street_sign_01.png', 'wafer_semi_font_10.png']",17,20,
097a139c,micro,3,"obtained by using an AI² device for inference (e.g. TensorRT/OpenVINO).
Note, however the initializa...",UseFastAI2Devices := 'false',21,25,
097a139c,micro,4,,"get_inference_dl_device (UseFastAI2Devices, DLDevice)",26,28,"* --- Automatically Added Context ---
UseFastAI2Devices := 'false'
* --- End of Automatically Added Context ---"
097a139c,micro,5,"Part 1: Detection and recognition of words within an image.
****************************************...","create_deep_ocr ([], [], DeepOcrHandle)",29,34,
097a139c,micro,6,,"get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', RecognitionAlphabet)",35,37,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,7,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)
DisplaySize := 480
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandleAlphabet)
display_recognition_alphabet (RecognitionAlphabet, WindowHandleAlphabet)
stop ()
dev_close_window ()",38,47,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ([], [], DeepOcrHandle)
get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', Recogniti..."
097a139c,micro,8,shown with a reduced size.,"PreprocessedDisplayWidth := 0.5 * DisplaySize
PreprocessedDisplayHeight := 0.5 * DisplaySize
ScoreMapsDisplayWidth := 2 * PreprocessedDisplayWidth
ScoreMapsDisplayHeight := PreprocessedDisplayHeight
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
dev_open_window (0, 10 + Disp...",48,58,"* --- Automatically Added Context ---
DisplaySize := 480
* --- End of Automatically Added Context ---"
097a139c,micro,9,,"for Index := 0 to |ImagesPath| - 1 by 1
read_image (Image, ImagesPath[Index])
get_image_size (Image, Width, Height)
dev_set_window (WindowHandle)
dev_set_window_extents (0, 0, DisplaySize, DisplaySize * Height / Width)
dev_display (Image)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
...",59,100,"* --- Automatically Added Context ---
ImagesPath := ImagesDir + ['chars_training_05.png', 'chip_01.png', 'dot_print_02.png', 'dot_print_10.png', 'industrial_text_01.png', 'industrial_text_02.png', 'ke..."
097a139c,micro,10,"Part 2: Recognition of the word only.
*************************************************************
...","create_deep_ocr ('mode', 'recognition', DeepOcrHandle)
set_deep_ocr_param (DeepOcrHandle, 'recognition_image_width', 150)",101,107,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,11,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)
dev_open_window (0, 0, 500, 100, 'black', WindowHandle)",108,112,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ([], [], DeepOcrHandle)
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHand..."
097a139c,micro,12,,"for Index := 1 to 11 by 1
read_image (Image, ImagesDir + 'cropped_text_image_' + Index$'.2d')
apply_deep_ocr (Image, DeepOcrHandle, 'recognition', DeepOcrResult)
dev_display_deep_ocr_results (Image, WindowHandle, DeepOcrResult, [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom',...",113,126,"* --- Automatically Added Context ---
ImagesDir := 'ocr/'
create_deep_ocr ([], [], DeepOcrHandle)
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
for Index := 0 to |ImagesPath|..."
097a139c,micro,13,"where the text is too clinched for recognition.
This can be handled by adapting recognition_image_wi...","read_image (Image, ImagesDir + 'medication_package_02_back.png')",127,134,"* --- Automatically Added Context ---
ImagesDir := 'ocr/'
read_image (Image, ImagesPath[Index])
* --- End of Automatically Added Context ---"
097a139c,micro,14,,"crop_rectangle1 (Image, ImageWord, 378, 176, 409, 605)",135,137,"* --- Automatically Added Context ---
read_image (Image, ImagesPath[Index])
* --- End of Automatically Added Context ---"
097a139c,micro,15,,"set_deep_ocr_param (DeepOcrHandle, 'recognition_image_width', 120)
apply_deep_ocr (ImageWord, DeepOcrHandle, 'recognition', DeepOcrResult)",138,141,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
crop_rectangle1 (Image, ImageWord, 378, 176, 409, 605)
* --- ..."
097a139c,micro,16,,"dev_display_deep_ocr_results (ImageWord, WindowHandle, DeepOcrResult, [], [])
dev_disp_text (['Original image.', 'The recognition result is wrong because', 'the width of the model is too small.'], 'window', 'bottom', 'right', 'black', [], [])
ImagePreprocessed := DeepOcrResult.image
change_format (I...",142,151,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', Deep..."
097a139c,micro,17,the depicted word is still recognizable in the preprocessed image.,"RecognitionImageWidth := 250
set_deep_ocr_param (DeepOcrHandle, 'recognition_image_width', RecognitionImageWidth)
apply_deep_ocr (ImageWord, DeepOcrHandle, 'recognition', DeepOcrResult)",152,157,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
crop_rectangle1 (Image, ImageWord, 378, 176, 409, 605)
get_de..."
097a139c,micro,18,,"ImagePreprocessed := DeepOcrResult.image
change_format (ImagePreprocessed, ImagePreprocessedPadded, 500, 32)
dev_open_window (390, 0, 500, 120, 'black', WindowHandlePreprocessed2)
dev_display_deep_ocr_results (ImagePreprocessedPadded, WindowHandlePreprocessed2, DeepOcrResult, [], [])
dev_disp_text (...",158,173,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
dev_disp_text ('Press Run (F5) to continue', 'window', 'botto..."
097a139c,micro,19,"Part 3: Recognition with alignment for words with background.
**************************************...","create_deep_ocr ('mode', 'recognition', DeepOcrHandle)",174,179,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,20,,"set_deep_ocr_param (DeepOcrHandle, 'recognition_alignment', 'true')",180,182,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,21,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)
DisplaySize := 500
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
dev_open_window (0, 10 + DisplaySize, 300, 100, 'black', WindowHandleAligned)",183,189,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ([], [], DeepOcrHandle)
DisplaySize := 480
dev_open_window (0, 0, DisplaySize, DisplaySize, ..."
097a139c,micro,22,,"for Index := 1 to 11 by 1
read_image (Image, ImagesDir + 'lot_number_' + Index$'.2d')
apply_deep_ocr (Image, DeepOcrHandle, 'recognition', DeepOcrResult)
dev_display_deep_ocr_results (Image, WindowHandle, DeepOcrResult, [], [])
dev_display_deep_ocr_alignment (WindowHandleAligned, DeepOcrResult, [], ...",190,209,"* --- Automatically Added Context ---
ImagesDir := 'ocr/'
create_deep_ocr ([], [], DeepOcrHandle)
for Index := 0 to |ImagesPath| - 1 by 1
read_image (Image, ImagesPath[Index])
apply_deep_ocr (Image, D..."
097a139c,micro,23,"Part 4: Detection of the words only.
*************************************************************
C...","create_deep_ocr ('mode', 'detection', DeepOcrHandle)",210,215,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,24,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)",216,218,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,25,,"for Index := 0 to 2 by 1
read_image (Image, ImagesPath[Index])
dev_open_window_fit_image (Image, 0, 0, 800, 600, WindowHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'detection', DeepOcrResult)
dev_display_deep_ocr_results (Image, WindowHandle, DeepOcrResult, [], [])
dev_disp_text ('Press Run (F5) to...",219,235,"* --- Automatically Added Context ---
ImagesPath := ImagesDir + ['chars_training_05.png', 'chip_01.png', 'dot_print_02.png', 'dot_print_10.png', 'industrial_text_01.png', 'industrial_text_02.png', 'ke..."
097a139c,micro,26,,DisplaySize := 1024,241,243,"* --- Automatically Added Context ---
DisplaySize := 480
* --- End of Automatically Added Context ---"
097a139c,micro,27,,"create_deep_ocr ('mode', 'auto', DeepOcrHandle)",244,246,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
* --- End of Automatically Added Context ---"
097a139c,micro,28,,"set_deep_ocr_param (DeepOcrHandle, 'device', DLDevice)
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
dev_open_window (0, 10 + DisplaySize, PreprocessedDisplayWidth, PreprocessedDisplayHeight, 'black', WindowPreprocessed)
dev_open_window (0, 20 + DisplaySize + PreprocessedDi...",247,253,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
create_deep_ocr ([], [], DeepOcrHandle)
DisplaySize := 480
PreprocessedDisplayWidth := 0.5 * DisplaySize
Pre..."
097a139c,micro,29,,"read_image (Image, ImagesDir + 'street_sign_02.jpg')
get_image_size (Image, Width, Height)
dev_set_window (WindowHandle)
dev_set_window_extents (0, 0, DisplaySize, DisplaySize * Height / Width)
dev_display (Image)",254,261,"* --- Automatically Added Context ---
ImagesDir := 'ocr/'
DisplaySize := 480
get_image_size (Image, Width, Height)
read_image (Image, ImagesPath[Index])
dev_open_window (0, 0, DisplaySize, DisplaySize..."
097a139c,micro,30,"Since the image is zoomed to the model size internally,
the text becomes very small in the preproces...","set_deep_ocr_param (DeepOcrHandle, 'detection_tiling', 'false')
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)",262,268,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
read_image (Image, ImagesPath[Index])
* --- End of Automatica..."
097a139c,micro,31,,"dev_display_deep_ocr_results (Image, WindowHandle, DeepOcrResult, [], [])
dev_disp_text ('Original image (' + Width + '×' + Height + ')', 'window', 'top', 'left', 'black', [], [])
dev_display_deep_ocr_results_preprocessed (WindowPreprocessed, DeepOcrResult, [], [])
dev_disp_text ('detection_tiling =...",269,277,"* --- Automatically Added Context ---
dev_disp_text ('Original image', 'window', 'top', 'left', 'black', [], [])
read_image (Image, ImagesPath[Index])
dev_disp_text ('Press Run (F5) to continue', 'win..."
097a139c,micro,32,"The image is split into overlapping tiles of size 'detection_image_size'.
Since the image is not zoo...","set_deep_ocr_param (DeepOcrHandle, 'detection_tiling', 'true')
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)",278,285,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
read_image (Image, ImagesPath[Index])
apply_deep_ocr (Image, DeepOcrHandle, 'auto', DeepOcrResult)
* --- End of Automatica..."
097a139c,micro,33,,"dev_display (Image)
display_tiles (WindowHandle)
dev_disp_text ('Original image (' + Width + '×' + Height + ')', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('detection_tiling = true', 'window', 'top', 'right', 'black', [], [])
dev_disp_text (['Internally, the image is automatically', 's...",286,294,"* --- Automatically Added Context ---
dev_disp_text ('Original image', 'window', 'top', 'left', 'black', [], [])
read_image (Image, ImagesPath[Index])
dev_open_window (0, 0, DisplaySize, DisplaySize, ..."
097a139c,micro,34,,"dev_set_window (WindowHandle)
dev_display_deep_ocr_results (Image, WindowHandle, DeepOcrResult, [], [])
dev_disp_text ('Original image (' + Width + '×' + Height + ')', 'window', 'top', 'left', 'black', [], [])
dev_disp_text ('detection_tiling = true', 'window', 'top', 'right', 'black', [], [])",295,300,"* --- Automatically Added Context ---
dev_disp_text ('Original image', 'window', 'top', 'left', 'black', [], [])
read_image (Image, ImagesPath[Index])
dev_open_window (0, 0, DisplaySize, DisplaySize, ..."
097a139c,micro,35,respective character and link score maps.,"dev_set_window (WindowPreprocessed)
dev_set_window_extents (-1, -1, PreprocessedDisplayWidth, PreprocessedDisplayHeight * Height / Width)
dev_display_deep_ocr_results_preprocessed (WindowPreprocessed, DeepOcrResult, [], [])
dev_set_window (WindowScoreMaps)
dev_set_window_extents (-1, -1, ScoreMapsDi...",301,332,"* --- Automatically Added Context ---
create_deep_ocr ([], [], DeepOcrHandle)
PreprocessedDisplayWidth := 0.5 * DisplaySize
PreprocessedDisplayHeight := 0.5 * DisplaySize
ScoreMapsDisplayWidth := 2 * ..."
097a139c,micro,36,,"Text := 'Characters the model can recognize:'
Text[|Text|] := ''",333,337,
097a139c,micro,37,1) 0-9,"Number := uniq(regexp_match(RecognitionAlphabet,'[0-9]'))
Number := remove(Number,find(Number,''))
Textline := ''
for i := 0 to |Number| - 1 by 1
Textline := Textline + Number[i] + ' '
endfor
Text[|Text|] := Textline",338,346,"* --- Automatically Added Context ---
get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', RecognitionAlphabet)
Text := 'Characters the model can recognize:'
* --- End of Automatically Added Con..."
097a139c,micro,38,,"Minor := uniq(regexp_match(RecognitionAlphabet,'[a-z]'))
Minor := remove(Minor,find(Minor,''))
Textline := ''
for i := 0 to |Minor| - 1 by 1
Textline := Textline + Minor[i] + ' '
endfor
Text[|Text|] := Textline",347,354,"* --- Automatically Added Context ---
get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', RecognitionAlphabet)
Text := 'Characters the model can recognize:'
Textline := ''
* --- End of Automati..."
097a139c,micro,39,,"Capital := uniq(regexp_match(RecognitionAlphabet,'[A-Z]'))
Capital := remove(Capital,find(Capital,''))
Textline := ''
for i := 0 to |Capital| - 1 by 1
Textline := Textline + Capital[i] + ' '
endfor
Text[|Text|] := Textline",355,362,"* --- Automatically Added Context ---
get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', RecognitionAlphabet)
Text := 'Characters the model can recognize:'
Textline := ''
* --- End of Automati..."
097a139c,micro,40,,"Special := difference(RecognitionAlphabet,[Minor,Capital,Number])
Special := remove(Special,find(Special,''))
for Line := 0 to |Special| - 1 by |Capital|
Textline := ''
for c := 0 to min2(|Capital| - 1,|Special| - 1 - Line) by 1
Char := Special[Line + c]
if (Char == '\n')
Textline := Textline + '\\n...",363,381,"* --- Automatically Added Context ---
get_deep_ocr_param (DeepOcrHandle, 'recognition_alphabet', RecognitionAlphabet)
Text := 'Characters the model can recognize:'
Number := uniq(regexp_match(Recognit..."
097a139c,micro,41,,"get_window_extents (WindowHandle, Row, Column, Width, Height)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
TextWidth := -1
TextHeight := -1
for Line := 0 to |Text| - 1 by 1
get_string_extents (WindowHandle, Text[Line], _, _, LineWidth, LineHeight)
TextWidth := max2(TextWidth,LineWidt...",382,395,"* --- Automatically Added Context ---
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
get_image_size (Image, Width, Height)
Text := 'Characters the model can recognize:'
for Li..."
097a139c,micro,42,,"dev_disp_text (Text, 'window', 'top', 'left', 'white', 'box', 'false')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', 'box', 'true')
return ()",396,432,"* --- Automatically Added Context ---
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
Text := 'Characters the model can recognize:'
* --- End of Automaticall..."
097a139c,micro,43,,"GenParamName := ['ai_accelerator_interface', 'runtime', 'ai_accelerator_interface', 'runtime']
GenParamValue := ['tensorrt', 'gpu', 'openvino', 'cpu']
if (UseFastAI2Devices == 'false')
AIIdx := find(GenParamName,'ai_accelerator_interface')
GenParamName := remove(GenParamName,AIIdx)
GenParamValue := ...",437,445,"* --- Automatically Added Context ---
UseFastAI2Devices := 'false'
* --- End of Automatically Added Context ---"
097a139c,micro,44,,"DLDevices := []
for P := 0 to |GenParamName| - 1 by 1
query_available_dl_devices (GenParamName[P], GenParamValue[P], DLDeviceHandles)
DLDevices := [DLDevices,DLDeviceHandles]
if (DLDevices != [])
break
endif
endfor
if (DLDevices == [])
throw ('No supported deep learning device found')
endif
DLDevice...",446,459,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
GenParamName := ['ai_accelerator_interface', 'runtime', 'ai_accelerator_interface', 'runtime']
GenParamValue..."
097a139c,micro,45,,"get_dl_device_param (DLDevice, 'ai_accelerator_interface', DLDeviceAI)
get_dl_device_param (DLDevice, 'type', DLDeviceType)
if (DLDeviceAI == 'none' and DLDeviceType == 'cpu')
set_system ('thread_num', 4)
endif
return ()",460,509,"* --- Automatically Added Context ---
get_inference_dl_device (UseFastAI2Devices, DLDevice)
* --- End of Automatically Added Context ---"
097a139c,micro,46,,"TileRow1 := [0, 0, 0, 0, 0, 904, 904, 904, 904, 904, 1808, 1808, 1808, 1808, 1808]
TileCol1 := [0, 808, 1616, 2424, 3232, 0, 808, 1616, 2424, 3232, 0, 808, 1616, 2424, 3232]
TileRow2 := [1023, 1023, 1023, 1023, 1023, 1927, 1927, 1927, 1927, 1927, 2831, 2831, 2831, 2831, 2831]
TileCol2 := [1023, 1831...",510,514,
097a139c,micro,47,,"gen_rectangle1 (Tiles, TileRow1, TileCol1, TileRow2, TileCol2)
dev_set_window (WindowHandle)
dev_set_draw ('margin')
dev_set_colored (12)
dev_display (Tiles)
return ()",515,538,"* --- Automatically Added Context ---
dev_open_window (0, 0, DisplaySize, DisplaySize, 'black', WindowHandle)
TileRow1 := [0, 0, 0, 0, 0, 904, 904, 904, 904, 904, 1808, 1808, 1808, 1808, 1808]
TileCol..."
b36fdff7,full,0,"This example program compares the recognition rate of OCR-SVMs with different
parameters on artifici...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('seed_rand', 42)
get_file_path_in_tmp_dir ('letters_autosvm.trf', TrainFile)
get_file_path_in_tmp_dir ('lette...",21,321,
b36fdff7,micro,1,"not considered in this example.
The estimation of the best parameter set may take a considerable amo...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
set_system ('seed_rand', 42)
get_file_path_in_tmp_dir ('letters_autosvm.trf', TrainFile)
get_file_path_in_tmp_dir ('lette...",15,29,
b36fdff7,micro,2,,"dev_clear_window ()
dev_set_part (0, 0, 499, 499)
Message := 'This example demonstrates the'
Message[1] := 'automatic parameter estimation and'
Message[2] := 'automatic feature selection for'
Message[3] := 'classifiers - in this case a SVM'
Message[4] := '(support vector machine) classifier'
Message...",30,66,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters_autosvm.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big_autosvm..."
b36fdff7,micro,3,,"disp_message (WindowHandle, ' ... adding distorted samples ... ready', 'window', 260, 12, 'white', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
dev_set_part (0, 0, 499, 499)
Message := 'Train SVM with default settings ...   '
disp_message (WindowHandle, ...",67,113,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters_big_autosvm.trf', TrainFileBig)
Message := 'This example demonstrates t..."
b36fdff7,micro,4,,"get_params_ocr_class_svm (OCRHandle, WidthCharacter, HeightCharacter, Interpolation, Features, CharactersT, KernelType, KernelParam, Nu, Mode, Preprocessing, NumComponents)
dev_clear_window ()
Message[2] := ' \nAutomatic parameter estimation ... ' + (S2 - S1)$'6.1f' + 's'
disp_message (WindowHandle,...",114,128,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
Message := 'This example demonstrates the'
count_seconds (S1)
count_seconds (S2)
select_feature_set_trainf..."
b36fdff7,micro,5,and determine the error rates,"NumDistort := 10
ErrorsSVMDef := 0
ErrorsSVMTuned := 0
ErrorsSVMAuto := 0
TimeSVMDef := 0
TimeSVMTun := 0
TimeSVMAut := 0
Num := 0
for J := 0 to NumChars - 1 by 1
select_obj (Characters, Char, J + 1)
Class := CharacterNames[J]
full_domain (Char, CharFull)
get_image_size (CharFull, Width, Height)
Num...",129,268,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters_autosvm.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big_autosvm..."
b36fdff7,micro,6,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",269,270,"* --- Automatically Added Context ---
threshold (CharDistort, Region, 0, 128)
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
b36fdff7,micro,7,,"dilation_circle (Region, RegionDilation, 3.5)",271,272,"* --- Automatically Added Context ---
threshold (CharDistort, Region, 0, 128)
* --- End of Automatically Added Context ---"
b36fdff7,micro,8,,"connection (RegionDilation, ConnectedRegions)",273,274,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
b36fdff7,micro,9,,"intersection (ConnectedRegions, Region, RegionIntersection)",275,276,"* --- Automatically Added Context ---
threshold (CharDistort, Region, 0, 128)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context ---"
b36fdff7,micro,10,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')",277,278,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharacterNames)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context ---"
b36fdff7,micro,11,,"count_obj (Characters, Number)
Classes := []
Sequence := [0:26 * 20 - 1]
Sequence := Sequence / 20
LetterColumn := chr(ord('a') + Sequence)
Classes := [LetterColumn,gen_tuple_const(20,'.')]",279,285,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharacterNames)
* --- End of Automatically Added Context ---"
b36fdff7,micro,12,,"write_ocr_trainf (Characters, Image, Classes, TrainFileName)
return ()
tuple_environment ('TEMP', PathToFile)
if (PathToFile == '')
tuple_environment ('TMP', PathToFile)
if (PathToFile == '')
file_exists ('/tmp', FileExists)
if (FileExists)
PathToFile := '/tmp'
else
PathToFile := './'
endif
endif
en...",286,317,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharacterNames)
read_image (Image, 'letters')
Classes := []
* --- End of Automatically Added Context ---"
b36fdff7,micro,13,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",318,330,"* --- Automatically Added Context ---
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
dcd4c30e,full,0,This example program shows how to use a simple k-NN OCR classifier,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",8,102,
dcd4c30e,micro,1,,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",6,18,
dcd4c30e,micro,2,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",19,20,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
dcd4c30e,micro,3,,"dilation_circle (Region, RegionDilation, 3.5)",21,22,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
dcd4c30e,micro,4,,"connection (RegionDilation, ConnectedRegions)",23,24,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
dcd4c30e,micro,5,,"intersection (ConnectedRegions, Region, RegionIntersection)",25,26,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
dcd4c30e,micro,6,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
dev_display (Characters)
disp_message (WindowHandle, 'Training characters', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",27,32,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context..."
dcd4c30e,micro,7,,"count_obj (Characters, Number)
Length := Number / 27
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(Length,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(Length,'.')]",33,40,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
dcd4c30e,micro,8,,"write_ocr_trainf (Characters, Image, Classes, TrainFile)",41,42,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
Classes..."
dcd4c30e,micro,9,"Therefore, the training part of the program is generic and can be used
to train any OCR classifier","read_ocr_trainf_names (TrainFile, CharacterNames, CharacterCount)
create_ocr_class_knn (8, 10, 'constant', 'default', CharacterNames, [], [], OCRHandle)",43,47,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
* --- End of Automatically Added Context ---"
dcd4c30e,micro,10,,"trainf_ocr_class_knn (OCRHandle, TrainFile, [], [])",48,50,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
create_ocr_class_knn (8, 10, 'constant', 'default', CharacterNames, [], [], OCRHandle)
* --- End of Automatica..."
dcd4c30e,micro,11,,"full_domain (Image, Image)",51,52,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
dcd4c30e,micro,12,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold1)
dilation_circle (Region, RegionDilation, 3.5)
connection (RegionDilation, ConnectedRegions)
intersection (ConnectedRegions, Region, RegionIntersection)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row'...",53,58,"* --- Automatically Added Context ---
read_image (Image, 'letters')
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
dilation_circle (Region, RegionDilation, 3.5)
connection..."
dcd4c30e,micro,13,,"do_ocr_multi_class_knn (Characters, Image, OCRHandle, Class, Confidence)",59,61,"* --- Automatically Added Context ---
read_image (Image, 'letters')
create_ocr_class_knn (8, 10, 'constant', 'default', CharacterNames, [], [], OCRHandle)
sort_region (RegionIntersection, Characters, ..."
dcd4c30e,micro,14,,"area_center (Characters, Area, Row, Column)
dev_display (Image)
set_display_font (WindowHandle, 16, 'sans', 'true', 'false')
disp_message (WindowHandle, Class, 'image', Row - 16, Column + 8, 'blue', 'false')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Cl...",62,98,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (Regio..."
dcd4c30e,micro,15,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",99,111,"* --- Automatically Added Context ---
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
07d05ab4,full,0,"This program demonstrates the usage of lexica on their own. However, they are mainly
intended to be ...","create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
lookup_lexicon (Months, 'may', Found)
lookup_lexicon (Months, 'nay', Found)
lookup_lexicon (Months, 'May', Found)
suggest_lexicon (Months, 'na...",8,22,
07d05ab4,micro,1,intended to be used in combination with do_ocr_word_mlp or do_ocr_word_svm.,"create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)",6,8,
07d05ab4,micro,2,,"lookup_lexicon (Months, 'may', Found)",9,10,"* --- Automatically Added Context ---
create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
* --..."
07d05ab4,micro,3,,"lookup_lexicon (Months, 'nay', Found)",11,12,"* --- Automatically Added Context ---
create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
look..."
07d05ab4,micro,4,,"lookup_lexicon (Months, 'May', Found)",13,14,"* --- Automatically Added Context ---
create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
look..."
07d05ab4,micro,5,,"suggest_lexicon (Months, 'nay', Suggestion, NumCorrections)
suggest_lexicon (Months, 'mya', Suggestion, NumCorrections)
suggest_lexicon (Months, 'nya', Suggestion, NumCorrections)
suggest_lexicon (Months, 'jyna', Suggestion, NumCorrections)",15,19,"* --- Automatically Added Context ---
create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
* --..."
07d05ab4,micro,6,the lexicon has been imported from a text file using import_lexicon,"inspect_lexicon (Months, Words)",20,28,"* --- Automatically Added Context ---
create_lexicon ('months', ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'], Months)
* --..."
bc1f1d5e,full,0,"This example shows how OCR results can be improved by restricting the
allowed results using a regula...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
read_image (Image, 'label/label_01.png')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')
read_ocr...",9,91,
bc1f1d5e,micro,1,"allowed results using a regular expression or a lexicon. Note, that the
classification results are a...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_close_window ()
read_image (Image, 'label/label_01.png')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 20, 'mono', 'true', 'false')",6,16,
bc1f1d5e,micro,2,,"read_ocr_class_mlp ('Industrial_NoRej', OCRHandle)",17,18,
bc1f1d5e,micro,3,,"create_lexicon ('label', ['BEST', 'BEFORE', 'END'], LexiconHandle)
for i := 1 to 9 by 1
read_image (Image, 'label/label_0' + i + '.png')
threshold (Image, Region, 128, 230)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, LabelRaw, 'width', 'and', 350, 450)
opening_circle (Label...",19,97,"* --- Automatically Added Context ---
read_image (Image, 'label/label_01.png')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_ocr_class_mlp ('Industrial_NoRej', OCRHandle)
* --- End..."
68b458ed,full,0,This example program shows how to use a simple MLP OCR classifier,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",8,102,
68b458ed,micro,1,,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",6,18,
68b458ed,micro,2,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",19,20,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
68b458ed,micro,3,,"dilation_circle (Region, RegionDilation, 3.5)",21,22,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
68b458ed,micro,4,,"connection (RegionDilation, ConnectedRegions)",23,24,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
68b458ed,micro,5,,"intersection (ConnectedRegions, Region, RegionIntersection)",25,26,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
68b458ed,micro,6,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
dev_display (Characters)
disp_message (WindowHandle, 'Training characters', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",27,32,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context..."
68b458ed,micro,7,,"count_obj (Characters, Number)
Length := Number / 27
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(Length,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(Length,'.')]",33,40,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
68b458ed,micro,8,,"write_ocr_trainf (Characters, Image, Classes, TrainFile)",41,42,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
Classes..."
68b458ed,micro,9,"Therefore, the training part of the program is generic and can be
used to train any OCR classifier.","read_ocr_trainf_names (TrainFile, CharacterNames, CharacterCount)
create_ocr_class_mlp (8, 10, 'constant', 'default', CharacterNames, 20, 'normalization', 26, 42, OCRHandle)",43,47,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
* --- End of Automatically Added Context ---"
68b458ed,micro,10,,"trainf_ocr_class_mlp (OCRHandle, TrainFile, 100, 0.01, 0.01, Error, ErrorLog)",48,50,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
create_ocr_class_mlp (8, 10, 'constant', 'default', CharacterNames, 20, 'normalization', 26, 42, OCRHandle)
* ..."
68b458ed,micro,11,,"full_domain (Image, Image)",51,52,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
68b458ed,micro,12,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold1)
dilation_circle (Region, RegionDilation, 3.5)
connection (RegionDilation, ConnectedRegions)
intersection (ConnectedRegions, Region, RegionIntersection)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row'...",53,58,"* --- Automatically Added Context ---
read_image (Image, 'letters')
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
dilation_circle (Region, RegionDilation, 3.5)
connection..."
68b458ed,micro,13,,"do_ocr_multi_class_mlp (Characters, Image, OCRHandle, Class, Confidence)",59,61,"* --- Automatically Added Context ---
read_image (Image, 'letters')
create_ocr_class_mlp (8, 10, 'constant', 'default', CharacterNames, 20, 'normalization', 26, 42, OCRHandle)
sort_region (RegionInter..."
68b458ed,micro,14,,"area_center (Characters, Area, Row, Column)
dev_display (Image)
set_display_font (WindowHandle, 16, 'sans', 'true', 'false')
disp_message (WindowHandle, Class, 'image', Row - 16, Column + 8, 'blue', 'false')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Cl...",62,98,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (Regio..."
68b458ed,micro,15,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",99,111,"* --- Automatically Added Context ---
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
92dff6fb,full,0,"This program shows the benefits of regularizing an MLP and of the
automatic determination of the reg...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_clear_window ()
Message := 'This program shows the benefits of'
Message[1] := 'regularizing an MLP and of the automat...",27,409,
92dff6fb,micro,1,"automatic determination of the regularization parameters. It creates two
MLPs with too many hidden u...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_clear_window ()
Message := 'This program shows the benefits of'
Message[1] := 'regularizing an MLP and of the automat...",6,60,
92dff6fb,micro,2,,"dev_clear_window ()
disp_message (WindowHandle, 'Creating initial samples... ', 'window', 12, 12, 'white', 'false')
gen_initial_trainfile (TrainFile)",61,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
* --- End of Automatically Added Context ---"
92dff6fb,micro,3,,"disp_message (WindowHandle, 'Creating modified samples... ', 'window', 42, 12, 'white', 'false')
read_ocr_trainf_names (TrainFile, CharClasses, CharCount)
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
dev_set_check ('~give_error')
delete_file (TrainFileBig)
dev_set_check ('give_error')
...",65,98,"* --- Automatically Added Context ---
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFile..."
92dff6fb,micro,4,,"dev_clear_window ()
disp_message (WindowHandle, 'Training MLP... ', 'window', 12, 12, 'white', 'false')
create_ocr_class_mlp (8, 10, 'constant', 'pixel_invar', CharClasses, 30, 'none', 10, 42, OCRHandleMLP)
count_seconds (S1)
trainf_ocr_class_mlp (OCRHandleMLP, TrainFileBig, 200, 1, 0.01, Error, Err...",99,111,"* --- Automatically Added Context ---
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
Message[1] := 'regularizing an MLP and of the automatic'
get_file_path_in_tmp_dir ('letters_big.trf', Trai..."
92dff6fb,micro,5,,"trainf_ocr_class_mlp (OCRHandleMLPReg, TrainFileBig, 200, 1, 0.01, Error, ErrorLog)",112,113,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters_big.trf', TrainFileBig)
trainf_ocr_class_mlp (OCRHandleMLP, TrainFileBig, 200, 1, 0.01, Error, ErrorLog)
create_ocr_class_mlp (..."
92dff6fb,micro,6,,"get_regularization_params_ocr_class_mlp (OCRHandleMLPReg, 'weight_prior', WeightPrior)
count_seconds (S2)
disp_message (WindowHandle, 'Training regularized MLP... ' + (S2 - S1)$'5.2f' + 's', 'window', 50, 12, 'green', 'false')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_w...",114,147,"* --- Automatically Added Context ---
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
Message := 'This program shows the benefits of'
Message[1] := 'regularizing an MLP and of the automatic'
M..."
92dff6fb,micro,7,error rates.,"NumDistort := 10
ErrorsMLP := 0
ErrorsMLPR := 0
for J := 0 to NumChars - 1 by 1
select_obj (Characters, Char, J + 1)
Class := CharClassesSingle[J]
full_domain (Char, CharFull)
get_image_size (CharFull, Width, Height)
Num := max([J * NumDistort,1])
gen_empty_obj (Chars)
for K := 1 to NumDistort by 1
...",148,356,"* --- Automatically Added Context ---
dev_open_window (0, 0, 570, 600, 'black', WindowHandle)
Message[1] := 'regularizing an MLP and of the automatic'
get_file_path_in_tmp_dir ('letters.trf', TrainFil..."
92dff6fb,micro,8,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",357,358,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
92dff6fb,micro,9,,"dilation_circle (Region, RegionDilation, 3.5)",359,360,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
92dff6fb,micro,10,,"connection (RegionDilation, ConnectedRegions)",361,362,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
92dff6fb,micro,11,,"intersection (ConnectedRegions, Region, RegionIntersection)",363,364,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
92dff6fb,micro,12,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')",365,366,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context --..."
92dff6fb,micro,13,,"count_obj (Characters, Number)
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(20,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(20,'.')]",367,373,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
for J := 0 to NumChars - 1 by 1
* --- End of Automatically Added Context ---"
92dff6fb,micro,14,,"write_ocr_trainf (Characters, Image, Classes, TrainFileName)
return ()
tuple_environment ('TEMP', PathToFile)
if (PathToFile == '')
tuple_environment ('TMP', PathToFile)
if (PathToFile == '')
file_exists ('/tmp', FileExists)
if (FileExists)
PathToFile := '/tmp'
else
PathToFile := './'
endif
endif
en...",374,405,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
read_image (Image, 'letters')
Classes := []
* --- End of Automatically Added Context ---"
92dff6fb,micro,15,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",406,418,"* --- Automatically Added Context ---
append_ocr_trainf (CharacterExpanded, CharacterExpanded, Class, FileName)
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
e26aaa57,full,0,"This example shows how find_text can be used to find and read
text. Furthermore, the most important ...","dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
read_ocr_class_mlp ('Industrial_Rej', OCRHandle)
disp_message (WindowHandle, 'This example shows how find_text can be used to \nfind an...",9,113,
e26aaa57,micro,1,"text. Furthermore, the most important parameters are explained","dev_update_off ()
dev_close_window ()",6,10,
e26aaa57,micro,2,,"dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",11,14,
e26aaa57,micro,3,,"read_ocr_class_mlp ('Industrial_Rej', OCRHandle)",15,17,
e26aaa57,micro,4,,"disp_message (WindowHandle, 'This example shows how find_text can be used to \nfind and read text. Furthermore, the most \nimportant parameters are explained.', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_clear_window ()
disp_message (WindowHa...",18,27,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
* --- End of Automatically Added Context ---"
e26aaa57,micro,5,,"create_text_model_reader ('auto', OCRHandle, TextModel)
read_image (Image, 'ocr/medication_package_02_right')",28,32,"* --- Automatically Added Context ---
read_ocr_class_mlp ('Industrial_Rej', OCRHandle)
* --- End of Automatically Added Context ---"
e26aaa57,micro,6,text within the input image,"find_text (Image, TextModel, TextResult)",33,36,"* --- Automatically Added Context ---
create_text_model_reader ('auto', OCRHandle, TextModel)
read_image (Image, 'ocr/medication_package_02_right')
* --- End of Automatically Added Context ---"
e26aaa57,micro,7,,"get_text_object (TextLines, TextResult, 'all_lines')
dev_set_colored (12)
dev_display (Image)
dev_display (TextLines)
disp_message (WindowHandle, 'Find_text extracts all text within the input image,\nregardless of the character size. \nPer default, light and dark text is extracted.', 'window', 12, 1...",37,46,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
read_image (Image, 'ocr/medication_package_02_right')
find_text (Image, TextModel, TextResult)
*..."
e26aaa57,micro,8,using the set_text_model_param operator,"set_text_model_param (TextModel, 'polarity', 'dark_on_light')
find_text (Image, TextModel, TextResult)
get_text_object (TextLines, TextResult, 'all_lines')
dev_set_colored (12)
dev_display (Image)
dev_display (TextLines)
disp_message (WindowHandle, 'It is possible to restrict the text segmentation \...",47,60,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
create_text_model_reader ('auto', OCRHandle, TextModel)
read_image (Image, 'ocr/medication_packa..."
e26aaa57,micro,9,"such as the character height, width or stroke width","set_text_model_param (TextModel, 'polarity', 'dark_on_light')
set_text_model_param (TextModel, 'min_char_height', 20)
find_text (Image, TextModel, TextResult)
get_text_object (TextLines, TextResult, 'all_lines')
dev_set_colored (12)
dev_display (Image)
dev_display (TextLines)
disp_message (WindowHan...",61,76,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
disp_message (WindowHandle, 'This example shows how find_text can be used to \nfind and read tex..."
e26aaa57,micro,10,set the corresponding structure with set_text_model_param,"set_text_model_param (TextModel, 'polarity', 'dark_on_light')
set_text_model_param (TextModel, 'min_char_height', 20)",77,80,"* --- Automatically Added Context ---
create_text_model_reader ('auto', OCRHandle, TextModel)
* --- End of Automatically Added Context ---"
e26aaa57,micro,11,"need to be valid characters within the used classifier. Otherwise
they are ignored.","set_text_model_param (TextModel, 'text_line_separators', '/')
set_text_model_param (TextModel, 'text_line_structure', '2 4')
find_text (Image, TextModel, TextResult)
get_text_object (TextLines, TextResult, 'all_lines')
dev_set_colored (12)
dev_display (Image)
dev_display (TextLines)
disp_message (Wi...",81,96,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
create_text_model_reader ('auto', OCRHandle, TextModel)
read_image (Image, 'ocr/medication_packa..."
e26aaa57,micro,12,each of the segmented characters with the get_text_result operator,"dev_set_colored (12)
dev_display (Image)
dev_display (TextLines)",97,103,"* --- Automatically Added Context ---
read_image (Image, 'ocr/medication_package_02_right')
get_text_object (TextLines, TextResult, 'all_lines')
* --- End of Automatically Added Context ---"
e26aaa57,micro,13,,"smallest_rectangle1 (TextLines, Row1, Column1, Row2, Column2)
get_text_result (TextResult, 'class', SingleCharacters)
tuple_sum (SingleCharacters, TextLineCharacters)
dev_set_color ('dark green')
for CharacterIndex := 0 to |SingleCharacters| - 1 by 1
set_tposition (WindowHandle, Row2[CharacterIndex]...",104,119,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 960, 768, 700, 700, WindowHandle)
disp_message (WindowHandle, 'It is possible to restrict the text segmentation \naccording to the..."
e49e0cf2,full,0,"This example uses the Automatic Text Reader to read
dot print characters in different images.
It als...","dev_update_off ()
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_window (WindowHandle)
Message := 'This example shows how to read dot print characters'
Message[1] := 'with the Automatic Text Reader.'
Message[2] := ' '
Mess...",12,326,
e49e0cf2,micro,1,the default parameters do not lead to the desired result.,"dev_update_off ()
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",9,15,
e49e0cf2,micro,2,,"dev_set_window (WindowHandle)
Message := 'This example shows how to read dot print characters'
Message[1] := 'with the Automatic Text Reader.'
Message[2] := ' '
Message[3] := 'The first example images can be read with default settings.'
Message[4] := ' '
Message[5] := 'After that, the example shows ...",16,28,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
e49e0cf2,micro,3,,"create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)",29,30,
e49e0cf2,micro,4,,"set_text_model_param (TextModel, 'dot_print', 'true')",31,33,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
* --- End of Automatically Added Context ---"
e49e0cf2,micro,5,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_01')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 1, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",38,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
create_text_mod..."
e49e0cf2,micro,6,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_02')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 2, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",46,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
dev_disp_text ('Press Run (F5) to continu..."
e49e0cf2,micro,7,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_03')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 3, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",54,61,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,8,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_04')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 4, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",62,69,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,9,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_05')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 5, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",70,77,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,10,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_06')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 6, Class)
Message := 'In general, it might happen that not only dot print but arbitra...",82,96,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,11,,"TextModelParamName := ['dot_print', 'min_char_height']
TextModelParamValue := ['true', 25]
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 6, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], ...",97,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,12,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_07')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 7, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', '...",104,111,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,13,,"TextModelParamName := ['dot_print', 'min_contrast']
TextModelParamValue := ['true', 40]
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 7, Class)
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])...",112,118,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,14,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_08')
dev_display (Image)
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 8, Class)
Message := 'If find_text fails to connect all dots and ...",123,137,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,15,,"dev_set_part (235, 307, 295, 387)
dev_display (Image)
dev_display (Characters)
Message := 'Measure the size of the maximal gap between dots within'
Message[1] := 'a character.'
dev_disp_text (Message, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom',...",138,164,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,16,,"TextModelParamName := ['dot_print', 'min_char_height', 'max_char_height', 'polarity']
TextModelParamValue := ['true', 15, 50, 'light_on_dark']
read_image (Image, 'ocr/dot_print_09')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 9, Cla...",165,177,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,17,,"TextModelParamName := ['dot_print', 'min_char_height', 'max_char_height', 'polarity', 'dot_print_tight_char_spacing']
TextModelParamValue := ['true', 15, 50, 'light_on_dark', 'true']
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 9, Cl...",178,184,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,18,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_10')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 10, Class)
Message := 'If neighboring characters are merged erroneously,'
Message[1] ...",185,196,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,19,,"TextModelParamName := ['dot_print', 'dot_print_tight_char_spacing']
TextModelParamValue := ['true', 'true']
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 10, Class)
Message := 'If \'dot_print_tight_char_spacing\' does not yield the de...",197,207,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,20,,"dev_set_part (166, 463, 225, 544)
dev_display (Image)
dev_display (Characters)
MessageImage11Measure[0] := 'Measure the size of the minimal gap between adjacent'
MessageImage11Measure[1] := 'characters.'
dev_disp_text (MessageImage11Measure, 'window', 12, 12, 'black', [], [])
dev_disp_text ('Press R...",208,231,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,21,,"TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
read_image (Image, 'ocr/dot_print_11')
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 11, Class)
Message := 'If find_text fails to connect all dots and characters are spli...",232,244,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,22,,"TextModelParamName := ['dot_print', 'dot_print_max_dot_gap']
TextModelParamValue := ['true', 5]
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 11, Class)
Message := 'If the value of \'dot_print_max_dot_gap\' exceeds the size of the min...",245,255,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
Message := 'This example shows how to read dot print characters'
create_text_model_reader ('auto', 'DotPri..."
e49e0cf2,micro,23,,"TextModelParamName := ['dot_print', 'dot_print_max_dot_gap', 'dot_print_min_char_gap']
TextModelParamValue := ['true', 5, 4]
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 11, Class)",256,284,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
fi..."
e49e0cf2,micro,24,,"get_text_model_param (TextModel, TextModelParamName, TextModelParamValueReset)",285,287,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
TextModelParamName := 'dot_print'
* --- End of Automatically Added Context ---"
e49e0cf2,micro,25,,"set_text_model_param (TextModel, TextModelParamName, TextModelParamValue)",288,290,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
TextModelParamName := 'dot_print'
TextModelParamValue := 'true'
* --- End of Automatically Added ..."
e49e0cf2,micro,26,,"find_text (Image, TextModel, TextResultID)
get_text_object (Characters, TextResultID, 'all_lines')
get_text_result (TextResultID, 'num_lines', NumLines)",291,295,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
read_image (Image, 'ocr/dot_print_01')
find_text_and_disp_result (Image, Characters, TextModel, T..."
e49e0cf2,micro,27,,"dev_set_window (WindowHandle)
dev_display (Image)
dev_display (Characters)
disp_message (WindowHandle, 'Image ' + ImageIndex, 'window', 12, 12, 'black', 'true')",296,301,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 600, 'white', WindowHandle)
read_image (Image, 'ocr/dot_print_01')
find_text_and_disp_result (Image, Characters, TextModel, TextModelP..."
e49e0cf2,micro,28,Display classification result for each character.,"get_text_result (TextResultID, 'class', Class)
smallest_rectangle1 (Characters, Row1, Column1, Row2, Column2)
dev_disp_text (Class, 'image', Row2 - 1, Column1 - 1, 'black', 'box', 'false')
dev_disp_text (Class, 'image', Row2 + 1, Column1 + 1, 'black', 'box', 'false')
dev_disp_text (Class, 'image', R...",302,311,"* --- Automatically Added Context ---
find_text_and_disp_result (Image, Characters, TextModel, TextModelParamName, TextModelParamValue, WindowHandle, 1, Class)
find_text (Image, TextModel, TextResultI..."
e49e0cf2,micro,29,,"Message := 'Used Automatic Text Reader parameters:'
Message := [Message,' - ' + TextModelParamName + ' = ' + TextModelParamValue]
tuple_gen_const (|Message|, 'black', Color)",312,315,"* --- Automatically Added Context ---
Message := 'This example shows how to read dot print characters'
Message[1] := 'with the Automatic Text Reader.'
TextModelParamName := 'dot_print'
TextModelParamV..."
e49e0cf2,micro,30,,"ParamValueDifferent := TextModelParamValue [!=] TextModelParamValueReset
tuple_find (ParamValueDifferent, 1, Indices)
if (Indices != -1)
Color[Indices + 1] := 'forest green'
endif
dev_disp_text (Message, 'window', 42, 12, Color, [], [])",316,323,"* --- Automatically Added Context ---
Message := 'This example shows how to read dot print characters'
TextModelParamValue := 'true'
get_text_model_param (TextModel, TextModelParamName, TextModelParam..."
e49e0cf2,micro,31,,"set_text_model_param (TextModel, TextModelParamName, TextModelParamValueReset)
return ()",324,341,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'DotPrint_Rej.omc', TextModel)
TextModelParamName := 'dot_print'
get_text_model_param (TextModel, TextModelParamName, TextModelP..."
92c1f2ed,full,0,"This example shows how to use different methods to separate
touching characters with the Automatic T...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
Message := 'This examp...",9,320,
92c1f2ed,micro,1,touching characters with the Automatic Text Reader.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
Message := 'This examp...",6,27,
92c1f2ed,micro,2,,"create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)",28,29,
92c1f2ed,micro,3,,"set_text_model_param (TextModel, 'min_contrast', 20)
TextModelParamName := 'separate_touching_chars'",30,33,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)
* --- End of Automatically Added Context ---"
92c1f2ed,micro,4,,"read_image (Image, 'ocr/article_label_01.png')
Index := 1
Message := 'If \'separate_touching_chars\' is set to \'false\','
Message[1] := 'no separation of touching characters is performed.'
disp_description (WindowHandle1, WindowHandle2, Message)
stop ()",34,41,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
Message := 'This example shows how to use diff..."
92c1f2ed,micro,5,,"set_text_model_param (TextModel, 'separate_touching_chars', 'false')
find_text_and_get_results (Image, Characters, TextModel, Class)",42,45,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)
read_image (Image, 'ocr/article_label_01.png')
* --- End of Automatically Added Context ---"
92c1f2ed,micro,6,,"MessageParam := 'separate_touching_chars = false'
ResultCorrect := [false, false]
disp_touching_character_results (Image, Characters, Class, Index, ResultCorrect, MessageParam, WindowHandle2, false)
stop ()
Message := 'If \'separate_touching_chars\' is set to \'standard\''
Message[1] := 'a direct me...",46,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
Message := 'This example shows how to use diff..."
92c1f2ed,micro,7,,"set_text_model_param (TextModel, 'separate_touching_chars', 'standard')
find_text_and_get_results (Image, CharactersStandard, TextModel, ClassStandard)",58,61,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)
read_image (Image, 'ocr/article_label_01.png')
* --- End of Automatically Added Context ---"
92c1f2ed,micro,8,,"MessageParam := 'separate_touching_chars = false'
disp_touching_character_results (Image, Characters, Class, Index, ResultCorrect, MessageParam, WindowHandle1, true)
MessageParam := 'separate_touching_chars = standard'
ResultCorrectStandard := [true, true]
disp_touching_character_results (Image, Cha...",62,69,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
read_image (Image, 'ocr/article_label_01.png')..."
92c1f2ed,micro,9,,"read_image (Image, 'ocr/article_label_02.png')
Index := 2
Message := 'In cases where the \'standard\' method fails a more complex'
Message[1] := 'method can be selected by setting \'separate_touching_chars\''
Message[2] := 'to \'enhanced\'.'
disp_description (WindowHandle1, WindowHandle2, Message)
s...",70,78,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
Message := 'This example shows how to use diff..."
92c1f2ed,micro,10,,"set_text_model_param (TextModel, 'separate_touching_chars', 'enhanced')
find_text_and_get_results (Image, CharactersEnhanced, TextModel, ClassEnhanced)",83,86,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)
read_image (Image, 'ocr/article_label_01.png')
* --- End of Automatically Added Context ---"
92c1f2ed,micro,11,,"MessageParam := 'separate_touching_chars = standard'
ResultCorrectStandard := [false, true, true, false]
disp_touching_character_results (Image, CharactersStandard, ClassStandard, Index, ResultCorrectStandard, MessageParam, WindowHandle1, true)
MessageParam := 'separate_touching_chars = enhanced'
Re...",87,95,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
read_image (Image, 'ocr/article_label_01.png')..."
92c1f2ed,micro,12,,"read_image (Image, 'ocr/article_label_03.png')
Index := 3
Message := 'For images without touching regions, the separation of'
Message[1] := 'touching characters can be switched off by setting  '
Message[2] := '\'separate_touching_chars\' to \'false\'.'
Message[4] := 'This may avoid segmentation fail...",96,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
Message := 'This example shows how to use diff..."
92c1f2ed,micro,13,,"MessageParam := 'separate_touching_chars = false'
ResultCorrect := true
disp_touching_character_results (Image, Characters, Class, Index, ResultCorrect, MessageParam, WindowHandle1, true)
MessageParam := 'separate_touching_chars = standard'
ResultCorrectStandard := false
disp_touching_character_resu...",116,124,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
read_image (Image, 'ocr/article_label_01.png')..."
92c1f2ed,micro,14,,"MessageParam := 'separate_touching_chars = false'
ResultCorrect := true
disp_touching_character_results (Image, Characters, Class, Index, ResultCorrect, MessageParam, WindowHandle1, false)
MessageParam := 'separate_touching_chars = enhanced'
ResultCorrectEnhanced := true
disp_touching_character_resu...",129,156,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
read_image (Image, 'ocr/article_label_01.png')..."
92c1f2ed,micro,15,corresponding character classes.,"find_text (Image, TextModel, TextResultID)
get_text_object (Characters, TextResultID, 'all_lines')
get_text_result (TextResultID, ['class', 0], Class)
return ()",157,181,"* --- Automatically Added Context ---
create_text_model_reader ('auto', 'Universal_Rej.occ', TextModel)
read_image (Image, 'ocr/article_label_01.png')
find_text_and_get_results (Image, Characters, Tex..."
92c1f2ed,micro,16,,"dev_set_window (WindowHandle2)
dev_clear_window ()
dev_set_window (WindowHandle1)
dev_clear_window ()
dev_disp_text (Message, 'window', 'top', 'left', 'black', 'box', 'false')
dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
return ()",182,213,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle1)
dev_open_window (0, 648, 640, 480, 'white', WindowHandle2)
Message := 'This example shows how to use diff..."
92c1f2ed,micro,17,images article_label_ [01-03].png.,"MaskSize := 15
if (Index == 1)
Row1 := [155, 205]
Column1 := [446, 553]
Row2 := [177, 228]
Column2 := [483, 583]
elseif (Index == 2)
Row1 := [204, 204, 204, 256]
Column1 := [121, 291, 358, 106]
Row2 := [227, 227, 226, 280]
Column2 := [151, 322, 389, 144]
else
Row1 := 132
Column1 := 502
Row2 := 158
C...",214,268,"* --- Automatically Added Context ---
Index := 1
* --- End of Automatically Added Context ---"
92c1f2ed,micro,18,,"ColorCorrect := 'forest green'
ColorWrong := 'red'
BoxColor := 'white'
NumColored := 3
LineWidth := 4",272,278,
92c1f2ed,micro,19,,"gen_marker_boxes (SelectedBoxes, MarkerBoxes, Index, MarkerRow, MarkerColumn)",279,281,"* --- Automatically Added Context ---
Index := 1
gen_rectangle1 (SelectedBoxes, Row1, Column1, Row2, Column2)
dilation_rectangle1 (SelectedBoxes, MarkerBoxes, MaskSize, MaskSize)
MarkerRow := Row2
Mar..."
92c1f2ed,micro,20,,"count_obj (SelectedBoxes, Number)
tuple_gen_const (Number, ColorCorrect, TextColor)
ClassDisp := []
for IdxBox := 1 to Number by 1
select_obj (SelectedBoxes, Box, IdxBox)
intersection (Characters, Box, RegionIntersection)
area_center (RegionIntersection, Area, Row, Column)
tuple_greater_elem (Area, ...",282,296,"* --- Automatically Added Context ---
find_text_and_get_results (Image, Characters, TextModel, Class)
gen_rectangle1 (SelectedBoxes, Row1, Column1, Row2, Column2)
ColorCorrect := 'forest green'
* --- ..."
92c1f2ed,micro,21,,"tuple_find (ResultCorrect, false, IndicesWrong)
if (IndicesWrong != -1)
TextColor[IndicesWrong] := ColorWrong
endif",297,302,"* --- Automatically Added Context ---
ResultCorrect := [false, false]
ColorWrong := 'red'
tuple_gen_const (Number, ColorCorrect, TextColor)
* --- End of Automatically Added Context ---"
92c1f2ed,micro,22,,"dev_set_window (WindowHandle)
dev_clear_window ()
dev_display (Image)
dev_set_draw ('fill')
dev_set_colored (NumColored)
dev_display (Characters)
dev_set_line_width (LineWidth)
dev_set_draw ('margin')
dev_set_color ('white')
dev_display (MarkerBoxes)
dev_disp_text (ClassDisp, 'window', MarkerRow, Ma...",303,335,"* --- Automatically Added Context ---
Message := 'This example shows how to use different methods to separate'
read_image (Image, 'ocr/article_label_01.png')
Message[4] := 'This may avoid segmentation..."
baa01363,full,0,,"dev_update_window ('off')
dev_update_var ('off')
dev_update_pc ('off')
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_colored (12)
dev_set_draw ('margin')
for J := 1 to 5 by 1
read_image (Image, 'dot_pr...",6,27,
18d19c2c,full,0,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_line_width (2)
for J := 1 to 5 by 1
read_image (Image, 'dot_print_rotated/dot_print_rotated_' + J$'02d')
text_lin...",6,52,
a80dac4b,full,0,,"dev_update_off ()
read_image (Image, 'dot_print_slanted')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width * 3, Height * 3, 'black', WindowHandle)
dev_set_draw ('margin')
dev_set_colored (12)
dev_set_line_width (3)
for J := 0 to 1 by 1
set_display_font (WindowHa...",6,44,
3c119b07,full,0,"This example program compares the training and recognition times of the
SVM and MLP OCR classifiers....","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFileBig)
dev_clear_...",21,381,
3c119b07,micro,1,"SVM and MLP OCR classifiers.  First, a moderately large training set of more
than 5000 samples is cr...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFileBig)",6,27,
3c119b07,micro,2,,"dev_clear_window ()
dev_set_part (0, 0, 499, 499)
disp_message (WindowHandle, 'Creating initial samples... ', 'window', 12, 12, 'green', 'false')
gen_initial_trainfile (TrainFile)",28,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
* --- End of Automatically Added Context ---"
3c119b07,micro,3,,"disp_message (WindowHandle, 'Creating modified samples... ', 'window', 42, 12, 'green', 'false')
read_ocr_trainf_names (TrainFile, CharClasses, CharCount)
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
dev_set_check ('~give_error')
delete_file (TrainFileBig)
dev_set_check ('give_error')
...",33,66,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFile..."
3c119b07,micro,4,"Note: For simplicity, the classification is performed on the raw gray values
without segmenting the ...","dev_clear_window ()
dev_set_part (0, 0, 499, 499)
disp_message (WindowHandle, 'Training SVM... ', 'window', 20, 20, 'green', 'false')
create_ocr_class_svm (8, 10, 'constant', 'pixel_invar', CharClasses, 'rbf', 0.01, 0.01, 'one-versus-all', 'normalization', 10, OCRHandleSVM)
count_seconds (S1)
trainf...",67,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFileBig)
read_ocr_trainf_names (TrainFile, CharClasses, ..."
3c119b07,micro,5,"example.  In a real application, this parameter would have to be determined
based on the error rate ...","reduce_ocr_class_svm (OCRHandleSVM, 'bottom_up', 2, 0.1, OCRHandleSVMR)
count_seconds (S2)
disp_message (WindowHandle, 'Reducing SVM... ' + (S2 - S1)$'5.2f' + 's', 'window', 50, 20, 'green', 'false')
get_support_vector_num_ocr_class_svm (OCRHandleSVMR, NumSupportVectorsR, NumSVPerSVMR)
disp_message ...",83,97,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFileBig)
read_ocr_trainf_names (TrainFile, CharClasses, ..."
3c119b07,micro,6,rates and classification times.,"NumDistort := 10
ErrorsSVM := 0
ErrorsSVMR := 0
ErrorsMLP := 0
TimeSVM := 0
TimeSVMR := 0
TimeMLP := 0
set_window_param (WindowHandle, 'flush', 'false')
for J := 0 to NumChars - 1 by 1
select_obj (Characters, Char, J + 1)
Class := CharClassesSingle[J]
full_domain (Char, CharFull)
get_image_size (Cha...",98,328,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_big.trf', TrainFile..."
3c119b07,micro,7,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",329,330,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
3c119b07,micro,8,,"dilation_circle (Region, RegionDilation, 3.5)",331,332,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
3c119b07,micro,9,,"connection (RegionDilation, ConnectedRegions)",333,334,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
3c119b07,micro,10,,"intersection (ConnectedRegions, Region, RegionIntersection)",335,336,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
3c119b07,micro,11,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')",337,338,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context --..."
3c119b07,micro,12,,"count_obj (Characters, Number)
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(20,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(20,'.')]",339,345,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
for J := 0 to NumChars - 1 by 1
* --- End of Automatically Added Context ---"
3c119b07,micro,13,,"write_ocr_trainf (Characters, Image, Classes, TrainFileName)
return ()
tuple_environment ('TEMP', PathToFile)
if (PathToFile == '')
tuple_environment ('TMP', PathToFile)
if (PathToFile == '')
file_exists ('/tmp', FileExists)
if (FileExists)
PathToFile := '/tmp'
else
PathToFile := './'
endif
endif
en...",346,377,"* --- Automatically Added Context ---
read_ocr_trainf (Characters, TrainFile, CharClassesSingle)
read_image (Image, 'letters')
Classes := []
* --- End of Automatically Added Context ---"
3c119b07,micro,14,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",378,390,"* --- Automatically Added Context ---
append_ocr_trainf (CharacterExpanded, CharacterExpanded, Class, FileName)
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
70ffba36,full,0,This example program shows how to use a simple SVM OCR classifier,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",8,102,
70ffba36,micro,1,,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_file_path_in_tmp_dir ('letters.trf', TrainFile...",6,18,
70ffba36,micro,2,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",19,20,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
70ffba36,micro,3,,"dilation_circle (Region, RegionDilation, 3.5)",21,22,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
70ffba36,micro,4,,"connection (RegionDilation, ConnectedRegions)",23,24,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
70ffba36,micro,5,,"intersection (ConnectedRegions, Region, RegionIntersection)",25,26,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
70ffba36,micro,6,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
dev_display (Characters)
disp_message (WindowHandle, 'Training characters', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",27,32,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context..."
70ffba36,micro,7,,"count_obj (Characters, Number)
Length := Number / 27
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(Length,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(Length,'.')]",33,40,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
70ffba36,micro,8,,"write_ocr_trainf (Characters, Image, Classes, TrainFile)",41,42,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
Classes..."
70ffba36,micro,9,"Therefore, the training part of the program is generic and can be
used to train any OCR classifier.","read_ocr_trainf_names (TrainFile, CharacterNames, CharacterCount)
create_ocr_class_svm (8, 10, 'constant', 'default', CharacterNames, 'rbf', 0.02, 0.05, 'one-versus-one', 'normalization', 0, OCRHandle)",43,47,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
* --- End of Automatically Added Context ---"
70ffba36,micro,10,,"trainf_ocr_class_svm (OCRHandle, TrainFile, 0.001, 'default')",48,50,"* --- Automatically Added Context ---
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
create_ocr_class_svm (8, 10, 'constant', 'default', CharacterNames, 'rbf', 0.02, 0.05, 'one-versus-one', 'norm..."
70ffba36,micro,11,,"full_domain (Image, Image)",51,52,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
70ffba36,micro,12,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold1)
dilation_circle (Region, RegionDilation, 3.5)
connection (RegionDilation, ConnectedRegions)
intersection (ConnectedRegions, Region, RegionIntersection)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row'...",53,58,"* --- Automatically Added Context ---
read_image (Image, 'letters')
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
dilation_circle (Region, RegionDilation, 3.5)
connection..."
70ffba36,micro,13,,"do_ocr_multi_class_svm (Characters, Image, OCRHandle, Class)",59,61,"* --- Automatically Added Context ---
read_image (Image, 'letters')
create_ocr_class_svm (8, 10, 'constant', 'default', CharacterNames, 'rbf', 0.02, 0.05, 'one-versus-one', 'normalization', 0, OCRHand..."
70ffba36,micro,14,,"area_center (Characters, Area, Row, Column)
dev_display (Image)
set_display_font (WindowHandle, 16, 'sans', 'true', 'false')
disp_message (WindowHandle, Class, 'image', Row - 16, Column + 8, 'blue', 'false')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Cl...",62,98,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (Regio..."
70ffba36,micro,15,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",99,111,"* --- Automatically Added Context ---
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
79fb5d67,full,0,"This example program shows how to protect OCR training files
with a password using the operator prot...","dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Exceptions := []
get_file_path_in_tmp_dir ('letter...",19,168,
79fb5d67,micro,1,,"dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Exceptions := []
get_file_path_in_tmp_dir ('letter...",17,30,
79fb5d67,micro,2,,"dev_display (Image)
gen_rectangle1 (Rectangle, 0, 0, Height - 1, 400)
reduce_domain (Image, Rectangle, Image)",31,35,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
79fb5d67,micro,3,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",36,37,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
79fb5d67,micro,4,,"dilation_circle (Region, RegionDilation, 3.5)",38,39,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
79fb5d67,micro,5,,"connection (RegionDilation, ConnectedRegions)",40,41,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
79fb5d67,micro,6,,"intersection (ConnectedRegions, Region, RegionIntersection)",42,43,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
79fb5d67,micro,7,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
dev_display (Characters)
disp_message (WindowHandle, 'Train characters', 'window', 12, 12, 'black', 'true')",44,47,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context..."
79fb5d67,micro,8,,"count_obj (Characters, Number)
Length := Number / 27
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(Length,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(Length,'.')]",48,56,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
79fb5d67,micro,9,"(Note, that it is still unprotected)","disp_message (WindowHandle, 'Write training file', 'window', 42, 12, 'black', 'true')
write_ocr_trainf (Characters, Image, Classes, TrainFile)",57,62,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
sort_region (Regio..."
79fb5d67,micro,10,,"protect_ocr_trainf (TrainFile, 'MySecretPassword007', TrainFileProtected)
disp_message (WindowHandle, 'Training file is now password protected', 'window', 72, 12, 'forest green', 'true')",63,67,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('letters_protected.trf..."
79fb5d67,micro,11,"After that, only the password protected training file is left.","delete_file (TrainFile)
try
read_ocr_trainf_names (TrainFileProtected, CharacterNames, CharacterCount)
catch (Exception)
Exceptions := [Exceptions,Exception]
disp_message (WindowHandle, 'Reading training file without password\n... failed', 'window', 102, 12, 'red', 'true')
endtry
try
read_ocr_trainf...",68,96,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Exceptions := []
get_file_path_in_tmp_dir ('letters.trf', TrainFile)
get_file_path_in_tmp_dir ('lett..."
79fb5d67,micro,12,,"create_ocr_class_mlp (8, 10, 'constant', 'default', CharacterNames, 20, 'normalization', 26, 42, OCRHandle)",97,99,"* --- Automatically Added Context ---
read_ocr_trainf_names (TrainFileProtected, CharacterNames, CharacterCount)
* --- End of Automatically Added Context ---"
79fb5d67,micro,13,,"try
trainf_ocr_class_mlp (OCRHandle, TrainFileProtected, 100, 0.01, 0.01, Error, ErrorLog)
catch (Exception)
Exceptions := [Exceptions,Exception]
endtry
try
trainf_ocr_class_mlp_protected (OCRHandle, TrainFileProtected, 'MySecretPassword007', 100, 0.01, 0.01, Error, ErrorLog)
catch (Exception)
Excep...",100,116,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Exceptions := []
get_file_path_in_tmp_dir ('letters_protected.trf', TrainFileProtected)
protect_ocr_..."
79fb5d67,micro,14,,"full_domain (Image, Image)",117,119,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
79fb5d67,micro,15,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold1)
dilation_circle (Region, RegionDilation, 3.5)
connection (RegionDilation, ConnectedRegions)
intersection (ConnectedRegions, Region, RegionIntersection)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row'...",120,125,"* --- Automatically Added Context ---
read_image (Image, 'letters')
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
dilation_circle (Region, RegionDilation, 3.5)
connection..."
79fb5d67,micro,16,,"do_ocr_multi_class_mlp (Characters, Image, OCRHandle, Class, Confidence)",126,127,"* --- Automatically Added Context ---
read_image (Image, 'letters')
create_ocr_class_mlp (8, 10, 'constant', 'default', CharacterNames, 20, 'normalization', 26, 42, OCRHandle)
sort_region (RegionInter..."
79fb5d67,micro,17,,"area_center (Characters, Area, Row, Column)
dev_display (Image)
set_display_font (WindowHandle, 16, 'sans', 'true', 'false')
disp_message (WindowHandle, Class, 'image', Row - 16, Column + 8, 'blue', 'false')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Cl...",128,164,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
get_file_path_in_tmp_dir ('letters_protected.trf', TrainFileProtected)..."
79fb5d67,micro,18,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
PathToFile := PathToFile + '/' + join([Year,Month,Day,Hour,Minute,Second,MSecond]$'02d','') + '_' + FileName
return ()",165,177,"* --- Automatically Added Context ---
tuple_environment ('TEMP', PathToFile)
* --- End of Automatically Added Context ---"
6b15ad15,full,0,Access the contour of an object,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'black', WindowID)
threshold (Image, Bright, 180, 255)
connection (Bright, ConnectedRegions)
select_shape_std (ConnectedRegions, MaxArea, 'max_area', 0)
get_region_contour (MaxArea, Rows, Columns)
Count := []
dev_displa...",8,36,
6b15ad15,micro,1,,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'black', WindowID)",6,10,
6b15ad15,micro,2,,"threshold (Image, Bright, 180, 255)
connection (Bright, ConnectedRegions)",11,13,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
6b15ad15,micro,3,,"select_shape_std (ConnectedRegions, MaxArea, 'max_area', 0)
get_region_contour (MaxArea, Rows, Columns)
Count := []
dev_display (Image)
dev_set_color ('red')
dev_display (MaxArea)
dev_update_var ('off')
dev_update_time ('off')
dev_update_pc ('off')
for r := 0 to 511 by 1
Count[r] := 0
endfor
count_s...",14,42,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'black', WindowID)
connection (Bright, ConnectedRegions)
* --- End of Automatically Added Context ---"
8b76c0d6,full,0,,"get_system ('neighborhood', Information)
gen_checker_region (RegionChecker, 511, 511, 16, 16)
set_system ('neighborhood', 4)
dev_set_colored (6)
connection (RegionChecker, ConnectedRegions)
set_system ('neighborhood', Information)",6,11,
777a53ec,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 3, 1000)
dev_set_color ('white')
inner_circle (Regions, Row, Column, Radius)
gen_circle (Circle, Row, Column, Radius)",6,11,
1db7d5f0,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 3, 1000)
dev_set_color ('white')
elliptic_axis (Regions, Ra, Rb, Phi)
area_center (Regions, Area, Row, Column)
gen_ellipse (Ellipse, Row, Column, Phi, Ra, Rb)",6,12,
e0e828b8,full,0,,"gen_empty_region (EmptyRegion)
area_center (EmptyRegion, Area, Row, Column)
count_obj (EmptyRegion, Number)",6,8,
8fc2c460,full,0,Create a region from lines or pixels,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
Gap := 10
gen_grid_region (RegionGrid, Gap, Gap, 'lines', Width, Height)
reduce_domain (Image, RegionGrid, ImageReduced)
threshold (ImageReduced, Region, 100, 255)
dilation_rectangle1 (Region, RegionDilation, Gap, Gap)
reduce_domai...",8,18,
8fc2c460,micro,1,,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
Gap := 10
gen_grid_region (RegionGrid, Gap, Gap, 'lines', Width, Height)",6,11,
8fc2c460,micro,2,,"reduce_domain (Image, RegionGrid, ImageReduced)",12,13,"* --- Automatically Added Context ---
read_image (Image, 'particle')
gen_grid_region (RegionGrid, Gap, Gap, 'lines', Width, Height)
* --- End of Automatically Added Context ---"
8fc2c460,micro,3,,"threshold (ImageReduced, Region, 100, 255)
dilation_rectangle1 (Region, RegionDilation, Gap, Gap)
reduce_domain (Image, RegionDilation, ImageReduced2)
threshold (ImageReduced2, Region, 100, 255)",14,24,"* --- Automatically Added Context ---
read_image (Image, 'particle')
Gap := 10
reduce_domain (Image, RegionGrid, ImageReduced)
* --- End of Automatically Added Context ---"
836c584e,full,0,,"dev_set_part (0, 0, 127, 127)
dev_set_draw ('fill')
gen_random_region (RegionRandom, 128, 128)
runlength_features (RegionRandom, NumRuns, KFactor, LFactor, MeanLength, Bytes)
remove_noise_region (RegionRandom, OutputRegion, 'n_4')
dev_set_draw ('fill')
dev_set_color ('red')
dev_display (RegionRandom...",6,15,
83e04ea6,full,0,,"Width := 512
Height := 512
dev_set_part (0, 0, Height - 1, Width - 1)
dev_set_colored (6)
gen_random_regions (Regions, 'circle', 10, 40, 10, 30, -0.7854, 0.7854, 100, Width, Height)
stop ()
dev_clear_window ()
gen_random_regions (Regions, 'ring', 10, 40, 5, 30, -0.7854, 0.7854, 100, Width, Height)",6,13,
87ea56dd,full,0,,"read_image (Image, 'letters')
threshold (Image, Region, 0, 100)
closing_rectangle1 (Region, RegionClosing, 9, 5)
connection (RegionClosing, ConnectedRegions)
smallest_rectangle1 (ConnectedRegions, Row1, Column1, Row2, Column2)
gen_rectangle1 (Rectangles, Row1, Column1, Row2, Column2)
dev_set_draw ('...",6,15,
b5e2234b,full,0,,"read_image (Image, 'for5')
threshold (Image, Region, 100, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'width', 'and', 300, 400)
smallest_rectangle2 (SelectedRegions, Row, Column, Phi, Length1, Length2)
gen_rectangle2 (CarSign, Row, Column, Phi, Length1...",6,15,
9ccf45b4,full,0,,"read_image (Image, 'fabrik')
gen_rectangle1 (Rectangle, 345, 280, 410, 350)
gray_histo (Rectangle, Image, AbsoluteHisto, RelativeHisto)
create_funct_1d_array (AbsoluteHisto, Function)
smooth_funct_1d_gauss (Function, 2, SmoothedFunction)
funct_1d_to_pairs (SmoothedFunction, XValues, YValues)
dev_set...",6,20,
3168cb69,full,0,,"dev_set_part (0, 0, 511, 511)
dev_set_color ('red')
for phi := 0 to 359 by 1
gen_region_hline (Line, rad(phi), 100)
endfor",6,10,
954a2a7b,full,0,Store input lines as regions,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
Row := 320
Col := 270
dev_update_off ()
for phi := 0 to 359 by 1
gen_region_line (Line, Row, Col, Row + 100 * sin(rad(phi)), Col + 100 * ...",8,23,
954a2a7b,micro,1,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
Row := 320
Col := 270
dev_update_off ()
for phi := 0 to 359 by 1
gen_region_line (Line, Row, Col, Row + 100 * sin(rad(phi)), Col + 100 * ...",6,29,
5b95a9b3,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Button := 1
Rows := []
Cols := []
dev_set_color ('red')
dev_clear_window ()
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
Rows := [Rows,Row]
Cols := [Cols,Column]
disp_circle (WindowID, Row, Column, 3)
endwhile...",6,23,
6bc9786d,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Button := 1
Rows := []
Cols := []
dev_set_color ('red')
dev_clear_window ()
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
Rows := [Rows,Row]
Cols := [Cols,Column]
disp_circle (WindowID, Row, Column, 3)
endwhile...",6,23,
1c50ea5d,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Button := 1
Rows := []
Cols := []
dev_set_color ('red')
dev_clear_window ()
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
Rows := [Rows,Row]
Cols := [Cols,Column]
disp_circle (WindowID, Row, Column, 3)
endwhile...",6,23,
5d0f1236,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Button := 1
Rows := []
Cols := []
dev_set_color ('red')
dev_clear_window ()
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
Rows := [Rows,Row]
Cols := [Cols,Column]
disp_circle (WindowID, Row, Column, 3)
endwhile...",6,23,
c82061bf,full,0,,"read_image (B51, 'b5_1')
scale_image (B51, ImageScaled, 0.02, 0)
label_to_region (ImageScaled, Regions)
select_obj (Regions, ObjectSelected, [1, 2])
union1 (ObjectSelected, RegionUnion)
dev_clear_window ()
dev_set_colored (6)
dev_display (RegionUnion)",6,13,
80b592ad,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 3, 200)
dev_set_draw ('margin')
dev_display (Regions)
area_center (Regions, Area, Row...",6,16,
1cbdd736,full,0,"This example demonstrates the use of the operator area_holes.
Setup display window","dev_close_window ()
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('goldenrod')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
threshold (Image, Region, 128, 255)
area_holes (Region, Area)
disp_messa...",9,21,
1cbdd736,micro,1,,"dev_close_window ()
read_image (Image, 'rings_and_nuts')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
dev_set_color ('goldenrod')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)",8,15,
1cbdd736,micro,2,,"threshold (Image, Region, 128, 255)",16,18,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
* --- End of Automatically Added Context ---"
1cbdd736,micro,3,,"area_holes (Region, Area)
disp_message (WindowHandle, 'Size of enclosed area (holes): ' + Area + ' pixel', 'window', 12, 12, 'black', 'true')",19,28,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
threshold (Image, Region, 128, 255)
* --- End of Automatically Added Context ---"
529ae1d9,full,0,Calculate the shape factor for the roundness of regions.,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)
for i := 1 to Number by 1
select_obj (Regions, ObjectSelected, i)
circularity (O...",8,34,
529ae1d9,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')",6,12,
529ae1d9,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)",13,15,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
529ae1d9,micro,3,,"for i := 1 to Number by 1
select_obj (Regions, ObjectSelected, i)
circularity (ObjectSelected, Circularity)
if (Circularity &gt; 0.4)
dev_set_color ('green')
dev_display (ObjectSelected)
else
dev_set_color ('red')
dev_display (ObjectSelected)
endif
endfor
stop ()",16,28,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)
* --- End of Automatically Added Context ---"
529ae1d9,micro,4,,dev_set_color ('red'),29,30,
529ae1d9,micro,5,,"select_shape (Regions, SelectedRegions1, 'circularity', 'and', 0, 0.4)
dev_set_color ('green')
select_shape (Regions, SelectedRegions2, 'circularity', 'and', 0.4, 1)",31,40,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
* --- End of Automatically Added Context ---"
6c6ff099,full,0,Calculate the shape factor for the compactness of regions,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)
for i := 1 to Number by 1
select_obj (Regions, ObjectSelected, i)
compactness (ObjectSelected, Compact...",8,33,
6c6ff099,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')",6,11,
6c6ff099,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)",12,14,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
6c6ff099,micro,3,,"for i := 1 to Number by 1
select_obj (Regions, ObjectSelected, i)
compactness (ObjectSelected, Compactness)
if (Compactness &lt; 1.8)
dev_set_color ('green')
dev_display (ObjectSelected)
else
dev_set_color ('red')
dev_display (ObjectSelected)
endif
endfor
stop ()",15,27,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, Number)
* --- End of Automatically Added Context ---"
6c6ff099,micro,4,,dev_set_color ('red'),28,29,
6c6ff099,micro,5,,"select_shape (Regions, SelectedRegions1, 'compactness', 'and', 1.8, 1000)
dev_set_color ('green')
select_shape (Regions, SelectedRegions2, 'compactness', 'and', 1, 1.8)",30,39,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
* --- End of Automatically Added Context ---"
081b2400,full,0,,"read_image (Image, 'monkey')
dev_set_color ('red')
threshold (Image, Region, 128, 255)
connect_and_holes (Region, NumConnected, NumHoles)
dev_set_color ('green')
complement (Region, RegionComplement)
connect_and_holes (RegionComplement, NumConnectedComplement, NumHolesComplement)",6,12,
43780154,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 3, 100)
area_center (Regions, Area, Row, Column)
contlength (Regions, ContLength)
Compactness := ContLength * ContLength / (Area * 4 * 3.1416)",6,12,
43780154,micro,1,,Compactness := ContLength * ContLength / (Area * 4 * 3.1416),11,18,"* --- Automatically Added Context ---
area_center (Regions, Area, Row, Column)
contlength (Regions, ContLength)
* --- End of Automatically Added Context ---"
b3e1d09b,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 100)
convexity (Regions, Convexity)
dev_set_color ('black')
dev_set_draw ('margin')
shape_trans (Regions, ConvexRegions, 'convex')
area_center (ConvexRegions, AreaConvex, Row, Column)
area_...",6,17,
b3e1d09b,micro,1,,"dev_set_color ('black')
dev_set_draw ('margin')
shape_trans (Regions, ConvexRegions, 'convex')
area_center (ConvexRegions, AreaConvex, Row, Column)
area_center (Regions, Area, Row1, Column1)
Convexity2 := real(Area) / AreaConvex",11,23,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
* --- End of Automatically Added Context ---"
a68758cd,full,0,Maximal distance between two boundary points of a region,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_colored (6)
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 100)
diameter_region (Regions, Row1, Column1, Row2, Column2, Diameter)
dev_set_color ('white')
dev_set_line_width (3)...",8,18,
a68758cd,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_colored (6)
dev_set_draw ('fill')",6,12,
a68758cd,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 100)
diameter_region (Regions, Row1, Column1, Row2, Column2, Diameter)
dev_set_color ('white')
dev_set_line_width (3)
disp_line (WindowID, Row1, Column1, Row2, Column2)",13,24,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'black', WindowID)
* --- End of Automatically Added Context ---"
215a22e1,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
area_center (Regions, Area, Row, Column)
eccentricity (Regions, Anisometry, Bulkiness, StructureFactor)
dev_...",6,19,
69764d37,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
elliptic_axis (Regions, Ra, Rb, Phi)
area_center (Regions, Area, Row, Column)
dev_set_draw ('margin')
dev_se...",6,16,
c39148da,full,0,,"read_image (Image, 'monkey')
dev_set_draw ('fill')
dev_set_color ('red')
threshold (Image, Region, 128, 255)
euler_number (Region, EulerNumber)
dev_set_color ('green')
get_system ('clip_region', Information)
set_system ('clip_region', 'true')
complement (Region, RegionComplement)
euler_number (Regio...",6,19,
23e790f4,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 3, 200)
gen_empty_region (Empty)
expand_region (Regions, Empty, RegionExpanded, 'maximal', 'image')
dev_clear_window ()
select_obj (RegionExpa...",6,33,
e207b651,full,0,Index of all regions containing a given pixel,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
Button := 1
dev_set_color ('red')
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
get_region...",8,25,
e207b651,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')",6,12,
e207b651,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 400)
Button := 1
dev_set_color ('red')
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
get_region_index (Regions, Row, Column, Index)
if (Index != [])
select_obj (Regions, ObjectSelected, Index)
endif
endwhile",13,31,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'black', WindowID)
* --- End of Automatically Added Context ---"
938ae40a,full,0,"This example program shows how to calculate the thickness
of a region along its main axis for each p...","dev_update_off ()
dev_close_window ()
read_image (Image, 'screw_thread')
WindowWidth := 540
WindowHeight := 400
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, -1, -1, WindowHandle1)
get_image_size (Image, ImageWidth, ImageHeight)
dev_set_part (0, 0, ImageHeight, ImageWidth)
set_display_f...",17,73,
938ae40a,micro,1,"connected components of predefined gray values. Then the
thickness of this region and for visualizat...","dev_update_off ()
dev_close_window ()",12,19,
938ae40a,micro,2,,"read_image (Image, 'screw_thread')
WindowWidth := 540
WindowHeight := 400
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, -1, -1, WindowHandle1)
get_image_size (Image, ImageWidth, ImageHeight)
dev_set_part (0, 0, ImageHeight, ImageWidth)
set_display_font (WindowHandle1, 16, 'mono', 'true'...",20,30,
938ae40a,micro,3,,"Message := 'This program shows how to calculate the'
Message[1] := 'thickness of a region along its main axis'
Message[2] := 'for each pixel of the section.'
Message[3] := 'First a region is determined and then the'
Message[4] := 'thickness along the main axis of this'
Message[5] := 'region is calcu...",31,41,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
938ae40a,micro,4,"-----------------------
Segment the image according to selected gray values and calculate
the thickn...","threshold (Image, Region, 0, 67)
get_region_thickness (Region, Thickness, Histogramm)",42,48,"* --- Automatically Added Context ---
read_image (Image, 'screw_thread')
* --- End of Automatically Added Context ---"
938ae40a,micro,5,,"dev_clear_window ()
dev_set_color ('red')
dev_display (Region)",52,56,"* --- Automatically Added Context ---
threshold (Image, Region, 0, 67)
* --- End of Automatically Added Context ---"
938ae40a,micro,6,,"area_center (Region, Area, Row, Column)
elliptic_axis (Region, Ra, Rb, Phi)
StartRow := Row + sin(Phi) * Ra
StartColumn := Column - cos(Phi) * Ra
EndRow := Row - sin(Phi) * Ra
EndColumn := Column + cos(Phi) * Ra
dev_set_color ('yellow')
disp_line (WindowHandle1, StartRow, StartColumn, EndRow, EndCol...",57,67,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, WindowWidth, WindowHeight, -1, -1, WindowHandle1)
threshold (Image, Region, 0, 67)
* --- End of Automatically Added Context ---"
938ae40a,micro,7,,"dev_open_window (0, WindowWidth + 10, 460, WindowHeight, 'black', WindowHandle2)
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
dev_set_line_width (1)
plot_tuple (WindowHandle2, [], Thickness, [], [], 'red', ['style', 'margin_top'], ['line',WindowHeight * 0.2])
disp_message (WindowHan...",68,79,"* --- Automatically Added Context ---
WindowWidth := 540
WindowHeight := 400
get_region_thickness (Region, Thickness, Histogramm)
* --- End of Automatically Added Context ---"
383c85d1,full,0,Hamming distance between two regions,"read_image (Image, 'monkey')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
threshold (Image, Region, 200, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 99999)
cl...",8,28,
383c85d1,micro,1,,"read_image (Image, 'monkey')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
threshold (Image, Region, 200, 255)",6,13,
383c85d1,micro,2,,"connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 99999)",14,16,"* --- Automatically Added Context ---
threshold (Image, Region, 200, 255)
* --- End of Automatically Added Context ---"
383c85d1,micro,3,,"closing_circle (SelectedRegions, RegionClosing, 3.5)
hamming_distance (SelectedRegions, RegionClosing, Distance1, Similarity1)
opening_circle (SelectedRegions, RegionOpening, 3.5)
hamming_distance (SelectedRegions, RegionOpening, Distance2, Similarity2)",17,21,"* --- Automatically Added Context ---
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 99999)
* --- End of Automatically Added Context ---"
383c85d1,micro,4,,"dev_set_color ('red')
dev_display (RegionClosing)
dev_set_color ('green')
dev_display (SelectedRegions)
dev_set_color ('blue')
dev_display (RegionOpening)",22,34,"* --- Automatically Added Context ---
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 99999)
closing_circle (SelectedRegions, RegionClosing, 3.5)
opening_circle (SelectedRegions,..."
f5a24e4d,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 500)
inner_circle (Regions, Row, Column, Radius)
dev_set_color ('red')
disp_circle (WindowID, Row, Column, Radius...",6,14,
645a5184,full,0,"This example program shows how to use inner_rectangle1 to find knot-free
rectangles in a piece of wo...","dev_update_window ('off')
dev_update_var ('off')
dev_update_pc ('off')
read_image (Image, 'wood_knots')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
MinAreaSize := 10000
MinWidth := 50
MinHeight := 50
dev_display (Image)
mean_...",9,53,
645a5184,micro,1,"rectangles in a piece of wood.  Typically, the piece of wood is then cut along
the rectangles to obt...","dev_update_window ('off')
dev_update_var ('off')
dev_update_pc ('off')
read_image (Image, 'wood_knots')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,15,
645a5184,micro,2,,"MinAreaSize := 10000
MinWidth := 50
MinHeight := 50
dev_display (Image)",16,20,"* --- Automatically Added Context ---
read_image (Image, 'wood_knots')
* --- End of Automatically Added Context ---"
645a5184,micro,3,,"mean_image (Image, ThresholdImage, 31, 31)
dyn_threshold (Image, ThresholdImage, RegionDynThresh, 20, 'dark')
erosion_circle (RegionDynThresh, RegionErosion, 1.5)
connection (RegionErosion, ConnectedRegions)
select_shape (ConnectedRegions, KnobRegions, 'area', 'and', 20, 200)
dilation_circle (KnobRe...",21,28,"* --- Automatically Added Context ---
read_image (Image, 'wood_knots')
* --- End of Automatically Added Context ---"
645a5184,micro,4,,"get_domain (Image, Domain)
difference (Domain, KnobRegionsUnion, KnobFreeRegion)",29,31,"* --- Automatically Added Context ---
read_image (Image, 'wood_knots')
union1 (KnobRegionsDilated, KnobRegionsUnion)
* --- End of Automatically Added Context ---"
645a5184,micro,5,to the tuple of knot-free rectangles.,"area_center (KnobFreeRegion, Area, Row, Column)
gen_empty_obj (KnobFreeRectangles)
while (Area &gt; MinAreaSize)
inner_rectangle1 (KnobFreeRegion, Row1, Column1, Row2, Column2)
RectangleHeight := Row2 - Row1
RectangleWidth := Column2 - Column1
if (RectangleHeight &gt; MinHeight and RectangleWidth &g...",32,59,"* --- Automatically Added Context ---
read_image (Image, 'wood_knots')
MinAreaSize := 10000
MinWidth := 50
MinHeight := 50
difference (Domain, KnobRegionsUnion, KnobFreeRegion)
* --- End of Automatica..."
26ae1c23,full,0,Calculate the geometric moments of regions,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 1000)
area_center (Regions, Area, Row, Column)
moments_region_2nd (Regions, M11, M20, M02, Ia, Ib)
dev_set_color ...",8,24,
26ae1c23,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')",6,12,
26ae1c23,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 1000)
area_center (Regions, Area, Row, Column)
moments_region_2nd (Regions, M11, M20, M02, Ia, Ib)
dev_set_color ('red')
Feature := M11",13,18,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
26ae1c23,micro,3,through the center parallel to the coordinate axes,"for i := 0 to |Row| - 1 by 1
set_tposition (WindowID, Row[i], Column[i])
write_string (WindowID, Feature[i]$'.5')
endfor",19,30,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
area_center (Regions, Area, Row, Column)
Feature := M11
moments_region_2nd (Regions, M11, M20, M02, Ia, Ib)
* ..."
a994ecd2,full,0,"Calculate the geometric moments of regions and the product of inertia
of the axes through the center...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_draw ('margin')
dev_set_color ('white')
M11Tuple := []
M20Tuple := []
M02Tuple := []
dev_update_var ('off')
dev_update_pc ('off')
for i := 10 to 250 by 2
gen_ellipse (Ellipse, i, i, 0.4, i, i / 2)
moments_region_2nd_inva...",9,31,
a994ecd2,micro,1,of the axes through the center parallel to the coordinate axes,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_draw ('margin')
dev_set_color ('white')
M11Tuple := []
M20Tuple := []
M02Tuple := []
dev_update_var ('off')
dev_update_pc ('off')",6,17,
a994ecd2,micro,2,,"for i := 10 to 250 by 2
gen_ellipse (Ellipse, i, i, 0.4, i, i / 2)
moments_region_2nd_invar (Ellipse, M11, M20, M02)
M11Tuple := [M11Tuple,M11]
M20Tuple := [M20Tuple,M20]
M02Tuple := [M02Tuple,M02]
endfor
dev_set_color ('red')
Feature := M11Tuple
Scale := 3000.0
for i := 0 to |Feature| - 1 by 1
disp...",18,37,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
M11Tuple := []
M20Tuple := []
M02Tuple := []
* --- End of Automatically Added Context ---"
9c7425e7,full,0,,"read_image (Clips, 'clip')
dev_close_window ()
get_image_size (Clips, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowID)
threshold (Clips, Dark, 0, 70)
connection (Dark, Single)
dev_clear_window ()
dev_set_color ('black')
dev_set_draw ('fill')
select_shape (Single, Selec...",6,22,
0cf4d366,full,0,"This example shows how to compute and use the region feature
rectangularity.
The first two examples ...","dev_set_colored (12)
dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowHandle)
read_image (Image, 'die/die_07')
auto_threshold (Image, Regions, 3)
connection (Regions, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegionsArea, 'area', 'and', 500, 1000)
dev_display (Imag...",16,119,
0cf4d366,micro,1,"rectangularity.
The first two examples show how to use select_shape in order
to select rectangular r...",dev_set_colored (12),6,17,
0cf4d366,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 728, 512, 'black', WindowHandle)
read_image (Image, 'die/die_07')
auto_threshold (Image, Regions, 3)
connection (Regions, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegionsArea, 'area', 'and', 500, 1000)
dev_display (Image)
dev_display (Selec...",18,33,
0cf4d366,micro,3,,"dev_close_window ()
dev_open_window (0, 0, 1109 / 2, 871 / 2, 'black', WindowHandle)
read_image (Image, 'pcb')
threshold (Image, Region, 0, 100)
erosion_circle (Region, RegionErosion, 11.5)
connection (RegionErosion, ConnectedRegions)
dilation_circle (ConnectedRegions, RegionDilation, 11.5)
dev_disp...",34,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, 728, 512, 'black', WindowHandle)
read_image (Image, 'die/die_07')
connection (Regions, ConnectedRegions)
select_shape (SelectedRegionsArea,..."
0cf4d366,micro,4,,"Dist := 60
dev_close_window ()
dev_open_window (0, 0, Dist * 27 / 3, Dist * 27 / 3, 'black', WindowHandle)
create_rand_regions (RegionsRand)
rectangularity (RegionsRand, Rectangularity)
Indices := sort_index(Rectangularity)
IndicesDesc := inverse(Indices)
gen_image_const (ImageRegions, 'byte', Dist ...",51,127,"* --- Automatically Added Context ---
dev_open_window (0, 0, 728, 512, 'black', WindowHandle)
read_image (Image, 'die/die_07')
connection (Regions, ConnectedRegions)
threshold (Image, Region, 0, 100)
..."
a19798d5,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
area_center (Regions, Area, Row, Column)
roundness (Regions, Distance, Sigma, Roundness, Sides)
dev_clear_wi...",6,22,
9af4338b,full,0,"This example program shows how to calculate the runlength
distribution of a region.
In HALCON a regi...","dev_update_off ()
dev_close_window ()
read_image (Image, 'tooth_rim')
get_image_size (Image, ImageWidth, ImageHeight)
dev_open_window_fit_size (0, 0, 540, 400, -1, -1, WindowHandle1)
dev_set_part (0, 0, ImageHeight, ImageWidth)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_displa...",20,92,
9af4338b,micro,1,"connected components of predefined gray values. The final
region is then chosen with the aid of shap...","dev_update_off ()
dev_close_window ()",13,22,
9af4338b,micro,2,,"read_image (Image, 'tooth_rim')
get_image_size (Image, ImageWidth, ImageHeight)
dev_open_window_fit_size (0, 0, 540, 400, -1, -1, WindowHandle1)
dev_set_part (0, 0, ImageHeight, ImageWidth)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
dev_display (Image)",23,30,
9af4338b,micro,3,,"Message := 'This program shows how to calculate the'
Message[1] := 'runlength distribution of a region. In HALCON'
Message[2] := 'regions are encoded in runlengths. For every'
Message[3] := 'line the coordinates of its start and end'
Message[4] := 'point are stored. The runlength distribution'
Messa...",31,47,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 540, 400, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
9af4338b,micro,4,"------------------------------------
Segment the image according to selected gray values.
Then calcu...","threshold (Image, Region, 0, 64)
runlength_distribution (Region, Foreground, Background)",48,54,"* --- Automatically Added Context ---
read_image (Image, 'tooth_rim')
* --- End of Automatically Added Context ---"
9af4338b,micro,5,,"dev_clear_window ()
dev_set_color ('red')
dev_display (Region)",58,62,"* --- Automatically Added Context ---
threshold (Image, Region, 0, 64)
* --- End of Automatically Added Context ---"
9af4338b,micro,6,,"threshold (Image, Region2, 64, 300)
connection (Region2, ConnectedRegions)
select_shape (ConnectedRegions, RegionBackground, 'area', 'and', 100, 9999)
dev_set_color ('lime green')
dev_display (RegionBackground)
Message := 'Foreground and Background of the'
Message[1] := 'selected region'
disp_messag...",63,72,"* --- Automatically Added Context ---
read_image (Image, 'tooth_rim')
dev_open_window_fit_size (0, 0, 540, 400, -1, -1, WindowHandle1)
Message := 'This program shows how to calculate the'
runlength_di..."
9af4338b,micro,7,---------------------------------,"get_window_extents (WindowHandle1, Row, Column, Width, Height)
dev_open_window (0, Width + 10, 460, Height, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
disp_message (WindowHandle2, 'Runlength distribution', 'window', 12, 12, 'black', 'true')",73,79,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 540, 400, -1, -1, WindowHandle1)
* --- End of Automatically Added Context ---"
9af4338b,micro,8,,"OuterMargin := 50
InnerMargin := 270
TopMargin := Height * 0.2
BottomMargin := Height * 0.15",80,85,"* --- Automatically Added Context ---
get_window_extents (WindowHandle1, Row, Column, Width, Height)
* --- End of Automatically Added Context ---"
9af4338b,micro,9,,"plot_tuple (WindowHandle2, [], Foreground, [], [], 'red', ['style', 'axes_color', 'margin_left', 'margin_right', 'margin_top', 'margin_bottom'], ['filled', 'white',OuterMargin,InnerMargin,TopMargin,BottomMargin])
disp_message (WindowHandle2, 'Foreground', 'window', TopMargin + 10, OuterMargin + 40, ...",86,89,"* --- Automatically Added Context ---
runlength_distribution (Region, Foreground, Background)
dev_open_window (0, Width + 10, 460, Height, 'black', WindowHandle2)
OuterMargin := 50
InnerMargin := 270
..."
9af4338b,micro,10,,"plot_tuple (WindowHandle2, [], Background, [], [], 'lime green', ['style', 'axes_color', 'margin_left', 'margin_right', 'margin_top', 'margin_bottom'], ['filled', 'white',InnerMargin,OuterMargin,TopMargin,BottomMargin])
disp_message (WindowHandle2, 'Background', 'window', TopMargin + 10, InnerMargin...",90,98,"* --- Automatically Added Context ---
runlength_distribution (Region, Foreground, Background)
dev_open_window (0, Width + 10, 460, Height, 'black', WindowHandle2)
OuterMargin := 50
InnerMargin := 270
..."
914e009a,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
area_center (Regions, Area, Row, Column)
runlength_features (Regions, NumRuns, KFactor, LFactor, MeanLength,...",6,22,
96198991,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_clear_window ()
dev_set_color ('white')
dev_display (Regions)
count_obj (Regions, Number)
Button := 1
de...",6,23,
bbfe0e51,full,0,Select regions by desired neighboring relation,"read_image (Meningg6, 'meningg6')
gauss_filter (Meningg6, ImageGauss, 7)
watersheds (ImageGauss, Regions, Watersheds)
dev_clear_window ()
dev_set_color ('light gray')
* select_obj (Regions, Reference, 261)
select_shape (Regions, Reference, ['row', 'column'], 'and', [250, 250], [260, 260])
select_reg...",8,28,
bbfe0e51,micro,1,,"read_image (Meningg6, 'meningg6')
gauss_filter (Meningg6, ImageGauss, 7)",6,9,
bbfe0e51,micro,2,,"watersheds (ImageGauss, Regions, Watersheds)
dev_clear_window ()
dev_set_color ('light gray')
* select_obj (Regions, Reference, 261)
select_shape (Regions, Reference, ['row', 'column'], 'and', [250, 250], [260, 260])",10,15,"* --- Automatically Added Context ---
gauss_filter (Meningg6, ImageGauss, 7)
* --- End of Automatically Added Context ---"
bbfe0e51,micro,3,,"select_region_spatial (Reference, Regions, 'left', RegionIndex1, RegionIndex2)
dev_set_color ('red')
select_obj (Regions, ObjectSelected, RegionIndex2)
select_region_spatial (Reference, Regions, 'right', RegionIndex1, RegionIndex2)
dev_set_color ('green')
select_obj (Regions, ObjectSelected, RegionI...",16,34,"* --- Automatically Added Context ---
watersheds (ImageGauss, Regions, Watersheds)
* select_obj (Regions, Reference, 261)
* --- End of Automatically Added Context ---"
ffa61350,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 10)
dev_set_color ('red')
select_shape (Regions, SelectedRegions, 'convexity', 'and', 0.95, 1)
dev_set_color ('gr...",6,17,
e96bb396,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
select_obj (Regions, Pattern, 21)
dev_clear_window ()
select_shape_proto (Regions, Pattern, SelectedRegions1...",6,25,
e716527a,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('red')
select_shape_std (Regions, SelectedRegions, 'rectangle1', 90)
dev_set_color ('green')
...",6,15,
46d793d6,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('red')
smallest_circle (Regions, Row, Column, Radius)
dev_set_draw ('margin')
gen_circle (Cir...",6,15,
b7a26bd0,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('red')
smallest_rectangle1 (Regions, Row1, Column1, Row2, Column2)
dev_set_draw ('margin')
ge...",6,15,
42a74f81,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_color ('white')
dev_set_draw ('fill')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('red')
dev_set_draw ('margin')
smallest_rectangle2 (Regions, Row, Column, Phi, Length1, Lengt...",6,15,
b7a66aaf,full,0,Pose relation of regions with regard to the coordinate axes,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_draw ('fill')
dev_set_color ('white')
regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('dim gray')
dev_set_color ('light gray')
select_obj (Regions, ObjectSelected, 12)
spatial_rel...",8,40,
b7a66aaf,micro,1,,"read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
dev_set_draw ('fill')
dev_set_color ('white')",6,12,
b7a66aaf,micro,2,,"regiongrowing (Image, Regions, 1, 1, 3, 400)
dev_set_color ('dim gray')
dev_set_color ('light gray')
select_obj (Regions, ObjectSelected, 12)
spatial_relation (ObjectSelected, Regions, 50, RegionIndex1, RegionIndex2, Relation1, Relation2)",13,18,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
b7a66aaf,micro,3,,"for i := 0 to |RegionIndex2| - 1 by 1
dev_set_color ('white')
select_obj (Regions, ObjectSelected, RegionIndex2[i])
area_center (ObjectSelected, Area, Row, Column)
set_tposition (WindowID, Row, Column)
dev_set_color ('red')
if (Relation1[i] == '')
write_string (WindowID, '(')
else
write_string (Wind...",19,36,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowID)
regiongrowing (Image, Regions, 1, 1, 3, 400)
select_obj (Regions, ObjectSelected, 12)
spatial_relation (Object..."
b7a66aaf,micro,4,,"select_obj (Regions, ObjectSelected1, 6)
select_obj (Regions, ObjectSelected2, 24)
spatial_relation (ObjectSelected1, ObjectSelected2, 50, RegionIndex1, RegionIndex2, Relation1, Relation2)",37,46,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 400)
spatial_relation (ObjectSelected, Regions, 50, RegionIndex1, RegionIndex2, Relation1, Relation2)
* --- End of Automat..."
e485fae8,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
draw_region (Region, WindowID)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, -0.3, 256, 256, HomMat2DRotate)
hom_mat2d_scale (HomMat2DRotate, 1.5, 1.5, 256, 256, HomMat2DScale)...",6,20,
e485fae8,micro,1,,"draw_region (Region, WindowID)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, -0.3, 256, 256, HomMat2DRotate)
hom_mat2d_scale (HomMat2DRotate, 1.5, 1.5, 256, 256, HomMat2DScale)
affine_trans_region (Region, RegionAffineTrans, HomMat2DScale, 'nearest_neighbor')
dev_clear_wi...",9,26,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
c2aba380,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
draw_region (Region, WindowID)
mirror_region (Region, RegionMirror1, 'row', 512)
mirror_region (Region, RegionMirror2, 'column', 512)
mirror_region (RegionMirror2, RegionMirror3, 'row', 512)
dev_clear_win...",6,23,
c2aba380,micro,1,,"draw_region (Region, WindowID)
mirror_region (Region, RegionMirror1, 'row', 512)
mirror_region (Region, RegionMirror2, 'column', 512)
mirror_region (RegionMirror2, RegionMirror3, 'row', 512)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Region)
dev_set_color ('green'...",9,29,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
10e35833,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
dev_set_draw ('margin')
dev_clear_window ()
draw_region (Region, WindowID)
area_center (Region, Area, RowOrig, ColumnOrig)
Button := 1
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
if (B...",6,25,
10e35833,micro,1,"When you are done drawing, use the right mouse button to proceed.","draw_region (Region, WindowID)
area_center (Region, Area, RowOrig, ColumnOrig)
Button := 1
while (Button == 1)
get_mbutton (WindowID, Row, Column, Button)
if (Button == 1)
dev_clear_window ()
move_region (Region, RegionMoved, Row - RowOrig, Column - ColumnOrig)
endif
endwhile",11,31,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
70c4c97d,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_region to rotate a region in 3D...","dev_update_off ()
read_image (Image, 'mreut')
threshold (Image, Region, 180, 255)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffe...",8,76,
70c4c97d,micro,1,projective_trans_region to rotate a region in 3D.,"dev_update_off ()
read_image (Image, 'mreut')",6,9,
70c4c97d,micro,2,,"threshold (Image, Region, 180, 255)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",10,14,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
70c4c97d,micro,3,"a smooth (i.e., flicker-free) display under both Windows and Unix.","open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffer, 'red')
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
Iter := 1440",15,20,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
70c4c97d,micro,4,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.1
DBeta := 1.5
DGamma := 1.9",21,26,
70c4c97d,micro,5,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",27,30,
70c4c97d,micro,6,of the region.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",31,35,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
70c4c97d,micro,7,"from which the region is created moves in 3D.
This will generate the torus knot T(5,4).","M := 5
N := 4",36,40,
70c4c97d,micro,8,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0
for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D...",41,82,"* --- Automatically Added Context ---
threshold (Image, Region, 180, 255)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, H..."
02f97d16,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
draw_region (Region, WindowID)
transpose_region (Region, Transposed, 256, 256)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Region)
dev_set_color ('green')
dev_display (T...",6,17,
02f97d16,micro,1,,"draw_region (Region, WindowID)
transpose_region (Region, Transposed, 256, 256)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Region)
dev_set_color ('green')
dev_display (Transposed)",9,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
e3de6e97,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
draw_region (Region, WindowID)
zoom_region (Region, RegionZoom, 2, 2)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Region)
dev_set_color ('green')
dev_display (RegionZoom...",6,17,
e3de6e97,micro,1,,"draw_region (Region, WindowID)
zoom_region (Region, RegionZoom, 2, 2)
dev_clear_window ()
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (Region)
dev_set_color ('green')
dev_display (RegionZoom)",9,23,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
96813625,full,0,Determine the connected components of the background of given regions,"read_image (Image, 'fabrik')
sobel_amp (Image, EdgeAmplitude, 'thin_sum_abs', 3)
threshold (EdgeAmplitude, Edges, 5, 255)
background_seg (Edges, BackgroundRegions)
fill_up_shape (BackgroundRegions, RegionFillUp, 'area', 1, 40)
dev_clear_window ()
dev_set_colored (6)
dev_display (RegionFillUp)",8,17,
96813625,micro,1,,"read_image (Image, 'fabrik')",6,8,
96813625,micro,2,,"sobel_amp (Image, EdgeAmplitude, 'thin_sum_abs', 3)
threshold (EdgeAmplitude, Edges, 5, 255)
background_seg (Edges, BackgroundRegions)",9,12,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
96813625,micro,3,,"fill_up_shape (BackgroundRegions, RegionFillUp, 'area', 1, 40)
dev_clear_window ()
dev_set_colored (6)
dev_display (RegionFillUp)",13,23,"* --- Automatically Added Context ---
background_seg (Edges, BackgroundRegions)
* --- End of Automatically Added Context ---"
0e718c8b,full,0,Init,"dev_update_off ()
read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, NumberOfOriginalRegions)
get_system ('store_empty_region', Information)
set_system ('store_empty_region', 'true')
clip_region (Regions, RegionClippedWithEmptyRegions, 100, 100, 455, 455)
c...",7,41,
0e718c8b,micro,1,,"dev_update_off ()
read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, NumberOfOriginalRegions)",6,11,
0e718c8b,micro,2,,"get_system ('store_empty_region', Information)
set_system ('store_empty_region', 'true')",12,14,
0e718c8b,micro,3,,"clip_region (Regions, RegionClippedWithEmptyRegions, 100, 100, 455, 455)
count_obj (RegionClippedWithEmptyRegions, NumberOfClippedRegionsWithEmptyRegions)
set_system ('store_empty_region', 'false')",15,18,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
* --- End of Automatically Added Context ---"
0e718c8b,micro,4,,"clip_region (Regions, RegionClipped, 100, 100, 455, 455)
count_obj (RegionClipped, NumberOfClippedRegionsWithoutEmptyRegions)",19,22,"* --- Automatically Added Context ---
regiongrowing (Image, Regions, 1, 1, 3, 100)
* --- End of Automatically Added Context ---"
0e718c8b,micro,5,,"dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
dev_set_colored (12)
dev_display (Regions)
disp_message (WindowHandle, NumberOfOriginalRegions + ' o...",23,47,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 3, 100)
count_obj (Regions, NumberOfOriginalRegions)
get_system ('store_empty_region', Informati..."
f9fd2d87,full,0,,"read_image (Alpha2, 'alpha2')
dev_set_color ('red')
threshold (Alpha2, Region, 0, 100)
connection (Region, ConnectedRegions)
dev_set_color ('green')
clip_region (ConnectedRegions, RegionClipped, 100, 100, 400, 400)
stop ()
dev_display (Alpha2)
dev_set_color ('red')
dev_display (Region)
dev_set_color...",6,17,
9ab0a457,full,0,This example program shows how to use closest_point_transform.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 610, 610, 'black', WindowHandle)
dev_set_paint (['vector_field', 4, 0, 1])
gen_circle (Circle, 30, 30, 25.5)
closest_point_transform (Circle, Distances, ClosestPoints, 'euclidean', 'true', 'relative', 61, 61)
dev_clear_window ()
dev_set_pa...",7,21,
9ab0a457,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 610, 610, 'black', WindowHandle)",6,9,
9ab0a457,micro,2,,"dev_set_paint (['vector_field', 4, 0, 1])
gen_circle (Circle, 30, 30, 25.5)
closest_point_transform (Circle, Distances, ClosestPoints, 'euclidean', 'true', 'relative', 61, 61)
dev_clear_window ()
dev_set_part (0, 0, 60, 60)
dev_display (Distances)
dev_set_draw ('margin')
dev_set_color ('green')
dev_...",10,27,
78010e7d,full,0,,"read_image (Image, 'mreut')
threshold (Image, Region, 190, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 1000000)
fill_up (SelectedRegions, RegionFillUp)
dev_set_color ('red')
dev_display (Image)
dev_display (RegionFillUp)",6,13,
824a76ff,full,0,"This program simulates a printed circuit board
and inspects it for defects.","dev_close_window ()
dev_open_window (0, 0, 400, 400, 'black', WindowHandle)
gen_region_polygon (Line1, [300, 300, 200, 0], [0, 200, 300, 300])
gen_region_polygon (Line2, [350, 350, 250, 0], [0, 250, 350, 350])
union2 (Line1, Line2, Lines)
dilation_circle (Lines, ThickLines, 7.5)
gen_circle (Error1, ...",8,46,
824a76ff,micro,1,and inspects it for defects.,"dev_close_window ()
dev_open_window (0, 0, 400, 400, 'black', WindowHandle)
gen_region_polygon (Line1, [300, 300, 200, 0], [0, 200, 300, 300])
gen_region_polygon (Line2, [350, 350, 250, 0], [0, 250, 350, 350])
union2 (Line1, Line2, Lines)
dilation_circle (Lines, ThickLines, 7.5)
gen_circle (Error1, ...",6,52,
db3ebcb0,full,0,,"Size := 500
dev_close_window ()
dev_open_window (0, 0, Size, Size, 'black', WindowHandle)
dev_set_part (0, 0, Size - 1, Size - 1)
draw_region (Region, WindowHandle)
distance_transform (Region, DTCityBlockFG, 'city-block', 'true', Size, Size)
distance_transform (Region, DTChessboardFG, 'chessboard', ...",6,20,
e3267f88,full,0,,"Size := 100
dev_close_window ()
dev_open_window (0, 0, Size * 5, Size * 5, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, Size - 1, Size - 1)
gen_region_points (Region, 50, 50)
distance_transform (Region, DTCircleCityBlock, 'city-block', 'fals...",6,73,
a7ec9ee2,full,0,Eliminate runs of a region of a given length.,"read_image (Die2, 'die/die_02')
dev_close_window ()
get_image_size (Die2, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
threshold (Die2, Region, 0, 60)
gen_circle (Circle, 200, 200, 15.5)
eliminate_runs (Circle, CircleRed, 14, 1000)
opening (Region, Circle, RegionOpening1)
...",8,23,
a7ec9ee2,micro,1,,"read_image (Die2, 'die/die_02')
dev_close_window ()
get_image_size (Die2, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
threshold (Die2, Region, 0, 60)
gen_circle (Circle, 200, 200, 15.5)
eliminate_runs (Circle, CircleRed, 14, 1000)
opening (Region, Circle, RegionOpening1)",6,15,
a7ec9ee2,micro,2,,"opening (Region, CircleRed, RegionOpening2)
dev_display (Die2)
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (RegionOpening1)
dev_set_color ('green')
dev_display (RegionOpening2)",16,29,"* --- Automatically Added Context ---
read_image (Die2, 'die/die_02')
threshold (Die2, Region, 0, 60)
eliminate_runs (Circle, CircleRed, 14, 1000)
opening (Region, Circle, RegionOpening1)
* --- End of..."
7ee54c14,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 3, 1000)
gen_empty_region (NoPixel)
expand_region (Regions, NoPixel, RegionExpanded1, 'maximal', 'image')
dev_display (Image)
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (RegionExpanded1)
stop ()
dev_clear_window ()
dilati...",6,20,
0d89d090,full,0,,"read_image (Aegyt1, 'egypt1')
threshold (Aegyt1, Region, 0, 140)
fill_up (Region, RegionFillUp)
difference (RegionFillUp, Region, Holes)
dev_display (Aegyt1)
dev_set_draw ('margin')
dev_set_color ('red')
dev_display (RegionFillUp)
dev_set_color ('green')
dev_display (Holes)",6,15,
3f4046ab,full,0,Fill up holes in regions having given shape features,"read_image (Caltab, 'caltab')
threshold (Caltab, Region, 120, 255)
fill_up_shape (Region, RegionFillUp, 'anisometry', 1, 1.6)
difference (RegionFillUp, Region, Holes)
connection (RegionFillUp, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions1, 'area', 'and', 10000, 1000000)
select_s...",8,23,
3f4046ab,micro,1,,"read_image (Caltab, 'caltab')
threshold (Caltab, Region, 120, 255)
fill_up_shape (Region, RegionFillUp, 'anisometry', 1, 1.6)
difference (RegionFillUp, Region, Holes)
connection (RegionFillUp, ConnectedRegions)",6,12,
3f4046ab,micro,2,,"select_shape (ConnectedRegions, SelectedRegions1, 'area', 'and', 10000, 1000000)
select_shape (SelectedRegions1, SelectedRegions2, 'convexity', 'and', 0.9, 1)",13,15,"* --- Automatically Added Context ---
connection (RegionFillUp, ConnectedRegions)
* --- End of Automatically Added Context ---"
3f4046ab,micro,3,,"dev_display (Caltab)
dev_set_color ('red')
dev_set_draw ('margin')
dev_display (SelectedRegions2)
stop ()
dev_set_color ('green')
dev_display (Holes)",16,29,"* --- Automatically Added Context ---
read_image (Caltab, 'caltab')
difference (RegionFillUp, Region, Holes)
select_shape (SelectedRegions1, SelectedRegions2, 'convexity', 'and', 0.9, 1)
* --- End of ..."
ca01dee1,full,0,,"read_image (Alpha1, 'alpha1')
get_image_size (Alpha1, Width, Height)
mean_image (Alpha1, ImageMean, 21, 21)
dyn_threshold (Alpha1, ImageMean, Dark, 5, 'dark')
connection (Dark, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 50, 1000)
opening_rectangle1 (SelectedReg...",6,33,
8ee2cec0,full,0,,"read_image (Image, 'monkey')
get_system ('max_connection', Information)
set_system ('max_connection', 0)
threshold (Image, Region, 128, 255)
connection (Region, ConnectedRegions)
count_obj (ConnectedRegions, NumConnected)
set_system ('max_connection', 1000)
connection (Region, ConnectedRegionsMax)
c...",6,15,
f877bd93,full,0,,"read_image (Bottle2, 'bottle2')
threshold (Bottle2, Region, 0, 90)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 1000, 10000)
partition_dynamic (SelectedRegions, Partitioned, 30, 30)
dev_display (Bottle2)
dev_set_colored (12)
dev_display (Parti...",6,13,
e06a934f,full,0,,"read_image (Bottle2, 'bottle2')
threshold (Bottle2, Region, 0, 90)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 1000, 10000)
partition_rectangle (SelectedRegions, Partitioned, 30, 100)
dev_display (Bottle2)
dev_set_colored (12)
dev_display (Pa...",6,13,
7246c0fc,full,0,Rank operator for regions,"read_image (Image, 'combine')
threshold (Image, Region, 170, 255)
Width := 81
Height := 81
rank_region (Region, RegionCount, Width, Height, 1000)
dev_display (Image)
dev_set_color ('red')
dev_set_draw ('fill')
dev_display (Region)
dev_set_color ('green')
dev_set_draw ('margin')
dev_display (RegionCo...",8,19,
7246c0fc,micro,1,,"read_image (Image, 'combine')
threshold (Image, Region, 170, 255)
Width := 81
Height := 81
rank_region (Region, RegionCount, Width, Height, 1000)
dev_display (Image)
dev_set_color ('red')
dev_set_draw ('fill')
dev_display (Region)
dev_set_color ('green')
dev_set_draw ('margin')
dev_display (RegionCo...",6,25,
5eb62959,full,0,"Remove noise from a region
Create noisy image.","read_image (Image, 'printer_chip/printer_chip_01')
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
sp_distribution (0.05, 0, Distribution)
add_noise_distribution (Image, ImageNoise, Distribution)
dev_display (ImageNoise)
stop ()
threshold (ImageNoise, Region, 128, 255)
stop ()
remove_noise_region ...",10,25,
5eb62959,micro,1,,"read_image (Image, 'printer_chip/printer_chip_01')
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
sp_distribution (0.05, 0, Distribution)
add_noise_distribution (Image, ImageNoise, Distribution)
dev_display (ImageNoise)
stop ()",9,16,
5eb62959,micro,2,,"threshold (ImageNoise, Region, 128, 255)
stop ()",17,20,"* --- Automatically Added Context ---
add_noise_distribution (Image, ImageNoise, Distribution)
* --- End of Automatically Added Context ---"
5eb62959,micro,3,,"remove_noise_region (Region, OutputRegion, 'n_4')
dev_display (Image)
dev_display (OutputRegion)",21,32,"* --- Automatically Added Context ---
read_image (Image, 'printer_chip/printer_chip_01')
threshold (ImageNoise, Region, 128, 255)
* --- End of Automatically Added Context ---"
5b4f5747,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 3, 100)
dev_set_draw ('margin')
dev_set_colored (6)
dev_clear_window ()
dev_display (Regions)
stop ()
shape_trans (Regions, RegionTrans, 'convex')
dev_clear_window ()
dev_display (RegionTrans)
stop ()
shape_trans (Regions, RegionTrans...",6,39,
f00eafe1,full,0,,"read_image (Image, 'mreut')
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 7)
threshold (EdgeAmplitude, Edges, 40, 255)
skeleton (Edges, Skeleton)
dev_display (Image)
dev_set_color ('red')
dev_display (Skeleton)",6,12,
a59b076c,full,0,,"read_image (Image, 'alpha2')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
mean_image (Image, ImageMean, 21, 21)
dyn_threshold (Image, ImageMean, RegionDynThresh, 5, 'dark')
connection (RegionDynThresh, ConnectedRegions)
select_sha...",6,36,
5e9e1533,full,0,,"read_image (Image, 'mreut')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 7)
threshold (EdgeAmplitude, Edges, 40, 255)
skeleton (Edges, Skeleton)
junctions_skeleton (Skeleton, EndPoints, JuncPoints)
difference (Skeleton, JuncPoint...",6,18,
177e8dff,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
edges_image (Image, ImaAmp, ImaDir, 'lanser2', 0.5, 'nms', 8, 16)
threshold (ImaAmp, Region, 8, 255)
skeleton (Region, Skeleton)
junctio...",6,21,
3ba71c5f,full,0,,"read_image (Image, 'mreut')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowID)
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 7)
threshold (EdgeAmplitude, Edges, 40, 255)
skeleton (Edges, Skeleton)
junctions_skeleton (Skeleton, EndPoints, JuncPoints)
difference (Skeleton, JuncPoint...",6,18,
b9d7450f,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
edges_image (Image, ImaAmp, ImaDir, 'lanser2', 0.5, 'nms', 8, 16)
threshold (ImaAmp, Region, 8, 255)
skeleton (Region, Skeleton)
junctio...",6,21,
42ee3a72,full,0,"This example program shows how to segment an RGB image with a GMM
classifier.  The classifier is tra...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",9,56,
42ee3a72,micro,1,"classifier.  The classifier is trained with four different colors.  In contrast to
other classifiers...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",6,18,
42ee3a72,micro,2,,"gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400], [350, 375], [-0.56, -0.75], [64, 104], [26, 11])
union1 (Deck, Deck)
gen_rectangle1 (Walls, 355, 623, 420, 702)
gen_rectangle2 (Chimney, 286, 623, -0.56, 64, 33)
concat_obj (Sea, Deck, Classes)
concat_obj (Classes, Walls, Class...",19,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
* --- End of Automatically Added Co..."
42ee3a72,micro,3,,"create_class_gmm (3, 4, [1, 10], 'full', 'none', 2, 42, GMMHandle)
add_samples_image_class_gmm (Image, Classes, GMMHandle, 2.0)
dev_display (Image)
Message := 'Training ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",40,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
Message := 'Training regions for the color cl..."
42ee3a72,micro,4,,"train_class_gmm (GMMHandle, 500, 1e-4, 'uniform', 1e-4, Centers, Iter)
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",46,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
create_class_gmm (3, 4, [1, 10], 'full', 'none', 2,..."
42ee3a72,micro,5,,"classify_image_class_gmm (Image, ClassRegions, GMMHandle, 0.0001)
region_to_mean (ClassRegions, Image, ImageClass)
dev_display (ImageClass)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",51,63,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
create_class_gmm (3, 4..."
361c71fe,full,0,"This example program shows how to segment an RGB image with a k-NN
classifier.  The classifier is tr...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",13,103,
361c71fe,micro,1,"classifier.  The classifier is trained with four different colors.  Note that the
resulting classifi...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",6,22,
361c71fe,micro,2,,"gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400], [350, 375], [-0.56, -0.75], [64, 104], [26, 11])
union1 (Deck, Deck)
gen_rectangle1 (Walls, 355, 623, 420, 702)
gen_rectangle2 (Chimney, 286, 623, -0.56, 64, 33)
concat_obj (Sea, Deck, Classes)
concat_obj (Classes, Walls, Class...",23,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
* --- End of Automatically Added Co..."
361c71fe,micro,3,,"create_class_knn (3, KNNHandle)
add_samples_image_class_knn (Image, Classes, KNNHandle)
dev_display (Image)
Message := 'Training ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",44,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
Message := 'Training regions for the color cl..."
361c71fe,micro,4,,"train_class_knn (KNNHandle, [], [])
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",50,54,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
create_class_knn (3, KNNHandle)
* --- End of Automa..."
361c71fe,micro,5,,"classify_image_class_knn (Image, ClassRegions, DistanceImage, KNNHandle, 255.0 * 255.0)
region_to_mean (ClassRegions, Image, ImageClass)
dev_display (ImageClass)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (Window...",55,62,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
create_class_knn (3, K..."
361c71fe,micro,6,"and the door are unintentionally assigned to one of the four trained classes, we
will construct an e...","gen_rectangle2 (Rejection, [193, 66, 261], [235, 332, 328], [-0.32, -1.45, -1.51], [33, 34, 60], [4, 3, 3])
union1 (Rejection, Rejection)
concat_obj (Classes, Rejection, Classes)
dev_display (Image)
dev_set_color (Color[0])
dev_display (Deck)
dev_set_color (Color[1])
dev_display (Sea)
dev_set_color ...",63,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
gen_re..."
361c71fe,micro,7,,"create_class_knn (3, KNNHandle)
add_samples_image_class_knn (Image, Classes, KNNHandle)",85,87,"* --- Automatically Added Context ---
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
create_class_knn (3, KNNHandle)
* --- End of Automatically Added Context ---"
361c71fe,micro,8,,"Message := 'Training the classifier with rejection class...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
train_class_knn (KNNHandle, [], [])
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHandle, Message, 'window'...",88,94,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
Message[1] := 'Segment image using the classifier ...."
361c71fe,micro,9,,"classify_image_class_knn (Image, ClassRegionsNotRejected, DistanceImage1, KNNHandle, 255.0 * 255.0)",95,96,"* --- Automatically Added Context ---
read_image (Image, 'patras')
create_class_knn (3, KNNHandle)
* --- End of Automatically Added Context ---"
361c71fe,micro,10,,"copy_obj (ClassRegionsNotRejected, ClassRegionsNotRejected, 1, 4)",97,98,"* --- Automatically Added Context ---
classify_image_class_knn (Image, ClassRegionsNotRejected, DistanceImage1, KNNHandle, 255.0 * 255.0)
* --- End of Automatically Added Context ---"
361c71fe,micro,11,,"region_to_mean (ClassRegionsNotRejected, Image, ImageClassNotRejected)
dev_display (ImageClassNotRejected)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",99,109,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
classify_image_class_k..."
8b7e9c6e,full,0,"This example shows the time needed to segment an RGB image
with the classifiers MLP, SVM, and GMM in...","dev_update_off ()
dev_close_window ()
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colored (6)
dev_set_window (WindowHandleL)
dev_display (Image)
set_display_fon...",11,284,
8b7e9c6e,micro,1,"with the classifiers MLP, SVM, and GMM in comparison to the
look-up table classifier (LUT) based on ...","dev_update_off ()
dev_close_window ()
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
dev_set_draw ('margin')
dev_set_line_width (3)
dev_set_colored (6)
dev_set_window (WindowHandleL)
dev_display (Image)",6,21,
8b7e9c6e,micro,2,four classes,"set_display_font (WindowHandleL, 14, 'mono', 'true', 'false')
gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400], [350, 375], [-0.56, -0.75], [64, 104], [26, 11])
union1 (Deck, Deck)
gen_rectangle1 (Walls, 355, 623, 420, 702)
gen_rectangle2 (Chimney, 286, 623, -0.56, 64, 33)
con...",22,38,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
* --- End of Automatically Added Context ---"
8b7e9c6e,micro,3,,"create_class_mlp (3, 3, 4, 'softmax', 'principal_components', 3, 42, MLPHandle)
add_samples_image_class_mlp (Image, Classes, MLPHandle)
dev_display_rois (Image, Deck, Sea, Walls, Chimney)
disp_message (WindowHandleL, 'Training MLP classifier...', 'window', 12, 12, 'black', 'true')
train_class_mlp (M...",39,45,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400]..."
8b7e9c6e,micro,4,,"dev_display (Image)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'window', 12, 12, 'black', 'true')
count_seconds (Start1)
create_class_lut_mlp (MLPHandle, [], [], ClassLUTHandle)
count_seconds (End1)
TimeLUTCreateMLP := End1 - Start1
dev_display (Image)
disp_message (WindowH...",46,57,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
create_class_mlp (3, 3, 4, 'softmax', 'principal_components', 3, 42, ML..."
8b7e9c6e,micro,5,,"count_seconds (Start2)
for Index := 1 to 100 by 1
classify_image_class_lut (Image, ClassRegionsLUT, ClassLUTHandle)
endfor
count_seconds (End2)
TimeLUTClassifyMLP := 1000 * (End2 - Start2) / 100
region_to_mean (ClassRegionsLUT, Image, ImageClassLUTbyMLP)
dev_display (ImageClassLUTbyMLP)
disp_message...",58,68,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,6,,"dev_open_and_init_second_window (Image, Width, Height, WindowHandleR)
count_seconds (Start2)
classify_image_class_mlp (Image, ClassRegionsMLP, MLPHandle, 0.5)
count_seconds (End2)
TimeMLPClassify := 1000 * (End2 - Start2)
region_to_mean (ClassRegionsMLP, Image, ImageClassMLP)
dev_display (ImageClass...",69,82,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
create_class_mlp (3, 3, 4, 'softm..."
8b7e9c6e,micro,7,,"dev_close_window ()
dev_set_window (WindowHandleL)",83,86,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
* --- End of Automatically Added Context ---"
8b7e9c6e,micro,8,,"create_class_svm (3, 'rbf', 0.1, 0.0005, 4, 'one-versus-all', 'principal_components', 3, SVMHandle)
add_samples_image_class_svm (Image, Classes, SVMHandle)
dev_display_rois (Image, Deck, Sea, Walls, Chimney)
disp_message (WindowHandleL, 'Training SVM classifier...', 'window', 12, 12, 'black', 'true'...",87,93,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400]..."
8b7e9c6e,micro,9,,"dev_display (Image)
disp_message (WindowHandleL, 'Creating SVM-based LUT classifier...', 'window', 12, 12, 'black', 'true')
count_seconds (Start1)
create_class_lut_svm (SVMHandle, [], [], ClassLUTHandle)
count_seconds (End1)
TimeLUTCreateSVM := End1 - Start1
dev_display (Image)
disp_message (WindowH...",94,105,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,10,,"count_seconds (Start2)
for Index := 1 to 100 by 1
classify_image_class_lut (Image, ClassRegionsLUT, ClassLUTHandle)
endfor
count_seconds (End2)
TimeLUTClassifySVM := 1000 * (End2 - Start2) / 100
region_to_mean (ClassRegionsLUT, Image, ImageClassLUTbySVM)
dev_display (ImageClassLUTbySVM)
disp_message...",106,116,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,11,,"dev_open_and_init_second_window (Image, Width, Height, WindowHandleR)
count_seconds (Start2)
classify_image_class_svm (Image, ClassRegionsSVM, SVMHandle)
count_seconds (End2)
TimeSVMClassify := 1000 * (End2 - Start2)
region_to_mean (ClassRegionsSVM, Image, ImageClassSVM)
dev_display (ImageClassSVM)
...",117,130,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Res..."
8b7e9c6e,micro,12,,"create_class_gmm (3, 4, [1, 10], 'full', 'none', 3, 42, GMMHandle)
add_samples_image_class_gmm (Image, Classes, GMMHandle, 2.0)
dev_display_rois (Image, Deck, Sea, Walls, Chimney)
disp_message (WindowHandleL, 'Training GMM classifier...', 'window', 12, 12, 'black', 'true')
train_class_gmm (GMMHandle...",135,141,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400]..."
8b7e9c6e,micro,13,,"dev_display (Image)
disp_message (WindowHandleL, 'Creating GMM-based LUT classifier...', 'window', 12, 12, 'black', 'true')
count_seconds (Start1)
create_class_lut_gmm (GMMHandle, [], [], ClassLUTHandle)
count_seconds (End1)
TimeLUTCreateGMM := End1 - Start1
dev_display (Image)
disp_message (WindowH...",142,153,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,14,,"count_seconds (Start2)
for Index := 1 to 100 by 1
classify_image_class_lut (Image, ClassRegionsLUT, ClassLUTHandle)
endfor
count_seconds (End2)
TimeLUTClassifyGMM := 1000 * (End2 - Start2) / 100
region_to_mean (ClassRegionsLUT, Image, ImageClassLUTbyGMM)
dev_display (ImageClassLUTbyGMM)
disp_message...",154,164,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,15,,"dev_open_and_init_second_window (Image, Width, Height, WindowHandleR)
count_seconds (Start2)
classify_image_class_gmm (Image, ClassRegionsGMM, GMMHandle, 0.0001)
count_seconds (End2)
TimeGMMClassify := 1000 * (End2 - Start2)
region_to_mean (ClassRegionsGMM, Image, ImageClassGMM)
dev_display (ImageCl...",165,178,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Res..."
8b7e9c6e,micro,16,,"create_class_knn (3, KNNHandle)
add_samples_image_class_knn (Image, Classes, KNNHandle)
dev_display_rois (Image, Deck, Sea, Walls, Chimney)
disp_message (WindowHandleL, 'Training k-NN classifier...', 'window', 12, 12, 'black', 'true')
train_class_knn (KNNHandle, [], [])",183,189,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400]..."
8b7e9c6e,micro,17,,"dev_display (Image)
disp_message (WindowHandleL, 'Creating k-NN-based LUT classifier. This may take a while...', 'window', 12, 12, 'black', 'true')
count_seconds (Start1)
create_class_lut_knn (KNNHandle, [], [], ClassLUTHandle)
count_seconds (End1)
TimeLUTCreateKNN := End1 - Start1
dev_display (Imag...",190,201,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,18,,"count_seconds (Start2)
for Index := 1 to 100 by 1
classify_image_class_lut (Image, ClassRegionsLUT, ClassLUTHandle)
endfor
count_seconds (End2)
TimeLUTClassifyKNN := 1000 * (End2 - Start2) / 100
region_to_mean (ClassRegionsLUT, Image, ImageClassLUTbyKNN)
dev_display (ImageClassLUTbyKNN)
disp_message...",202,212,"* --- Automatically Added Context ---
read_image (Image, 'patras')
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Creating MLP-based LUT classifier...', 'w..."
8b7e9c6e,micro,19,,"dev_open_and_init_second_window (Image, Width, Height, WindowHandleR)
count_seconds (Start2)
classify_image_class_knn (Image, ClassRegionsKNN, DistanceImageKNN, KNNHandle, 5)
count_seconds (End2)
TimeKNNClassify := 1000 * (End2 - Start2)
region_to_mean (ClassRegionsKNN, Image, ImageClassKNN)
dev_dis...",213,226,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
disp_message (WindowHandleL, 'Res..."
8b7e9c6e,micro,20,,"disp_end_of_program_message (WindowHandleL, 'black', 'true')
dev_display (Image)
dev_set_color ('indian red')
dev_display (Deck)
dev_set_color ('cornflower blue')
dev_display (Sea)
dev_set_color ('white')
dev_display (Walls)
dev_set_color ('black')
dev_display (Chimney)
return ()
dev_open_window (0,...",227,295,"* --- Automatically Added Context ---
read_image (Image, 'patras')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleL)
gen_rectangle1 (Sea, 10, 10, 120,..."
395edbf7,full,0,"This example program shows how to segment an RGB image with an MLP
classifier.  The classifier is tr...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",13,103,
395edbf7,micro,1,"classifier.  The classifier is trained with four different colors.  Note that the
resulting classifi...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",6,22,
395edbf7,micro,2,,"gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400], [350, 375], [-0.56, -0.75], [64, 104], [26, 11])
union1 (Deck, Deck)
gen_rectangle1 (Walls, 355, 623, 420, 702)
gen_rectangle2 (Chimney, 286, 623, -0.56, 64, 33)
concat_obj (Sea, Deck, Classes)
concat_obj (Classes, Walls, Class...",23,43,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
* --- End of Automatically Added Co..."
395edbf7,micro,3,,"create_class_mlp (3, 3, 4, 'softmax', 'principal_components', 3, 42, MLPHandle)
add_samples_image_class_mlp (Image, Classes, MLPHandle)
dev_display (Image)
Message := 'Training ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",44,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
Message := 'Training regions for the color cl..."
395edbf7,micro,4,,"train_class_mlp (MLPHandle, 200, 1, 0.01, Error, ErrorLog)
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",50,54,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
create_class_mlp (3, 3, 4, 'softmax', 'principal_co..."
395edbf7,micro,5,,"classify_image_class_mlp (Image, ClassRegions, MLPHandle, 0.5)
region_to_mean (ClassRegions, Image, ImageClass)
dev_display (ImageClass)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
...",55,62,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
create_class_mlp (3, 3..."
395edbf7,micro,6,"and the door are unintentionally assigned to one of the four trained classes, we
will construct an e...","gen_rectangle2 (Rejection, [193, 66, 261], [235, 332, 328], [-0.32, -1.45, -1.51], [33, 34, 60], [4, 3, 3])
union1 (Rejection, Rejection)
concat_obj (Classes, Rejection, Classes)
dev_display (Image)
dev_set_color (Color[0])
dev_display (Deck)
dev_set_color (Color[1])
dev_display (Sea)
dev_set_color ...",63,84,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
gen_re..."
395edbf7,micro,7,,"create_class_mlp (3, 4, 5, 'softmax', 'principal_components', 3, 42, MLPHandle)
add_samples_image_class_mlp (Image, Classes, MLPHandle)",85,87,"* --- Automatically Added Context ---
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
create_class_mlp (3, 3, 4, 'softmax', 'principal_components', 3, 42, MLPHandle)
* --- End of Automati..."
395edbf7,micro,8,,"Message := 'Training the classifier with rejection class...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
train_class_mlp (MLPHandle, 200, 1, 0.01, Error, ErrorLog)
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHa...",88,94,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
create_class_mlp (3, 3, 4, 'softmax', 'principal_co..."
395edbf7,micro,9,,"classify_image_class_mlp (Image, ClassRegionsNotRejected, MLPHandle, 0.5)",95,96,"* --- Automatically Added Context ---
read_image (Image, 'patras')
create_class_mlp (3, 3, 4, 'softmax', 'principal_components', 3, 42, MLPHandle)
* --- End of Automatically Added Context ---"
395edbf7,micro,10,,"copy_obj (ClassRegionsNotRejected, ClassRegionsNotRejected, 1, 4)",97,98,"* --- Automatically Added Context ---
classify_image_class_mlp (Image, ClassRegionsNotRejected, MLPHandle, 0.5)
* --- End of Automatically Added Context ---"
395edbf7,micro,11,,"region_to_mean (ClassRegionsNotRejected, Image, ImageClassNotRejected)
dev_display (ImageClassNotRejected)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",99,109,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
classify_image_class_m..."
e691e65e,full,0,"This example program shows how to segment an RGB image with a SVM
classifier.  The classifier is tra...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",8,55,
e691e65e,micro,1,classifier.  The classifier is trained with four different colors.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_draw ('margin')
dev_set_colored (6)
dev_set_line_width (3)
read_image (Image, 'patras')
dev_display (Image)
Color := ['indian red', 'corn...",6,17,
e691e65e,micro,2,,"gen_rectangle1 (Sea, 10, 10, 120, 270)
gen_rectangle2 (Deck, [170, 400], [350, 375], [-0.56, -0.75], [64, 104], [26, 11])
union1 (Deck, Deck)
gen_rectangle1 (Walls, 355, 623, 420, 702)
gen_rectangle2 (Chimney, 286, 623, -0.56, 64, 33)
concat_obj (Sea, Deck, Classes)
concat_obj (Classes, Walls, Class...",18,38,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Color := ['indian red', 'cornflower blue', 'white', 'black', 'yellow']
* --- End of Automatically Added Co..."
e691e65e,micro,3,,"create_class_svm (3, 'rbf', 0.1, 0.0005, 4, 'one-versus-all', 'normalization', 3, SVMHandle)
add_samples_image_class_svm (Image, Classes, SVMHandle)
dev_display (Image)
Message := 'Training ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",39,44,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
concat_obj (Sea, Deck, Classes)
Message := 'Training regions for the color cl..."
e691e65e,micro,4,,"train_class_svm (SVMHandle, 0.001, 'default')
Message := Message + ' ready.'
Message[1] := 'Segment image using the classifier ...'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",45,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
Message := 'Training regions for the color classifier'
create_class_svm (3, 'rbf', 0.1, 0.0005, 4, 'one-ve..."
e691e65e,micro,5,,"classify_image_class_svm (Image, ClassRegions, SVMHandle)
region_to_mean (ClassRegions, Image, ImageClass)
dev_display (ImageClass)
Message[1] := Message[1] + ' ready.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",50,61,"* --- Automatically Added Context ---
dev_open_window (0, 0, 735, 485, 'black', WindowHandle)
read_image (Image, 'patras')
Message := 'Training regions for the color classifier'
create_class_svm (3, '..."
6bb53306,full,0,"Segment an image using two-dimensional pixel classification.
For interactive mode set this variable ...","Interactive := 0
read_image (Image, 'ic')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
decompose3 (Image, Red, Green, Blue)
dev_display (Red)
dev_set_color ('red')
if (Interactive)
draw_region (Pattern, WindowID)
else
gen_rectangl...",9,31,
6bb53306,micro,1,,"Interactive := 0
read_image (Image, 'ic')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)",8,13,
6bb53306,micro,2,,"decompose3 (Image, Red, Green, Blue)
dev_display (Red)
dev_set_color ('red')
if (Interactive)
draw_region (Pattern, WindowID)
else
gen_rectangle1 (Pattern, 362, 276, 371, 298)
endif",14,22,"* --- Automatically Added Context ---
Interactive := 0
read_image (Image, 'ic')
dev_open_window (0, 0, Width, Height, 'white', WindowID)
* --- End of Automatically Added Context ---"
6bb53306,micro,3,,"histo_2dim (Pattern, Red, Blue, Histo2Dim)
threshold (Histo2Dim, Features, 1, 255)",23,25,"* --- Automatically Added Context ---
decompose3 (Image, Red, Green, Blue)
draw_region (Pattern, WindowID)
* --- End of Automatically Added Context ---"
6bb53306,micro,4,,"closing_circle (Features, FeaturesClosed, 11.5)
dev_set_draw ('fill')
dev_set_part (0, 0, 511, 511)
dev_display (Red)
class_2dim_sup (Red, Blue, FeaturesClosed, RegionClass2Dim)",26,37,"* --- Automatically Added Context ---
decompose3 (Image, Red, Green, Blue)
threshold (Histo2Dim, Features, 1, 255)
* --- End of Automatically Added Context ---"
fd3d5ce0,full,0,,"read_image (Image, 'patras')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
decompose3 (Image, Red, Green, Blue)
dev_display (Red)
dev_set_draw ('fill')
dev_set_colored (6)
dev_display (Red)
median_image (Red, RedMedian, 'square', 5...",6,17,
4f33add3,full,0,,"read_image (Image, 'ic')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_color ('red')
gen_rectangle1 (Region, 360, 198, 369, 226)
gen_empty_region (EmptyRegion)
learn_ndim_norm (Region, EmptyRegion, Image...",6,18,
cfdb1530,full,0,"This example program shows you how to use the GMM classifier for novelty
detection to perform a web ...","dev_update_off ()
ReadPretrainedClassifier := false
* ReadPretrainedClassifier := true
SaveClassifier := false
* SaveClassifier := true
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHa...",13,126,
cfdb1530,micro,1,"detection to perform a web inspection task.  To perform the novelty detection,
all pixels belonging ...","dev_update_off ()
ReadPretrainedClassifier := false",6,15,
cfdb1530,micro,2,disk. The training may last up to half a minute.,"* ReadPretrainedClassifier := true
SaveClassifier := false",16,19,"* --- Automatically Added Context ---
ReadPretrainedClassifier := false
* --- End of Automatically Added Context ---"
cfdb1530,micro,3,,"* SaveClassifier := true
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_system ('example_d...",20,29,"* --- Automatically Added Context ---
SaveClassifier := false
* --- End of Automatically Added Context ---"
cfdb1530,micro,4,"borders because the images of the plastic mesh to be inspected do not
contain an integer number of m...","gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11, Width / 2 - 11)
if (ReadPretrainedClassifier)
dev_display (Image)
disp_message (WindowHandle, 'Reading classifier from disk...', 'window', 10, 10, 'black', 'true')
read_class_gmm (HalconExamples + '/hdevelop/Segmentation/Classification/novelty_dete...",30,66,"* --- Automatically Added Context ---
ReadPretrainedClassifier := false
SaveClassifier := false
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_open_window..."
cfdb1530,micro,5,,"dev_set_draw ('margin')
dev_set_line_width (3)
for J := 1 to 14 by 1
read_image (Image, 'plastic_mesh/plastic_mesh_' + J$'02')
zoom_image_factor (Image, ImageZoomed, 0.5, 0.5, 'constant')
dev_display (ImageZoomed)
dev_set_color ('white')
dev_display (Rectangle)
gen_texture_image (ImageZoomed, ImageT...",67,115,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11..."
cfdb1530,micro,6,"five different Laws filters, which basically correspond to first and second
derivatives, and smoothi...","texture_laws (Image, ImageEL, 'el', 5, 5)
texture_laws (Image, ImageLE, 'le', 5, 5)
texture_laws (Image, ImageES, 'es', 1, 5)
texture_laws (Image, ImageSE, 'se', 1, 5)
texture_laws (Image, ImageEE, 'ee', 2, 5)
compose5 (ImageEL, ImageLE, ImageES, ImageSE, ImageEE, ImageLaws)
smooth_image (ImageLaws,...",116,135,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
gen_texture_image (ImageZoomed, ImageTexture)
* --- End of Automatically Added Context ---"
371c6635,full,0,"This example program shows how to use the MLP classifier for novelty
detection to perform a web insp...","dev_update_off ()
ReadPretrainedClassifier := false
* ReadPretrainedClassifier := true
SaveClassifier := false
* SaveClassifier := true
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHa...",12,131,
371c6635,micro,1,"detection to perform a web inspection task.  To perform the novelty detection,
a rejection class is ...","dev_update_off ()
ReadPretrainedClassifier := false",6,14,
371c6635,micro,2,disk. The training may last up to half a minute.,"* ReadPretrainedClassifier := true
SaveClassifier := false",15,18,"* --- Automatically Added Context ---
ReadPretrainedClassifier := false
* --- End of Automatically Added Context ---"
371c6635,micro,3,,"* SaveClassifier := true
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_system ('example_d...",19,28,"* --- Automatically Added Context ---
SaveClassifier := false
* --- End of Automatically Added Context ---"
371c6635,micro,4,"borders because the images of the plastic mesh to be inspected do not
contain an integer number of m...","gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11, Width / 2 - 11)
if (ReadPretrainedClassifier)
dev_display (Image)
disp_message (WindowHandle, 'Reading classifier from disk...', 'window', 10, 10, 'black', 'true')
read_class_mlp (HalconExamples + '/hdevelop/Segmentation/Classification/novelty_dete...",29,70,"* --- Automatically Added Context ---
ReadPretrainedClassifier := false
SaveClassifier := false
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_open_window..."
371c6635,micro,5,,"dev_set_draw ('margin')
dev_set_line_width (3)
for J := 1 to 14 by 1
read_image (Image, 'plastic_mesh/plastic_mesh_' + J$'02')
zoom_image_factor (Image, ImageZoomed, 0.5, 0.5, 'constant')
dev_display (ImageZoomed)
dev_set_color ('white')
dev_display (Rectangle)
gen_texture_image (ImageZoomed, ImageT...",71,120,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11..."
371c6635,micro,6,"five different Laws filters, which basically correspond to first and second
derivatives, and smoothi...","texture_laws (Image, ImageEL, 'el', 5, 5)
texture_laws (Image, ImageLE, 'le', 5, 5)
texture_laws (Image, ImageES, 'es', 1, 5)
texture_laws (Image, ImageSE, 'se', 1, 5)
texture_laws (Image, ImageEE, 'ee', 2, 5)
compose5 (ImageEL, ImageLE, ImageES, ImageSE, ImageEE, ImageLaws)
smooth_image (ImageLaws,...",121,140,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
gen_texture_image (ImageZoomed, ImageTexture)
* --- End of Automatically Added Context ---"
5dc8ee44,full,0,"This example program shows you how to use the novelty detection mode of
the SVM classifier to perfor...","dev_update_off ()
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_rectangle1 (Rectangle, 10...",13,106,
5dc8ee44,micro,1,"the SVM classifier to perform a web inspection task.  The novelty detection
basically classifies fea...","dev_update_off ()
read_image (Image, 'plastic_mesh/plastic_mesh_01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_color ('red')
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,20,
5dc8ee44,micro,2,"borders because the images of the plastic mesh to be inspected do not
contain an integer number of m...","gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11, Width / 2 - 11)",21,27,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
5dc8ee44,micro,3,,"create_class_svm (5, 'rbf', 0.01, 0.0005, 1, 'novelty-detection', 'normalization', 5, SVMHandle)",28,29,
5dc8ee44,micro,4,,"for J := 1 to 5 by 1
read_image (Image, 'plastic_mesh/plastic_mesh_' + J$'02')
zoom_image_factor (Image, ImageZoomed, 0.5, 0.5, 'constant')
dev_display (ImageZoomed)
disp_message (WindowHandle, 'Adding training samples...', 'window', 12, 12, 'black', 'true')
gen_texture_image (ImageZoomed, ImageText...",30,44,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11..."
5dc8ee44,micro,5,,"train_class_svm (SVMHandle, 0.001, 'default')",45,46,"* --- Automatically Added Context ---
create_class_svm (5, 'rbf', 0.01, 0.0005, 1, 'novelty-detection', 'normalization', 5, SVMHandle)
* --- End of Automatically Added Context ---"
5dc8ee44,micro,6,,"reduce_class_svm (SVMHandle, 'bottom_up', 2, 0.001, SVMHandleReduced)",47,48,"* --- Automatically Added Context ---
create_class_svm (5, 'rbf', 0.01, 0.0005, 1, 'novelty-detection', 'normalization', 5, SVMHandle)
* --- End of Automatically Added Context ---"
5dc8ee44,micro,7,,"dev_set_draw ('margin')
dev_set_line_width (3)
for J := 1 to 14 by 1
read_image (Image, 'plastic_mesh/plastic_mesh_' + J$'02')
zoom_image_factor (Image, ImageZoomed, 0.5, 0.5, 'constant')
dev_display (ImageZoomed)
dev_set_color ('white')
dev_display (Rectangle)
gen_texture_image (ImageZoomed, ImageT...",49,95,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gen_rectangle1 (Rectangle, 10, 10, Height / 2 - 11..."
5dc8ee44,micro,8,"five different Laws filters, which basically correspond to first and second
derivatives, and smoothi...","texture_laws (Image, ImageEL, 'el', 5, 5)
texture_laws (Image, ImageLE, 'le', 5, 5)
texture_laws (Image, ImageES, 'es', 1, 5)
texture_laws (Image, ImageSE, 'se', 1, 5)
texture_laws (Image, ImageEE, 'ee', 2, 5)
compose5 (ImageEL, ImageLE, ImageES, ImageSE, ImageEE, ImageLaws)
smooth_image (ImageLaws,...",96,115,"* --- Automatically Added Context ---
read_image (Image, 'plastic_mesh/plastic_mesh_01')
gen_texture_image (ImageZoomed, ImageTexture)
* --- End of Automatically Added Context ---"
0526aef0,full,0,,"read_image (Image, 'fabrik')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_set_color ('red')
sobel_amp (Image, EdgeAmplitude, 'thin_sum_abs', 3)
hysteresis_threshold (EdgeAmplitude, RegionHysteresis, 10, 20, 10)",6,12,
5a6cfe65,full,0,,"read_image (Image, 'fabrik')
sobel_amp (Image, EdgeAmplitude, 'sum_abs', 9)
nonmax_suppression_amp (EdgeAmplitude, ImageResult, 'hvnms')
threshold (ImageResult, Region, 20, 255)",6,9,
a6ed0078,full,0,,"read_image (Image, 'fabrik')
frei_dir (Image, ImageEdgeAmp, ImageEdgeDir)
nonmax_suppression_dir (ImageEdgeAmp, ImageEdgeDir, ImageResult, 'nms')
threshold (ImageResult, Region, 20, 255)
dev_display (Image)
dev_set_color ('green')
dev_display (Region)",6,12,
2482b0bc,full,0,"This example demonstrates the functionality of segment_image_mser.
Create artificial example image.","create_example_image (Image)
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := 'The operator \'segment_image_mser\' extracts'
Message[1] := 'maximally stable ...",9,201,
2482b0bc,micro,1,,"create_example_image (Image)
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
Message := 'The operator \'segment_image_mser\' extracts'
Message[1] := 'maximally stable ...",8,23,
2482b0bc,micro,2,,"segment_image_mser (Image, MSERDark, MSERLight, 'dark', 10, [], 15, [], [])
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'With \'Polarity\' set to \'dark\', the operator extracts'
Message[1] := 'regions which are darker than their background.'
dev_disp_text (Message,...",24,32,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
dev_disp_text..."
2482b0bc,micro,3,,"segment_image_mser (Image, MSERDark, MSERLight, 'light', 10, [], 15, [], [])
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'With \'Polarity\' set to \'light\', the operator extracts'
Message[1] := 'regions which are brighter than their background.'
dev_disp_text (Mess...",33,41,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
dev_disp_text..."
2482b0bc,micro,4,small and too large regions.,"MinArea := 2000
MaxArea := 15000
segment_image_mser (Image, MSERDark, MSERLight, 'both', MinArea, MaxArea, 15, [], [])
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'The parameters \'MinArea\' and \'MaxArea\' can be used to'
Message[1] := 'restrict the size of the ret...",42,55,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
segment_image..."
2482b0bc,micro,5,This reduces the number of regions.,"Delta := 5
segment_image_mser (Image, MSERDark, MSERLight, 'both', 100, [], Delta, [], [])
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'Furthermore, \'Delta\' can be used to regulate'
Message[1] := 'the number of thresholds over which a region needs'
Message[2] := '...",56,69,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
segment_image..."
2482b0bc,micro,6,'max_variation' to a larger value. This increases the number of regions.,"MaxVariation := 1.0
segment_image_mser (Image, MSERDark, MSERLight, 'both', 100, [], Delta, 'max_variation', MaxVariation)
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'The generic parameter \'max_variation\' can be used to'
Message[1] := 'regulate how much a region ...",70,83,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
segment_image..."
2482b0bc,micro,7,'min_diversity' to a larger value. This increases the number of overlapping regions.,"MinDiversity := 5.5
segment_image_mser (Image, MSERDark, MSERLight, 'both', 100, [], Delta, ['max_variation', 'min_diversity'], [MaxVariation,MinDiversity])
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'The generic parameter \'min_diversity\' can be used to'
Message[...",84,96,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
segment_image..."
2482b0bc,micro,8,the generic parameter 'min_gray' and 'max_gray',"MinGray := 50
MaxGray := 210
count_seconds (S1)
segment_image_mser (Image, MSERDark, MSERLight, 'both', 100, [], Delta, ['min_gray', 'max_gray'], [MinGray,MaxGray])
count_seconds (S2)
TimeMinMaxGray := (S2 - S1) * 1000",97,104,"* --- Automatically Added Context ---
create_example_image (Image)
segment_image_mser (Image, MSERDark, MSERLight, 'dark', 10, [], 15, [], [])
Delta := 5
* --- End of Automatically Added Context ---"
2482b0bc,micro,9,,"count_seconds (S1)
segment_image_mser (Image, MSERDark, MSERLight, 'both', 100, [], Delta, [], [])
count_seconds (S2)
Time := (S2 - S1) * 1000
disp_dark_light_results (Image, MSERDark, MSERLight, WindowHandle)
Message := 'The generic parameter \'min_gray\' and \'max_gray\' set the'
Message[1] := 'mi...",105,128,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
Message := 'The operator \'segment_image_mser\' extracts'
segment_image..."
2482b0bc,micro,10,,"gen_image_gray_ramp (Image, 10.0, 0, 128, 325, 300, 600, 600)",129,131,"* --- Automatically Added Context ---
create_example_image (Image)
* --- End of Automatically Added Context ---"
2482b0bc,micro,11,,"Row := [200, 200, 200, 200, 200]
Column := [75:100:550]
Radius := [20:10:60]
Gray1 := [160:-20:80]
gen_circle (Circle, Row, Column, Radius)
overpaint_region (Image, Circle, Gray1, 'fill')",132,138,"* --- Automatically Added Context ---
create_example_image (Image)
* --- End of Automatically Added Context ---"
2482b0bc,micro,12,,"erosion_circle (Circle, CircleEroded13, 13)
Gray1 := [180:-20:100]
overpaint_region (Image, CircleEroded13, Gray1, 'fill')
erosion_circle (Circle, CircleEroded19, 19)
Gray1 := [200:-20:120]
overpaint_region (Image, CircleEroded19, Gray1, 'fill')",139,145,"* --- Automatically Added Context ---
create_example_image (Image)
Gray1 := [160:-20:80]
gen_circle (Circle, Row, Column, Radius)
* --- End of Automatically Added Context ---"
2482b0bc,micro,13,,"union1 (Circle, RegionUnion)
dilation_circle (RegionUnion, RegionDilation, 3.5)
reduce_domain (Image, RegionDilation, ImageReduced)
mean_image (ImageReduced, ImageMean, 11, 11)",146,151,"* --- Automatically Added Context ---
create_example_image (Image)
gen_circle (Circle, Row, Column, Radius)
* --- End of Automatically Added Context ---"
2482b0bc,micro,14,,"Row := [450, 450, 450, 450, 450]
Gray1 := [80:20:160]
gen_circle (Circle, Row, Column, Radius)
overpaint_region (Image, Circle, Gray1, 'fill')",152,156,"* --- Automatically Added Context ---
create_example_image (Image)
Row := [200, 200, 200, 200, 200]
Column := [75:100:550]
Radius := [20:10:60]
Gray1 := [160:-20:80]
gen_circle (Circle, Row, Column, R..."
2482b0bc,micro,15,,"erosion_circle (Circle, CircleEroded13, 13)
Gray1 := [60:20:140]
overpaint_region (Image, CircleEroded13, Gray1, 'fill')
erosion_circle (Circle, CircleEroded19, 19)
Gray1 := [40:20:120]
overpaint_region (Image, CircleEroded19, Gray1, 'fill')",157,163,"* --- Automatically Added Context ---
create_example_image (Image)
Gray1 := [160:-20:80]
erosion_circle (Circle, CircleEroded13, 13)
erosion_circle (Circle, CircleEroded19, 19)
gen_circle (Circle, Row..."
2482b0bc,micro,16,,"union1 (Circle, RegionUnion)
dilation_circle (RegionUnion, RegionDilation, 3.5)
reduce_domain (Image, RegionDilation, ImageReduced)
mean_image (ImageReduced, ImageMean, 11, 11)
add_noise_white (Image, ImageResult, 10)
return ()
dev_set_window (WindowHandle)
dev_display (Image)
dev_set_line_width (3)...",164,212,"* --- Automatically Added Context ---
create_example_image (Image)
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
segment_image_mser (Image, MSERDark, MSERLight, 'dark', 10, [], 15, [],..."
4ebb0f43,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 1, 100)
gen_empty_region (EmptyRegion)
expand_gray (Regions, Image, EmptyRegion, RegionExpand, 'maximal', 'image', 4)",6,10,
b2d56c98,full,0,,"read_image (Image, 'fabrik')
dev_set_colored (6)
regiongrowing (Image, Regions, 1, 1, 1, 100)
gen_empty_region (EmptyRegion)
intensity (Regions, Image, Mean, Deviation)
expand_gray_ref (Regions, Image, EmptyRegion, RegionExpand, 'maximal', 'image', Mean, 11)",6,11,
fe0664d7,full,0,,"read_image (Image, 'mreut')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
median_image (Image, ImageMedian, 'circle', 2, 'mirrored')
regiongrowing (ImageMedian, Regions, 1, 1, 2, 100)
fill_up_shape (Regions, RegionFillUp, 'area', 1...",6,20,
c8037fd9,full,0,,"read_image (Image, 'fabrik')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
median_image (Image, ImageMedian, 'circle', 2, 'mirrored')
regiongrowing (ImageMedian, Regions, 1, 1, 2, 5000)
shape_trans (Regions, Centers, 'inner_center'...",6,22,
de2d67f2,full,0,,"read_image (Image, 'ic')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
median_image (Image, ImageMedian, 'circle', 4, 'mirrored')
* regiongrowing_n (ImageMedian, Regions, '1-...",6,34,
febceca2,full,0,,"dev_close_window ()
read_image (Aegypt1, 'egypt1')
get_image_size (Aegypt1, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_set_colored (6)
dev_clear_window ()
Sigma := 4
auto_threshold (Aegypt1, Regions, Sigma)
gra...",6,26,
48bc876b,full,0,"This example shows how to use the operator binary_threshold.
Init display","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ImageFiles := ['dip_switch/dip_switch_01', 'circular_barcode', 'fin1']
for I := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[I])
dev_...",9,107,
48bc876b,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
ImageFiles := ['dip_switch/dip_switch_01', 'circular_barcode', 'fin1']
for I := 0 to |ImageFiles| - 1 by 1
read_image (Image, ImageFiles[I])
dev_...",8,85,
48bc876b,micro,2,but 'max_separability' is faster in most cases.,"symm_difference (RegionMaxSeparabilityDark, RegionSmoothHistoDark, RegionDifference)",86,88,"* --- Automatically Added Context ---
binary_threshold (Image, RegionMaxSeparabilityDark, 'max_separability', 'dark', UsedThreshold)
binary_threshold (Image, RegionSmoothHistoDark, 'smooth_histo', 'da..."
48bc876b,micro,3,,"dev_display (Image)
dev_display (RegionDifference)
Message := 'The difference of both methods is small'
Message[1] := '- \'max_separability\' is less prone to'
Message[2] := '  undesired effects caused by over- or underexposure'
Message[3] := '- often, \'max_separability\' is faster'
Message[4] := '...",89,100,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
read_image (Image, ImageFiles[I])
Message := 'Test image for binary_threshold'
symm_difference (RegionMaxS..."
48bc876b,micro,4,"The threshold operator with this value returns the same region as
binary_threshold did.","threshold (Image, RegionThreshold, 0, UsedThreshold)",101,105,"* --- Automatically Added Context ---
read_image (Image, ImageFiles[I])
binary_threshold (Image, RegionMaxSeparabilityLight, 'max_separability', 'light', UsedThreshold)
* --- End of Automatically Adde..."
48bc876b,micro,5,,"symm_difference (RegionThreshold, RegionSmoothHistoDark, RegionDifference)",106,113,"* --- Automatically Added Context ---
binary_threshold (Image, RegionSmoothHistoDark, 'smooth_histo', 'dark', UsedThreshold)
symm_difference (RegionMaxSeparabilityDark, RegionSmoothHistoDark, RegionDi..."
eb620cef,full,0,,"dev_close_window ()
read_image (Alpha1, 'alpha1')
get_image_size (Alpha1, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Alpha1)
dev_set_color ('white')
dev_clear_window ()
char_threshold (Alpha1, ...",6,21,
439b8695,full,0,,"dev_close_window ()
read_image (Traffic1, 'traffic1')
read_image (Traffic2, 'traffic2')
get_image_size (Traffic1, Width, Height)
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Traffic1)
dev_set_draw ('mar...",6,40,
439b8695,micro,1,,"disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_display (Traffic2)
dev_set_draw ('margin')
dev_set_color ('yellow')",16,21,"* --- Automatically Added Context ---
read_image (Traffic2, 'traffic2')
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
439b8695,micro,2,,"check_difference (Traffic1, Traffic2, Selected2, 'diff_outside', -255, 15, 0, 0, 0)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",22,25,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
read_image (Traffic2, 'traffic2')
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowHandle)
* --- End of Automaticall..."
439b8695,micro,3,,"hom_mat2d_identity (HomMat2DIdentity)
MoveRow := 10
MoveCol := 15
Add := 10
Noise := 5
hom_mat2d_translate (HomMat2DIdentity, MoveRow, MoveCol, HomMat2DTranslate)
affine_trans_image (Traffic1, Moved1, HomMat2DTranslate, 'constant', 'false')
scale_image (Moved1, MovedScaled1, 1, Add)
add_noise_white ...",26,35,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
* --- End of Automatically Added Context ---"
439b8695,micro,4,the Result is empty.,"check_difference (Traffic1, MovedScaledNoise1, Diff, 'diff_outside', -Noise, Noise, -Add, -MoveRow, -MoveCol)
dev_display (Traffic1)
dev_display (Diff)",36,46,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
MoveRow := 10
MoveCol := 15
Add := 10
Noise := 5
add_noise_white (MovedScaled1, MovedScaledNoise1, Noise)
* --- End of Automatic..."
dad5e289,full,0,Threshold operator for signed images,"dev_close_window ()
read_image (Traffic1, 'traffic1')
read_image (Traffic2, 'traffic2')
convert_image_type (Traffic1, ImageConverted1, 'int2')
convert_image_type (Traffic2, ImageConverted2, 'int2')
sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dual_threshold (ImageSub, RegionDiff, 500...",8,36,
dad5e289,micro,1,,"dev_close_window ()
read_image (Traffic1, 'traffic1')
read_image (Traffic2, 'traffic2')
convert_image_type (Traffic1, ImageConverted1, 'int2')
convert_image_type (Traffic2, ImageConverted2, 'int2')",6,12,
dad5e289,micro,2,,"sub_image (ImageConverted1, ImageConverted2, ImageSub, 1, 0)
dual_threshold (ImageSub, RegionDiff, 500, 20, 10)
get_image_size (Traffic1, Width, Height)
dev_open_window (0, 0, 2 * Width, 2 * Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, ...",13,25,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
convert_image_type (Traffic1, ImageConverted1, 'int2')
convert_image_type (Traffic2, ImageConverted2, 'int2')
* --- End of Autom..."
dad5e289,micro,3,,"select_gray (RegionDiff, Traffic1, SelectedRegions, 'deviation', 'and', 20, 255)
dilation_circle (SelectedRegions, RegionDilation, 1.5)
reduce_domain (Traffic1, RegionDilation, ImageReduced)
binary_threshold (ImageReduced, Region, 'max_separability', 'dark', UsedThreshold)",26,30,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
dual_threshold (ImageSub, RegionDiff, 500, 20, 10)
* --- End of Automatically Added Context ---"
dad5e289,micro,4,,"shape_trans (Region, RegionTrans, 'convex')
dev_set_draw ('margin')
dev_set_colored (6)
dev_display (Traffic1)
dev_display (RegionTrans)",31,42,"* --- Automatically Added Context ---
read_image (Traffic1, 'traffic1')
binary_threshold (ImageReduced, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
1b6399de,full,0,"This example shows the use of the operator dyn_threshold for
the segmentation of the raised dots of ...","dev_update_off ()
read_image (Image, 'photometric_stereo/embossed_01')
get_image_size (Image, Width, Height)
dev_get_window (WindowHandle)
if (is_handle_elem(WindowHandle) == true)
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
else
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
en...",14,69,
1b6399de,micro,1,"the segmentation of the raised dots of braille characters.
The operator dyn_threshold is especially ...",dev_update_off (),6,15,
1b6399de,micro,2,,"read_image (Image, 'photometric_stereo/embossed_01')
get_image_size (Image, Width, Height)
dev_get_window (WindowHandle)
if (is_handle_elem(WindowHandle) == true)
dev_resize_window_fit_image (Image, 0, 0, -1, -1)
else
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
endif
set_display_fo...",16,34,
1b6399de,micro,3,,"mean_image (Image, ImageMean, 59, 59)
dev_display (ImageMean)
Message := 'Mean filtered image'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",35,43,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_get_window (WindowHandle)
Message := 'Original image'
* --- End of Automatically Added Context ---"
1b6399de,micro,4,region where the gray values of the two images differ by more than 15,"dyn_threshold (Image, ImageMean, RegionDynThresh, 15, 'not_equal')
dev_display (Image)
dev_display (RegionDynThresh)
Message := 'Regions segmented with dyn_threshold'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",44,54,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_get_window (WindowHandle)
Message := 'Original image'
mean_image (Image, ImageMean, 59, 59)
* --- End of ..."
1b6399de,micro,5,,"closing_circle (RegionDynThresh, RegionClosing, 8.5)
opening_circle (RegionClosing, RegionOpening, 6.5)
connection (RegionOpening, ConnectedRegions)
smallest_circle (ConnectedRegions, Row, Column, Radius)
gen_circle_contour_xld (ContCircle, Row, Column, Radius, 0, 6.28318, 'positive', 1)",55,61,"* --- Automatically Added Context ---
dyn_threshold (Image, ImageMean, RegionDynThresh, 15, 'not_equal')
* --- End of Automatically Added Context ---"
1b6399de,micro,6,,"dev_display (Image)
dev_set_color ('green')
dev_display (ContCircle)
Message := 'Results of braille segmentation after morphology'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_update_on ()",62,75,"* --- Automatically Added Context ---
read_image (Image, 'photometric_stereo/embossed_01')
dev_get_window (WindowHandle)
Message := 'Original image'
gen_circle_contour_xld (ContCircle, Row, Column, Ra..."
5b313849,full,0,"Fast detection of clips
ATTENTION
On multicore computers supporting the SSE2 instruction set, thresh...","dev_update_off ()
read_image (ActualImage, 'clip')
get_image_size (ActualImage, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
dev_set_part (0, 0, Height + 199, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_...",13,58,
5b313849,micro,1,"On multicore computers supporting the SSE2 instruction set, threshold
is most likely faster than fas...","dev_update_off ()
read_image (ActualImage, 'clip')
get_image_size (ActualImage, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
dev_set_part (0, 0, Height + 199, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_...",8,21,
5b313849,micro,2,,"MinHeight := 20
Min := 0
Max := 128
threshold (ActualImage, ThresholdedRegion, Min, Max)
count_seconds (Start)
for i := 1 to 100 by 1
threshold (ActualImage, ThresholdedRegion, Min, Max)
endfor
count_seconds (End)
TimeThreshold := (End - Start) / 100 * 1000
dev_set_color ('yellow')
dev_display (Thre...",22,64,"* --- Automatically Added Context ---
read_image (ActualImage, 'clip')
get_image_size (ActualImage, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
* --- End ..."
c9752062,full,0,,"read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowID)
dev_set_color ('red')
gray_histo (Image, Image, AbsoluteHisto, RelativeHisto)
histo_to_thresh (RelativeHisto, 8, MinThresh, MaxThresh)
dev_set_colo...",6,14,
c1d24587,full,0,"This example shows the method 'adapted_std_deviation' of local_threshold
Init display","dev_update_off ()
dev_close_window ()
read_image (Letters, 'letters')
dev_open_window_fit_image (Letters, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
get_image_size (Letters, Width, Height)
gen_image_surface_first_order (ImageSurface, 'byte', 0.5, 0.5, 0....",9,46,
c1d24587,micro,1,,"dev_update_off ()
dev_close_window ()
read_image (Letters, 'letters')
dev_open_window_fit_image (Letters, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",8,14,
c1d24587,micro,2,the strength of the adapted_std_deviation method more clearly.,"get_image_size (Letters, Width, Height)
gen_image_surface_first_order (ImageSurface, 'byte', 0.5, 0.5, 0.5, Width / 2, Height / 2, Width, Height)
add_image (Letters, ImageSurface, ImageCombined, 0.5, 0)",15,20,"* --- Automatically Added Context ---
read_image (Letters, 'letters')
* --- End of Automatically Added Context ---"
c1d24587,micro,3,with one global threshold from this image,"GlobalThreshold := 128
threshold (ImageCombined, RegionGlobal, 0, GlobalThreshold)
dev_display (ImageCombined)
dev_display (RegionGlobal)
Message := 'In images with inhomogeneous background'
Message[1] := 'it is impossible to segment the characters'
Message[2] := 'with a global threshold.'
disp_mess...",21,33,"* --- Automatically Added Context ---
dev_open_window_fit_image (Letters, 0, 0, -1, -1, WindowHandle)
add_image (Letters, ImageSurface, ImageCombined, 0.5, 0)
* --- End of Automatically Added Context ..."
c1d24587,micro,4,is suited to segment objects with varying background,"local_threshold (ImageCombined, Region, 'adapted_std_deviation', 'dark', [], [])",36,40,"* --- Automatically Added Context ---
add_image (Letters, ImageSurface, ImageCombined, 0.5, 0)
* --- End of Automatically Added Context ---"
c1d24587,micro,5,,"dev_display (ImageCombined)
dev_display (Region)
Message := 'With a local threshold, the characters'
Message[1] := 'can be segmented successfully.'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')",41,52,"* --- Automatically Added Context ---
dev_open_window_fit_image (Letters, 0, 0, -1, -1, WindowHandle)
add_image (Letters, ImageSurface, ImageCombined, 0.5, 0)
Message := 'In images with inhomogeneous ..."
f285d6ce,full,0,,"read_image (Audi2, 'audi2')
fill_interlace (Audi2, ImageFilled, 'odd')
threshold (ImageFilled, Region, 0, 90)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'width', 'and', 30, 70)
select_shape (SelectedRegions, Letters, 'height', 'and', 60, 110)
dev_clear_win...",6,15,
6e9cebbd,full,0,,"read_image (Image, 'double_circle')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
threshold_sub_pix (Image, Edges, 128)
segment_contours_xld (Edges, ContoursSplit, 'lines_circles', 5, 4, 3)
count_obj (ContoursSplit, Number)
dev...",6,25,
ab8a9ad0,full,0,"This example program shows the usage of var_threshold to threshold an image
by local mean and standa...","dev_close_window ()
dev_update_off ()
list_image_files ('label', 'default', [], ImageFiles)
ImageFiles1 := regexp_select(ImageFiles,'label_...png$')
read_image (Image, ImageFiles1[0])
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_displ...",15,44,
ab8a9ad0,micro,1,"have a high local standard deviation (for a positive StdDevScale),
or a low local standard deviation...","dev_close_window ()
dev_update_off ()",9,17,
ab8a9ad0,micro,2,"and select all images that end with 'label_', three arbitrary characters,
and then the string 'png'.","list_image_files ('label', 'default', [], ImageFiles)
ImageFiles1 := regexp_select(ImageFiles,'label_...png$')",18,23,
ab8a9ad0,micro,3,,"read_image (Image, ImageFiles1[0])
get_image_size (Image, Width, Height)
dev_open_window_fit_size (0, 0, Width, Height, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",24,29,"* --- Automatically Added Context ---
ImageFiles1 := regexp_select(ImageFiles,'label_...png$')
list_image_files ('label', 'default', [], ImageFiles)
* --- End of Automatically Added Context ---"
ab8a9ad0,micro,4,,"for Index := 0 to |ImageFiles1| - 1 by 1
read_image (Image, ImageFiles1[Index])
var_threshold (Image, Region, 15, 15, 1.01, 40, 'dark')
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, ['height', 'area'], 'and', [20, 100], [100, 400])
dev_display (Image)
dev_dis...",30,50,"* --- Automatically Added Context ---
ImageFiles1 := regexp_select(ImageFiles,'label_...png$')
list_image_files ('label', 'default', [], ImageFiles)
read_image (Image, ImageFiles1[0])
dev_open_window_..."
63dca5c3,full,0,,"read_image (Image, 'mreut')
diff_of_gauss (Image, DiffOfGauss, 4, 1.6)
zero_crossing (DiffOfGauss, RegionCrossing)
dev_display (Image)
dev_set_color ('red')
dev_display (RegionCrossing)",6,11,
494c59c4,full,0,"This example program shows how to use critical_points_sub_pix.
critical_points_sub_pix is used in co...","CornerRow := 307
CornerCol := 291
read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 512, 512)
derivate_gauss (Image, FilterResponse, 1, 'kitchen_rosenfeld')
critical_points_sub_pix (FilterResponse, 'facet', 1.5, 0.7, RowMin, ...",22,68,
494c59c4,micro,1,"that is sensitive to certain features of an image. In this example
the input image is convolved with...","CornerRow := 307
CornerCol := 291
read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 512, 512)",8,29,
494c59c4,micro,2,and extract the critical points of the filter response.,"derivate_gauss (Image, FilterResponse, 1, 'kitchen_rosenfeld')
critical_points_sub_pix (FilterResponse, 'facet', 1.5, 0.7, RowMin, ColMin, RowMax, ColMax, RowSaddle, ColSaddle)
tuple_concat (RowMax, RowMin, Row)
tuple_concat (ColMax, ColMin, Col)
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398...",30,38,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
494c59c4,micro,3,,"dev_display (FilterResponse)
dev_set_color ('red')
dev_display (Crosses)",39,44,"* --- Automatically Added Context ---
derivate_gauss (Image, FilterResponse, 1, 'kitchen_rosenfeld')
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398)
* --- End of Automatically Added Context ---"
494c59c4,micro,4,around the lower left corner of the bright rectangle.,"dev_set_draw ('margin')
dev_set_color ('yellow')
disp_rectangle1 (WindowHandle, CornerRow - 4, CornerCol - 4, CornerRow + 4, CornerCol + 4)
disp_arrow (WindowHandle, CornerRow, CornerCol + 5, 128, 512, 1)
dev_open_window (0, 520, 256, 256, 'black', WindowSection)
dev_set_part (CornerRow - 4, CornerC...",45,62,"* --- Automatically Added Context ---
CornerRow := 307
CornerCol := 291
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
derivate_gauss (Image, FilterResponse, 1, 'kitchen_rosenfeld')
gen_cross..."
494c59c4,micro,5,,"dev_close_window ()
dev_set_part (0, 0, 512, 512)
dev_display (Image)
dev_display (Crosses)",63,74,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398)
* --- End of Automatically Added Context ---"
c6cc721f,full,0,,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_color ('green')
get_system ('neighborhood', Information)
set_system ('neighborhood', 4)
local_max (Image, LocalMaxima)
set_sys...",6,15,
9dd1cdac,full,0,"This example program shows how to use local_max_sub_pix.
local_max_sub_pix is typically used in comb...","CornerRow := 341
CornerCol := 206
read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 512, 512)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
corner_response (Image, FilterResponse, 3, 0.04)
local_max_sub_pix (Fi...",15,58,
9dd1cdac,micro,1,"that is sensitive to certain features of an image. In this example,
the input image is convolved wit...","CornerRow := 341
CornerCol := 206
read_image (Image, 'fabrik')
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 512, 512)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",8,23,
9dd1cdac,micro,2,and extract the local maxima of the filter response.,"corner_response (Image, FilterResponse, 3, 0.04)
local_max_sub_pix (FilterResponse, 'facet', 1.5, 1.1, Row, Col)
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398)",24,30,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
9dd1cdac,micro,3,,"dev_display (FilterResponse)
dev_set_color ('red')
dev_display (Crosses)",31,36,"* --- Automatically Added Context ---
corner_response (Image, FilterResponse, 3, 0.04)
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398)
* --- End of Automatically Added Context ---"
9dd1cdac,micro,4,around the upper left corner of the lower black rectangle.,"dev_set_draw ('margin')
dev_set_color ('yellow')
disp_rectangle1 (WindowHandle, CornerRow - 4, CornerCol - 4, CornerRow + 4, CornerCol + 4)
disp_arrow (WindowHandle, CornerRow, CornerCol + 5, 128, 512, 1)
dev_open_window (0, 520, 256, 256, 'black', WindowHandlePart)
dev_set_part (CornerRow - 4, Corn...",37,52,"* --- Automatically Added Context ---
CornerRow := 341
CornerCol := 206
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
corner_response (Image, FilterResponse, 3, 0.04)
gen_cross_contour_xld (..."
9dd1cdac,micro,5,,"dev_close_window ()
dev_set_part (0, 0, 512, 512)
dev_display (Image)
dev_display (Crosses)",53,64,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
gen_cross_contour_xld (Crosses, Row, Col, 6, 0.785398)
* --- End of Automatically Added Context ---"
33f0d28c,full,0,"This example shows the usage of the loc_max and loc_min operators
and the relation between them.","read_image (Image, 'particle')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Image)
get_system ('neighborhood', Information)
set_system ('neighborhood', 4)
local...",9,40,
33f0d28c,micro,1,and the relation between them.,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (Image)
get_system ('neighborhood', Information)
set_system ('neighborhood', 4)",6,17,
33f0d28c,micro,2,,"local_max (Image, LocalMaxima)
dev_set_color ('green')
dev_display (LocalMaxima)
disp_continue_message (WindowID, 'black', 'true')
stop ()",18,25,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
33f0d28c,micro,3,,"invert_image (Image, ImageInverted)
local_min (ImageInverted, LocalMinima)
dev_set_color ('red')
dev_display (LocalMinima)
disp_continue_message (WindowID, 'black', 'true')
stop ()",26,34,"* --- Automatically Added Context ---
read_image (Image, 'particle')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
33f0d28c,micro,4,,"symm_difference (LocalMaxima, LocalMinima, Difference)
dev_display (Image)
dev_display (Difference)
set_system ('neighborhood', Information)",35,46,"* --- Automatically Added Context ---
read_image (Image, 'particle')
get_system ('neighborhood', Information)
local_max (Image, LocalMaxima)
local_min (ImageInverted, LocalMinima)
* --- End of Automat..."
56d79b3c,full,0,"This example shows the usage of the plateaus and lowlands operators
and the relation between them.","read_image (Image, 'particle')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
get_image_size (ImageSmooth, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (ImageSmooth)
dev_set_colore...",9,39,
56d79b3c,micro,1,and the relation between them.,"read_image (Image, 'particle')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
get_image_size (ImageSmooth, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
set_display_font (WindowID, 16, 'mono', 'true', 'false')
dev_display (ImageSmooth)
dev_set_colore...",6,17,
56d79b3c,micro,2,,"plateaus (ImageSmooth, Plateaus)
dev_display (Plateaus)
disp_continue_message (WindowID, 'black', 'true')
stop ()",18,24,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
56d79b3c,micro,3,,"invert_image (ImageSmooth, ImageInverted)
lowlands (ImageInverted, Lowlands)
dev_display (Lowlands)
disp_continue_message (WindowID, 'black', 'true')
stop ()",25,32,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
56d79b3c,micro,4,,"union1 (Plateaus, PlateausUnion)
union1 (Lowlands, LowlandsUnion)
symm_difference (PlateausUnion, LowlandsUnion, Difference)
dev_display (ImageSmooth)
dev_display (Difference)",33,45,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
plateaus (ImageSmooth, Plateaus)
lowlands (ImageInverted, Lowlands)
* --- End of Automatically Added Context --..."
a9322919,full,0,"This example shows the usage of the plateaus_center and
lowlands_center operators and the relation b...","read_image (Image, 'particle')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
get_image_size (ImageSmooth, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (ImageSmooth)
dev_set_colored (12)
set_display_font (WindowID, 16, 'mono', 'true', 'f...",9,39,
a9322919,micro,1,lowlands_center operators and the relation between them.,"read_image (Image, 'particle')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
get_image_size (ImageSmooth, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (ImageSmooth)
dev_set_colored (12)
set_display_font (WindowID, 16, 'mono', 'true', 'f...",6,17,
a9322919,micro,2,,"plateaus_center (ImageSmooth, Plateaus)
dev_display (Plateaus)
disp_continue_message (WindowID, 'black', 'true')
stop ()",18,24,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
a9322919,micro,3,,"invert_image (ImageSmooth, ImageInverted)
lowlands_center (ImageInverted, Lowlands)
dev_display (Lowlands)
disp_continue_message (WindowID, 'black', 'true')
stop ()",25,32,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
* --- End of Automatically Added Context ---"
a9322919,micro,4,,"union1 (Plateaus, PlateausUnion)
union1 (Lowlands, LowlandsUnion)
symm_difference (PlateausUnion, LowlandsUnion, Difference)
dev_display (ImageSmooth)
dev_display (Difference)",33,45,"* --- Automatically Added Context ---
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
plateaus_center (ImageSmooth, Plateaus)
lowlands_center (ImageInverted, Lowlands)
* --- End of Automatically Ad..."
c0bc58c4,full,0,,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_color ('green')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_set_colored (12)
plateaus (ImageSmooth, Plateaus)",6,14,
1d7cebc7,full,0,,"read_image (Image, 'particle')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Image)
dev_set_color ('green')
smooth_image (Image, ImageSmooth, 'deriche2', 0.2)
dev_set_colored (12)
plateaus_center (ImageSmooth, Plateaus...",6,14,
2cb503f2,full,0,,"read_image (Image, 'ic')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
decompose3 (Image, Red, Green, Blue)
dev_display (Red)
dev_set_colored (6)
histo_2dim (Red, Red, Blue, Histo2Dim)
scale_image_max (Histo2Dim, Histo2DimByte)
smo...",6,21,
9d7c751c,full,0,This example program shows how to use saddle_points_sub_pix.,"read_image (Image, 'landmarks')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
rgb1_to_gray (Image, GrayImage)
Sigma := 1.5
Threshold := 12
saddle_points_sub_pix (GrayImage, 'facet', Sigma, Threshold, Row, Col)
gen_cross_contour...",8,25,
9d7c751c,micro,1,,"read_image (Image, 'landmarks')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,12,
9d7c751c,micro,2,to convert the input image into a gray value image before using the operator.,"rgb1_to_gray (Image, GrayImage)
Sigma := 1.5
Threshold := 12
saddle_points_sub_pix (GrayImage, 'facet', Sigma, Threshold, Row, Col)
gen_cross_contour_xld (Crosses, Row, Col, 12, 0.785398)
dev_display (GrayImage)
dev_set_color ('red')
dev_display (Crosses)",13,31,"* --- Automatically Added Context ---
read_image (Image, 'landmarks')
* --- End of Automatically Added Context ---"
8e22302d,full,0,,"read_image (Br2, 'particle')
gauss_filter (Br2, ImageGauss, 9)
invert_image (ImageGauss, ImageInvert)
watersheds (ImageInvert, Basins, Watersheds)
dev_set_draw ('margin')
dev_set_colored (12)
dev_display (Br2)
dev_display (Basins)",6,13,
d68a354e,full,0,"This example demonstrates the functionality
of watersheds_marker.
Read images and get size.","CitrusFruits := 'color/citrus_fruits_' + [1:15]$'02'
read_image (Image, CitrusFruits[4])
get_image_size (Image, Width, Height)
gen_image_const (ImageBlack, 'byte', Width, Height)
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (Win...",10,131,
d68a354e,micro,1,,"CitrusFruits := 'color/citrus_fruits_' + [1:15]$'02'
read_image (Image, CitrusFruits[4])
get_image_size (Image, Width, Height)
gen_image_const (ImageBlack, 'byte', Width, Height)
dev_update_off ()
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (Win...",9,31,
d68a354e,micro,2,,"OrangeColor := 0.6
LemonColor := 1.1
Edge := 5
Colors := ['#FFA50080', '#FFFF0080', '#0000FF80']
dev_set_color (Colors)
gen_empty_region (EmptyRegion)
for Index := 0 to |CitrusFruits| - 1 by 1
if (Index == 0)
read_image (Image, CitrusFruits[4])
elseif (Index == 4)
read_image (Image, CitrusFruits[0])...",32,137,"* --- Automatically Added Context ---
CitrusFruits := 'color/citrus_fruits_' + [1:15]$'02'
read_image (Image, CitrusFruits[4])
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0..."
c1c2a27f,full,0,"This example program shows how to use watersheds_threshold
for different tasks.
Segment the letters ...","watersheds_threshold_logo ()
watersheds_threshold_cells ()
watersheds_threshold_pellets ()
watersheds_threshold_classification ()
dev_close_window ()
dev_set_draw ('fill')
dev_set_line_width (2)
dev_set_colored (12)
read_image (ImageLogo, 'mvtec_logo.png')
dev_close_window ()
get_image_size (ImageLo...",10,215,
c1c2a27f,micro,1,,watersheds_threshold_logo (),9,11,
c1c2a27f,micro,2,,watersheds_threshold_cells (),12,14,
c1c2a27f,micro,3,,watersheds_threshold_pellets (),15,17,
c1c2a27f,micro,4,,"watersheds_threshold_classification ()
dev_close_window ()",18,29,
c1c2a27f,micro,5,"MVTec logo by applying the watersheds algorithm to the
edge amplitude of the gray values.
To emphasi...","dev_set_draw ('fill')
dev_set_line_width (2)
dev_set_colored (12)
read_image (ImageLogo, 'mvtec_logo.png')
dev_close_window ()
get_image_size (ImageLogo, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_display (ImageLogo)
disp_continue_message (WindowHandle, 'black', ...",30,66,
c1c2a27f,micro,6,"by applying the watersheds algorithm to the image.
To emphasize the advantage of watersheds_threshol...","dev_set_draw ('margin')
dev_set_line_width (2)
dev_set_colored (12)
read_image (Meningg6, 'meningg6.png')
dev_close_window ()
get_image_size (Meningg6, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gauss_filter (Meningg6, ImageGauss, 3)
dev_display (ImageGauss)
disp_con...",67,103,"* --- Automatically Added Context ---
get_image_size (ImageLogo, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
gauss_filter (ImageLogo, ImageGauss, 9)
watersheds (EdgeAmp..."
c1c2a27f,micro,7,"color classification of the input image.
For this the two dimensional histogram of the u and the v
c...","dev_set_colored (12)
dev_set_line_width (2)
dev_update_window ('off')
dev_close_window ()
read_image (Image, 'ic')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_open_window (0, Width + 7, 256, 256, 'black', WindowHandleHisto)
dev_set_window (W...",104,135,"* --- Automatically Added Context ---
get_image_size (ImageLogo, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
c1c2a27f,micro,8,,"watersheds_threshold (ImageInvert, Basins, 50)
dev_set_draw ('margin')
dev_display (Basins)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
dev_set_window (WindowHandle)
dev_set_lut ('default')
dev_display (Image)
dev_set_colored (12)
dev_set_draw ('fill')
class_2dim_sup (ImageU, Image...",136,168,"* --- Automatically Added Context ---
get_image_size (ImageLogo, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (Image, 'ic')
dev_open_window (0, Width + 7, 256..."
c1c2a27f,micro,9,"First, a simple thresholding operation yields the region of the pellets
in the image. Unfortunately,...","dev_set_draw ('margin')
dev_set_colored (12)
read_image (Image, 'pellets')
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
threshold (Image, Region, 105, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, ...",169,222,"* --- Automatically Added Context ---
get_image_size (ImageLogo, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
read_image (Image, 'ic')
watersheds_threshold (ImageInvert,..."
2c48285e,full,0,This example shows how to use compute devices with HALCON.,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
query_available_compute_devices (DeviceIdentifier)
if (|DeviceIdentifier| == 0)
return ()
endif
disp_message (WindowHandle, 'Found ' + |D...",8,98,
2c48285e,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,12,
2c48285e,micro,2,,query_available_compute_devices (DeviceIdentifier),13,15,
2c48285e,micro,3,,"if (|DeviceIdentifier| == 0)
return ()
endif",16,20,"* --- Automatically Added Context ---
query_available_compute_devices (DeviceIdentifier)
* --- End of Automatically Added Context ---"
2c48285e,micro,4,,"disp_message (WindowHandle, 'Found ' + |DeviceIdentifier| + ' Compute Device(s):', 'window', 12, 12, 'black', 'true')
for Index := 0 to |DeviceIdentifier| - 1 by 1
get_compute_device_info (DeviceIdentifier[Index], 'name', DeviceName)
get_compute_device_info (DeviceIdentifier[Index], 'vendor', Device...",21,31,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
query_available_compute_devices (DeviceIdentifier)
* --- End of Automatically Added Context ---"
2c48285e,micro,5,,"for DeviceIndex := 0 to |DeviceIdentifier| - 1 by 1
dev_clear_window ()
disp_message (WindowHandle, 'Activating Device #' + DeviceIndex + ' and performing benchmark...', 'window', 12, 12, 'black', 'true')
open_compute_device (DeviceIdentifier[DeviceIndex], DeviceHandle)
set_compute_device_param (Dev...",32,104,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 480, -1, -1, WindowHandle)
query_available_compute_devices (DeviceIdentifier)
disp_message (WindowHandle, 'Found ' + |DeviceI..."
3402c5e6,full,0,This example program shows the use of the operator get_operator_info,"dev_close_window ()
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
set_display_font (WindowHandle, 11, 'mono', 'false', 'false')
Row := 16
Line := 0.5
WriteResults := false
get_multithreading_operators (TypeExclusive, TypeMutual, TypeReentrant, TypeIndependent)
disp_message (WindowHandle, '...",7,503,
3402c5e6,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
set_display_font (WindowHandle, 11, 'mono', 'false', 'false')
Row := 16
Line := 0.5
WriteResults := false",6,14,
3402c5e6,micro,2,,"get_multithreading_operators (TypeExclusive, TypeMutual, TypeReentrant, TypeIndependent)",15,16,
3402c5e6,micro,3,,"disp_message (WindowHandle, 'Multithreading type', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
disp_message (WindowHandle, |TypeExclusive|$'4d' + ' operators are exclusive (run in parallel only with independent operators)', 'window', Line * Row, 10, 'black', 'false')
Line := Line + ...",17,27,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_multithreading_operators (TypeExclusive, TypeMutual, TypeReentrant, TypeIndepend..."
3402c5e6,micro,4,,"if (WriteResults == true)
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent operators)', TypeExclusive)
write_operator_info ('multithreading_type_mutual_operators', 'List of operators that are mutual (run in p...",28,35,"* --- Automatically Added Context ---
WriteResults := false
get_multithreading_operators (TypeExclusive, TypeMutual, TypeReentrant, TypeIndependent)
* --- End of Automatically Added Context ---"
3402c5e6,micro,5,,"get_parallel_method_operators (SplitTuple, SplitChannel, SplitDomain, SplitPartial, None)",36,37,
3402c5e6,micro,6,,"Line := Line + 0.5
disp_message (WindowHandle, 'Parallelization method', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
AutoParallel := [SplitTuple,SplitChannel,SplitDomain,SplitPartial]
AutoParallel := uniq(sort(AutoParallel))
disp_message (WindowHandle, |AutoParallel|$'4d' + ' operat...",38,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_parallel_method_operators (SplitTuple, SplitChannel, SplitDomain, SplitPartial, ..."
3402c5e6,micro,7,,"if (WriteResults == true)
write_operator_info ('auto_parallel_operators', 'List of automatically parallelized operators', AutoParallel)
write_operator_info ('parallel_method_tuple_operators', 'List of operators that are automatically parallelized on tuple level', SplitTuple)
write_operator_info ('pa...",54,62,"* --- Automatically Added Context ---
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent..."
3402c5e6,micro,8,,get_opencl_operators (OpenCLSupport),63,64,
3402c5e6,micro,9,,"Line := Line + 0.5
disp_message (WindowHandle, 'Compute devices', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
disp_message (WindowHandle, |OpenCLSupport|$'4d' + ' operators support OpenCL', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1",65,70,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_opencl_operators (OpenCLSupport)
* --- End of Automatically Added Context ---"
3402c5e6,micro,10,,"if (WriteResults == true)
write_operator_info ('opencl_supporting_operators', 'List of operators that support OpenCL', OpenCLSupport)
endif",71,75,"* --- Automatically Added Context ---
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent..."
3402c5e6,micro,11,,get_extended_error_operators (ExtendedErrorSupport),76,77,
3402c5e6,micro,12,,"Line := Line + 0.5
disp_message (WindowHandle, 'Extended error info', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
disp_message (WindowHandle, |ExtendedErrorSupport|$'4d' + ' operators provide extended error information', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1",78,83,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_extended_error_operators (ExtendedErrorSupport)
* --- End of Automatically Added..."
3402c5e6,micro,13,,get_uint2_operators (UINT2Support),89,90,
3402c5e6,micro,14,,"Line := Line + 0.5
disp_message (WindowHandle, 'Image data types', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
disp_message (WindowHandle, |UINT2Support|$'4d' + ' operators support UINT2 images', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1",91,96,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_uint2_operators (UINT2Support)
* --- End of Automatically Added Context ---"
3402c5e6,micro,15,,"if (WriteResults == true)
write_operator_info ('uint2_supporting_operators', 'List of operators that support images of type UINT2', UINT2Support)
endif",97,101,"* --- Automatically Added Context ---
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent..."
3402c5e6,micro,16,,get_real_operators (RealSupport),102,103,
3402c5e6,micro,17,,"disp_message (WindowHandle, |RealSupport|$'4d' + ' operators support real images', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1",104,106,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_real_operators (RealSupport)
* --- End of Automatically Added Context ---"
3402c5e6,micro,18,,"if (WriteResults == true)
write_operator_info ('real_supporting_operators', 'List of operators that support images of type real', RealSupport)
endif",107,111,"* --- Automatically Added Context ---
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent..."
3402c5e6,micro,19,,get_all_modules (Modules),112,113,
3402c5e6,micro,20,,"get_operator_name ('', OperatorNames)
Line := Line + 0.5
disp_message (WindowHandle, 'The ' + |OperatorNames|$'4d' + ' operators are organized in ' + |Modules| + ' modules', 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1",114,118,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
get_all_modules (Modules)
* --- End of Automatically Added Context ---"
3402c5e6,micro,21,,"if (WriteResults == true)
write_operator_info ('all_available_modules', 'List of all available Modules', Modules)
endif",119,123,"* --- Automatically Added Context ---
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators', 'List of operators that are exclusive (run in parallel only with independent..."
3402c5e6,micro,22,,"for Index := 0 to |Modules| - 1 by 1
Module := Modules[Index]
get_module_operators (Module, Operators)
disp_message (WindowHandle, |Operators|$'4d' + ' operators are in module ' + Module, 'window', Line * Row, 10, 'black', 'false')
Line := Line + 1
if (WriteResults == true)
tuple_regexp_replace (Mod...",124,369,"* --- Automatically Added Context ---
dev_open_window (0, 0, 760, 540, 'white', WindowHandle)
Row := 16
Line := 0.5
WriteResults := false
write_operator_info ('multithreading_type_exclusive_operators'..."
3402c5e6,micro,23,,"get_operator_name ('', OperatorNames)
SplitTuple := []
SplitChannel := []
SplitDomain := []
SplitPartial := []
None := []
for Index := 0 to |OperatorNames| - 1 by 1
get_operator_info (OperatorNames[Index], 'parallel_method', Information)
if (|Information| == 0)
None := [None,OperatorNames[Index]]
co...",370,435,"* --- Automatically Added Context ---
get_parallel_method_operators (SplitTuple, SplitChannel, SplitDomain, SplitPartial, None)
get_operator_name ('', OperatorNames)
for Index := 0 to |Modules| - 1 by..."
3402c5e6,micro,24,,"get_operator_name ('', OperatorNames)
TypeExclusive := []
TypeMutual := []
TypeReentrant := []
TypeIndependent := []
ScopeGlobal := []
ScopeLocal := []
for Index := 0 to |OperatorNames| - 1 by 1
get_operator_info (OperatorNames[Index], 'parallelization', Information)
if (max(strstr(Information,'excl...",436,487,"* --- Automatically Added Context ---
get_multithreading_operators (TypeExclusive, TypeMutual, TypeReentrant, TypeIndependent)
for Index := 0 to |Modules| - 1 by 1
get_operator_info (OperatorNames[Ind..."
3402c5e6,micro,25,extended error information that can be queried with,"* get_extended_error_info (OperatorName, ErrorCode, ErrorMessage)
dev_update_off ()
get_operator_name ('', OperatorNames)
ExtendedErrorSupport := []
for Index := 0 to |OperatorNames| - 1 by 1
get_operator_info (OperatorNames[Index], 'result_state', Information)
if (Information =~ 'get_extended_error...",488,516,"* --- Automatically Added Context ---
get_extended_error_operators (ExtendedErrorSupport)
for Index := 0 to |Modules| - 1 by 1
get_operator_info (OperatorNames[Index], 'module', Information)
get_opera..."
60af037c,full,0,"This example program shows how to get information about the
parameters of operators. In particular, ...","dev_update_pc ('off')
dev_update_var ('off')
ByteOperators := []
CyclicOperators := []
DirectionOperators := []
Int1Operators := []
UInt2Operators := []
Int2Operators := []
Int4Operators := []
Int8Operators := []
RealOperators := []
ComplexOperators := []
VectorFieldOperators := []
get_operator_name...",9,83,
60af037c,micro,1,"parameters of operators. In particular, operators that support
specific input image types are obtain...","dev_update_pc ('off')
dev_update_var ('off')
ByteOperators := []
CyclicOperators := []
DirectionOperators := []
Int1Operators := []
UInt2Operators := []
Int2Operators := []
Int4Operators := []
Int8Operators := []
RealOperators := []
ComplexOperators := []
VectorFieldOperators := []",6,23,
60af037c,micro,2,,"get_operator_name ('', OperatorNames)
for idx := 0 to |OperatorNames| - 1 by 1
OperatorName := OperatorNames[idx]
get_param_names (OperatorName, InpObjPar, OutpObjPar, InpCtrlPar, OutpCtrlPar)
for jdx := 0 to |InpObjPar| - 1 by 1
get_param_info (OperatorName, InpObjPar[jdx], 'sem_type', SemType)
if ...",24,90,"* --- Automatically Added Context ---
ByteOperators := []
CyclicOperators := []
DirectionOperators := []
Int1Operators := []
UInt2Operators := []
Int2Operators := []
Int4Operators := []
Int8Operators ..."
9eb50f05,full,0,"This example starts the operator 'get_current_hthread_id' in
a separate user thread and shows that t...","par_start&lt;UserThreadID&gt; : get_current_hthread_id (HThreadID)
par_join (UserThreadID)
AreIdentical := UserThreadID == HThreadID",11,15,
9eb50f05,micro,1,"a separate user thread and shows that the received thread id
of the thread is identical to the threa...","par_start&lt;UserThreadID&gt; : get_current_hthread_id (HThreadID)
par_join (UserThreadID)",6,13,
9eb50f05,micro,2,,AreIdentical := UserThreadID == HThreadID,14,21,"* --- Automatically Added Context ---
par_start&lt;UserThreadID&gt; : get_current_hthread_id (HThreadID)
* --- End of Automatically Added Context ---"
71b04f62,full,0,"This example shows how to interrupt a running operator from another thread
using interrupt_operator ...","TimeDelay := 0.2
get_current_hthread_id (HThreadID)
par_start&lt;UserThreadID&gt; : tuple_add (1, 2, XX)
par_join (UserThreadID)
interrupt_operator (HThreadID, 'cancel')
read_image (Image, 'pcb_color')
par_start&lt;UserThreadID&gt; : interrupt_operator_delayed (HThreadID, 'cancel', TimeDelay)
try
me...",11,157,
71b04f62,micro,1,the interrupt signal.,TimeDelay := 0.2,9,12,
71b04f62,micro,2,"to be interrupted and a different thread sends the interruption signal.
Therefore, remember the thre...",get_current_hthread_id (HThreadID),13,18,
71b04f62,micro,3,,"par_start&lt;UserThreadID&gt; : tuple_add (1, 2, XX)
par_join (UserThreadID)",19,22,
71b04f62,micro,4,when the signal is sent in the current thread ...,"interrupt_operator (HThreadID, 'cancel')",25,27,"* --- Automatically Added Context ---
get_current_hthread_id (HThreadID)
* --- End of Automatically Added Context ---"
71b04f62,micro,5,"(like median_image in this case).
Hint: interrupt_operator_delayed just runs interrupt_operator afte...","read_image (Image, 'pcb_color')
par_start&lt;UserThreadID&gt; : interrupt_operator_delayed (HThreadID, 'cancel', TimeDelay)
try
median_image (Image, ImageMedian, 'circle', 200, 'mirrored')
CancelWasSent_1a := false
catch (Exception)
dev_get_exception_data (Exception, 'error_code', ErrorNr)
CancelWas...",28,45,"* --- Automatically Added Context ---
TimeDelay := 0.2
get_current_hthread_id (HThreadID)
par_start&lt;UserThreadID&gt; : tuple_add (1, 2, XX)
* --- End of Automatically Added Context ---"
71b04f62,micro,6,,"read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)",46,48,
71b04f62,micro,7,,"par_start&lt;UserThreadID&gt; : interrupt_operator_delayed (HThreadID, 'cancel', TimeDelay)
count_seconds (Start)",51,53,"* --- Automatically Added Context ---
TimeDelay := 0.2
get_current_hthread_id (HThreadID)
par_start&lt;UserThreadID&gt; : tuple_add (1, 2, XX)
* --- End of Automatically Added Context ---"
71b04f62,micro,8,This exception will be caught in the procedure and CancelWasSent_1b will be true.,"run_abortable_operator (ObjectModel3D, CancelWasSent_1b)
count_seconds (End)",54,58,"* --- Automatically Added Context ---
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
* --- End of Automatically Added Context ---"
71b04f62,micro,9,"Note, that the measurement in this example includes also the time of thread creation
(par_start) and...","CancelTime_1b := abs(End - Start - TimeDelay)
stop ()",59,64,"* --- Automatically Added Context ---
TimeDelay := 0.2
count_seconds (Start)
count_seconds (End)
* --- End of Automatically Added Context ---"
71b04f62,micro,10,"also be switched (this example uses simply the thread ID returned by par_start to
reference the thre...","par_start&lt;UserThreadID&gt; : run_abortable_operator (ObjectModel3D, CancelWasSent_1c)
count_seconds (Start)
interrupt_operator_delayed (UserThreadID, 'cancel', TimeDelay)
count_seconds (End)
par_join (UserThreadID)
CancelTime_1c := abs(End - Start - TimeDelay)
clear_object_model_3d (ObjectModel3D...",65,90,"* --- Automatically Added Context ---
TimeDelay := 0.2
par_start&lt;UserThreadID&gt; : tuple_add (1, 2, XX)
read_object_model_3d ('pipe_joint', 'm', [], [], ObjectModel3D, Status)
count_seconds (Start..."
71b04f62,micro,11,"operator is already running in the other thread. Otherwise,
the call to interrupt_operator has no ef...","wait_seconds (TimeDelay)
interrupt_operator (HThreadID, Mode)
return ()
try
create_surface_model (ObjectModel3D, 0.007, [], [], SurfaceModelID)
AbortWasSent := false
catch (Exception)
dev_get_exception_data (Exception, 'error_code', ErrorNr)
AbortWasSent := ErrorNr == 22
endtry
return ()",94,181,"* --- Automatically Added Context ---
TimeDelay := 0.2
get_current_hthread_id (HThreadID)
catch (Exception)
dev_get_exception_data (Exception, 'error_code', ErrorNr)
read_object_model_3d ('pipe_joint'..."
6522f260,full,0,"The primary purpose of HALCON message queues is to deliver data safely
among multiple threads withou...","create_message_queue (Queue)
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
disp_message (WindowHandle, 'Acquire images and push them to the message queue\nfor later processing', 'window', 12, 12, 'black', 'tru...",19,62,
6522f260,micro,1,,create_message_queue (Queue),18,20,
6522f260,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",21,25,
6522f260,micro,3,"Note: such an approach might be memory-intensive, depending on the amount
of data stored in the queu...","disp_message (WindowHandle, 'Acquire images and push them to the message queue\nfor later processing', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
create_message (MessageOut)
open_framegrabber ('File', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -...",26,44,"* --- Automatically Added Context ---
create_message_queue (Queue)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
6522f260,micro,4,In this example processing means simply to display the images...,"dev_clear_window ()
disp_message (WindowHandle, 'Get and display all the data from the message queue', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
while (1)
get_message_queue_param (Queue, 'is_empty', QueueIsEmpty)
if (QueueIsEmpty)
break
endif
de...",45,68,"* --- Automatically Added Context ---
create_message_queue (Queue)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
d064081c,full,0,"This example demonstrates the basic use of message queues
for data delivery among multiple threads.
...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 800, 240, 'black', WindowResults)
set_display_font (WindowResults, 16, 'mono', 'true', 'false')
Message := 'This example demonstrates the basic use of message queues for data'
Message[1] := 'delivery among multiple threads.'
Message[2] := ...",17,380,
d064081c,micro,1,"for data delivery among multiple threads.
This is illustrated by an application that detects and cou...",dev_update_off (),6,18,
d064081c,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 800, 240, 'black', WindowResults)
set_display_font (WindowResults, 16, 'mono', 'true', 'false')
Message := 'This example demonstrates the basic use of message queues for data'
Message[1] := 'delivery among multiple threads.'
Message[2] := 'The main thread f...",19,32,
d064081c,micro,3,"to processing threads, the other to deliver results.","create_message_queue (QueueImages)
create_message_queue (QueueResults)",33,37,
d064081c,micro,4,,"NumWorkerThreads := 2
for ThreadIndex := 0 to NumWorkerThreads - 1 by 1
par_start&lt;VProcThreads.at(ThreadIndex)&gt; : processing_thread (QueueImages, QueueResults, ThreadIndex)
endfor
par_start&lt;AcqThread&gt; : acquisition_thread (QueueImages, QueueResults, NumWorkerThreads)
NumStartedThreads :=...",38,46,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
create_message_queue (QueueResults)
* --- End of Automatically Added Context ---"
d064081c,micro,5,,"dev_update_off ()
NumCrates := 0
NumBottles := 0
NumIncomplete := 0
IncompleteIDs := []
ClutteredIDs := []
StopMessages := []
display_results (WindowResults, NumCrates, NumBottles, NumIncomplete, IncompleteIDs, ClutteredIDs, StopMessages, 0)",47,56,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 240, 'black', WindowResults)
* --- End of Automatically Added Context ---"
d064081c,micro,6,,"while (1)
dequeue_message (QueueResults, 'timeout', 'infinite', MessageResult)
get_message_param (MessageResult, 'key_exists', 'thread_finished', ThreadEndInfo)
if (ThreadEndInfo[0])
get_message_tuple (MessageResult, 'thread_finished', ThreadEndMessage)
StopMessages := [StopMessages,ThreadEndMessage...",57,103,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 240, 'black', WindowResults)
dev_open_window (200, 320, 480, 384, 'black', WindowImage)
create_message_queue (QueueResults)
NumStarted..."
d064081c,micro,7,,"convert_vector_to_tuple (VProcThreads, ProcThreads)
par_join ([AcqThread,ProcThreads])",104,106,"* --- Automatically Added Context ---
par_start&lt;VProcThreads.at(ThreadIndex)&gt; : processing_thread (QueueImages, QueueResults, ThreadIndex)
par_start&lt;AcqThread&gt; : acquisition_thread (QueueI..."
d064081c,micro,8,,"display_results (WindowResults, NumCrates, NumBottles, NumIncomplete, IncompleteIDs, ClutteredIDs, StopMessages, 1)",107,122,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 240, 'black', WindowResults)
NumCrates := 0
NumBottles := 0
NumIncomplete := 0
IncompleteIDs := []
ClutteredIDs := []
StopMessages := ..."
d064081c,micro,9,identify clutter (see below),"set_system ('store_empty_region', 'false')",125,128,
d064081c,micro,10,message from the acquisition thread.,"while (1)
dequeue_message (QueueImage, 'timeout', 'infinite', MessageData)
get_message_param (MessageData, 'key_exists', 'stop_processing', StopProcInfo)
if (StopProcInfo[0])
break
endif
get_message_obj (Image, MessageData, 'image')
threshold (Image, BackgroundRegion, 50, 130)
opening_circle (Backgr...",129,191,"* --- Automatically Added Context ---
create_message_queue (QueueResults)
for ThreadIndex := 0 to NumWorkerThreads - 1 by 1
NumBottles := 0
* --- End of Automatically Added Context ---"
d064081c,micro,11,"is finished through the ""results"" queue.","create_message (MessageFinished)
set_message_tuple (MessageFinished, 'thread_finished', 'Processing thread #' + ThreadIndex + ' finished')
enqueue_message (QueueResults, MessageFinished, [], [])
return ()",192,215,"* --- Automatically Added Context ---
create_message_queue (QueueResults)
for ThreadIndex := 0 to NumWorkerThreads - 1 by 1
* --- End of Automatically Added Context ---"
d064081c,micro,12,"is stopped. In real applications, this acquisition stop would
be controlled for example by an extern...","for Index := 1 to 24 by 1
read_image (Image, 'bottles/bottle_crate_' + Index$'.02')
create_message (MessageImg)
set_message_obj (Image, MessageImg, 'image')
set_message_tuple (MessageImg, 'crate_id', Index)
enqueue_message (QueueImages, MessageImg, [], [])
wait_seconds (0.3)
endfor",218,239,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
get_message_obj (Image, MessageData, 'image')
* --- End of Automatically Added Context ---"
d064081c,micro,13,"images has been sent to the processing threads), inform the processing
threads that no more work is ...","create_message (MessageStop)
set_message_tuple (MessageStop, 'stop_processing', 1)
for Index := 1 to NrProcessingThreads by 1
enqueue_message (QueueImages, MessageStop, [], [])
endfor",240,255,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
for Index := 1 to 24 by 1
* --- End of Automatically Added Context ---"
d064081c,micro,14,the acquisition is finished,"create_message (MessageFinished)
set_message_tuple (MessageFinished, 'thread_finished', 'Acquisition thread finished')
enqueue_message (QueueResults, MessageFinished, [], [])
return ()",256,284,"* --- Automatically Added Context ---
create_message_queue (QueueResults)
create_message (MessageFinished)
* --- End of Automatically Added Context ---"
d064081c,micro,15,processing results in textual form,"dev_set_window (WindowHandle)
dev_clear_window ()",285,289,
d064081c,micro,16,,"Message := []
Message[0] := 'Processed crates: ' + NumCrates
Message[1] := 'Found bottles: ' + NumBottles
Message[2] := 'Incomplete crates: ' + NumIncomplete
tuple_elements_to_string (IncompleteIDs, ', ', IncompleteIDList)
Message[3] := 'IDs of incomplete crates: ' + IncompleteIDList
tuple_elements_...",290,333,"* --- Automatically Added Context ---
Message := 'This example demonstrates the basic use of message queues for data'
NumCrates := 0
NumBottles := 0
NumIncomplete := 0
IncompleteIDs := []
ClutteredIDs..."
d064081c,micro,17,"i.e., the original image overlaid by detected bottles,
big bottles and clutter, each with a differen...","get_image_size (Image, Width, Height)
open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandle)
set_part (WindowHandle, 0, 0, Height - 1, Width - 1)
disp_obj (Image, WindowHandle)
set_color (WindowHandle, 'lime green')
disp_obj (Bottles, WindowHandle)
set_color (WindowHandle, 'goldenrod')
dis...",334,396,"* --- Automatically Added Context ---
get_message_obj (Image, MessageData, 'image')
select_shape (ConnectedRegions, Clutter, ['width', 'height'], 'or', [100, 100], [500, 400])
select_shape (RoundCandi..."
9a2cf10c,full,0,"This example demonstrates the basic use of message queues
for data delivery among multiple threads. ...","create_message_queue (QueueImages)
create_event ('', '', StopAcq)
dev_close_window ()
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
set_display_font (WindowResults, 16, 'mono', 'true', 'false')
Message := 'This example demonstrates the basic use of message queues for data'
Message[1] := '...",22,360,
9a2cf10c,micro,1,and a stop-acquisition event used to control the acquisition threads.,"create_message_queue (QueueImages)
create_event ('', '', StopAcq)",20,24,
9a2cf10c,micro,2,,"dev_close_window ()
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
set_display_font (WindowResults, 16, 'mono', 'true', 'false')
Message := 'This example demonstrates the basic use of message queues for data'
Message[1] := 'delivery among multiple threads.'
Message[2] := 'In particular, it...",25,40,
9a2cf10c,micro,3,within the acquired images.,"display_status (WindowResults, 0, 0, 0, 0, 1, 0, [])
create_and_train_mlp (MLPHandle)
display_status (WindowResults, 0, 0, 0, 0, 0, 0, [])",41,46,"* --- Automatically Added Context ---
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,4,,"par_start&lt;ProcessingThread&gt; : processing_thread (QueueImages, WindowResults, MLPHandle)
par_start&lt;AcqThread1&gt; : acquisition_thread (QueueImages, 1, StopAcq)
par_start&lt;AcqThread2&gt; : acquisition_thread (QueueImages, 2, StopAcq)",47,51,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
create_event ('', '', StopAcq)
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
create_and_train_mlp (MLPHandle)
* --- ..."
9a2cf10c,micro,5,-&gt; here this is simulated by a simple wait function.,wait_seconds (10),52,55,
9a2cf10c,micro,6,to stop at the next loop.,signal_event (StopAcq),56,59,"* --- Automatically Added Context ---
create_event ('', '', StopAcq)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,7,"This call ensures that the attempts to receive a new message from the queue
(dequeue_message) by the...","set_message_queue_param (QueueImages, 'abort_dequeuing', 1)",60,66,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,8,,"par_join ([ProcessingThread,AcqThread1,AcqThread2])",67,69,"* --- Automatically Added Context ---
par_start&lt;ProcessingThread&gt; : processing_thread (QueueImages, WindowResults, MLPHandle)
par_start&lt;AcqThread1&gt; : acquisition_thread (QueueImages, 1, St..."
9a2cf10c,micro,9,"be fully destroyed when releasing the queue (clear_message_queue or overwriting
all instances of its...","set_message_queue_param (QueueImages, 'flush_queue', 1)",70,89,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,10,,"dev_open_window (200, 0, 400, 300, 'black', WindowImage1)
set_display_font (WindowImage1, 14, 'mono', 'true', 'false')
dev_open_window (200, 408, 400, 300, 'black', WindowImage2)
set_display_font (WindowImage2, 14, 'mono', 'true', 'false')
dev_update_off ()
Line1Oranges := 0
Line1Lemons := 0
Line2Or...",92,105,"* --- Automatically Added Context ---
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,11,through the message queue is aborted from the main thread,"while (1)
try
dequeue_message (QueueImages, 'timeout', 'infinite', MessageData)
catch (Exception)
if (Exception[0] == 2890)
break
else
throw (Exception)
endif
endtry
get_message_obj (Image, MessageData, 'image')
classify_image_class_mlp (Image, ClassRegions, MLPHandle, 0.5)
select_obj (ClassRegions,...",106,184,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
create_and_train_mlp (MLPHandle)
dev_open_window (200, 0, 400, 300, 'b..."
9a2cf10c,micro,12,,"display_status (WindowResults, Line1Oranges, Line1Lemons, Line2Oranges, Line2Lemons, 0, 1, [])
return ()",185,205,"* --- Automatically Added Context ---
dev_open_window (0, 0, 808, 220, 'black', WindowResults)
Line1Oranges := 0
Line1Lemons := 0
Line2Oranges := 0
Line2Lemons := 0
* --- End of Automatically Added Co..."
9a2cf10c,micro,13,,"try_wait_event (StopAcq, Busy)
while (Busy)
read_random_citrus_image (Image)
create_message (MessageImg)
set_message_obj (Image, MessageImg, 'image')
set_message_tuple (MessageImg, 'line_id', InputLineID)
enqueue_message (QueueImages, MessageImg, [], [])
tuple_rand (1, RandTimeout)
wait_seconds (Ran...",208,235,"* --- Automatically Added Context ---
create_message_queue (QueueImages)
create_event ('', '', StopAcq)
get_message_obj (Image, MessageData, 'image')
get_message_tuple (MessageData, 'line_id', InputLi..."
9a2cf10c,micro,14,"the stop acquisition event again to allow the other threads to ""see"" it","signal_event (StopAcq)
return ()",236,262,"* --- Automatically Added Context ---
create_event ('', '', StopAcq)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,15,processing results in textual form,"dev_set_window (WindowHandle)
dev_clear_window ()",263,267,"* --- Automatically Added Context ---
dev_open_window (200, 0, 400, 300, 'black', WindowImage1)
WindowHandle := WindowImage1
* --- End of Automatically Added Context ---"
9a2cf10c,micro,16,,"disp_message (WindowHandle, 'Total fruits: ' + (Line1Oranges + Line2Oranges) + ' oranges, ' + (Line1Lemons + Line2Lemons) + ' lemons', 'window', 12, 12, 'green', 'false')",268,269,"* --- Automatically Added Context ---
Line1Oranges := 0
Line1Lemons := 0
Line2Oranges := 0
Line2Lemons := 0
dev_open_window (200, 0, 400, 300, 'black', WindowImage1)
WindowHandle := WindowImage1
* ---..."
9a2cf10c,micro,17,,"Message := []
Message[0] := 'Line #1: ' + Line1Oranges + ' oranges, ' + Line1Lemons + ' lemons'
Message[1] := 'Line #2: ' + Line2Oranges + ' oranges, ' + Line2Lemons + ' lemons'
disp_message (WindowHandle, Message, 'window', 50, 12, 'white', 'false')",270,274,"* --- Automatically Added Context ---
Message := 'This example demonstrates the basic use of message queues for data'
Line1Oranges := 0
Line1Lemons := 0
Line2Oranges := 0
Line2Lemons := 0
dev_open_win..."
9a2cf10c,micro,18,,"if (Finished)
disp_message (WindowHandle, 'Finished processing', 'window', 110, 12, 'magenta', 'false')
elseif (Training)
disp_message (WindowHandle, 'Training MLP...', 'window', 110, 12, 'cyan', 'false')
else
disp_message (WindowHandle, 'Processing... ' + ceil(Countdown) + 's left', 'window', 110, ...",275,304,"* --- Automatically Added Context ---
dev_open_window (200, 0, 400, 300, 'black', WindowImage1)
End := Start + 10
count_seconds (Start)
WindowHandle := WindowImage1
Countdown := End - Seconds
count_se..."
9a2cf10c,micro,19,images and read the image,"tuple_rand (1, Rand)
tuple_floor (Rand * 15 + 1, ImageIndexDouble)
tuple_int (ImageIndexDouble, ImageIndex)
read_image (Image, 'color/citrus_fruits_' + ImageIndex$'.02')
return ()",305,327,"* --- Automatically Added Context ---
get_message_obj (Image, MessageData, 'image')
* --- End of Automatically Added Context ---"
9a2cf10c,micro,20,,"create_class_mlp (3, 3, 3, 'softmax', 'normalization', 10, 42, MLPHandle)",331,333,"* --- Automatically Added Context ---
create_and_train_mlp (MLPHandle)
* --- End of Automatically Added Context ---"
9a2cf10c,micro,21,'oranges' and 'background' to the classifier,"read_image (Image, 'color/citrus_fruits_01')
gen_rectangle1 (OrangeRegion, 100, 130, 230, 200)
gen_rectangle1 (BackgroundRegion, 30, 20, 50, 50)
gen_empty_region (EmptyRegion)
gen_empty_obj (TrainingRegions1)
concat_obj (TrainingRegions1, OrangeRegion, TrainingRegions1)
concat_obj (TrainingRegions1,...",334,345,"* --- Automatically Added Context ---
create_and_train_mlp (MLPHandle)
get_message_obj (Image, MessageData, 'image')
* --- End of Automatically Added Context ---"
9a2cf10c,micro,22,'lemons' and 'background' to the classifier,"read_image (Image, 'color/citrus_fruits_03')
gen_rectangle1 (LemonRegion, 180, 130, 230, 240)
gen_rectangle1 (BackgroundRegion, 400, 20, 430, 50)
gen_empty_obj (TrainingRegions2)
concat_obj (TrainingRegions2, EmptyRegion, TrainingRegions2)
concat_obj (TrainingRegions2, LemonRegion, TrainingRegions2)...",346,356,"* --- Automatically Added Context ---
create_and_train_mlp (MLPHandle)
get_message_obj (Image, MessageData, 'image')
gen_rectangle1 (BackgroundRegion, 30, 20, 50, 50)
gen_empty_region (EmptyRegion)
* ..."
9a2cf10c,micro,23,,"train_class_mlp (MLPHandle, 300, 1, 0.01, Error, ErrorLog)
return ()",357,368,"* --- Automatically Added Context ---
create_and_train_mlp (MLPHandle)
* --- End of Automatically Added Context ---"
ce95366c,full,0,"This example shows how to implement a pipeline pattern, i.e.,
a processing pattern that uses paralle...","NumImageProcessingThreads := 4
MessageQueueMaxMessageNum := 200
NumAOPThreads := 1
NumAOPThreadsForImageProcessing := 1
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) +...",21,943,
ce95366c,micro,1,,"NumImageProcessingThreads := 4
MessageQueueMaxMessageNum := 200
NumAOPThreads := 1
NumAOPThreadsForImageProcessing := 1",20,26,
ce95366c,micro,2,,"estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) + 1.0), 0.001, MeanAcquisitionInterval)",27,29,"* --- Automatically Added Context ---
NumImageProcessingThreads := 4
NumAOPThreadsForImageProcessing := 1
* --- End of Automatically Added Context ---"
ce95366c,micro,3,,"* MeanAcquisitionInterval := 0.003
set_system ('thread_num', NumAOPThreads)",30,34,"* --- Automatically Added Context ---
NumAOPThreads := 1
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) + 1.0), 0.001, MeanAcquisitionInterval)
* --- End of Automatically ..."
ce95366c,micro,4,,"get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'true')
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",35,42,
ce95366c,micro,5,"and limit their size.
- Message queue that delivers the original images from the image acquisition s...","create_message_queue (QueueOriginalImage)
set_message_queue_param (QueueOriginalImage, 'max_message_num', MessageQueueMaxMessageNum)",43,48,"* --- Automatically Added Context ---
MessageQueueMaxMessageNum := 200
* --- End of Automatically Added Context ---"
ce95366c,micro,6,to the multiplexer.,"for I := 0 to NumImageProcessingThreads - 1 by 1
create_message_queue (QueueImageProcessingResultsVector.at(I))
set_message_queue_param (QueueImageProcessingResultsVector.at(I), 'max_message_num', MessageQueueMaxMessageNum)
endfor
convert_vector_to_tuple (QueueImageProcessingResultsVector, QueuesIma...",49,55,"* --- Automatically Added Context ---
NumImageProcessingThreads := 4
MessageQueueMaxMessageNum := 200
* --- End of Automatically Added Context ---"
ce95366c,micro,7,to the result evaluation stage.,"create_message_queue (QueueImageProcessingResult)
set_message_queue_param (QueueImageProcessingResult, 'max_message_num', MessageQueueMaxMessageNum)",56,60,"* --- Automatically Added Context ---
MessageQueueMaxMessageNum := 200
* --- End of Automatically Added Context ---"
ce95366c,micro,8,- Create event used to stop the image acquisition.,"create_event ('', '', StopAcq)",61,63,
ce95366c,micro,9,,TerminationKey := 'terminate',64,66,
ce95366c,micro,10,,"par_start&lt;AcquisitionThread&gt; : acquire_images (MeanAcquisitionInterval, StopAcq, TerminationKey, QueueOriginalImage)",67,68,"* --- Automatically Added Context ---
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) + 1.0), 0.001, MeanAcquisitionInterval)
create_message_queue (QueueOriginalImage)
crea..."
ce95366c,micro,11,,"for I := 0 to NumImageProcessingThreads - 1 by 1
par_start&lt;ImageProcessingThreadVector.at(I)&gt; : process_images (QueueOriginalImage, NumAOPThreadsForImageProcessing, TerminationKey, QueueImageProcessingResultsVector.at(I))
endfor
convert_vector_to_tuple (ImageProcessingThreadVector, ImageProces...",69,76,"* --- Automatically Added Context ---
NumImageProcessingThreads := 4
NumAOPThreadsForImageProcessing := 1
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
create_message_queue (QueueOriginalIma..."
ce95366c,micro,12,thus terminate the pipeline.,"wait_seconds (max([5,720 * MeanAcquisitionInterval * 1.5]))
signal_event (StopAcq)",77,81,"* --- Automatically Added Context ---
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) + 1.0), 0.001, MeanAcquisitionInterval)
create_event ('', '', StopAcq)
* --- End of Au..."
ce95366c,micro,13,,"par_join ([AcquisitionThread,ImageProcessingThreads,MultiplexerThread,ResultEvaluationThread])",82,84,"* --- Automatically Added Context ---
par_start&lt;AcquisitionThread&gt; : acquire_images (MeanAcquisitionInterval, StopAcq, TerminationKey, QueueOriginalImage)
convert_vector_to_tuple (ImageProcessin..."
ce95366c,micro,14,,"set_system ('store_empty_region', StoreEmptyRegion)",85,101,"* --- Automatically Added Context ---
get_system ('store_empty_region', StoreEmptyRegion)
* --- End of Automatically Added Context ---"
ce95366c,micro,15,when reading from remote or network drives.,"NumImages := 16
gen_empty_obj (Images)
for Index := 1 to NumImages by 1
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
concat_obj (Images, Image, Images)
endfor",104,112,
ce95366c,micro,16,,"ImageId := 0
count_seconds (LastAcquisitionTime)
repeat
wait_to_simulate_non_trivial_acquisition_time (MeanAcquisitionInterval, ImageId, LastAcquisitionTime, LastAcquisitionTime)
acquire_random_image (Images, Image)
count_seconds (AcquisitionTime)
create_message (MessageImg)
set_message_obj (Image, ...",113,145,"* --- Automatically Added Context ---
round_up_to (EstimatedImageProcessingTime / (log(NumImageProcessingThreads) + 1.0), 0.001, MeanAcquisitionInterval)
create_event ('', '', StopAcq)
gen_empty_obj (..."
ce95366c,micro,17,,"create_message (TerminationMessage)
set_message_tuple (TerminationMessage, TerminationKey, 'true')
enqueue_message_to_limited_queue (TerminationMessage, QueueOut, 'wait')
return ()",146,215,"* --- Automatically Added Context ---
TerminationKey := 'terminate'
enqueue_message_to_limited_queue (MessageImg, QueueOut, 'throw_exception')
* --- End of Automatically Added Context ---"
ce95366c,micro,18,,"SmoothX := 501
PolarResolution := 640
RingSize := 70",216,220,
ce95366c,micro,19,,"set_system ('tsp_thread_num', NumAOPThreads)",221,223,"* --- Automatically Added Context ---
NumAOPThreads := 1
* --- End of Automatically Added Context ---"
ce95366c,micro,20,,"while (1)
dequeue_message (QueueIn, [], [], MessageHandle)
get_message_param (MessageHandle, 'key_exists', TerminationKey, Terminate)
if (Terminate)
enqueue_message_to_limited_queue (MessageHandle, QueueIn, 'wait')
enqueue_message_to_limited_queue (MessageHandle, QueueOut, 'wait')
break
endif
get_me...",224,319,"* --- Automatically Added Context ---
TerminationKey := 'terminate'
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
enqueue_message_to_limited_queue (MessageImg, QueueOut, 'throw_exception')..."
ce95366c,micro,21,,"if (Mode != 'wait' and Mode != 'throw_exception')
throw ('Wrong value of Mode: ' + Mode)
endif",320,324,
ce95366c,micro,22,,"while (1)
try
enqueue_message (MessageQueue, Message, [], [])
break
catch (Exception)
if (Exception[0] == 2891)
if (Mode == 'wait')
elseif (Mode == 'throw_exception')
throw (['Message queue overflow', 'Processing is too slow for current image acquisition interval.', 'Increase the image acquisition i...",325,405,"* --- Automatically Added Context ---
if (Mode != 'wait' and Mode != 'throw_exception')
* --- End of Automatically Added Context ---"
ce95366c,micro,23,,"PlotWidth := 721
UpdateInterval := 1.0",406,409,
ce95366c,micro,24,,"count_seconds (LastUpdate)
AcquisitionInterval := gen_tuple_const(PlotWidth,0)
ImageProcessingTime := gen_tuple_const(PlotWidth,0)
ResponseTime := gen_tuple_const(PlotWidth,0)
CycleTime := gen_tuple_const(PlotWidth,0)
XVal := [0:PlotWidth - 1]
LastAcquisitionTime := -1
LastFinishingTime := -1
FirstL...",410,423,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
count_seconds (LastAcquisitionTime)
PlotWidth := 721
* --- End of Automatically Added Context ---"
ce95366c,micro,25,,"while (1)
dequeue_message (QueueIn, [], [], MessageHandle)
get_message_param (MessageHandle, 'key_exists', TerminationKey, Terminate)
if (Terminate)
break
endif
get_message_tuple (MessageHandle, 'acquisition_time', AcquisitionTime)
get_message_tuple (MessageHandle, 'start_processing_time', StartProc...",424,530,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
TerminationKey := 'terminate'
count_seconds (LastAcquisitionTime)
count_seconds (AcquisitionTime)
dequeue_..."
ce95366c,micro,26,,"NumInputQueues := |QueuesIn|
LastId := -1
Buffers := gen_tuple_const(NumInputQueues,-1)
Ids := gen_tuple_const(NumInputQueues,LastId)
TerminationFlags := gen_tuple_const(NumInputQueues,0)
TerminationMessage := -1",531,538,"* --- Automatically Added Context ---
create_message (TerminationMessage)
* --- End of Automatically Added Context ---"
ce95366c,micro,27,,"while (1)
for I := 0 to NumInputQueues - 1 by 1
if (TerminationFlags[I] == 0)
if (Buffers[I] == -1)
dequeue_message (QueuesIn[I], [], [], MessageHandle)
get_message_param (MessageHandle, 'key_exists', TerminationKey, Terminate)
if (Terminate)
TerminationFlags[I] := 1
if (TerminationMessage == -1)
Te...",539,793,"* --- Automatically Added Context ---
NumAOPThreadsForImageProcessing := 1
TerminationKey := 'terminate'
for I := 0 to NumImageProcessingThreads - 1 by 1
read_image (Image, 'bottles/bottle_mouth_' + I..."
ce95366c,micro,28,,MeasuredTimePlus := MeasuredTime * 1.25,794,795,"* --- Automatically Added Context ---
MeasuredTime := real(Seconds2 - Seconds1) / Num
Num := 100
count_seconds (Seconds1)
count_seconds (Seconds2)
* --- End of Automatically Added Context ---"
ce95366c,micro,29,,"round_up_to (MeasuredTimePlus, RoundUpTo, EstimatedImageProcessingTime)
return ()
RoundedValue := ceil(Value / RoundUpTo) * RoundUpTo
return ()
LastAcquisitionTimeOut := LastAcquisitionTime
AI := max([MeanAcquisitionInterval + 0.5 * sin(rad(ImageId)) * MeanAcquisitionInterval + 0.5 * (rand(1) - 0.5)...",796,988,"* --- Automatically Added Context ---
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
round_up_to (EstimatedImageProcessingTime / (log(NumImagePr..."
c6959b2f,full,0,"This example shows how to implement a pipeline pattern, i.e.,
a processing pattern that uses paralle...","MessageQueueMaxMessageNum := 200
NumAOPThreads := 1
NumAOPThreadsForImageProcessing := 1
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
MeanAcquisitionInterval := EstimatedImageProcessingTime
set_system ('thread_num', NumAOPThreads)
get_system ...",21,791,
c6959b2f,micro,1,,"MessageQueueMaxMessageNum := 200
NumAOPThreads := 1
NumAOPThreadsForImageProcessing := 1",20,24,
c6959b2f,micro,2,,"estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
MeanAcquisitionInterval := EstimatedImageProcessingTime
set_system ('thread_num', NumAOPThreads)",25,30,"* --- Automatically Added Context ---
NumAOPThreads := 1
NumAOPThreadsForImageProcessing := 1
* --- End of Automatically Added Context ---"
c6959b2f,micro,3,,"get_system ('store_empty_region', StoreEmptyRegion)
set_system ('store_empty_region', 'true')
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",31,38,
c6959b2f,micro,4,"and limit their size.
- Message queue that delivers the original images from the image acquisition s...","create_message_queue (QueueOriginalImage)
set_message_queue_param (QueueOriginalImage, 'max_message_num', MessageQueueMaxMessageNum)",39,44,"* --- Automatically Added Context ---
MessageQueueMaxMessageNum := 200
* --- End of Automatically Added Context ---"
c6959b2f,micro,5,to the result evaluation stage.,"create_message_queue (QueueImageProcessingResult)
set_message_queue_param (QueueImageProcessingResult, 'max_message_num', MessageQueueMaxMessageNum)",45,49,"* --- Automatically Added Context ---
MessageQueueMaxMessageNum := 200
* --- End of Automatically Added Context ---"
c6959b2f,micro,6,- Create event used to stop the image acquisition.,"create_event ('', '', StopAcq)",50,52,
c6959b2f,micro,7,,TerminationKey := 'terminate',53,55,
c6959b2f,micro,8,,"par_start&lt;AcquisitionThread&gt; : acquire_images (MeanAcquisitionInterval, StopAcq, TerminationKey, QueueOriginalImage)
par_start&lt;ImageProcessingThread&gt; : process_images (QueueOriginalImage, NumAOPThreadsForImageProcessing, TerminationKey, QueueImageProcessingResult)
par_start&lt;ResultEval...",56,60,"* --- Automatically Added Context ---
NumAOPThreadsForImageProcessing := 1
MeanAcquisitionInterval := EstimatedImageProcessingTime
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessi..."
c6959b2f,micro,9,thus terminate the pipeline.,"wait_seconds (max([5,720 * MeanAcquisitionInterval * 1.5]))
signal_event (StopAcq)",61,65,"* --- Automatically Added Context ---
MeanAcquisitionInterval := EstimatedImageProcessingTime
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
cre..."
c6959b2f,micro,10,,"par_join ([AcquisitionThread,ImageProcessingThread,ResultEvaluationThread])",66,68,"* --- Automatically Added Context ---
par_start&lt;AcquisitionThread&gt; : acquire_images (MeanAcquisitionInterval, StopAcq, TerminationKey, QueueOriginalImage)
par_start&lt;ImageProcessingThread&gt; ..."
c6959b2f,micro,11,,"set_system ('store_empty_region', StoreEmptyRegion)",69,85,"* --- Automatically Added Context ---
get_system ('store_empty_region', StoreEmptyRegion)
* --- End of Automatically Added Context ---"
c6959b2f,micro,12,when reading from remote or network drives.,"NumImages := 16
gen_empty_obj (Images)
for Index := 1 to NumImages by 1
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
concat_obj (Images, Image, Images)
endfor",88,96,
c6959b2f,micro,13,,"ImageId := 0
count_seconds (LastAcquisitionTime)
repeat
wait_to_simulate_non_trivial_acquisition_time (MeanAcquisitionInterval, ImageId, LastAcquisitionTime, LastAcquisitionTime)
acquire_random_image (Images, Image)
count_seconds (AcquisitionTime)
create_message (MessageImg)
set_message_obj (Image, ...",97,129,"* --- Automatically Added Context ---
MeanAcquisitionInterval := EstimatedImageProcessingTime
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
cre..."
c6959b2f,micro,14,,"create_message (TerminationMessage)
set_message_tuple (TerminationMessage, TerminationKey, 'true')
enqueue_message_to_limited_queue (TerminationMessage, QueueOut, 'wait')
return ()",130,199,"* --- Automatically Added Context ---
TerminationKey := 'terminate'
enqueue_message_to_limited_queue (MessageImg, QueueOut, 'throw_exception')
* --- End of Automatically Added Context ---"
c6959b2f,micro,15,,"SmoothX := 501
PolarResolution := 640
RingSize := 70",200,204,
c6959b2f,micro,16,,"set_system ('tsp_thread_num', NumAOPThreads)",205,207,"* --- Automatically Added Context ---
NumAOPThreads := 1
* --- End of Automatically Added Context ---"
c6959b2f,micro,17,,"while (1)
dequeue_message (QueueIn, [], [], MessageHandle)
get_message_param (MessageHandle, 'key_exists', TerminationKey, Terminate)
if (Terminate)
enqueue_message_to_limited_queue (MessageHandle, QueueOut, 'wait')
break
endif
get_message_obj (Image, MessageHandle, 'image')
count_seconds (Seconds)
...",208,301,"* --- Automatically Added Context ---
TerminationKey := 'terminate'
read_image (Image, 'bottles/bottle_mouth_' + Index$'.02')
enqueue_message_to_limited_queue (MessageImg, QueueOut, 'throw_exception')..."
c6959b2f,micro,18,,"if (Mode != 'wait' and Mode != 'throw_exception')
throw ('Wrong value of Mode: ' + Mode)
endif",302,306,
c6959b2f,micro,19,,"while (1)
try
enqueue_message (MessageQueue, Message, [], [])
break
catch (Exception)
if (Exception[0] == 2891)
if (Mode == 'wait')
elseif (Mode == 'throw_exception')
throw (['Message queue overflow', 'Processing is too slow for current image acquisition interval.', 'Increase the image acquisition i...",307,387,"* --- Automatically Added Context ---
if (Mode != 'wait' and Mode != 'throw_exception')
* --- End of Automatically Added Context ---"
c6959b2f,micro,20,,"PlotWidth := 721
UpdateInterval := 1.0",388,391,
c6959b2f,micro,21,,"count_seconds (LastUpdate)
AcquisitionInterval := gen_tuple_const(PlotWidth,0)
ImageProcessingTime := gen_tuple_const(PlotWidth,0)
ResponseTime := gen_tuple_const(PlotWidth,0)
CycleTime := gen_tuple_const(PlotWidth,0)
XVal := [0:PlotWidth - 1]
LastAcquisitionTime := -1
LastFinishingTime := -1
FirstL...",392,403,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
count_seconds (LastAcquisitionTime)
PlotWidth := 721
* --- End of Automatically Added Context ---"
c6959b2f,micro,22,,"while (1)
dequeue_message (QueueIn, [], [], MessageHandle)
get_message_param (MessageHandle, 'key_exists', TerminationKey, Terminate)
if (Terminate)
break
endif
get_message_tuple (MessageHandle, 'acquisition_time', AcquisitionTime)
get_message_tuple (MessageHandle, 'start_processing_time', StartProc...",404,669,"* --- Automatically Added Context ---
NumAOPThreadsForImageProcessing := 1
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
TerminationKey := 'terminate'
read_image (Image, 'bottles/bottle_mout..."
c6959b2f,micro,23,,MeasuredTimePlus := MeasuredTime * 1.25,670,671,"* --- Automatically Added Context ---
MeasuredTime := real(Seconds2 - Seconds1) / Num
Num := 100
count_seconds (Seconds1)
count_seconds (Seconds2)
* --- End of Automatically Added Context ---"
c6959b2f,micro,24,,"round_up_to (MeasuredTimePlus, RoundUpTo, EstimatedImageProcessingTime)
return ()
count_obj (Images, NumImages)
Idx := int(floor(rand(1) * NumImages)) + 1
select_obj (Images, Image, Idx)
return ()
LastAcquisitionTimeOut := LastAcquisitionTime
AI := max([MeanAcquisitionInterval + 0.5 * sin(rad(ImageI...",672,842,"* --- Automatically Added Context ---
estimate_image_processing_time (0.0025, NumAOPThreadsForImageProcessing, EstimatedImageProcessingTime)
MeanAcquisitionInterval := EstimatedImageProcessingTime
Num..."
0af15bc2,full,0,"This example program shows the difference of AOP (automatic
operator parallelization) models that ca...","dev_update_off ()
dev_close_window ()
WindowWidth := 500
WindowHeight := 500
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
dev_set_line_width (2)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')
get_system ('processor_num', NumCPUs)
read_image (Image, 'monkey...",13,191,
0af15bc2,micro,1,"operator parallelization) models that can be trained using
optimize_aop. The speed-up of the sobel_a...","dev_update_off ()
dev_close_window ()
WindowWidth := 500
WindowHeight := 500
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
dev_set_line_width (2)
set_display_font (WindowHandle1, 14, 'mono', 'true', 'false')",6,21,
0af15bc2,micro,2,,"get_system ('processor_num', NumCPUs)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Threads := [1:NumCPUs]
Speedup := [1:max([2,NumCPUs / 2])]
Loops := 50
OperatorName := 'sobel_amp'
Method := 'sum_abs'
Mask := 3
Param := 'false'
InputControl := [Method,Mask]
Me...",22,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
* --- End of Automatically Added Context ---"
0af15bc2,micro,3,,"disp_message (WindowHandle1, 'Measure \'nil\' ... ', 'window', 250, 12, 'yellow', 'false')
count_seconds (S1)
optimize_aop (OperatorName, 'byte', 'no_file', ['file_mode', 'system_mode'], ['nil', 'remove'])
get_system ('parallelize_operators', Information)
get_aop_info (OperatorName, ['iconic_type', ...",51,58,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
OperatorName := 'sobel_amp'
* --- End of Automatically Added Context ---"
0af15bc2,micro,4,,"measure_speedup_on_size (Image, InputControl, Loops, ImageSize, SpeedupNil, UsedThreadsNil)
count_seconds (S2)
TimeNil := S2 - S1
disp_message (WindowHandle1, 'Measure \'nil\' ... done in ' + TimeNil$'.2' + ' s', 'window', 250, 12, 'green', 'false')",59,64,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Loop..."
0af15bc2,micro,5,,"disp_message (WindowHandle1, 'Measure \'threshold\' ...', 'window', 280, 12, 'yellow', 'false')
count_seconds (S1)
optimize_aop (OperatorName, 'byte', 'no_file', ['file_mode', 'model', 'parameters'], ['nil', 'threshold',Param])
measure_speedup_on_size (Image, InputControl, Loops, ImageSize, SpeedupT...",65,73,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Loop..."
0af15bc2,micro,6,,"disp_message (WindowHandle1, 'Measure \'linear\' ...', 'window', 310, 12, 'yellow', 'false')
count_seconds (S1)
optimize_aop (OperatorName, 'byte', 'no_file', ['file_mode', 'model', 'parameters'], ['nil', 'linear',Param])
measure_speedup_on_size (Image, InputControl, Loops, ImageSize, SpeedupLinear,...",74,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Loop..."
0af15bc2,micro,7,,"disp_message (WindowHandle1, 'Measure \'mlp\' ...', 'window', 340, 12, 'yellow', 'false')
count_seconds (S1)
optimize_aop (OperatorName, 'byte', 'no_file', ['file_mode', 'model', 'parameters'], ['nil', 'mlp',Param])
measure_speedup_on_size (Image, InputControl, Loops, ImageSize, SpeedupMLP, UsedThre...",83,93,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Loop..."
0af15bc2,micro,8,,"dev_clear_window ()
dev_open_window (0, WindowWidth + 13, WindowWidth, WindowHeight, 'black', WindowHandle2)
dev_set_line_width (2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Legend := ['\'nil\'', '\'threshold\'', '\'linear\'', '\'mlp\'']
Colors := ['red', 'orange', 'yellow', 'gre...",94,101,"* --- Automatically Added Context ---
WindowWidth := 500
WindowHeight := 500
* --- End of Automatically Added Context ---"
0af15bc2,micro,9,,"plot_tuple (WindowHandle1, ImageSize$'d', [SpeedupNil,SpeedupThresh,SpeedupLinear,SpeedupMLP], 'Image Size', ' Speedup factor', Colors, ['grid_y', 'ticks_y', 'start_y'], [1, 1, 0])
disp_message (WindowHandle1, Legend, 'window', 280, 300, Colors, 'false')
plot_tuple (WindowHandle2, ImageSize$'d', [Us...",102,128,"* --- Automatically Added Context ---
dev_open_window (0, 0, WindowWidth, WindowHeight, 'black', WindowHandle1)
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Thre..."
0af15bc2,micro,10,(only the fastest time will be taken),"NumMeasurements := 2
Method := InputControl[0]
Mask := InputControl[1]",131,136,"* --- Automatically Added Context ---
Method := 'sum_abs'
Mask := 3
InputControl := [Method,Mask]
* --- End of Automatically Added Context ---"
0af15bc2,micro,11,,"for MeasureIndex := NumMeasurements - 1 to 0 by -1
count_seconds (S1)
for Index := 1 to Loops by 1
sobel_amp (InputImage, EdgeAmplitude, Method, Mask)
endfor
count_seconds (S2)
Times[MeasureIndex] := (S2 - S1) / Loops
endfor
MinTime := min(Times)
sobel_amp (InputImage, EdgeAmplitude, Method, Mask)
g...",137,204,"* --- Automatically Added Context ---
read_image (Image, 'monkey')
ImageSize := [32, 48, 64, 96, 128, 192, 256, 372, 512]
Speedup := [1:max([2,NumCPUs / 2])]
Loops := 50
Method := 'sum_abs'
Mask := 3
..."
ea0fd5e9,full,0,"This example program shows how to use the operators query_aop_info,
get_aop_info, and set_aop_info. ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example shows how to use the operators'
Message[1] := '\'query_aop_info\', \'get_aop_info\', and \'set_aop_info\''
Message[2] :=...",12,97,
ea0fd5e9,micro,1,"get_aop_info, and set_aop_info. AOP (automatic operator
parallelization) information of different ki...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example shows how to use the operators'
Message[1] := '\'query_aop_info\', \'get_aop_info\', and \'set_aop_info\''
Message[2] :=...",6,25,
ea0fd5e9,micro,2,"Run optimize_aop for some operator configurations to
set parallelization information","optimize_aop ('median_image', 'uint2', 'no_file', ['file_mode', 'model', 'parameters'], ['nil', 'linear', 'true'])
optimize_aop ('sobel_amp', ['byte', 'uint2'], 'no_file', ['file_mode', 'model', 'parameters'], ['nil', 'threshold', 'false'])",26,31,
ea0fd5e9,micro,3,,"query_aop_info ('', '', '', OpStep, OperatorNames)",35,37,
ea0fd5e9,micro,4,,"for I := 0 to |OperatorNames| - 1 by 1
Operator := OperatorNames[I]
query_aop_info (Operator, '', '', IconicTypeStep, IconicTypeValue)
for J := 0 to |IconicTypeStep| - 1 by 1
IconicType := IconicTypeValue[J]
query_aop_info (Operator, IconicTypeStep[J], IconicType, ParStep, ParValue)
query_detailed_a...",38,110,"* --- Automatically Added Context ---
dev_open_window (0, 0, 800, 512, 'black', WindowHandle)
Message := 'This example shows how to use the operators'
Message[3] := 'After calling \'optimize_aop\', th..."
e5bcb0d0,full,0,"This program simulates automatic operator parallelization (AOP)
using parallel programming in HDevel...","dev_close_window ()
dev_update_off ()
get_system ('processor_num', Cores)
MaxNumberOfSubthreads := 20
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesSeq := []
TimesAop := []
TimesPar := []
Color := ['yellow', 'green', 'cyan']
Runs := 10
Factor := 3
Radius := 15
get_system ('parallelize_operat...",31,149,
e5bcb0d0,micro,1,,"dev_close_window ()
dev_update_off ()
get_system ('processor_num', Cores)
MaxNumberOfSubthreads := 20
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesSeq := []
TimesAop := []
TimesPar := []
Color := ['yellow', 'green', 'cyan']",30,39,
e5bcb0d0,micro,2,,Runs := 10,40,41,
e5bcb0d0,micro,3,,Factor := 3,42,43,
e5bcb0d0,micro,4,,Radius := 15,44,45,
e5bcb0d0,micro,5,,"get_system ('parallelize_operators', ParallelizeOperators)
read_image (Image, 'fabrik')
get_image_size (Image, Width, Height)
zoom_image_factor (Image, Image, Factor, Factor, 'constant')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true'...",46,63,"* --- Automatically Added Context ---
Factor := 3
* --- End of Automatically Added Context ---"
e5bcb0d0,micro,6,Measure sequential execution time.,"set_system ('parallelize_operators', 'false')
disp_message (WindowHandle1, 'Sequential processing', 'window', 106, 12, Color[0], ['black', 'false'])
count_seconds (T1)
for Run := 1 to Runs by 1
median_image (Image, ImageMedianSeq, 'circle', Radius, 'mirrored')
endfor
count_seconds (T2)
TimesSeq := g...",64,80,"* --- Automatically Added Context ---
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesSeq := []
Color := ['yellow', 'green', 'cyan']
get_system ('processor_num', Cores)
MaxNumberOfSubthreads := ..."
e5bcb0d0,micro,7,Measure execution time with AOP.,"set_system ('parallelize_operators', 'true')
for Threads := 1 to MaxThreads by 1
set_system ('thread_num', Threads)
disp_message (WindowHandle1, 'AOP processing, threads: ' + Threads, 'window', 128, 12, Color[1], ['black', 'false'])
count_seconds (T1)
for Run := 1 to Runs by 1
median_image (Image, I...",81,100,"* --- Automatically Added Context ---
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesAop := []
Color := ['yellow', 'green', 'cyan']
get_system ('processor_num', Cores)
MaxNumberOfSubthreads := ..."
e5bcb0d0,micro,8,Measure parallel execution time by simulating AOP.,"set_system ('parallelize_operators', 'false')
for Threads := 1 to MaxThreads by 1
disp_message (WindowHandle1, 'Simulate AOP processing, threads: ' + Threads, 'window', 150, 12, Color[2], ['black', 'false'])
count_seconds (T1)
for Run := 1 to Runs by 1
get_region_runs (Image, Row, ColumnBegin, Colum...",101,139,"* --- Automatically Added Context ---
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesPar := []
Color := ['yellow', 'green', 'cyan']
get_system ('processor_num', Cores)
MaxNumberOfSubthreads := ..."
e5bcb0d0,micro,9,,"TimeMax := max([TimesSeq,TimesAop,TimesPar])
TicksX := int(ceil(MaxThreads / 16.0))
PlotParamName := ['ticks_x', 'margin_top', 'margin_left', 'start_y', 'end_y']
PlotParamValue := [TicksX,220, 90, 0,TimeMax * 1.1]
plot_tuple (WindowHandle1, [1:MaxThreads], [TimesSeq,TimesAop,TimesPar], 'Number of th...",140,145,"* --- Automatically Added Context ---
MaxThreads := min([Cores,MaxNumberOfSubthreads])
TimesSeq := []
TimesAop := []
TimesPar := []
Color := ['yellow', 'green', 'cyan']
get_system ('processor_num', Co..."
e5bcb0d0,micro,10,,"* dev_inspect_ctrl (['plot',TimesSeq,TimesAop,TimesPar])",146,147,"* --- Automatically Added Context ---
TimesSeq := []
TimesAop := []
TimesPar := []
* --- End of Automatically Added Context ---"
e5bcb0d0,micro,11,,"set_system ('parallelize_operators', ParallelizeOperators)",148,155,"* --- Automatically Added Context ---
get_system ('parallelize_operators', ParallelizeOperators)
* --- End of Automatically Added Context ---"
20961bba,full,0,"This example queries HALCON relevant system parameters.
These parameters are about the
- used HALCON...","Path := ''
dev_close_window ()
SystemKeys := []
SystemValues := []
get_system ('version', HalconVersion)
if (number(HalconVersion) &gt;= 11.0)
get_system ('file_version', HalconFileVersion)
else
get_system ('revision', HalconRevision)
if (HalconRevision &gt; '')
HalconFileVersion := HalconVersion + ...",21,387,
20961bba,micro,1,,"Path := ''
dev_close_window ()
SystemKeys := []
SystemValues := []",20,27,
20961bba,micro,2,,"get_system ('version', HalconVersion)
if (number(HalconVersion) &gt;= 11.0)
get_system ('file_version', HalconFileVersion)
else
get_system ('revision', HalconRevision)
if (HalconRevision &gt; '')
HalconFileVersion := HalconVersion + '.' + HalconRevision
else
HalconFileVersion := HalconVersion
endif
...",28,66,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,3,,"get_system ('operating_system', OSName)
get_system ('operating_system_version', OSVersion)
SystemKeys := [SystemKeys,'*** System Information ***']
SystemValues := [SystemValues,'']
SystemKeys := [SystemKeys,'    Operating system:']
SystemValues := [SystemValues,OSName]
SystemKeys := [SystemKeys,'   ...",67,76,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,4,,"if (HalconVersion &gt;= '18.05')
get_system ('locale_raw', LocaleRaw)
get_system ('locale_codeset', LocaleCodeset)
get_system ('filename_encoding', HlibEncoding)
SystemKeys := [SystemKeys,'*** Locale and Encoding Settings ***']
SystemValues := [SystemValues,'']
SystemKeys := [SystemKeys,'    Locale ...",77,91,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system ('version', HalconVersion)
* --- End of Automatically Added Context ---"
20961bba,micro,5,,"EnvHalconRoot := environment('HALCONROOT')
EnvHalconArch := environment('HALCONARCH')
EnvHalconLicenseFile := environment('HALCON_LICENSE_FILE')
EnvHalconExamples := environment('HALCONEXAMPLES')
EnvHalconImages := environment('HALCONIMAGES')
EnvHalconExtensions := environment('HALCONEXTENSIONS')
En...",92,136,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system ('operating_system', OSName)
* --- End of Automatically Added Context ---"
20961bba,micro,6,Note that tuple_join has been introduced with HALCON-22.05.,"if (HalconVersion &gt;= '22.05')
get_system ('hostids', HostIDs)
get_system ('current_license_info', LicenseInfo)
LicenseInfo := join(LicenseInfo + '',',')
get_system ('licensed_hostid', HostID)
get_system ('available_license_files', AvailableLicenseFiles)
get_system ('expiration_date', ExpirationDa...",137,162,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system ('version', HalconVersion)
* --- End of Automatically Added Context ---"
20961bba,micro,7,,"get_system ('processor_num', ProcessorNum)
get_system ('thread_pool', ThreadPool)
get_system ('thread_num', ThreadNum)
get_system ('parallelize_operators', AOP)
SystemKeys := [SystemKeys,'*** Parallelization ***']
SystemValues := [SystemValues,'']
SystemKeys := [SystemKeys,'    Processor number:']
S...",163,178,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,8,,"if (HalconVersion &gt;= '21.05')
SIMDExtensions := ['mmx', 'sse2', 'sse3', 'ssse3', 'sse41', 'sse42', 'avx', 'avx2', 'avx512f', 'avx512dq', 'avx512bw', 'avx512cd', 'avx512vl', 'avx512vbmi', 'avx512ifma', 'avx512vbmi2', 'avx512vpopcntdq', 'avx512bitalg', 'avx512vnni']
else
SIMDExtensions := ['mmx', '...",179,192,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system ('version', HalconVersion)
* --- End of Automatically Added Context ---"
20961bba,micro,9,,"get_system ('do_low_error', LLE)
SystemKeys := [SystemKeys,'*** Misc ***']
SystemValues := [SystemValues,'']
SystemKeys := [SystemKeys,'    Low Level Errors:']
SystemValues := [SystemValues,LLE]",193,199,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,10,"only way to do this sensibly is to open a buffer window and call disp_text. If this
succeeds, hcanva...","try
open_window (0, 0, 256, 256, 0, 'buffer', '', BufferHandle)
disp_text (BufferHandle, 'hello', 'window', 12, 12, 'black', [], [])
close_window (BufferHandle)
SmartBuffers := 'available'
catch (Exception)
if (Exception[0] == 5123)
SmartBuffers := 'unavailable'
elseif (Exception[0] == 5104)
SmartBu...",200,222,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,11,,"get_param_info ('info_framegrabber', 'Name', 'values', AcqInterfaces)
set_system ('do_low_error', 'disabled')
SystemKeys := [SystemKeys,'*** Image Acquisition Interfaces ***']
SystemValues := [SystemValues,'']
AcqString := []
for I := 0 to |AcqInterfaces| - 1 by 1
SystemKeys := [SystemKeys,'    ' + ...",223,238,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
for I := 0 to |SIMDExtensions| - 1 by 1
catch (Exception)
* --- End of Automatically Added Context ---"
20961bba,micro,12,,"CDString := []
query_available_compute_devices (DeviceIdentifiers)
SystemKeys := [SystemKeys,'*** Compute Devices ***']
SystemValues := [SystemValues,'']
for I := 0 to |DeviceIdentifiers| - 1 by 1
get_compute_device_info (DeviceIdentifiers[I], 'name', DeviceName)
get_compute_device_info (DeviceIdent...",239,272,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
for I := 0 to |SIMDExtensions| - 1 by 1
* --- End of Automatically Added Context ---"
20961bba,micro,13,,"if (HalconVersion &gt;= '17.12')
SystemKeys := [SystemKeys,'*** CUDA capable devices ***']
SystemValues := [SystemValues,'']
try
get_system ('cuda_version', CUDAVersion)
catch (Exception)
if (Exception[0] == 7708)
CUDAVersion := 'No CUDA capable device'
else
throw (Exception)
endif
endtry
SystemKeys...",273,319,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system ('version', HalconVersion)
catch (Exception)
* --- End of Automatically Added Context ---"
20961bba,micro,14,,"get_system ('opengl_hidden_surface_removal_available', OpenGL_HSRA)
get_system ('opengl_hidden_surface_removal_enable', OpenGL_HSRE)
try
get_system ('opengl_info', OpenGL_Info)
catch (Exception)
OpenGL_Info := 'No OpenGL information available'
endtry",320,327,"* --- Automatically Added Context ---
catch (Exception)
cuDNNVersion := 'No CUDA capable device'
* --- End of Automatically Added Context ---"
20961bba,micro,15,,"tuple_regexp_replace (OpenGL_Info, '\\n$', '', OpenGL_Info)
Substrings := split(OpenGL_Info,'\n')
Substrings := split(Substrings,'=')
EvenIdx := [0:2:|Substrings| - 1]
OddIdx := [1:2:|Substrings| - 1]
SystemKeys := [SystemKeys,'*** OpenGL Information ***']
SystemValues := [SystemValues,'']
SystemKey...",328,357,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
get_system (SIMDExtensions[I] + '_supported', Information)
get_system ('do_low_error', LLE)
get_system ('opengl_hidden_surface..."
20961bba,micro,16,,"get_system_time (MSecond, Second, Minute, Hour, Day, YDay, Month, Year)
DayString := Year$'4d' + '.' + Month$'02d' + '.' + Day$'02d'
TimeString := Hour$'02d' + '.' + Minute$'02d' + '.' + Second$'02d'",358,362,
20961bba,micro,17,,"dev_inspect_ctrl ([SystemKeys,SystemValues])",363,365,"* --- Automatically Added Context ---
SystemKeys := []
SystemValues := []
* --- End of Automatically Added Context ---"
20961bba,micro,18,,"open_file (Path + 'halcon_system_parameters.txt', 'output', FileHandle)
fwrite_string (FileHandle, '************************************************************\n')
fwrite_string (FileHandle, '*                 HALCON System Parameters                 *\n')
fwrite_string (FileHandle, '**************...",366,388,"* --- Automatically Added Context ---
Path := ''
SystemKeys := []
SystemValues := []
get_system ('operating_system', OSName)
if (OSName != 'Windows NT')
for I := 0 to |SIMDExtensions| - 1 by 1
DayStri..."
2117fde0,full,0,"Note: This example is meant to demonstrate the use of the serial interface
of HALCON.  On Unix machi...","get_system ('operating_system', OpSystem)
if (OpSystem == 'Windows NT')
open_serial ('COM1', SerialHandle)
else
open_serial ('/dev/tty', SerialHandle)
endif
set_serial_param (SerialHandle, 9600, 8, 'none', 'none', 1, 1000, 'unchanged')
write_serial (SerialHandle, ords('Hello world!\n\r'))
read_seria...",12,30,
2117fde0,micro,1,,"get_system ('operating_system', OpSystem)
if (OpSystem == 'Windows NT')
open_serial ('COM1', SerialHandle)
else
open_serial ('/dev/tty', SerialHandle)
endif",11,17,
2117fde0,micro,2,,"set_serial_param (SerialHandle, 9600, 8, 'none', 'none', 1, 1000, 'unchanged')",18,19,"* --- Automatically Added Context ---
open_serial ('COM1', SerialHandle)
* --- End of Automatically Added Context ---"
2117fde0,micro,3,,"write_serial (SerialHandle, ords('Hello world!\n\r'))",20,21,"* --- Automatically Added Context ---
open_serial ('COM1', SerialHandle)
* --- End of Automatically Added Context ---"
2117fde0,micro,4,,"read_serial (SerialHandle, 10, Data)",22,23,"* --- Automatically Added Context ---
open_serial ('COM1', SerialHandle)
* --- End of Automatically Added Context ---"
2117fde0,micro,5,,"if (|Data| &gt; 0)
Read := chrt(Data)
endif",24,28,"* --- Automatically Added Context ---
read_serial (SerialHandle, 10, Data)
* --- End of Automatically Added Context ---"
2117fde0,micro,6,,close_serial (SerialHandle),29,36,"* --- Automatically Added Context ---
open_serial ('COM1', SerialHandle)
* --- End of Automatically Added Context ---"
117d7716,full,0,"*************************************************************** *
*****   Halcon serialized data en/...","dev_update_off ()
dev_close_window ()
tuple_environment ('HALCON_PASSWORD', Password)
Secret := dict{password: Password}
read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
serialize_dl_model (DLModelHandle, SerializedItemHandle)
encrypt_serialized_item (SerializedItemHandle, Secre...",17,78,
117d7716,micro,1,,"dev_update_off ()
dev_close_window ()",15,19,
117d7716,micro,2,"symmetric algorithms that use a password string. For security
reasons, the password must not be stor...","tuple_environment ('HALCON_PASSWORD', Password)",24,33,
117d7716,micro,3,,Secret := dict{password: Password},34,36,"* --- Automatically Added Context ---
tuple_environment ('HALCON_PASSWORD', Password)
* --- End of Automatically Added Context ---"
117d7716,micro,4,encrypted.,"read_dl_model ('pretrained_dl_classifier_compact.hdl', DLModelHandle)
serialize_dl_model (DLModelHandle, SerializedItemHandle)",41,45,
117d7716,micro,5,"in encrypted form. The default file extension for encrypted
data is 'henc'.","encrypt_serialized_item (SerializedItemHandle, Secret, EncryptedItemHandle)
write_encrypted_item (EncryptedItemHandle, 'dl_model.henc')",46,51,"* --- Automatically Added Context ---
tuple_environment ('HALCON_PASSWORD', Password)
Secret := dict{password: Password}
serialize_dl_model (DLModelHandle, SerializedItemHandle)
* --- End of Automatic..."
117d7716,micro,6,from disk.,"read_encrypted_item ('dl_model.henc', EncryptedItemHandle1)
decrypt_serialized_item (EncryptedItemHandle1, Secret, SerializedItemHandle1)",56,60,"* --- Automatically Added Context ---
tuple_environment ('HALCON_PASSWORD', Password)
Secret := dict{password: Password}
* --- End of Automatically Added Context ---"
117d7716,micro,7,,"deserialize_dl_model (SerializedItemHandle1, DLModelHandle1)",61,63,"* --- Automatically Added Context ---
decrypt_serialized_item (EncryptedItemHandle1, Secret, SerializedItemHandle1)
* --- End of Automatically Added Context ---"
117d7716,micro,8,"type that can be serialized, e.g., a tuple.","Tuple := ['some', 'information', 'in', 'text', 'form']
serialize_tuple (Tuple, SerializedItemHandle2)
encrypt_serialized_item (SerializedItemHandle2, Secret, EncryptedItemHandle2)
write_encrypted_item (EncryptedItemHandle2, 'tuple.henc')
read_encrypted_item ('tuple.henc', EncryptedItemHandle3)
decry...",68,84,"* --- Automatically Added Context ---
tuple_environment ('HALCON_PASSWORD', Password)
Secret := dict{password: Password}
* --- End of Automatically Added Context ---"
f59c38a4,full,0,"***********************************************************************
This example program shows h...","Protocol := 'TCP4'
Timeout := 3.0
open_socket_accept (4660, ['protocol', 'timeout'], [Protocol,Timeout], AcceptingSocket)
tuple_regexp_match (Protocol, 'TCP|HALCON', BaseProtocol)
if (BaseProtocol == 'TCP' or BaseProtocol == 'HALCON')
dev_error_var (Error, 1)
dev_set_check ('~give_error')
OpenStatus...",15,61,
f59c38a4,micro,1,"This example program shows how to use the HALCON generic socket
functionality to send and receive ar...","Protocol := 'TCP4'
Timeout := 3.0",6,17,
f59c38a4,micro,2,,"open_socket_accept (4660, ['protocol', 'timeout'], [Protocol,Timeout], AcceptingSocket)",18,19,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Timeout := 3.0
* --- End of Automatically Added Context ---"
f59c38a4,micro,3,,"tuple_regexp_match (Protocol, 'TCP|HALCON', BaseProtocol)
if (BaseProtocol == 'TCP' or BaseProtocol == 'HALCON')
dev_error_var (Error, 1)
dev_set_check ('~give_error')
OpenStatus := 5
while (OpenStatus != 2)
socket_accept_connect (AcceptingSocket, 'auto', Socket)
OpenStatus := Error
endwhile
dev_set...",20,42,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Timeout := 3.0
open_socket_accept (4660, ['protocol', 'timeout'], [Protocol,Timeout], AcceptingSocket)
* --- End of Automatically Added Context..."
f59c38a4,micro,4,,"Answer := []
while (Answer != 'End')
receive_data (Socket, ['cz-csi', 'A3'], Answer, From)
if (From[2] == 0)
Data := 'Received:' + Answer[1]
else
Data := 'Received:' + Answer
endif
To := [From[0],From[1]]
Format := 'z'
send_data (Socket, Format, Data, To)
endwhile
stop ()
close_socket (Socket)
close...",43,67,"* --- Automatically Added Context ---
open_socket_accept (4660, ['protocol', 'timeout'], [Protocol,Timeout], AcceptingSocket)
socket_accept_connect (AcceptingSocket, 'auto', Socket)
* --- End of Autom..."
50cf6bc9,full,0,"***********************************************************************
This example program shows h...","Protocol := 'TCP4'
Timeout := 5.0
open_socket_connect ('127.0.0.1', 4660, ['protocol', 'timeout'], [Protocol,Timeout], Socket)
get_socket_param (Socket, 'address_info', Address)
To := []
send_data (Socket, 'cz-csi', [1, 'Generic sockets are great!', -1, -2, -3], To)
receive_data (Socket, ['c', 'z'],...",15,30,
50cf6bc9,micro,1,"This example program shows how to use the HALCON generic socket
functionality to send and receive ar...","Protocol := 'TCP4'
Timeout := 5.0",6,16,
50cf6bc9,micro,2,,"open_socket_connect ('127.0.0.1', 4660, ['protocol', 'timeout'], [Protocol,Timeout], Socket)
get_socket_param (Socket, 'address_info', Address)",17,20,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Timeout := 5.0
* --- End of Automatically Added Context ---"
50cf6bc9,micro,3,,To := [],21,22,
50cf6bc9,micro,4,,"send_data (Socket, 'cz-csi', [1, 'Generic sockets are great!', -1, -2, -3], To)
receive_data (Socket, ['c', 'z'], Answer, From)",23,25,"* --- Automatically Added Context ---
open_socket_connect ('127.0.0.1', 4660, ['protocol', 'timeout'], [Protocol,Timeout], Socket)
To := []
* --- End of Automatically Added Context ---"
50cf6bc9,micro,5,,"send_data (Socket, 'A3', 'End', To)
receive_data (Socket, ['c', 'z'], Answer2, From)
stop ()
close_socket (Socket)",26,36,"* --- Automatically Added Context ---
open_socket_connect ('127.0.0.1', 4660, ['protocol', 'timeout'], [Protocol,Timeout], Socket)
To := []
receive_data (Socket, ['c', 'z'], Answer, From)
* --- End of..."
e74e3e48,full,0,"***********************************************************************
This example program shows h...","Protocol := 'TCP4'
Port := 4242
Timeout := 3.0
get_system ('halcon_dir', HalconDir)
TLSCertificate := HalconDir + '/tls/cert-pub.pem'
TLSPrivateKey := HalconDir + '/tls/key.pem'
open_socket_accept (Port, ['protocol', 'timeout', 'tls_enable', 'tls_certificate', 'tls_private_key'], [Protocol,Timeout,'...",17,54,
e74e3e48,micro,1,"This example program shows how to use the HALCON generic socket
functionality to implement a server ...","Protocol := 'TCP4'
Port := 4242
Timeout := 3.0",6,19,
e74e3e48,micro,2,openssl req -x509 -newkey rsa:2048 -keyout tls/key.pem -out tls/cert-pub.pem -nodes,"get_system ('halcon_dir', HalconDir)
TLSCertificate := HalconDir + '/tls/cert-pub.pem'
TLSPrivateKey := HalconDir + '/tls/key.pem'
open_socket_accept (Port, ['protocol', 'timeout', 'tls_enable', 'tls_certificate', 'tls_private_key'], [Protocol,Timeout,'true',TLSCertificate,TLSPrivateKey], AcceptingS...",22,51,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Port := 4242
Timeout := 3.0
* --- End of Automatically Added Context ---"
e74e3e48,micro,3,,"close_socket (AcceptingSocket)
return ()",52,60,"* --- Automatically Added Context ---
open_socket_accept (Port, ['protocol', 'timeout', 'tls_enable', 'tls_certificate', 'tls_private_key'], [Protocol,Timeout,'true',TLSCertificate,TLSPrivateKey], Acc..."
319e6865,full,0,"***********************************************************************
This example program shows h...","Protocol := 'TCP4'
Port := 4660
Timeout := 5.0
AcceptRetries := 8
open_socket_accept (Port, ['protocol', 'reuseaddr', 'timeout'], [Protocol,0,Timeout], AcceptingSocket)
par_start&lt;ThreadID1&gt; : send_image_jpeg_memory_block (Protocol, Port, Timeout)
poll_socket_accept_connection (AcceptRetries, A...",28,213,
319e6865,micro,1,"* Worker thread startup: connect to main thread.
* Main to Worker: send filename as string.
* Worker...","Protocol := 'TCP4'
Port := 4660
Timeout := 5.0
AcceptRetries := 8",20,31,
319e6865,micro,2,,"open_socket_accept (Port, ['protocol', 'reuseaddr', 'timeout'], [Protocol,0,Timeout], AcceptingSocket)",32,34,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Port := 4660
Timeout := 5.0
* --- End of Automatically Added Context ---"
319e6865,micro,3,,"par_start&lt;ThreadID1&gt; : send_image_jpeg_memory_block (Protocol, Port, Timeout)",35,37,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Port := 4660
Timeout := 5.0
* --- End of Automatically Added Context ---"
319e6865,micro,4,,"poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
set_socket_param (Socket, 'timeout', Timeout)",38,41,"* --- Automatically Added Context ---
Timeout := 5.0
AcceptRetries := 8
open_socket_accept (Port, ['protocol', 'reuseaddr', 'timeout'], [Protocol,0,Timeout], AcceptingSocket)
* --- End of Automaticall..."
319e6865,micro,5,,"To := []
send_data (Socket, 'z', 'printer_chip/printer_chip_01', To)",42,45,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
* --- End of Automatically Added Context ---"
319e6865,micro,6,,"receive_data (Socket, 'ii', Answer, From)
Status := Answer[0]
Size := Answer[1]",46,50,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
* --- End of Automatically Added Context ---"
319e6865,micro,7,,"if (Status == 2)
Format := 'a' + Size
receive_data (Socket, Format, Answer, From)
write_memory_block (Answer[0], 'memory_block.jpg')
endif",51,57,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
receive_data (Socket, 'ii', Answer, From)
Status := Answer[0]
Size := Answer[1]
* --- End o..."
319e6865,micro,8,,"close_socket (Socket)
par_join (ThreadID1)",58,61,"* --- Automatically Added Context ---
par_start&lt;ThreadID1&gt; : send_image_jpeg_memory_block (Protocol, Port, Timeout)
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
* --- E..."
319e6865,micro,9,,close_socket (AcceptingSocket),62,77,"* --- Automatically Added Context ---
open_socket_accept (Port, ['protocol', 'reuseaddr', 'timeout'], [Protocol,0,Timeout], AcceptingSocket)
* --- End of Automatically Added Context ---"
319e6865,micro,10,,"open_socket_connect ('localhost', Port, ['protocol', 'timeout'], [Protocol,Timeout], Socket)",80,82,"* --- Automatically Added Context ---
Protocol := 'TCP4'
Port := 4660
Timeout := 5.0
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
* --- End of Automatically Added Context ---"
319e6865,micro,11,,"try
receive_data (Socket, 'z', Data, From)
ImageName := Data[0]
catch (Exception)
close_socket (Socket)
return ()
endtry
Size := 0
Status := 2",83,93,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
receive_data (Socket, 'ii', Answer, From)
Status := Answer[0]
Size := Answer[1]
* --- End o..."
319e6865,micro,12,,"try
read_image (Image, ImageName)
image_to_memory_block (Image, 'jpeg', 0, MemoryBlockHandle)
get_memory_block_ptr (MemoryBlockHandle, Pointer, Size)
catch (Exception)
Status := Exception[0]
endtry
try
send_data (Socket, 'ii', [Status,Size], [])
if (Status == 2)
To := []
send_data (Socket, 'a', Memo...",94,118,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
To := []
Status := Answer[0]
Size := Answer[1]
receive_data (Socket, 'ii', Answer, From)
Im..."
319e6865,micro,13,,"close_socket (Socket)
return ()",119,195,"* --- Automatically Added Context ---
poll_socket_accept_connection (AcceptRetries, AcceptingSocket, Socket)
* --- End of Automatically Added Context ---"
319e6865,micro,14,using gradually larger polling timeouts.,"wait_seconds (0.1)
attempts := 5
for Index := 1 to attempts by 1
try
socket_accept_connect (AcceptingSocket, 'false', Socket)
catch (Exception)
if (Index == attempts)
close_socket (AcceptingSocket)
throw (Exception)
endif
wait_seconds (0.5 * Index)
continue
endtry
break
endfor
return ()",196,256,"* --- Automatically Added Context ---
open_socket_accept (Port, ['protocol', 'reuseaddr', 'timeout'], [Protocol,0,Timeout], AcceptingSocket)
poll_socket_accept_connection (AcceptRetries, AcceptingSock..."
0a930017,full,0,"***********************************************************************
This example program shows h...","dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Message := 'Please...",16,120,
0a930017,micro,1,"This example program shows how to use the serialization of HALCON
objects and tuples in HALCON.  In ...","dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_set_color ('green')
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Message := 'Please...",6,28,
0a930017,micro,2,,"open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)",29,31,
0a930017,micro,3,,"OpenStatus := 5
while (OpenStatus[0] != 2)
OpenStatus := 2
try
socket_accept_connect (AcceptingSocket, 'false', Socket)
catch (OpenStatus)
endtry
wait_seconds (0.2)
endwhile
disp_message (WindowHandle2, 'Connected ...', 'window', 12, 12, 'green', 'false')
dev_set_window (WindowHandle1)
dev_clear_win...",32,45,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
open_socket_accept (3000, 'protocol', 'HALCON4..."
0a930017,micro,4,,"receive_serialized_item (Socket, SerializedItemHandle)
deserialize_tuple (SerializedItemHandle, Names)
Models := []
for I := 0 to 3 by 1
receive_serialized_item (Socket, SerializedItemHandle)
deserialize_shape_model (SerializedItemHandle, ModelID)
Models := [Models,ModelID]
disp_message (WindowHandl...",46,57,"* --- Automatically Added Context ---
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
socket_accept_connect (AcceptingSocket, 'false', Socket)
* --- End of Automatically Added Context ---"
0a930017,micro,5,,"for I := 1 to 13 by 1
read_image (Image, 'coins/20cent_' + I$'.2' + '.png')
find_coin (Image, Models, Row, Column, Angle, Score, Model)
crop_part (Image, ImagePart, Row - 460 / 2, Column - 460 / 2, 460, 460)
get_shape_model_contours (ModelContours, Models[Model], 1)
vector_angle_to_rigid (0, 0, 0, 4...",58,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
Message := 'Please open a second HDevelop and'..."
0a930017,micro,6,,close_socket (Socket),83,84,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'false', Socket)
* --- End of Automatically Added Context ---"
0a930017,micro,7,,"close_socket (AcceptingSocket)
disp_message (WindowHandle2, 'Connection closed.', 'window', 410, 12, 'green', 'false')
threshold (Image, Region, 70, 255)
connection (Region, ConnectedRegions)
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
shape_trans (SelectedRegions, RegionTran...",85,134,"* --- Automatically Added Context ---
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
Models := []
disp_message (WindowHand..."
6d26e94b,full,0,"***********************************************************************
This example program shows h...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Names := ['german', 'i...",15,113,
6d26e94b,micro,1,"This example program shows how to use the serialization of HALCON
objects and tuples in HALCON.  In ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
set_display_font (WindowHandle2, 14, 'mono', 'true', 'false')
Names := ['german', 'i...",6,34,
6d26e94b,micro,2,,"open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
disp_message (WindowHandle2, 'Connected ...', 'window', 12, 12, 'green', 'false')",35,39,"* --- Automatically Added Context ---
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
* --- End of Automatically Added Context ---"
6d26e94b,micro,3,,"serialize_tuple (Names, SerializedItemHandle)
send_serialized_item (Socket, SerializedItemHandle)",40,43,"* --- Automatically Added Context ---
Names := ['german', 'italian', 'greek', 'spanish']
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
* --- End of Automatically Added Context ---"
6d26e94b,micro,4,,"for I := 0 to 3 by 1
read_image (Image, 'coins/20cent_' + Names[I])
Message := 'Train coin ' + (I + 1) + '/4 (' + Names[I] + ')'
disp_message (WindowHandle2, Message, 'window', 30 + I * 40, 12, 'white', 'false')
train_coin_model (Image, ModelID)
serialize_shape_model (ModelID, SerializedItemHandle)
...",44,56,"* --- Automatically Added Context ---
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
Names := ['german', 'italian', 'greek', 'spanish']
Message := 'Please open a second HDevelop and'
open_..."
6d26e94b,micro,5,,"dev_set_color ('green')
dev_set_line_width (1)
disp_message (WindowHandle2, 'Receive matching results ...', 'window', 195, 12, 'green', 'false')
for I := 1 to 13 by 1
receive_serialized_item (Socket, SerializedItemHandle)
deserialize_tuple (SerializedItemHandle, CoinName)
receive_serialized_item (So...",57,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle1)
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
Message := 'Please open a second HDevelop and'..."
6d26e94b,micro,6,,"close_socket (Socket)
disp_message (WindowHandle2, 'Connection closed.', 'window', 480, 12, 'green', 'false')
threshold (Image, Region, 70, 255)
connection (Region, ConnectedRegions)
select_shape_std (ConnectedRegions, SelectedRegions, 'max_area', 0)
shape_trans (SelectedRegions, RegionTrans, 'conve...",83,109,"* --- Automatically Added Context ---
dev_open_window (0, 524, 400, 512, 'black', WindowHandle2)
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'coins/20cent_' + Names[I])
..."
6d26e94b,micro,7,,"* inspect_shape_model (ImageReduced, ModelImages, ModelRegions, 1, HysteresisContrast)
create_shape_model (ImageReduced, 0, 0, rad(360), 0, 'no_pregeneration', 'ignore_local_polarity', HysteresisContrast, 5, ModelID)
return ()",110,122,"* --- Automatically Added Context ---
train_coin_model (Image, ModelID)
HysteresisContrast := [Contrast / 2,Contrast + 6,10]
reduce_domain (Image, Coin, ImageReduced)
Contrast := 20
* --- End of Autom..."
abf4192f,full,0,"***********************************************************************
This example program shows h...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
dev_error_var (Error, 1)
dev_set_check ('~give_error')
OpenStatus := 5
while (OpenStatus != 2)
socket_accept_connect (AcceptingSocket, 'f...",14,49,
abf4192f,micro,1,"This example program shows how to use the HALCON socket functionality
to transfer image, region and ...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)",6,16,
abf4192f,micro,2,,"open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)",17,18,
abf4192f,micro,3,,"dev_error_var (Error, 1)
dev_set_check ('~give_error')
OpenStatus := 5
while (OpenStatus != 2)
socket_accept_connect (AcceptingSocket, 'false', Socket)
OpenStatus := Error
wait_seconds (0.2)
endwhile
dev_set_check ('give_error')",19,28,"* --- Automatically Added Context ---
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
* --- End of Automatically Added Context ---"
abf4192f,micro,4,,"get_next_socket_data_type (Socket, DataType)",29,30,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'false', Socket)
* --- End of Automatically Added Context ---"
abf4192f,micro,5,,"receive_image (Image, Socket)
convert_image_type (Image, ImageInt2, 'int2')",31,33,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'false', Socket)
* --- End of Automatically Added Context ---"
abf4192f,micro,6,,"send_image (ImageInt2, Socket)
receive_image (ImageReal, Socket)
threshold (ImageReal, Region, 0, 63)
send_region (Region, Socket)
receive_region (ConnectedRegions, Socket)
area_center (ConnectedRegions, Area, Row, Column)
send_tuple (Socket, Area)
send_tuple (Socket, Row)
send_tuple (Socket, Column...",34,45,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'false', Socket)
convert_image_type (Image, ImageInt2, 'int2')
* --- End of Automatically Added Context ---"
abf4192f,micro,7,,close_socket (Socket),46,47,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'false', Socket)
* --- End of Automatically Added Context ---"
abf4192f,micro,8,,close_socket (AcceptingSocket),48,55,"* --- Automatically Added Context ---
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
* --- End of Automatically Added Context ---"
d6213f50,full,0,"***********************************************************************
This example program shows h...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'fabrik')
send_image (Image, Socket)
receive_image (ImageInt2, Socket)
convert_image_type (ImageInt2, ImageReal, 'real')
send_im...",14,36,
d6213f50,micro,1,"This example program shows how to use the HALCON socket functionality
to transfer image, region and ...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)",6,16,
d6213f50,micro,2,,"open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'fabrik')",17,19,
d6213f50,micro,3,,"send_image (Image, Socket)",20,21,"* --- Automatically Added Context ---
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'fabrik')
* --- End of Automatically Added Context ---"
d6213f50,micro,4,,"receive_image (ImageInt2, Socket)
convert_image_type (ImageInt2, ImageReal, 'real')
send_image (ImageReal, Socket)
receive_region (Region, Socket)
connection (Region, ConnectedRegions)
send_region (ConnectedRegions, Socket)
receive_tuple (Socket, Area)
receive_tuple (Socket, Row)
receive_tuple (Sock...",22,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
* --- End of Automatically Added Context ---"
d6213f50,micro,5,,close_socket (Socket),35,42,"* --- Automatically Added Context ---
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
* --- End of Automatically Added Context ---"
08da63a7,full,0,"***********************************************************************
This example program shows h...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
socket_accept_connect (AcceptingSocket, 'true', Socket)
get_next_socket_data_type (Socket, DataType)
receive_image (Image, Socket)
edges_...",13,34,
08da63a7,micro,1,"This example program shows how to use the HALCON socket functionality
to transfer image and XLD obje...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)",6,15,
08da63a7,micro,2,,"open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)",16,17,
08da63a7,micro,3,,"socket_accept_connect (AcceptingSocket, 'true', Socket)
get_next_socket_data_type (Socket, DataType)
receive_image (Image, Socket)
edges_sub_pix (Image, Edges, 'canny', 1.5, 20, 40)
send_xld (Edges, Socket)
receive_xld (Polygons, Socket)
split_contours_xld (Polygons, Contours, 'polygon', 1, 5)
gen_p...",18,30,"* --- Automatically Added Context ---
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
* --- End of Automatically Added Context ---"
08da63a7,micro,4,,close_socket (Socket),31,32,"* --- Automatically Added Context ---
socket_accept_connect (AcceptingSocket, 'true', Socket)
* --- End of Automatically Added Context ---"
08da63a7,micro,5,,close_socket (AcceptingSocket),33,40,"* --- Automatically Added Context ---
open_socket_accept (3000, 'protocol', 'HALCON4', AcceptingSocket)
* --- End of Automatically Added Context ---"
3fca57a9,full,0,"***********************************************************************
This example program shows h...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'mreut')
send_image (Image, Socket)
receive_xld (Edges, Socket)
gen_polygons_xld (Edges, Polygons, 'ramer', 2)
send_xld (Polygon...",14,31,
3fca57a9,micro,1,"This example program shows how to use the HALCON socket functionality
to transfer image and XLD obje...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_colored (12)",6,16,
3fca57a9,micro,2,,"open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
read_image (Image, 'mreut')
send_image (Image, Socket)
receive_xld (Edges, Socket)
gen_polygons_xld (Edges, Polygons, 'ramer', 2)
send_xld (Polygons, Socket)
split_contours_xld (Polygons, Contours, 'polygon', 1, 5)
receive_xld (Parallels, Socke...",17,29,
3fca57a9,micro,3,,close_socket (Socket),30,37,"* --- Automatically Added Context ---
open_socket_connect ('127.0.0.1', 3000, [], [], Socket)
* --- End of Automatically Added Context ---"
e29cd21f,full,0,"This example program shows how to use compose_funct_1d.  It computes
two functions, atan(x) and cos(...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('black')
dev_set_line_width (2)
X := []
for J := -125 to 125 by 1
X := [X,J / 40.0]
endfor
create_funct_1d_pairs (X, cos(X), Cos)
...",12,42,
e29cd21f,micro,1,"two functions, atan(x) and cos(x), and composes them, which results in the
function cos(atan(x)).  T...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('black')
dev_set_line_width (2)
X := []
for J := -125 to 125 by 1
X := [X,J / 40.0]
endfor
create_funct_1d_pairs (X, cos(X), Cos)
...",6,49,
50234269,full,0,"This example program shows how to use invert_funct_1d.  It computes
a function, cos(x), and inverts ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_set_color ('black')
X := []
for J := 0 to 360 by 1
X := [X,rad(J) / 2]
endfor
create_funct_1d_pairs (X, cos(X), Cos)
X...",11,36,
50234269,micro,1,"a function, cos(x), and inverts it, which results in the function inv(cos(x)).
This function should,...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_set_color ('black')
X := []
for J := 0 to 360 by 1
X := [X,rad(J) / 2]
endfor
create_funct_1d_pairs (X, cos(X), Cos)
X...",6,42,
a9afd1e6,full,0,Calculate transformation parameters between two functions,"NPT := 100
MPT := 100
GM := [30.0, 65.0]
GS := [15.0, 25.0]
GA := [20.0, 15.0]
E := [0.8, 20.0, 1.4, -10.0]
X1 := []
Y1 := []
for I := 0 to NPT - 1 by 1
X := E[2] * I + E[3]
Y := GA[0] * exp(-pow((X - GM[0]) / GS[0],2)) + GA[1] * exp(-pow((X - GM[1]) / GS[1],2))
F := E[0] * Y + E[1]
X1 := [X1,I]
Y1 ...",8,52,
a9afd1e6,micro,1,,"NPT := 100
MPT := 100
GM := [30.0, 65.0]
GS := [15.0, 25.0]
GA := [20.0, 15.0]
E := [0.8, 20.0, 1.4, -10.0]
X1 := []
Y1 := []
for I := 0 to NPT - 1 by 1
X := E[2] * I + E[3]
Y := GA[0] * exp(-pow((X - GM[0]) / GS[0],2)) + GA[1] * exp(-pow((X - GM[1]) / GS[1],2))
F := E[0] * Y + E[1]
X1 := [X1,I]
Y1 ...",6,32,
a9afd1e6,micro,2,,"create_funct_1d_array (Y1, F1)
create_funct_1d_array (Y2, F2)
match_funct_1d_trans (F1, F2, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsF1, ChiSquareF1, CovarF1)
match_funct_1d_trans (F2, F1, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsB1, ...",33,37,"* --- Automatically Added Context ---
Y1 := []
Y2 := []
* --- End of Automatically Added Context ---"
a9afd1e6,micro,3,,"transform_funct_1d (F2, ParamsF1, F2Trans)
transform_funct_1d (F1, ParamsB1, F1Trans)",38,40,"* --- Automatically Added Context ---
create_funct_1d_array (Y1, F1)
create_funct_1d_array (Y2, F2)
match_funct_1d_trans (F1, F2, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], Pa..."
a9afd1e6,micro,4,,"sample_funct_1d (F2Trans, 0, NPT - 1, 1, 'constant', F2Sampled)
sample_funct_1d (F1Trans, 0, MPT - 1, 1, 'constant', F1Sampled)",41,43,"* --- Automatically Added Context ---
NPT := 100
MPT := 100
transform_funct_1d (F2, ParamsF1, F2Trans)
transform_funct_1d (F1, ParamsB1, F1Trans)
* --- End of Automatically Added Context ---"
a9afd1e6,micro,5,,"create_funct_1d_pairs (X1, Y1, F3)
create_funct_1d_pairs (X2, Y2, F4)
match_funct_1d_trans (F3, F4, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsF2, ChiSquareF2, CovarF2)
match_funct_1d_trans (F4, F3, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], Pa...",44,58,"* --- Automatically Added Context ---
NPT := 100
MPT := 100
X1 := []
Y1 := []
X2 := []
Y2 := []
* --- End of Automatically Added Context ---"
495f0279,full,0,Measure time to calculate transformation parameters between two functions,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_update_time ('off')
NPT := 100
MPT := 100
GM := [30.0, 65.0]
GS := [15.0, 25.0]
GA := [20.0, 15.0]
E := [0.8, 20.0, 1.4, -10.0]
X1 := []
Y1 := []
for I := 0 to NPT - 1 by 1
X := E[2] * I + E[3]
Y := GA[0] * exp(-pow((X - GM[0...",8,57,
495f0279,micro,1,,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
dev_update_time ('off')
NPT := 100
MPT := 100
GM := [30.0, 65.0]
GS := [15.0, 25.0]
GA := [20.0, 15.0]
E := [0.8, 20.0, 1.4, -10.0]
X1 := []
Y1 := []
for I := 0 to NPT - 1 by 1
X := E[2] * I + E[3]
Y := GA[0] * exp(-pow((X - GM[0...",6,36,
495f0279,micro,2,,"create_funct_1d_array (Y1, F1)
create_funct_1d_array (Y2, F2)
count_seconds (S1)",37,40,"* --- Automatically Added Context ---
Y1 := []
Y2 := []
* --- End of Automatically Added Context ---"
495f0279,micro,3,,"for I := 1 to 1000 by 1
match_funct_1d_trans (F1, F2, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsF1, ChiSquareF1, CovarF1)
match_funct_1d_trans (F2, F1, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsB1, ChiSquareB1, CovarB1)
endfor
count_sec...",41,47,"* --- Automatically Added Context ---
for I := 0 to NPT - 1 by 1
create_funct_1d_array (Y1, F1)
create_funct_1d_array (Y2, F2)
count_seconds (S1)
* --- End of Automatically Added Context ---"
495f0279,micro,4,,"create_funct_1d_pairs (X1, Y1, F3)
create_funct_1d_pairs (X2, Y2, F4)
count_seconds (S1)
for I := 1 to 1000 by 1
match_funct_1d_trans (F3, F4, 'constant', [1.0, 0.0, 1.0, 0.0], ['true', 'true', 'true', 'true'], ParamsF4, ChiSquareF4, CovarF4)
match_funct_1d_trans (F4, F3, 'constant', [1.0, 0.0, 1.0,...",48,63,"* --- Automatically Added Context ---
X1 := []
Y1 := []
for I := 0 to NPT - 1 by 1
X2 := []
Y2 := []
count_seconds (S1)
count_seconds (S2)
* --- End of Automatically Added Context ---"
ce87b6d9,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
RowA1 := 255
ColumnA1 := 10
RowA2 := 255
ColumnA2 := 501
dev_set_color ('black')
disp_line (WindowID, RowA1, ColumnA1, RowA2, ColumnA2)
RowB1 := 255
ColumnB1 := 255
for i := 1 to 360 by 1
RowB2 := 255 + sin(rad(i)) * 200
ColumnB...",6,21,
f87aa8eb,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
RowA1 := 255
ColumnA1 := 10
RowA2 := 255
ColumnA2 := 501
dev_set_color ('red')
disp_line (WindowID, RowA1, ColumnA1, RowA2, ColumnA2)
dev_set_color ('black')
RowB1 := 255
ColumnB1 := 255
for i := 1 to 360 by 1
RowB2 := 255 + sin...",6,22,
8dd9fdd6,full,0,"Show difference between distance_contours_xld and
apply_distance_transform_xld
Init visualization","dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example shows the speed difference between the operators'
Message[1] := 'distance_contours_xld and apply_distance_transform_xld.'
Messag...",10,181,
8dd9fdd6,micro,1,,"dev_close_window ()
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",9,13,
8dd9fdd6,micro,2,,"Message := 'This example shows the speed difference between the operators'
Message[1] := 'distance_contours_xld and apply_distance_transform_xld.'
Message[2] := 'Both operators measure the pointwise distance between'
Message[3] := 'two contours.'
Message[4] := ' '
Message[5] := 'While distance_conto...",14,29,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
8dd9fdd6,micro,3,"'point_to_point' is faster,
'point_to_segment' is more accurate.","Mode := 'point_to_point'
* Mode := 'point_to_segment'
Tolerance := 7
Loops := 4
Legend := ['Legend:', '- template contour', '- random test contour within tolerance', '- random test contour outside of tolerance']",30,38,
8dd9fdd6,micro,4,the pointwise distance between two contours,"for I := 1 to Loops by 1
gen_test_contours (EdgeOriginal, EdgeWarped)
count_seconds (S1)
distance_contours_xld (EdgeWarped, EdgeOriginal, EdgeWarpedWithDistances, Mode)
count_seconds (S2)
get_contour_attrib_xld (EdgeWarpedWithDistances, 'distance', Distance)
segment_contour_attrib_xld (EdgeWarpedWit...",41,65,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
Message := 'This example shows the speed difference between the operators'
Mode := 'point_to_poi..."
8dd9fdd6,micro,5,"pointwise distance to changing contours to a not
changing reference contour.
To accelerate the calcu...","dev_clear_window ()
disp_message (WindowHandle, 'Please wait while pre-calculating distance transform...', 'window', 42, 12, 'white', 'false')",68,76,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
* --- End of Automatically Added Context ---"
8dd9fdd6,micro,6,"(this may take a while, depending on the size of the contour
and MaxDistance)
The parameter MaxDista...","MaxDistance := 8
create_distance_transform_xld (EdgeOriginal, Mode, MaxDistance, DistanceTransformID)
for I := 1 to Loops by 1
gen_test_contours (NotUsedOriginal, TestContour)
count_seconds (S1)
apply_distance_transform_xld (TestContour, TestContourOut, DistanceTransformID)
count_seconds (S2)
get_co...",77,191,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 1280, 1024, -1, -1, WindowHandle)
Message := 'This example shows the speed difference between the operators'
Mode := 'point_to_poi..."
11db28c9,full,0,"Example for area_intersection_rectangle2 operator.
Define the first oriented rectangle.","Row1 := 100
Col1 := 100
Phi1 := rad(30)
Length11 := 60
Length21 := 20
Row2 := 100
Col2 := 100
Phi2 := rad(-30)
Length12 := 60
Length22 := 20
area_intersection_rectangle2 (Row1, Col1, Phi1, Length11, Length21, Row2, Col2, Phi2, Length12, Length22, AreaIntersection)
gen_rectangle2 (Rectangle1, Row1, C...",9,35,
11db28c9,micro,1,,"Row1 := 100
Col1 := 100
Phi1 := rad(30)
Length11 := 60
Length21 := 20",8,14,
11db28c9,micro,2,,"Row2 := 100
Col2 := 100
Phi2 := rad(-30)
Length12 := 60
Length22 := 20",15,21,
11db28c9,micro,3,,"area_intersection_rectangle2 (Row1, Col1, Phi1, Length11, Length21, Row2, Col2, Phi2, Length12, Length22, AreaIntersection)",22,24,"* --- Automatically Added Context ---
Row1 := 100
Col1 := 100
Phi1 := rad(30)
Length11 := 60
Length21 := 20
Row2 := 100
Col2 := 100
Phi2 := rad(-30)
Length12 := 60
Length22 := 20
* --- End of Automati..."
11db28c9,micro,4,,"gen_rectangle2 (Rectangle1, Row1, Col1, Phi1, Length11, Length21)
gen_rectangle2 (Rectangle2, Row2, Col2, Phi2, Length12, Length22)
intersection (Rectangle1, Rectangle2, RegionIntersection)
area_center (RegionIntersection, AreaIntersectionRegion, Row, Column)",25,30,"* --- Automatically Added Context ---
Row1 := 100
Col1 := 100
Phi1 := rad(30)
Length11 := 60
Length21 := 20
Row2 := 100
Col2 := 100
Phi2 := rad(-30)
Length12 := 60
Length22 := 20
* --- End of Automati..."
11db28c9,micro,5,"a pixel-precise approximation of the original oriented rectangles.
The operator area_intersection_re...",Difference := AreaIntersectionRegion - AreaIntersection,31,41,"* --- Automatically Added Context ---
area_intersection_rectangle2 (Row1, Col1, Phi1, Length11, Length21, Row2, Col2, Phi2, Length12, Length22, AreaIntersection)
area_center (RegionIntersection, AreaI..."
9d7e46b3,full,0,"Example for distance_cc_min operator. *
This example shows the differences of the single metrics (mo...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_color ('white')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
SampleWidths := [1:.5:25]
for I := 0 to |SampleWidths| - 1 by 1
SampleWidth := SampleWidths[I]
gen_contour_polygon_rounde...",8,58,
9d7e46b3,micro,1,This example shows the differences of the single metrics (modes) provided by distance_cc_min.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_color ('white')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
SampleWidths := [1:.5:25]",6,13,
9d7e46b3,micro,2,every loop increases the sample width of the contours (fine to coarse),"for I := 0 to |SampleWidths| - 1 by 1
SampleWidth := SampleWidths[I]
gen_contour_polygon_rounded_xld (Edge1, [10, 500, 500, 10, 10], [10, 10, 500, 500, 10], [245, 245, 245, 245, 245], SampleWidth)
gen_contour_polygon_rounded_xld (Edge2, [100, 480, 480, 100, 100], [100, 100, 480, 480, 100], [190, 190...",14,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
SampleWidths := [1:.5:25]
* --- End of Automatically Added Context ---"
9d7e46b3,micro,3,,"dev_clear_window ()
Colors := ['red', 'green', 'yellow']
plot_tuple (WindowHandle, SampleWidths, [Min1,Min2,Min3], 'Sample Width', 'Minimal Distance', Colors, ['ticks_x', 'ticks_y', 'margin_top'], [4, 1, 85])
Message := ['Minimal distances between contours', 'with varying sample widths', 'computed b...",52,65,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
SampleWidths := [1:.5:25]
Min1[I] := DistanceMin1
Min2[I] := DistanceMin2
Min3[I] := DistanceMin3
Message ..."
a1d7b265,full,0,"This example program shows how to use the operator distance_cc_min_points.
This operator calculates ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_ellipse_contour_xld (ContEllipse1, 200.5, 200.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (ContEllipse2, 342, 342.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)
distan...",10,40,
a1d7b265,micro,1,"This operator calculates the minimum distance between two contours
and returns the points used for t...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)",6,13,
a1d7b265,micro,2,,"gen_ellipse_contour_xld (ContEllipse1, 200.5, 200.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (ContEllipse2, 342, 342.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)",14,17,
a1d7b265,micro,3,,"distance_cc_min_points (ContEllipse1, ContEllipse2, 'fast_point_to_segment', DistanceMin, Row1Min, Col1Min, Row2Min, Col2Min)",18,20,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (ContEllipse1, 200.5, 200.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (ContEllipse2, 342, 342.5, -rad(45), ..."
a1d7b265,micro,4,,"get_contour_xld (ContEllipse1, Row1, Col1)
get_contour_xld (ContEllipse2, Row2, Col2)
concat_obj (ContEllipse1, ContEllipse2, ObjectsConcat)
gen_cross_contour_xld (Cross1, Row1, Col1, 0.2, 0.785398)
gen_cross_contour_xld (Cross2, Row2, Col2, 0.2, 0.785398)
gen_cross_contour_xld (Cross1Min, Row1Min, ...",21,46,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (ContEllipse1, 200.5, 200.5, -rad(45), 100, 15, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (ContEllipse2, 342, 342.5, -rad(45), ..."
505c5988,full,0,Calculate the distance between one line and one region,"dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 100000000)
dev_clear_window ()
dev_set_color ('black')
...",8,28,
505c5988,micro,1,,"dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)",6,12,
505c5988,micro,2,,"select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 100000000)
dev_clear_window ()
dev_set_color ('black')
dev_display (SelectedRegions)
Row1 := 100
Row2 := 400
for Col := 50 to 400 by 4
distance_lr (SelectedRegions, Row1, Col + 100, Row2, Col, DistanceMin, DistanceMax)
if (Distanc...",13,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
connection (Region, ConnectedRegions)
* --- End of Automatically Added Context ---"
e67c9288,full,0,"Example program for distance_pc
Determine the minimal and maximal radius of drill holes","dev_close_window ()
read_image (Rim, 'rim')
get_image_size (Rim, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Rim)
set_display_font (WindowID, 14, 'mono', 'false', 'false')
edges_sub_pix (Rim, Edges, 'canny', 4, 20, 40)
select_shape_xld (Edges, Holes, 'circula...",9,42,
e67c9288,micro,1,Determine the minimal and maximal radius of drill holes,"dev_close_window ()
read_image (Rim, 'rim')
get_image_size (Rim, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
dev_display (Rim)
set_display_font (WindowID, 14, 'mono', 'false', 'false')",6,14,
e67c9288,micro,2,"The alpha parameter was chosen different than the default value
to ensure stronger smoothing and thu...","edges_sub_pix (Rim, Edges, 'canny', 4, 20, 40)
select_shape_xld (Edges, Holes, 'circularity', 'and', 0.7, 1.0)
sort_contours_xld (Holes, Holes, 'upper_left', 'true', 'row')",15,20,"* --- Automatically Added Context ---
read_image (Rim, 'rim')
* --- End of Automatically Added Context ---"
e67c9288,micro,3,,"smallest_circle_xld (Holes, Row, Column, Radius)
count_obj (Holes, Number)
dev_set_color ('yellow')",21,24,"* --- Automatically Added Context ---
select_shape_xld (Edges, Holes, 'circularity', 'and', 0.7, 1.0)
* --- End of Automatically Added Context ---"
e67c9288,micro,4,,"for i := 1 to Number by 1
select_obj (Holes, Hole, i)
dev_display (Rim)
dev_display (Hole)
distance_pc (Hole, Row[i - 1], Column[i - 1], DistanceMin, DistanceMax)
disp_cross (WindowID, Row[i - 1], Column[i - 1], 6, 0)
tuple_string (DistanceMin, '.3f', SVal)
get_string_extents (WindowID, 'min: ' + SV...",25,48,"* --- Automatically Added Context ---
read_image (Rim, 'rim')
dev_open_window (0, 0, Width, Height, 'black', WindowID)
select_shape_xld (Edges, Holes, 'circularity', 'and', 0.7, 1.0)
smallest_circle_x..."
5d3d8a1a,full,0,Calculate the distance between any points and one line,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedR...",8,33,
5d3d8a1a,micro,1,,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedR...",6,26,
5d3d8a1a,micro,2,of the selected region and the displayed line,"for i := 1 to NumberTuple by 20
disp_line (WindowID, Rows[i], Columns[i] - 2, Rows[i], Columns[i] + 2)
disp_line (WindowID, Rows[i] - 2, Columns[i], Rows[i] + 2, Columns[i])
distance_pl (Rows[i], Columns[i], RowLine1, ColLine1, RowLine2, ColLine2, Distance)
endfor",27,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
get_region_contour (SelectedRegions, Rows, Columns)
RowLine1 := 5
ColLine1 := 300
RowLine2 := 300
ColLine2 := ..."
74249f16,full,0,Calculate the distance between two points,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
* dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, Selecte...",8,39,
74249f16,micro,1,,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
* dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, Selecte...",6,23,
74249f16,micro,2,,"gen_circle (Circle, RowPoint, ColPoint, 10)
dev_display (Circle)
dev_set_color ('green')",24,27,"* --- Automatically Added Context ---
RowPoint := 80
ColPoint := 250
* --- End of Automatically Added Context ---"
74249f16,micro,3,of the selected region and the displayed point,"for I := 1 to NumberTuple by 10
gen_cross_contour_xld (Cross, Rows[I], Columns[I], 6, 0.785398)
gen_contour_polygon_xld (Contour, [Rows[I],RowPoint], [Columns[I],ColPoint])
dev_set_color ('green')
dev_display (Cross)
dev_set_color ('white')
dev_display (Contour)
distance_pp (RowPoint, ColPoint, Rows...",28,45,"* --- Automatically Added Context ---
get_region_contour (SelectedRegions, Rows, Columns)
RowPoint := 80
ColPoint := 250
NumberTuple := |Rows|
* --- End of Automatically Added Context ---"
fced2e85,full,0,Calculate the distance between one point and one region,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10000, 100000000)
RowB1 := 255
ColumnB...",8,26,
fced2e85,micro,1,,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10000, 100000000)
RowB1 := 255
ColumnB...",6,19,
fced2e85,micro,2,,"for i := 1 to 360 by 1
RowB2 := 255 + sin(rad(i)) * 200
ColumnB2 := 255 + cos(rad(i)) * 200
disp_line (WindowID, RowB1, ColumnB1, RowB2, ColumnB2)
distance_pr (SelectedRegions, RowB2, ColumnB2, DistanceMin, DistanceMax)
endfor",20,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 10000, 100000000)
RowB1 := 255
ColumnB1 := 255..."
ab3ca5f3,full,0,Calculate the distances between a point and a line segment,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedR...",8,33,
ab3ca5f3,micro,1,,"dev_close_window ()
read_image (Image, 'mreut')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
dev_set_color ('black')
threshold (Image, Region, 180, 255)
dev_clear_window ()
dev_display (Region)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedR...",6,26,
ab3ca5f3,micro,2,of the selected region and the displayed line segment,"for i := 1 to NumberTuple by 10
disp_line (WindowID, Rows[i], Columns[i] - 2, Rows[i], Columns[i] + 2)
disp_line (WindowID, Rows[i] - 2, Columns[i], Rows[i] + 2, Columns[i])
distance_ps (Rows[i], Columns[i], RowLine1, ColLine1, RowLine2, ColLine2, DistanceMin, DistanceMax)
endfor",27,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
get_region_contour (SelectedRegions, Rows, Columns)
RowLine1 := 400
ColLine1 := 50
RowLine2 := 50
ColLine2 := ..."
c1c9085f,full,0,Calculate the distances between one line segment and one line,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 200
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
dev_set_color ('green')
n := 0
for Rows := 40 to 200 ...",8,29,
c1c9085f,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 200
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
dev_set_color ('green')
n := 0
for Rows := 40 to 200 ...",6,35,
f51f33a3,full,0,Calculate the distance between one line segment and one region,"dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 100000000)
dev_clear_window ()
dev_...",8,34,
f51f33a3,micro,1,,"dev_close_window ()
read_image (Image, 'fabrik')
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_display (Image)
threshold (Image, Region, 180, 255)
connection (Region, ConnectedRegions)",6,13,
f51f33a3,micro,2,,"select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 100000000)
dev_clear_window ()
dev_set_color ('black')
dev_display (SelectedRegions)
dev_set_color ('red')
Row1 := 100
Row2 := 400
n := 0",14,22,"* --- Automatically Added Context ---
connection (Region, ConnectedRegions)
* --- End of Automatically Added Context ---"
f51f33a3,micro,3,and the displayed region,"for Col := 50 to 400 by 5
distance_sr (SelectedRegions, Row1 + n, Col, Row2 - n, Col + 100, DistanceMin, DistanceMax)
if (DistanceMin &lt;= 0)
dev_set_color ('green')
else
dev_set_color ('red')
endif
disp_line (WindowID, Row1 + n, Col, Row2 - n, Col + 100)
n := n + 5
endfor",23,40,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
select_shape (ConnectedRegions, SelectedRegions, 'area', 'and', 5000, 100000000)
Row1 := 100
Row2 := 400
* ---..."
81048800,full,0,Calculate the distances between line segments,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 240
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
dev_set_color ('red')
n := 0
for Rows := 40 to 200 by...",8,31,
81048800,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 240
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
dev_set_color ('red')
n := 0",6,19,
81048800,micro,2,and the displayed single line,"for Rows := 40 to 200 by 4
distance_ss (Rows, Columns, Rows + n, Columns + n, RowLine1, ColLine1, RowLine2, ColLine2, DistanceMin, DistanceMax)
if (DistanceMin == 0)
dev_set_color ('green')
else
dev_set_color ('red')
endif
disp_line (WindowID, Rows, Columns, Rows + n, Columns + n)
n := n + 8
endfor",20,37,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
RowLine1 := 400
ColLine1 := 200
RowLine2 := 240
ColLine2 := 400
Rows := 300
Columns := 50
* --- End of Automat..."
b186c8e9,full,0,"This example program shows the different intersection operators, which
compute intersections between...","Interactive := 1
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
display_menu (LabelRegions, WindowHandle, Intro, Instructions, Labels, LabelRow1, LabelColumn1)
ItemSelected := 0
MRow := 0
MColumn := 0
MButton := 0
AutoCounter :=...",31,1283,
b186c8e9,micro,1,"which shows all sections in a row after a short
pause without the need of user interaction",Interactive := 1,28,31,
b186c8e9,micro,2,,"init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
display_menu (LabelRegions, WindowHandle, Intro, Instructions, Labels, LabelRow1, LabelColumn1)",32,35,"* --- Automatically Added Context ---
Interactive := 1
* --- End of Automatically Added Context ---"
b186c8e9,micro,3,,"ItemSelected := 0
MRow := 0
MColumn := 0
MButton := 0
AutoCounter := 0
Timeout := 5
LastSelection := -1
count_seconds (TimeSinceLastInteraction)
dev_set_preferences ('graphics_window_context_menu', 'false')",36,46,
b186c8e9,micro,4,,"while (not ItemSelected)
try
get_mposition (WindowHandle, MRow, MColumn, MButton)
catch (Exception)
MButton := 0
endtry
Highlighted := min([max([0,int(floor((MRow - LabelRow1) / LabelHeight))]),|Labels| - 1])
if (not Interactive)
MButton := 0
Highlighted := AutoCounter
auto_continue_on_timeout (Time...",47,139,"* --- Automatically Added Context ---
Interactive := 1
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
ItemSelected := 0
MRow := ..."
b186c8e9,micro,5,to get the representation of a line,"IntersectionPoints := []
get_window_extents (WindowHandle, Row, Column, Width, Height)
Segment1Column := [0, 0, 0,Width - 1]
Segment2Column := [Width - 1,Width - 1,0,Width - 1]
Segment1Row := [0,Height - 1,0, 0]
Segment2Row := [0,Height - 1,Height - 1,Height - 1]
for I := 0 to |Segment1Column| - 1 b...",140,190,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
* --- End of Automatically Added Context --..."
b186c8e9,micro,6,,"ColorObject1 := 'medium slate blue'
ColorObject2 := 'orange'
ColorIntersection := 'lime green'",191,195,
b186c8e9,micro,7,"e.g., from intersecting to non-intersecting",DelayChange := 1,196,198,
b186c8e9,micro,8,,"DelayNoChange := 0.01
gen_cross_contour_xld (Intersections, Row, Column, 16, rad(45))
gen_rectangle1 (Dummy, 0, 0, 0, 0)",199,204,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, Width, Height)
* --- End of Automatically Added Context ---"
b186c8e9,micro,9,,"set_system ('flush_graphic', 'false')
dev_clear_window ()
disp_message (WindowHandle, Text, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, Message, 'window', 40, 12, 'white', 'false')
if (IsOverlapping)
disp_message (WindowHandle, 'Is Overlapping', 'window', 12, 365, 'red', 'false')
...",205,251,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,10,,"Row1 := [21, 490]
Column1 := [256, 256] + 250
Column2 := [64, 364] + 250
Row2 := [256, 256]
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := (Column2[1] + Column2[0]) * 0.5
RotationCenter2Row := (Row2[1] + Row2[0]) * 0....",256,269,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,11,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",270,329,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,12,,"Column1 := [21, 290] + 250
Row1 := [256, 256]
Column2 := [64, 364] + 250
Row2 := [256, 256]
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := (Column2[1] + Column2[0]) * 0.5
RotationCenter2Row := (Row2[1] + Row2[0]) * 0....",334,347,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,13,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",348,408,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,14,,"Column1 := [21, 490] + 250
Row1 := [256, 256]
Column2 := [64, 364] + 250
Row2 := [256, 256]
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := (Column2[1] + Column2[0]) * 0.5
RotationCenter2Row := (Row2[1] + Row2[0]) * 0....",413,426,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,15,,"NumIntersections := 1
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 4)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, ColumnT...",427,493,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,16,,"Column1 := [41, 470] + 250
Row1 := [256, 256]
Column2 := 221 + 250
Row2 := 256
Radius := 200
StartPhi := rad(45)
EndPhi := rad(135)
PointOrder := 'negative'
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := Column2
Rotat...",498,515,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,17,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",516,578,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,18,,"Column1 := [41, 470] + 250
Row1 := [160, 160]
Column2 := 256 + 250
Row2 := 256
Radius := 100
StartPhi := rad(45)
EndPhi := rad(135)
PointOrder := 'negative'
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := Column2
Rotat...",583,600,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,19,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",601,665,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,20,,"Column1 := 256 + 250
Row1 := 256
r1 := 200
p11 := rad(45)
p12 := rad(135)
po1 := 'negative'
Column2 := 256 + 250
Row2 := 512
r2 := 256
p21 := rad(0)
p22 := rad(315)
po2 := 'positive'
RotationCenter1Column := Column1
RotationCenter1Row := Row1
RotationCenter2Column := Column2
RotationCenter2Row := Ro...",670,691,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,21,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
p11r := p11 + Phi1
p12r := p12 + Phi1
p21r := p21 + Phi2
p22r := p22 + Phi2
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2...",692,759,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,22,,"Column1 := [21, 490] + 250
Row1 := [256, 256]
Column2 := [64, 64, 192, 128, 256, 256, 384, 384, 448] + 250
Row2 := [128, 320, 384, 128, 256, 64, 384, 256, 256]
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := 256 + 250
...",764,777,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,23,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",778,841,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,24,,"Column1 := [21, 490] + 250
Row1 := [256, 256]
Column2 := [64, 64, 192, 128, 256, 256, 384, 384, 448] + 250
Row2 := [128, 320, 384, 128, 256, 64, 384, 256, 256]
RotationCenter1Column := (Column1[1] + Column1[0]) * 0.5
RotationCenter1Row := (Row1[1] + Row1[0]) * 0.5
RotationCenter2Column := 256 + 250
...",846,859,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,25,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",860,924,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,26,,"Column1 := 471
Row1 := 256
Radius := 100
StartPhi := rad(0)
EndPhi := rad(180)
PointOrder := 'positive'
Column2 := [64, 64, 192, 128, 256, 256, 384, 384, 448] + 250
Row2 := [128, 320, 384, 128, 256, 64, 384, 256, 256]
RotationCenter1Column := Column1
RotationCenter1Row := Row1
RotationCenter2Column ...",929,946,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,27,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
p1r := StartPhi + Phi2
p2r := EndPhi + Phi2
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (Hom...",947,1009,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,28,,"Column1 := [128, 320, 384, 128, 256, 64, 384, 256, 256] + 250
Row1 := [64, 64, 192, 128, 256, 256, 384, 384, 448]
Column2 := [64, 64, 192, 128, 256, 256, 384, 384, 448] + 250
Row2 := [128, 320, 384, 128, 256, 64, 384, 256, 256]
RotationCenter1Column := 256 + 250
RotationCenter1Row := 256
RotationCen...",1014,1027,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
intersection_segment_line (Segment1Row[I], ..."
b186c8e9,micro,29,,"NumIntersections := 0
for Alpha := 180 to 0 by -1
Phi1 := rad(Alpha)
Phi2 := rad(Alpha * 3.5)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, Phi1, RotationCenter1Row, RotationCenter1Column, HomMat2DRotate)
affine_trans_pixel (HomMat2DRotate, Row1, Column1, RowTrans1, Colum...",1028,1101,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,30,and define instruction text,"Width := 700
Height := 512
dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_clear_window ()
dev_set_line_width (2)
dev_set_colored (12)
dev_se...",1102,1117,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
get_window_extents (WindowHandle, Row, Colu..."
b186c8e9,micro,31,,"Labels := 'intersection_segments'
Labels[1] := 'intersection_segment_line'
Labels[2] := 'intersection_lines'
Labels[3] := 'intersection_segment_circle'
Labels[4] := 'intersection_line_cirlce'
Labels[5] := 'intersection_circles'
Labels[6] := 'intersection_segment_contour_xld'
Labels[7] := 'intersecti...",1118,1182,"* --- Automatically Added Context ---
Interactive := 1
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
* --- End of Automatically..."
b186c8e9,micro,32,"to switch to the next demo section after a given
time specified in Timeout.
This is done by virtuall...","MButtonOut := MButton
AutoCounterOut := AutoCounter
HighlightedOut := Highlighted
count_seconds (Now)
if (Now - TimeSinceLastInteraction &gt; Timeout)
if (AutoCounterOut &gt; MaxCounter)
MButtonOut := 4
else
HighlightedOut := AutoCounter
AutoCounterOut := AutoCounter + 1
MButtonOut := 1
endif
endif
...",1183,1237,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
AutoCounter := 0
Timeout := 5
MRow := 0
MBu..."
b186c8e9,micro,33,,"dev_set_color ('black')
dev_set_draw ('margin')
dev_display (LabelRegions)
select_obj (LabelRegions, LabelHighlighted, Highlighted + 1)
dev_set_color ('#00B900')
dev_display (LabelHighlighted)
return ()
dev_clear_window ()
disp_message (WindowHandle, Intro, 'window', 12, 12, 'white', 'false')
disp_m...",1238,1297,"* --- Automatically Added Context ---
init_menu (LabelRegions, Interactive, Labels, LabelRow1, LabelColumn1, LabelHeight, Intro, Instructions, WindowHandle)
MRow := 0
Highlighted := min([max([0,int(fl..."
89fa760f,full,0,Calculate the projection of a point onto a line,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 240
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
n := 0
for Rows := 40 to 200 by 4
dev_set_color ('red...",8,29,
89fa760f,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
dev_set_color ('black')
RowLine1 := 400
ColLine1 := 200
RowLine2 := 240
ColLine2 := 400
Rows := 300
Columns := 50
disp_line (WindowID, RowLine1, ColLine1, RowLine2, ColLine2)
n := 0
for Rows := 40 to 200 by 4
dev_set_color ('red...",6,35,
9672d7fe,full,0,This example illustrates how to use the operator gen_arbitrary_distortion_map.,"GridSpacing := 50
dev_update_window ('off')
read_image (Image, 'calib/grid_space.cal.k.000')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width * 0.5, Height * 0.5, 'black', DistortedWindow)
set_display_font (DistortedWindow, 14, 'mono', 'true', 'false')
dev_set_p...",8,52,
9672d7fe,micro,1,,"GridSpacing := 50
dev_update_window ('off')
read_image (Image, 'calib/grid_space.cal.k.000')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width * 0.5, Height * 0.5, 'black', DistortedWindow)
set_display_font (DistortedWindow, 14, 'mono', 'true', 'false')
dev_set_p...",6,20,
9672d7fe,micro,2,"the HALCONROOT/calib directory, or use an absolute path","CaltabDescrName := 'caltab_small.descr'
for I := 0 to 8 by 1
dev_set_window (DistortedWindow)
read_image (Image, 'calib/grid_space.cal.k.' + (I$'03'))
dev_display (Image)
find_caltab (Image, Caltab, CaltabDescrName, 3, 112, 5)
find_marks_and_pose (Image, Caltab, CaltabDescrName, StartCamParam, 128, ...",21,58,"* --- Automatically Added Context ---
GridSpacing := 50
read_image (Image, 'calib/grid_space.cal.k.000')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * 0.5, Height * 0.5, 'black'..."
d465ccb3,full,0,"This example illustrates how to use the operators for the grid-rectification.
The following command ...","WidthOfGrid := 0.17
NumSquares := 17
create_rectification_grid (WidthOfGrid, NumSquares, 'rectification_grid.ps')
read_image (Image, 'can_with_grid')
get_image_size (Image, ImageWidth, ImageHeight)
dev_close_window ()
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
...",11,97,
d465ccb3,micro,1,"that contains the rectification grid. This grid must be
printed. Then it must be mounted on the obje...","WidthOfGrid := 0.17
NumSquares := 17
create_rectification_grid (WidthOfGrid, NumSquares, 'rectification_grid.ps')",8,14,
d465ccb3,micro,2,and reopen the window with an appropriate size.,"read_image (Image, 'can_with_grid')
get_image_size (Image, ImageWidth, ImageHeight)
dev_close_window ()
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
dev_display (Image)
dev_update_off ()
set_display_font (WindowID1, 14, 'mono', 'true', 'false')",15,25,
d465ccb3,micro,3,,"MinContrast := 25
Radius := 10
find_rectification_grid (Image, GridRegion, MinContrast, Radius)
dev_display (GridRegion)
disp_message (WindowID1, 'Grid region', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowID1, 'black', 'true')
stop ()
reduce_domain (Image, GridRegion, ImageReduce...",33,43,"* --- Automatically Added Context ---
read_image (Image, 'can_with_grid')
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
* --- End of Automatically Added Context ---"
d465ccb3,micro,4,,"SigmaSaddlePoints := 1.5
Threshold := 5
saddle_points_sub_pix (ImageReduced, 'facet', SigmaSaddlePoints, Threshold, Row, Col)
dev_set_color ('blue')
gen_cross_contour_xld (SaddlePoints, Row, Col, 6, 0.785398)
dev_display (Image)
dev_display (SaddlePoints)
disp_message (WindowID1, 'Grid points', 'win...",44,56,"* --- Automatically Added Context ---
read_image (Image, 'can_with_grid')
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
disp_message (WindowID1, 'Grid region', 'win..."
d465ccb3,micro,5,,"SigmaConnectGridPoints := 0.9
MaxDist := 5.0
GridSpacing := 20
dev_set_color ('red')
connect_grid_points (ImageReduced, ConnectingLines, Row, Col, SigmaConnectGridPoints, MaxDist)
dev_display (ConnectingLines)
disp_message (WindowID1, 'Connected grid points', 'window', 12, 12, 'black', 'true')
disp_...",57,68,"* --- Automatically Added Context ---
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
reduce_domain (Image, GridRegion, ImageReduced)
saddle_points_sub_pix (ImageRedu..."
d465ccb3,micro,6,,"gen_grid_rectification_map (ImageReduced, ConnectingLines, Map, Meshes, GridSpacing, 0, Row, Col, 'bilinear')
map_image (ImageReduced, Map, ImageMapped)
get_image_size (Map, MapWidth, MapHeight)
dev_open_window (0, (ImageWidth * 0.75) + 12, MapWidth, MapHeight, 'black', WindowID2)
set_display_font (...",69,80,"* --- Automatically Added Context ---
get_image_size (Image, ImageWidth, ImageHeight)
reduce_domain (Image, GridRegion, ImageReduced)
saddle_points_sub_pix (ImageReduced, 'facet', SigmaSaddlePoints, T..."
d465ccb3,micro,7,,"read_image (Image, 'can')",85,87,"* --- Automatically Added Context ---
read_image (Image, 'can_with_grid')
* --- End of Automatically Added Context ---"
d465ccb3,micro,8,,"dev_set_window (WindowID2)
map_image (Image, Map, ImageMapped)
dev_set_window (WindowID1)
dev_display (Image)
disp_message (WindowID1, 'Original image', 'window', 12, 12, 'black', 'true')
dev_set_window (WindowID2)
dev_display (ImageMapped)
disp_message (WindowID2, 'Rectified image', 'window', 12, 1...",88,103,"* --- Automatically Added Context ---
read_image (Image, 'can_with_grid')
dev_open_window (0, 0, ImageWidth * 0.75, ImageHeight * 0.75, 'black', WindowID1)
gen_grid_rectification_map (ImageReduced, Co..."
c23cc63a,full,0,"Detect lines in an image with the help of the Hough transform
and return it in HNF","read_image (Image, 'fabrik')
rectangle1_domain (Image, ImageReduced, 230, 180, 330, 280)
sobel_amp (ImageReduced, EdgeAmplitude, 'thin_sum_abs', 3)
dev_set_color ('red')
threshold (EdgeAmplitude, Region, 10, 255)
hough_lines (Region, 4, 50, 5, 5, Angle, Dist)
dev_set_color ('blue')
gen_region_hline ...",9,18,
c23cc63a,micro,1,and return it in HNF,"read_image (Image, 'fabrik')
rectangle1_domain (Image, ImageReduced, 230, 180, 330, 280)",6,10,
c23cc63a,micro,2,,"sobel_amp (ImageReduced, EdgeAmplitude, 'thin_sum_abs', 3)
dev_set_color ('red')
threshold (EdgeAmplitude, Region, 10, 255)
hough_lines (Region, 4, 50, 5, 5, Angle, Dist)
dev_set_color ('blue')",11,16,"* --- Automatically Added Context ---
rectangle1_domain (Image, ImageReduced, 230, 180, 330, 280)
* --- End of Automatically Added Context ---"
c23cc63a,micro,3,,"gen_region_hline (Regions, Angle, Dist)",17,24,"* --- Automatically Added Context ---
hough_lines (Region, 4, 50, 5, 5, Angle, Dist)
* --- End of Automatically Added Context ---"
fdc2008d,full,0,"Detect lines in an image with the help of the Hough transform
using the edge direction as additional...","read_image (Image, 'fabrik')
rectangle1_domain (Image, ImageReduced, 170, 280, 310, 360)
sobel_dir (ImageReduced, EdgeAmplitude, EdgeDirection, 'sum_abs', 3)
dev_set_color ('red')
threshold (EdgeAmplitude, Region, 55, 255)
reduce_domain (EdgeDirection, Region, EdgeDirectionReduced)
hough_lines_dir (...",10,29,
fdc2008d,micro,1,"using the edge direction as additional information and return it both
in HNF and as regions","read_image (Image, 'fabrik')
rectangle1_domain (Image, ImageReduced, 170, 280, 310, 360)",6,11,
fdc2008d,micro,2,,"sobel_dir (ImageReduced, EdgeAmplitude, EdgeDirection, 'sum_abs', 3)
dev_set_color ('red')
threshold (EdgeAmplitude, Region, 55, 255)",12,15,"* --- Automatically Added Context ---
rectangle1_domain (Image, ImageReduced, 170, 280, 310, 360)
* --- End of Automatically Added Context ---"
fdc2008d,micro,3,,"reduce_domain (EdgeDirection, Region, EdgeDirectionReduced)",16,17,"* --- Automatically Added Context ---
sobel_dir (ImageReduced, EdgeAmplitude, EdgeDirection, 'sum_abs', 3)
threshold (EdgeAmplitude, Region, 55, 255)
* --- End of Automatically Added Context ---"
fdc2008d,micro,4,,"hough_lines_dir (EdgeDirectionReduced, HoughImage, Lines, 4, 2, 'mean', 3, 25, 5, 5, 'true', Angle, Dist)",18,19,"* --- Automatically Added Context ---
reduce_domain (EdgeDirection, Region, EdgeDirectionReduced)
* --- End of Automatically Added Context ---"
fdc2008d,micro,5,,"gen_region_hline (LinesHNF, Angle, Dist)
dev_display (Image)
dev_set_colored (12)",20,23,"* --- Automatically Added Context ---
read_image (Image, 'fabrik')
hough_lines_dir (EdgeDirectionReduced, HoughImage, Lines, 4, 2, 'mean', 3, 25, 5, 5, 'true', Angle, Dist)
* --- End of Automatically ..."
fdc2008d,micro,6,,"dev_set_draw ('margin')
dev_display (LinesHNF)",24,26,"* --- Automatically Added Context ---
gen_region_hline (LinesHNF, Angle, Dist)
* --- End of Automatically Added Context ---"
fdc2008d,micro,7,,"dev_set_draw ('fill')
dev_display (Lines)",27,35,"* --- Automatically Added Context ---
hough_lines_dir (EdgeDirectionReduced, HoughImage, Lines, 4, 2, 'mean', 3, 25, 5, 5, 'true', Angle, Dist)
* --- End of Automatically Added Context ---"
ea094bc5,full,0,"This example program shows how to interpolate scattered data
using the operators interpolate_scatter...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_color ('orange')
dev_set_draw ('margin')
dev_set_line_width (1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Border := 20
for Index := 1 to 4 by 1
FileName := 'scattered_data/scatter...",12,80,
ea094bc5,micro,1,"using the operators interpolate_scattered_data_points_to_image
and interpolate_scattered_data_image....","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_color ('orange')
dev_set_draw ('margin')
dev_set_line_width (1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Border := 20
for Index := 1 to 4 by 1
FileName := 'scattered_data/scatter...",6,86,
8638b97a,full,0,"This example program shows how 128 images of the interior of a church can be
combined into a mosaic ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
dev_set_part (0, 0, 647, 1955)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Reading images...')
gen...",13,194,
8638b97a,micro,1,"combined into a mosaic that covers a 360x130 degree view.  The images were acquired
with a camera in...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
dev_set_part (0, 0, 647, 1955)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_set_color ('yellow')
set_tposition (WindowHandle, 20, 20)
write_string (WindowHandle, 'Reading images...')",6,20,
8638b97a,micro,2,,"gen_empty_obj (Images)
for J := 1 to 128 by 1
read_image (Image, 'panorama/sankt_martin_automatic_' + J$'03d')
concat_obj (Images, Image, Images)
endfor
get_image_size (Image, Width, Height)",21,27,
8638b97a,micro,3,"mosaic images were acquired as 16 vertical strips of 8 images each.
For each image, we match the ima...","FF := [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8]
TT := [2, 9, 3, 10, 4, 11, 5, 12, 6, 13, 7, 14, 8, 15, 16]
From := []
To := []
for J := 0 to 15 by 1
From := [From,(FF - 1 + 8 * J) % 128 + 1]
To := [To,(TT - 1 + 8 * J) % 128 + 1]
endfor",28,39,"* --- Automatically Added Context ---
for J := 1 to 128 by 1
* --- End of Automatically Added Context ---"
8638b97a,micro,4,,"HomMatrices2D := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
for J := 0 to |From| - 1 by 1
select_obj (Images, ImageF, From[J])
select_obj (Images, ImageT, To[J])
points_foerstner (ImageF, 1, 2, 3, 50, 0.1, 'gauss', 'true', RowsF, ColsF, CoRRJunctions, CoRCJunctions, CoCCJunc...",40,95,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
for J := 1 to 128 by 1
get_image_size (Image, Width, Height)
From := []
To := []
* ..."
8638b97a,micro,5,,"stationary_camera_self_calibration (128, 968, 648, 6, From, To, HomMatrices2D, Rows1, Cols1, Rows2, Cols2, NumMatches, 'gold_standard', ['focus', 'principal_point', 'kappa'], 'true', CameraMatrix, Kappa, RotationMatrices, X, Y, Z, Error)
dev_clear_window ()
dev_set_color ('yellow')
set_tposition (Wi...",96,101,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
From := []
To := []
HomMatrices2D := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
*..."
8638b97a,micro,6,,"cam_mat_to_cam_par (CameraMatrix, Kappa, 968, 648, CamParam)
change_radial_distortion_cam_par ('fixed', CamParam, 0, CamParOut)
gen_radial_distortion_map (Map, CamParam, CamParOut, 'bilinear')
map_image (Images, Map, Images)
dev_clear_window ()
dev_set_color ('yellow')
set_tposition (WindowHandle, 2...",102,110,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
stationary_camera_self_calibration (128, 968, 648, 6, From, To, HomMatrices2D, Rows..."
8638b97a,micro,7,"transformations between the images from the camera matrix and the rotation
matrices that are returne...","hom_mat2d_invert (CameraMatrix, CameraMatrixInv)
PermMat := [0.0, 1.0, 0.5, 1.0, 0.0, 0.5, 0.0, 0.0, 1.0]
hom_mat2d_invert (PermMat, PermMatInv)
hom_mat2d_compose (CameraMatrixInv, PermMatInv, CamMatPermInv)
hom_mat2d_compose (PermMat, CameraMatrix, CamMatPerm)
HomMats2D := []
for J := 0 to |From| -...",111,132,"* --- Automatically Added Context ---
for J := 1 to 128 by 1
From := []
To := []
proj_match_points_ransac (ImageFG, ImageTG, RowsF, ColsF, RowsT, ColsT, 'ncc', 10, 0, 0, 648, 968, [rad(-10),rad(40)], ..."
8638b97a,micro,8,"were set to automatic, we calculate 'mult_gray'.  Since the camera is a consumer
camera and therefor...","adjust_mosaic_images (Images, CorrectedImages, From, To, 118, HomMats2D, 'gold_standard', ['mult_gray', 'response', 'vignetting', 'subsampling_4'], 'laguerre')",133,138,"* --- Automatically Added Context ---
gen_empty_obj (Images)
From := []
To := []
HomMats2D := []
* --- End of Automatically Added Context ---"
8638b97a,micro,9,calibrated rotation matrices by rotating them by -5.5 degrees around the x axis.,"hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(-5.5), 'x', 0, 0, 0, HomMat3D)
RotMat := [HomMat3D[0:2],HomMat3D[4:6],HomMat3D[8:10]]
RotMats := []
for J := 0 to 127 by 1
RotMatCalib := RotationMatrices[J * 9:J * 9 + 8]
hom_mat2d_compose (RotMatCalib, RotMat, RotMatRot)
RotMats := [Rot...",139,153,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
for J := 1 to 128 by 1
stationary_camera_self_calibration (128, 968, 648, 6, From, To, HomMatrices2D, Rows..."
8638b97a,micro,10,,"gen_spherical_mosaic (Images, SphericalMosaicOrig, CameraMatrix, RotMats, -90, 90, -180, 180, 0, 'voronoi', 'bilinear')
get_image_size (SphericalMosaicOrig, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (SphericalMosaicOrig)
dev_set_color ('yellow')
set_tp...",154,169,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
gen_empty_obj (Images)
get_image_size (Image, Width, Height)
stationary_camera_self_calibration (128, 968,..."
8638b97a,micro,11,,"gen_spherical_mosaic (CorrectedImages, SphericalMosaicAdjust, CameraMatrix, RotMats, -90, 90, -180, 180, 0, 'voronoi', 'bilinear')
get_image_size (SphericalMosaicAdjust, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (SphericalMosaicAdjust)
dev_set_color ('...",170,185,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
get_image_size (Image, Width, Height)
stationary_camera_self_calibration (128, 968, 648, 6, From, To, HomM..."
8638b97a,micro,12,,"gen_spherical_mosaic (CorrectedImages, SphericalMosaicAdjustBlend, CameraMatrix, RotMats, -90, 90, -180, 180, 0, 'blend', 'bilinear')
get_image_size (SphericalMosaicAdjustBlend, Width, Height)
dev_set_part (0, 0, Height - 1, Width - 1)
dev_clear_window ()
dev_display (SphericalMosaicAdjustBlend)
dev...",186,200,"* --- Automatically Added Context ---
dev_open_window (0, 0, 978, 324, 'black', WindowHandle)
get_image_size (Image, Width, Height)
stationary_camera_self_calibration (128, 968, 648, 6, From, To, HomM..."
20bfb663,full,0,"This example program shows how several images of a PCB can be combined
into a large mosaic image of ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_empty_obj (Images)
for J := 1 to 6 by 1
read_image (Image, 'mosaic/pcb_' + J$'02')
concat_obj (Images, Image, Images)...",13,159,
20bfb663,micro,1,"into a large mosaic image of the PCB.  The program shows how to use
proj_match_points_ransac and gen...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
dev_set_color ('green')
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",6,17,
20bfb663,micro,2,degradations running across the PCB.,"gen_empty_obj (Images)
for J := 1 to 6 by 1
read_image (Image, 'mosaic/pcb_' + J$'02')
concat_obj (Images, Image, Images)
dev_display (Image)
disp_message (WindowHandle, 'Image ' + J$'d', 'window', 12, 12, 'black', 'true')
wait_seconds (1)
endfor
disp_continue_message (WindowHandle, 'black', 'true')...",18,29,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
20bfb663,micro,3,"transformation between the images, we will show all images in a large
tiled image with some space be...","dev_set_window_extents (-1, -1, 640 / 4, 2980 / 4)
tile_images_offset (Images, TiledImage, [0, 500, 1000, 1500, 2000, 2500], [0, 0, 0, 0, 0, 0], [-1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1], [-1, -1, -1, -1, -1, -1], 640, 2980)
dev_clear_window ()
dev_display (TiledIm...",30,40,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
gen_empty_obj (Images)
* --- End of Automatically Added Context ---"
20bfb663,micro,4,"the projective transformation between the image pairs.  Note that the code
below calls the point ope...","dev_clear_window ()
dev_display (TiledImage)
disp_message (WindowHandle, 'Point matches', 'window', 12, 3, 'black', 'true')",41,51,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
tile_images_offset (Images, TiledImage, [0, 500, 1000, 1500, 2000, 2500], [0, 0, 0, 0, 0, 0], [-1, -1, -1,..."
20bfb663,micro,5,,"From := [1, 2, 3, 4, 5]
To := [2, 3, 4, 5, 6]
Num := |From|",52,55,
20bfb663,micro,6,,ProjMatrices := [],56,57,
20bfb663,micro,7,"accumulate all the point correspondences and the number of matches per
image pair.","Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []",58,65,
20bfb663,micro,8,,"for J := 0 to Num - 1 by 1
F := From[J]
T := To[J]
select_obj (Images, ImageF, F)
select_obj (Images, ImageT, T)
points_foerstner (ImageF, 1, 2, 3, 200, 0.3, 'gauss', 'false', RowJunctionsF, ColJunctionsF, CoRRJunctionsF, CoRCJunctionsF, CoCCJunctionsF, RowAreaF, ColAreaF, CoRRAreaF, CoRCAreaF, CoCC...",66,111,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
gen_empty_obj (Images)
for J := 1 to 6 by 1
disp_message (WindowHandle, 'Click \'Run\'\nto continue', 'win..."
20bfb663,micro,9,,"gen_projective_mosaic (Images, MosaicImage, 2, From, To, ProjMatrices, 'default', 'false', MosaicMatrices2D)
get_image_size (MosaicImage, Width, Height)
dev_set_window_extents (-1, -1, Width / 3, Height / 3)
dev_clear_window ()
dev_display (MosaicImage)
disp_message (WindowHandle, 'Projective mosaic...",112,120,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
gen_empty_obj (Images)
From := [1, 2, 3, 4, 5]
To := [2, 3, 4, 5, 6]
ProjMatrices := []
disp_message (Wind..."
20bfb663,micro,10,"mosaicking, we display the seams between the images in the mosaic image.
This can be done most easil...","get_image_size (Image, Width, Height)
gen_image_const (ImageBlank, 'byte', Width, Height)
gen_rectangle1 (Rectangle, 0, 0, Height - 1, Width - 1)
paint_region (Rectangle, ImageBlank, ImageBorder, 255, 'margin')
gen_empty_obj (ImagesBorder)
for J := 1 to 6 by 1
concat_obj (ImagesBorder, ImageBorder, ...",121,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
for J := 1 to 6 by 1
read_image (Image, 'mosaic/pcb_' + J$'02')
From := [1, 2, 3, 4, 5]
To := [2, 3, 4, 5,..."
20bfb663,micro,11,"there is a very slight projective distortion in the mosaic.  This happens
because the transformation...","bundle_adjust_mosaic (6, 1, From, To, ProjMatrices, Rows1, Cols1, Rows2, Cols2, NumMatches, 'rigid', MosaicMatrices2D, Rows, Cols, Error)",143,152,"* --- Automatically Added Context ---
From := [1, 2, 3, 4, 5]
To := [2, 3, 4, 5, 6]
ProjMatrices := []
Rows1 := []
Cols1 := []
Rows2 := []
Cols2 := []
NumMatches := []
gen_projective_mosaic (Images, M..."
20bfb663,micro,12,,"gen_bundle_adjusted_mosaic (Images, MosaicImageRigid, MosaicMatrices2D, 'default', 'false', TransMatrix2D)
get_image_size (MosaicImageRigid, Width, Height)
dev_set_window_extents (-1, -1, Width / 3, Height / 3)
dev_clear_window ()
dev_display (MosaicImageRigid)
disp_message (WindowHandle, 'Rigid mos...",153,165,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'white', WindowHandle)
gen_empty_obj (Images)
gen_projective_mosaic (Images, MosaicImage, 2, From, To, ProjMatrices, 'default', '..."
e85cec00,full,0,"This example program shows how images can be combined
into a mosaic image using proj_match_points_ra...","ImgPath := '3d_machine_vision/mosaic/'
ImgName := 'bga_r_'
Times := []
Colors := ['red', 'coral', 'yellow', 'lime green']
read_image (Images, ImgPath + ImgName + ['01', '06'])
dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 980, 320, 490, WindowHandle)
dev_open_window_fit_...",13,225,
e85cec00,micro,1,,"ImgPath := '3d_machine_vision/mosaic/'
ImgName := 'bga_r_'
Times := []
Colors := ['red', 'coral', 'yellow', 'lime green']
read_image (Images, ImgPath + ImgName + ['01', '06'])
dev_update_off ()
dev_close_window ()
dev_open_window_fit_size (0, 0, 640, 980, 320, 490, WindowHandle)
dev_open_window_fit_...",12,23,
e85cec00,micro,2,(necessary to eliminate radial distortions),"gen_cam_par_area_scan_division (0.0121693, -2675.63, 7.40046e-006, 7.4e-006, 290.491, 258.887, 640, 480, CamParam)
change_radial_distortion_cam_par ('adaptive', CamParam, 0, CamParOut)
change_radial_distortion_image (Images, Images, Images, CamParam, CamParOut)",24,28,"* --- Automatically Added Context ---
read_image (Images, ImgPath + ImgName + ['01', '06'])
* --- End of Automatically Added Context ---"
e85cec00,micro,3,"transformation between the images, we will show both images in a
tiled image with some space between...","tile_images_offset (Images, TiledImage, [0, 500], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], 640, 980)",29,34,"* --- Automatically Added Context ---
read_image (Images, ImgPath + ImgName + ['01', '06'])
* --- End of Automatically Added Context ---"
e85cec00,micro,4,,"From := 1
To := 2
select_obj (Images, ImageF, From)
select_obj (Images, ImageT, To)",35,40,"* --- Automatically Added Context ---
read_image (Images, ImgPath + ImgName + ['01', '06'])
* --- End of Automatically Added Context ---"
e85cec00,micro,5,,"for NumLevels := 1 to 4 by 1
dev_clear_window ()
dev_set_window (WindowHandle)
dev_clear_window ()
dev_display (TiledImage)
disp_message (WindowHandle, ['Calculate point matches','with ' + NumLevels + ' pyramid levels','Please wait ...'], 'window', 20, 10, 'black', 'true')
count_seconds (S1)
proj_ma...",41,90,"* --- Automatically Added Context ---
Times := []
read_image (Images, ImgPath + ImgName + ['01', '06'])
dev_open_window_fit_size (0, 0, 640, 980, 320, 490, WindowHandle)
dev_open_window_fit_size (0, 3..."
e85cec00,micro,6,,"dev_set_window (WindowHandle)
dev_close_window ()
MaxTime := max(Times)
BaseRow := 380
RectHeight := 300
disp_message (WindowHandle1, ['Time in s:', '(#levels used)'], 'image', BaseRow + 20, 10, 'black', 'true')
for Index := 0 to |Times| - 1 by 1
gen_rectangle1 (Rectangle, BaseRow - RectHeight * Tim...",91,130,"* --- Automatically Added Context ---
Times := []
Colors := ['red', 'coral', 'yellow', 'lime green']
dev_open_window_fit_size (0, 0, 640, 980, 320, 490, WindowHandle)
dev_open_window_fit_size (0, 330,..."
e85cec00,micro,7,"the results are restricted to rigid transformations
(instead of projective transformations)",UseRigidTransformation := true,134,137,
e85cec00,micro,8,,"SigmaGrad := 0.7
SigmaSmooth := 2
Alpha := 0.04
Threshold := 50",138,143,
e85cec00,micro,9,,"gen_gauss_pyramid (ImageF, ImageFPyramid, 'constant', 0.5)
gen_gauss_pyramid (ImageT, ImageTPyramid, 'constant', 0.5)",144,146,"* --- Automatically Added Context ---
select_obj (Images, ImageF, From)
select_obj (Images, ImageT, To)
* --- End of Automatically Added Context ---"
e85cec00,micro,10,,HomMat2DGuide := [],147,149,
e85cec00,micro,11,,"for Level := NumLevels to 1 by -1
select_obj (ImageFPyramid, ImageFLevel, Level)
select_obj (ImageTPyramid, ImageTLevel, Level)
points_harris (ImageFLevel, SigmaGrad, SigmaSmooth, Alpha, Threshold, RowsF, ColsF)
points_harris (ImageTLevel, SigmaGrad, SigmaSmooth, Alpha, Threshold, RowsT, ColsT)
if (...",150,210,"* --- Automatically Added Context ---
for NumLevels := 1 to 4 by 1
proj_match_points_ransac_pyramid (ImageF, ImageT, NumLevels, RowFAll, ColFAll, RowTAll, ColTAll, ProjMatrix, Points1, Points2)
RowF :..."
e85cec00,micro,12,"WindowHandle: The window, where the text shall be displayed
Color: defines the text color.
If set to...","Message := '   Program finished.    '
get_window_extents (WindowHandle, Row, Column, Width, Height)
get_string_extents (WindowHandle, ' ' + Message + ' ', Ascent, Descent, TextWidth, TextHeight)
disp_message (WindowHandle, Message, 'window', Height - TextHeight - 10, Width - TextWidth - 10, Color, B...",215,235,"* --- Automatically Added Context ---
dev_open_window_fit_size (0, 0, 640, 980, 320, 490, WindowHandle)
get_image_size (MosaicImage, Width, Height)
* --- End of Automatically Added Context ---"
993b067c,full,0,"This example shows how to use proj_match_points_distortion_ransac to
match two images in a mosaickin...","dev_update_off ()
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Imag...",10,101,
993b067c,micro,1,,dev_update_off (),9,10,
993b067c,micro,2,,"read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image1)
disp_message (...",11,26,
993b067c,micro,3,,"points_foerstner (Image1, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows1, Columns1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows2, Columns2, CoRRJunctions, CoRCJunctions, CoCCJunctions, Row...",27,30,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
* --- End of Automatically Added Context ---"
993b067c,micro,4,"the radial distortions into account to show the errors that are caused
by neglecting the radial dist...","proj_match_points_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard', 2, 42, HomMat2DUnrectified, Points1Unrectified, Points2Unrectified)",31,34,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
points_foerstner (Image1, 1, 2, 3, 50, ..."
993b067c,micro,5,,"concat_obj (Image1, Image2, Images)
gen_projective_mosaic (Images, MosaicImageUnrectified, 1, 1, 2, HomMat2DUnrectified, 'default', 'false', MosaicMatrices2DUnrectified)",35,38,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
proj_match_points_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'n..."
993b067c,micro,6,,"get_image_size (MosaicImageUnrectified, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_clear_window ()
dev_display (MosaicImageUnrectified)",39,43,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
gen_projective_mosaic (Images, MosaicImageUnrectified, 1, 1, 2, HomMat2DUnrectified, 'default', 'false', MosaicMatrices2DUn..."
993b067c,micro,7,,"projective_trans_pixel (MosaicMatrices2DUnrectified[9:17], [0, 493], [0, 0], RowTrans, ColumnTrans)
gen_contour_polygon_xld (Contour, RowTrans, ColumnTrans)
set_line_style (WindowHandle, [1, 5])
dev_set_line_width (1)
dev_set_color ('yellow')
dev_display (Contour)
set_line_style (WindowHandle, [])
d...",44,63,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
gen_projective_mosaic (Images, MosaicImageUnrectified, 1, 1, 2, HomMat2DUnrectified, 'default', 'fals..."
993b067c,micro,8,distortions into account.,"get_image_size (Image1, Width, Height)
proj_match_points_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard', 1, 42, HomMat2D, Kappa, Error, Points1, Points2)",64,67,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
points_foerstner (Image1, 1, 2, 3, 50, ..."
993b067c,micro,9,"i.e., to remove the radial distortions.","gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)",68,70,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
proj_match_points_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, Height, Width, 0, 0..."
993b067c,micro,10,,"change_radial_distortion_cam_par ('fixed', CamParDist, 0, CamPar)
change_radial_distortion_image (Image1, Image1, Image1Rect, CamParDist, CamPar)
change_radial_distortion_image (Image2, Image2, Image2Rect, CamParDist, CamPar)",71,74,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width..."
993b067c,micro,11,fit together perfectly.,"concat_obj (Image1Rect, Image2Rect, ImagesRect)
gen_projective_mosaic (ImagesRect, MosaicImage, 1, 1, 2, HomMat2D, 'default', 'false', MosaicMatrices2D)",75,79,"* --- Automatically Added Context ---
proj_match_points_distortion_ransac (Image1, Image2, Rows1, Columns1, Rows2, Columns2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard', 1, 42, HomMat2D, K..."
993b067c,micro,12,,"get_image_size (MosaicImage, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_clear_window ()
dev_display (MosaicImage)",80,84,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
gen_projective_mosaic (ImagesRect, MosaicImage, 1, 1, 2, HomMat2D, 'default', 'false', MosaicMatrices2D)
* --- End of Autom..."
993b067c,micro,13,,"projective_trans_pixel (MosaicMatrices2D[9:17], [0, 493], [0, 0], RowTrans, ColumnTrans)
gen_contour_polygon_xld (Contour2, RowTrans, ColumnTrans)
set_line_style (WindowHandle, [1, 5])
dev_set_line_width (1)
dev_set_color ('yellow')
dev_display (Contour2)
set_line_style (WindowHandle, [])
dev_set_dr...",85,107,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
projective_trans_pixel (MosaicMatrices2DUnrectified[9:17], [0, 493], [0, 0], RowTrans, ColumnTrans)
g..."
de9e9625,full,0,"This example shows how to use proj_match_points_distortion_ransac_guided
to match two images in a mo...","dev_update_off ()
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Imag...",10,70,
de9e9625,micro,1,,dev_update_off (),9,10,
de9e9625,micro,2,,"read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
get_image_size (Image1, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image1)
disp_message (...",11,26,
de9e9625,micro,3,"initial estimates of the projective transformation and of the radial
distortion coefficient.",Factor := 0.5,27,30,
de9e9625,micro,4,,"zoom_image_factor (Image1, Image1Zoomed, Factor, Factor, 'constant')
zoom_image_factor (Image2, Image2Zoomed, Factor, Factor, 'constant')",31,33,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
Factor := 0.5
* --- End of Automatically Added Context ---"
de9e9625,micro,5,,"points_foerstner (Image1Zoomed, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows1, Cols1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2Zoomed, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows2, Cols2, CoRRJunctions, CoRCJunctions, CoCCJunction...",34,36,"* --- Automatically Added Context ---
zoom_image_factor (Image1, Image1Zoomed, Factor, Factor, 'constant')
zoom_image_factor (Image2, Image2Zoomed, Factor, Factor, 'constant')
* --- End of Automatical..."
de9e9625,micro,6,range for point matches as large as possible.,"get_image_size (Image1Zoomed, Width, Height)",37,39,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
zoom_image_factor (Image1, Image1Zoomed, Factor, Factor, 'constant')
* --- End of Automatically Added Context ---"
de9e9625,micro,7,,"proj_match_points_distortion_ransac (Image1Zoomed, Image2Zoomed, Rows1, Cols1, Rows2, Cols2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard', 1, 42, HomMat2D, Kappa, Error, Points1, Points2)",40,41,"* --- Automatically Added Context ---
get_image_size (Image1, Width, Height)
zoom_image_factor (Image1, Image1Zoomed, Factor, Factor, 'constant')
zoom_image_factor (Image2, Image2Zoomed, Factor, Facto..."
de9e9625,micro,8,,"hom_mat2d_scale_local (HomMat2D, Factor, Factor, HomMat2DGuide)
hom_mat2d_scale (HomMat2DGuide, 1.0 / Factor, 1.0 / Factor, 0, 0, HomMat2DGuide)",42,44,"* --- Automatically Added Context ---
Factor := 0.5
proj_match_points_distortion_ransac (Image1Zoomed, Image2Zoomed, Rows1, Cols1, Rows2, Cols2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard'..."
de9e9625,micro,9,,KappaGuide := Kappa * Factor * Factor,45,46,"* --- Automatically Added Context ---
Factor := 0.5
proj_match_points_distortion_ransac (Image1Zoomed, Image2Zoomed, Rows1, Cols1, Rows2, Cols2, 'ncc', 10, 0, 0, Height, Width, 0, 0.5, 'gold_standard'..."
de9e9625,micro,10,,"points_foerstner (Image1, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows1, Cols1, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
points_foerstner (Image2, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows2, Cols2, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ...",47,49,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
points_foerstner (Image1Zoomed, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows1, Cols..."
de9e9625,micro,11,"projective transformation and of the radial distortion coefficient as
a guide.","proj_match_points_distortion_ransac_guided (Image1, Image2, Rows1, Cols1, Rows2, Cols2, 'ncc', 10, HomMat2DGuide, KappaGuide, 5, 0.5, 'gold_standard', 1, 42, HomMat2D, Kappa, Error, Points1, Points2)",50,53,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
points_foerstner (Image1Zoomed, 1, 2, 3, 50, 0.1, 'gauss', 'true', Rows1, Cols..."
de9e9625,micro,12,"i.e., to remove the radial distortions.","get_image_size (Image1, Width, Height)
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width - 1), 0.5 * (Height - 1), Width, Height, CamParDist)",54,57,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
get_image_size (Image1, Width, Height)
proj_match_points_distortion_ransac (Image1Zoomed, Image2Zoomed, Rows1, Cols1, Ro..."
de9e9625,micro,13,,"change_radial_distortion_cam_par ('fixed', CamParDist, 0, CamPar)
change_radial_distortion_image (Image1, Image1, Image1Rect, CamParDist, CamPar)
change_radial_distortion_image (Image2, Image2, Image2Rect, CamParDist, CamPar)",58,61,"* --- Automatically Added Context ---
read_image (Image1, 'mosaic/building_01')
read_image (Image2, 'mosaic/building_02')
gen_cam_par_area_scan_telecentric_division (1.0, Kappa, 1.0, 1.0, 0.5 * (Width..."
de9e9625,micro,14,fit together perfectly.,"concat_obj (Image1Rect, Image2Rect, ImagesRect)
gen_projective_mosaic (ImagesRect, MosaicImage, 1, 1, 2, HomMat2D, 'default', 'false', MosaicMatrices2D)
get_image_size (MosaicImage, Width, Height)
dev_set_window_extents (-1, -1, Width, Height)
dev_clear_window ()
dev_display (MosaicImage)
disp_messa...",62,76,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
proj_match_points_distortion_ransac (Image1Zoomed, Image2Zoomed, Rows1, Cols1, Rows2, Cols2, 'ncc', 1..."
38c8ae99,full,0,"This example demonstrates how to perform highly accurate mosaicking
through stereo camera calibratio...","dev_update_off ()
ImagePath := '3d_machine_vision/calibrated_mosaic/'
dev_close_window ()
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()
dev_clear_window ()
dev_disp_calibration_text ()
stop ()
...",10,282,
38c8ae99,micro,1,"through stereo camera calibration with the standard HALCON calibration
plate.",dev_update_off (),6,11,
38c8ae99,micro,2,,ImagePath := '3d_machine_vision/calibrated_mosaic/',12,14,
38c8ae99,micro,3,,"dev_close_window ()
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_disp_workflow_text ()
stop ()",15,21,
38c8ae99,micro,4,,"dev_clear_window ()
dev_disp_calibration_text ()
stop ()
dev_close_window ()
dev_open_window (0, 0, 600, 480, 'black', WindowHandle1)
dev_open_window (0, 605, 600, 480, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 16, 'mono', ...",22,32,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
* --- End of Automatically Added Context ---"
38c8ae99,micro,5,,NumCalibImages := 10,37,39,
38c8ae99,micro,6,,"read_image (ImageCam1, ImagePath + '/calib_cam_1_01')
read_image (ImageCam2, ImagePath + '/calib_cam_2_01')
get_image_size (ImageCam1, WidthCam1, HeightCam1)
get_image_size (ImageCam2, WidthCam2, HeightCam2)",40,45,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/calibrated_mosaic/'
* --- End of Automatically Added Context ---"
38c8ae99,micro,7,,"gen_cam_par_area_scan_division (0.012, 0, 4.4e-6, 4.4e-6, WidthCam1 / 2, HeightCam1 / 2, WidthCam1, HeightCam1, StartCamParam1)
gen_cam_par_area_scan_division (0.012, 0, 4.4e-6, 4.4e-6, WidthCam2 / 2, HeightCam2 / 2, WidthCam2, HeightCam2, StartCamParam2)",46,49,"* --- Automatically Added Context ---
get_image_size (ImageCam1, WidthCam1, HeightCam1)
get_image_size (ImageCam2, WidthCam2, HeightCam2)
* --- End of Automatically Added Context ---"
38c8ae99,micro,8,"including the image coordinates of the calibration marks and
the observation poses of the calibratio...","create_calib_data ('calibration_object', 2, 1, CalibDataID)
set_calib_data_cam_param (CalibDataID, 0, [], StartCamParam1)
set_calib_data_cam_param (CalibDataID, 1, [], StartCamParam2)
set_calib_data_calib_object (CalibDataID, 0, 'calplate_160mm.cpd')",50,58,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.012, 0, 4.4e-6, 4.4e-6, WidthCam1 / 2, HeightCam1 / 2, WidthCam1, HeightCam1, StartCamParam1)
gen_cam_par_area_scan_division (0...."
38c8ae99,micro,9,,"for I := 0 to NumCalibImages - 1 by 1
read_image (ImageCam1, ImagePath + '/calib_cam_1_' + (I + 1)$'02d')
read_image (ImageCam2, ImagePath + '/calib_cam_2_' + (I + 1)$'02d')
find_calib_object (ImageCam1, CalibDataID, 0, 0, I, [], [])
get_calib_data_observ_contours (ContoursCam1, CalibDataID, 'marks'...",59,84,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/calibrated_mosaic/'
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
dev_open_window (0, 605, 600, 480, 'black', WindowHan..."
38c8ae99,micro,10,,"calibrate_cameras (CalibDataID, Errors)
dev_set_window (WindowHandle1)
dev_disp_text ('Calibration successful', 'window', 'top', 'left', 'green', [], [])
dev_set_window (WindowHandle2)
dev_disp_text ('Calibration successful', 'window', 'top', 'left', 'green', [], [])
disp_continue_message (WindowHan...",85,93,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
dev_open_window (0, 605, 600, 480, 'black', WindowHandle2)
create_calib_data ('calibration_object', 2, 1,..."
38c8ae99,micro,11,,"dev_close_window ()
dev_close_window ()
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
dev_disp_mosaicking_text ()
stop ()",98,105,"* --- Automatically Added Context ---
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
* --- End of Automatically Added Context ---"
38c8ae99,micro,12,,NumObjects := 2,106,107,
38c8ae99,micro,13,,NumObjImages := 2,108,110,
38c8ae99,micro,14,,"get_calib_data (CalibDataID, 'camera', 0, 'params', CamParam1)
get_calib_data (CalibDataID, 'camera', 1, 'params', CamParam2)",111,114,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
38c8ae99,micro,15,"calibration image which lies in the same plane as the object is
used as the rectification plane (the...","get_calib_data (CalibDataID, 'calib_obj_pose', [0, 0], 'pose', Pose1)",115,122,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
38c8ae99,micro,16,"needs to be corrected by the thickness, which is 4mm here.","set_origin_pose (Pose1, 0, 0, 0.004, Pose1)",123,126,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'calib_obj_pose', [0, 0], 'pose', Pose1)
* --- End of Automatically Added Context ---"
38c8ae99,micro,17,,"get_calib_data (CalibDataID, 'camera', 1, 'pose', RelPose2)",127,128,"* --- Automatically Added Context ---
create_calib_data ('calibration_object', 2, 1, CalibDataID)
* --- End of Automatically Added Context ---"
38c8ae99,micro,18,to be inverted and combined with the absolute pose of the first camera.,"pose_invert (RelPose2, RelPose2Inverted)
pose_compose (RelPose2Inverted, Pose1, Pose2)",129,133,"* --- Automatically Added Context ---
get_calib_data (CalibDataID, 'calib_obj_pose', [0, 0], 'pose', Pose1)
get_calib_data (CalibDataID, 'camera', 1, 'pose', RelPose2)
* --- End of Automatically Added..."
38c8ae99,micro,19,image fits well after the mapping.,"TargetWidth := 1340
TargetHeight := 800
Scale := 0.0002",134,138,
38c8ae99,micro,20,,"Borders := [125, 110, 665, 1222]",139,141,
38c8ae99,micro,21,"A ruler with a thickness of about 2.5mm and a thin brochure which can be
approximated with 0mm thick...","HeightCorrections := [-0.0025, 0]
dev_close_window ()
dev_open_window (0, 0, 600, 480, 'black', WindowHandle1)
dev_open_window (0, 605, 600, 480, 'black', WindowHandle2)
dev_open_window (535, 0, 740, 360, 'black', WindowHandle3)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_displ...",143,155,"* --- Automatically Added Context ---
dev_open_window (0, 605, 600, 480, 'black', WindowHandle2)
dev_open_window (0, 0, 600, 300, 'black', WindowHandle1)
* --- End of Automatically Added Context ---"
38c8ae99,micro,22,"Therefore, we create a map which projects the camera images onto
the rectification plane. Since this...","for OIdx := 0 to NumObjects - 1 by 1
set_origin_pose (Pose1, -0.14, -0.07, HeightCorrections[OIdx], WorldPose1)
set_origin_pose (Pose2, -0.14, -0.07, HeightCorrections[OIdx], WorldPose2)
gen_image_to_world_plane_map (Map1, CamParam1, WorldPose1, WidthCam1, HeightCam1, TargetWidth, TargetHeight, Scal...",156,288,"* --- Automatically Added Context ---
ImagePath := '3d_machine_vision/calibrated_mosaic/'
read_image (ImageCam1, ImagePath + '/calib_cam_1_01')
read_image (ImageCam2, ImagePath + '/calib_cam_2_01')
ge..."
0f83119b,full,0,"This example program reflects an image about an arbitrary axis.  It then
displays the original image...","dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
get_system ('init_new_image', InitNewIm...",10,45,
0f83119b,micro,1,"displays the original image in magenta and the transformed image in
green blended together along wit...","dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)",6,17,
0f83119b,micro,2,output images are initialized.,"get_system ('init_new_image', InitNewImage)
set_system ('init_new_image', 'true')
for A := 0 to 180 by 1
L := 0.75 * max([Width,Height])
Mr := Height / 2.0
Mc := Width / 2.0
Pr := Mr + L * sin(rad(A))
Pc := Mc - L * cos(rad(A))
Qr := Mr - L * sin(rad(A))
Qc := Mc + L * cos(rad(A))
hom_mat2d_identity...",18,51,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Co..."
aac4d7b8,full,0,Add a rotation to a homogeneous 2D transformation matrix,"dev_close_window ()
gen_image_gray_ramp (Gray, 0, 0, 128, 8, 8, 16, 16)
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Row := 8
Col := 8
set_grayval (Gray, Row, Col, 255)
dev_display (Gray)
for phi := 0 to 360 by 6
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(ph...",8,20,
aac4d7b8,micro,1,,"dev_close_window ()
gen_image_gray_ramp (Gray, 0, 0, 128, 8, 8, 16, 16)
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Row := 8
Col := 8
set_grayval (Gray, Row, Col, 255)
dev_display (Gray)
for phi := 0 to 360 by 6
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(ph...",6,26,
bf2377ff,full,0,"This program visualizes the effect of an affine slant transformation by
transforming an image with s...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
hom_mat2d_identity (HomMat2DIdentity)
for Theta := -89 to 89 by 1
hom_mat2d_slant ...",12,29,
bf2377ff,micro,1,"transforming an image with slants from -89° to 89° around the x and y axes.
You can also try angles ...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
hom_mat2d_identity (HomMat2DIdentity)
for Theta := -89 to 89 by 1
hom_mat2d_slant ...",6,35,
c162af75,full,0,"This program shows the use of hom_mat2d_to_affine_par, which decomposes
an affine transformation int...","dev_update_off ()
read_image (Image, 'board/board-01.png')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 500, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
display_instructions (WindowHandle, Win...",14,178,
c162af75,micro,1,,"dev_update_off ()
read_image (Image, 'board/board-01.png')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window_fit_image (Image, 0, 0, 500, -1, WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
display_instructions (WindowHandle, Win...",13,24,
c162af75,micro,2,,"RowTarget := [0, 0,Height,Height]
ColumnTarget := [0,Width,Width,0]
input_affine_trans (WindowHandle, RowTarget, ColumnTarget, Rows, Columns)",25,29,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 500, -1, WindowHandle)
* --- End of Automatically Added Context ---"
c162af75,micro,3,,"vector_to_hom_mat2d (Rows, Columns, RowTarget[0:2], ColumnTarget[0:2], HomMat2D)
calculate_and_display_4th_corner_point (Cross, Contour, Arrow, HomMat2D, Height, Rows, Columns, RowTarget, ColumnTarget, HomMat2DInvert, HomMat2DTmp, HomMat2DInvertAdapted, Row4, Column4)",30,33,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
RowTarget := [0, 0,Height,Height]
ColumnTarget := [0,Width,Width,0]
input_affine_trans (WindowHandle, RowTarget, ColumnTarge..."
c162af75,micro,4,"(but before that, correct the coordinate system)","hom_mat2d_translate (HomMat2D, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
affine_trans_image (Image, ImageAffineTrans, HomMat2DAdapted, 'constant', 'true')",34,39,"* --- Automatically Added Context ---
read_image (Image, 'board/board-01.png')
vector_to_hom_mat2d (Rows, Columns, RowTarget[0:2], ColumnTarget[0:2], HomMat2D)
calculate_and_display_4th_corner_point (..."
c162af75,micro,5,the transformation matrix,"hom_mat2d_to_affine_par (HomMat2D, Sx, Sy, Phi, Theta, Tx, Ty)",40,43,"* --- Automatically Added Context ---
vector_to_hom_mat2d (Rows, Columns, RowTarget[0:2], ColumnTarget[0:2], HomMat2D)
* --- End of Automatically Added Context ---"
c162af75,micro,6,,"dev_set_window (WindowHandle1)
dev_clear_window ()
dev_display (ImageAffineTrans)
Message := 'Transformed image'
Message[1] := ' Scale (Row)          = ' + Sx$' .1f'
Message[2] := ' Scale (Column)       = ' + Sy$' .1f'
Message[3] := ' Slant                = ' + deg(Theta)$' .1f' + '°'
Message[4] := ...",44,163,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window_fit_image (Image, 0, 0, 500, -1, WindowHandle)
display_instructions (WindowHandle, WindowHandle1)
RowTarget ..."
c162af75,micro,7,(just for visualization).,"hom_mat2d_invert (HomMat2D, HomMat2DInvert)
hom_mat2d_translate (HomMat2DInvert, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DInvertAdapted)
affine_trans_pixel (HomMat2DInvertAdapted, Height, 0, Row4, Column4)
gen_cross_contour_xld (Cross, Row4, Column4, 6, 0.78...",164,199,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
RowTarget := [0, 0,Height,Height]
ColumnTarget := [0,Width,Width,0]
input_affine_trans (WindowHandle, RowTarget, ColumnTarge..."
c766716d,full,0,Add a translation to a homogeneous 2D transformation matrix,"dev_close_window ()
gen_image_gray_ramp (Gray, 0, 0, 128, 8, 8, 32, 32)
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Row := 2
Col := 2
set_grayval (Gray, Row, Col, 255)
dev_display (Gray)
for Trans := 0 to 29 by 1
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, Tr...",8,20,
c766716d,micro,1,,"dev_close_window ()
gen_image_gray_ramp (Gray, 0, 0, 128, 8, 8, 32, 32)
dev_open_window (0, 0, 512, 512, 'black', WindowID)
Row := 2
Col := 2
set_grayval (Gray, Row, Col, 255)
dev_display (Gray)
for Trans := 0 to 29 by 1
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_translate (HomMat2DIdentity, Tr...",6,26,
2156f384,full,0,"This program shows how hom_vector_to_proj_hom_mat2d can be used
to specify transformations that move...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')...",8,76,
2156f384,micro,1,to specify transformations that move points at infinity and finite points.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_color ('red')...",6,18,
2156f384,micro,2,,"hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 1, 1, 1], [20, 100, 470, 500], [10, 490, 400, 30], [1, 1, 1, 1], 'dlt', HomMat2D)
projective_trans_image_size (Image, TransImage, HomMat2D, 'bilinear', 512, 512, 'false')
dev_set_part (0, 0, 511, 511)
dev_clear_window ()
dev_displ...",19,29,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
2156f384,micro,3,"the image to a point at infinity in the direction (1,1).  For reasons of numerical
stability, we spe...","hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 1, 1, 1], [0, 0, 512, 512], [0, 512, 512, 0], [1, 1, 0, 1], 'dlt', HomMat2D)
projective_trans_image_size (Image, TransImage, HomMat2D, 'bilinear', 1024, 1024, 'false')
dev_set_part (0, 0, 1023, 1023)
dev_clear_window ()
dev_displa...",30,47,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 1, ..."
2156f384,micro,4,"transforms two points at infinity to two different points at infinity.  Note that
since the points a...","hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 0, 1, 0], [0, 256, 512, 512], [0, 512, 512, 64], [1, 0, 1, 0], 'dlt', HomMat2D)
projective_trans_image_size (Image, TransImage, HomMat2D, 'bilinear', 512, 512, 'false')
dev_set_part (0, 0, 511, 511)
dev_clear_window ()
dev_display...",48,61,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 1, ..."
2156f384,micro,5,"the row axis remains fixed.  Here, numerical problems will not allow us to
specify the direction as ...","hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 0, 1, 0], [0, 128, 512, 512], [0, 512, 512, 0.01], [1, 0, 1, 0], 'dlt', HomMat2D)
projective_trans_image_size (Image, TransImage, HomMat2D, 'bilinear', 512, 512, 'false')
dev_set_part (0, 0, 511, 511)
dev_clear_window ()
dev_displ...",62,82,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
hom_vector_to_proj_hom_mat2d ([0, 0, 512, 512], [0, 512, 512, 0], [1, 1, ..."
c2a2402b,full,0,"This example program shows how to align images based on point-to-line
correspondences. HALCON's metr...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleAlign)
set_display_font (WindowHandle, 14, 'mono', 'true', 'fa...",14,172,
c2a2402b,micro,1,"correspondences. HALCON's metrology model and point_line_to_hom_mat2d are used
to detect the positio...","dev_update_off ()
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle)
dev_open_window (0, 0, Width, Height, 'black', WindowHandleAlign)
set_display_font (WindowHandle, 14, 'mono', 'true', 'fa...",6,23,
c2a2402b,micro,2,"Sometimes the print is also in an incorrect position of the clip.  This will lead
to erroneous regio...","threshold (Image, Region, 100, 255)
fill_up (Region, RegionFillUp)
erosion_rectangle1 (RegionFillUp, RegionROI, 1, 15)",24,30,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
* --- End of Automatically Added Context ---"
c2a2402b,micro,3,"the minimum number of point-to-line correspondences that results in a unique rigid
transformation.","create_metrology_model (MetrologyHandle)
set_metrology_model_image_size (MetrologyHandle, Width, Height)
add_metrology_object_line_measure (MetrologyHandle, [208, 137, 213, 90], [49, 327, 139, 307], [100, 201, 214, 89], [82, 318, 56, 375], 40, 5, 1, 30, ['measure_transition', 'min_score'], ['negativ...",31,36,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
c2a2402b,micro,4,,"apply_metrology_model (Image, MetrologyHandle)
get_metrology_object_result (MetrologyHandle, 'all', 'all', 'result_type', 'row_begin', RowBegin)
get_metrology_object_result (MetrologyHandle, 'all', 'all', 'result_type', 'column_begin', ColBegin)
get_metrology_object_result (MetrologyHandle, 'all', '...",37,42,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
create_metrology_model (MetrologyHandle)
* --- End of Automatically Added Context ---"
c2a2402b,micro,5,"segments.  They will be used to compute the transformation from the current image
to the reference i...","RowRef := 0.5 * (RowBegin + RowEnd)
ColRef := 0.5 * (ColBegin + ColEnd)
dev_set_window (WindowHandle)
dev_display (Image)
dev_set_window (WindowHandleAlign)
dev_display (Image)
get_metrology_object_measures (MeasureContours, MetrologyHandle, 'all', 'all', Row, Column)
dev_set_color ('green')
dev_dis...",43,72,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
c2a2402b,micro,6,,"create_variation_model (Width, Height, 'byte', 'standard', VariationModelID)
for I := 1 to 15 by 1
read_image (Image, 'pen/pen-' + I$'02d')
apply_metrology_model (Image, MetrologyHandle)
get_metrology_object_result (MetrologyHandle, 'all', 'all', 'result_type', 'row_begin', RowBegin)
get_metrology_o...",73,128,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
get_image_size (Image, Width, Height)
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle)
dev_open_window (0, 0..."
c2a2402b,micro,7,,"NumImages := 30
for I := 1 to 30 by 1
read_image (Image, 'pen/pen-' + I$'02d')
apply_metrology_model (Image, MetrologyHandle)
get_metrology_object_result (MetrologyHandle, 'all', 'all', 'result_type', 'row_begin', RowBegin)
get_metrology_object_result (MetrologyHandle, 'all', 'all', 'result_type', '...",129,178,"* --- Automatically Added Context ---
read_image (Image, 'pen/pen-01')
dev_open_window (0, Width + 12, Width, Height, 'black', WindowHandle)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle..."
e6d2d548,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_image to rotate an image in 3D....","dev_update_off ()
read_image (Image, 'mreut_y')
points_foerstner (Image, 1, 2.5, 4, 300, 0.3, 'gauss', 'true', Rows, Cols, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, ...",10,84,
e6d2d548,micro,1,"projective_trans_image to rotate an image in 3D.  Furthermore, it shows
how to use projective_trans_...","dev_update_off ()
read_image (Image, 'mreut_y')",6,11,
e6d2d548,micro,2,,"points_foerstner (Image, 1, 2.5, 4, 300, 0.3, 'gauss', 'true', Rows, Cols, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, ColumnArea, CoRRArea, CoRCArea, CoCCArea)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",12,16,"* --- Automatically Added Context ---
read_image (Image, 'mreut_y')
* --- End of Automatically Added Context ---"
e6d2d548,micro,3,"a smooth (i.e., flicker-free) display under both Windows and Unix.","open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffer, 'red')
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
Iter := 1440",17,22,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
e6d2d548,micro,4,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.9
DBeta := 1.7
DGamma := 1.5",23,28,
e6d2d548,micro,5,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",29,32,
e6d2d548,micro,6,of the image.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",33,37,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
e6d2d548,micro,7,"moves in 3D.
This will generate the torus knot T(7,6).","M := 7
N := 6",38,42,
e6d2d548,micro,8,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0",43,46,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
e6d2d548,micro,9,,"for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Alpha), 'x', PrincipalRow, Pr...",47,90,"* --- Automatically Added Context ---
read_image (Image, 'mreut_y')
points_foerstner (Image, 1, 2.5, 4, 300, 0.3, 'gauss', 'true', Rows, Cols, CoRRJunctions, CoRCJunctions, CoCCJunctions, RowArea, Col..."
1c64738c,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_image to rotate an image in 3D....","dev_update_off ()
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffer, 'red')
set_part (WindowHandleBuff...",10,92,
1c64738c,micro,1,"projective_trans_image to rotate an image in 3D.  Furthermore, it shows
how to use projective_trans_...","dev_update_off ()
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)",6,14,
1c64738c,micro,2,"a smooth (i.e., flicker-free) display under both Windows and Unix.","open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffer, 'red')
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
Iter := 1440",15,20,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
1c64738c,micro,3,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.7
DBeta := 1.3
DGamma := 1.1",21,26,
1c64738c,micro,4,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",27,30,
1c64738c,micro,5,of the image.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",31,35,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
1c64738c,micro,6,"moves in 3D.
This will generate the torus knot T(7,3).","M := 7
N := 3",36,40,
1c64738c,micro,7,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0",41,44,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
1c64738c,micro,8,,"Rows := []
Cols := []
for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Alpha),...",45,98,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open_window (0, 0, Width, Height, 0..."
40cb464d,full,0,"online shape-based matching with adaptation to illumination changes
rotational invariant
rotation/tr...","online := false
VisUndefPixelBlack := 1
dev_update_window ('off')
dev_update_pc ('off')
dev_update_var ('off')
dev_update_time ('off')
if (online)
info_framegrabber ('1394IIDC', 'revision', RevisionInfo, RevisionInfoValues)
open_framegrabber ('1394IIDC', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -...",14,171,
40cb464d,micro,1,"if online is set to false, a virtual image acquisition device is opened which reads an image sequenc...","online := false
VisUndefPixelBlack := 1
dev_update_window ('off')
dev_update_pc ('off')
dev_update_var ('off')
dev_update_time ('off')
if (online)
info_framegrabber ('1394IIDC', 'revision', RevisionInfo, RevisionInfoValues)
open_framegrabber ('1394IIDC', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -...",11,43,
40cb464d,micro,2,------------------------,"if (online)
dev_update_pc ('off')
dev_set_window (WindowID)
dev_set_draw ('margin')
dev_set_line_width (5)
grab_image (ImageTempl, AcqHandle)
dev_set_window (WindowID)
dev_display (ImageTempl)
disp_message (WindowID, 'define the template', 'window', 12, 12, 'black', 'true')
dev_set_color ('green')
d...",44,85,"* --- Automatically Added Context ---
open_framegrabber ('1394IIDC', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
grab_image (Image, AcqHandle)
g..."
40cb464d,micro,3,"------------------------------------------
Compensate for rotation and translation","vector_angle_to_rigid (RowTempl, ColumnTempl, PhiTempl, RowRot, ColumnRot, 0, HomMat2DRotate)
affine_trans_image (ImageTempl, ImageAffineTrans, HomMat2DRotate, 'constant', 'false')
if (VisUndefPixelBlack == 1)
full_domain (ImageAffineTrans, ImageFull)
dev_set_window (WindowRot)
dev_display (ImageFul...",86,112,"* --- Automatically Added Context ---
VisUndefPixelBlack := 1
dev_open_window (0, Width + 30, Width, Height, 'black', WindowRot)
dev_open_window (0, 0, Width, Height, 'black', WindowID)
grab_image (Im..."
40cb464d,micro,4,------------------------,"Button := 0
Exp := 1
while (Button != 4)
if (online)
grab_image_async (Image, AcqHandle, -1)
else
grab_image (Image, AcqHandle)
endif
count_seconds (Seconds1)
find_shape_model (Image, ModelID, 0, rad(360), 0.7, 1, 0.5, 'least_squares', 0, 0.7, Row, Column, Angle, Score)
if (Score &gt; 0.5)
gen_recta...",113,177,"* --- Automatically Added Context ---
VisUndefPixelBlack := 1
open_framegrabber ('1394IIDC', 1, 1, 0, 0, 0, 0, 'default', -1, 'default', -1, 'default', 'default', 'default', -1, -1, AcqHandle)
grab_im..."
8d290588,full,0,This program gives an example of how to use vector_to_aniso.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)
gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20, 20, 20]...",7,93,
8d290588,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)",6,11,
8d290588,micro,2,we will use a synthetic square and read out its coordinates.,"gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20, 20, 20], 1)
get_contour_xld (Square, Rows1, Columns1)",12,15,
8d290588,micro,3,"rotated rectangle, and add some noise to the coordinates.","hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, 1.25, 0.5, 0, 0, HomMat2DScale)
hom_mat2d_rotate (HomMat2DScale, rad(30), 0, 0, HomMat2DRotate)
hom_mat2d_translate (HomMat2DRotate, 150, 150, HomMat2DTranslate)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Columns1, Rows2,...",16,24,"* --- Automatically Added Context ---
get_contour_xld (Square, Rows1, Columns1)
* --- End of Automatically Added Context ---"
8d290588,micro,4,"the transformation.  Note that by his approach we know exactly which points
correspond to each other...","get_contour_xld (NoisyRectangle, Rows2, Columns2)",25,29,"* --- Automatically Added Context ---
affine_trans_point_2d (HomMat2DTranslate, Rows1, Columns1, Rows2, Columns2)
add_noise_white_contour_xld (Rectangle, NoisyRectangle, 5, 5)
* --- End of Automatical..."
8d290588,micro,5,approximates the point correspondences.,"vector_to_aniso (Rows1, Columns1, Rows2, Columns2, HomMat2D)",30,32,"* --- Automatically Added Context ---
get_contour_xld (Square, Rows1, Columns1)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Columns1, Rows2, Columns2)
* --- End of Automatically Added Context ---"
8d290588,micro,6,"to get an impression of how accurate the calculated transformation is
(but before that, correct the ...","hom_mat2d_translate (HomMat2D, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
affine_trans_contour_xld (Square, SquareTrans, HomMat2DAdapted)",33,38,"* --- Automatically Added Context ---
gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20, 20, 20], 1)
vector_to_aniso (Rows1, Columns1, Rows2, C..."
8d290588,micro,7,,"dev_clear_window ()
Message := 'Calculate anisometric transformation of'
Message[1] := 'a square: Scale first, then rotate'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_set_color ('white')
disp_message (WindowHandle, 'Original square', 'window', 80, 100, '', 'false')
d...",39,53,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20..."
8d290588,micro,8,"rotates the points.  This means that the square can only be transformed
into a rotated rectangle.  S...","hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(30), 0, 0, HomMat2DRotate)
hom_mat2d_scale (HomMat2DRotate, 1.25, 0.5, 0, 0, HomMat2DScale)
hom_mat2d_translate (HomMat2DScale, 200, 200, HomMat2DTranslate)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Columns1, Rows2,...",54,69,"* --- Automatically Added Context ---
get_contour_xld (Square, Rows1, Columns1)
hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_scale (HomMat2DIdentity, 1.25, 0.5, 0, 0, HomMat2DScale)
hom_mat2d_rotat..."
8d290588,micro,9,"approximates the point correspondences.
Note, that the point pairs are passed in the opposite order
...","vector_to_aniso (Rows2, Columns2, Rows1, Columns1, HomMat2D)
hom_mat2d_invert (HomMat2D, HomMat2D)",70,75,"* --- Automatically Added Context ---
get_contour_xld (Square, Rows1, Columns1)
vector_to_aniso (Rows1, Columns1, Rows2, Columns2, HomMat2D)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Columns1, ..."
8d290588,micro,10,to get an impression of how accurate the calculated transformation is.,"hom_mat2d_translate (HomMat2D, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
affine_trans_contour_xld (Square, SquareTrans, HomMat2DAdapted)",76,80,"* --- Automatically Added Context ---
gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20, 20, 20], 1)
vector_to_aniso (Rows1, Columns1, Rows2, C..."
8d290588,micro,11,,"dev_clear_window ()
Message[1] := 'a square: Rotate first, then scale'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_set_color ('white')
disp_message (WindowHandle, 'Original square', 'window', 80, 100, '', 'false')
dev_display (Square)
dev_set_color ('red')
disp_messag...",81,99,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
gen_contour_polygon_rounded_xld (Square, [100, 100, 300, 300, 100], [100, 300, 300, 100, 100], [20, 20, 20..."
973cd820,full,0,"This example program shows how to rectify a part of an image using
vector_to_proj_hom_mat2d.  This i...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Oblique view of...",13,111,
973cd820,micro,1,"vector_to_proj_hom_mat2d.  This is done by extracting the four
corners of a soccer field from an obl...","dev_update_off ()
read_image (Image, 'olympic_stadium')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
disp_message (WindowHandle, 'Oblique view of...",6,22,
973cd820,micro,2,most easily by using the Hue channel of the HSV transform of the image.,"decompose3 (Image, ImageR, ImageG, ImageB)
trans_from_rgb (ImageR, ImageG, ImageB, ImageH, ImageS, ImageV, 'hsv')
threshold (ImageH, GreenRegion, 60, 90)
connection (GreenRegion, ConnectedRegions)",23,28,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
* --- End of Automatically Added Context ---"
973cd820,micro,3,that roughly looks like a rotated rectangle.,"select_shape_std (ConnectedRegions, RectangleRegions, 'rectangle2', 80)
select_shape_std (RectangleRegions, Field, 'max_area', 90)",29,32,"* --- Automatically Added Context ---
connection (GreenRegion, ConnectedRegions)
* --- End of Automatically Added Context ---"
973cd820,micro,4,segmented field.,"shape_trans (Field, FieldConvex, 'convex')
boundary (FieldConvex, FieldBorder, 'inner')
dilation_rectangle1 (FieldBorder, FieldDilation, 7, 7)
dev_display (Image)
dev_set_draw ('margin')
dev_display (FieldDilation)
dev_set_draw ('fill')
disp_message (WindowHandle, 'Field ROI based on color segmentat...",33,44,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
select_shape_std (RectangleRegions, Field, 'max_area', 90)
* --..."
973cd820,micro,5,,"reduce_domain (Image, FieldDilation, ImageReduced)
edges_color_sub_pix (ImageReduced, Edges, 'canny', 1.5, 20, 40)
dev_display (Image)
dev_display (Edges)
disp_message (WindowHandle, 'Extracted color edges', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
sto...",45,52,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dilation_rectangle1 (FieldBorder, FieldDilation, 7, 7)
* --- En..."
973cd820,micro,6,the four sides of the quadrilateral.,"select_shape_xld (Edges, SelectedEdges, 'contlength', 'and', 15, 500)",53,55,"* --- Automatically Added Context ---
edges_color_sub_pix (ImageReduced, Edges, 'canny', 1.5, 20, 40)
* --- End of Automatically Added Context ---"
973cd820,micro,7,extracted edges may represent more than one side of the quadrilateral.,"segment_contours_xld (SelectedEdges, ContoursSplit, 'lines', 5, 4, 2)
regress_contours_xld (ContoursSplit, RegressContours, 'no', 1)",56,59,"* --- Automatically Added Context ---
select_shape_xld (Edges, SelectedEdges, 'contlength', 'and', 15, 500)
* --- End of Automatically Added Context ---"
973cd820,micro,8,,"select_contours_xld (RegressContours, SelectedContours, 'curvature', 0, 0.5, 0, 0)",60,61,"* --- Automatically Added Context ---
regress_contours_xld (ContoursSplit, RegressContours, 'no', 1)
* --- End of Automatically Added Context ---"
973cd820,micro,9,,"select_shape_xld (SelectedContours, SelectedEdges, 'contlength', 'and', 15, 500)",62,63,"* --- Automatically Added Context ---
select_shape_xld (Edges, SelectedEdges, 'contlength', 'and', 15, 500)
select_contours_xld (RegressContours, SelectedContours, 'curvature', 0, 0.5, 0, 0)
* --- End..."
973cd820,micro,10,,"union_collinear_contours_xld (SelectedEdges, UnionContours, 30, 1, 4, 0.1, 'attr_forget')
dev_display (Image)
dev_display (UnionContours)
disp_message (WindowHandle, 'Selected straight edges', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",64,70,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
select_shape_xld (Edges, SelectedEdges, 'contlength', 'and', 15..."
973cd820,micro,11,"intersect the sides to get the corners of the quadrilateral.  First, we
separate the sides into roug...","select_shape_xld (UnionContours, HorizontalEdges, 'phi', 'and', rad(-20), rad(20))
select_shape_xld (UnionContours, VerticalEdges, ['phi', 'phi'], 'or', [rad(-90),rad(60)], [rad(-60),rad(90)])",71,75,"* --- Automatically Added Context ---
union_collinear_contours_xld (SelectedEdges, UnionContours, 30, 1, 4, 0.1, 'attr_forget')
* --- End of Automatically Added Context ---"
973cd820,micro,12,"their row coordinates, while the vertical sides are sorted based on their
column coordinates.","fit_line_contour_xld (HorizontalEdges, 'tukey', -1, 0, 10, 2, RowBegHor, ColBegHor, RowEndHor, ColEndHor, NrHor, NcHor, DistHor)
IndexHor := sort_index(RowBegHor)
fit_line_contour_xld (VerticalEdges, 'tukey', -1, 0, 10, 2, RowBegVer, ColBegVer, RowEndVer, ColEndVer, NrVer, NcVer, DistVer)
IndexVer :...",76,82,"* --- Automatically Added Context ---
select_shape_xld (UnionContours, HorizontalEdges, 'phi', 'and', rad(-20), rad(20))
select_shape_xld (UnionContours, VerticalEdges, ['phi', 'phi'], 'or', [rad(-90)..."
973cd820,micro,13,to get the four corners of the quadrilateral.,"intersection_lines (RowBegHor[IndexHor[0]], ColBegHor[IndexHor[0]], RowEndHor[IndexHor[0]], ColEndHor[IndexHor[0]], RowBegVer[IndexVer[0]], ColBegVer[IndexVer[0]], RowEndVer[IndexVer[0]], ColEndVer[IndexVer[0]], RowUL, ColUL, IsOverlapping)
intersection_lines (RowBegHor[IndexHor[0]], ColBegHor[Index...",83,88,"* --- Automatically Added Context ---
fit_line_contour_xld (HorizontalEdges, 'tukey', -1, 0, 10, 2, RowBegHor, ColBegHor, RowEndHor, ColEndHor, NrHor, NcHor, DistHor)
IndexHor := sort_index(RowBegHor)..."
973cd820,micro,14,"quadrilateral, i.e., the field border.","gen_contour_polygon_xld (FieldBorder, [RowUL,RowUR,RowLR,RowLL,RowUL], [ColUL,ColUR,ColLR,ColLL,ColUL])
dev_display (Image)
dev_display (FieldBorder)
disp_message (WindowHandle, 'Fitted field borders (quadrilateral)', 'window', 12, 12, 'black', 'true')
disp_continue_message (WindowHandle, 'black', '...",89,96,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
boundary (FieldConvex, FieldBorder, 'inner')
intersection_lines..."
973cd820,micro,15,"quadrilateral to a rectangle of given dimensions.  Note that we have to
add 0.5 to the coordinates t...","vector_to_proj_hom_mat2d ([RowUL,RowUR,RowLR,RowLL] + 0.5, [ColUL,ColUR,ColLR,ColLL] + 0.5, [160, 160, 340, 340] + 0.5, [250, 550, 550, 250] + 0.5, 'normalized_dlt', [], [], [], [], [], [], HomMat2D, Covariance)",97,101,"* --- Automatically Added Context ---
intersection_lines (RowBegHor[IndexHor[0]], ColBegHor[IndexHor[0]], RowEndHor[IndexHor[0]], ColEndHor[IndexHor[0]], RowBegVer[IndexVer[0]], ColBegVer[IndexVer[0]]..."
973cd820,micro,16,,"* hom_vector_to_proj_hom_mat2d ([RowUL,RowUR,RowLR,RowLL] + 0.5, [ColUL,ColUR,ColLR,ColLL] + 0.5, [1, 1, 1, 1], [160, 160, 340, 340] + 0.5, [250, 550, 550, 250] + 0.5, [1, 1, 1, 1], 'normalized_dlt', HomMat2D)",102,103,"* --- Automatically Added Context ---
intersection_lines (RowBegHor[IndexHor[0]], ColBegHor[IndexHor[0]], RowEndHor[IndexHor[0]], ColEndHor[IndexHor[0]], RowBegVer[IndexVer[0]], ColBegVer[IndexVer[0]]..."
973cd820,micro,17,,"projective_trans_image_size (Image, TransImage, HomMat2D, 'bilinear', 800, 500, 'false')
projective_trans_contour_xld (FieldBorder, FieldBorderTrans, HomMat2D)
dev_set_window_extents (-1, -1, 800, 500)
dev_display (TransImage)
dev_display (FieldBorderTrans)
disp_message (WindowHandle, 'Rectified tra...",104,118,"* --- Automatically Added Context ---
read_image (Image, 'olympic_stadium')
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
boundary (FieldConvex, FieldBorder, 'inner')
vector_to_proj_hom..."
454ccb2c,full,0,This program gives an example of how to use vector_to_rigid.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
get_contour_xld...",7,50,
454ccb2c,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)",6,11,
454ccb2c,micro,2,we will use a synthetic ellipse and read out its coordinates.,"gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
get_contour_xld (ContEllipse, Rows1, Cols1)",12,15,
454ccb2c,micro,3,noise to the coordinates.,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(30), 0, 0, HomMat2DRotate)
hom_mat2d_translate (HomMat2DRotate, 200, 100, HomMat2DTranslate)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Cols1, Rows2, Cols2)
gen_contour_polygon_xld (Contour, Rows2, Cols2)
add_noise_w...",16,23,"* --- Automatically Added Context ---
get_contour_xld (ContEllipse, Rows1, Cols1)
* --- End of Automatically Added Context ---"
454ccb2c,micro,4,"the transformation.  Note that by his approach we know exactly which points
correspond to each other...","get_contour_xld (NoisyContours, Rows2, Cols2)",24,28,"* --- Automatically Added Context ---
affine_trans_point_2d (HomMat2DTranslate, Rows1, Cols1, Rows2, Cols2)
add_noise_white_contour_xld (Contour, NoisyContours, 5, 5)
* --- End of Automatically Added ..."
454ccb2c,micro,5,the point correspondences.,"vector_to_rigid (Rows1, Cols1, Rows2, Cols2, HomMat2D)",29,31,"* --- Automatically Added Context ---
get_contour_xld (ContEllipse, Rows1, Cols1)
affine_trans_point_2d (HomMat2DTranslate, Rows1, Cols1, Rows2, Cols2)
* --- End of Automatically Added Context ---"
454ccb2c,micro,6,"to get an impression of how accurate the calculated transformation is
(but before that, correct the ...","hom_mat2d_translate (HomMat2D, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
affine_trans_contour_xld (ContEllipse, ContoursAffineTrans, HomMat2DAdapted)",32,37,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
vector_to_rigid (Rows1, Cols1, Rows2, Cols2, HomMat2D)
* --- E..."
454ccb2c,micro,7,,"dev_clear_window ()
Message := 'Calculate rigid transformation of an ellipse:'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_set_color ('white')
disp_message (WindowHandle, 'Original ellipse', 'window', 80, 30, '', 'false')
dev_display (ContEllipse)
dev_set_color ('red'...",38,56,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
add_no..."
b6b92fc9,full,0,This program gives an example of how to use vector_to_similarity.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
get_contour_xld...",7,52,
b6b92fc9,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_part (0, 0, 499, 499)",6,11,
b6b92fc9,micro,2,we will use a synthetic ellipse and read out its coordinates.,"gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
get_contour_xld (ContEllipse, Rows1, Cols1)",12,15,
b6b92fc9,micro,3,noise to the coordinates.,"hom_mat2d_identity (HomMat2DIdentity)
hom_mat2d_rotate (HomMat2DIdentity, rad(80), 0, 0, HomMat2DRotate)
hom_mat2d_translate (HomMat2DRotate, 600, 400, HomMat2DTranslate)
hom_mat2d_scale (HomMat2DTranslate, 0.5, 0.5, 0, 0, HomMat2DScale)
affine_trans_point_2d (HomMat2DScale, Rows1, Cols1, Rows2, Col...",16,24,"* --- Automatically Added Context ---
get_contour_xld (ContEllipse, Rows1, Cols1)
* --- End of Automatically Added Context ---"
b6b92fc9,micro,4,"the transformation.  Note that by his approach we know exactly which points
correspond to each other...","get_contour_xld (NoisyContours, Rows2, Cols2)",25,29,"* --- Automatically Added Context ---
affine_trans_point_2d (HomMat2DScale, Rows1, Cols1, Rows2, Cols2)
add_noise_white_contour_xld (Contour, NoisyContours, 5, 5)
* --- End of Automatically Added Cont..."
b6b92fc9,micro,5,the point correspondences.,"vector_to_similarity (Rows1, Cols1, Rows2, Cols2, HomMat2D)",30,32,"* --- Automatically Added Context ---
get_contour_xld (ContEllipse, Rows1, Cols1)
affine_trans_point_2d (HomMat2DScale, Rows1, Cols1, Rows2, Cols2)
* --- End of Automatically Added Context ---"
b6b92fc9,micro,6,"to get an impression of how accurate the calculated transformation is
(but before that, correct the ...","hom_mat2d_translate (HomMat2D, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
affine_trans_contour_xld (ContEllipse, ContoursAffineTrans, HomMat2DAdapted)",33,38,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
vector_to_similarity (Rows1, Cols1, Rows2, Cols2, HomMat2D)
* ..."
b6b92fc9,micro,7,,"dev_clear_window ()
Message := 'Calculate similarity transformation'
Message[1] := 'of an ellipse:'
disp_message (WindowHandle, Message, 'window', 12, 12, 'black', 'true')
dev_set_color ('white')
disp_message (WindowHandle, 'Original ellipse', 'window', 80, 30, '', 'false')
dev_display (ContEllipse)...",39,58,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
gen_ellipse_contour_xld (ContEllipse, 200, 200, rad(20), 150, 100, rad(0), rad(260), 'positive', 1)
add_no..."
1b253a42,full,0,This program gives an example of how to use vector_to_hom_mat3d.,"dev_update_off ()
Width := 768
Height := 576
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_fon...",8,108,
1b253a42,micro,1,,"dev_update_off ()
Width := 768
Height := 576
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_part (0, 0, Height - 1, Width - 1)
set_display_fon...",6,15,
1b253a42,micro,2,"we will use a 3D object model and a noisy version of the same 3D object
model. We will read out the ...","read_object_model_3d ('joint.off', 'mm', [], [], Joint3DID, Status)
read_object_model_3d ('joint_noise.off', 'mm', [], [], JointNoise3DID, Status)
get_object_model_3d_params (Joint3DID, 'diameter', ModelDiam)
create_pose (-ModelDiam * 0.3, 0.0, ModelDiam * 2.0, 70.0, 10.0, -20.0, 'Rp+T', 'gba', 'poi...",16,28,
1b253a42,micro,3,,"hom_mat3d_identity (HomMat3DIdentity)
hom_mat3d_rotate_local (HomMat3DIdentity, rad(35), [-0.1, -0.3, -0.5], HomMat3DRotate)
hom_mat3d_translate_local (HomMat3DRotate, ModelDiam * 0.3, ModelDiam * 0.7, -ModelDiam * 0.1, HomMat3DRigid)
affine_trans_object_model_3d (JointNoise3DID, HomMat3DRigid, Join...",29,34,"* --- Automatically Added Context ---
read_object_model_3d ('joint_noise.off', 'mm', [], [], JointNoise3DID, Status)
get_object_model_3d_params (Joint3DID, 'diameter', ModelDiam)
* --- End of Automati..."
1b253a42,micro,4,,"hom_mat3d_identity (HomMat3DIdentity)
hom_mat3d_scale_local (HomMat3DIdentity, 0.75, 0.75, 0.75, HomMat3DScale)
hom_mat3d_rotate_local (HomMat3DScale, rad(120), [0.2, 0.5, -0.1], HomMat3DRotate)
hom_mat3d_translate_local (HomMat3DRotate, -ModelDiam * 0.5, ModelDiam * 1.0, ModelDiam * 0.3, HomMat3DSi...",35,41,"* --- Automatically Added Context ---
read_object_model_3d ('joint_noise.off', 'mm', [], [], JointNoise3DID, Status)
get_object_model_3d_params (Joint3DID, 'diameter', ModelDiam)
hom_mat3d_identity (H..."
1b253a42,micro,5,,"hom_mat3d_identity (HomMat3DIdentity)
hom_mat3d_rotate_local (HomMat3DIdentity, rad(25), [-0.4, -0.3, -0.2], HomMat3DRotate)
hom_mat3d_scale_local (HomMat3DRotate, 1.25, 0.75, 0.5, HomMat3DScale)
hom_mat3d_translate_local (HomMat3DScale, ModelDiam * 0.4, ModelDiam * 0.3, -ModelDiam * 0.5, HomMat3DAf...",42,48,"* --- Automatically Added Context ---
read_object_model_3d ('joint_noise.off', 'mm', [], [], JointNoise3DID, Status)
get_object_model_3d_params (Joint3DID, 'diameter', ModelDiam)
hom_mat3d_rotate_loca..."
1b253a42,micro,6,,"get_object_model_3d_params (Joint3DID, 'point_coord_x', XR)
get_object_model_3d_params (Joint3DID, 'point_coord_y', YR)
get_object_model_3d_params (Joint3DID, 'point_coord_z', ZR)
disp_object_model_3d_safe (WindowHandle, Joint3DID, CameraParam, PoseSceneToCamera, 'color_0', 'green')
disp_message (Wi...",49,56,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,7,transformation and display the reference object and the transformed object.,"get_object_model_3d_params (JointNoiseRigid3DID, 'point_coord_x', XN)
get_object_model_3d_params (JointNoiseRigid3DID, 'point_coord_y', YN)
get_object_model_3d_params (JointNoiseRigid3DID, 'point_coord_z', ZN)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseRigid3DID], CameraParam, Pos...",57,65,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,8,"object, transform it with the transformation, and display the transformed
object.","vector_to_hom_mat3d ('rigid', XN, YN, ZN, XR, YR, ZR, HomMat3D)
affine_trans_object_model_3d (JointNoiseRigid3DID, HomMat3D, JointNoiseRigidTrans3DID)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseRigidTrans3DID], CameraParam, PoseSceneToCamera, ['color_0', 'color_1'], ['green', 'blu...",66,74,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,9,transformation and display the reference object and the transformed object.,"get_object_model_3d_params (JointNoiseSimilarity3DID, 'point_coord_x', XN)
get_object_model_3d_params (JointNoiseSimilarity3DID, 'point_coord_y', YN)
get_object_model_3d_params (JointNoiseSimilarity3DID, 'point_coord_z', ZN)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseSimilarity3DI...",75,83,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,10,"reference object, transform it with the transformation, and display the
transformed object.","vector_to_hom_mat3d ('similarity', XN, YN, ZN, XR, YR, ZR, HomMat3D)
affine_trans_object_model_3d (JointNoiseSimilarity3DID, HomMat3D, JointNoiseSimilarityTrans3DID)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseSimilarityTrans3DID], CameraParam, PoseSceneToCamera, ['color_0', 'color...",84,92,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,11,transformation and display the reference object and the transformed object.,"get_object_model_3d_params (JointNoiseAffine3DID, 'point_coord_x', XN)
get_object_model_3d_params (JointNoiseAffine3DID, 'point_coord_y', YN)
get_object_model_3d_params (JointNoiseAffine3DID, 'point_coord_z', ZN)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseAffine3DID], CameraParam,...",93,101,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
1b253a42,micro,12,"reference object, transform it with the transformation, and display the
transformed object.","vector_to_hom_mat3d ('affine', XN, YN, ZN, XR, YR, ZR, HomMat3D)
affine_trans_object_model_3d (JointNoiseAffine3DID, HomMat3D, JointNoiseAffineTrans3DID)
disp_object_model_3d_safe (WindowHandle, [Joint3DID,JointNoiseAffineTrans3DID], CameraParam, PoseSceneToCamera, ['color_0', 'color_1'], ['green', ...",102,114,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, 0.0, 1.1e-05, 1.1e-05, 0.5 * Width, 0.5 * Height, Width, Height, CameraParam)
dev_open_window (0, 0, Width, Height, 'black',..."
d414a33b,full,0,"This example shows how to use dual quaternions for rigid transformations
like rotations, translation...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
tuple...",11,676,
d414a33b,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Instructions[0] := 'Rotate: Left button'
Instructions[1] := 'Zoom:   Shift + left button'
Instructions[2] := 'Move:   Ctrl  + left button'
tuple...",9,25,
d414a33b,micro,2,,"Message := 'This example shows how to use dual quaternions'
Message[1] := 'for rigid transformations like rotations, translations,'
Message[2] := 'and screws.'
disp_object_model_3d (WindowHandle, ObjectModel3DInitial, [], VisPose1, ['disp_pose', 'color', 'alpha'], ['true', 'orange', 0.5])
disp_messa...",26,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
gen_initial_object_model_3d (Obje..."
d414a33b,micro,3,,"disp_message_block_1 (WindowHandle, Message)
stop ()",35,37,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Message := 'This example shows how to use dual quaternions'
* --- End of Automatically Added Context ---"
d414a33b,micro,4,,"Rotation := rad(135)
DualQuatStart := [1, 0, 0, 0, 0, 0, 0, 0]
DualQuatRotation := [cos(Rotation / 2),0, 0,sin(Rotation / 2),0, 0, 0, 0]",38,41,
d414a33b,micro,5,,"for Index := 0 to 1 + StepSize by StepSize
dual_quat_interpolate (DualQuatStart, DualQuatRotation, Index, DualQuatRotationInterpolated)
dual_quat_to_pose (DualQuatRotationInterpolated, PoseRotation)
rigid_trans_object_model_3d (ObjectModel3DInitial, PoseRotation, ObjectModel3DRotation)
disp_object_m...",42,54,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
StepSize := 0.05
WaitSeconds := 0.05
create_pose (-2, 4, 500, 12..."
d414a33b,micro,6,,"zoom_visualization_pose (WindowHandle, VisPose1, VisPose2, [ObjectModel3DInitial,ObjectModel3DRotation], ['disp_pose_0', 'color_0', 'color_1', 'alpha'], ['true', 'orange', 'green', 0.5], StepSize)",55,57,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
StepSize := 0.05
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
create_pose (-31..."
d414a33b,micro,7,,create_message_block_2 (Message),58,60,"* --- Automatically Added Context ---
Message := 'This example shows how to use dual quaternions'
* --- End of Automatically Added Context ---"
d414a33b,micro,8,,"Tx := 50
Ty := 50
Tz := 80
DualQuatTrans := [1, 0, 0, 0, 0,Tx / 2,Ty / 2,Tz / 2]",61,65,
d414a33b,micro,9,,"create_pose (Tx, Ty, Tz, 0, 0, 0, 'Rp+T', 'gba', 'point', TransPose)
gen_arrow_object_model_3d (0.2, [0, 0, 0, 0, 0, 0, 0], TransPose, OM3DArrow)
tuple_gen_const (|OM3DArrow|, 'khaki', ColorOM3DArrow)",66,69,"* --- Automatically Added Context ---
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
Tx := 50
Ty := 50
Tz := 80
* --- End of Automatically Added Context ---"
d414a33b,micro,10,,"NumOM3D := |[ObjectModel3DInitial,ObjectModel3DRotation,OM3DArrow]| - 1
visualize_object_model_3d (WindowHandle, [ObjectModel3DInitial,ObjectModel3DRotation,OM3DArrow], [], VisPose2, ['disp_pose_0',Colors[0:NumOM3D],'alpha'], ['true', 'orange', 'green',ColorOM3DArrow,0.5], Message, [], Instructions,...",70,82,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
Colors := 'color_' + [0:220]
StepSize := 0.05
WaitSeconds := 0.0..."
d414a33b,micro,11,,create_message_block_3 (Message),83,85,"* --- Automatically Added Context ---
Message := 'This example shows how to use dual quaternions'
* --- End of Automatically Added Context ---"
d414a33b,micro,12,,"dual_quat_interpolate (DualQuatStart, DualQuatTrans, [0:StepSize / 5:1], DualQuatTransInterpolated1)
dual_quat_to_pose (DualQuatTransInterpolated1, PosesTrans)
dual_quat_interpolate (DualQuatStart, DualQuatRotation, [0:StepSize / 5:1], DualQuatRotationInterpolated1)
dual_quat_to_pose (DualQuatRotati...",86,93,"* --- Automatically Added Context ---
StepSize := 0.05
DualQuatStart := [1, 0, 0, 0, 0, 0, 0, 0]
DualQuatRotation := [cos(Rotation / 2),0, 0,sin(Rotation / 2),0, 0, 0, 0]
Rotation := rad(135)
DualQuat..."
d414a33b,micro,13,,"dual_quat_to_screw (DualQuatRotTrans, 'moment', Lx, Ly, Lz, Mx, My, Mz, Rotation, d)
create_pose (Lx, Ly, Lz, 0, 0, 0, 'Rp+T', 'gba', 'point', L)
create_pose (Mx, My, Mz, 0, 0, 0, 'Rp+T', 'gba', 'point', M)
dual_quat_to_screw (DualQuatRotTrans, 'point', Lx, Ly, Lz, Px, Py, Pz, Rotation, d)
create_po...",94,99,"* --- Automatically Added Context ---
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
Rotation := rad(135)
dual_quat_compose (DualQuatTrans, DualQuatRotation, DualQuatRotTrans)..."
d414a33b,micro,14,,"PosesRotationTransXY := PosesRotTrans
IndexRotation := [2:7:|PosesRotTrans| - 1]
PosesRotationTransXY[IndexRotation] := 0",100,103,"* --- Automatically Added Context ---
dual_quat_to_pose (DualQuatRotationInterpolated1, PosesRotTrans)
* --- End of Automatically Added Context ---"
d414a33b,micro,15,,"PosesTransZ := PosesTrans
IndexTransX := [0:7:|PosesTrans| - 1]
IndexTransY := [1:7:|PosesTrans| - 1]
PosesTransZ[IndexTransX] := 0
PosesTransZ[IndexTransY] := 0",104,109,"* --- Automatically Added Context ---
dual_quat_to_pose (DualQuatTransInterpolated1, PosesTrans)
* --- End of Automatically Added Context ---"
d414a33b,micro,16,,"dLLineStart := PosesRotationTransXY[|PosesRotTrans| - 7:|PosesRotTrans| - 1]
dLLineEnd := PosesRotTrans[|PosesRotTrans| - 7:|PosesRotTrans| - 1]",110,112,"* --- Automatically Added Context ---
dual_quat_to_pose (DualQuatRotationInterpolated1, PosesRotTrans)
PosesRotationTransXY := PosesRotTrans
* --- End of Automatically Added Context ---"
d414a33b,micro,17,,"gen_curve_object_model_3d (0.2, false, [P - (d / 2) * L,P + (d + d / 6) * L], OM3DScrewAxis)
tuple_gen_const (|OM3DScrewAxis|, 'white', ColorOM3DScrewAxis)
gen_curve_object_model_3d (0.2, true, PosesRotTrans, OM3DScrewLine)
tuple_gen_const (|OM3DScrewLine|, 'khaki', ColorOM3DScrewLine)
gen_curve_obj...",113,127,"* --- Automatically Added Context ---
dual_quat_to_pose (DualQuatRotationInterpolated1, PosesRotTrans)
create_pose (Lx, Ly, Lz, 0, 0, 0, 'Rp+T', 'gba', 'point', L)
create_pose (Mx, My, Mz, 0, 0, 0, 'R..."
d414a33b,micro,18,,"OM3DVisualization := [OM3DArrowP,OM3DArrowL,OM3DArrowM,OM3DScrewAxis,OM3DRotationLine,OM3DArrowdL,OM3DScrewLine]
ColorsOM3DVisualization := [ColorOM3DArrowP,ColorOM3DArrowL,ColorOM3DArrowM,ColorOM3DScrewAxis,ColorOM3DRotationLine,ColorOM3DArrowdL,ColorOM3DScrewLine]",128,130,"* --- Automatically Added Context ---
gen_curve_object_model_3d (0.2, false, [P - (d / 2) * L,P + (d + d / 6) * L], OM3DScrewAxis)
tuple_gen_const (|OM3DScrewAxis|, 'white', ColorOM3DScrewAxis)
gen_cu..."
d414a33b,micro,19,,"Labels[3] := 'P = L x M'
Labels[4] := 'L'
Labels[6] := 'M'
Labels[8] := '(L,M)'
IndexLabelRotationLine := int(8 + |OM3DRotationLine| / 2)
IndexLabeldLLine := 9 + |OM3DRotationLine|
Labels[IndexLabelRotationLine] := 'theta'
Labels[IndexLabeldLLine] := 'd*L'",131,139,"* --- Automatically Added Context ---
tuple_gen_const (220, '', Labels)
create_pose (Lx, Ly, Lz, 0, 0, 0, 'Rp+T', 'gba', 'point', L)
create_pose (Mx, My, Mz, 0, 0, 0, 'Rp+T', 'gba', 'point', M)
create..."
d414a33b,micro,20,,"NumOM3D := |[ObjectModel3DInitial,ObjectModel3DTrans,ColorsOM3DVisualization]| - 1
visualize_object_model_3d (WindowHandle, [ObjectModel3DInitial,ObjectModel3DTrans,OM3DVisualization], [], VisPose2, ['disp_pose_0',Colors[0:NumOM3D],'alpha'], ['true', 'orange', 'cyan',ColorsOM3DVisualization,0.5], Me...",140,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
tuple_gen_const (220, '', Labels)
Colors := 'color_' + [0:220]
c..."
d414a33b,micro,21,,"NumOM3D := |[ObjectModel3DInitial,ObjectModel3DTrans,OM3DVisualization,ObjectModel3DRotation]| - 1
for Index := 0 to |PosesRotationTransXY| / 7 - 1 by 2
Pose := PosesRotationTransXY[7 * Index:(Index + 1) * 7 - 1]
rigid_trans_object_model_3d (ObjectModel3DInitial, Pose, ObjectModel3DRotation)
disp_ob...",143,149,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Colors := 'color_' + [0:220]
create_pose (-31, 32, 990, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose2)
ge..."
d414a33b,micro,22,,"for Index := 0 to |PosesTransZ| / 7 - 1 by 2
Pose := PosesTransZ[7 * Index:(Index + 1) * 7 - 1]
rigid_trans_object_model_3d (ObjectModel3DRotation, Pose, ObjectModel3DTransZ)
NumOM3D := |[ObjectModel3DInitial,ObjectModel3DTrans,OM3DVisualization,ObjectModel3DTrans]| - 1
disp_object_model_3d (WindowH...",150,156,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Colors := 'color_' + [0:220]
create_pose (-31, 32, 990, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose2)
ge..."
d414a33b,micro,23,,"for Index := 0 to |PosesRotTrans| / 7 - 1 by 1
Pose := PosesRotTrans[7 * Index:(Index + 1) * 7 - 1]
rigid_trans_object_model_3d (ObjectModel3DInitial, Pose, ObjectModel3DTransRotation)
NumOM3D := |[ObjectModel3DInitial,ObjectModel3DTrans,OM3DVisualization,ObjectModel3DTransRotation]| - 1
disp_object...",157,166,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
tuple_gen_const (220, '', Labels)
Colors := 'color_' + [0:220]
c..."
d414a33b,micro,24,,create_message_block_4 (Message),167,169,"* --- Automatically Added Context ---
Message := 'This example shows how to use dual quaternions'
* --- End of Automatically Added Context ---"
d414a33b,micro,25,,"create_pose (-1, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', L)
create_pose (TransPose[0] / 2, TransPose[1] / 2, TransPose[2] / 2, 0, 0, 0, 'Rp+T', 'gba', 'point', P)
d := TransPose[0]
screw_to_dual_quat ('point', L[0], L[1], L[2], P[0], P[1], P[2], -rad(90), d, DualQuaternionScrew)",170,174,"* --- Automatically Added Context ---
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
create_pose (Tx, Ty, Tz, 0, 0, 0, 'Rp+T', 'gba', 'point', TransPose)
create_pose (Lx, Ly, ..."
d414a33b,micro,26,,"dual_quat_interpolate (DualQuatStart, DualQuaternionScrew, [0:StepSize / 5:1], DualQuatScrewInterpolated)
dual_quat_to_pose (DualQuatScrewInterpolated, ScrewPoses)
pose_invert (PoseAfterFirstScrew, PoseAfterFirstScrewInv)
pose_compose (ScrewPoses, PoseAfterFirstScrew, ScrewPosesLine)
gen_curve_objec...",175,195,"* --- Automatically Added Context ---
tuple_gen_const (220, '', Labels)
StepSize := 0.05
DualQuatStart := [1, 0, 0, 0, 0, 0, 0, 0]
for Index := 0 to 1 + StepSize by StepSize
create_pose (Lx, Ly, Lz, 0..."
d414a33b,micro,27,,"NumOM3D := |[ObjectModel3DInitial,ObjectModel3DTrans,OM3DVisualization]| - 1
visualize_object_model_3d (WindowHandle, [ObjectModel3DInitial,ObjectModel3DTransRotation,OM3DVisualization], [], VisPose2, ['disp_pose_0',Colors[0:NumOM3D],'alpha'], ['true', 'orange', 'cyan',ColorsOM3DVisualization,0.5], ...",196,207,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
Instructions[0] := 'Rotate: Left button'
tuple_gen_const (220, '', Labels)
Colors := 'color_' + [0:220]
c..."
d414a33b,micro,28,,"pose_to_dual_quat (PoseAfterFirstScrew, DualQuaternionAfterFirstScrew)
dual_quat_conjugate (DualQuaternionAfterFirstScrew, DualQuaternionConjugateFirstScrew)",210,212,"* --- Automatically Added Context ---
for Index := 0 to 1 + StepSize by StepSize
dual_quat_to_pose (DualQuatRotationInterpolated1, PosesRotTrans)
PosesRotationTransXY := PosesRotTrans
Pose := PosesRot..."
d414a33b,micro,29,,"dual_quat_conjugate (DualQuaternionScrew, DualQuaternionConjugateSecondScrew)
dual_quat_compose (DualQuaternionConjugateFirstScrew, DualQuaternionConjugateSecondScrew, DualQuaternionConjugateComposed)",213,216,"* --- Automatically Added Context ---
screw_to_dual_quat ('point', L[0], L[1], L[2], P[0], P[1], P[2], -rad(90), d, DualQuaternionScrew)
dual_quat_conjugate (DualQuaternionAfterFirstScrew, DualQuatern..."
d414a33b,micro,30,,"for Index := 0 to 1 + StepSize by StepSize
dual_quat_interpolate (DualQuatStart, DualQuaternionConjugateComposed, Index, DualQuatConjugateInterpolated)
dual_quat_to_pose (DualQuatConjugateInterpolated, PoseConjugate)
rigid_trans_object_model_3d (ObjectModel3DScrew, PoseConjugate, ObjectModel3DConjug...",217,240,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
StepSize := 0.05
WaitSeconds := 0.05
create_pose (-31, 32, 990, 125, 0, 325, 'Rp+T', 'gba', 'point', VisP..."
d414a33b,micro,31,,"X := [-30, 30, 30, -30, -30, 30, 30, -30]
Y := [-20, -5, 20, 20, -20, 20, 20, 20]
Z := [-10, -10, -10, -10, 10, 0, 0, 10]
gen_object_model_3d_from_points (X / 2, Y / 2, Z / 2, ObjectModel3DTmp)
convex_hull_object_model_3d (ObjectModel3DTmp, ObjectModel3D)
return ()",241,283,
d414a33b,micro,32,,"ConeRadius := 2.5 * LineThickness
ConeLength := 3 * ConeRadius",286,289,
d414a33b,micro,33,,"LineLength := 0
if (ArrowBool)
for Index := 0 to |PosesCurve| / 7 - 2 by 1
LinePose1 := PosesCurve[7 * Index:(Index + 1) * 7 - 1]
LinePose2 := PosesCurve[7 * (Index + 1):(Index + 2) * 7 - 1]
DirectionVector := LinePose2 - LinePose1
Norm := sqrt(DirectionVector[0] * DirectionVector[0] + DirectionVect...",290,301,"* --- Automatically Added Context ---
for Index := 0 to 1 + StepSize by StepSize
* --- End of Automatically Added Context ---"
d414a33b,micro,34,,"OM3DCurve := []
LineLengthTmp := 0
for Index := 0 to |PosesCurve| / 7 - 2 by 1
if (ArrowBool and LineLengthTmp &gt; (LineLength - ConeLength))
continue
endif
LinePose1 := PosesCurve[7 * Index:(Index + 1) * 7 - 1]
LinePose2 := PosesCurve[7 * (Index + 1):(Index + 2) * 7 - 1]
DirectionVector := LinePos...",302,405,"* --- Automatically Added Context ---
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
Rotation := rad(135)
for Index := 0 to 1 + StepSize by StepSize
X := [-30, 30, 30, -30, -3..."
d414a33b,micro,35,,"ConeRadius := 2.5 * ArrowThickness
ConeLength := 3 * ConeRadius",408,411,"* --- Automatically Added Context ---
ConeRadius := 2.5 * LineThickness
ConeLength := 3 * ConeRadius
gen_cylinder_object_model_3d (PoseLine, LineThickness, 0, Norm, OM3DsLinesTmp)
* --- End of Automat..."
d414a33b,micro,36,,"pi := rad(180)
X := 0
Y := 0
Z := ConeLength
for Index := 0 to 2 * pi by 0.1
X := [X,ConeRadius * cos(Index)]
Y := [Y,ConeRadius * sin(Index)]
Z := [Z,0]
endfor
gen_object_model_3d_from_points (X, Y, Z, OM3DConeTmp)
convex_hull_object_model_3d (OM3DConeTmp, OM3DCone)",412,424,"* --- Automatically Added Context ---
for Index := 0 to 1 + StepSize by StepSize
X := [-30, 30, 30, -30, -30, 30, 30, -30]
Y := [-20, -5, 20, 20, -20, 20, 20, 20]
Z := [-10, -10, -10, -10, 10, 0, 0, 1..."
d414a33b,micro,37,,"DirectionVector := ArrowEnd[0:2] - ArrowStart[0:2]
Norm := sqrt(DirectionVector[0] * DirectionVector[0] + DirectionVector[1] * DirectionVector[1] + DirectionVector[2] * DirectionVector[2])
CosineRotation := DirectionVector[2] / Norm
Rotation := acos(CosineRotation)
tuple_vector_cross_product ([0, 0,...",425,492,"* --- Automatically Added Context ---
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
Rotation := rad(135)
for Index := 0 to 1 + StepSize by StepSize
ConeRadius := 2.5 * LineTh..."
d414a33b,micro,38,VisPoseOut.,"for T := StepSize to 1 by StepSize
pose_average ([VisPoseStart,VisPoseEnd], [1 - T,T], 'direct', 'auto', 'auto', VisPose, Quality)
disp_object_model_3d (WindowHandle, ObjectModel3D, [], VisPose, GenParamName, GenParamValue)
wait_seconds (0.05)
endfor
return ()
Message := '1) Rotations:'
Message[1] :...",493,693,"* --- Automatically Added Context ---
dev_open_window (0, 0, 1024, 768, 'black', WindowHandle)
StepSize := 0.05
create_pose (-2, 4, 500, 125, 0, 325, 'Rp+T', 'gba', 'point', VisPose1)
Message := 'This..."
9b76f8ae,full,0,"This example visualizes different poses
in the camera coordinate system
A calibration plate is held ...","CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_close_window ()
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
dev_open_window (0, 0, Widt...",85,527,
9b76f8ae,micro,1,the ideal internal camera parameters,"CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_close_window ()",83,87,
9b76f8ae,micro,2,,"get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
dev_open_window (0, 0, Width, Height, 'white', TitleWindowHandle)
set_display_font (TitleWindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (2)
dev_open_window (0, Width + 12, W...",88,98,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,3,,"create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'The calibration plate is placed Tz=' + ObjInCamPose[2] + ' m along'
Message[1] := 'the z-axis of the camera coordinate system'
Message[2] := 'and held parallel to the camera plane.'
show_camera_view (CalTabFile, Ide...",103,111,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,4,"The effect is that the calibration plate is tilted towards
the left with respect to the camera plane...","create_pose (0.0, 0.0, 0.2, 60, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'The plate is rotated by Rx=' + ObjInCamPose[3] + '° around the x-axis'
Message[1] := '(red arrow) of the local plate coordinate '
Message[2] := 'system. It is NOT parallel to the camera plane.'
show_camera_view (...",112,122,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,5,"The effect is that the calibration plate is tilted towards
the left with respect to the camera plane...","create_pose (0.0, 0.0, 0.2, 0, 45, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'The plate is rotated by Ry=' + ObjInCamPose[4] + '° around the y-axis'
Message[1] := '(green arrow) of the local plate coordinate'
Message[2] := 'system. It is NOT parallel to the camera plane.'
show_camera_view ...",123,133,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,6,"This has the effect that the calibration plate is rotated
in the camera plane but is still parallel ...","create_pose (0.0, 0.0, 0.2, 0, 0, 30, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'A rotation by Rz=' + ObjInCamPose[5] + '° around the z-axis of the'
Message[1] := 'calibration plate coordinate system is performed.'
Message[2] := 'The plate is still parallel to the camera plane.'
show_camera_v...",134,146,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,7,,"create_pose (0.0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'Original unrotated calibration plate pose.'
Message[1] := 'A translation Tz=' + ObjInCamPose[2] + ' m along the z-axis'
Message[2] := 'of the camera coordinate system is performed.'
show_camera_view (CalTabFile, I...",151,159,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,8,,"create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
pose_compose (ObjInCamPose, Pose, ObjInCamPose)",160,162,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,9,,"Message := 'Additionally, the plate is moved Tx=' + ObjInCamPose[0] + ' m'
Message[1] := 'along the x-axis (red arrow) of the camera'
Message[2] := 'coordinate system.'
show_camera_view (CalTabFile, IdealCamParam, ObjInCamPose, WindowHandle)
show_extern_scene_view (TitleWindowHandle, CalTabFile, Ide...",163,170,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,10,,"create_pose (0, 0.01, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
pose_compose (ObjInCamPose, Pose, ObjInCamPose)",171,173,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatical..."
9b76f8ae,micro,11,,"Message := 'Additionally, the plate is moved Ty=' + ObjInCamPose[1] + ' m'
Message[1] := 'along the y-axis (green arrow) of the camera'
Message[2] := 'coordinate system.'
show_camera_view (CalTabFile, IdealCamParam, ObjInCamPose, WindowHandle)
show_extern_scene_view (TitleWindowHandle, CalTabFile, I...",174,181,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,12,"The effect is that the calibration plate is tilted towards
the left with respect to the camera plane...","create_pose (0.0, 0.0, 0, 20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
pose_compose (ObjInCamPose, Pose, ObjInCamPose)",182,186,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatical..."
9b76f8ae,micro,13,,"Message := 'Additionally, the plate is rotated by '
Message[1] := 'Rx=20° around the x-axis (red arrow) '
Message[2] := 'of the local plate coordinate system.'
show_camera_view (CalTabFile, IdealCamParam, ObjInCamPose, WindowHandle)
show_extern_scene_view (TitleWindowHandle, CalTabFile, IdealCamPara...",187,194,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,14,,"create_pose (0.0, 0.0, 0, 0, 45, 0, 'Rp+T', 'gba', 'point', Pose)
pose_compose (ObjInCamPose, Pose, ObjInCamPose)",195,197,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatical..."
9b76f8ae,micro,15,,"Message := 'Additionally, the plate is rotated by Ry=' + ObjInCamPose[4] + '°'
Message[1] := 'around the y-axis (green arrow) of the'
Message[2] := 'local plate coordinate system.'
show_camera_view (CalTabFile, IdealCamParam, ObjInCamPose, WindowHandle)
show_extern_scene_view (TitleWindowHandle, Cal...",198,205,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,16,,"create_pose (0.0, 0.0, 0., 0, 0, 30, 'Rp+T', 'gba', 'point', Pose)
pose_compose (ObjInCamPose, Pose, ObjInCamPose)",206,208,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatical..."
9b76f8ae,micro,17,,"Message := 'The plate is rotated by Rz=' + ObjInCamPose[5] + '° around'
Message[1] := 'the z-axis (blue arrow) of the local'
Message[2] := 'coordinate system of the plate.'
show_camera_view (CalTabFile, IdealCamParam, ObjInCamPose, WindowHandle)
show_extern_scene_view (TitleWindowHandle, CalTabFile,...",209,233,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, 0..."
9b76f8ae,micro,18,"Rx, Ry, Rz: Rotations around the corresponding axes
ObjPose: Pose of the calibration plate in camera...","create_pose (0.0, 0.0, 0.0, Rx, Ry, Rz, 'Rp+T', 'gba', 'point', Pose)
pose_compose (Pose, ObjPose, ObjPoseRotated)",237,244,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0.015, 0, 0, 0, 0, 0, 'Rp+T', 'gba', 'point', Pose)
Message[1] := 'Rx=20° ar..."
9b76f8ae,micro,19,,"ObjPoseRotated[0] := ObjPose[0]
ObjPoseRotated[1] := ObjPose[1]
ObjPoseRotated[2] := ObjPose[2]
return ()",245,272,"* --- Automatically Added Context ---
pose_compose (Pose, ObjPose, ObjPoseRotated)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,20,to the camera coordinate system,"create_pose (0, 0.0, 0.0, -86, 0, 0, 'Rp+T', 'gba', 'point', Pose4Rot)",275,277,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,21,of the observer.,"create_pose (0, 0.0, 0.2, -90, 0, 0, 'Rp+T', 'gba', 'point', CamInObserverPose)
dev_set_window (WindowHandle)
ShadowOn := 'false'",278,282,"* --- Automatically Added Context ---
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle)
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
* --- End of Automa..."
9b76f8ae,micro,22,,"GrayBackground := 255
GrayCaltab := 224
GrayMarks := 80
ScaleFac := 1
CoordAxesLength := 0.007
get_window_extents (WindowHandle, Row, Column, Width, Height)
gen_camera_image (TitleImage, WindowHandle)",283,290,"* --- Automatically Added Context ---
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
dev_open_window (0, Width + 12, Width, Height, 'wh..."
9b76f8ae,micro,23,,"InitX := 0
InitY := 0
InitZ := 0.1",291,294,
9b76f8ae,micro,24,,"Tx := ObjInCamPose[0]
Ty := ObjInCamPose[1]
Tz := ObjInCamPose[2]",295,298,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message[1] := 'A translation Tz=' + ObjInCamPose[2] + ' m along the z-axis'
* --- End of ..."
9b76f8ae,micro,25,,ConstZ := 0.2,299,300,
9b76f8ae,micro,26,off the movement shown in the left image,"XRange := 0.02
YRange := 0.01
ZRange := 0.1
NewX := (Tx - InitX) / XRange
NewY := (Ty - InitY) / YRange
NewZ := (Tz - InitZ) / ZRange",301,308,"* --- Automatically Added Context ---
Message[1] := 'A translation Tz=' + ObjInCamPose[2] + ' m along the z-axis'
InitX := 0
InitY := 0
InitZ := 0.1
Tx := ObjInCamPose[0]
Ty := ObjInCamPose[1]
* --- E..."
9b76f8ae,micro,27,,"rotate_object (Pose4Rot[3], Pose4Rot[4], Pose4Rot[5], ObjInCamPose, RotatedObjPoseInCam)",309,310,"* --- Automatically Added Context ---
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
create_pose (0, 0.0, 0.0, -86, 0, 0, 'Rp+T', 'gba', 'point', Pose4Rot)
* --- End of Autom..."
9b76f8ae,micro,28,"The simulated image shall only appear enlarged if it is
moved along the y-axis of the camera coordin...","RotatedObjPoseInCam[0] := 0
RotatedObjPoseInCam[1] := 0
RotatedObjPoseInCam[2] := ConstZ - (NewY * ZRange / 2)",311,316,"* --- Automatically Added Context ---
InitY := 0
Ty := ObjInCamPose[1]
ConstZ := 0.2
ZRange := 0.1
NewY := (Ty - InitY) / YRange
YRange := 0.01
rotate_object (Pose4Rot[3], Pose4Rot[4], Pose4Rot[5], Ob..."
9b76f8ae,micro,29,,"sim_caltab (RotatedImage, CalTabFile, IdealCamParam, RotatedObjPoseInCam, GrayBackground, GrayCaltab, GrayMarks, ScaleFac)",317,318,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
GrayBackground := 255..."
9b76f8ae,micro,30,,"hom_mat2d_identity (HomMat2DIdentity)
Scale := 0.5
hom_mat2d_scale (HomMat2DIdentity, Scale, Scale, 0, 0, HomMat2DScale)
affine_trans_image_size (RotatedImage, ImageAffineTrans, HomMat2DScale, 'constant', Width / 2, Height / 2)
concat_obj (TitleImage, ImageAffineTrans, Images)",319,324,"* --- Automatically Added Context ---
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
gen_camera_image (TitleImage, TitleWindowHandle)
s..."
9b76f8ae,micro,31,,"project_3d_point (0, 0, ConstZ, IdealCamParam, Row, Column)",325,326,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
get_window_extents (WindowHandle, Row, Column, Width, H..."
9b76f8ae,micro,32,,"Radius := 200
TopR := (Row - Radius) * Scale
BottomR := (Row + Radius) * Scale
TopC := (Column - Radius) * Scale
BottomC := (Column + Radius) * Scale",327,332,"* --- Automatically Added Context ---
get_window_extents (WindowHandle, Row, Column, Width, Height)
Scale := 0.5
* --- End of Automatically Added Context ---"
9b76f8ae,micro,33,,"RowIncMax := 100
ColIncMax := 50
RowOffset := RowIncMax * NewZ
ColOffset := ColIncMax * NewX
DiffRow := Radius * Scale
DiffCol := Radius * Scale",333,339,"* --- Automatically Added Context ---
Message[1] := 'A translation Tz=' + ObjInCamPose[2] + ' m along the z-axis'
InitX := 0
InitZ := 0.1
Tx := ObjInCamPose[0]
NewX := (Tx - InitX) / XRange
NewZ := (T..."
9b76f8ae,micro,34,,"ImagePosRow := 190 + RowOffset
ImagePosCol := 185 + ColOffset",340,342,"* --- Automatically Added Context ---
Message[1] := 'A translation Tz=' + ObjInCamPose[2] + ' m along the z-axis'
InitX := 0
InitZ := 0.1
Tx := ObjInCamPose[0]
NewX := (Tx - InitX) / XRange
NewZ := (T..."
9b76f8ae,micro,35,,"tile_images_offset (Images, ExternViewImage, [0,ImagePosRow], [0,ImagePosCol], [-1,TopR], [-1,TopC], [-1,BottomR], [-1,BottomC], Width, Height)
dev_display (ExternViewImage)",343,345,"* --- Automatically Added Context ---
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
Message[1] := 'A translation Tz=' + ObjInCamPose[2..."
9b76f8ae,micro,36,"Position of top left corner of the inserted subimage with respect to projected camera
coordinate sys...","ObjCSRow := ImagePosRow + DiffRow
ObjCSCol := ImagePosCol + DiffCol
dev_set_colored (3)
ObjInCamPoseOrientation := [RotatedObjPoseInCam[3],RotatedObjPoseInCam[4],RotatedObjPoseInCam[5]]
disp_3d_coord_system_in_image (WindowHandle, IdealCamParam, ObjInCamPoseOrientation, ObjCSRow, ObjCSCol, CoordAxes...",346,354,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, Width + 12, Width, Height, 'white',..."
9b76f8ae,micro,37,,"CamCSOrientation := [CamInObserverPose[3],CamInObserverPose[4],CamInObserverPose[5]]
disp_3d_coord_system_in_image (WindowHandle, IdealCamParam, CamCSOrientation, 121, 287, CoordAxesLength)
disp_message (WindowHandle, 'Camera\ncoordinate\nsystem', 'image', 120, 360, 'black', ShadowOn)
disp_message (...",355,381,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, Width + 12, Width, Height, 'white',..."
9b76f8ae,micro,38,,"GrayBackground := 128
GrayCaltab := 224
GrayMarks := 80
ScaleFac := 1
dev_set_window (WindowHandle)",382,388,"* --- Automatically Added Context ---
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle)
GrayBackground := 255
GrayCaltab := 224
GrayMarks := 80
ScaleFac := 1
* --- End of Automatic..."
9b76f8ae,micro,39,as described by ObjInCamPose,"sim_caltab (SimImage, CalTabFile, IdealCamParam, ObjInCamPose, GrayBackground, GrayCaltab, GrayMarks, ScaleFac)
dev_display (SimImage)",389,392,"* --- Automatically Added Context ---
CalTabFile := 'caltab_30mm.descr'
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
create_pose (0, 0.0, ..."
9b76f8ae,micro,40,,"Colors := ['black', 'black', 'red', 'forest green', 'blue', 'red', 'forest green', 'blue']
Message := 'Object pose in'
Message[1] := 'camera coordinates'
Message[2] := 'Tx = ' + ObjInCamPose[0]$'.03f' + ' m'
Message[3] := 'Ty = ' + ObjInCamPose[1]$'.03f' + ' m'
Message[4] := 'Tz = ' + ObjInCamPose[2...",393,404,"* --- Automatically Added Context ---
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle)
create_pose (0, 0.0, 0.2, 0, 0, 0, 'Rp+T', 'gba', 'point', ObjInCamPose)
Message := 'The cal..."
9b76f8ae,micro,41,onto the image plane (PoseProjectedCamCS).,"get_window_extents (WindowHandle, Row, Column, Width, Height)
get_cam_par_data (IdealCamParam, 'cx', Cx)
get_cam_par_data (IdealCamParam, 'cy', Cy)
gen_contour_polygon_xld (Cross1, [Cx,Cx], [0,Width - 1])
gen_contour_polygon_xld (Cross2, [0,Height - 1], [Cy,Cy])
set_line_style (WindowHandle, [1, 5])...",405,417,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
get_cam_par_data (IdealCamParam, 'image_width', Width)
..."
9b76f8ae,micro,42,,"dev_disp_3d_coord_system (WindowHandle, IdealCamParam, ObjInCamPose, 0.01)
disp_continue_message (WindowHandle, 'black', 'true')
return ()",418,441,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.0117685, 0.0, 7.32909e-006, 7.4e-006, 259, 259, 512, 512, IdealCamParam)
dev_open_window (0, Width + 12, Width, Height, 'white',..."
9b76f8ae,micro,43,content into an image object.,"dev_clear_window ()
dev_set_color ('black')
dev_set_line_width (3)
gen_rectangle2_contour_xld (Rectangle, 120, 285, 0, 25, 40)
dev_display (Rectangle)
gen_contour_polygon_xld (Triangle, [187, 161, 161, 187, 187, 187], [265, 284, 284, 304, 304, 265])
dev_display (Triangle)
dump_window_image (Image, W...",442,473,"* --- Automatically Added Context ---
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,44,"WindowHandle: The window where the coordinate system shall be displayed
CamParam: The camera paramet...","get_window_extents (WindowHandle, WinRow, WinColumn, Width, Height)
OffsetRow := Row - Height / 2.0
OffsetColumn := Col - Width / 2.0
create_pose (0, 0, 0.2, Orientation3D[0], Orientation3D[1], Orientation3D[2], 'Rp+T', 'gba', 'point', OriginPose)",477,486,"* --- Automatically Added Context ---
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
dev_open_window (0, Width + 12, Width, Height, 'wh..."
9b76f8ae,micro,45,,"pose_to_hom_mat3d (OriginPose, TransWorld2Cam)",487,488,"* --- Automatically Added Context ---
create_pose (0, 0, 0.2, Orientation3D[0], Orientation3D[1], Orientation3D[2], 'Rp+T', 'gba', 'point', OriginPose)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,46,,"affine_trans_point_3d (TransWorld2Cam, 0, 0, 0, OrigCamX, OrigCamY, OrigCamZ)
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)",489,491,"* --- Automatically Added Context ---
pose_to_hom_mat3d (OriginPose, TransWorld2Cam)
* --- End of Automatically Added Context ---"
9b76f8ae,micro,47,,"affine_trans_point_3d (TransWorld2Cam, CoordAxesLength, 0, 0, X, Y, Z)
project_3d_point (X, Y, Z, CamParam, RowAxX, ColumnAxX)
affine_trans_point_3d (TransWorld2Cam, 0, CoordAxesLength, 0, X, Y, Z)
project_3d_point (X, Y, Z, CamParam, RowAxY, ColumnAxY)
affine_trans_point_3d (TransWorld2Cam, 0, 0, C...",492,499,"* --- Automatically Added Context ---
CoordAxesLength := 0.007
pose_to_hom_mat3d (OriginPose, TransWorld2Cam)
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)
* --- End of Auto..."
9b76f8ae,micro,48,,"distance_pp ([Row0,Row0,Row0], [Column0,Column0,Column0], [RowAxX,RowAxY,RowAxZ], [ColumnAxX,ColumnAxY,ColumnAxZ], Distance)
HeadLength := int(max([max(Distance) / 12.0,5.0]))
gen_arrow_contour_xld (Arrows, [Row0,Row0,Row0], [Column0,Column0,Column0], [RowAxX,RowAxY,RowAxZ], [ColumnAxX,ColumnAxY,Col...",500,504,"* --- Automatically Added Context ---
hom_mat2d_identity (HomMat2DIdentity)
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)
project_3d_point (X, Y, Z, CamParam, RowAxX, Column..."
9b76f8ae,micro,49,,"ImageRowOffset := OffsetRow - 5
ImageColOffset := OffsetColumn - 4
hom_mat2d_translate (HomMat2DIdentity, ImageRowOffset, ImageColOffset, HomMat2DTranslate)
hom_mat2d_translate (HomMat2DTranslate, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
projective_...",505,512,"* --- Automatically Added Context ---
get_cam_par_data (IdealCamParam, 'image_width', Width)
get_cam_par_data (IdealCamParam, 'image_height', Height)
get_window_extents (WindowHandle, Row, Column, Wid..."
9b76f8ae,micro,50,,"disp_xld (Arrows, WindowHandle)
get_rgb (WindowHandle, Red, Green, Blue)
set_rgb (WindowHandle, Red[0], Green[0], Blue[0])
set_tposition (WindowHandle, RowAxX + 3 + ImageRowOffset, ColumnAxX + 3 + ImageColOffset)
write_string (WindowHandle, 'X')
set_rgb (WindowHandle, Red[1 % |Red|], Green[1 % |Gree...",513,540,"* --- Automatically Added Context ---
dev_open_window (0, Width + 12, Width, Height, 'white', WindowHandle)
get_window_extents (WindowHandle, Row, Column, Width, Height)
OffsetRow := Row - Height / 2...."
8cd082b2,full,0,"This example program shows how to use the operator get_circle_pose.
Set the camera parameters","gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
AngleStart := 0
AngleEnd := 360
AngleStep := 5
CT := 'caltab_30mm.descr'
Radius := 0.0009375
bg_images_available := false
dev_close_window ()
...",9,386,
8cd082b2,micro,1,,"gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)",8,11,
8cd082b2,micro,2,,"AngleStart := 0
AngleEnd := 360
AngleStep := 5
CT := 'caltab_30mm.descr'
Radius := 0.0009375
bg_images_available := false
dev_close_window ()
set_system ('flush_graphic', 'true')
get_cam_par_data (CamParam, 'image_width', ImageWidth)
get_cam_par_data (CamParam, 'image_height', ImageHeight)
dev_open_...",12,29,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
* --..."
8cd082b2,micro,3,,"sim_caltab (SimImage, CT, CamParam, Pose, 128, 224, 80, 1)
find_caltab (SimImage, Caltab, CT, 3, 112, 5)
erosion_circle (Caltab, Caltab, 3.5)
reduce_domain (SimImage, Caltab, ImageReduced)
edges_sub_pix (ImageReduced, Edges, 'canny', 0.5, 10, 40)
select_contours_xld (Edges, Edges, 'contour_length', ...",30,38,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
CT :..."
8cd082b2,micro,4,,"get_circle_pose (Edges, CamParam, gen_tuple_const(Number,Radius), 'center_normal', CenterNormal1, CenterNormal2)",39,41,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
Radius := 0.0009375
edges_sub_pix (ImageReduced, Edges, 'canny', 0.5, 10, ..."
8cd082b2,micro,5,"where the normal vector points in approximately the same direction.  Because all the circles lie
in ...","p_cluster_normals (CenterNormal1, CenterNormal2, Cluster1, Cluster2)",42,48,"* --- Automatically Added Context ---
get_circle_pose (Edges, CamParam, gen_tuple_const(Number,Radius), 'center_normal', CenterNormal1, CenterNormal2)
* --- End of Automatically Added Context ---"
8cd082b2,micro,6,Note that the normal vectors point away from the optical center.,"p_gen_normals_and_circles (Normals1, Circles1, CamParam, Cluster1, Radius)
dev_display (SimImage)
dev_set_color ('green')
dev_display (Normals1)
dev_display (Circles1)
disp_message (WindowHandle, 'Cluster 1', 'window', 10, 10, 'black', 'true')
disp_message (WindowHandle, 'Press mouse button to conti...",49,68,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
Radius := 0.0009375
dev_open_window_fit_size (0, 0, ImageWidth, ImageHeigh..."
8cd082b2,micro,7,,"if (not bg_images_available)
gen_empty_obj (SimImages)
Angles := []
dev_update_window ('off')
ResolutionFactor := 4.0
get_cam_par_data (CamParam, ['sx', 'sy', 'cx', 'cy', 'image_width', 'image_height'], CamParamValue)
CamParamLowResolution := CamParam
set_cam_par_data (CamParamLowResolution, ['sx', ...",69,101,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
Angl..."
8cd082b2,micro,8,"For this, the simulated calibration plate is rotated, together with the superimposed circles in 3D","Finish := false
while (true)
if (Finish)
break
endif
dev_clear_window ()
disp_message (WindowHandle, 'Left   mouse button: View cluster 1', 'window', 10, 10, 'black', 'true')
disp_message (WindowHandle, 'Right  mouse button: View cluster 2', 'window', 35, 10, 'black', 'true')
get_mbutton (WindowHand...",102,195,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
Radi..."
8cd082b2,micro,9,,"StartX := subset(CenterNormal,Indices)
StartY := subset(CenterNormal,Indices + 1)
StartZ := subset(CenterNormal,Indices + 2)
EndX := StartX + 0.005 * subset(CenterNormal,Indices + 3)
EndY := StartY + 0.005 * subset(CenterNormal,Indices + 4)
EndZ := StartZ + 0.005 * subset(CenterNormal,Indices + 5)
p...",196,351,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
Radi..."
8cd082b2,micro,10,,"StartX := subset(CenterNormal,Indices)
StartY := subset(CenterNormal,Indices + 1)
StartZ := subset(CenterNormal,Indices + 2)
EndX := StartX + 0.005 * subset(CenterNormal,Indices + 3)
EndY := StartY + 0.005 * subset(CenterNormal,Indices + 4)
EndZ := StartZ + 0.005 * subset(CenterNormal,Indices + 5)
a...",352,400,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.004, -100, 1e-5, 1e-5, 512, 384, 1024, 768, CamParam)
create_pose (0.0, 0.0, 0.02, -20, 0, 0, 'Rp+T', 'gba', 'point', Pose)
Radi..."
c8bd8b94,full,0,"*****************************************************************************
pose_average.hdev
****...","gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
dev_update_off ()
dev_close_window ()
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Part[1]) * 4, (Part[2] - Part[0]) * 4, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mon...",21,284,
c8bd8b94,micro,1,,"gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
dev_update_off ()
dev_close_window ()",20,23,
c8bd8b94,micro,2,,"Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Part[1]) * 4, (Part[2] - Part[0]) * 4, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_set_line_width (3)",24,29,
c8bd8b94,micro,3,"This is done to reduce the noise introduced by the
time-of-flight sensor.
**************************...","gen_empty_obj (ModelsX)
gen_empty_obj (ModelsY)
gen_empty_obj (ModelsZ)
for I := 1 to 5 by 1
read_image (Image, 'time_of_flight/gutter_corner_xyz_' + I$'02')
select_obj (Image, X, 1)
select_obj (Image, Y, 2)
select_obj (Image, Z, 3)
disp_depth_image (Z, Part)
Message := 'Create 3D surface model'
Mes...",33,60,"* --- Automatically Added Context ---
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Part[1]) * 4, (Part[2] - Part[0]) * 4, 'black', WindowHandle)
* --- End of Automatically Added Contex..."
c8bd8b94,micro,4,,"threshold (ModelMedianZ, Regions, 0.544, 0.6058)
connection (Regions, ConnectedRegions)
area_center (ConnectedRegions, Area, Row, Column)
select_shape (ConnectedRegions, ModelROI, 'area', 'and', sort(Area)[|Area| - 1], sort(Area)[|Area| - 1] + 1)",61,66,"* --- Automatically Added Context ---
rank_n (ModelsZ, ModelMedianZ, (NumChannels + 1) / 2)
* --- End of Automatically Added Context ---"
c8bd8b94,micro,5,,"dev_set_color ('green')
dev_set_draw ('margin')
dev_display (ModelROI)
disp_continue_message (WindowHandle, 'black', 'true')
stop ()",67,73,"* --- Automatically Added Context ---
dev_open_window (0, 0, (Part[3] - Part[1]) * 4, (Part[2] - Part[0]) * 4, 'black', WindowHandle)
select_shape (ConnectedRegions, ModelROI, 'area', 'and', sort(Area..."
c8bd8b94,micro,6,,"reduce_domain (ModelMedianX, ModelROI, ModelX)
reduce_domain (ModelMedianY, ModelROI, ModelY)
reduce_domain (ModelMedianZ, ModelROI, ModelZ)
xyz_to_object_model_3d (ModelX, ModelY, ModelZ, OM3DReduced)",74,78,"* --- Automatically Added Context ---
rank_n (ModelsX, ModelMedianX, (NumChannels + 1) / 2)
rank_n (ModelsY, ModelMedianY, (NumChannels + 1) / 2)
rank_n (ModelsZ, ModelMedianZ, (NumChannels + 1) / 2)
..."
c8bd8b94,micro,7,,"connection_object_model_3d (OM3DReduced, 'distance_3d', 0.009, OM3DConnected)
select_object_model_3d (OM3DConnected, 'num_points', 'and', 500, 99999999, OM3DSelected)",79,81,"* --- Automatically Added Context ---
xyz_to_object_model_3d (ModelX, ModelY, ModelZ, OM3DReduced)
* --- End of Automatically Added Context ---"
c8bd8b94,micro,8,,"surface_normals_object_model_3d (OM3DSelected, 'mls', [], [], OM3DModel)",82,83,"* --- Automatically Added Context ---
select_object_model_3d (OM3DConnected, 'num_points', 'and', 500, 99999999, OM3DSelected)
* --- End of Automatically Added Context ---"
c8bd8b94,micro,9,,"create_surface_model (OM3DModel, 0.03, 'model_invert_normals', 'true', SurfaceModelID)
get_surface_model_param (SurfaceModelID, 'center', ModelCenter)
disp_continue_message (WindowHandle, 'black', 'true')
create_pose (-0.33, -0.38, 16, 0, 0, 180, 'Rp+T', 'gba', 'point', DispPose)
disp_object_model_3...",84,94,"* --- Automatically Added Context ---
dev_open_window (0, 0, (Part[3] - Part[1]) * 4, (Part[2] - Part[0]) * 4, 'black', WindowHandle)
surface_normals_object_model_3d (OM3DSelected, 'mls', [], [], OM3D..."
c8bd8b94,micro,10,"pose. This leads to an outlier pose.
**************************************************************","Poses := []
Color := ['orange', 'gold', 'goldenrod', 'yellow', 'cyan']
for Index := 8 to 11 by 1
read_image (Scene, 'time_of_flight/gutter_corner_xyz_' + Index$'02')
select_obj (Scene, X, 1)
select_obj (Scene, Y, 2)
select_obj (Scene, Z, 3)
copy_image (Z, BaseSceneZ)
disp_depth_image (BaseSceneZ, Pa...",103,133,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
c8bd8b94,micro,11,,"pose_average (Poses, [], 'direct', 'auto', 'auto', AveragePoseDirect, Quality1)
gen_reprojected_silhouette (RegionAffineTransDirect, OM3DModel, CameraParam, AveragePoseDirect)
dev_clear_window ()
disp_depth_image (BaseSceneZ, Part)
dev_set_colored (12)
dev_disp_3d_coord_system (WindowHandle, CameraP...",137,150,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
c8bd8b94,micro,12,,"read_image (Scene, 'time_of_flight/gutter_corner_xyz_12')
select_obj (Scene, X, 1)
select_obj (Scene, Y, 2)
select_obj (Scene, Z, 3)
disp_depth_image (BaseSceneZ, Part)
xyz_to_object_model_3d (X, Y, Z, OM3DScene)
find_surface_model (SurfaceModelID, OM3DScene, 0.05, 0.2, 0, 'false', [], [], Pose, Sco...",156,176,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
c8bd8b94,micro,13,,"pose_average (Poses, [], 'direct', 'auto', 'auto', AveragePoseDirect, Quality1)
gen_reprojected_silhouette (RegionAffineTransDirect, OM3DModel, CameraParam, AveragePoseDirect)
disp_depth_image (BaseSceneZ, Part)
dev_set_colored (12)
dev_disp_3d_coord_system (WindowHandle, CameraParam, AveragePoseDir...",181,194,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
c8bd8b94,micro,14,,"pose_average (Poses, [], 'iterative', 'auto', 'auto', AveragePoseIterativeAuto, Quality)
gen_reprojected_silhouette (RegionAffineTransIterativeAuto, OM3DModel, CameraParam, AveragePoseIterativeAuto)
dev_clear_window ()
disp_depth_image (BaseSceneZ, Part)
dev_set_colored (12)
dev_disp_3d_coord_system...",195,213,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
c8bd8b94,micro,15,,"pose_average (Poses, [], 'iterative', 0.8, 'auto', AveragePoseIterative, Quality)
gen_reprojected_silhouette (RegionAffineTransIterative, OM3DModel, CameraParam, AveragePoseIterative)
dev_clear_window ()
disp_depth_image (BaseSceneZ, Part)
dev_set_colored (12)
dev_disp_3d_coord_system (WindowHandle,...",214,295,"* --- Automatically Added Context ---
gen_cam_par_area_scan_division (0.01, -10599.4, 4e-005, 4e-005, 87.6, 69.9, 176, 144, CameraParam)
Part := [16, 30, 133, 145]
dev_open_window (0, 0, (Part[3] - Pa..."
6c9abaa1,full,0,"This example shows how the operator 'pose_compose' is used.
'pose_compose' composes a new 3D pose fr...","create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.1, 0.5, 0.1, 7, 14, 27, 'Rp+T', 'gba', 'point', PoseLeft2)
create_pose (0.2, 0.2, 0.2, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRight)
create_pose (0.2, 0.7, 0.5, 44, 70, 30, 'Rp+T', 'gba', 'point', PoseRight2)
pose_...",15,35,
6c9abaa1,micro,1,,"create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.1, 0.5, 0.1, 7, 14, 27, 'Rp+T', 'gba', 'point', PoseLeft2)
create_pose (0.2, 0.2, 0.2, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRight)
create_pose (0.2, 0.7, 0.5, 44, 70, 30, 'Rp+T', 'gba', 'point', PoseRight2)",14,19,
6c9abaa1,micro,2,,"pose_compose (PoseLeft, PoseRight, PoseCompose)",20,21,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.2, 0.2, 0.2, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRight)
* --- End of Auto..."
6c9abaa1,micro,3,,"pose_compose ([PoseLeft,PoseLeft2], PoseRight, PoseCompose1)",22,23,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.1, 0.5, 0.1, 7, 14, 27, 'Rp+T', 'gba', 'point', PoseLeft2)
create_pose (0.2..."
6c9abaa1,micro,4,,"pose_compose (PoseLeft, [PoseRight,PoseRight2], PoseCompose2)",24,25,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.2, 0.2, 0.2, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRight)
create_pose (0.2,..."
6c9abaa1,micro,5,,"pose_compose ([PoseLeft,PoseLeft2], [PoseRight,PoseRight2], PoseCompose3)",26,28,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.1, 0.5, 0.1, 7, 14, 27, 'Rp+T', 'gba', 'point', PoseLeft2)
create_pose (0.2..."
6c9abaa1,micro,6,"The poses are converted into homogeneous matrices.
These are multiplied and the result is converted ...","pose_to_hom_mat3d (PoseLeft, HomMat3DLeft)
pose_to_hom_mat3d (PoseRight, HomMat3DRight)
hom_mat3d_compose (HomMat3DLeft, HomMat3DRight, HomMat3DCompose)
hom_mat3d_to_pose (HomMat3DCompose, PoseComposeAlternative)",29,41,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 77, 0, 0, 'Rp+T', 'gba', 'point', PoseLeft)
create_pose (0.2, 0.2, 0.2, 0, 90, 0, 'Rp+T', 'gba', 'point', PoseRight)
* --- End of Auto..."
2468de21,full,0,"This example demonstrates the use of the operator 'pose_invert'.
This operator inverts the input pos...","create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
create_pose (0.1, 0.4, 0.1, 23, 23, 90, 'Rp+T', 'gba', 'point', Pose2)
pose_invert (Pose, PoseInvert)
pose_invert ([Pose,Pose2], PoseInvert2)
pose_to_hom_mat3d (Pose, HomMat3D)
hom_mat3d_invert (HomMat3D, HomMat3DInvert)
hom_mat3d...",14,26,
2468de21,micro,1,,"create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
create_pose (0.1, 0.4, 0.1, 23, 23, 90, 'Rp+T', 'gba', 'point', Pose2)",13,16,
2468de21,micro,2,,"pose_invert (Pose, PoseInvert)",17,18,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatically Added Context ---"
2468de21,micro,3,,"pose_invert ([Pose,Pose2], PoseInvert2)",19,21,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
create_pose (0.1, 0.4, 0.1, 23, 23, 90, 'Rp+T', 'gba', 'point', Pose2)
* --- End of Automati..."
2468de21,micro,4,converted back into a pose.,"pose_to_hom_mat3d (Pose, HomMat3D)
hom_mat3d_invert (HomMat3D, HomMat3DInvert)
hom_mat3d_to_pose (HomMat3DInvert, PoseInvertAlternative)",22,32,"* --- Automatically Added Context ---
create_pose (0.1, 0.1, 0.1, 90, 90, 90, 'Rp+T', 'gba', 'point', Pose)
* --- End of Automatically Added Context ---"
a0597737,full,0,"The pose of an object always depends on the chosen reference
coordinate system. This example visuali...","dev_close_window ()
dev_get_preferences ('graphics_window_context_menu', GraphicsWindowContextMenu)
dev_set_preferences ('graphics_window_context_menu', 'false')
Width := 640
Height := 480
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true'...",18,446,
a0597737,micro,1,"coordinate system. This example visualizes the pose of the
object with respect to different coordina...","dev_close_window ()
dev_get_preferences ('graphics_window_context_menu', GraphicsWindowContextMenu)
dev_set_preferences ('graphics_window_context_menu', 'false')
Width := 640
Height := 480",7,22,
a0597737,micro,2,,"dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
gen_robot_cam_object (Image, WindowHandle)
dev_display (Image)
dev_set_line_width (2)",23,28,"* --- Automatically Added Context ---
Width := 640
Height := 480
* --- End of Automatically Added Context ---"
a0597737,micro,3,,"create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'point', WorldCSPose)",29,30,
a0597737,micro,4,,"create_pose (0.05, 0.20, 0.0, 180, 0, 45, 'Rp+T', 'gba', 'point', ObjInWorldPose)",31,32,"* --- Automatically Added Context ---
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'point', WorldCSPose)
* --- End of Automatically Added Context ---"
a0597737,micro,5,,"create_pose (-0.30, 0.20, 0.0, 90, 0, 0, 'Rp+T', 'gba', 'point', RobotInWorldPose)",33,34,"* --- Automatically Added Context ---
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'point', WorldCSPose)
* --- End of Automatically Added Context ---"
a0597737,micro,6,,"create_pose (0.1, -0.15, 0.0, -90, 0, 0, 'Rp+T', 'gba', 'point', CamInWorldPose)",35,36,"* --- Automatically Added Context ---
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'point', WorldCSPose)
* --- End of Automatically Added Context ---"
a0597737,micro,7,coordinate system.,"show_pose_in_selected_cs (Image, WindowHandle, ObjInWorldPose, RobotInWorldPose, CamInWorldPose, WorldCSPose)",37,39,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
gen_robot_cam_object (Image, WindowHandle)
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'poi..."
a0597737,micro,8,,"wait_seconds (0.5)
dev_set_preferences ('graphics_window_context_menu', GraphicsWindowContextMenu)",42,61,"* --- Automatically Added Context ---
dev_get_preferences ('graphics_window_context_menu', GraphicsWindowContextMenu)
* --- End of Automatically Added Context ---"
a0597737,micro,9,"WindowHandle: The window where the coordinate system shall be displayed
CamParam: The camera paramet...","CoordAxesLength := 0.01
get_window_extents (WindowHandle, WinRow, WinColumn, Width, Height)
OffsetRow := Row - Height / 2.0
OffsetColumn := Col - Width / 2.0
create_pose (0, 0, 0.2, Orientation3D[0], Orientation3D[1], Orientation3D[2], 'Rp+T', 'gba', 'point', OriginPose)",65,75,"* --- Automatically Added Context ---
Width := 640
Height := 480
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'point', WorldCSPose..."
a0597737,micro,10,,"pose_to_hom_mat3d (OriginPose, TransWorld2Cam)",76,77,"* --- Automatically Added Context ---
create_pose (0, 0, 0.2, Orientation3D[0], Orientation3D[1], Orientation3D[2], 'Rp+T', 'gba', 'point', OriginPose)
* --- End of Automatically Added Context ---"
a0597737,micro,11,,"affine_trans_point_3d (TransWorld2Cam, 0, 0, 0, OrigCamX, OrigCamY, OrigCamZ)
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)",78,80,"* --- Automatically Added Context ---
pose_to_hom_mat3d (OriginPose, TransWorld2Cam)
* --- End of Automatically Added Context ---"
a0597737,micro,12,,"affine_trans_point_3d (TransWorld2Cam, CoordAxesLength, 0, 0, X, Y, Z)
project_3d_point (X, Y, Z, CamParam, RowAxX, ColumnAxX)
affine_trans_point_3d (TransWorld2Cam, 0, CoordAxesLength, 0, X, Y, Z)
project_3d_point (X, Y, Z, CamParam, RowAxY, ColumnAxY)
affine_trans_point_3d (TransWorld2Cam, 0, 0, C...",81,88,"* --- Automatically Added Context ---
CoordAxesLength := 0.01
pose_to_hom_mat3d (OriginPose, TransWorld2Cam)
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)
* --- End of Autom..."
a0597737,micro,13,,"distance_pp ([Row0,Row0,Row0], [Column0,Column0,Column0], [RowAxX,RowAxY,RowAxZ], [ColumnAxX,ColumnAxY,ColumnAxZ], Distance)
HeadLength := int(max([max(Distance) / 12.0,5.0]))
gen_arrow_contour_xld (Arrows, [Row0,Row0,Row0], [Column0,Column0,Column0], [RowAxX,RowAxY,RowAxZ], [ColumnAxX,ColumnAxY,Col...",89,93,"* --- Automatically Added Context ---
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)
project_3d_point (X, Y, Z, CamParam, RowAxX, ColumnAxX)
project_3d_point (X, Y, Z, CamPar..."
a0597737,micro,14,,"ImageRowOffset := OffsetRow - 5
ImageColOffset := OffsetColumn - 4
hom_mat2d_translate (HomMat2DIdentity, ImageRowOffset, ImageColOffset, HomMat2DTranslate)
hom_mat2d_translate (HomMat2DTranslate, 0.5, 0.5, HomMat2DTmp)
hom_mat2d_translate_local (HomMat2DTmp, -0.5, -0.5, HomMat2DAdapted)
projective_...",94,101,"* --- Automatically Added Context ---
Width := 640
Height := 480
OffsetRow := Row - Height / 2.0
OffsetColumn := Col - Width / 2.0
gen_arrow_contour_xld (Arrows, [Row0,Row0,Row0], [Column0,Column0,Col..."
a0597737,micro,15,,"disp_xld (Arrows, WindowHandle)
get_rgb (WindowHandle, Red, Green, Blue)
set_rgb (WindowHandle, Red[0], Green[0], Blue[0])
set_tposition (WindowHandle, RowAxX + 3 + ImageRowOffset, ColumnAxX + 3 + ImageColOffset)
write_string (WindowHandle, 'X')
set_rgb (WindowHandle, Red[1 % |Red|], Green[1 % |Gree...",102,142,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
OffsetRow := Row - Height / 2.0
OffsetColumn := Col - Width / 2.0
affine_trans_point_3d (TransWorld2C..."
a0597737,micro,16,coordinate systems),"gen_cam_par_area_scan_division (0.01, 0, 7.32e-006, 7.4e-6, 323.6, 245.555, 640, 480, CamParam)
dev_update_off ()",149,152,"* --- Automatically Added Context ---
project_3d_point (OrigCamX, OrigCamY, OrigCamZ, CamParam, Row0, Column0)
* --- End of Automatically Added Context ---"
a0597737,micro,17,,"get_window_param (WindowHandle, 'flush', Flush)
set_window_param (WindowHandle, 'flush', 'false')",153,155,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
a0597737,micro,18,the corresponding coordinate system,"get_window_extents (WindowHandle, Row, Column, Width, Height)",156,158,"* --- Automatically Added Context ---
Width := 640
Height := 480
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
* --- End of Automatically Added Context ---"
a0597737,micro,19,,"ColorX := 'red'
ColorY := 'forest green'
ColorZ := 'blue'
TextColor := 'black'",159,163,
a0597737,micro,20,,"ObjRow := 425
ObjColumn := 385",164,166,
a0597737,micro,21,,"WorldRow := 220
WorldColumn := 310",167,169,
a0597737,micro,22,,"RobotRow := 425
RobotColumn := 46",170,172,
a0597737,micro,23,,"CamRow := 70
CamColumn := 450",173,175,
a0597737,micro,24,,"LabelOffsetColumn := 85
LabelOffsetRow := -15",176,178,
a0597737,micro,25,,"LabelObjInImage := [ObjRow + LabelOffsetRow,ObjColumn + LabelOffsetColumn]",179,180,"* --- Automatically Added Context ---
ObjRow := 425
ObjColumn := 385
LabelOffsetColumn := 85
LabelOffsetRow := -15
* --- End of Automatically Added Context ---"
a0597737,micro,26,,"LabelWorldInImage := [WorldRow + LabelOffsetRow,WorldColumn + LabelOffsetColumn]",181,182,"* --- Automatically Added Context ---
WorldRow := 220
WorldColumn := 310
LabelOffsetColumn := 85
LabelOffsetRow := -15
* --- End of Automatically Added Context ---"
a0597737,micro,27,,"LabelRobotInImage := [RobotRow + LabelOffsetRow,RobotColumn + LabelOffsetColumn]",183,184,"* --- Automatically Added Context ---
RobotRow := 425
RobotColumn := 46
LabelOffsetColumn := 85
LabelOffsetRow := -15
* --- End of Automatically Added Context ---"
a0597737,micro,28,,"LabelCamInImage := [CamRow + LabelOffsetRow,CamColumn + LabelOffsetColumn]",185,186,"* --- Automatically Added Context ---
CamRow := 70
CamColumn := 450
LabelOffsetColumn := 85
LabelOffsetRow := -15
* --- End of Automatically Added Context ---"
a0597737,micro,29,,"AreaSizeRow := 150
AreaSizeColumn := 220
StartOffset := -80
gen_rectangle1 (ROIObj, ObjRow + StartOffset, ObjColumn + StartOffset, ObjRow + AreaSizeRow, ObjColumn + AreaSizeColumn)
gen_rectangle1 (ROICam, CamRow + StartOffset, CamColumn + StartOffset, CamRow + AreaSizeRow, CamColumn + AreaSizeColumn...",187,194,"* --- Automatically Added Context ---
ObjRow := 425
ObjColumn := 385
WorldRow := 220
WorldColumn := 310
RobotRow := 425
RobotColumn := 46
CamRow := 70
CamColumn := 450
* --- End of Automatically Added..."
a0597737,micro,30,,"PoseTextRow := 260
PoseTextColumn := 460
Orientation3D := [ObjInWorldPose[3],ObjInWorldPose[4],ObjInWorldPose[5]]
Colors := [TextColor,TextColor,TextColor,ColorX,ColorY,ColorZ,ColorX,ColorY,ColorZ]
CurrentlyDisplayed := 0
ToBeDisplayed := 1
Button := 0
while (Button != 4)
if (ToBeDisplayed != Curren...",195,344,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
gen_robot_cam_object (Image, WindowHandle)
create_pose (0.0, 0.0, 0.0, 0, 0, 0.0, 'Rp+T', 'gba', 'poi..."
a0597737,micro,31,"The contents of the window is dumped into an image
object and returned.","dev_clear_window ()
dev_set_color ('black')
dev_set_line_width (3)
gen_rectangle2_contour_xld (Rectangle, 69.5, 449.5, rad(-90), 34, 22.8293)
gen_contour_polygon_xld (Triangle, [105, 131, 131, 131, 105, 131], [449, 426, 426, 469, 449, 469])
dev_display (Rectangle)
dev_display (Triangle)
dev_set_line...",345,390,"* --- Automatically Added Context ---
Width := 640
Height := 480
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
gen_robot_cam_object (Image, WindowHandle)
hom_mat2d_identity (HomMat2DIde..."
a0597737,micro,32,,"tile_images_offset (Images, Image, [0,ImagePosRow], [0,ImagePosCol], [-1, 0], [-1, 30], [-1, 125], [-1, 160], Width, Height)
dev_set_line_width (2)
return ()",391,432,"* --- Automatically Added Context ---
Width := 640
Height := 480
gen_robot_cam_object (Image, WindowHandle)
concat_obj (Image, ImageScaled, Images)
ImagePosRow := 330
ImagePosCol := 350
* --- End of A..."
a0597737,micro,33,,"reset_visualization (Image, WindowHandle, LabelObjInImage, LabelRobotInImage, LabelCamInImage, LabelWorldInImage)
dev_set_colored (3)
disp_3d_coord_system_in_image (WindowHandle, CamParam, Orientation3D, ObjRow, ObjColumn)
disp_3d_coord_system_in_image (WindowHandle, CamParam, SelectedOrientation, S...",433,472,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width, Height, 'white', WindowHandle)
gen_robot_cam_object (Image, WindowHandle)
create_pose (0.1, -0.15, 0.0, -90, 0, 0, 'Rp+T', 'gba', 'p..."
53ef7ac4,full,0,"This example shows the elementwise
comparison of tuples and the usage of
tuple_select_mask to access...","A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
C := ['x', 'y', 'xyz', 'yyy', 'z']
AEqualsB_a := A [==] B
tuple_equal_elem (A, B, AEqualsBb_b)
AEquals2_a := A [==] 2
tuple_equal_elem (A, 2, AEquals2_b)
XEqualsC_a := 'x' [==] C
tuple_equal_elem ('x', C, XEqualsC_b)
ANotEqualTo...",13,97,
53ef7ac4,micro,1,,"A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
C := ['x', 'y', 'xyz', 'yyy', 'z']",11,16,
53ef7ac4,micro,2,,"AEqualsB_a := A [==] B
tuple_equal_elem (A, B, AEqualsBb_b)
AEquals2_a := A [==] 2
tuple_equal_elem (A, 2, AEquals2_b)
XEqualsC_a := 'x' [==] C
tuple_equal_elem ('x', C, XEqualsC_b)",30,37,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
C := ['x', 'y', 'xyz', 'yyy', 'z']
* --- End of Automatically Added Context ---"
53ef7ac4,micro,3,,"ANotEqualToB_a := A [!=] B
tuple_not_equal_elem (A, B, ANotEqualToB_b)
ANotEqualTo2_a := A [!=] 2
tuple_not_equal_elem (A, 2, ANotEqualTo2_b)
XNotEqualToC_a := 'x' [!=] C
tuple_not_equal_elem ('x', C, XNotEqualToC_b)",38,45,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
C := ['x', 'y', 'xyz', 'yyy', 'z']
* --- End of Automatically Added Context ---"
53ef7ac4,micro,4,,"AGreaterThanB_a := A [&gt;] B
tuple_greater_elem (A, B, AGreaterThanB_b)
AGreaterThan2_a := A [&gt;] 2
tuple_greater_elem (A, 2, AGreaterThan2_b)
TwoGreaterThanB_a := 2 [&gt;] B
tuple_greater_elem (2, B, TwoGreaterThanB_b)",46,53,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
* --- End of Automatically Added Context ---"
53ef7ac4,micro,5,,"AGreaterOrEqualToB_a := A [&gt;=] B
tuple_greater_equal_elem (A, B, AGreaterOrEqualToB_b)
AGreaterOrEqualTo2_a := A [&gt;=] 2
tuple_greater_equal_elem (A, 2, AGreaterOrEqualToB_b)
TwoGreaterOrEqualToB_a := 2 [&gt;=] B
tuple_greater_equal_elem (2, B, TwoGreaterOrEqualToB_b)",54,61,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
* --- End of Automatically Added Context ---"
53ef7ac4,micro,6,,"ALessThanB_a := A [&lt;] B
tuple_less_elem (A, B, ALessThanB_b)
ALessThan2_a := A [&lt;] 2
tuple_less_elem (A, 2, ALessThan2_b)
TwoLessThanB_a := 2 [&lt;] B
tuple_less_elem (2, B, TwoLessThanB_b)",62,69,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
* --- End of Automatically Added Context ---"
53ef7ac4,micro,7,,"ALessOrEqualToB_a := A [&lt;=] B
tuple_less_equal_elem (A, B, ALessOrEqualToB_b)
ALessOrEqualTo2_a := A [&lt;=] 2
tuple_less_equal_elem (A, 2, ALessOrEqualTo2_b)
ThressLessOrEqualToB_a := 3 [&lt;=] B
tuple_less_equal_elem (3, B, ThressLessOrEqualToB_b)",70,77,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
B := [1, 3, 3, 3, 4, 4, 2, 2, 6, 6]
* --- End of Automatically Added Context ---"
53ef7ac4,micro,8,,"SelectedElementsOfAGreaterOrEqualToThree_a := select_mask(A,A [&gt;=] 3)
tuple_select_mask (A, A [&gt;=] 3, SelectedElementsOfAGreaterOrEqualToThree_b)",85,88,"* --- Automatically Added Context ---
A := [1, 2, 1, 3, 1, 4, 2, 5, 4, 6]
* --- End of Automatically Added Context ---"
53ef7ac4,micro,9,combine element/wise tuple comparison with select_mask,"Filenames := ['abcd.tif', 'image.jpg', 'xyz.tif', 'img00.png']
Extensions := Filenames{strrchr(Filenames,'.') + 1:strlen(Filenames) - 1}
Tiffs_a := select_mask(Filenames,Extensions [==] 'tif')
tuple_select_mask (Filenames, Extensions [==] 'tif', Tiffs_b)
dev_open_tool ('variable_view', 'default', 'd...",90,103,
854a44d0,full,0,"A dictionary is designed to store arbitrary tuple and/or iconic
object data within a single containe...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* dev_resize_window_fit_size (0, 0, 512, 512, -1, -1)
Message := 'This example demonstrates the basic'
Message[1] := 'functionality of dictionaries.'
Message[2] := 'It shows how arbitrary data can be'
Message[3] := 'stored i...",14,105,
854a44d0,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* dev_resize_window_fit_size (0, 0, 512, 512, -1, -1)
Message := 'This example demonstrates the basic'
Message[1] := 'functionality of dictionaries.'
Message[2] := 'It shows how arbitrary data can be'
Message[3] := 'stored i...",13,30,
854a44d0,micro,2,,"gen_image_gray_ramp (Image, 0, 1, 128, 256, 256, 512, 512)
gen_rectangle1 (Rectangle, 30, 20, 100, 200)
gen_contour_region_xld (Rectangle, Contours, 'border')
concat_obj (Image, Rectangle, ObjectsConcat)
concat_obj (ObjectsConcat, Contours, ObjectsConcat)",31,38,
854a44d0,micro,3,,"DictHandle := dict{}
DictHandle.single_integer := 27
DictHandle.single_string := 'Hello world'
DictHandle.mixed_tuple := ['The answer', 42]
DictHandle.single_image := Image
DictHandle.single_region := Rectangle
DictHandle.object_array := ObjectsConcat",39,47,"* --- Automatically Added Context ---
gen_image_gray_ramp (Image, 0, 1, 128, 256, 256, 512, 512)
gen_rectangle1 (Rectangle, 30, 20, 100, 200)
concat_obj (Image, Rectangle, ObjectsConcat)
* --- End of ..."
854a44d0,micro,4,,"ImageDict := dict{}
for I := 1 to 5 by 1
read_image (ImageDict.['image_' + I], 'printer_chip/printer_chip_0' + I)
endfor",48,54,
854a44d0,micro,5,"Note they require the dynamic access syntax, and if all your keys are
integers, you should consider ...","DictHandle.[0] := Image
DictHandle.[1] := Contours
DictHandle.[2] := 42",55,61,"* --- Automatically Added Context ---
gen_image_gray_ramp (Image, 0, 1, 128, 256, 256, 512, 512)
gen_contour_region_xld (Rectangle, Contours, 'border')
DictHandle := dict{}
* --- End of Automatically ..."
854a44d0,micro,6,- Get all available keys,"get_dict_param (DictHandle, 'keys', [], AllKeys)",62,64,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,7,,"get_dict_param (DictHandle, 'key_exists', ['mixed_tuple', 'foo', 2, 'single_image'], KeysPresence)",65,66,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,8,,"get_dict_param (DictHandle, 'key_data_type', ['mixed_tuple', 'object_array'], KeysType)",67,69,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,9,"Note, tuples are true deep copies and iconic objects are ref counted.",TupleCopy := DictHandle.mixed_tuple,70,72,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,10,"type of the variable ObjectCopy cannot be determined from the assignment
alone. There must be at lea...","gen_empty_obj (ObjectCopy)
ObjectCopy := DictHandle.object_array",73,79,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,11,,"get_dict_param (DictHandle, 'keys', [], AllKeys)
for Index := 0 to |AllKeys| - 1 by 1
NextKey := AllKeys[Index]
get_dict_param (DictHandle, 'key_data_type', NextKey, NextKeyDataType)
if (NextKeyDataType == 'tuple')
NextTupleCopy := DictHandle.[NextKey]
else
NextObjectCopy := DictHandle.[NextKey]
cou...",80,93,"* --- Automatically Added Context ---
DictHandle := dict{}
get_dict_param (DictHandle, 'keys', [], AllKeys)
* --- End of Automatically Added Context ---"
854a44d0,micro,12,1. Remove some keys,"remove_dict_key (DictHandle, ['single_image', 'single_region'])",94,96,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,13,,"DictHandle.[4711] := ['a string', 'yet another string']",97,98,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,14,,"DictHandle.object_array := 'this is now a simple text'
get_dict_param (DictHandle, 'keys', [], AllKeys_Modified)
get_dict_param (DictHandle, 'key_data_type', ['mixed_tuple', 'object_array'], KeysTypeModified)",99,102,"* --- Automatically Added Context ---
DictHandle := dict{}
* --- End of Automatically Added Context ---"
854a44d0,micro,15,,"remove_dict_key (DictHandle, AllKeys_Modified)
get_dict_param (DictHandle, 'keys', [], AllKeysCleared)",103,111,"* --- Automatically Added Context ---
DictHandle := dict{}
get_dict_param (DictHandle, 'keys', [], AllKeys_Modified)
* --- End of Automatically Added Context ---"
035b431a,full,0,"This example shows you how to migrate code that interacts with
dictionaries from using operators to ...","ImagePath := 'printer_chip/printer_chip_01'
create_dict (OpDict)
set_dict_tuple (OpDict, 'remove_outer_edges', 'true')
set_dict_tuple (OpDict, 'max_gap', 150)
read_image (PcbImage, ImagePath)
set_dict_object (PcbImage, OpDict, 'image')
get_dict_tuple (OpDict, 'max_gap', MaxGap)
if (MaxGap &gt; 100)
...",17,141,
035b431a,micro,1,,ImagePath := 'printer_chip/printer_chip_01',15,18,
035b431a,micro,2,,create_dict (OpDict),28,30,
035b431a,micro,3,overwrite existing elements.,"set_dict_tuple (OpDict, 'remove_outer_edges', 'true')
set_dict_tuple (OpDict, 'max_gap', 150)
read_image (PcbImage, ImagePath)
set_dict_object (PcbImage, OpDict, 'image')",31,38,"* --- Automatically Added Context ---
ImagePath := 'printer_chip/printer_chip_01'
create_dict (OpDict)
* --- End of Automatically Added Context ---"
035b431a,micro,4,out of the dictionary we got as input parameter.,"get_dict_tuple (OpDict, 'max_gap', MaxGap)
if (MaxGap &gt; 100)
get_dict_tuple (OpDict, 'remove_outer_edges', RemoveOuterEdges)
if (RemoveOuterEdges == 'true')
get_dict_object (Image, OpDict, 'image')
dev_display (Image)
endif
endif",39,50,"* --- Automatically Added Context ---
create_dict (OpDict)
* --- End of Automatically Added Context ---"
035b431a,micro,5,,stop (),51,53,
035b431a,micro,6,to create a dictionary and initialize it with values directly.,"DyDict := dict{['remove_outer_edges']: 'true', ['max_gap']: 150}",56,60,
035b431a,micro,7,the read_image () operator call directly into the dict.,"read_image (DyDict.['image'], ImagePath)",61,64,"* --- Automatically Added Context ---
ImagePath := 'printer_chip/printer_chip_01'
DyDict := dict{['remove_outer_edges']: 'true', ['max_gap']: 150}
* --- End of Automatically Added Context ---"
035b431a,micro,8,access expression to read values and use them.,"if (DyDict.['max_gap'] &gt; 100 and DyDict.['remove_outer_edges'] == 'true')
dev_display (DyDict.['image'])
endif",65,70,"* --- Automatically Added Context ---
DyDict := dict{['remove_outer_edges']: 'true', ['max_gap']: 150}
* --- End of Automatically Added Context ---"
035b431a,micro,9,"during program execution.
For these cases, there is a shorter and less noisy static
dictionary synta...","StDict := dict{remove_outer_edges: 'true', max_gap: 150}",76,82,
035b431a,micro,10,,"read_image (StDict.image, ImagePath)",83,85,"* --- Automatically Added Context ---
ImagePath := 'printer_chip/printer_chip_01'
StDict := dict{remove_outer_edges: 'true', max_gap: 150}
* --- End of Automatically Added Context ---"
035b431a,micro,11,access expressions.,"if (StDict.max_gap &gt; 100 and StDict.remove_outer_edges == 'true')
dev_display (StDict.image)
endif",86,91,"* --- Automatically Added Context ---
StDict := dict{remove_outer_edges: 'true', max_gap: 150}
* --- End of Automatically Added Context ---"
035b431a,micro,12,,stop (),92,94,
035b431a,micro,13,"dictionary expressions.
Because we want to be generic and work with all kinds of dictionaries,
we dy...","query_dict_item_lengths (StDict, StDictItemLength)",95,102,"* --- Automatically Added Context ---
StDict := dict{remove_outer_edges: 'true', max_gap: 150}
* --- End of Automatically Added Context ---"
035b431a,micro,14,,"query_dict_item_lengths (dict{x: [2, 6, 8]}, ItemLengthB)",103,105,
035b431a,micro,15,"dictionary expressions where possible as they provide the most compact and
easy-to-read syntax. Use ...","get_dict_param (Dict, 'keys', [], Keys)
KeyInfo := dict{}
for I := 0 to |Keys| - 1 by 1
Key := Keys[I]
get_dict_param (Dict, 'key_data_type', Key, KeyType)
if (KeyType == 'tuple')
KeyInfo.[Key] := |Dict.[Key]|
else
count_obj (Dict.[Key], KeyInfo.[Key])
endif
endfor
return ()",106,150,
56679807,full,0,"This example shows how to use tuple_histo_range to calculate
the value distribution of a tuple in a ...","tuple_rand (10, Tuple)
MinValue := 0.0
MaxValue := 1.0
NumBins := 5
tuple_histo_range (Tuple, MinValue, MaxValue, NumBins, Histo, BinSize)
Sorted := sort(Tuple)
dev_inspect_ctrl (Sorted)
dev_inspect_ctrl ([Histo,Distribution])
Sequence := [0:NumBins - 1]
Distribution := subset(Histo,Sequence) + ' va...",10,22,
56679807,micro,1,"the value distribution of a tuple in a user-defined value
range and number of bins.","tuple_rand (10, Tuple)
MinValue := 0.0
MaxValue := 1.0
NumBins := 5
tuple_histo_range (Tuple, MinValue, MaxValue, NumBins, Histo, BinSize)",6,16,
56679807,micro,2,,"Sorted := sort(Tuple)
dev_inspect_ctrl (Sorted)
dev_inspect_ctrl ([Histo,Distribution])
Sequence := [0:NumBins - 1]
Distribution := subset(Histo,Sequence) + ' values in [' + (Sequence * BinSize + MinValue)$'3' + ',' + ((Sequence + 1) * BinSize + MinValue)$'3' + '['",17,28,"* --- Automatically Added Context ---
tuple_rand (10, Tuple)
MinValue := 0.0
NumBins := 5
tuple_histo_range (Tuple, MinValue, MaxValue, NumBins, Histo, BinSize)
* --- End of Automatically Added Contex..."
e9b41078,full,0,"This example shows how to use tuple_insert
to insert one or more elements into a tuple at
a given po...","OriginalTuple := [0, 1, 2, 3, 4, 5]
tuple_insert (OriginalTuple, 3, 'x', InsertSingleValueA)
InsertSingleValueB := insert(OriginalTuple,3,'x')
tuple_insert (OriginalTuple, 1, ['y', 'z'], InsertedMultipleValuesA)
InsertedMultipleValuesB := insert(OriginalTuple,1,['y', 'z'])
tuple_insert (OriginalTupl...",10,25,
e9b41078,micro,1,"to insert one or more elements into a tuple at
a given position","OriginalTuple := [0, 1, 2, 3, 4, 5]",6,10,
e9b41078,micro,2,,"tuple_insert (OriginalTuple, 3, 'x', InsertSingleValueA)",11,12,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
e9b41078,micro,3,,"InsertSingleValueB := insert(OriginalTuple,3,'x')",13,15,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
e9b41078,micro,4,,"tuple_insert (OriginalTuple, 1, ['y', 'z'], InsertedMultipleValuesA)",16,17,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
e9b41078,micro,5,,"InsertedMultipleValuesB := insert(OriginalTuple,1,['y', 'z'])",18,20,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
e9b41078,micro,6,,"tuple_insert (OriginalTuple, 6, ['x', 'y', 'z'], AppendedA)",21,22,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
e9b41078,micro,7,,"AppendedB := insert(OriginalTuple,6,['x', 'y', 'z'])
dev_open_tool ('variable_view', 'default', 'default', 'default', 'default', [], [], ToolId)",23,31,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,full,0,"This example shows how to use tuple_replace
to replace one or more elements of a tuple","OriginalTuple := [0, 1, 2, 3, 4, 5]
tuple_replace (OriginalTuple, [0, 1], ['x', 'y'], Replaced1)
Replaced2 := replace(OriginalTuple,[0, 1],['x', 'y'])
tuple_replace (OriginalTuple, [1, 3, 5], -111, ReplacedWithOneValue1)
ReplacedWithOneValue2 := replace(OriginalTuple,[1, 3, 5],-111)
tuple_replace (O...",9,30,
9498ff5a,micro,1,to replace one or more elements of a tuple,"OriginalTuple := [0, 1, 2, 3, 4, 5]",6,9,
9498ff5a,micro,2,,"tuple_replace (OriginalTuple, [0, 1], ['x', 'y'], Replaced1)",10,11,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,3,,"Replaced2 := replace(OriginalTuple,[0, 1],['x', 'y'])",12,14,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,4,,"tuple_replace (OriginalTuple, [1, 3, 5], -111, ReplacedWithOneValue1)",15,16,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,5,,"ReplacedWithOneValue2 := replace(OriginalTuple,[1, 3, 5],-111)",17,19,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,6,"-&gt; Tuple will be extended with appropriate default values
The default value for numeric tuples is...","tuple_replace (OriginalTuple, 10, 100, Extended1)",20,23,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,7,,"Extended2 := replace(OriginalTuple,10,100)",24,25,"* --- Automatically Added Context ---
OriginalTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
9498ff5a,micro,8,,"tuple_replace (['a', 'b', 'c', 'd', 'e'], [7, 10], ['h', 'k'], StringsExtended1)",26,27,
9498ff5a,micro,9,,"StringsExtended2 := replace(['a', 'b', 'c', 'd', 'e'],[7, 10],['h', 'k'])
dev_open_tool ('variable_view', 'default', 'default', 'default', 'default', [], [], ToolId)",28,36,
f17f8ad7,full,0,"This example shows the usage of the HALCON operators
tuple_find, tuple_find_first and tuple_find_las...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example shows the operators tuple_find,'
Message[1] := 'tuple_find_first and tuple_find_last.'
Message[2] := 'Please'
Message[3]...",12,82,
f17f8ad7,micro,1,,"dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This example shows the operators tuple_find,'
Message[1] := 'tuple_find_first and tuple_find_last.'
Message[2] := 'Please'
Message[3]...",9,26,
f17f8ad7,micro,2,,ToFind := 1,34,37,
f17f8ad7,micro,3,,"IndicesFindA := find(Tuple,ToFind)
tuple_find (Tuple, ToFind, IndicesFindB)",38,41,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind := 1
* --- End of Automatically Added Context ---"
f17f8ad7,micro,4,,"IndicesFindFirstA := find_first(Tuple,ToFind)
tuple_find_first (Tuple, ToFind, IndicesFindFirstB)",42,45,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind := 1
* --- End of Automatically Added Context ---"
f17f8ad7,micro,5,,"IndicesFindLastA := find_last(Tuple,ToFind)
tuple_find_last (Tuple, ToFind, IndicesFindLastB)",46,50,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind := 1
* --- End of Automatically Added Context ---"
f17f8ad7,micro,6,"is to use tuple_equal_elem together with
tuple_select_mask","SelectMaskA := select_mask([0:|Tuple| - 1],Tuple [==] ToFind)
tuple_equal_elem (Tuple, ToFind, EqualB)
tuple_select_mask ([0:|Tuple| - 1], EqualB, SelectMaskB)",51,59,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind := 1
* --- End of Automatically Added Context ---"
f17f8ad7,micro,7,,"ToFind2 := [1, 3]",60,63,
f17f8ad7,micro,8,,"IndicesFindSubA := find(Tuple,ToFind2)
tuple_find (Tuple, ToFind2, IndicesFindSubB)",64,67,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind2 := [1, 3]
* --- End of Automatically Added Context ---"
f17f8ad7,micro,9,,"IndicesFindFirstSubA := find_first(Tuple,ToFind2)
tuple_find_first (Tuple, ToFind2, IndicesFindFirstSubB)",68,71,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind2 := [1, 3]
* --- End of Automatically Added Context ---"
f17f8ad7,micro,10,,"IndicesFindLastSubA := find_last(Tuple,ToFind2)
tuple_find_last (Tuple, ToFind2, IndicesFindLastSubB)",72,77,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
ToFind2 := [1, 3]
* --- End of Automatically Added Context ---"
f17f8ad7,micro,11,operators return -1,"NotFoundA := find(Tuple,9)
tuple_find (Tuple, 9, NotFoundB)",78,88,"* --- Automatically Added Context ---
Tuple := [1, 2, 1, 3, 1, 3, 2, 5, 4, 1, 8, 6]
* --- End of Automatically Added Context ---"
b951dfee,full,0,"This example shows how to use tuple_select_mask
to select in mask specified elements of a tuple","IntTuple := [0, 1, 2, 3, 4, 5]
StringTuple := ['abcd', 'defg', 'ghij']
tuple_select_mask (IntTuple, [0, 1, 0, 1, 0, 1], SelectSome1)
SelectSome2 := select_mask(IntTuple,[0, 1, 0, 1, 0, 1])
tuple_select_mask (IntTuple, [1, 1, 1, 1, 1, 1], SelectAll1)
SelectAll2 := select_mask(IntTuple,[1, 1, 1, 1, 1,...",9,26,
b951dfee,micro,1,to select in mask specified elements of a tuple,"IntTuple := [0, 1, 2, 3, 4, 5]
StringTuple := ['abcd', 'defg', 'ghij']",6,11,
b951dfee,micro,2,,"tuple_select_mask (IntTuple, [0, 1, 0, 1, 0, 1], SelectSome1)",12,13,"* --- Automatically Added Context ---
IntTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
b951dfee,micro,3,,"SelectSome2 := select_mask(IntTuple,[0, 1, 0, 1, 0, 1])",14,16,"* --- Automatically Added Context ---
IntTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
b951dfee,micro,4,,"tuple_select_mask (IntTuple, [1, 1, 1, 1, 1, 1], SelectAll1)",17,18,"* --- Automatically Added Context ---
IntTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
b951dfee,micro,5,,"SelectAll2 := select_mask(IntTuple,[1, 1, 1, 1, 1, 1])",19,21,"* --- Automatically Added Context ---
IntTuple := [0, 1, 2, 3, 4, 5]
* --- End of Automatically Added Context ---"
b951dfee,micro,6,,"tuple_select_mask (StringTuple, [0, 0, 1], SelectOne1)",22,23,"* --- Automatically Added Context ---
StringTuple := ['abcd', 'defg', 'ghij']
* --- End of Automatically Added Context ---"
b951dfee,micro,7,,"SelectOne2 := select_mask(StringTuple,[0, 0, 1])
dev_open_tool ('variable_view', 'default', 'default', 'default', 'default', [], [], ToolId)",24,32,"* --- Automatically Added Context ---
StringTuple := ['abcd', 'defg', 'ghij']
* --- End of Automatically Added Context ---"
c66064fe,full,0,"This example shows how to apply several fundamental
set-operators on tuples.
In particular the progr...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program gives an overview of tuple'
Message[1] := 'set operators and how to use them.'
Message[2] := 'Please'
Message[3] := ' - ...",23,85,
c66064fe,micro,1,"I.  The elements in the output tuple will be in the same order
as they were given in the input tuple...","dev_close_window ()
dev_update_off ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
Message := 'This program gives an overview of tuple'
Message[1] := 'set operators and how to use them.'
Message[2] := 'Please'
Message[3] := ' - ...",13,35,
c66064fe,micro,2,The input tuples contain only integer elements.,"TupleInt1 := [3, 1, 2, 9, 1]
TupleInt2 := [10, 2, 4, 3, 2]
tuple_union (TupleInt1, TupleInt2, UnionInt)
tuple_intersection (TupleInt1, TupleInt2, IntersectionInt)
tuple_difference (TupleInt1, TupleInt2, DifferenceInt)
tuple_symmdiff (TupleInt1, TupleInt2, SymmDiffInt)",36,44,
c66064fe,micro,3,,"UnionIntHDev := union(TupleInt1,TupleInt2)
IntersectionIntHDev := intersection(TupleInt1,TupleInt2)
DifferenceIntHDev := difference(TupleInt1,TupleInt2)
SymmDiffIntHDev := symmdiff(TupleInt1,TupleInt2)",45,50,"* --- Automatically Added Context ---
TupleInt1 := [3, 1, 2, 9, 1]
TupleInt2 := [10, 2, 4, 3, 2]
* --- End of Automatically Added Context ---"
c66064fe,micro,4,The input tuples contain only floating point numbers.,"TupleFloat1 := real([3, 1, 2, 9, 1])
TupleFloat2 := real([10, 2, 4, 3, 2])
tuple_union (TupleFloat1, TupleFloat2, UnionFloat)
tuple_intersection (TupleFloat1, TupleFloat2, IntersectionFloat)
tuple_difference (TupleFloat1, TupleFloat2, DifferenceFloat)
tuple_symmdiff (TupleFloat1, TupleFloat2, SymmDi...",51,59,
c66064fe,micro,5,The input tuples contain only string elements.,"TupleString1 := ['ab', 'a', 's', 'a', '1']
TupleString2 := ['1', 'ab', 'a', 'c']
tuple_union (TupleString1, TupleString2, UnionString)
tuple_intersection (TupleString1, TupleString2, IntersectionString)
tuple_difference (TupleString1, TupleString2, DifferenceString)
tuple_symmdiff (TupleString1, Tup...",60,68,
c66064fe,micro,6,The input tuples contain a mixed type of elements.,"TupleMixed1 := [0, 2.9, 5, 'a', 3, 5, 's']
TupleMixed2 := ['s', 5, 1, 3.0, 2.9]
tuple_union (TupleMixed1, TupleMixed2, UnionMixed)
tuple_intersection (TupleMixed1, TupleMixed2, IntersectionMixed)
tuple_difference (TupleMixed1, TupleMixed2, DifferenceMixed)
tuple_symmdiff (TupleMixed1, TupleMixed2, S...",69,77,
c66064fe,micro,7,"It is also possible to compute complex set operations with
nested elements.","Combined1 := union(intersection(TupleMixed1,TupleMixed2),intersection(TupleString1,TupleString2))
Combined2 := intersection(symmdiff(TupleMixed1,TupleMixed2),intersection(TupleString1,TupleString2))",78,83,"* --- Automatically Added Context ---
TupleString1 := ['ab', 'a', 's', 'a', '1']
TupleString2 := ['1', 'ab', 'a', 'c']
TupleMixed1 := [0, 2.9, 5, 'a', 3, 5, 's']
TupleMixed2 := ['s', 5, 1, 3.0, 2.9]
*..."
c66064fe,micro,8,,"dev_open_tool ('variable_view', 'default', 'default', 'default', 'default', [], [], ToolId)",84,91,
9387e77f,full,0,"From 18.11, HALCON supports UTF-8.
tuple_ord and tuple_chr use the Unicode code points.","tuple_ord ('茶', Ord)
tuple_ords ('ä茶', Ords)
tuple_chr (0x8336, Chr)
tuple_chrt ([0xE4, 0x8336], Chrt)
tuple_strlen ('ä茶δ', Length)
SubString := 'ä茶δ'{1}
SubString2 := 'αβγδε'{2:3}
tuple_split ('ä茶δ', '茶', Substrings)
tuple_str_first_n ('ä茶δ', 1, SubstringFirstN)
tuple_str_last_n ('ä茶δ', 1, Substrin...",10,50,
9387e77f,micro,1,,"tuple_ord ('茶', Ord)
tuple_ords ('ä茶', Ords)
tuple_chr (0x8336, Chr)
tuple_chrt ([0xE4, 0x8336], Chrt)",9,14,
9387e77f,micro,2,,"tuple_strlen ('ä茶δ', Length)
SubString := 'ä茶δ'{1}
SubString2 := 'αβγδε'{2:3}
tuple_split ('ä茶δ', '茶', Substrings)
tuple_str_first_n ('ä茶δ', 1, SubstringFirstN)
tuple_str_last_n ('ä茶δ', 1, SubstringLastN)
tuple_strchr ('ä茶δ', '茶', PositionStrChr)
tuple_strrchr ('ä茶δ', '茶', PositionStrrChr)
tuple_str...",15,26,
9387e77f,micro,3,,"tuple_regexp_match ('ä茶δ', '茶.', Matches)
tuple_regexp_replace ('ä茶δ', '茶.', 'Ω', Result)
tuple_regexp_select ('ä茶δ', '茶.', Selection)
tuple_regexp_test ('ä茶δ', '茶.', NumMatches)",27,32,
9387e77f,micro,4,,"set_system ('tsp_tuple_string_operator_mode', 'byte')",34,35,
9387e77f,micro,5,,"tuple_strlen ('ä茶', LengthInByte)",39,41,
9387e77f,micro,6,,ByteAtPosition3 := 'ä茶'{3},42,43,
9387e77f,micro,7,,"tuple_ords ('茶', BytesOfUnicodeCharacter)
set_system ('tsp_tuple_string_operator_mode', 'codepoint')",47,56,
acc3e3fc,full,0,"This example program demonstrates, how Unicode code points can be used
to create arbitrary strings o...","set_system ('filename_encoding', 'utf8')
tuple_chrt ([0x539f, 0x5358, 0x4fa1], JapaneseStr)
tuple_chr ([0x539f, 0x5358, 0x4fa1], JapaneseChars)
tuple_ords ('ＭＳ％ 原　単　価', JapaneseCodePoints)
JapaneseCodePointsHex := JapaneseCodePoints$'x'
tuple_chr ([0x410:0x42f], CyrillicCapitalLetters)
tuple_chr ([0...",11,43,
acc3e3fc,micro,1,,"set_system ('filename_encoding', 'utf8')",10,12,
acc3e3fc,micro,2,,"tuple_chrt ([0x539f, 0x5358, 0x4fa1], JapaneseStr)
tuple_chr ([0x539f, 0x5358, 0x4fa1], JapaneseChars)",13,16,
acc3e3fc,micro,3,"One can see that the characters MS% at the begin of the string are not
the standard ASCII characters...","tuple_ords ('ＭＳ％ 原　単　価', JapaneseCodePoints)
JapaneseCodePointsHex := JapaneseCodePoints$'x'",17,24,
acc3e3fc,micro,4,,"tuple_chr ([0x410:0x42f], CyrillicCapitalLetters)",25,27,
acc3e3fc,micro,5,,"tuple_chr ([0x2190:0x21e0], Arrows)",28,30,
acc3e3fc,micro,6,"For this we need to switch string operations into byte mode.
Note that in that mode tuple_ord cannot...","set_system ('tuple_string_operator_mode', 'byte')
tuple_ords ('ＭＳ％ 原　単　価', JapaneseUtf8Bytes)
JapaneseUtf8BytesHex := JapaneseUtf8Bytes$'x'
tuple_ords ('原', JapaneseUtf8Char)
JapaneseUtf8CharHex := JapaneseUtf8Char$'x'",31,41,
acc3e3fc,micro,7,,"set_system ('tuple_string_operator_mode', 'codepoint')",42,50,
e74f92a4,full,0,"This program demonstrates the tuple operators and functions for working
with regular expressions.
**...","tuple_regexp_match ('abba', 'ab*', Matches)
tuple_regexp_match ('abba', 'ba*', Matches)
tuple_regexp_match ('abba', 'b+a*', Matches)
tuple_regexp_test ('ababab', '(ab){3}', NumMatches)
tuple_regexp_test ('abababa', '(ab){3}', NumMatches)
tuple_regexp_test ('abababa', '^(ab){3}$', NumMatches)
tuple_r...",12,59,
e74f92a4,micro,1,"***** Regular expression basics
***************************************************","tuple_regexp_match ('abba', 'ab*', Matches)
tuple_regexp_match ('abba', 'ba*', Matches)
tuple_regexp_match ('abba', 'b+a*', Matches)
tuple_regexp_test ('ababab', '(ab){3}', NumMatches)
tuple_regexp_test ('abababa', '(ab){3}', NumMatches)
tuple_regexp_test ('abababa', '^(ab){3}$', NumMatches)
tuple_r...",9,20,
e74f92a4,micro,2,"***** Some sample expressions
***************************************************","tuple_regexp_replace (['SN/1234567-X', 'SN/2345678-Y', 'SN/3456789-Z'], 'SN/(\\d{7})-([A-Z])', 'Product Model $2, Serial Number $1', Result)
tuple_regexp_replace (['01/04/2000', '06/30/2007'], '(\\d{2})/(\\d{2})/(\\d{4})', 'Day: $2, Month: $1, Year: $3', Result)",21,25,"* --- Automatically Added Context ---
tuple_regexp_replace ('abba', 'b*', 'x', Result)
* --- End of Automatically Added Context ---"
e74f92a4,micro,3,"***** Working with file names
***************************************************","get_system ('image_dir', HalconImages)
get_system ('operating_system', OS)
if (OS{0:2} == 'Win')
tuple_split (HalconImages, ';', HalconImagesSplit)
else
tuple_split (HalconImages, ':', HalconImagesSplit)
endif
list_files (HalconImagesSplit[0], ['files', 'follow_links'], Files)",26,36,
e74f92a4,micro,4,,"tuple_regexp_select (Files, '\\.png$', FilesPNG)",37,38,"* --- Automatically Added Context ---
list_files (HalconImagesSplit[0], ['files', 'follow_links'], Files)
* --- End of Automatically Added Context ---"
e74f92a4,micro,5,,"tuple_regexp_select (FilesPNG, ['\\d\\.png$', 'invert_match'], FilesNoDigit)",39,40,"* --- Automatically Added Context ---
tuple_regexp_select (Files, '\\.png$', FilesPNG)
* --- End of Automatically Added Context ---"
e74f92a4,micro,6,,"tuple_regexp_match (FilesNoDigit, '[^/\\\\]*.png', ShortNames)",41,42,"* --- Automatically Added Context ---
tuple_regexp_select (FilesPNG, ['\\d\\.png$', 'invert_match'], FilesNoDigit)
* --- End of Automatically Added Context ---"
e74f92a4,micro,7,,"tuple_regexp_replace (ShortNames, '(.*)\\.png$', 'out_$1.jpg', ConvertedNames)",43,44,"* --- Automatically Added Context ---
tuple_regexp_match (FilesNoDigit, '[^/\\\\]*.png', ShortNames)
* --- End of Automatically Added Context ---"
e74f92a4,micro,8,,"tuple_regexp_test (ShortNames, '_|-', NumCombined)",45,46,"* --- Automatically Added Context ---
tuple_regexp_match (FilesNoDigit, '[^/\\\\]*.png', ShortNames)
* --- End of Automatically Added Context ---"
e74f92a4,micro,9,"***** Using regular expressions in HDevelop expressions
********************************************...","if (|ShortNames| &gt; 0)
Result := 100.0 * regexp_test(ShortNames,'\\d') / |ShortNames| + '% of PNG file names contain a digit'
endif",47,53,"* --- Automatically Added Context ---
tuple_regexp_replace ('abba', 'b*', 'x', Result)
tuple_regexp_match (FilesNoDigit, '[^/\\\\]*.png', ShortNames)
* --- End of Automatically Added Context ---"
e74f92a4,micro,10,,"Result := regexp_match(regexp_select(ShortNames,'^a'),'^a(.*)')",54,55,"* --- Automatically Added Context ---
tuple_regexp_replace ('abba', 'b*', 'x', Result)
tuple_regexp_match (FilesNoDigit, '[^/\\\\]*.png', ShortNames)
* --- End of Automatically Added Context ---"
e74f92a4,micro,11,,"if (ShortNames =~ '^z')
Result := 'A filename starting with z exists'
endif",56,65,"* --- Automatically Added Context ---
tuple_regexp_replace ('abba', 'b*', 'x', Result)
tuple_regexp_replace (['SN/1234567-X', 'SN/2345678-Y', 'SN/3456789-Z'], 'SN/(\\d{7})-([A-Z])', 'Product Model $2,..."
a5e7ebb0,full,0,"This program demonstrates the tuple split and join operators.
**************************************...","input := 'aaa;bbb;ccc'
tuple_split (input, ';', result)
input := ['aaaXXXbbbXXXccc', 'aaaYYYbbbYYYccc', 'aaaZZZbbbZZZccc']
tuple_split (input, ['XXX', 'YYY', 'ZZZ'], result)
input := ['aaa', 'aaa', 'aaa']
tuple_split (input, ['XXX', 'YYY', 'ZZZ'], result)
input := 'aaa'
tuple_split (input, ';', resu...",12,102,
a5e7ebb0,micro,1,"**** Tuple split with ASCII characters
**************************************************","input := 'aaa;bbb;ccc'
tuple_split (input, ';', result)
input := ['aaaXXXbbbXXXccc', 'aaaYYYbbbYYYccc', 'aaaZZZbbbZZZccc']
tuple_split (input, ['XXX', 'YYY', 'ZZZ'], result)
input := ['aaa', 'aaa', 'aaa']
tuple_split (input, ['XXX', 'YYY', 'ZZZ'], result)
input := 'aaa'
tuple_split (input, ';', resu...",8,29,
a5e7ebb0,micro,2,since this is required for splitting with UTF-8 strings,"get_system ('tuple_string_operator_mode', tuple_string_op_mode)
set_system ('tuple_string_operator_mode', 'codepoint')
input := '∏∏∏__茶__♌♌♌__茶__∑∑∑'
tuple_split (input, '__茶__', result)
input := ['∏∏∏__♋__♌♌♌__♋__∑∑∑', '∏∏∏__✋__♌♌♌__✋__∑∑∑', '∏∏∏__♑__♌♌♌__♑__∑∑∑']
tuple_split (input, ['__♋__', '__✋...",34,56,
a5e7ebb0,micro,3,,"set_system ('tuple_string_operator_mode', tuple_string_op_mode)",57,59,
a5e7ebb0,micro,4,"**** Tuple join with ASCII characters
**************************************************","input := ['aaa', 'bbb', 'ccc']
tuple_join (input, ';', result)
input := ['aaa', 'bbb', 'ccc']
tuple_join (input, ['XXX', 'YYY', 'ZZZ'], result)
input := 'aaa'
tuple_join (input, ['XXX', 'YYY', 'ZZZ'], result)
input := 'aaa'
tuple_join (input, ';', result)
input := ''
tuple_join (input, ';', result)
...",60,81,"* --- Automatically Added Context ---
tuple_split (input, ['XXX', 'YYY', 'ZZZ'], result)
* --- End of Automatically Added Context ---"
a5e7ebb0,micro,5,"**** Tuple join with UTF-8 characters
**************************************************","input := ['∏∏∏', '♌♌♌', '∑∑∑']
tuple_join (input, '__茶__', result)
input := ['∏∏∏', '♌♌♌', '∑∑∑']
tuple_join (input, ['__♋__', '__✋__', '__♑__'], result)
input := '∏∏∏'
tuple_join (input, ['__♋__', '__✋__', '__♑__'], result)
input := '∏∏∏'
tuple_join (input, '__♋__', result)
input := ''
tuple_join (...",82,108,
e9a81421,full,0,"This example shows how to use tuple_str_distance to
calculate the Levenshtein distance between strin...","tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)
Distance := str_distance('WordOne','WordTwo','levenshtein')
tuple_str_distance (['WordOne', 'WordTwo'], ['WordThree', 'WordFour'], 'levenshtein', Distance)
tuple_str_distance ('WordOne', ['WordTwo', 'WordThree'], 'levenshtein', Dista...",10,21,
e9a81421,micro,1,,"tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)",9,10,
e9a81421,micro,2,,"Distance := str_distance('WordOne','WordTwo','levenshtein')",11,13,"* --- Automatically Added Context ---
tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)
* --- End of Automatically Added Context ---"
e9a81421,micro,3,,"tuple_str_distance (['WordOne', 'WordTwo'], ['WordThree', 'WordFour'], 'levenshtein', Distance)",14,16,"* --- Automatically Added Context ---
tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)
* --- End of Automatically Added Context ---"
e9a81421,micro,4,,"tuple_str_distance ('WordOne', ['WordTwo', 'WordThree'], 'levenshtein', Distance)",17,19,"* --- Automatically Added Context ---
tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)
tuple_str_distance (['WordOne', 'WordTwo'], ['WordThree', 'WordFour'], 'levenshtein', Distance)..."
e9a81421,micro,5,,"tuple_str_distance (['WordOne', 'WordTwo'], [], 'levenshtein', Distance)",20,28,"* --- Automatically Added Context ---
tuple_str_distance ('WordOne', 'WordTwo', 'levenshtein', Distance)
* --- End of Automatically Added Context ---"
b054abcf,full,0,"This example shows how to use tuple_substr to
extract a substring from a tuple","String1 := 'abcdefghij'
String2 := '0123456'
tuple_substr (String1, 3, 5, SingleSubstring1)
SingleSubstring2 := String1{3:5}
tuple_substr (String1, [1, 2, 3], [3, 6, 3], MultipleIndices1)
MultipleIndices2 := String1{[1, 2, 3]:[3, 6, 3]}
tuple_substr ([String1,String2], 3, 5, MultipleInputStrings1)
M...",9,37,
b054abcf,micro,1,extract a substring from a tuple,"String1 := 'abcdefghij'
String2 := '0123456'",6,11,
b054abcf,micro,2,,"tuple_substr (String1, 3, 5, SingleSubstring1)",12,13,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
* --- End of Automatically Added Context ---"
b054abcf,micro,3,,SingleSubstring2 := String1{3:5},14,16,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
* --- End of Automatically Added Context ---"
b054abcf,micro,4,,"tuple_substr (String1, [1, 2, 3], [3, 6, 3], MultipleIndices1)",17,18,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
* --- End of Automatically Added Context ---"
b054abcf,micro,5,,"MultipleIndices2 := String1{[1, 2, 3]:[3, 6, 3]}",19,21,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
* --- End of Automatically Added Context ---"
b054abcf,micro,6,,"tuple_substr ([String1,String2], 3, 5, MultipleInputStrings1)",22,23,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
b054abcf,micro,7,,"MultipleInputStrings2 := [String1,String2]{3:5}",24,26,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
b054abcf,micro,8,,"tuple_substr ([String1,String2], [5, 0], [8, 1], MultipleInputStringsAndIndices1)",27,28,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
b054abcf,micro,9,,"MultipleInputStringsAndIndices2 := [String1,String2]{[5, 0]:[8, 1]}",29,31,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
b054abcf,micro,10,,"tuple_substr ([String1,String2], 1, 0, EmptySubstring1)",32,33,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
b054abcf,micro,11,,"EmptySubstring2 := [String1,String2]{1:0}
dev_open_tool ('variable_view', 'default', 'default', 'default', 'default', [], [], ToolId)",34,43,"* --- Automatically Added Context ---
String1 := 'abcdefghij'
String2 := '0123456'
* --- End of Automatically Added Context ---"
2fbf32cb,full,0,"This example demonstrates the limits of the numeric range
imposed by the underlying representation o...","SimpleInt := 4234
LargestIntHalcon32 := H_INT32_MAX
SmallestIntHalcon32 := H_INT32_MIN
LargestIntHalcon64 := H_INT64_MAX
SmallestIntHalcon64 := H_INT64_MIN
LargestIntHalcon := H_INT_MAX
SmallestIntHalcon := H_INT_MIN
SimpleFloat := 3.79
LargestFloatTuple := H_FLOAT64_MAX
SmallestFloatTuple := H_FLOA...",14,72,
2fbf32cb,micro,1,"HALCON 32-bit and signed 64-bit integers for HALCON 64-bit
This means they can hold at most 2^32 or ...","SimpleInt := 4234
LargestIntHalcon32 := H_INT32_MAX
SmallestIntHalcon32 := H_INT32_MIN",10,18,
2fbf32cb,micro,2,,"LargestIntHalcon64 := H_INT64_MAX
SmallestIntHalcon64 := H_INT64_MIN",19,22,
2fbf32cb,micro,3,or 64-bit HALCON is used.,"LargestIntHalcon := H_INT_MAX
SmallestIntHalcon := H_INT_MIN",23,27,
2fbf32cb,micro,4,binary64 floats.,"SimpleFloat := 3.79
LargestFloatTuple := H_FLOAT64_MAX
SmallestFloatTuple := H_FLOAT64_MIN
SmallestPositiveFloatTuple := H_FLOAT64_MIN_POSITIVE
EpsilonFloatTuple := H_FLOAT64_EPSILON",28,36,
2fbf32cb,micro,5,IEEE 754 binary32 floats.,"LargestFloatRealImage := H_FLOAT32_MAX
SmallestFloatRealImage := H_FLOAT32_MIN
SmallestPositiveFloatRealImage := H_FLOAT32_MIN_POSITIVE
EpsilonFloatRealImage := H_FLOAT32_EPSILON",37,43,
2fbf32cb,micro,6,of precision.,"FloatInfinity := H_FLOAT_INFINITY
FloatNegativeInfinity := H_FLOAT_NEG_INFINITY
FloatNan := H_FLOAT_NAN",44,49,
2fbf32cb,micro,7,Use tuple_is_nan_elem to test if a value is NaN.,"if (FloatNan != H_FLOAT_NAN)
MsgB := 'Wrong way to check for NaN'
endif
if (not is_nan_elem(LargestFloatRealImage))
MsgA := 'LargestFloatRealImage is not NaN'
endif
if (not is_nan_elem(FloatNan))
MsgC := 'Correct way to check for NaN'
endif
MultiElemTupleIsNan := is_nan_elem(['xx',H_FLOAT_NAN,7.9,H_...",50,68,"* --- Automatically Added Context ---
LargestFloatRealImage := H_FLOAT32_MAX
FloatNan := H_FLOAT_NAN
* --- End of Automatically Added Context ---"
2fbf32cb,micro,8,"with the help of the operator tuple_constant, which
resolves their value at runtime.","tuple_constant ('H_INT_MIN', TupleConstantOperatorCallValue)",69,78,
dbe1ee8c,full,0,"This example shows how to use the operators tuple_type,
tuple_is_int, tuple_is_real, tuple_is_string...","UseTupleFunctions := false
create_matrix (3, 3, 0, MatrixID)
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]
if (UseTupleFunctions)
tuple_type (MyTuple, TupleType)
tuple_type_elem (MyTuple, ElemType)
else
TupleType := type(MyTuple)
ElemType := type_elem(MyTuple)
endif
tuple_type_to_strin...",16,130,
dbe1ee8c,micro,1,HDevelop functions,UseTupleFunctions := false,14,17,
dbe1ee8c,micro,2,,"create_matrix (3, 3, 0, MatrixID)
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]",18,21,
dbe1ee8c,micro,3,the constants to a human-readable text representation,"if (UseTupleFunctions)
tuple_type (MyTuple, TupleType)
tuple_type_elem (MyTuple, ElemType)
else
TupleType := type(MyTuple)
ElemType := type_elem(MyTuple)
endif
tuple_type_to_string (TupleType, TupleTypeString)
tuple_type_to_string (ElemType, ElemTypeString)",22,33,"* --- Automatically Added Context ---
UseTupleFunctions := false
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]
create_matrix (3, 3, 0, MatrixID)
* --- End of Automatically Added Context ..."
dbe1ee8c,micro,4,elements can be obtained in string form,"tuple_sem_type (MyTuple, SemType)
tuple_sem_type_elem (MyTuple, SemTypeElem)",34,38,"* --- Automatically Added Context ---
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]
create_matrix (3, 3, 0, MatrixID)
* --- End of Automatically Added Context ---"
dbe1ee8c,micro,5,,"if (UseTupleFunctions)
tuple_is_int (MyTuple, IsInt)
tuple_is_real (MyTuple, IsReal)
tuple_is_string (MyTuple, IsString)
tuple_is_handle (MyTuple, IsHandle)
tuple_is_mixed (MyTuple, IsMixed)
tuple_is_int_elem (MyTuple, IsIntElem)
tuple_is_real_elem (MyTuple, IsRealElem)
tuple_is_string_elem (MyTuple...",39,61,"* --- Automatically Added Context ---
UseTupleFunctions := false
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]
create_matrix (3, 3, 0, MatrixID)
* --- End of Automatically Added Context ..."
dbe1ee8c,micro,6,number of elements of type integer of the tuple MyTuple,NumInt := sum(IsIntElem),62,65,"* --- Automatically Added Context ---
tuple_is_int_elem (MyTuple, IsIntElem)
* --- End of Automatically Added Context ---"
dbe1ee8c,micro,7,,"dev_inspect_ctrl ([TupleTypeString,MyTuple,ElemTypeString,SemTypeElem,IsIntElem,IsRealElem,IsStringElem,IsHandleElem])",66,69,"* --- Automatically Added Context ---
MyTuple := [42,43 - 1,'forty-two', 42.0, 42,HNULL,MatrixID]
create_matrix (3, 3, 0, MatrixID)
tuple_type_to_string (TupleType, TupleTypeString)
tuple_type_to_stri..."
dbe1ee8c,micro,8,"of the same type from the beginning or without interruption.
A tuple that becomes a tuple whose elem...","IntTuple := gen_tuple_const(20000,1)
MixedTuple := [gen_tuple_const(20000 - 1,1),1.0]
count_seconds (S1)
SortTuple1 := sort(IntTuple)
count_seconds (S2)
SortTuple2 := sort(MixedTuple)
count_seconds (S3)
TimeSortInt := (S2 - S1) * 1000
TimeSortMixed := (S3 - S2) * 1000",70,83,
dbe1ee8c,micro,9,"a pure tuple e.g., with int() or tuple_int to improve the
speed of following operators that use that...","if (type(MixedTuple) == H_TYPE_MIXED)
CastTuple := int(MixedTuple)
endif
count_seconds (S4)
SortTuple2_Fast := sort(CastTuple)
count_seconds (S5)
TimeSortCast := (S5 - S4) * 1000",84,93,"* --- Automatically Added Context ---
MixedTuple := [gen_tuple_const(20000 - 1,1),1.0]
* --- End of Automatically Added Context ---"
dbe1ee8c,micro,10,,"dev_inspect_ctrl ([TimeSortInt,TimeSortMixed,TimeSortCast])",94,110,"* --- Automatically Added Context ---
TimeSortInt := (S2 - S1) * 1000
TimeSortMixed := (S3 - S2) * 1000
count_seconds (S1)
count_seconds (S2)
count_seconds (S3)
TimeSortCast := (S5 - S4) * 1000
count_..."
dbe1ee8c,micro,11,tuple elements to a human-readable interpretation,"for Index := 0 to |Types| - 1 by 1
if (Types[Index] == H_TYPE_INT)
Strings[Index] := 'integer'
elseif (Types[Index] == H_TYPE_REAL)
Strings[Index] := 'real'
elseif (Types[Index] == H_TYPE_STRING)
Strings[Index] := 'string'
elseif (Types[Index] == H_TYPE_HANDLE)
Strings[Index] := 'handle'
elseif (Typ...",111,139,"* --- Automatically Added Context ---
if (type(MixedTuple) == H_TYPE_MIXED)
* --- End of Automatically Added Context ---"
73b321f4,full,0,,"read_image (Image, 'fabrik')
regiongrowing (Image, Regions, 1, 1, 6, 1)
dev_set_colored (12)
dev_clear_window ()
gen_contour_region_xld (Regions, Contours, 'border')",6,10,
d63582fa,full,0,Create a NURBS curve that interpolates a list of points.,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Rows := [150, 160, 130, 140, 180]
Cols := [50, 200, 300, 400, 450]
gen_cross_contour_xld (Cross, Rows, Cols, 12, 0.785398)
gen_nurbs_interp (Rows, Cols, [0, -10, 0, 10], 3, CtrlRows, CtrlCols, Knots)
gen_contour_nurbs_xld (C...",7,15,
d63582fa,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Rows := [150, 160, 130, 140, 180]
Cols := [50, 200, 300, 400, 450]
gen_cross_contour_xld (Cross, Rows, Cols, 12, 0.785398)
gen_nurbs_interp (Rows, Cols, [0, -10, 0, 10], 3, CtrlRows, CtrlCols, Knots)
gen_contour_nurbs_xld (C...",6,21,
fa8cae09,full,0,"This example compares the operators elliptic_axis_xld and area_center_xld
to their counterparts elli...","dev_update_off ()
read_image (Image, 'clip')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
read_image (Image, 'clip')...",13,93,
fa8cae09,micro,1,"to their counterparts elliptic_axis_points_xld and area_center_points_xld.
While the features comput...","dev_update_off ()
read_image (Image, 'clip')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_display (Image)
read_image (Image, 'clip')",6,22,
fa8cae09,micro,2,,"lines_gauss (Image, Lines, 5.0, 0.8, 2.0, 'dark', 'true', 'bar-shaped', 'false')
union_adjacent_contours_xld (Lines, ClipContours, 50, 1, 'attr_keep')
select_shape_xld (ClipContours, ClipContours, 'width', 'and', 20, 99999)
close_contours_xld (ClipContours, ClosedContours)",23,29,"* --- Automatically Added Context ---
read_image (Image, 'clip')
* --- End of Automatically Added Context ---"
fa8cae09,micro,3,,"elliptic_axis_points_xld (ClipContours, RaPoints, RbPoints, PhiPoints)
elliptic_axis_xld (ClipContours, Ra, Rb, Phi)
count_obj (ClipContours, Number)
dev_display (Image)",30,35,"* --- Automatically Added Context ---
read_image (Image, 'clip')
union_adjacent_contours_xld (Lines, ClipContours, 50, 1, 'attr_keep')
* --- End of Automatically Added Context ---"
fa8cae09,micro,4,,"dev_set_line_width (3)
dev_set_color ('yellow')
dev_display (ClosedContours)
dev_set_color ('magenta')
dev_display (ClipContours)
dev_update_window ('off')
disp_continue_message (WindowHandle, 'black', 'true')
stop ()
area_center_points_xld (ClipContours, Area, RowPoints, ColumnPoints)
area_center_x...",36,46,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
union_adjacent_contours_xld (Lines, ClipContours, 50, 1, 'attr_keep')
close_contours_xld (Cli..."
fa8cae09,micro,5,,"select_shape_xld (ClipContours, BadClosed, 'area', 'and', 150, 5000)
gen_cross_contour_xld (Cross, Row, Column, 12, 0.785398)
dev_display (Cross)
dev_set_color ('red')
dev_display (BadClosed)",47,53,"* --- Automatically Added Context ---
union_adjacent_contours_xld (Lines, ClipContours, 50, 1, 'attr_keep')
area_center_xld (ClipContours, Area, Row, Column, PointOrder)
* --- End of Automatically Add..."
fa8cae09,micro,6,,"for Index := 1 to Number by 1
Sin := sin(Phi[Index - 1])
Cos := cos(Phi[Index - 1])
gen_ellipse_contour_xld (ContEllipse, Row[Index - 1], Column[Index - 1], Phi[Index - 1], Ra[Index - 1], Rb[Index - 1], 0, 6.28318, 'positive', 1.5)
if (Rb[Index - 1] &gt; 0)
dev_set_color ('green')
else
dev_set_color...",54,79,"* --- Automatically Added Context ---
read_image (Image, 'clip')
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
union_adjacent_contours_xld (Lines, ClipContours, 50, 1, 'attr_kee..."
fa8cae09,micro,7,,"dev_display (Cross)
for Index := 1 to Number by 1
Sin := sin(PhiPoints[Index - 1])
Cos := cos(PhiPoints[Index - 1])
gen_ellipse_contour_xld (ContEllipse, RowPoints[Index - 1], ColumnPoints[Index - 1], PhiPoints[Index - 1], RaPoints[Index - 1], RbPoints[Index - 1], 0, 6.28318, 'positive', 1.5)
dev_se...",80,99,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'black', WindowHandle)
elliptic_axis_points_xld (ClipContours, RaPoints, RbPoints, PhiPoints)
count_obj (ClipContour..."
30ba7e07,full,0,Robust circle fitting,"read_image (Image, 'earth')
rgb1_to_gray (Image, GrayImage)
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
threshold (GrayImage, Region, 60, 255)
closing_circle (Region, Region, 10.5)
gen_contour_region_xld (Region, Cont...",9,25,
30ba7e07,micro,1,,"read_image (Image, 'earth')
rgb1_to_gray (Image, GrayImage)
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
threshold (GrayImage, Region, 60, 255)
closing_circle (Region, Region, 10.5)
gen_contour_region_xld (Region, Cont...",7,17,
30ba7e07,micro,2,,"fit_circle_contour_xld (Contour, 'atukey', -1, 2, 0, 10, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
dev_set_color ('magenta')
gen_circle_contour_xld (ContCircle, Row, Column, Radius, 0, 4 * acos(0), 'positive', 1)",18,21,"* --- Automatically Added Context ---
gen_contour_region_xld (Region, Contour, 'border')
* --- End of Automatically Added Context ---"
30ba7e07,micro,3,,"fit_circle_contour_xld (Contour, 'geotukey', -1, 2, 0, 10, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
dev_set_color ('cyan')
gen_circle_contour_xld (ContCircle, Row, Column, Radius, 0, 4 * acos(0), 'positive', 1)",22,31,"* --- Automatically Added Context ---
gen_contour_region_xld (Region, Contour, 'border')
fit_circle_contour_xld (Contour, 'atukey', -1, 2, 0, 10, 1, Row, Column, Radius, StartPhi, EndPhi, PointOrder)
..."
476039f9,full,0,Approximation of XLD contours by ellipses or elliptic arcs,"gen_image_const (Image, 'byte', 400, 400)
dev_set_color ('green')
gen_ellipse (Ellipse, 200, 200, rad(30), 150, 120)
paint_region (Ellipse, Image, ImageEllipse, 255, 'fill')
edges_sub_pix (ImageEllipse, EdgesComplete, 'mderiche2', 0.5, 20, 40)
fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1...",8,51,
476039f9,micro,1,,"gen_image_const (Image, 'byte', 400, 400)
dev_set_color ('green')
gen_ellipse (Ellipse, 200, 200, rad(30), 150, 120)
paint_region (Ellipse, Image, ImageEllipse, 255, 'fill')
edges_sub_pix (ImageEllipse, EdgesComplete, 'mderiche2', 0.5, 20, 40)",6,12,
476039f9,micro,2,,"fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)",13,14,"* --- Automatically Added Context ---
edges_sub_pix (ImageEllipse, EdgesComplete, 'mderiche2', 0.5, 20, 40)
* --- End of Automatically Added Context ---"
476039f9,micro,3,,"gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder, 1.5)
gen_rectangle2 (Rectangle1, 200, 200, rad(30), 150, 2)
gen_rectangle2 (Rectangle2, 200, 200, rad(120), 150, 2)
union2 (Rectangle1, Rectangle2, Cross)
complement (Cross, CrossComplement)
reduc...",15,22,"* --- Automatically Added Context ---
paint_region (Ellipse, Image, ImageEllipse, 255, 'fill')
fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Rad..."
476039f9,micro,4,"First, make a fit to the individual arcs.","fit_ellipse_contour_xld (EdgesIncomplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)",23,25,"* --- Automatically Added Context ---
fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
edges_sub_pix (ImageE..."
476039f9,micro,5,This can be done by sorting them according to their StartPhi.,Order := sort_index(StartPhi),31,33,"* --- Automatically Added Context ---
fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
* --- End of Automati..."
476039f9,micro,6,,"RowsMerged := []
ColsMerged := []
for I := 0 to |Order| - 1 by 1
select_obj (EdgesIncomplete, SelectedEdge, Order[I] + 1)
get_contour_xld (SelectedEdge, Rows, Cols)
if (PointOrder[Order[I]] == 'negative')
Rows := inverse(Rows)
Cols := inverse(Cols)
endif
RowsMerged := [RowsMerged,Rows]
ColsMerged :=...",34,57,"* --- Automatically Added Context ---
fit_ellipse_contour_xld (EdgesComplete, 'fitzgibbon', -1, 2, 0, 200, 3, 2, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
edges_sub_pix (ImageE..."
2ac727a3,full,0,"**************************************************************************************************
E...","dev_set_line_width (2)
dev_update_window ('off')
TextHeight := 26
read_image (Image, 'tooth_rim')
zoom_image_factor (Image, Image, 0.5, 0.5, 'weighted')
get_image_size (Image, Width, Height)
edges_sub_pix (Image, Edges, 'canny', 1, 10, 30)
length_xld (Edges, Length)
tuple_sort_index (Length, Indices...",15,224,
2ac727a3,micro,1,,"dev_set_line_width (2)
dev_update_window ('off')
TextHeight := 26",14,18,
2ac727a3,micro,2,,"read_image (Image, 'tooth_rim')
zoom_image_factor (Image, Image, 0.5, 0.5, 'weighted')
get_image_size (Image, Width, Height)",19,23,
2ac727a3,micro,3,,"edges_sub_pix (Image, Edges, 'canny', 1, 10, 30)
length_xld (Edges, Length)
tuple_sort_index (Length, Indices)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)",24,29,"* --- Automatically Added Context ---
read_image (Image, 'tooth_rim')
* --- End of Automatically Added Context ---"
2ac727a3,micro,4,,"clip_contours_xld (ContourComplete, ContourHalf, 90, 0, Height, Width)",30,32,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
* --- End of Automatically Added Context ---"
2ac727a3,micro,5,,"clip_contours_xld (ContourComplete, ContourThird, 147, 0, Height, Width)",33,36,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
* --- End of Automatically Added Context ---"
2ac727a3,micro,6,,"dev_open_window (0, 0, Width, Height + TextHeight, 'white', Window1)
dev_set_part (0, 0, Height - 1 + TextHeight, Width - 1)
dev_display (Image)
dev_set_color ('yellow')
dev_display (ContourHalf)",37,44,"* --- Automatically Added Context ---
TextHeight := 26
read_image (Image, 'tooth_rim')
get_image_size (Image, Width, Height)
clip_contours_xld (ContourComplete, ContourHalf, 90, 0, Height, Width)
* --..."
2ac727a3,micro,7,,"fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('red')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cross_c...",45,52,"* --- Automatically Added Context ---
clip_contours_xld (ContourComplete, ContourHalf, 90, 0, Height, Width)
* --- End of Automatically Added Context ---"
2ac727a3,micro,8,,"fit_ellipse_contour_xld (ContourHalf, 'geometric', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('green')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cross_...",53,61,"* --- Automatically Added Context ---
TextHeight := 26
get_image_size (Image, Width, Height)
clip_contours_xld (ContourComplete, ContourHalf, 90, 0, Height, Width)
dev_open_window (0, 0, Width, Height..."
2ac727a3,micro,9,,"dist_ellipse_contour_xld (ContourHalf, 'geometric', -1, 0, Row, Column, Phi, Radius1, Radius2, MinDist, MaxDist, AvgDist, SigmaDist)",62,65,"* --- Automatically Added Context ---
clip_contours_xld (ContourComplete, ContourHalf, 90, 0, Height, Width)
fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, ..."
2ac727a3,micro,10,,"dev_open_window (0, Width + 8, Width, Height + TextHeight, 'white', Window2)
dev_set_part (0, 0, Height - 1 + TextHeight, Width - 1)
dev_display (Image)
dev_set_color ('yellow')
dev_display (ContourThird)",66,73,"* --- Automatically Added Context ---
TextHeight := 26
read_image (Image, 'tooth_rim')
get_image_size (Image, Width, Height)
clip_contours_xld (ContourComplete, ContourThird, 147, 0, Height, Width)
* ..."
2ac727a3,micro,11,,"fit_ellipse_contour_xld (ContourThird, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('red')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cross_...",74,81,"* --- Automatically Added Context ---
clip_contours_xld (ContourComplete, ContourThird, 147, 0, Height, Width)
fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi..."
2ac727a3,micro,12,,"fit_ellipse_contour_xld (ContourThird, 'geometric', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('green')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cross...",82,91,"* --- Automatically Added Context ---
TextHeight := 26
get_image_size (Image, Width, Height)
clip_contours_xld (ContourComplete, ContourThird, 147, 0, Height, Width)
fit_ellipse_contour_xld (ContourHa..."
2ac727a3,micro,13,,"dev_open_window (Height + 74 + TextHeight, 0, Width, Height + TextHeight, 'white', Window3)
dev_set_part (0, 0, Height - 1 + TextHeight, Width - 1)
dev_display (Image)
dev_set_color ('yellow')
dev_display (ContourComplete)",92,99,"* --- Automatically Added Context ---
TextHeight := 26
read_image (Image, 'tooth_rim')
get_image_size (Image, Width, Height)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
* --- End o..."
2ac727a3,micro,14,,"fit_ellipse_contour_xld (ContourComplete, 'ftukey', -1, 0, 5, 200, 10, 4, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('red')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cross_...",100,107,"* --- Automatically Added Context ---
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1..."
2ac727a3,micro,15,,"fit_ellipse_contour_xld (ContourComplete, 'geotukey', -1, 0, 5, 200, 10, 4, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dev_set_color ('green')
gen_ellipse_contour_xld (ContEllipse, Row, Column, Phi, Radius1, Radius2, 0, rad(360), 'positive', 1)
dev_display (ContEllipse)
gen_cr...",108,117,"* --- Automatically Added Context ---
TextHeight := 26
get_image_size (Image, Width, Height)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
fit_ellipse_contour_xld (ContourHalf, 'fitz..."
2ac727a3,micro,16,,"dist_ellipse_contour_points_xld (ContourComplete, 'signed', 0, Row, Column, Phi, Radius1, Radius2, Distances)",120,122,"* --- Automatically Added Context ---
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1..."
2ac727a3,micro,17,,"segment_tooth_rim (Distances, Ind)
get_contour_xld (ContourComplete, Rows, Cols)
Rows := Rows[Ind[0]:Ind[1]]
Cols := Cols[Ind[0]:Ind[1]]
gen_contour_polygon_xld (Contour, Rows, Cols)
dev_open_window (Height + 74 + TextHeight, Width + 8, Width, Height + TextHeight, 'white', Window4)
dev_set_part (0, ...",123,136,"* --- Automatically Added Context ---
TextHeight := 26
read_image (Image, 'tooth_rim')
get_image_size (Image, Width, Height)
select_obj (Edges, ContourComplete, Indices[|Indices| - 1] + 1)
dist_ellips..."
2ac727a3,micro,18,,"dist_ellipse_contour_points_xld (Contour, 'signed', 0, Row, Column, Phi, Radius1, Radius2, Distances)
create_funct_1d_array (Distances, Rim)",137,140,"* --- Automatically Added Context ---
fit_ellipse_contour_xld (ContourHalf, 'fitzgibbon', -1, 0, 0, 200, 1, 1, Row, Column, Phi, Radius1, Radius2, StartPhi, EndPhi, PointOrder)
dist_ellipse_contour_po..."
2ac727a3,micro,19,,"local_min_max_funct_1d (Rim, 'strict_min_max', 'false', ToothMin, ToothMax)
ToothMin := ToothMin[1:|ToothMin| - 2]
ToothMinFct := subset(Distances,ToothMin)
ToothMax := ToothMax[1:|ToothMax| - 2]
ToothMaxFct := subset(Distances,ToothMax)
ToothAmpl := (mean(ToothMaxFct) - mean(ToothMinFct)) / 2",141,148,"* --- Automatically Added Context ---
dist_ellipse_contour_points_xld (ContourComplete, 'signed', 0, Row, Column, Phi, Radius1, Radius2, Distances)
create_funct_1d_array (Distances, Rim)
* --- End of ..."
2ac727a3,micro,20,,"zero_crossings_funct_1d (Rim, ToothDist)
ToothDist := ToothDist[1:|ToothDist| - 1] - ToothDist[0:|ToothDist| - 2]
ToothDist := mean(ToothDist)
set_tposition (Window4, Height - 22 + TextHeight, 20)
write_string (Window4, 'Tooth distance: ' + ToothDist$'-4.1f' + '    //    Tooth amplitude: ' + ToothAm...",149,180,"* --- Automatically Added Context ---
TextHeight := 26
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height + TextHeight, 'white', Window1)
dev_open_window (0, Width + 8, Width, ..."
2ac727a3,micro,21,,"create_funct_1d_array (Distances, Rim)
zero_crossings_funct_1d (Rim, Zeros)
ZerosDiff := Zeros[0:|Zeros| - 3] - Zeros[2:|Zeros| - 1]
tuple_median (ZerosDiff, MedianZerosDiff)
ZerosDiff := abs(ZerosDiff - MedianZerosDiff)
Ind := round(Zeros[0])
for i := 0 to |ZerosDiff| - 1 by 1
if (ZerosDiff[i] &gt;...",181,234,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dist_ellipse_contour_points_xld (ContourComplete, 'signed', 0, Row, Column, Phi, Radius1, Radius2, Distances)
segment_tooth_..."
fd9ea39e,full,0,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'white', WindowID)
set_display_font (WindowID, 14, 'mono', 'true', 'false')
dev_update_off ()
dev_set_line_width (3)
Button := -1
RowLine := []
ColLine := []
dev_set_color ('red')
Message := 'Use the left mouse button to draw data points'
Message[...",6,74,
fd9ea39e,micro,1,,"Button := -1
RowLine := []
ColLine := []
dev_set_color ('red')
Message := 'Use the left mouse button to draw data points'
Message[1] := 'that will be used to fit a line.'
Message[2] := '(Right click to end)'
disp_message (WindowID, Message, 'window', 12, 12, 'black', 'true')",12,21,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
* --- End of Automatically Added Context ---"
fd9ea39e,micro,2,Use right button to end input,"while (Button != 4)
get_mbutton (WindowID, Row, Column, Button)
if (Button != 4)
gen_cross_contour_xld (Cross, Row, Column, 20, 0.785398)
dev_display (Cross)
RowLine := [RowLine,Row]
ColLine := [ColLine,Column]
endif
endwhile
dev_clear_window ()
gen_cross_contour_xld (Crosses, RowLine, ColLine, 20, ...",22,80,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'white', WindowID)
Button := -1
RowLine := []
ColLine := []
* --- End of Automatically Added Context ---"
40ee59e4,full,0,"This example program shows how fit_rectangle2_contour_xld can be used to
detect manufacturing errors...","dev_update_off ()
read_image (Image, 'punched_holes')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)
fast_threshold (Image, Region, 128, 255, 10)
b...",14,95,
40ee59e4,micro,1,"detect manufacturing errors of punched holes in a metal part.  The errors
show up as small protrusio...","dev_update_off ()
read_image (Image, 'punched_holes')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display (Image)",6,20,
40ee59e4,micro,2,"significantly by constructing a ROI for the subpixel-precise edge extraction
that is as small as pos...","fast_threshold (Image, Region, 128, 255, 10)
boundary (Region, Border, 'inner')
dilation_rectangle1 (Border, EdgeROI, 7, 7)
reduce_domain (Image, EdgeROI, ImageReduced)",21,28,"* --- Automatically Added Context ---
read_image (Image, 'punched_holes')
* --- End of Automatically Added Context ---"
40ee59e4,micro,3,,"edges_sub_pix (ImageReduced, Edges, 'canny', 1.7, 40, 120)",29,30,"* --- Automatically Added Context ---
reduce_domain (Image, EdgeROI, ImageReduced)
* --- End of Automatically Added Context ---"
40ee59e4,micro,4,,"select_shape_xld (Edges, RectangleEdges, 'contlength', 'and', 500, 100000)",31,32,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Edges, 'canny', 1.7, 40, 120)
* --- End of Automatically Added Context ---"
40ee59e4,micro,5,,"fit_rectangle2_contour_xld (RectangleEdges, 'tukey', -1, 0, 0, 3, 2, Row, Column, Phi, Length1, Length2, PointOrder)",33,34,"* --- Automatically Added Context ---
select_shape_xld (Edges, RectangleEdges, 'contlength', 'and', 500, 100000)
* --- End of Automatically Added Context ---"
40ee59e4,micro,6,,"gen_rectangle2_contour_xld (Rectangles, Row, Column, Phi, Length1, Length2)
dev_set_color ('yellow')
dev_display (Rectangles)",35,38,"* --- Automatically Added Context ---
fit_rectangle2_contour_xld (RectangleEdges, 'tukey', -1, 0, 0, 3, 2, Row, Column, Phi, Length1, Length2, PointOrder)
* --- End of Automatically Added Context ---"
40ee59e4,micro,7,,"count_obj (RectangleEdges, Number)
for I := 0 to Number - 1 by 1
select_obj (RectangleEdges, RectangleEdge, I + 1)
get_contour_xld (RectangleEdge, Rows, Cols)
gen_rectangle2_contour_xld (Rect, Row[I], Column[I], Phi[I], Length1[I], Length2[I])
get_contour_xld (Rect, RowC, ColC)
D1 := sqrt((Rows - Ro...",39,101,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
select_shape_xld (Edges, RectangleEdges, 'contlength', 'and', 5..."
e3542f8e,full,0,,"read_image (Image, 'ed_g')
pi := acos(0) * 2
Eps := pi / 4
dev_close_window ()
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'white', WindowID)
dev_set_draw ('margin')
dev_set_part (153, 165, 215, 231)
dev_display (Image)
disp_message (WindowID, 'Select ROI with the mou...",6,45,
e3542f8e,micro,1,,"disp_message (WindowID, 'Select ROI with the mouse', 'window', 12, 12, 'black', 'true')
draw_rectangle2 (WindowID, Row, Column, Phi, Length1, Length2)
gen_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
reduce_domain (Image, Rectangle, ImageReduced)
dev_display (Rectangle)
* dev_set_part ...",15,51,"* --- Automatically Added Context ---
read_image (Image, 'ed_g')
Eps := pi / 4
dev_open_window (0, 0, Width, Height, 'white', WindowID)
* --- End of Automatically Added Context ---"
b9a1dce5,full,0,This example shows some possibilities to select contours using their features.,"dev_close_window ()
read_image (Letters, 'letters')
crop_part (Letters, ImagePart, 295, 564, 260, 400)
get_image_size (ImagePart, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (ImagePart)
set_display_font (WindowHandle, 11, 'mono', 'true', 'false')
C...",7,53,
b9a1dce5,micro,1,,"dev_close_window ()
read_image (Letters, 'letters')
crop_part (Letters, ImagePart, 295, 564, 260, 400)
get_image_size (ImagePart, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (ImagePart)
set_display_font (WindowHandle, 11, 'mono', 'true', 'false')
C...",6,59,
4db4de2f,full,0,"This example program shows how to use select_xld_point.
Color code:
red - test point
white - contour...","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := 100.0
PointCol := 100.0
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150, 50], [200, 300, 300, 200, 200])
concat_obj (Contour...",16,100,
4db4de2f,micro,1,"red - test point
white - contours, selected
dim gray - contours, not selected","dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := 100.0
PointCol := 100.0
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150, 50], [200, 300, 300, 200, 200])
concat_obj (Contour...",9,38,
4db4de2f,micro,2,"Therefore, the selection for the open contours is exactly
the same as in the previous example.","PointRow := 100.0
PointCol := 100.0
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 150, 150, 50])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150], [200, 300, 300, 200])
concat_obj (Contours, Contour2, Contours)
select_xld_point (Contours, SelectedContours, PointRow, PointCol)
gen_...",39,60,"* --- Automatically Added Context ---
PointRow := 100.0
PointCol := 100.0
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
gen_contour_polygon_xld (Contour2, [50, 50,..."
4db4de2f,micro,3,line segments in real world applications will practically never intersect.,"PointRow := 200.0
PointCol := 200.0
gen_contour_polygon_xld (Contours, [50, 50, 250, 250, 150, 150, 350, 350, 50], [50, 250, 250, 150, 150, 350, 350, 50, 50])
select_xld_point (Contours, SelectedContours, PointRow, PointCol)
gen_cross_contour_xld (Cross, PointRow, PointCol, 6, 0.785398)
dev_clear_wi...",61,79,"* --- Automatically Added Context ---
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
PointRow := 100.0
PointCol := 100.0
select_xld_point (Contours, SelectedContour..."
4db4de2f,micro,4,cannot be classified reliably.,"PointRow := 200.0
PointCol := 200.0
gen_contour_polygon_xld (Contours, [150, 150, 250, 250, 150], [100, 200, 200, 100, 100])
gen_contour_polygon_xld (Contour2, [100, 100, 200, 200, 100], [150, 250, 250, 150, 150])
concat_obj (Contours, Contour2, Contours)
gen_contour_polygon_xld (Contour3, [150, 150...",80,106,"* --- Automatically Added Context ---
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150, 50], [200, 300, 300, 200,..."
fa73d04a,full,0,"This example program shows how to analyze two dimensional
statistical data with *_points_xld operato...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true',...",8,131,
fa73d04a,micro,1,statistical data with *_points_xld operators,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowHandle)
dev_set_colored (12)
set_display_font (WindowHandle, 14, 'mono', 'true',...",6,18,
fa73d04a,micro,2,,"binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)",19,21,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
fa73d04a,micro,3,,"dilation_circle (Region, RegionDilation, 3.5)",22,23,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
* --- End of Automatically Added Context ---"
fa73d04a,micro,4,,"connection (RegionDilation, ConnectedRegions)",24,25,"* --- Automatically Added Context ---
dilation_circle (Region, RegionDilation, 3.5)
* --- End of Automatically Added Context ---"
fa73d04a,micro,5,,"intersection (ConnectedRegions, Region, RegionIntersection)",26,27,"* --- Automatically Added Context ---
binary_threshold (Image, Region, 'max_separability', 'dark', UsedThreshold)
connection (RegionDilation, ConnectedRegions)
* --- End of Automatically Added Context..."
fa73d04a,micro,6,,"sort_region (RegionIntersection, Characters, 'character', 'true', 'row')",28,29,"* --- Automatically Added Context ---
intersection (ConnectedRegions, Region, RegionIntersection)
* --- End of Automatically Added Context ---"
fa73d04a,micro,7,,"count_obj (Characters, Number)
Classes := []
for J := 0 to 25 by 1
Classes := [Classes,gen_tuple_const(20,chr(ord('a') + J))]
endfor
Classes := [Classes,gen_tuple_const(20,'.')]",30,36,"* --- Automatically Added Context ---
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
* --- End of Automatically Added Context ---"
fa73d04a,micro,8,,"write_ocr_trainf (Characters, Image, Classes, 'letters.trf')",37,38,"* --- Automatically Added Context ---
read_image (Image, 'letters')
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
Classes := []
* --- End of Automatically Added Context ---"
fa73d04a,micro,9,"the training part of the program is generic and can be used to train any MLP
OCR classifier.","read_ocr_trainf_names ('letters.trf', CharacterNames, CharacterCount)
create_ocr_class_mlp (8, 10, 'weighted', ['anisometry', 'compactness'], CharacterNames, 5, 'none', 26, 42, OCRHandle)
count_obj (Characters, Number)
dev_set_colored (12)
dev_display (Characters)
disp_message (WindowHandle, ['Click...",39,49,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowHandle)
sort_region (RegionIntersection, Characters, 'character', 'true', 'row')
count_obj (Character..."
fa73d04a,micro,10,,dev_clear_window (),50,52,
fa73d04a,micro,11,,"Colors := ['red', 'green', 'blue', 'black', 'cyan', 'magenta', 'red', 'green', 'blue', 'black', 'cyan', 'magenta']
for ClassIndex := 0 to 11 by 1
Anisometries := []
Compactness := []
for Index := 1 + 20 * ClassIndex to 20 + 20 * ClassIndex by 1
select_obj (Characters, ObjectSelected, Index)
reduce_d...",53,90,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowHandle)
sort_region (RegionInters..."
fa73d04a,micro,12,,dev_clear_window (),91,93,
fa73d04a,micro,13,,"for ClassIndex := 0 to 11 by 1
Anisometries := []
Compactness := []
for Index := 1 + 20 * ClassIndex to 20 + 20 * ClassIndex by 1
select_obj (Characters, ObjectSelected, Index)
reduce_domain (Image, ObjectSelected, ImageReduced)
get_features_ocr_class_mlp (ImageReduced, OCRHandle, 'true', Features)
...",94,137,"* --- Automatically Added Context ---
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2, 'white', WindowHandle)
sort_region (RegionInters..."
b764b798,full,0,This example shows the usage of the HALCON operator test_closed_xld.,"dev_close_window ()
read_image (Image, 'tooth_rim')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
edges_sub_pix (Image, Edges, 'canny', 1, 20, 40)
test_closed_xld (Edges, IsClosed)
select_mask_obj (Edges, OpenContours, not ...",8,34,
b764b798,micro,1,,"dev_close_window ()
read_image (Image, 'tooth_rim')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
edges_sub_pix (Image, Edges, 'canny', 1, 20, 40)",6,16,
b764b798,micro,2,,"test_closed_xld (Edges, IsClosed)",17,19,"* --- Automatically Added Context ---
edges_sub_pix (Image, Edges, 'canny', 1, 20, 40)
* --- End of Automatically Added Context ---"
b764b798,micro,3,Use select_mask_obj to get the indices of all open contours.,"select_mask_obj (Edges, OpenContours, not IsClosed)
dev_display (Image)
dev_set_line_width (2)
dev_set_color ('blue')
dev_display (OpenContours)
disp_message (WindowHandle, 'Open contours', 'window', 12, 475, 'blue', 'true')",20,28,"* --- Automatically Added Context ---
read_image (Image, 'tooth_rim')
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 1, 20, 40)
test_closed_xld (Ed..."
b764b798,micro,4,Use select_mask_obj to get the indices of all closed contours.,"select_mask_obj (Edges, ClosedContours, IsClosed)
dev_set_color ('orange')
dev_display (ClosedContours)
disp_message (WindowHandle, 'Closed contours', 'window', 42, 475, 'orange', 'true')",29,40,"* --- Automatically Added Context ---
dev_open_window_fit_image (Image, 0, 0, -1, -1, WindowHandle)
edges_sub_pix (Image, Edges, 'canny', 1, 20, 40)
test_closed_xld (Edges, IsClosed)
* --- End of Auto..."
4fb9ffe4,full,0,This example program shows how to use test_self_intersection_xld.,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 200, 50, 200])
gen_contour_polygon_xld (Contour2, [50, 150, 150, 50, 50], [300, 450, 300, 450, 300])
concat_obj (Contours, Contour2, Contours)
gen_contour_polygon_x...",9,124,
4fb9ffe4,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)",7,13,
4fb9ffe4,micro,2,themselves.,"gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 200, 50, 200])
gen_contour_polygon_xld (Contour2, [50, 150, 150, 50, 50], [300, 450, 300, 450, 300])
concat_obj (Contours, Contour2, Contours)
gen_contour_polygon_xld (Contour3, [200, 300, 300, 200], [50, 50, 200, 200])
concat_obj (Contours...",14,34,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
4fb9ffe4,micro,3,are closed before testing.,"test_self_intersection_xld (Contours, 'true', DoesIntersect)
close_contours_xld (Contours, ClosedContours)
dev_clear_window ()
dev_set_color ('dim gray')
dev_display (ClosedContours)
dev_set_color ('white')
dev_display (Contours)
p_label_contours (Contours, WindowHandle, DoesIntersect)
stop ()",35,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 200, 50, 200])
test_self_intersection_xld (Con..."
4fb9ffe4,micro,4,only touch themselves.,"gen_contour_polygon_xld (Contours, [200, 200, 300, 300, 200], [50, 100, 100, 200, 200])
gen_contour_polygon_xld (Contour2, [200, 200, 300, 300, 200, 200], [300, 350, 350, 450, 450, 300])
concat_obj (Contours, Contour2, Contours)
test_self_intersection_xld (Contours, 'true', DoesIntersect)
close_cont...",51,70,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 200, 50, 200])
gen_contour_polygon_xld (Contou..."
4fb9ffe4,micro,5,whether or not a contour touches itself .,"gen_contour_polygon_xld (Contours, [200, 200, 300, 300, 200, 200], [50, 100, 100, 200, 200, 50])
hom_mat2d_identity (HomMat2DIdentity)
Pi := 3.14159265358
Count := 0.0
TotalCount := 0.0
for Angle := 0.0 to -Pi / 2.0 by -Pi / 200.0
hom_mat2d_rotate (HomMat2DIdentity, Angle, 300.0, 200.0, HomMat2DRota...",71,134,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 200, 50, 200])
test_self_intersection_xld (Con..."
e81610d4,full,0,This example program shows how to use test_xld_point.,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_contour_polygon_xld (Contour1, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50...",9,191,
e81610d4,micro,1,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')",7,15,
e81610d4,micro,2,by an XLD contour.,"PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_contour_polygon_xld (Contour1, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
test_xld_point (Contour1, PointRow, PointCol, IsInsideContour1)
gen_cross_contour_xld (Cross, PointRow, PointCol, 6, 0.785398)
dev_clear_window ()
dev_s...",16,42,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
* --- End of Automatically Added Context ---"
e81610d4,micro,3,"Therefore, the test result for the open contour is exactly
the same as in the previous example.","gen_contour_polygon_xld (Contour2, [50, 50, 150, 150], [50, 150, 150, 50])
test_xld_point (Contour2, PointRow, PointCol, IsInsideContour2)
dev_clear_window ()
dev_set_color ('white')
dev_display (Contour2)
dev_set_color ('gray')
dev_display (Cross)
for CurPoint := 0 to |PointRow| - 1 by 1
set_tposit...",43,67,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_cross_contour_xld (Cross, PointRow, P..."
e81610d4,micro,4,,"PointRow := 100
PointCol := 100
gen_contour_polygon_xld (Contours, [50, 50, 150, 150, 50], [50, 150, 150, 50, 50])
gen_contour_polygon_xld (Contour3, [250, 250, 350, 350, 250], [50, 150, 150, 50, 50])
concat_obj (Contours, Contour3, Contours)
gen_contour_polygon_xld (Contour4, [50, 50, 150, 150, 50]...",68,102,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_cross_contour_xld (Cross, PointRow, P..."
e81610d4,micro,5,"The i-th polygon is tested with the i-th point. Points are displayed
in the same color as their corr...","PointRow := [100, 100, 300, 300]
PointCol := [100, 300, 100, 300]
Colors := ['white', 'cyan', 'yellow', 'green']
test_xld_point (Contours, PointRow, PointCol, IsInsideContours)
gen_cross_contour_xld (Cross, PointRow, PointCol, 6, 0.785398)
dev_clear_window ()
count_obj (Contours, NumContours)
for Cu...",103,132,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
for CurPoint := 0 to |PointRow| - 1 by 1
..."
e81610d4,micro,6,line segments in real world applications will practically never intersect.,"PointRow := [100, 100, 200, 250, 300, 400, 400]
PointCol := [100, 400, 300, 250, 200, 100, 400]
gen_contour_polygon_xld (Contour6, [50, 50, 275, 275, 150, 150, 450, 450, 225, 225, 350, 350, 50], [50, 350, 350, 225, 225, 450, 450, 150, 150, 275, 275, 50, 50])
test_xld_point (Contour6, PointRow, Point...",133,159,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_cross_contour_xld (Cross, PointRow, P..."
e81610d4,micro,7,cannot be classified reliably.,"PointRow := 200
PointCol := 200
Steps := 100
Count := 0
TotalCount := 0
gen_cross_contour_xld (Cross, PointRow, PointCol, 6, 0.785398)
for Offset := -100.0 to 100.0 by 2.0
gen_contour_polygon_xld (Contour7, [400,200 + Offset,200 - Offset,400, 400], [100, 100, 300, 300, 100])
test_xld_point (Contour7...",160,197,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
PointRow := [100, 50, 150, 200]
PointCol := [100, 100, 100, 100]
gen_cross_contour_xld (Cross, PointRow, P..."
a4df7e3c,full,0,Compute the parallel contour of an XLD contour,"dev_set_color ('red')
gen_image_const (Image, 'byte', 64, 64)
gen_circle (Circle, 32, 32, 16)
paint_region (Circle, Image, ImageCircle, 255, 'fill')
edges_sub_pix (ImageCircle, Edges, 'canny', 1.5, 20, 40)
gen_parallel_contour_xld (Edges, ParallelEdgesAngle, 'contour_normal', 3)
gen_parallel_contour...",8,25,
a4df7e3c,micro,1,,dev_set_color ('red'),6,8,
a4df7e3c,micro,2,,"gen_image_const (Image, 'byte', 64, 64)
gen_circle (Circle, 32, 32, 16)
paint_region (Circle, Image, ImageCircle, 255, 'fill')",9,12,
a4df7e3c,micro,3,,"edges_sub_pix (ImageCircle, Edges, 'canny', 1.5, 20, 40)
gen_parallel_contour_xld (Edges, ParallelEdgesAngle, 'contour_normal', 3)
gen_parallel_contour_xld (Edges, ParallelEdgesGradient, 'gradient', -6)
gen_parallel_contour_xld (Edges, ParallelEdgesRegression, 'regression_normal', 9)
stop ()",13,18,"* --- Automatically Added Context ---
paint_region (Circle, Image, ImageCircle, 255, 'fill')
* --- End of Automatically Added Context ---"
a4df7e3c,micro,4,,"gen_rectangle1 (Rectangle, 0, 0, 63, 31)
paint_region (Rectangle, Image, ImageRectangle, 255, 'fill')
edges_sub_pix (ImageRectangle, Edges, 'canny', 1.5, 20, 40)
gen_parallel_contour_xld (Edges, ParallelEdgesAngle, 'contour_normal', -3)
gen_parallel_contour_xld (Edges, ParallelEdgesGradient, 'gradie...",19,31,"* --- Automatically Added Context ---
gen_image_const (Image, 'byte', 64, 64)
edges_sub_pix (ImageCircle, Edges, 'canny', 1.5, 20, 40)
gen_parallel_contour_xld (Edges, ParallelEdgesAngle, 'contour_nor..."
d802f373,full,0,"This program shows how to use hom_mat3d_project and
projective_trans_region to rotate an XLD contour...","dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')
threshold (Image, Region, 180, 255)
dilation_circle (Region, RegionDilation, 5.5)
reduce_domain (Image, RegionDilation, ImageReduced)
edges_sub_pix (ImageReduced, Contours, 'canny', 2, 20, 50)
get_imag...",8,83,
d802f373,micro,1,projective_trans_region to rotate an XLD contour in 3D.,"dev_update_pc ('off')
dev_update_window ('off')
dev_update_var ('off')
read_image (Image, 'mreut')",6,11,
d802f373,micro,2,,"threshold (Image, Region, 180, 255)
dilation_circle (Region, RegionDilation, 5.5)
reduce_domain (Image, RegionDilation, ImageReduced)
edges_sub_pix (ImageReduced, Contours, 'canny', 2, 20, 50)
get_image_size (Image, Width, Height)
dev_close_window ()
dev_open_window (0, 0, Width, Height, 'black', Wi...",12,19,"* --- Automatically Added Context ---
read_image (Image, 'mreut')
* --- End of Automatically Added Context ---"
d802f373,micro,3,"a smooth (i.e., flicker-free) display under both Windows and Unix.","open_window (0, 0, Width, Height, 0, 'buffer', '', WindowHandleBuffer)
set_color (WindowHandleBuffer, 'red')
set_part (WindowHandleBuffer, 0, 0, Height - 1, Width - 1)
Iter := 1440",20,25,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
d802f373,micro,4,"that their common divisor is as small as possible (0.1).  This leads to a
sequence of images that ha...","DAlpha := 1.3
DBeta := 1.7
DGamma := 1.9",26,31,
d802f373,micro,5,,"Alpha := 0.0
Beta := 0.0
Gamma := 0.0",32,35,
d802f373,micro,6,of the contours.,"PrincipalRow := Height / 2
PrincipalColumn := Width / 2
Focus := (Width + Height) / 2",36,40,"* --- Automatically Added Context ---
get_image_size (Image, Width, Height)
* --- End of Automatically Added Context ---"
d802f373,micro,7,"from which the contours are created moves in 3D.
This will generate the torus knot T(7,4).","M := 7
N := 4",41,45,
d802f373,micro,8,,"H := Height / 4.0
W := Width / 4.0
D := (Width + Height) / 6.0
for J := 1 to Iter by 1
hom_mat3d_identity (HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Gamma), 'z', PrincipalRow, PrincipalColumn, Focus, HomMat3D)
hom_mat3d_rotate (HomMat3D, rad(Beta), 'y', PrincipalRow, PrincipalColumn, Focus, HomMat3D...",46,89,"* --- Automatically Added Context ---
edges_sub_pix (ImageReduced, Contours, 'canny', 2, 20, 50)
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
open..."
ed77c9ad,full,0,"This example shows the usage of the operator difference_closed_contours_xld
First, two closed contou...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
dev_set_line_width (5)
dev_set_color ('green')
dev_dis...",10,49,
ed77c9ad,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)",8,12,
ed77c9ad,micro,2,,"difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)",13,15,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
ed77c9ad,micro,3,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (Contour1)
dev_set_color ('red')
dev_display (Contour2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursDifference)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",16,29,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
ed77c9ad,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
concat_obj (Boundary1, Hole1, BoundarySet1)
gen_ellipse_contour_xld (Boundary2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5...",30,37,
ed77c9ad,micro,5,,"difference_closed_contours_xld (BoundarySet1, BoundarySet2, ContoursDifference)",38,40,"* --- Automatically Added Context ---
difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2)
* ..."
ed77c9ad,micro,6,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursDifference)",41,55,"* --- Automatically Added Context ---
difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2)
* ..."
ce09bd6c,full,0,"This example shows the usage of the operator difference_closed_polygons_xld
First, two closed polygo...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
difference_closed_polygo...",10,57,
ce09bd6c,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)",8,14,
ce09bd6c,micro,2,,"difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)",15,17,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
* --- End of Automatically Added Context ---"
ce09bd6c,micro,3,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (Polygon1)
dev_set_color ('red')
dev_display (Polygon2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsDifference)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",18,32,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
difference_closed_polygons_xld (Polygon1, Polygon2, Polygons..."
ce09bd6c,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Boundary1, Boundary1Poly, 'ramer', 10)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Hole1, Hole1Poly, 'ramer', 10)
concat_obj (Boundary1Pol...",33,44,
ce09bd6c,micro,5,,"difference_closed_polygons_xld (BoundarySet1, BoundarySet2, PolygonsDifference)",45,47,"* --- Automatically Added Context ---
difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Poly, ..."
ce09bd6c,micro,6,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsDifference)",48,63,"* --- Automatically Added Context ---
difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Poly, ..."
d3c2e69c,full,0,"This example shows the usage of the operator intersection_closed_contours_xld
First, two closed cont...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
intersection_closed_contours_xld (Contour1, Contour2, ContoursIntersection)
dev_set_line_width (5)
dev_set_color ('green')
dev...",10,49,
d3c2e69c,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)",8,12,
d3c2e69c,micro,2,,"intersection_closed_contours_xld (Contour1, Contour2, ContoursIntersection)",13,15,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
d3c2e69c,micro,3,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (Contour1)
dev_set_color ('red')
dev_display (Contour2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursIntersection)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",16,29,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
d3c2e69c,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
concat_obj (Boundary1, Hole1, BoundarySet1)
gen_ellipse_contour_xld (Boundary2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5...",30,37,
d3c2e69c,micro,5,,"intersection_closed_contours_xld (BoundarySet1, BoundarySet2, ContoursIntersection)",38,40,"* --- Automatically Added Context ---
intersection_closed_contours_xld (Contour1, Contour2, ContoursIntersection)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2..."
d3c2e69c,micro,6,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursIntersection)",41,55,"* --- Automatically Added Context ---
intersection_closed_contours_xld (Contour1, Contour2, ContoursIntersection)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2..."
a74b27fd,full,0,"This example shows the usage of the operator intersection_closed_polygons_xld
First, two closed poly...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
intersection_closed_poly...",10,57,
a74b27fd,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)",8,14,
a74b27fd,micro,2,,"intersection_closed_polygons_xld (Polygon1, Polygon2, PolygonsIntersection)",15,17,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
* --- End of Automatically Added Context ---"
a74b27fd,micro,3,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (Polygon1)
dev_set_color ('red')
dev_display (Polygon2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsIntersection)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",18,32,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
intersection_closed_polygons_xld (Polygon1, Polygon2, Polygo..."
a74b27fd,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Boundary1, Boundary1Poly, 'ramer', 10)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Hole1, Hole1Poly, 'ramer', 10)
concat_obj (Boundary1Pol...",33,44,
a74b27fd,micro,5,,"intersection_closed_polygons_xld (BoundarySet1, BoundarySet2, PolygonsIntersection)",45,47,"* --- Automatically Added Context ---
intersection_closed_polygons_xld (Polygon1, Polygon2, PolygonsIntersection)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Po..."
a74b27fd,micro,6,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsIntersection)",48,63,"* --- Automatically Added Context ---
intersection_closed_polygons_xld (Polygon1, Polygon2, PolygonsIntersection)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Po..."
b4e7c7c6,full,0,"This example shows how to use the operator
intersection_region_contour_xld
Initialization.","dev_update_off ()
dev_set_line_width (3)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle1)
dev_open_window (0, 650, 640, 480, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')
read_image (Image, ...",11,107,
b4e7c7c6,micro,1,,"dev_update_off ()
dev_set_line_width (3)
dev_open_window (0, 0, 640, 480, 'black', WindowHandle1)
dev_open_window (0, 650, 640, 480, 'black', WindowHandle2)
set_display_font (WindowHandle1, 16, 'mono', 'true', 'false')
set_display_font (WindowHandle2, 16, 'mono', 'true', 'false')",10,17,
b4e7c7c6,micro,2,,"read_image (Image, 'rings_and_nuts')
edges_sub_pix (Image, TestContour, 'canny', 1, 20, 50)
gen_example_test_regions (TestRegion)",18,22,
b4e7c7c6,micro,3,,"count_seconds (T0)
intersection_region_contour_xld (TestRegion, TestContour, IntersectionPoints, 'points')
count_seconds (T1)
RuntimePointsMS := (T1 - T0) * 1000
dev_set_window (WindowHandle1)
visualize_intersection_result (Image, TestRegion, TestContour, IntersectionPoints, 'points', RuntimePointsM...",23,30,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle1)
read_image (Image, 'rings_and_nuts')
edges_sub_pix (Image, TestContour, 'canny', 1, 20, 50)
gen_example_t..."
b4e7c7c6,micro,4,,"count_seconds (T0)
intersection_region_contour_xld (TestRegion, TestContour, IntersectionLines, 'lines')
count_seconds (T1)
RuntimeLinesMS := (T1 - T0) * 1000
dev_set_window (WindowHandle2)
visualize_intersection_result (Image, TestRegion, TestContour, IntersectionLines, 'lines', RuntimeLinesMS)",31,38,"* --- Automatically Added Context ---
dev_open_window (0, 650, 640, 480, 'black', WindowHandle2)
read_image (Image, 'rings_and_nuts')
edges_sub_pix (Image, TestContour, 'canny', 1, 20, 50)
gen_example..."
b4e7c7c6,micro,5,,"dev_disp_text ('Press Run (F5) to continue', 'window', 'bottom', 'right', 'black', [], [])
stop ()",39,42,
b4e7c7c6,micro,6,,"dev_set_window (WindowHandle1)
dev_set_part (301, 52, 312, 66)
visualize_intersection_result (Image, TestRegion, TestContour, IntersectionPoints, 'points', RuntimePointsMS)
dev_set_window (WindowHandle2)
dev_set_part (301, 52, 312, 66)
visualize_intersection_result (Image, TestRegion, TestContour, I...",43,50,"* --- Automatically Added Context ---
dev_open_window (0, 0, 640, 480, 'black', WindowHandle1)
dev_open_window (0, 650, 640, 480, 'black', WindowHandle2)
read_image (Image, 'rings_and_nuts')
edges_sub..."
b4e7c7c6,micro,7,,"dev_disp_text ('      End of program      ', 'window', 'bottom', 'right', 'black', [], [])",51,65,
b4e7c7c6,micro,8,union over several circular regions.,"RandRow := [51, 383, 425, 101, 460, 31, 476, 258, 464, 293, 340, 15, 91, 157, 369, 342, 156, 435, 8, 387, 320, 391, 302, 367, 251, 19, 63, 311, 351, 331, 222, 356, 30, 266, 283, 254, 188, 378, 296, 109, 157, 37, 218, 191, 356, 6, 228, 0, 467, 154, 194, 261, 462, 427, 350, 54, 72, 355, 24, 150, 450, ...",66,161,"* --- Automatically Added Context ---
read_image (Image, 'rings_and_nuts')
edges_sub_pix (Image, TestContour, 'canny', 1, 20, 50)
gen_example_test_regions (TestRegion)
* --- End of Automatically Added..."
4f87b21d,full,0,"This example shows the usage of the operator symm_difference_closed_contours_xld
First, two closed c...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
symm_difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
count_obj (ContoursDifference, Number)
for Index ...",10,57,
4f87b21d,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)",8,12,
4f87b21d,micro,2,,"symm_difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)",13,15,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
4f87b21d,micro,3,This information is stored in the global contour attribute 'is_hole'.,"count_obj (ContoursDifference, Number)
for Index := 1 to Number by 1
select_obj (ContoursDifference, ObjectSelected, Index)
get_contour_global_attrib_xld (ObjectSelected, 'is_hole', Attrib)
endfor",16,23,"* --- Automatically Added Context ---
symm_difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
* --- End of Automatically Added Context ---"
4f87b21d,micro,4,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (Contour1)
dev_set_color ('red')
dev_display (Contour2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursDifference)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",24,37,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
4f87b21d,micro,5,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
concat_obj (Boundary1, Hole1, BoundarySet1)
gen_ellipse_contour_xld (Boundary2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5...",38,45,
4f87b21d,micro,6,,"symm_difference_closed_contours_xld (BoundarySet1, BoundarySet2, ContoursDifference)",46,48,"* --- Automatically Added Context ---
symm_difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet..."
4f87b21d,micro,7,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursDifference)",49,63,"* --- Automatically Added Context ---
symm_difference_closed_contours_xld (Contour1, Contour2, ContoursDifference)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet..."
747323a9,full,0,"This example shows the usage of the operator symm_difference_closed_polygons_xld
First, two closed p...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
symm_difference_closed_p...",10,57,
747323a9,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)",8,14,
747323a9,micro,2,,"symm_difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)",15,17,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
* --- End of Automatically Added Context ---"
747323a9,micro,3,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (Polygon1)
dev_set_color ('red')
dev_display (Polygon2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsDifference)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",18,32,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
symm_difference_closed_polygons_xld (Polygon1, Polygon2, Pol..."
747323a9,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Boundary1, Boundary1Poly, 'ramer', 10)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Hole1, Hole1Poly, 'ramer', 10)
concat_obj (Boundary1Pol...",33,44,
747323a9,micro,5,,"symm_difference_closed_polygons_xld (BoundarySet1, BoundarySet2, PolygonsDifference)",45,47,"* --- Automatically Added Context ---
symm_difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2P..."
747323a9,micro,6,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsDifference)",48,63,"* --- Automatically Added Context ---
symm_difference_closed_polygons_xld (Polygon1, Polygon2, PolygonsDifference)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2P..."
91d25052,full,0,"This example shows the usage of the operator union2_closed_contours_xld
First, two closed contours a...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
union2_closed_contours_xld (Contour1, Contour2, ContoursUnion)
dev_set_line_width (5)
dev_set_color ('green')
dev_display (Con...",10,57,
91d25052,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)",8,12,
91d25052,micro,2,,"union2_closed_contours_xld (Contour1, Contour2, ContoursUnion)",13,15,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
91d25052,micro,3,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (Contour1)
dev_set_color ('red')
dev_display (Contour2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursUnion)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",16,29,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'posi..."
91d25052,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
concat_obj (Boundary1, Hole1, BoundarySet1)
gen_ellipse_contour_xld (Boundary2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5...",30,37,
91d25052,micro,5,,"union2_closed_contours_xld (BoundarySet1, BoundarySet2, ContoursUnion)",38,40,"* --- Automatically Added Context ---
union2_closed_contours_xld (Contour1, Contour2, ContoursUnion)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2)
* --- End o..."
91d25052,micro,6,,"dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (ContoursUnion)",41,50,"* --- Automatically Added Context ---
union2_closed_contours_xld (Contour1, Contour2, ContoursUnion)
concat_obj (Boundary1, Hole1, BoundarySet1)
concat_obj (Boundary2, Hole2, BoundarySet2)
* --- End o..."
91d25052,micro,7,This information is stored in the global contour attribute 'is_hole'.,"count_obj (ContoursUnion, Number)
for Index := 1 to Number by 1
select_obj (ContoursUnion, ObjectSelected, Index)
get_contour_global_attrib_xld (ObjectSelected, 'is_hole', Attrib)
endfor",51,63,"* --- Automatically Added Context ---
union2_closed_contours_xld (Contour1, Contour2, ContoursUnion)
* --- End of Automatically Added Context ---"
7d7c6dff,full,0,"This example shows the usage of the operator union_closed_polygons_xld
First, two closed polygons ar...","gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
union2_closed_polygons_x...",10,57,
7d7c6dff,micro,1,These two regions overlap each other.,"gen_ellipse_contour_xld (Contour1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_ellipse_contour_xld (Contour2, 200, 300, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)",8,14,
7d7c6dff,micro,2,,"union2_closed_polygons_xld (Polygon1, Polygon2, PolygonsUnion)",15,17,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
* --- End of Automatically Added Context ---"
7d7c6dff,micro,3,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (Polygon1)
dev_set_color ('red')
dev_display (Polygon2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsUnion)
stop ()
dev_clear_window ()
dev_set_line_width (1)
dev_set_color ('white')",18,32,"* --- Automatically Added Context ---
gen_polygons_xld (Contour1, Polygon1, 'ramer', 10)
gen_polygons_xld (Contour2, Polygon2, 'ramer', 10)
union2_closed_polygons_xld (Polygon1, Polygon2, PolygonsUnio..."
7d7c6dff,micro,4,,"gen_ellipse_contour_xld (Boundary1, 200, 200, 0, 100, 100, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Boundary1, Boundary1Poly, 'ramer', 10)
gen_ellipse_contour_xld (Hole1, 200, 200, 0, 75, 75, 0, 6.28318, 'positive', 1.5)
gen_polygons_xld (Hole1, Hole1Poly, 'ramer', 10)
concat_obj (Boundary1Pol...",33,44,
7d7c6dff,micro,5,,"union2_closed_polygons_xld (BoundarySet1, BoundarySet2, PolygonsUnion)",45,47,"* --- Automatically Added Context ---
union2_closed_polygons_xld (Polygon1, Polygon2, PolygonsUnion)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Poly, BoundaryS..."
7d7c6dff,micro,6,,"dev_clear_window ()
dev_set_line_width (5)
dev_set_color ('green')
dev_display (BoundarySet1)
dev_set_color ('red')
dev_display (BoundarySet2)
dev_set_line_width (3)
dev_set_color ('blue')
dev_display (PolygonsUnion)",48,63,"* --- Automatically Added Context ---
union2_closed_polygons_xld (Polygon1, Polygon2, PolygonsUnion)
concat_obj (Boundary1Poly, Hole1Poly, BoundarySet1)
concat_obj (Boundary2Poly, Hole2Poly, BoundaryS..."
1717932b,full,0,This example program shows how to use clip_contours_xld.,"dev_close_window ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)
lines_gauss (Angio, Lines, 2.3, 0.0, 0.7, 'dark', 'true', 'parabolic', 'true')
dev_display (A...",10,57,
1717932b,micro,1,,"dev_close_window ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)",7,15,
1717932b,micro,2,,"lines_gauss (Angio, Lines, 2.3, 0.0, 0.7, 'dark', 'true', 'parabolic', 'true')
dev_display (Angio)
dev_set_color ('yellow')
dev_display (Lines)
stop ()",16,22,"* --- Automatically Added Context ---
read_image (Angio, 'angio-part')
* --- End of Automatically Added Context ---"
1717932b,micro,3,"are clipped accordingly (the original contours are displayed in gray).
Note, that the  clipped conto...","Top := 200
Left := 100
Bottom := 300
Right := 200
gen_rectangle1 (Rectangle, Top, Left, Bottom, Right)
reduce_domain (Angio, Rectangle, AngioReduced)
clip_contours_xld (Lines, LinesClipped, Top, Left, Bottom, Right)
dev_clear_window ()
dev_display (AngioReduced)
dev_set_color ('dim gray')
dev_displa...",23,63,"* --- Automatically Added Context ---
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
lines_gauss (Angio..."
ff53e1bd,full,0,"This example program shows the difference between the two modes of
clip_end_points_contours_xld by u...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_part (0, 0, 499, 499)
dev_set_line_width (3)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
gen_ellipse_contour_xld (EllipseContour, 250, 250, 0, 200, 100, 0, rad(180), 'positive', 3)
...",13,35,
ff53e1bd,micro,1,"clip_end_points_contours_xld by using an XLD contour of an ellipse that
has a contour point spacing ...","dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
dev_set_part (0, 0, 499, 499)
dev_set_line_width (3)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')",6,18,
ff53e1bd,micro,2,,"gen_ellipse_contour_xld (EllipseContour, 250, 250, 0, 200, 100, 0, rad(180), 'positive', 3)",19,20,
ff53e1bd,micro,3,,"clip_end_points_contours_xld (EllipseContour, ClippedContoursLength, 'length', 20)",21,22,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (EllipseContour, 250, 250, 0, 200, 100, 0, rad(180), 'positive', 3)
* --- End of Automatically Added Context ---"
ff53e1bd,micro,4,,"clip_end_points_contours_xld (EllipseContour, ClippedContoursNumPoints, 'num_points', 20)",23,24,"* --- Automatically Added Context ---
gen_ellipse_contour_xld (EllipseContour, 250, 250, 0, 200, 100, 0, rad(180), 'positive', 3)
* --- End of Automatically Added Context ---"
ff53e1bd,micro,5,,"dev_clear_window ()
Colors := ['blue', 'red', 'green']
dev_set_color (Colors[0])
dev_display (EllipseContour)
dev_set_color (Colors[1])
dev_display (ClippedContoursLength)
dev_set_color (Colors[2])
dev_display (ClippedContoursNumPoints)
String := ['Original', 'Clipped (length 20)', 'Clipped (20 poin...",25,41,"* --- Automatically Added Context ---
dev_open_window (0, 0, 500, 500, 'black', WindowHandle)
gen_ellipse_contour_xld (EllipseContour, 250, 250, 0, 200, 100, 0, rad(180), 'positive', 3)
clip_end_point..."
ce23796a,full,0,This example program shows how to use close_contours_xld.,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 150, 150, 250])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150, 60], [300, 450, 450, 300, 300])
concat_obj (Contours, Contour2, Contours)
gen_contour_polygon_...",10,49,
ce23796a,micro,1,,"dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)",7,14,
ce23796a,micro,2,"The input contours are displayed in white on top of the red output contours.
Thus, it becomes obviou...","gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 150, 150, 250])
gen_contour_polygon_xld (Contour2, [50, 50, 150, 150, 60], [300, 450, 450, 300, 300])
concat_obj (Contours, Contour2, Contours)
gen_contour_polygon_xld (Contour3, [200, 300, 300], [50, 50, 250])
concat_obj (Contours, Contour...",15,37,
ce23796a,micro,3,"to obtain a more meaningful result. With this, only the two contours to the
right are closed.","select_contours_xld (Contours, SelectedContours, 'closed', 0, 20, 0, 0)
close_contours_xld (SelectedContours, ClosedContours)
dev_clear_window ()
dev_set_color ('red')
dev_display (ClosedContours)
dev_set_color ('white')
dev_display (Contours)",38,55,"* --- Automatically Added Context ---
gen_contour_polygon_xld (Contours, [50, 50, 150, 150], [50, 150, 150, 250])
close_contours_xld (Contours, ClosedContours)
* --- End of Automatically Added Context..."
e57f986e,full,0,This example program shows how to use crop_contours_xld.,"dev_close_window ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)
lines_gauss (Angio, Lines, 2.3, 0.0, 0.7, 'dark', 'true', 'parabolic', 'true')
dev_display (A...",10,90,
e57f986e,micro,1,,"dev_close_window ()
read_image (Angio, 'angio-part')
get_image_size (Angio, Width, Height)
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
dev_set_part (0, 0, Height - 1, Width - 1)",7,15,
e57f986e,micro,2,,"lines_gauss (Angio, Lines, 2.3, 0.0, 0.7, 'dark', 'true', 'parabolic', 'true')
dev_display (Angio)
dev_set_color ('yellow')
dev_display (Lines)
stop ()",16,22,"* --- Automatically Added Context ---
read_image (Angio, 'angio-part')
* --- End of Automatically Added Context ---"
e57f986e,micro,3,"are clipped accordingly (the original contours are displayed in gray).
Note, that you have to expand...","Top := 200
Left := 100
Bottom := 300
Right := 200
gen_rectangle1 (Rectangle, Top, Left, Bottom, Right)
reduce_domain (Angio, Rectangle, AngioReduced)
crop_contours_xld (Lines, LinesCropped, Top - 0.5, Left - 0.5, Bottom + 0.5, Right + 0.5, 'false')
dev_clear_window ()
dev_display (AngioReduced)
dev_...",23,57,"* --- Automatically Added Context ---
read_image (Angio, 'angio-part')
dev_open_window (0, 0, 3 * Width / 2, 3 * Height / 2, 'black', WindowID)
lines_gauss (Angio, Lines, 2.3, 0.0, 0.7, 'dark', 'true'..."
e57f986e,micro,4,"CloseContours is set 'true'. In this case, the clipped contour segments are connected
along the bord...","gen_rectangle1 (Rectangles, 200, 110, 300, 190)
gen_rectangle1 (Rectangle2, 200, 310, 300, 390)
union2 (Rectangles, Rectangle2, Rectangles)
gen_contour_polygon_xld (Contours, [170, 330, 330, 170, 170], [70, 230, 70, 230, 70])
gen_contour_polygon_xld (Contour2, [170, 330, 330, 170, 170], [270, 430, 2...",58,77,
e57f986e,micro,5,,"gen_contour_polygon_xld (Contours, [170, 330, 330, 170], [70, 230, 70, 230])
gen_contour_polygon_xld (Contour2, [170, 330, 330, 170], [270, 430, 270, 430])
concat_obj (Contours, Contour2, Contours)
crop_contours_xld (Contours, CroppedContour1, 199.5, 109.5, 300.5, 190.5, 'false')
crop_contours_xld (...",78,96,"* --- Automatically Added Context ---
gen_rectangle1 (Rectangles, 200, 110, 300, 190)
gen_contour_polygon_xld (Contours, [170, 330, 330, 170, 170], [70, 230, 70, 230, 70])
gen_contour_polygon_xld (Con..."
c69eb07e,full,0,"This example transforms contours into their convex hull, into an ellipse, into their smallest enclos...","dev_close_window ()
read_image (Letters, 'letters')
crop_part (Letters, ImagePart, 631, 4, 200, 310)
get_image_size (ImagePart, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (ImagePart)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono...",8,55,
c69eb07e,micro,1,"circle, and into their smallest enclosing rectangles using the operator shape_trans_xld","dev_close_window ()
read_image (Letters, 'letters')
crop_part (Letters, ImagePart, 631, 4, 200, 310)
get_image_size (ImagePart, Width, Height)
dev_open_window (0, 0, Width * 2, Height * 2, 'black', WindowHandle)
dev_display (ImagePart)
dev_set_line_width (2)
set_display_font (WindowHandle, 14, 'mono...",6,61,
31a9f8b8,full,0,"Example program for the sort_contours operator.
The program sorts the contours of the letters.
Initi...","dev_close_window ()
dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
dev_set_part (-100, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display ...",10,49,
31a9f8b8,micro,1,,"dev_close_window ()
dev_update_off ()
read_image (Image, 'letters')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
dev_set_part (-100, 0, Height - 1, Width - 1)
set_display_font (WindowHandle, 16, 'mono', 'true', 'false')
dev_display ...",9,20,
31a9f8b8,micro,2,,"threshold_sub_pix (Image, Edges, 128)
select_contours_xld (Edges, SelectedContours, 'contour_length', 10, 200, -0.5, 0.5)",21,23,"* --- Automatically Added Context ---
read_image (Image, 'letters')
* --- End of Automatically Added Context ---"
31a9f8b8,micro,3,"First sort the contours by row coordinates. The position of a
contour is given by the upper left cor...","count_obj (SelectedContours, Number)
dev_set_line_width (3)",24,28,"* --- Automatically Added Context ---
select_contours_xld (Edges, SelectedContours, 'contour_length', 10, 200, -0.5, 0.5)
* --- End of Automatically Added Context ---"
31a9f8b8,micro,4,,"sort_contours_xld (SelectedContours, SortedContours1, 'character', 'true', 'column')
dev_display (Image)
disp_message (WindowHandle, 'XLD contours sorted by column', 'window', 12, 12, 'black', 'true')
for I := 1 to Number by 1
select_obj (SortedContours1, ObjectSelected, I)
dev_display (ObjectSelect...",29,42,"* --- Automatically Added Context ---
read_image (Image, 'letters')
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
select_contours_xld (Edges, SelectedContours, 'contour_le..."
31a9f8b8,micro,5,,"disp_message (WindowHandle, 'XLD contours sorted by row', 'window', 12, 12, 'black', 'true')
for I := 1 to Number by 1
select_obj (SortedContours2, ObjectSelected, I)
dev_display (ObjectSelected)
wait_seconds (0.01)
endfor",43,55,"* --- Automatically Added Context ---
dev_open_window (0, 0, Width / 2, Height / 2 + 100, 'black', WindowHandle)
count_obj (SelectedContours, Number)
disp_message (WindowHandle, 'XLD contours sorted b..."
c67de17d,full,0,"Extract contours and join all contours belonging to the same circles
Setup the graphics display","dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
dev_set_colored (12)
read_image (Image, 'circular_barcode')
dev_display (Image)
edges_sub_pix (Image, Edges, 'canny', 0.9, 20, 40)
select_contours_xld (Edges, SelectedContours, 'contour_length', 200, 99999, -0.5, 0.5)
dev_display...",9,33,
c67de17d,micro,1,,"dev_update_pc ('off')
dev_update_var ('off')
dev_update_window ('off')
dev_set_colored (12)
read_image (Image, 'circular_barcode')
dev_display (Image)",8,15,
c67de17d,micro,2,,"edges_sub_pix (Image, Edges, 'canny', 0.9, 20, 40)",16,17,"* --- Automatically Added Context ---
read_image (Image, 'circular_barcode')
* --- End of Automatically Added Context ---"
c67de17d,micro,3,,"select_contours_xld (Edges, SelectedContours, 'contour_length', 200, 99999, -0.5, 0.5)
dev_display (SelectedContours)
stop ()",18,22,"* --- Automatically Added Context ---
edges_sub_pix (Image, Edges, 'canny', 0.9, 20, 40)
* --- End of Automatically Added Context ---"
c67de17d,micro,4,,"union_cocircular_contours_xld (SelectedContours, UnionContours, 1.6, 0.9, 0.9, 30, 40, 40, 'true', 1)
dev_display (UnionContours)
stop ()",23,27,"* --- Automatically Added Context ---
select_contours_xld (Edges, SelectedContours, 'contour_length', 200, 99999, -0.5, 0.5)
* --- End of Automatically Added Context ---"
c67de17d,micro,5,,"dev_clear_window ()
dev_display (SelectedContours)
stop ()
dev_clear_window ()
dev_display (UnionContours)",28,39,"* --- Automatically Added Context ---
select_contours_xld (Edges, SelectedContours, 'contour_length', 200, 99999, -0.5, 0.5)
union_cocircular_contours_xld (SelectedContours, UnionContours, 1.6, 0.9, 0..."
ce156f67,full,0,"This example program demonstrates the use of union_collinear_contours_xld for connecting
collinear l...","dev_close_window ()
read_image (Image, 'pads')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_colored (12)
dev_set_draw ('margin')
dev_display (Image)
Border := 35
rectangle1_domain (Image, ImageReduced, Border, Border, 576 - Border, 768 - ...",12,54,
ce156f67,micro,1,"collinear line segments.  This is the new and recommended operator for this task.
In addition, the p...","dev_close_window ()
read_image (Image, 'pads')
get_image_size (Image, Width, Height)
dev_open_window (0, 0, Width, Height, 'black', WindowHandle)
dev_set_colored (12)
dev_set_draw ('margin')
dev_display (Image)",7,19,
ce156f67,micro,2,,"Border := 35
rectangle1_domain (Image, ImageReduced, Border, Border, 576 - Border, 768 - Border)",20,24,"* --- Automatically Added Context ---
read_image (Image, 'pads')
* --- End of Automatically Added Context ---"
ce156f67,micro,3,Unify collinear line segments and keep only the long ones,"* edges_sub_pix (ImageReduced, Edges, 'lanser2', 0.16, 3, 5)
edges_sub_pix (ImageReduced, Edges, 'canny', 5, 3, 5)
segment_contours_xld (Edges, ContoursSplit, 'lines', 5, 4, 2)
select_contours_xld (ContoursSplit, SelectedContours, 'contour_length', 20, Width / 2, -0.5, 0.5)
union_collinear_contours_...",25,38,"* --- Automatically Added Context ---
read_image (Image, 'pads')
get_image_size (Image, Width, Height)
rectangle1_domain (Image, ImageReduced, Border, Border, 576 - Border, 768 - Border)
* --- End of ..."
ce156f67,micro,4,,"union_adjacent_contours_xld (SelectedContours1, UnionContours1, 20, 1, 'attr_keep')
smallest_rectangle2_xld (UnionContours1, Row, Column, Phi, Length1, Length2)
gen_rectangle2 (Rectangle, Row, Column, Phi, Length1, Length2)
stop ()",39,46,"* --- Automatically Added Context ---
select_contours_xld (UnionContours, SelectedContours1, 'contour_length', 50, 10000, -0.5, 0.5)
* --- End of Automatically Added Context ---"
ce156f67,micro,5,,"dev_display (Image)
fit_line_contour_xld (SelectedContours1, 'tukey', -1, 0, 5, 2, RowBegin, ColBegin, RowEnd, ColEnd, Nr, Nc, Dist)
for i := 0 to |RowBegin| - 1 by 1
gen_contour_polygon_xld (Contour, [RowBegin[i],RowEnd[i]], [ColBegin[i],ColEnd[i]])
dev_display (Contour)
endfor",47,60,"* --- Automatically Added Context ---
read_image (Image, 'pads')
select_contours_xld (UnionContours, SelectedContours1, 'contour_length', 50, 10000, -0.5, 0.5)
* --- End of Automatically Added Context..."
d8c6d068,full,0,"This example demonstrates how to use the operator
union_cotangential_contours_xld.
Therefore, the op...","get_system ('flush_graphic', FlushGraphic)
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
RowOffsets := [25, 25, 240, 240]
ColumnOffsets := [0, 256, 0, 256]
gen_test_contour (ContourConcat1, RowOffsets[0], ColumnOffsets[0])
gen_test_con...",19,306,
d8c6d068,micro,1,,"get_system ('flush_graphic', FlushGraphic)",18,20,
d8c6d068,micro,2,,"FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
RowOffsets := [25, 25, 240, 240]
ColumnOffsets := [0, 256, 0, 256]
gen_test_contour (ContourConcat1, RowOffsets[0], ColumnOffsets[0])
gen_test_contour (ContourConcat2, RowOffsets[1], Column...",21,36,
d8c6d068,micro,3,,"dev_update_off ()
dev_close_window ()
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
dev_set_part (0, 0, 511, 511)
set_display_font (WindowHandle, 14, 'mono', 'true', 'false')
dev_clear_window ()
dev_set_line_width (3)
dev_set_colored (12)
dev_display (ContourConcat1)
dev_display (ContourCo...",37,57,"* --- Automatically Added Context ---
gen_test_contour (ContourConcat1, RowOffsets[0], ColumnOffsets[0])
gen_test_contour (ContourConcat2, RowOffsets[1], ColumnOffsets[1])
gen_test_contour (ContourCon..."
d8c6d068,micro,4,,"TestFitClippingLength := 10
TestFitLength := 5
TestMaxTangAngle := rad(135)",58,62,
d8c6d068,micro,5,,"union_cotangential_contours_xld (ContourConcat1, UnionContours1, FitClippingLength, FitLength, MaxTangAngle, MaxDist, MaxDistPerp, MaxOverlap, 'attr_forget')
union_cotangential_contours_xld (ContourConcat2, UnionContours2, TestFitClippingLength, FitLength, MaxTangAngle, MaxDist, MaxDistPerp, MaxOver...",63,68,"* --- Automatically Added Context ---
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
gen_test_contour (ContourConcat1, RowOffsets[0], Co..."
d8c6d068,micro,6,,"dev_clear_window ()
dev_set_line_width (5)
dev_display (UnionContours1)
dev_display (UnionContours2)
dev_display (UnionContours3)
dev_display (UnionContours4)
dev_set_line_width (1)
dev_set_color ('white')
dev_display (ContourConcat1)
dev_display (ContourConcat2)
dev_display (ContourConcat3)
dev_dis...",69,95,"* --- Automatically Added Context ---
RowOffsets := [25, 25, 240, 240]
ColumnOffsets := [0, 256, 0, 256]
gen_test_contour (ContourConcat1, RowOffsets[0], ColumnOffsets[0])
gen_test_contour (ContourCon..."
d8c6d068,micro,7,,"TestMaxDist := 10
TestMaxDistPerp := 10
TestMaxOverlap := 10
TestMaxTangAngle := rad(60)",104,109,"* --- Automatically Added Context ---
TestMaxTangAngle := rad(135)
* --- End of Automatically Added Context ---"
d8c6d068,micro,8,,"Row := [200, 200, 200]
Column := [100, 250, 400]
Delay := 0.1
gen_empty_obj (FixedContours)
for I := 0 to |Row| - 1 by 1
gen_ellipse_contour_xld (ContEllipse, Row[I], Column[I], rad(90), 100, 50, 0, rad(90), 'positive', 1.5)
concat_obj (FixedContours, ContEllipse, FixedContours)
endfor
gen_ellipse_c...",110,130,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Text := 'Default parameters:\nFitClippingLength = 0\nFitLength = 30\nMaxTangAngle = rad(45)'
* --- End of ..."
d8c6d068,micro,9,,"Title := 'Test influence of MaxDist'
DistY := 0
for DistX := 20 to -10 by -1
gen_ellipse_contour_xld (Contour1, Row[0] - 125 + DistY, Column[0] + DistX, rad(270), 25, 35, 0, rad(90), 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, Row[1] - 75 + DistY, Column[1] + DistX, rad(0), 35, 25, 0, rad(90...",131,151,"* --- Automatically Added Context ---
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
dev_open_window (0, 0, 512, 512, 'black', WindowHan..."
d8c6d068,micro,10,,"Title := 'Test influence of MaxDistPerp'
DistX := 5
for DistY := -20 to 20 by 1
gen_ellipse_contour_xld (Contour1, Row[0] - 125 + DistY, Column[0] + DistX, rad(270), 25, 35, 0, rad(90), 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, Row[1] - 75 + DistY, Column[1] + DistX, rad(0), 35, 25, 0, rad...",152,171,"* --- Automatically Added Context ---
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
dev_open_window (0, 0, 512, 512, 'black', WindowHan..."
d8c6d068,micro,11,,"Title := 'Test influence of positive MaxOverlap'
DistY := -5
for DistX := -15 to 15 by 1
gen_ellipse_contour_xld (Contour1, Row[0] - 125 + DistY, Column[0] + DistX, rad(270), 25, 35, 0, rad(90), 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, Row[1] - 75 + DistY, Column[1] + DistX, rad(0), 35, 2...",172,191,"* --- Automatically Added Context ---
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
dev_open_window (0, 0, 512, 512, 'black', WindowHan..."
d8c6d068,micro,12,,"Title := 'Test influence of negative MaxOverlap'
DistY := -5
for DistX := -15 to 15 by 1
gen_ellipse_contour_xld (Contour1, Row[0] - 125 + DistY, Column[0] + DistX, rad(270), 25, 35, 0, rad(90), 'positive', 1.5)
gen_ellipse_contour_xld (Contour2, Row[1] - 75 + DistY, Column[1] + DistX, rad(0), 35, 2...",192,211,"* --- Automatically Added Context ---
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
MaxOverlap := 2
dev_open_window (0, 0, 512, 512, 'black', WindowHan..."
d8c6d068,micro,13,,"Title := 'Test influence of MaxTangAngle'
DistX := 10
DistY := 0
hom_mat2d_identity (HomMat2DIdentity)
for Phi := 90 to -90 by -1
gen_ellipse_contour_xld (Contour1, Row[0] - 125 + DistY, Column[0] + DistX, rad(270), 25, 35, 0, rad(90), 'positive', 1.5)
hom_mat2d_rotate (HomMat2DIdentity, rad(Phi), R...",212,292,"* --- Automatically Added Context ---
get_system ('flush_graphic', FlushGraphic)
FitClippingLength := 0
FitLength := 30
MaxTangAngle := rad(45)
MaxDist := 25
MaxDistPerp := 10
dev_open_window (0, 0, 5..."
d8c6d068,micro,14,,"set_system ('flush_graphic', 'false')
dev_clear_window ()
disp_message (WindowHandle, Title, 'window', 12, 12, 'black', 'true')
disp_message (WindowHandle, Text, 'window', 220, 12, 'white', 'false')
dev_set_line_width (5)
dev_set_colored (12)
dev_display (UnionContours)
dev_set_line_width (1)
dev_se...",293,318,"* --- Automatically Added Context ---
dev_open_window (0, 0, 512, 512, 'black', WindowHandle)
Text := 'Default parameters:\nFitClippingLength = 0\nFitLength = 30\nMaxTangAngle = rad(45)'
Title := 'Tes..."
